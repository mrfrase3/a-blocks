!function(e){var t={};function o(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=165)}([function(e,t,o){e.exports=n;var i=o(5);function n(e,t,o){this.x=e||0,this.y=t||0,this.z=o||0}n.ZERO=new n(0,0,0),n.UNIT_X=new n(1,0,0),n.UNIT_Y=new n(0,1,0),n.UNIT_Z=new n(0,0,1),n.prototype.cross=function(e,t){var o=e.x,i=e.y,r=e.z,s=this.x,a=this.y,l=this.z;return(t=t||new n).x=a*r-l*i,t.y=l*o-s*r,t.z=s*i-a*o,t},n.prototype.set=function(e,t,o){return this.x=e,this.y=t,this.z=o,this},n.prototype.setZero=function(){this.x=this.y=this.z=0},n.prototype.vadd=function(e,t){if(!t)return new n(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z},n.prototype.vsub=function(e,t){if(!t)return new n(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z},n.prototype.crossmat=function(){return new i([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},n.prototype.normalize=function(){var e=this.x,t=this.y,o=this.z,i=Math.sqrt(e*e+t*t+o*o);if(i>0){var n=1/i;this.x*=n,this.y*=n,this.z*=n}else this.x=0,this.y=0,this.z=0;return i},n.prototype.unit=function(e){e=e||new n;var t=this.x,o=this.y,i=this.z,r=Math.sqrt(t*t+o*o+i*i);return r>0?(r=1/r,e.x=t*r,e.y=o*r,e.z=i*r):(e.x=1,e.y=0,e.z=0),e},n.prototype.norm=function(){var e=this.x,t=this.y,o=this.z;return Math.sqrt(e*e+t*t+o*o)},n.prototype.length=n.prototype.norm,n.prototype.norm2=function(){return this.dot(this)},n.prototype.lengthSquared=n.prototype.norm2,n.prototype.distanceTo=function(e){var t=this.x,o=this.y,i=this.z,n=e.x,r=e.y,s=e.z;return Math.sqrt((n-t)*(n-t)+(r-o)*(r-o)+(s-i)*(s-i))},n.prototype.distanceSquared=function(e){var t=this.x,o=this.y,i=this.z,n=e.x,r=e.y,s=e.z;return(n-t)*(n-t)+(r-o)*(r-o)+(s-i)*(s-i)},n.prototype.mult=function(e,t){t=t||new n;var o=this.x,i=this.y,r=this.z;return t.x=e*o,t.y=e*i,t.z=e*r,t},n.prototype.vmul=function(e,t){return(t=t||new n).x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t},n.prototype.scale=n.prototype.mult,n.prototype.addScaledVector=function(e,t,o){return(o=o||new n).x=this.x+e*t.x,o.y=this.y+e*t.y,o.z=this.z+e*t.z,o},n.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},n.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},n.prototype.negate=function(e){return(e=e||new n).x=-this.x,e.y=-this.y,e.z=-this.z,e};var r=new n,s=new n;n.prototype.tangents=function(e,t){var o=this.norm();if(o>0){var i=r,n=1/o;i.set(this.x*n,this.y*n,this.z*n);var a=s;Math.abs(i.x)<.9?(a.set(1,0,0),i.cross(a,e)):(a.set(0,1,0),i.cross(a,e)),i.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)},n.prototype.toString=function(){return this.x+","+this.y+","+this.z},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},n.prototype.lerp=function(e,t,o){var i=this.x,n=this.y,r=this.z;o.x=i+(e.x-i)*t,o.y=n+(e.y-n)*t,o.z=r+(e.z-r)*t},n.prototype.almostEquals=function(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)},n.prototype.almostZero=function(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)};var a=new n;n.prototype.isAntiparallelTo=function(e,t){return this.negate(a),a.almostEquals(e,t)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)}},function(e,t,o){e.exports=i;var i=o(1);o(0),o(2),o(13);function i(){this.id=i.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null,this.body=null}i.prototype.constructor=i,i.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},i.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},i.prototype.calculateLocalInertia=function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type},i.idCounter=0,i.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},function(e,t,o){e.exports=n;var i=o(0);function n(e,t,o,i){this.x=void 0!==e?e:0,this.y=void 0!==t?t:0,this.z=void 0!==o?o:0,this.w=void 0!==i?i:1}n.prototype.set=function(e,t,o,i){return this.x=e,this.y=t,this.z=o,this.w=i,this},n.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},n.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},n.prototype.setFromAxisAngle=function(e,t){var o=Math.sin(.5*t);return this.x=e.x*o,this.y=e.y*o,this.z=e.z*o,this.w=Math.cos(.5*t),this},n.prototype.toAxisAngle=function(e){e=e||new i,this.normalize();var t=2*Math.acos(this.w),o=Math.sqrt(1-this.w*this.w);return o<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/o,e.y=this.y/o,e.z=this.z/o),[e,t]};var r=new i,s=new i;n.prototype.setFromVectors=function(e,t){if(e.isAntiparallelTo(t)){var o=r,i=s;e.tangents(o,i),this.setFromAxisAngle(o,Math.PI)}else{var n=e.cross(t);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(Math.pow(e.norm(),2)*Math.pow(t.norm(),2))+e.dot(t),this.normalize()}return this};new i,new i,new i;n.prototype.mult=function(e,t){t=t||new n;var o=this.x,i=this.y,r=this.z,s=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=o*u+s*a+i*c-r*l,t.y=i*u+s*l+r*a-o*c,t.z=r*u+s*c+o*l-i*a,t.w=s*u-o*a-i*l-r*c,t},n.prototype.inverse=function(e){var t=this.x,o=this.y,i=this.z,r=this.w;e=e||new n,this.conjugate(e);var s=1/(t*t+o*o+i*i+r*r);return e.x*=s,e.y*=s,e.z*=s,e.w*=s,e},n.prototype.conjugate=function(e){return(e=e||new n).x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e},n.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},n.prototype.normalizeFast=function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},n.prototype.vmult=function(e,t){t=t||new i;var o=e.x,n=e.y,r=e.z,s=this.x,a=this.y,l=this.z,c=this.w,u=c*o+a*r-l*n,h=c*n+l*o-s*r,g=c*r+s*n-a*o,d=-s*o-a*n-l*r;return t.x=u*c+d*-s+h*-l-g*-a,t.y=h*c+d*-a+g*-s-u*-l,t.z=g*c+d*-l+u*-a-h*-s,t},n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},n.prototype.toEuler=function(e,t){var o,i,n;t=t||"YZX";var r=this.x,s=this.y,a=this.z,l=this.w;switch(t){case"YZX":var c=r*s+a*l;if(c>.499&&(o=2*Math.atan2(r,l),i=Math.PI/2,n=0),c<-.499&&(o=-2*Math.atan2(r,l),i=-Math.PI/2,n=0),isNaN(o)){var u=r*r,h=s*s,g=a*a;o=Math.atan2(2*s*l-2*r*a,1-2*h-2*g),i=Math.asin(2*c),n=Math.atan2(2*r*l-2*s*a,1-2*u-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=o,e.z=i,e.x=n},n.prototype.setFromEuler=function(e,t,o,i){i=i||"XYZ";var n=Math.cos(e/2),r=Math.cos(t/2),s=Math.cos(o/2),a=Math.sin(e/2),l=Math.sin(t/2),c=Math.sin(o/2);return"XYZ"===i?(this.x=a*r*s+n*l*c,this.y=n*l*s-a*r*c,this.z=n*r*c+a*l*s,this.w=n*r*s-a*l*c):"YXZ"===i?(this.x=a*r*s+n*l*c,this.y=n*l*s-a*r*c,this.z=n*r*c-a*l*s,this.w=n*r*s+a*l*c):"ZXY"===i?(this.x=a*r*s-n*l*c,this.y=n*l*s+a*r*c,this.z=n*r*c+a*l*s,this.w=n*r*s-a*l*c):"ZYX"===i?(this.x=a*r*s-n*l*c,this.y=n*l*s+a*r*c,this.z=n*r*c-a*l*s,this.w=n*r*s+a*l*c):"YZX"===i?(this.x=a*r*s+n*l*c,this.y=n*l*s+a*r*c,this.z=n*r*c-a*l*s,this.w=n*r*s-a*l*c):"XZY"===i&&(this.x=a*r*s-n*l*c,this.y=n*l*s-a*r*c,this.z=n*r*c+a*l*s,this.w=n*r*s+a*l*c),this},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)},n.prototype.slerp=function(e,t,o){o=o||new n;var i,r,s,a,l,c=this.x,u=this.y,h=this.z,g=this.w,d=e.x,p=e.y,f=e.z,m=e.w;return(r=c*d+u*p+h*f+g*m)<0&&(r=-r,d=-d,p=-p,f=-f,m=-m),1-r>1e-6?(i=Math.acos(r),s=Math.sin(i),a=Math.sin((1-t)*i)/s,l=Math.sin(t*i)/s):(a=1-t,l=t),o.x=a*c+l*d,o.y=a*u+l*p,o.z=a*h+l*f,o.w=a*g+l*m,o},n.prototype.integrate=function(e,t,o,i){i=i||new n;var r=e.x*o.x,s=e.y*o.y,a=e.z*o.z,l=this.x,c=this.y,u=this.z,h=this.w,g=.5*t;return i.x+=g*(r*h+s*u-a*c),i.y+=g*(s*h+a*l-r*u),i.z+=g*(a*h+r*c-s*l),i.w+=g*(-r*l-s*c-a*u),i}},function(e,t,o){e.exports=r;var i=o(7),n=o(0);o(5);function r(e,t,o){o=void 0!==o?o:1e6,i.call(this,e,t,0,o),this.restitution=0,this.ri=new n,this.rj=new n,this.ni=new n}r.prototype=new i,r.prototype.constructor=r;var s=new n,a=new n,l=new n;r.prototype.computeB=function(e){var t=this.a,o=this.b,i=this.bi,n=this.bj,r=this.ri,c=this.rj,u=s,h=a,g=i.velocity,d=i.angularVelocity,p=(i.force,i.torque,n.velocity),f=n.angularVelocity,m=(n.force,n.torque,l),y=this.jacobianElementA,v=this.jacobianElementB,E=this.ni;r.cross(E,u),c.cross(E,h),E.negate(y.spatial),u.negate(y.rotational),v.spatial.copy(E),v.rotational.copy(h),m.copy(n.position),m.vadd(c,m),m.vsub(i.position,m),m.vsub(r,m);var _=E.dot(m),T=this.restitution+1;return-_*t-(T*p.dot(E)-T*g.dot(E)+f.dot(h)-d.dot(u))*o-e*this.computeGiMf()};var c=new n,u=new n,h=new n,g=new n,d=new n;r.prototype.getImpactVelocityAlongNormal=function(){var e=c,t=u,o=h,i=g,n=d;return this.bi.position.vadd(this.ri,o),this.bj.position.vadd(this.rj,i),this.bi.getVelocityAtWorldPoint(o,e),this.bj.getVelocityAtWorldPoint(i,t),e.vsub(t,n),this.ni.dot(n)}},function(e,t,o){e.exports=c;var i=o(25),n=(o(1),o(0)),r=o(5),s=o(2),a=(o(13),o(6)),l=o(21);function c(e){e=e||{},i.apply(this),this.id=c.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new n,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:1,this.collisionResponse=!0,this.position=new n,this.previousPosition=new n,this.interpolatedPosition=new n,this.initPosition=new n,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new n,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new n,this.force=new n;var t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?c.STATIC:c.DYNAMIC,typeof e.type==typeof c.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new n,this.quaternion=new s,this.initQuaternion=new s,this.previousQuaternion=new s,this.interpolatedQuaternion=new s,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new n,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new n,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new n,this.invInertia=new n,this.invInertiaWorld=new r,this.invMassSolve=0,this.invInertiaSolve=new n,this.invInertiaWorldSolve=new r,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new n(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new n(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new a,this.aabbNeedsUpdate=!0,this.wlambda=new n,e.shape&&this.addShape(e.shape),this.updateMassProperties()}c.prototype=new i,c.prototype.constructor=c,c.COLLIDE_EVENT_NAME="collide",c.DYNAMIC=1,c.STATIC=2,c.KINEMATIC=4,c.AWAKE=0,c.SLEEPY=1,c.SLEEPING=2,c.idCounter=0,c.wakeupEvent={type:"wakeup"},c.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=0,this._wakeUpAfterNarrowphase=!1,e===c.SLEEPING&&this.dispatchEvent(c.wakeupEvent)},c.prototype.sleep=function(){this.sleepState=c.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this._wakeUpAfterNarrowphase=!1},c.sleepyEvent={type:"sleepy"},c.sleepEvent={type:"sleep"},c.prototype.sleepTick=function(e){if(this.allowSleep){var t=this.sleepState,o=this.velocity.norm2()+this.angularVelocity.norm2(),i=Math.pow(this.sleepSpeedLimit,2);t===c.AWAKE&&o<i?(this.sleepState=c.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(c.sleepyEvent)):t===c.SLEEPY&&o>i?this.wakeUp():t===c.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(c.sleepEvent))}},c.prototype.updateSolveMassProperties=function(){this.sleepState===c.SLEEPING||this.type===c.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},c.prototype.pointToLocalFrame=function(e,t){t=t||new n;return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t},c.prototype.vectorToLocalFrame=function(e,t){t=t||new n;return this.quaternion.conjugate().vmult(e,t),t},c.prototype.pointToWorldFrame=function(e,t){t=t||new n;return this.quaternion.vmult(e,t),t.vadd(this.position,t),t},c.prototype.vectorToWorldFrame=function(e,t){t=t||new n;return this.quaternion.vmult(e,t),t};var u=new n,h=new s;c.prototype.addShape=function(e,t,o){var i=new n,r=new s;return t&&i.copy(t),o&&r.copy(o),this.shapes.push(e),this.shapeOffsets.push(i),this.shapeOrientations.push(r),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this},c.prototype.updateBoundingRadius=function(){for(var e=this.shapes,t=this.shapeOffsets,o=e.length,i=0,n=0;n!==o;n++){var r=e[n];r.updateBoundingSphereRadius();var s=t[n].norm(),a=r.boundingSphereRadius;s+a>i&&(i=s+a)}this.boundingRadius=i};var g=new a;c.prototype.computeAABB=function(){for(var e=this.shapes,t=this.shapeOffsets,o=this.shapeOrientations,i=e.length,n=u,r=h,s=this.quaternion,a=this.aabb,l=g,c=0;c!==i;c++){var d=e[c];s.vmult(t[c],n),n.vadd(this.position,n),o[c].mult(s,r),d.calculateWorldAABB(n,r,l.lowerBound,l.upperBound),0===c?a.copy(l):a.extend(l)}this.aabbNeedsUpdate=!1};var d=new r,p=new r;new r;c.prototype.updateInertiaWorld=function(e){var t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){var o=d,i=p;o.setRotationFromQuaternion(this.quaternion),o.transpose(i),o.scale(t,o),o.mmult(i,this.invInertiaWorld)}else;};new n;var f=new n;c.prototype.applyForce=function(e,t){if(this.type===c.DYNAMIC){var o=f;t.cross(e,o),this.force.vadd(e,this.force),this.torque.vadd(o,this.torque)}};var m=new n,y=new n;c.prototype.applyLocalForce=function(e,t){if(this.type===c.DYNAMIC){var o=m,i=y;this.vectorToWorldFrame(e,o),this.vectorToWorldFrame(t,i),this.applyForce(o,i)}};new n;var v=new n,E=new n;c.prototype.applyImpulse=function(e,t){if(this.type===c.DYNAMIC){var o=t,i=v;i.copy(e),i.mult(this.invMass,i),this.velocity.vadd(i,this.velocity);var n=E;o.cross(e,n),this.invInertiaWorld.vmult(n,n),this.angularVelocity.vadd(n,this.angularVelocity)}};var _=new n,T=new n;c.prototype.applyLocalImpulse=function(e,t){if(this.type===c.DYNAMIC){var o=_,i=T;this.vectorToWorldFrame(e,o),this.vectorToWorldFrame(t,i),this.applyImpulse(o,i)}};var b=new n;c.prototype.updateMassProperties=function(){var e=b;this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia,o=this.fixedRotation;this.computeAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),l.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!o?1/t.x:0,t.y>0&&!o?1/t.y:0,t.z>0&&!o?1/t.z:0),this.updateInertiaWorld(!0)},c.prototype.getVelocityAtWorldPoint=function(e,t){var o=new n;return e.vsub(this.position,o),this.angularVelocity.cross(o,t),this.velocity.vadd(t,t),t};new n,new n,new s,new s;c.prototype.integrate=function(e,t,o){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),(this.type===c.DYNAMIC||this.type===c.KINEMATIC)&&this.sleepState!==c.SLEEPING){var i=this.velocity,n=this.angularVelocity,r=this.position,s=this.force,a=this.torque,l=this.quaternion,u=this.invMass,h=this.invInertiaWorld,g=this.linearFactor,d=u*e;i.x+=s.x*d*g.x,i.y+=s.y*d*g.y,i.z+=s.z*d*g.z;var p=h.elements,f=this.angularFactor,m=a.x*f.x,y=a.y*f.y,v=a.z*f.z;n.x+=e*(p[0]*m+p[1]*y+p[2]*v),n.y+=e*(p[3]*m+p[4]*y+p[5]*v),n.z+=e*(p[6]*m+p[7]*y+p[8]*v),r.x+=i.x*e,r.y+=i.y*e,r.z+=i.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),t&&(o?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}},function(e,t,o){e.exports=n;var i=o(0);function n(e){this.elements=e||[0,0,0,0,0,0,0,0,0]}n.prototype.identity=function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1},n.prototype.setZero=function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0},n.prototype.setTrace=function(e){var t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z},n.prototype.getTrace=function(e){e=e||new i;var t=this.elements;e.x=t[0],e.y=t[4],e.z=t[8]},n.prototype.vmult=function(e,t){t=t||new i;var o=this.elements,n=e.x,r=e.y,s=e.z;return t.x=o[0]*n+o[1]*r+o[2]*s,t.y=o[3]*n+o[4]*r+o[5]*s,t.z=o[6]*n+o[7]*r+o[8]*s,t},n.prototype.smult=function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]*=e},n.prototype.mmult=function(e,t){for(var o=t||new n,i=0;i<3;i++)for(var r=0;r<3;r++){for(var s=0,a=0;a<3;a++)s+=e.elements[i+3*a]*this.elements[a+3*r];o.elements[i+3*r]=s}return o},n.prototype.scale=function(e,t){t=t||new n;for(var o=this.elements,i=t.elements,r=0;3!==r;r++)i[3*r+0]=e.x*o[3*r+0],i[3*r+1]=e.y*o[3*r+1],i[3*r+2]=e.z*o[3*r+2];return t},n.prototype.solve=function(e,t){t=t||new i;for(var o,n=[],r=0;r<12;r++)n.push(0);for(r=0;r<3;r++)for(o=0;o<3;o++)n[r+4*o]=this.elements[r+3*o];n[3]=e.x,n[7]=e.y,n[11]=e.z;var s,a,l=3,c=l;do{if(0===n[(r=c-l)+4*r])for(o=r+1;o<c;o++)if(0!==n[r+4*o]){s=4;do{n[(a=4-s)+4*r]+=n[a+4*o]}while(--s);break}if(0!==n[r+4*r])for(o=r+1;o<c;o++){var u=n[r+4*o]/n[r+4*r];s=4;do{n[(a=4-s)+4*o]=a<=r?0:n[a+4*o]-n[a+4*r]*u}while(--s)}}while(--l);if(t.z=n[11]/n[10],t.y=(n[7]-n[6]*t.z)/n[5],t.x=(n[3]-n[2]*t.z-n[1]*t.y)/n[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t},n.prototype.e=function(e,t,o){if(void 0===o)return this.elements[t+3*e];this.elements[t+3*e]=o},n.prototype.copy=function(e){for(var t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this},n.prototype.toString=function(){for(var e="",t=0;t<9;t++)e+=this.elements[t]+",";return e},n.prototype.reverse=function(e){e=e||new n;for(var t,o=[],i=0;i<18;i++)o.push(0);for(i=0;i<3;i++)for(t=0;t<3;t++)o[i+6*t]=this.elements[i+3*t];o[3]=1,o[9]=0,o[15]=0,o[4]=0,o[10]=1,o[16]=0,o[5]=0,o[11]=0,o[17]=1;var r,s,a=3,l=a;do{if(0===o[(i=l-a)+6*i])for(t=i+1;t<l;t++)if(0!==o[i+6*t]){r=6;do{o[(s=6-r)+6*i]+=o[s+6*t]}while(--r);break}if(0!==o[i+6*i])for(t=i+1;t<l;t++){var c=o[i+6*t]/o[i+6*i];r=6;do{o[(s=6-r)+6*t]=s<=i?0:o[s+6*t]-o[s+6*i]*c}while(--r)}}while(--a);i=2;do{t=i-1;do{c=o[i+6*t]/o[i+6*i];r=6;do{o[(s=6-r)+6*t]=o[s+6*t]-o[s+6*i]*c}while(--r)}while(t--)}while(--i);i=2;do{c=1/o[i+6*i];r=6;do{o[(s=6-r)+6*i]=o[s+6*i]*c}while(--r)}while(i--);i=2;do{t=2;do{if(s=o[3+t+6*i],isNaN(s)||s===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(i,t,s)}while(t--)}while(i--);return e},n.prototype.setRotationFromQuaternion=function(e){var t=e.x,o=e.y,i=e.z,n=e.w,r=t+t,s=o+o,a=i+i,l=t*r,c=t*s,u=t*a,h=o*s,g=o*a,d=i*a,p=n*r,f=n*s,m=n*a,y=this.elements;return y[0]=1-(h+d),y[1]=c-m,y[2]=u+f,y[3]=c+m,y[4]=1-(l+d),y[5]=g-p,y[6]=u-f,y[7]=g+p,y[8]=1-(l+h),this},n.prototype.transpose=function(e){for(var t=(e=e||new n).elements,o=this.elements,i=0;3!==i;i++)for(var r=0;3!==r;r++)t[3*i+r]=o[3*r+i];return e}},function(e,t,o){var i=o(0);o(14);function n(e){e=e||{},this.lowerBound=new i,e.lowerBound&&this.lowerBound.copy(e.lowerBound),this.upperBound=new i,e.upperBound&&this.upperBound.copy(e.upperBound)}e.exports=n;var r=new i;n.prototype.setFromPoints=function(e,t,o,i){var n=this.lowerBound,s=this.upperBound,a=o;n.copy(e[0]),a&&a.vmult(n,n),s.copy(n);for(var l=1;l<e.length;l++){var c=e[l];a&&(a.vmult(c,r),c=r),c.x>s.x&&(s.x=c.x),c.x<n.x&&(n.x=c.x),c.y>s.y&&(s.y=c.y),c.y<n.y&&(n.y=c.y),c.z>s.z&&(s.z=c.z),c.z<n.z&&(n.z=c.z)}return t&&(t.vadd(n,n),t.vadd(s,s)),i&&(n.x-=i,n.y-=i,n.z-=i,s.x+=i,s.y+=i,s.z+=i),this},n.prototype.copy=function(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this},n.prototype.clone=function(){return(new n).copy(this)},n.prototype.extend=function(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)},n.prototype.overlaps=function(e){var t=this.lowerBound,o=this.upperBound,i=e.lowerBound,n=e.upperBound,r=i.x<=o.x&&o.x<=n.x||t.x<=n.x&&n.x<=o.x,s=i.y<=o.y&&o.y<=n.y||t.y<=n.y&&n.y<=o.y,a=i.z<=o.z&&o.z<=n.z||t.z<=n.z&&n.z<=o.z;return r&&s&&a},n.prototype.volume=function(){var e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)},n.prototype.contains=function(e){var t=this.lowerBound,o=this.upperBound,i=e.lowerBound,n=e.upperBound;return t.x<=i.x&&o.x>=n.x&&t.y<=i.y&&o.y>=n.y&&t.z<=i.z&&o.z>=n.z},n.prototype.getCorners=function(e,t,o,i,n,r,s,a){var l=this.lowerBound,c=this.upperBound;e.copy(l),t.set(c.x,l.y,l.z),o.set(c.x,c.y,l.z),i.set(l.x,c.y,c.z),n.set(c.x,l.y,l.z),r.set(l.x,c.y,l.z),s.set(l.x,l.y,c.z),a.copy(c)};var s=[new i,new i,new i,new i,new i,new i,new i,new i];n.prototype.toLocalFrame=function(e,t){var o=s,i=o[0],n=o[1],r=o[2],a=o[3],l=o[4],c=o[5],u=o[6],h=o[7];this.getCorners(i,n,r,a,l,c,u,h);for(var g=0;8!==g;g++){var d=o[g];e.pointToLocal(d,d)}return t.setFromPoints(o)},n.prototype.toWorldFrame=function(e,t){var o=s,i=o[0],n=o[1],r=o[2],a=o[3],l=o[4],c=o[5],u=o[6],h=o[7];this.getCorners(i,n,r,a,l,c,u,h);for(var g=0;8!==g;g++){var d=o[g];e.pointToWorld(d,d)}return t.setFromPoints(o)},n.prototype.overlapsRay=function(e){var t=1/e._direction.x,o=1/e._direction.y,i=1/e._direction.z,n=(this.lowerBound.x-e.from.x)*t,r=(this.upperBound.x-e.from.x)*t,s=(this.lowerBound.y-e.from.y)*o,a=(this.upperBound.y-e.from.y)*o,l=(this.lowerBound.z-e.from.z)*i,c=(this.upperBound.z-e.from.z)*i,u=Math.max(Math.max(Math.min(n,r),Math.min(s,a)),Math.min(l,c)),h=Math.min(Math.min(Math.max(n,r),Math.max(s,a)),Math.max(l,c));return!(h<0)&&!(u>h)}},function(e,t,o){e.exports=r;var i=o(120),n=o(0);function r(e,t,o,n){this.id=r.id++,this.minForce=void 0===o?-1e6:o,this.maxForce=void 0===n?1e6:n,this.bi=e,this.bj=t,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new i,this.jacobianElementB=new i,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}r.prototype.constructor=r,r.id=0,r.prototype.setSpookParams=function(e,t,o){var i=t,n=e,r=o;this.a=4/(r*(1+4*i)),this.b=4*i/(1+4*i),this.eps=4/(r*r*n*(1+4*i))},r.prototype.computeB=function(e,t,o){var i=this.computeGW();return-this.computeGq()*e-i*t-this.computeGiMf()*o},r.prototype.computeGq=function(){var e=this.jacobianElementA,t=this.jacobianElementB,o=this.bi,i=this.bj,n=o.position,r=i.position;return e.spatial.dot(n)+t.spatial.dot(r)};new n;r.prototype.computeGW=function(){var e=this.jacobianElementA,t=this.jacobianElementB,o=this.bi,i=this.bj,n=o.velocity,r=i.velocity,s=o.angularVelocity,a=i.angularVelocity;return e.multiplyVectors(n,s)+t.multiplyVectors(r,a)},r.prototype.computeGWlambda=function(){var e=this.jacobianElementA,t=this.jacobianElementB,o=this.bi,i=this.bj,n=o.vlambda,r=i.vlambda,s=o.wlambda,a=i.wlambda;return e.multiplyVectors(n,s)+t.multiplyVectors(r,a)};var s=new n,a=new n,l=new n,c=new n;r.prototype.computeGiMf=function(){var e=this.jacobianElementA,t=this.jacobianElementB,o=this.bi,i=this.bj,n=o.force,r=o.torque,u=i.force,h=i.torque,g=o.invMassSolve,d=i.invMassSolve;return n.scale(g,s),u.scale(d,a),o.invInertiaWorldSolve.vmult(r,l),i.invInertiaWorldSolve.vmult(h,c),e.multiplyVectors(s,l)+t.multiplyVectors(a,c)};var u=new n;r.prototype.computeGiMGt=function(){var e=this.jacobianElementA,t=this.jacobianElementB,o=this.bi,i=this.bj,n=o.invMassSolve,r=i.invMassSolve,s=o.invInertiaWorldSolve,a=i.invInertiaWorldSolve,l=n+r;return s.vmult(e.rotational,u),l+=u.dot(e.rotational),a.vmult(t.rotational,u),l+=u.dot(t.rotational)};var h=new n;new n,new n,new n,new n,new n;r.prototype.addToWlambda=function(e){var t=this.jacobianElementA,o=this.jacobianElementB,i=this.bi,n=this.bj,r=h;i.vlambda.addScaledVector(i.invMassSolve*e,t.spatial,i.vlambda),n.vlambda.addScaledVector(n.invMassSolve*e,o.spatial,n.vlambda),i.invInertiaWorldSolve.vmult(t.rotational,r),i.wlambda.addScaledVector(e,r,i.wlambda),n.invInertiaWorldSolve.vmult(o.rotational,r),n.wlambda.addScaledVector(e,r,n.wlambda)},r.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},function(e,t,o){e.exports=n;var i=o(14);function n(e,t,o){o=i.defaults(o,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=t,this.id=n.idCounter++,this.collideConnected=o.collideConnected,o.wakeUpBodies&&(e&&e.wakeUp(),t&&t.wakeUp())}n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.prototype.enable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!0},n.prototype.disable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!1},n.idCounter=0},function(e,t,o){var i=o(0),n=o(2);function r(e){e=e||{},this.position=new i,e.position&&this.position.copy(e.position),this.quaternion=new n,e.quaternion&&this.quaternion.copy(e.quaternion)}e.exports=r;var s=new n;r.pointToLocalFrame=function(e,t,o,n){n=n||new i;return o.vsub(e,n),t.conjugate(s),s.vmult(n,n),n},r.prototype.pointToLocal=function(e,t){return r.pointToLocalFrame(this.position,this.quaternion,e,t)},r.pointToWorldFrame=function(e,t,o,n){n=n||new i;return t.vmult(o,n),n.vadd(e,n),n},r.prototype.pointToWorld=function(e,t){return r.pointToWorldFrame(this.position,this.quaternion,e,t)},r.prototype.vectorToWorldFrame=function(e,t){t=t||new i;return this.quaternion.vmult(e,t),t},r.vectorToWorldFrame=function(e,t,o){return e.vmult(t,o),o},r.vectorToLocalFrame=function(e,t,o,n){n=n||new i;return t.w*=-1,t.vmult(o,n),t.w*=-1,n}},function(e,t,o){e.exports=s;var i=o(1),n=o(0),r=(o(2),o(9));function s(e,t,o){i.call(this),this.type=i.types.CONVEXPOLYHEDRON,this.vertices=e||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=t||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=o?o.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}s.prototype=new i,s.prototype.constructor=s;var a=new n;s.prototype.computeEdges=function(){var e=this.faces,t=this.vertices,o=(t.length,this.uniqueEdges);o.length=0;for(var i=a,n=0;n!==e.length;n++)for(var r=e[n],s=r.length,l=0;l!==s;l++){var c=(l+1)%s;t[r[l]].vsub(t[r[c]],i),i.normalize();for(var u=!1,h=0;h!==o.length;h++)if(o[h].almostEquals(i)||o[h].almostEquals(i)){u=!0;break}u||o.push(i.clone())}},s.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++)if(!this.vertices[this.faces[e][t]])throw new Error("Vertex "+this.faces[e][t]+" not found!");var o=this.faceNormals[e]||new n;this.getFaceNormal(e,o),o.negate(o),this.faceNormals[e]=o;var i=this.vertices[this.faces[e][0]];if(o.dot(i)<0){console.error(".faceNormals["+e+"] = Vec3("+o.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(t=0;t<this.faces[e].length;t++)console.warn(".vertices["+this.faces[e][t]+"] = Vec3("+this.vertices[this.faces[e][t]].toString()+")")}}};var l=new n,c=new n;s.computeNormal=function(e,t,o,i){t.vsub(e,c),o.vsub(t,l),l.cross(c,i),i.isZero()||i.normalize()},s.prototype.getFaceNormal=function(e,t){var o=this.faces[e],i=this.vertices[o[0]],n=this.vertices[o[1]],r=this.vertices[o[2]];return s.computeNormal(i,n,r,t)};var u=new n;s.prototype.clipAgainstHull=function(e,t,o,i,r,s,a,l,c){for(var h=u,g=-1,d=-Number.MAX_VALUE,p=0;p<o.faces.length;p++){h.copy(o.faceNormals[p]),r.vmult(h,h);var f=h.dot(s);f>d&&(d=f,g=p)}for(var m=[],y=o.faces[g],v=y.length,E=0;E<v;E++){var _=o.vertices[y[E]],T=new n;T.copy(_),r.vmult(T,T),i.vadd(T,T),m.push(T)}g>=0&&this.clipFaceAgainstHull(s,e,t,m,a,l,c)};var h=new n,g=new n,d=new n,p=new n,f=new n,m=new n;s.prototype.findSeparatingAxis=function(e,t,o,i,n,r,s,a){var l=h,c=g,u=d,y=p,v=f,E=m,_=Number.MAX_VALUE;if(this.uniqueAxes)for(b=0;b!==this.uniqueAxes.length;b++){if(o.vmult(this.uniqueAxes[b],l),!1===(S=this.testSepAxis(l,e,t,o,i,n)))return!1;S<_&&(_=S,r.copy(l))}else for(var T=s?s.length:this.faces.length,b=0;b<T;b++){var M=s?s[b]:b;if(l.copy(this.faceNormals[M]),o.vmult(l,l),!1===(S=this.testSepAxis(l,e,t,o,i,n)))return!1;S<_&&(_=S,r.copy(l))}if(e.uniqueAxes)for(b=0;b!==e.uniqueAxes.length;b++){if(n.vmult(e.uniqueAxes[b],c),0,!1===(S=this.testSepAxis(c,e,t,o,i,n)))return!1;S<_&&(_=S,r.copy(c))}else for(var A=a?a.length:e.faces.length,b=0;b<A;b++){var S;M=a?a[b]:b;if(c.copy(e.faceNormals[M]),n.vmult(c,c),0,!1===(S=this.testSepAxis(c,e,t,o,i,n)))return!1;S<_&&(_=S,r.copy(c))}for(var w=0;w!==this.uniqueEdges.length;w++){o.vmult(this.uniqueEdges[w],y);for(var C=0;C!==e.uniqueEdges.length;C++)if(n.vmult(e.uniqueEdges[C],v),y.cross(v,E),!E.almostZero()){E.normalize();var N=this.testSepAxis(E,e,t,o,i,n);if(!1===N)return!1;N<_&&(_=N,r.copy(E))}}return i.vsub(t,u),u.dot(r)>0&&r.negate(r),!0};var y=[],v=[];s.prototype.testSepAxis=function(e,t,o,i,n,r){s.project(this,e,o,i,y),s.project(t,e,n,r,v);var a=y[0],l=y[1],c=v[0],u=v[1];if(a<u||c<l)return!1;var h=a-u,g=c-l;return h<g?h:g};var E=new n,_=new n;s.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(E,_);var o=_.x-E.x,i=_.y-E.y,n=_.z-E.z;t.x=1/12*e*(2*i*2*i+2*n*2*n),t.y=1/12*e*(2*o*2*o+2*n*2*n),t.z=1/12*e*(2*i*2*i+2*o*2*o)},s.prototype.getPlaneConstantOfFace=function(e){var t=this.faces[e],o=this.faceNormals[e],i=this.vertices[t[0]];return-o.dot(i)};var T=new n,b=new n,M=new n,A=new n,S=new n,w=new n,C=new n,N=new n;s.prototype.clipFaceAgainstHull=function(e,t,o,i,n,r,s){for(var a=T,l=b,c=M,u=A,h=S,g=w,d=C,p=N,f=i,m=[],y=-1,v=Number.MAX_VALUE,E=0;E<this.faces.length;E++){a.copy(this.faceNormals[E]),o.vmult(a,a);var _=a.dot(e);_<v&&(v=_,y=E)}if(!(y<0)){var L=this.faces[y];L.connectedFaces=[];for(var I=0;I<this.faces.length;I++)for(var R=0;R<this.faces[I].length;R++)-1!==L.indexOf(this.faces[I][R])&&I!==y&&-1===L.connectedFaces.indexOf(I)&&L.connectedFaces.push(I);f.length;for(var D=L.length,x=0;x<D;x++){var O=this.vertices[L[x]],k=this.vertices[L[(x+1)%D]];O.vsub(k,l),c.copy(l),o.vmult(c,c),t.vadd(c,c),u.copy(this.faceNormals[y]),o.vmult(u,u),t.vadd(u,u),c.cross(u,h),h.negate(h),g.copy(O),o.vmult(g,g),t.vadd(g,g);g.dot(h);var B=L.connectedFaces[x];d.copy(this.faceNormals[B]);var P=this.getPlaneConstantOfFace(B);p.copy(d),o.vmult(p,p);var U=P-p.dot(t);for(this.clipFaceAgainstPlane(f,m,p,U);f.length;)f.shift();for(;m.length;)f.push(m.shift())}d.copy(this.faceNormals[y]);P=this.getPlaneConstantOfFace(y);p.copy(d),o.vmult(p,p);for(U=P-p.dot(t),I=0;I<f.length;I++){var F=p.dot(f[I])+U;if(F<=n&&(console.log("clamped: depth="+F+" to minDist="+n),F=n),F<=r){var H=f[I];if(F<=0){var j={point:H,normal:p,depth:F};s.push(j)}}}}},s.prototype.clipFaceAgainstPlane=function(e,t,o,i){var r,s,a=e.length;if(a<2)return t;var l=e[e.length-1],c=e[0];r=o.dot(l)+i;for(var u=0;u<a;u++){if(c=e[u],s=o.dot(c)+i,r<0)if(s<0){(h=new n).copy(c),t.push(h)}else{var h=new n;l.lerp(c,r/(r-s),h),t.push(h)}else if(s<0){h=new n;l.lerp(c,r/(r-s),h),t.push(h),t.push(c)}l=c,r=s}return t},s.prototype.computeWorldVertices=function(e,t){for(var o=this.vertices.length;this.worldVertices.length<o;)this.worldVertices.push(new n);for(var i=this.vertices,r=this.worldVertices,s=0;s!==o;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1};new n;s.prototype.computeLocalAABB=function(e,t){var o=this.vertices.length,i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var n=0;n<o;n++){var r=i[n];r.x<e.x?e.x=r.x:r.x>t.x&&(t.x=r.x),r.y<e.y?e.y=r.y:r.y>t.y&&(t.y=r.y),r.z<e.z?e.z=r.z:r.z>t.z&&(t.z=r.z)}},s.prototype.computeWorldFaceNormals=function(e){for(var t=this.faceNormals.length;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new n);for(var o=this.faceNormals,i=this.worldFaceNormals,r=0;r!==t;r++)e.vmult(o[r],i[r]);this.worldFaceNormalsNeedsUpdate=!1},s.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,o=0,i=t.length;o!==i;o++){var n=t[o].norm2();n>e&&(e=n)}this.boundingSphereRadius=Math.sqrt(e)};var L=new n;s.prototype.calculateWorldAABB=function(e,t,o,i){for(var n,r,s,a,l,c,u=this.vertices.length,h=this.vertices,g=0;g<u;g++){L.copy(h[g]),t.vmult(L,L),e.vadd(L,L);var d=L;d.x<n||void 0===n?n=d.x:(d.x>a||void 0===a)&&(a=d.x),d.y<r||void 0===r?r=d.y:(d.y>l||void 0===l)&&(l=d.y),d.z<s||void 0===s?s=d.z:(d.z>c||void 0===c)&&(c=d.z)}o.set(n,r,s),i.set(a,l,c)},s.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},s.prototype.getAveragePointLocal=function(e){e=e||new n;for(var t=this.vertices.length,o=this.vertices,i=0;i<t;i++)e.vadd(o[i],e);return e.mult(1/t,e),e},s.prototype.transformAllPoints=function(e,t){var o=this.vertices.length,i=this.vertices;if(t){for(var n=0;n<o;n++){var r=i[n];t.vmult(r,r)}for(n=0;n<this.faceNormals.length;n++){r=this.faceNormals[n];t.vmult(r,r)}}if(e)for(n=0;n<o;n++){(r=i[n]).vadd(e,r)}};var I=new n,R=new n,D=new n;s.prototype.pointIsInside=function(e){var t=this.vertices.length,o=this.vertices,i=this.faces,n=this.faceNormals,r=this.faces.length,s=I;this.getAveragePointLocal(s);for(var a=0;a<r;a++){this.faces[a].length,t=n[a];var l=o[i[a][0]],c=R;e.vsub(l,c);var u=t.dot(c),h=D;s.vsub(l,h);var g=t.dot(h);if(u<0&&g>0||u>0&&g<0)return!1}return-1};new n;var x=new n,O=new n;s.project=function(e,t,o,i,n){var s=e.vertices.length,a=x,l=0,c=0,u=O,h=e.vertices;u.setZero(),r.vectorToLocalFrame(o,i,t,a),r.pointToLocalFrame(o,i,u,u);var g=u.dot(a);c=l=h[0].dot(a);for(var d=1;d<s;d++){var p=h[d].dot(a);p>l&&(l=p),p<c&&(c=p)}if((c-=g)>(l-=g)){var f=c;c=l,l=f}n[0]=l,n[1]=c}},function(e,t,o){e.exports={version:o(121).version,AABB:o(6),ArrayCollisionMatrix:o(39),Body:o(4),Box:o(21),Broadphase:o(20),Constraint:o(8),ContactEquation:o(3),Narrowphase:o(37),ConeTwistConstraint:o(119),ContactMaterial:o(34),ConvexPolyhedron:o(10),Cylinder:o(117),DistanceConstraint:o(116),Equation:o(7),EventTarget:o(25),FrictionEquation:o(24),GSSolver:o(33),GridBroadphase:o(115),Heightfield:o(114),HingeConstraint:o(32),LockConstraint:o(113),Mat3:o(5),Material:o(13),NaiveBroadphase:o(31),ObjectCollisionMatrix:o(112),Pool:o(35),Particle:o(30),Plane:o(38),PointToPointConstraint:o(17),Quaternion:o(2),Ray:o(19),RaycastVehicle:o(111),RaycastResult:o(12),RigidVehicle:o(109),RotationalEquation:o(16),RotationalMotorEquation:o(23),SAPBroadphase:o(108),SPHSystem:o(107),Shape:o(1),Solver:o(18),Sphere:o(29),SplitSolver:o(106),Spring:o(105),Transform:o(9),Trimesh:o(104),Vec3:o(0),Vec3Pool:o(36),World:o(102)}},function(e,t,o){var i=o(0);function n(){this.rayFromWorld=new i,this.rayToWorld=new i,this.hitNormalWorld=new i,this.hitPointWorld=new i,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}e.exports=n,n.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},n.prototype.abort=function(){this._shouldStop=!0},n.prototype.set=function(e,t,o,i,n,r,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(o),this.hitPointWorld.copy(i),this.shape=n,this.body=r,this.distance=s}},function(e,t){function o(e){var t="";"string"==typeof(e=e||{})?(t=e,e={}):"object"==typeof e&&(t=""),this.name=t,this.id=o.idCounter++,this.friction=void 0!==e.friction?e.friction:-1,this.restitution=void 0!==e.restitution?e.restitution:-1}e.exports=o,o.idCounter=0},function(e,t){function o(){}e.exports=o,o.defaults=function(e,t){for(var o in e=e||{},t)o in e||(e[o]=t[o]);return e}},function(e,t,o){var i=o(145);i.setLocale=function(e){i.Msg=Object.assign(e,i.Msg),i.Msg=i.Msg()},i.utils.getMessageArray_=function(){return i.Msg},i.setLocale(o(144)),i.Blocks=Object.assign(i.Blocks,o(143)(i)),i.JavaScript=o(142)(i),i.Lua=o(141)(i),i.Dart=o(140)(i),i.PHP=o(139)(i),i.Python=o(138)(i),e.exports=i},function(e,t,o){e.exports=r;var i=o(0),n=(o(5),o(7));function r(e,t,o){var r=void 0!==(o=o||{}).maxForce?o.maxForce:1e6;n.call(this,e,t,-r,r),this.axisA=o.axisA?o.axisA.clone():new i(1,0,0),this.axisB=o.axisB?o.axisB.clone():new i(0,1,0),this.maxAngle=Math.PI/2}r.prototype=new n,r.prototype.constructor=r;var s=new i,a=new i;r.prototype.computeB=function(e){var t=this.a,o=this.b,i=this.axisA,n=this.axisB,r=s,l=a,c=this.jacobianElementA,u=this.jacobianElementB;return i.cross(n,r),n.cross(i,l),c.rotational.copy(l),u.rotational.copy(r),-(Math.cos(this.maxAngle)-i.dot(n))*t-this.computeGW()*o-e*this.computeGiMf()}},function(e,t,o){e.exports=s;var i=o(8),n=o(3),r=o(0);function s(e,t,o,s,a){i.call(this,e,o),a=void 0!==a?a:1e6,this.pivotA=t?t.clone():new r,this.pivotB=s?s.clone():new r;var l=this.equationX=new n(e,o),c=this.equationY=new n(e,o),u=this.equationZ=new n(e,o);this.equations.push(l,c,u),l.minForce=c.minForce=u.minForce=-a,l.maxForce=c.maxForce=u.maxForce=a,l.ni.set(1,0,0),c.ni.set(0,1,0),u.ni.set(0,0,1)}s.prototype=new i,s.prototype.update=function(){var e=this.bodyA,t=this.bodyB,o=this.equationX,i=this.equationY,n=this.equationZ;e.quaternion.vmult(this.pivotA,o.ri),t.quaternion.vmult(this.pivotB,o.rj),i.ri.copy(o.ri),i.rj.copy(o.rj),n.ri.copy(o.ri),n.rj.copy(o.rj)}},function(e,t){function o(){this.equations=[]}e.exports=o,o.prototype.solve=function(e,t){return 0},o.prototype.addEquation=function(e){e.enabled&&this.equations.push(e)},o.prototype.removeEquation=function(e){var t=this.equations,o=t.indexOf(e);-1!==o&&t.splice(o,1)},o.prototype.removeAllEquations=function(){this.equations.length=0}},function(e,t,o){e.exports=c;var i=o(0),n=o(2),r=o(9),s=(o(10),o(21),o(12)),a=o(1),l=o(6);function c(e,t){this.from=e?e.clone():new i,this.to=t?t.clone():new i,this._direction=new i,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=c.ANY,this.result=new s,this.hasHit=!1,this.callback=function(e){}}c.prototype.constructor=c,c.CLOSEST=1,c.ANY=2,c.ALL=4;var u=new l,h=[];c.prototype.intersectWorld=function(e,t){return this.mode=t.mode||c.ANY,this.result=t.result||new s,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(u),h.length=0,e.broadphase.aabbQuery(e,u,h),this.intersectBodies(h),this.hasHit};var g=new i,d=new i;function p(e,t,o,i){i.vsub(t,P),o.vsub(t,g),e.vsub(t,d);var n,r,s=P.dot(P),a=P.dot(g),l=P.dot(d),c=g.dot(g),u=g.dot(d);return(n=c*l-a*u)>=0&&(r=s*u-a*l)>=0&&n+r<s*c-a*a}c.pointInTriangle=p;var f=new i,m=new n;c.prototype.intersectBody=function(e,t){t&&(this.result=t,this._updateDirection());var o=this.checkCollisionResponse;if((!o||e.collisionResponse)&&0!=(this.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&this.collisionFilterMask))for(var i=f,n=m,r=0,s=e.shapes.length;r<s;r++){var a=e.shapes[r];if((!o||a.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[r],n),e.quaternion.vmult(e.shapeOffsets[r],i),i.vadd(e.position,i),this.intersectShape(a,n,i,e),this.result._shouldStop))break}},c.prototype.intersectBodies=function(e,t){t&&(this.result=t,this._updateDirection());for(var o=0,i=e.length;!this.result._shouldStop&&o<i;o++)this.intersectBody(e[o])},c.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},c.prototype.intersectShape=function(e,t,o,i){if(!(function(e,t,o){o.vsub(e,P);var i=P.dot(t);return t.mult(i,U),U.vadd(e,U),o.distanceTo(U)}(this.from,this._direction,o)>e.boundingSphereRadius)){var n=this[e.type];n&&n.call(this,e,t,o,i,e)}};new i,new i;var y=new i,v=new i,E=new i,_=new i;new i,new s;c.prototype.intersectBox=function(e,t,o,i,n){return this.intersectConvex(e.convexPolyhedronRepresentation,t,o,i,n)},c.prototype[a.types.BOX]=c.prototype.intersectBox,c.prototype.intersectPlane=function(e,t,o,n,r){var s=this.from,a=this.to,l=this._direction,c=new i(0,0,1);t.vmult(c,c);var u=new i;s.vsub(o,u);var h=u.dot(c);if(a.vsub(o,u),!(h*u.dot(c)>0||s.distanceTo(a)<h)){var g=c.dot(l);if(!(Math.abs(g)<this.precision)){var d=new i,p=new i,f=new i;s.vsub(o,d);var m=-c.dot(d)/g;l.scale(m,p),s.vadd(p,f),this.reportIntersection(c,f,r,n,-1)}}},c.prototype[a.types.PLANE]=c.prototype.intersectPlane,c.prototype.getAABB=function(e){var t=this.to,o=this.from;e.lowerBound.x=Math.min(t.x,o.x),e.lowerBound.y=Math.min(t.y,o.y),e.lowerBound.z=Math.min(t.z,o.z),e.upperBound.x=Math.max(t.x,o.x),e.upperBound.y=Math.max(t.y,o.y),e.upperBound.z=Math.max(t.z,o.z)};var T={faceList:[0]},b=new i,M=new c,A=[];c.prototype.intersectHeightfield=function(e,t,o,i,n){e.data,e.elementSize;var s=M;s.from.copy(this.from),s.to.copy(this.to),r.pointToLocalFrame(o,t,s.from,s.from),r.pointToLocalFrame(o,t,s.to,s.to),s._updateDirection();var a,c,u,h,g=A;a=c=0,u=h=e.data.length-1;var d=new l;s.getAABB(d),e.getIndexOfPosition(d.lowerBound.x,d.lowerBound.y,g,!0),a=Math.max(a,g[0]),c=Math.max(c,g[1]),e.getIndexOfPosition(d.upperBound.x,d.upperBound.y,g,!0),u=Math.min(u,g[0]+1),h=Math.min(h,g[1]+1);for(var p=a;p<u;p++)for(var f=c;f<h;f++){if(this.result._shouldStop)return;if(e.getAabbAtIndex(p,f,d),d.overlapsRay(s)){if(e.getConvexTrianglePillar(p,f,!1),r.pointToWorldFrame(o,t,e.pillarOffset,b),this.intersectConvex(e.pillarConvex,t,b,i,n,T),this.result._shouldStop)return;e.getConvexTrianglePillar(p,f,!0),r.pointToWorldFrame(o,t,e.pillarOffset,b),this.intersectConvex(e.pillarConvex,t,b,i,n,T)}}},c.prototype[a.types.HEIGHTFIELD]=c.prototype.intersectHeightfield;var S=new i,w=new i;c.prototype.intersectSphere=function(e,t,o,i,n){var r=this.from,s=this.to,a=e.radius,l=Math.pow(s.x-r.x,2)+Math.pow(s.y-r.y,2)+Math.pow(s.z-r.z,2),c=2*((s.x-r.x)*(r.x-o.x)+(s.y-r.y)*(r.y-o.y)+(s.z-r.z)*(r.z-o.z)),u=Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)+Math.pow(r.z-o.z,2)-Math.pow(a,2),h=Math.pow(c,2)-4*l*u,g=S,d=w;if(!(h<0))if(0===h)r.lerp(s,h,g),g.vsub(o,d),d.normalize(),this.reportIntersection(d,g,n,i,-1);else{var p=(-c-Math.sqrt(h))/(2*l),f=(-c+Math.sqrt(h))/(2*l);if(p>=0&&p<=1&&(r.lerp(s,p,g),g.vsub(o,d),d.normalize(),this.reportIntersection(d,g,n,i,-1)),this.result._shouldStop)return;f>=0&&f<=1&&(r.lerp(s,f,g),g.vsub(o,d),d.normalize(),this.reportIntersection(d,g,n,i,-1))}},c.prototype[a.types.SPHERE]=c.prototype.intersectSphere;var C=new i,N=(new i,new i,new i);c.prototype.intersectConvex=function(e,t,o,i,n,r){for(var s=C,a=N,l=r&&r.faceList||null,c=e.faces,u=e.vertices,h=e.faceNormals,g=this._direction,d=this.from,f=this.to,m=d.distanceTo(f),T=l?l.length:c.length,b=this.result,M=0;!b._shouldStop&&M<T;M++){var A=l?l[M]:M,S=c[A],w=h[A],L=t,I=o;a.copy(u[S[0]]),L.vmult(a,a),a.vadd(I,a),a.vsub(d,a),L.vmult(w,s);var R=g.dot(s);if(!(Math.abs(R)<this.precision)){var D=s.dot(a)/R;if(!(D<0)){g.mult(D,y),y.vadd(d,y),v.copy(u[S[0]]),L.vmult(v,v),I.vadd(v,v);for(var x=1;!b._shouldStop&&x<S.length-1;x++){E.copy(u[S[x]]),_.copy(u[S[x+1]]),L.vmult(E,E),L.vmult(_,_),I.vadd(E,E),I.vadd(_,_);var O=y.distanceTo(d);!p(y,v,E,_)&&!p(y,E,v,_)||O>m||this.reportIntersection(s,y,n,i,A)}}}}},c.prototype[a.types.CONVEXPOLYHEDRON]=c.prototype.intersectConvex;var L=new i,I=new i,R=new i,D=new i,x=new i,O=new i,k=(new l,[]),B=new r;c.prototype.intersectTrimesh=function(e,t,o,i,n,s){var a=L,l=k,c=B,u=N,h=I,g=R,d=D,f=O,m=x,T=(s&&s.faceList,e.indices),b=(e.vertices,e.faceNormals,this.from),M=this.to,A=this._direction;c.position.copy(o),c.quaternion.copy(t),r.vectorToLocalFrame(o,t,A,h),r.pointToLocalFrame(o,t,b,g),r.pointToLocalFrame(o,t,M,d),d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,d.vsub(g,h),h.normalize();var S=g.distanceSquared(d);e.tree.rayQuery(this,c,l);for(var w=0,C=l.length;!this.result._shouldStop&&w!==C;w++){var P=l[w];e.getNormal(P,a),e.getVertex(T[3*P],v),v.vsub(g,u);var U=h.dot(a),F=a.dot(u)/U;if(!(F<0)){h.scale(F,y),y.vadd(g,y),e.getVertex(T[3*P+1],E),e.getVertex(T[3*P+2],_);var H=y.distanceSquared(g);!p(y,E,v,_)&&!p(y,v,E,_)||H>S||(r.vectorToWorldFrame(t,a,m),r.pointToWorldFrame(o,t,y,f),this.reportIntersection(m,f,n,i,P))}}l.length=0},c.prototype[a.types.TRIMESH]=c.prototype.intersectTrimesh,c.prototype.reportIntersection=function(e,t,o,i,n){var r=this.from,s=this.to,a=r.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this._direction)>0))switch(l.hitFaceIndex=void 0!==n?n:-1,this.mode){case c.ALL:this.hasHit=!0,l.set(r,s,e,t,o,i,a),l.hasHit=!0,this.callback(l);break;case c.CLOSEST:(a<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(r,s,e,t,o,i,a));break;case c.ANY:this.hasHit=!0,l.hasHit=!0,l.set(r,s,e,t,o,i,a),l._shouldStop=!0}};var P=new i,U=new i},function(e,t,o){var i=o(4),n=o(0),r=o(2);o(1),o(38);function s(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}e.exports=s,s.prototype.collisionPairs=function(e,t,o){throw new Error("collisionPairs not implemented for this BroadPhase class!")},s.prototype.needBroadphaseCollision=function(e,t){return 0!=(e.collisionFilterGroup&t.collisionFilterMask)&&0!=(t.collisionFilterGroup&e.collisionFilterMask)&&(0==(e.type&i.STATIC)&&e.sleepState!==i.SLEEPING||0==(t.type&i.STATIC)&&t.sleepState!==i.SLEEPING)},s.prototype.intersectionTest=function(e,t,o,i){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,o,i):this.doBoundingSphereBroadphase(e,t,o,i)};var a=new n;new n,new r,new n;s.prototype.doBoundingSphereBroadphase=function(e,t,o,i){var n=a;t.position.vsub(e.position,n);var r=Math.pow(e.boundingRadius+t.boundingRadius,2);n.norm2()<r&&(o.push(e),i.push(t))},s.prototype.doBoundingBoxBroadphase=function(e,t,o,i){e.aabbNeedsUpdate&&e.computeAABB(),t.aabbNeedsUpdate&&t.computeAABB(),e.aabb.overlaps(t.aabb)&&(o.push(e),i.push(t))};var l={keys:[]},c=[],u=[];s.prototype.makePairsUnique=function(e,t){for(var o=l,i=c,n=u,r=e.length,s=0;s!==r;s++)i[s]=e[s],n[s]=t[s];e.length=0,t.length=0;for(s=0;s!==r;s++){var a=i[s].id,h=n[s].id;o[g=a<h?a+","+h:h+","+a]=s,o.keys.push(g)}for(s=0;s!==o.keys.length;s++){var g,d=o[g=o.keys.pop()];e.push(i[d]),t.push(n[d]),delete o[g]}},s.prototype.setWorld=function(e){};var h=new n;s.boundingSphereCheck=function(e,t){var o=h;return e.position.vsub(t.position,o),Math.pow(e.shape.boundingSphereRadius+t.shape.boundingSphereRadius,2)>o.norm2()},s.prototype.aabbQuery=function(e,t,o){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},function(e,t,o){e.exports=s;var i=o(1),n=o(0),r=o(10);function s(e){i.call(this),this.type=i.types.BOX,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}s.prototype=new i,s.prototype.constructor=s,s.prototype.updateConvexPolyhedronRepresentation=function(){var e=this.halfExtents.x,t=this.halfExtents.y,o=this.halfExtents.z,i=n,s=[new i(-e,-t,-o),new i(e,-t,-o),new i(e,t,-o),new i(-e,t,-o),new i(-e,-t,o),new i(e,-t,o),new i(e,t,o),new i(-e,t,o)],a=(new i(0,0,1),new i(0,1,0),new i(1,0,0),new r(s,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]]));this.convexPolyhedronRepresentation=a,a.material=this.material},s.prototype.calculateLocalInertia=function(e,t){return t=t||new n,s.calculateInertia(this.halfExtents,e,t),t},s.calculateInertia=function(e,t,o){var i=e;o.x=1/12*t*(2*i.y*2*i.y+2*i.z*2*i.z),o.y=1/12*t*(2*i.x*2*i.x+2*i.z*2*i.z),o.z=1/12*t*(2*i.y*2*i.y+2*i.x*2*i.x)},s.prototype.getSideNormals=function(e,t){var o=e,i=this.halfExtents;if(o[0].set(i.x,0,0),o[1].set(0,i.y,0),o[2].set(0,0,i.z),o[3].set(-i.x,0,0),o[4].set(0,-i.y,0),o[5].set(0,0,-i.z),void 0!==t)for(var n=0;n!==o.length;n++)t.vmult(o[n],o[n]);return o},s.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},s.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var a=new n;new n;s.prototype.forEachWorldCorner=function(e,t,o){for(var i=this.halfExtents,n=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]],r=0;r<n.length;r++)a.set(n[r][0],n[r][1],n[r][2]),t.vmult(a,a),e.vadd(a,a),o(a.x,a.y,a.z)};var l=[new n,new n,new n,new n,new n,new n,new n,new n];s.prototype.calculateWorldAABB=function(e,t,o,i){var n=this.halfExtents;l[0].set(n.x,n.y,n.z),l[1].set(-n.x,n.y,n.z),l[2].set(-n.x,-n.y,n.z),l[3].set(-n.x,-n.y,-n.z),l[4].set(n.x,-n.y,-n.z),l[5].set(n.x,n.y,-n.z),l[6].set(-n.x,n.y,-n.z),l[7].set(n.x,-n.y,n.z);var r=l[0];t.vmult(r,r),e.vadd(r,r),i.copy(r),o.copy(r);for(var s=1;s<8;s++){r=l[s];t.vmult(r,r),e.vadd(r,r);var a=r.x,c=r.y,u=r.z;a>i.x&&(i.x=a),c>i.y&&(i.y=c),u>i.z&&(i.z=u),a<o.x&&(o.x=a),c<o.y&&(o.y=c),u<o.z&&(o.z=u)}}},function(e,t){e.exports=class{static computeCentroids(e){var t,o,i;for(t=0,o=e.faces.length;t<o;t++)(i=e.faces[t]).centroid=new THREE.Vector3(0,0,0),i.centroid.add(e.vertices[i.a]),i.centroid.add(e.vertices[i.b]),i.centroid.add(e.vertices[i.c]),i.centroid.divideScalar(3)}static roundNumber(e,t){var o=Number(e+"").toFixed(parseInt(t));return parseFloat(o)}static sample(e){return e[Math.floor(Math.random()*e.length)]}static mergeVertexIds(e,t){var o=[];if(e.forEach(e=>{t.indexOf(e)>=0&&o.push(e)}),o.length<2)return[];o.includes(e[0])&&o.includes(e[e.length-1])&&e.push(e.shift()),o.includes(t[0])&&o.includes(t[t.length-1])&&t.push(t.shift()),o=[],e.forEach(e=>{t.includes(e)&&o.push(e)});for(var i=o[1],n=o[0],r=e.slice();r[0]!==i;)r.push(r.shift());for(var s=0,a=t.slice();a[0]!==n;)if(a.push(a.shift()),s++>10)throw new Error("Unexpected state");return a.shift(),a.pop(),r=r.concat(a)}static setPolygonCentroid(e,t){var o=new THREE.Vector3,i=t.vertices;e.vertexIds.forEach(e=>{o.add(i[e])}),o.divideScalar(e.vertexIds.length),e.centroid.copy(o)}static cleanPolygon(e,t){for(var o=[],i=t.vertices,n=0;n<e.vertexIds.length;n++){var r,s,a,l,c=i[e.vertexIds[n]];0===n?(r=e.vertexIds[1],s=e.vertexIds[e.vertexIds.length-1]):n===e.vertexIds.length-1?(r=e.vertexIds[0],s=e.vertexIds[e.vertexIds.length-2]):(r=e.vertexIds[n+1],s=e.vertexIds[n-1]),a=i[r],l=i[s];var u=a.clone().sub(c),h=l.clone().sub(c),g=u.angleTo(h);if(g>Math.PI-.01&&g<Math.PI+.01){var d=[];e.neighbours.forEach(t=>{t.vertexIds.includes(e.vertexIds[n])||d.push(t)}),e.neighbours=d}else o.push(e.vertexIds[n])}e.vertexIds=o,setPolygonCentroid(e,t)}static isConvex(e,t){var o=t.vertices;if(e.vertexIds.length<3)return!1;for(var i=!0,n=[],r=0;r<e.vertexIds.length;r++){var s,a,l=o[e.vertexIds[r]];0===r?(s=o[e.vertexIds[1]],a=o[e.vertexIds[e.vertexIds.length-1]]):r===e.vertexIds.length-1?(s=o[e.vertexIds[0]],a=o[e.vertexIds[e.vertexIds.length-2]]):(s=o[e.vertexIds[r+1]],a=o[e.vertexIds[r-1]]);var c=s.clone().sub(l),u=a.clone().sub(l),h=c.angleTo(u);if(h===Math.PI||0===h)return!1;var g=c.cross(u).y;n.push(g)}return n.forEach(e=>{0===e&&(i=!1)}),n[0]>0?n.forEach(e=>{e<0&&(i=!1)}):n.forEach(e=>{e>0&&(i=!1)}),i}static distanceToSquared(e,t){var o=e.x-t.x,i=e.y-t.y,n=e.z-t.z;return o*o+i*i+n*n}static isPointInPoly(e,t){for(var o=!1,i=-1,n=e.length,r=n-1;++i<n;r=i)(e[i].z<=t.z&&t.z<e[r].z||e[r].z<=t.z&&t.z<e[i].z)&&t.x<(e[r].x-e[i].x)*(t.z-e[i].z)/(e[r].z-e[i].z)+e[i].x&&(o=!o);return o}static isVectorInPolygon(e,t,o){var i=1e5,n=-1e5,r=[];return t.vertexIds.forEach(e=>{i=Math.min(o[e].y,i),n=Math.max(o[e].y,n),r.push(o[e])}),!!(e.y<n+.5&&e.y>i-.5&&this.isPointInPoly(r,e))}static triarea2(e,t,o){var i=t.x-e.x,n=t.z-e.z;return(o.x-e.x)*n-i*(o.z-e.z)}static vequal(e,t){return this.distanceToSquared(e,t)<1e-5}static array_intersect(){let e,t,o,i,n,r,s=[],a={};for(r=arguments.length-1,o=arguments[0].length,t=0,e=0;e<=r;e++)(i=arguments[e].length)<o&&(t=e,o=i);for(e=0;e<=r;e++){n=arguments[i=e===t?0:e||t].length;for(var l=0;l<n;l++){var c=arguments[i][l];a[c]===e-1?e===r?(s.push(c),a[c]=0):a[c]=e:0===e&&(a[c]=0)}}return s}}},function(e,t,o){e.exports=r;var i=o(0),n=(o(5),o(7));function r(e,t,o){o=void 0!==o?o:1e6,n.call(this,e,t,-o,o),this.axisA=new i,this.axisB=new i,this.targetVelocity=0}r.prototype=new n,r.prototype.constructor=r,r.prototype.computeB=function(e){this.a;var t=this.b,o=(this.bi,this.bj,this.axisA),i=this.axisB,n=this.jacobianElementA,r=this.jacobianElementB;return n.rotational.copy(o),i.negate(r.rotational),-(this.computeGW()-this.targetVelocity)*t-e*this.computeGiMf()}},function(e,t,o){e.exports=r;var i=o(7),n=o(0);o(5);function r(e,t,o){i.call(this,e,t,-o,o),this.ri=new n,this.rj=new n,this.t=new n}r.prototype=new i,r.prototype.constructor=r;var s=new n,a=new n;r.prototype.computeB=function(e){this.a;var t=this.b,o=(this.bi,this.bj,this.ri),i=this.rj,n=s,r=a,l=this.t;o.cross(l,n),i.cross(l,r);var c=this.jacobianElementA,u=this.jacobianElementB;return l.negate(c.spatial),n.negate(c.rotational),u.spatial.copy(l),u.rotational.copy(r),-this.computeGW()*t-e*this.computeGiMf()}},function(e,t){var o=function(){};e.exports=o,o.prototype={constructor:o,addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var o=this._listeners;return void 0===o[e]&&(o[e]=[]),-1===o[e].indexOf(t)&&o[e].push(t),this},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var o=this._listeners;return void 0!==o[e]&&-1!==o[e].indexOf(t)},hasAnyEventListener:function(e){return void 0!==this._listeners&&void 0!==this._listeners[e]},removeEventListener:function(e,t){if(void 0===this._listeners)return this;var o=this._listeners;if(void 0===o[e])return this;var i=o[e].indexOf(t);return-1!==i&&o[e].splice(i,1),this},dispatchEvent:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var o=0,i=t.length;o<i;o++)t[o].call(this,e)}return this}}},function(e,t,o){var i=o(11),n=o(99);e.exports={"dynamic-body":o(96),"static-body":o(92),constraint:o(91),system:o(90),registerAll:function(e){this._registered||(e=e||window.AFRAME,n.registerAll(),e.systems.physics||e.registerSystem("physics",this.system),e.components["dynamic-body"]||e.registerComponent("dynamic-body",this["dynamic-body"]),e.components["static-body"]||e.registerComponent("static-body",this["static-body"]),e.components.constraint||e.registerComponent("constraint",this.constraint),this._registered=!0)}},window.CANNON=window.CANNON||i},function(e,t){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t,o){var i,n,r=o(11),s=o(95);o(93),e.exports={schema:{shape:{default:"auto",oneOf:["auto","box","cylinder","sphere","hull","none"]},cylinderAxis:{default:"y",oneOf:["x","y","z"]},sphereRadius:{default:NaN}},init:function(){this.system=this.el.sceneEl.systems.physics,this.el.sceneEl.hasLoaded?this.initBody():this.el.sceneEl.addEventListener("loaded",this.initBody.bind(this))},initBody:function(){var e,t=this.el,o=this.data,i=t.getAttribute("position");if(this.body=new r.Body({mass:o.mass||0,material:this.system.material,position:new r.Vec3(i.x,i.y,i.z),linearDamping:o.linearDamping,angularDamping:o.angularDamping}),this.el.object3D.updateMatrixWorld(!0),"none"!==o.shape){var n="auto"===o.shape?void 0:AFRAME.utils.extend({},this.data,{type:s.Type[o.shape.toUpperCase()]});if(!(e=s(this.el.object3D,n)))return void this.el.addEventListener("model-loaded",this.initBody.bind(this));this.body.addShape(e,e.offset,e.orientation),this.system.debug&&this.createWireframe(this.body,e)}var a=t.getAttribute("rotation");this.body.quaternion.setFromEuler(THREE.Math.degToRad(a.x),THREE.Math.degToRad(a.y),THREE.Math.degToRad(a.z),"XYZ").normalize(),this.el.body=this.body,this.body.el=this.el,this.isLoaded=!0,this.isPlaying&&this._play(),this.el.emit("body-loaded",{body:this.el.body})},play:function(){this.isLoaded&&this._play()},_play:function(){this.system.addBehavior(this,this.system.Phase.SIMULATE),this.system.addBody(this.body),this.wireframe&&this.el.sceneEl.object3D.add(this.wireframe),this.syncToPhysics()},pause:function(){this.isLoaded&&(this.system.removeBehavior(this,this.system.Phase.SIMULATE),this.system.removeBody(this.body),this.wireframe&&this.el.sceneEl.object3D.remove(this.wireframe))},remove:function(){this.pause(),delete this.body.el,delete this.body,delete this.el.body,delete this.wireframe},createWireframe:function(e,t){var o=t.offset,i=t.orientation,n=r.shape2mesh(e).children[0];this.wireframe=new THREE.LineSegments(new THREE.EdgesGeometry(n.geometry),new THREE.LineBasicMaterial({color:16711680})),o&&(this.wireframe.offset=o.clone()),i&&(i.inverse(i),this.wireframe.orientation=new THREE.Quaternion(i.x,i.y,i.z,i.w)),this.syncWireframe()},syncWireframe:function(){var e,t=this.wireframe;this.wireframe&&(t.quaternion.copy(this.body.quaternion),t.orientation&&t.quaternion.multiply(t.orientation),t.position.copy(this.body.position),t.offset&&(e=t.offset.clone().applyQuaternion(t.quaternion),t.position.add(e)),t.updateMatrix())},syncToPhysics:(i=new THREE.Quaternion,n=new THREE.Vector3,function(){var e=this.el,t=e.parentEl,o=this.body;o&&(e.components.velocity&&o.velocity.copy(e.getAttribute("velocity")),t.isScene?(o.quaternion.copy(e.object3D.quaternion),o.position.copy(e.object3D.position)):(e.object3D.getWorldQuaternion(i),o.quaternion.copy(i),e.object3D.getWorldPosition(n),o.position.copy(n)),this.wireframe&&this.syncWireframe())}),syncFromPhysics:function(){var e=new THREE.Vector3,t=new THREE.Quaternion,o=new THREE.Quaternion;return function(){var i=this.el,n=i.parentEl,r=this.body;r&&(n.isScene?(i.setAttribute("quaternion",r.quaternion),i.setAttribute("position",r.position)):(t.copy(r.quaternion),n.object3D.getWorldQuaternion(o),t.multiply(o.inverse()),i.setAttribute("quaternion",{x:t.x,y:t.y,z:t.z,w:t.w}),e.copy(r.position),n.object3D.worldToLocal(e),i.setAttribute("position",{x:e.x,y:e.y,z:e.z})),this.wireframe&&this.syncWireframe())}}()}},function(e,t,o){e.exports=r;var i=o(1),n=o(0);function r(e){if(i.call(this),this.radius=void 0!==e?Number(e):1,this.type=i.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}r.prototype=new i,r.prototype.constructor=r,r.prototype.calculateLocalInertia=function(e,t){t=t||new n;var o=2*e*this.radius*this.radius/5;return t.x=o,t.y=o,t.z=o,t},r.prototype.volume=function(){return 4*Math.PI*this.radius/3},r.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},r.prototype.calculateWorldAABB=function(e,t,o,i){for(var n=this.radius,r=["x","y","z"],s=0;s<r.length;s++){var a=r[s];o[a]=e[a]-n,i[a]=e[a]+n}}},function(e,t,o){e.exports=r;var i=o(1),n=o(0);function r(){i.call(this),this.type=i.types.PARTICLE}r.prototype=new i,r.prototype.constructor=r,r.prototype.calculateLocalInertia=function(e,t){return(t=t||new n).set(0,0,0),t},r.prototype.volume=function(){return 0},r.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},r.prototype.calculateWorldAABB=function(e,t,o,i){o.copy(e),i.copy(e)}},function(e,t,o){e.exports=r;var i=o(20),n=o(6);function r(){i.apply(this)}r.prototype=new i,r.prototype.constructor=r,r.prototype.collisionPairs=function(e,t,o){var i,n,r,s,a=e.bodies,l=a.length;for(i=0;i!==l;i++)for(n=0;n!==i;n++)r=a[i],s=a[n],this.needBroadphaseCollision(r,s)&&this.intersectionTest(r,s,t,o)};new n;r.prototype.aabbQuery=function(e,t,o){o=o||[];for(var i=0;i<e.bodies.length;i++){var n=e.bodies[i];n.aabbNeedsUpdate&&n.computeAABB(),n.aabb.overlaps(t)&&o.push(n)}return o}},function(e,t,o){e.exports=a;o(8);var i=o(17),n=o(16),r=o(23),s=(o(3),o(0));function a(e,t,o){var a=void 0!==(o=o||{}).maxForce?o.maxForce:1e6,l=o.pivotA?o.pivotA.clone():new s,c=o.pivotB?o.pivotB.clone():new s;i.call(this,e,l,t,c,a),(this.axisA=o.axisA?o.axisA.clone():new s(1,0,0)).normalize(),(this.axisB=o.axisB?o.axisB.clone():new s(1,0,0)).normalize();var u=this.rotationalEquation1=new n(e,t,o),h=this.rotationalEquation2=new n(e,t,o),g=this.motorEquation=new r(e,t,a);g.enabled=!1,this.equations.push(u,h,g)}a.prototype=new i,a.constructor=a,a.prototype.enableMotor=function(){this.motorEquation.enabled=!0},a.prototype.disableMotor=function(){this.motorEquation.enabled=!1},a.prototype.setMotorSpeed=function(e){this.motorEquation.targetVelocity=e},a.prototype.setMotorMaxForce=function(e){this.motorEquation.maxForce=e,this.motorEquation.minForce=-e};var l=new s,c=new s;a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,o=this.motorEquation,n=this.rotationalEquation1,r=this.rotationalEquation2,s=l,a=c,u=this.axisA,h=this.axisB;i.prototype.update.call(this),e.quaternion.vmult(u,s),t.quaternion.vmult(h,a),s.tangents(n.axisA,r.axisA),n.axisB.copy(a),r.axisB.copy(a),this.motorEquation.enabled&&(e.quaternion.vmult(this.axisA,o.axisA),t.quaternion.vmult(this.axisB,o.axisB))}},function(e,t,o){e.exports=n;o(0),o(2);var i=o(18);function n(){i.call(this),this.iterations=10,this.tolerance=1e-7}n.prototype=new i;var r=[],s=[],a=[];n.prototype.solve=function(e,t){var o,i,n,l,c,u=0,h=this.iterations,g=this.tolerance*this.tolerance,d=this.equations,p=d.length,f=t.bodies,m=f.length,y=e;if(0!==p)for(var v=0;v!==m;v++)f[v].updateSolveMassProperties();var E=s,_=a,T=r;E.length=p,_.length=p,T.length=p;for(v=0;v!==p;v++){var b=d[v];T[v]=0,_[v]=b.computeB(y),E[v]=1/b.computeC()}if(0!==p){for(v=0;v!==m;v++){var M=(w=f[v]).vlambda,A=w.wlambda;M.set(0,0,0),A.set(0,0,0)}for(u=0;u!==h;u++){l=0;for(var S=0;S!==p;S++){b=d[S];o=_[S],i=E[S],(c=T[S])+(n=i*(o-b.computeGWlambda()-b.eps*c))<b.minForce?n=b.minForce-c:c+n>b.maxForce&&(n=b.maxForce-c),T[S]+=n,l+=n>0?n:-n,b.addToWlambda(n)}if(l*l<g)break}for(v=0;v!==m;v++){var w,C=(w=f[v]).velocity,N=w.angularVelocity;w.vlambda.vmul(w.linearFactor,w.vlambda),C.vadd(w.vlambda,C),w.wlambda.vmul(w.angularFactor,w.wlambda),N.vadd(w.wlambda,N)}for(var L=d.length,I=1/y;L--;)d[L].multiplier=T[L]*I}return u}},function(e,t,o){var i=o(14);function n(e,t,o){o=i.defaults(o,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=n.idCounter++,this.materials=[e,t],this.friction=o.friction,this.restitution=o.restitution,this.contactEquationStiffness=o.contactEquationStiffness,this.contactEquationRelaxation=o.contactEquationRelaxation,this.frictionEquationStiffness=o.frictionEquationStiffness,this.frictionEquationRelaxation=o.frictionEquationRelaxation}e.exports=n,n.idCounter=0},function(e,t){function o(){this.objects=[],this.type=Object}e.exports=o,o.prototype.release=function(){for(var e=arguments.length,t=0;t!==e;t++)this.objects.push(arguments[t]);return this},o.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},o.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")},o.prototype.resize=function(e){for(var t=this.objects;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}},function(e,t,o){e.exports=r;var i=o(0),n=o(35);function r(){n.call(this),this.type=i}r.prototype=new n,r.prototype.constructObject=function(){return new i}},function(e,t,o){e.exports=d;var i=o(6),n=o(4),r=o(1),s=o(19),a=o(0),l=o(9),c=(o(10),o(2)),u=(o(18),o(36)),h=o(3),g=o(24);function d(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new u,this.world=e,this.currentContactMaterial=null,this.enableFrictionReduction=!1}d.prototype.createContactEquation=function(e,t,o,i,n,r){var s;this.contactPointPool.length?((s=this.contactPointPool.pop()).bi=e,s.bj=t):s=new h(e,t),s.enabled=e.collisionResponse&&t.collisionResponse&&o.collisionResponse&&i.collisionResponse;var a=this.currentContactMaterial;s.restitution=a.restitution,s.setSpookParams(a.contactEquationStiffness,a.contactEquationRelaxation,this.world.dt);var l=o.material||e.material,c=i.material||t.material;return l&&c&&l.restitution>=0&&c.restitution>=0&&(s.restitution=l.restitution*c.restitution),s.si=n||o,s.sj=r||i,s},d.prototype.createFrictionEquationsFromContact=function(e,t){var o=e.bi,i=e.bj,n=e.si,r=e.sj,s=this.world,a=this.currentContactMaterial,l=a.friction,c=n.material||o.material,u=r.material||i.material;if(c&&u&&c.friction>=0&&u.friction>=0&&(l=c.friction*u.friction),l>0){var h=l*s.gravity.length(),d=o.invMass+i.invMass;d>0&&(d=1/d);var p=this.frictionEquationPool,f=p.length?p.pop():new g(o,i,h*d),m=p.length?p.pop():new g(o,i,h*d);return f.bi=m.bi=o,f.bj=m.bj=i,f.minForce=m.minForce=-h*d,f.maxForce=m.maxForce=h*d,f.ri.copy(e.ri),f.rj.copy(e.rj),m.ri.copy(e.ri),m.rj.copy(e.rj),e.ni.tangents(f.t,m.t),f.setSpookParams(a.frictionEquationStiffness,a.frictionEquationRelaxation,s.dt),m.setSpookParams(a.frictionEquationStiffness,a.frictionEquationRelaxation,s.dt),f.enabled=m.enabled=e.enabled,t.push(f,m),!0}return!1};var p=new a,f=new a,m=new a;d.prototype.createFrictionFromAverage=function(e){var t=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(t,this.frictionResult)&&1!==e){var o=this.frictionResult[this.frictionResult.length-2],i=this.frictionResult[this.frictionResult.length-1];p.setZero(),f.setZero(),m.setZero();for(var n=t.bi,r=(t.bj,0);r!==e;r++)(t=this.result[this.result.length-1-r]).bodyA!==n?(p.vadd(t.ni,p),f.vadd(t.ri,f),m.vadd(t.rj,m)):(p.vsub(t.ni,p),f.vadd(t.rj,f),m.vadd(t.ri,m));var s=1/e;f.scale(s,o.ri),m.scale(s,o.rj),i.ri.copy(o.ri),i.rj.copy(o.rj),p.normalize(),p.tangents(o.t,i.t)}};var y=new a,v=new a,E=new c,_=new c;d.prototype.getContacts=function(e,t,o,i,r,s,a){this.contactPointPool=r,this.frictionEquationPool=a,this.result=i,this.frictionResult=s;for(var l=E,c=_,u=y,h=v,g=0,d=e.length;g!==d;g++){var p=e[g],f=t[g],m=null;p.material&&f.material&&(m=o.getContactMaterial(p.material,f.material)||null);for(var T=p.type&n.KINEMATIC&&f.type&n.STATIC||p.type&n.STATIC&&f.type&n.KINEMATIC||p.type&n.KINEMATIC&&f.type&n.KINEMATIC,b=0;b<p.shapes.length;b++){p.quaternion.mult(p.shapeOrientations[b],l),p.quaternion.vmult(p.shapeOffsets[b],u),u.vadd(p.position,u);for(var M=p.shapes[b],A=0;A<f.shapes.length;A++){f.quaternion.mult(f.shapeOrientations[A],c),f.quaternion.vmult(f.shapeOffsets[A],h),h.vadd(f.position,h);var S=f.shapes[A];if(!(u.distanceTo(h)>M.boundingSphereRadius+S.boundingSphereRadius)){var w=null;M.material&&S.material&&(w=o.getContactMaterial(M.material,S.material)||null),this.currentContactMaterial=w||m||o.defaultContactMaterial;var C=this[M.type|S.type];if(C){(M.type<S.type?C.call(this,M,S,u,h,l,c,p,f,M,S,T):C.call(this,S,M,h,u,c,l,f,p,M,S,T))&&T&&(o.shapeOverlapKeeper.set(M.id,S.id),o.bodyOverlapKeeper.set(p.id,f.id))}}}}}};d.prototype[r.types.BOX|r.types.BOX]=d.prototype.boxBox=function(e,t,o,i,n,r,s,a,l,c,u){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,o,i,n,r,s,a,e,t,u)},d.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(e,t,o,i,n,r,s,a,l,c,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,o,i,n,r,s,a,e,t,u)},d.prototype[r.types.BOX|r.types.PARTICLE]=d.prototype.boxParticle=function(e,t,o,i,n,r,s,a,l,c,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,o,i,n,r,s,a,e,t,u)},d.prototype[r.types.SPHERE]=d.prototype.sphereSphere=function(e,t,o,i,n,r,s,a,l,c,u){if(u)return o.distanceSquared(i)<Math.pow(e.radius+t.radius,2);var h=this.createContactEquation(s,a,e,t,l,c);i.vsub(o,h.ni),h.ni.normalize(),h.ri.copy(h.ni),h.rj.copy(h.ni),h.ri.mult(e.radius,h.ri),h.rj.mult(-t.radius,h.rj),h.ri.vadd(o,h.ri),h.ri.vsub(s.position,h.ri),h.rj.vadd(i,h.rj),h.rj.vsub(a.position,h.rj),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)};var T=new a,b=new a,M=new a;d.prototype[r.types.PLANE|r.types.TRIMESH]=d.prototype.planeTrimesh=function(e,t,o,i,n,r,s,c,u,h,g){var d=new a,p=T;p.set(0,0,1),n.vmult(p,p);for(var f=0;f<t.vertices.length/3;f++){t.getVertex(f,d);var m=new a;m.copy(d),l.pointToWorldFrame(i,r,m,d);var y=b;if(d.vsub(o,y),p.dot(y)<=0){if(g)return!0;var v=this.createContactEquation(s,c,e,t,u,h);v.ni.copy(p);var E=M;p.scale(y.dot(p),E),d.vsub(E,E),v.ri.copy(E),v.ri.vsub(s.position,v.ri),v.rj.copy(d),v.rj.vsub(c.position,v.rj),this.result.push(v),this.createFrictionEquationsFromContact(v,this.frictionResult)}}};var A=new a,S=new a,w=(new a,new a),C=new a,N=new a,L=new a,I=new a,R=new a,D=new a,x=new a,O=new a,k=new a,B=new a,P=new i,U=[];d.prototype[r.types.SPHERE|r.types.TRIMESH]=d.prototype.sphereTrimesh=function(e,t,o,i,n,r,a,c,u,h,g){var d=N,p=L,f=I,m=R,y=D,v=x,E=P,_=C,T=S,b=U;l.pointToLocalFrame(i,r,o,y);var M=e.radius;E.lowerBound.set(y.x-M,y.y-M,y.z-M),E.upperBound.set(y.x+M,y.y+M,y.z+M),t.getTrianglesInAABB(E,b);for(var F=w,H=e.radius*e.radius,j=0;j<b.length;j++)for(var z=0;z<3;z++)if(t.getVertex(t.indices[3*b[j]+z],F),F.vsub(y,T),T.norm2()<=H){if(_.copy(F),l.pointToWorldFrame(i,r,_,F),F.vsub(o,T),g)return!0;(W=this.createContactEquation(a,c,e,t,u,h)).ni.copy(T),W.ni.normalize(),W.ri.copy(W.ni),W.ri.scale(e.radius,W.ri),W.ri.vadd(o,W.ri),W.ri.vsub(a.position,W.ri),W.rj.copy(F),W.rj.vsub(c.position,W.rj),this.result.push(W),this.createFrictionEquationsFromContact(W,this.frictionResult)}for(j=0;j<b.length;j++)for(z=0;z<3;z++){t.getVertex(t.indices[3*b[j]+z],d),t.getVertex(t.indices[3*b[j]+(z+1)%3],p),p.vsub(d,f),y.vsub(p,v);var V=v.dot(f);y.vsub(d,v);var G=v.dot(f);if(G>0&&V<0)if(y.vsub(d,v),m.copy(f),m.normalize(),G=v.dot(m),m.scale(G,v),v.vadd(d,v),(J=v.distanceTo(y))<e.radius){if(g)return!0;var W=this.createContactEquation(a,c,e,t,u,h);v.vsub(y,W.ni),W.ni.normalize(),W.ni.scale(e.radius,W.ri),l.pointToWorldFrame(i,r,v,v),v.vsub(c.position,W.rj),l.vectorToWorldFrame(r,W.ni,W.ni),l.vectorToWorldFrame(r,W.ri,W.ri),this.result.push(W),this.createFrictionEquationsFromContact(W,this.frictionResult)}}for(var Y=O,X=k,K=B,Q=A,q=(j=0,b.length);j!==q;j++){t.getTriangleVertices(b[j],Y,X,K),t.getNormal(b[j],Q),y.vsub(Y,v);var J=v.dot(Q);if(Q.scale(J,v),y.vsub(v,v),J=v.distanceTo(y),s.pointInTriangle(v,Y,X,K)&&J<e.radius){if(g)return!0;W=this.createContactEquation(a,c,e,t,u,h);v.vsub(y,W.ni),W.ni.normalize(),W.ni.scale(e.radius,W.ri),l.pointToWorldFrame(i,r,v,v),v.vsub(c.position,W.rj),l.vectorToWorldFrame(r,W.ni,W.ni),l.vectorToWorldFrame(r,W.ri,W.ri),this.result.push(W),this.createFrictionEquationsFromContact(W,this.frictionResult)}}b.length=0};var F=new a,H=new a;d.prototype[r.types.SPHERE|r.types.PLANE]=d.prototype.spherePlane=function(e,t,o,i,n,r,s,a,l,c,u){var h=this.createContactEquation(s,a,e,t,l,c);if(h.ni.set(0,0,1),r.vmult(h.ni,h.ni),h.ni.negate(h.ni),h.ni.normalize(),h.ni.mult(e.radius,h.ri),o.vsub(i,F),h.ni.mult(h.ni.dot(F),H),F.vsub(H,h.rj),-F.dot(h.ni)<=e.radius){if(u)return!0;var g=h.ri,d=h.rj;g.vadd(o,g),g.vsub(s.position,g),d.vadd(i,d),d.vsub(a.position,d),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}};var j=new a,z=new a,V=new a;function G(e,t,o){for(var i=null,n=e.length,r=0;r!==n;r++){var s=e[r],a=j;e[(r+1)%n].vsub(s,a);var l=z;a.cross(t,l);var c=V;o.vsub(s,c);var u=l.dot(c);if(!(null===i||u>0&&!0===i||u<=0&&!1===i))return!1;null===i&&(i=u>0)}return!0}var W=new a,Y=new a,X=new a,K=new a,Q=[new a,new a,new a,new a,new a,new a],q=new a,J=new a,$=new a,Z=new a;d.prototype[r.types.SPHERE|r.types.BOX]=d.prototype.sphereBox=function(e,t,o,i,n,r,s,a,l,c,u){var h=this.v3pool,g=Q;o.vsub(i,W),t.getSideNormals(g,r);for(var d=e.radius,p=!1,f=J,m=$,y=Z,v=null,E=0,_=0,T=0,b=null,M=0,A=g.length;M!==A&&!1===p;M++){var S=Y;S.copy(g[M]);var w=S.norm();S.normalize();var C=W.dot(S);if(C<w+d&&C>0){var N=X,L=K;N.copy(g[(M+1)%3]),L.copy(g[(M+2)%3]);var I=N.norm(),R=L.norm();N.normalize(),L.normalize();var D=W.dot(N),x=W.dot(L);if(D<I&&D>-I&&x<R&&x>-R){var O=Math.abs(C-w-d);if((null===b||O<b)&&(b=O,_=D,T=x,v=w,f.copy(S),m.copy(N),y.copy(L),E++,u))return!0}}}if(E){p=!0;var k=this.createContactEquation(s,a,e,t,l,c);f.mult(-d,k.ri),k.ni.copy(f),k.ni.negate(k.ni),f.mult(v,f),m.mult(_,m),f.vadd(m,f),y.mult(T,y),f.vadd(y,k.rj),k.ri.vadd(o,k.ri),k.ri.vsub(s.position,k.ri),k.rj.vadd(i,k.rj),k.rj.vsub(a.position,k.rj),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult)}for(var B=h.get(),P=q,U=0;2!==U&&!p;U++)for(var F=0;2!==F&&!p;F++)for(var H=0;2!==H&&!p;H++)if(B.set(0,0,0),U?B.vadd(g[0],B):B.vsub(g[0],B),F?B.vadd(g[1],B):B.vsub(g[1],B),H?B.vadd(g[2],B):B.vsub(g[2],B),i.vadd(B,P),P.vsub(o,P),P.norm2()<d*d){if(u)return!0;p=!0,(k=this.createContactEquation(s,a,e,t,l,c)).ri.copy(P),k.ri.normalize(),k.ni.copy(k.ri),k.ri.mult(d,k.ri),k.rj.copy(B),k.ri.vadd(o,k.ri),k.ri.vsub(s.position,k.ri),k.rj.vadd(i,k.rj),k.rj.vsub(a.position,k.rj),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult)}h.release(B),B=null;var j=h.get(),z=h.get(),V=(k=h.get(),h.get()),G=(O=h.get(),g.length);for(U=0;U!==G&&!p;U++)for(F=0;F!==G&&!p;F++)if(U%3!=F%3){g[F].cross(g[U],j),j.normalize(),g[U].vadd(g[F],z),k.copy(o),k.vsub(z,k),k.vsub(i,k);var ee=k.dot(j);j.mult(ee,V);for(H=0;H===U%3||H===F%3;)H++;O.copy(o),O.vsub(V,O),O.vsub(z,O),O.vsub(i,O);var te=Math.abs(ee),oe=O.norm();if(te<g[H].norm()&&oe<d){if(u)return!0;p=!0;var ie=this.createContactEquation(s,a,e,t,l,c);z.vadd(V,ie.rj),ie.rj.copy(ie.rj),O.negate(ie.ni),ie.ni.normalize(),ie.ri.copy(ie.rj),ie.ri.vadd(i,ie.ri),ie.ri.vsub(o,ie.ri),ie.ri.normalize(),ie.ri.mult(d,ie.ri),ie.ri.vadd(o,ie.ri),ie.ri.vsub(s.position,ie.ri),ie.rj.vadd(i,ie.rj),ie.rj.vsub(a.position,ie.rj),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult)}}h.release(j,z,k,V,O)};var ee=new a,te=new a,oe=new a,ie=new a,ne=new a,re=new a,se=new a,ae=new a,le=new a,ce=new a;d.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(e,t,o,i,n,r,s,a,l,c,u){var h=this.v3pool;o.vsub(i,ee);for(var g=t.faceNormals,d=t.faces,p=t.vertices,f=e.radius,m=0;m!==p.length;m++){var y=p[m],v=ne;r.vmult(y,v),i.vadd(v,v);var E=ie;if(v.vsub(o,E),E.norm2()<f*f)return!!u||(_=!0,(O=this.createContactEquation(s,a,e,t,l,c)).ri.copy(E),O.ri.normalize(),O.ni.copy(O.ri),O.ri.mult(f,O.ri),v.vsub(i,O.rj),O.ri.vadd(o,O.ri),O.ri.vsub(s.position,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(a.position,O.rj),this.result.push(O),void this.createFrictionEquationsFromContact(O,this.frictionResult))}for(var _=!1,T=(m=0,d.length);m!==T&&!1===_;m++){var b=g[m],M=d[m],A=re;r.vmult(b,A);var S=se;r.vmult(p[M[0]],S),S.vadd(i,S);var w=ae;A.mult(-f,w),o.vadd(w,w);var C=le;w.vsub(S,C);var N=C.dot(A),L=ce;if(o.vsub(S,L),N<0&&L.dot(A)>0){for(var I=[],R=0,D=M.length;R!==D;R++){var x=h.get();r.vmult(p[M[R]],x),i.vadd(x,x),I.push(x)}if(G(I,A,o)){if(u)return!0;_=!0;var O=this.createContactEquation(s,a,e,t,l,c);A.mult(-f,O.ri),A.negate(O.ni);var k=h.get();A.mult(-N,k);var B=h.get();A.mult(-f,B),o.vsub(i,O.rj),O.rj.vadd(B,O.rj),O.rj.vadd(k,O.rj),O.rj.vadd(i,O.rj),O.rj.vsub(a.position,O.rj),O.ri.vadd(o,O.ri),O.ri.vsub(s.position,O.ri),h.release(k),h.release(B),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult);R=0;for(var P=I.length;R!==P;R++)h.release(I[R]);return}for(R=0;R!==M.length;R++){var U=h.get(),F=h.get();r.vmult(p[M[(R+1)%M.length]],U),r.vmult(p[M[(R+2)%M.length]],F),i.vadd(U,U),i.vadd(F,F);var H=te;F.vsub(U,H);var j=oe;H.unit(j);var z=h.get(),V=h.get();o.vsub(U,V);var W=V.dot(j);j.mult(W,z),z.vadd(U,z);var Y=h.get();if(z.vsub(o,Y),W>0&&W*W<H.norm2()&&Y.norm2()<f*f){if(u)return!0;O=this.createContactEquation(s,a,e,t,l,c);z.vsub(i,O.rj),z.vsub(o,O.ni),O.ni.normalize(),O.ni.mult(f,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(a.position,O.rj),O.ri.vadd(o,O.ri),O.ri.vsub(s.position,O.ri),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult);for(R=0,P=I.length;R!==P;R++)h.release(I[R]);return h.release(U),h.release(F),h.release(z),h.release(Y),void h.release(V)}h.release(U),h.release(F),h.release(z),h.release(Y),h.release(V)}for(R=0,P=I.length;R!==P;R++)h.release(I[R])}}};new a,new a;d.prototype[r.types.PLANE|r.types.BOX]=d.prototype.planeBox=function(e,t,o,i,n,r,s,a,l,c,u){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,o,i,n,r,s,a,e,t,u)};var ue=new a,he=new a,ge=new a,de=new a;d.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(e,t,o,i,n,r,s,a,l,c,u){var h=ue,g=he;g.set(0,0,1),n.vmult(g,g);for(var d=0,p=ge,f=0;f!==t.vertices.length;f++){if(h.copy(t.vertices[f]),r.vmult(h,h),i.vadd(h,h),h.vsub(o,p),g.dot(p)<=0){if(u)return!0;var m=this.createContactEquation(s,a,e,t,l,c),y=de;g.mult(g.dot(p),y),h.vsub(y,y),y.vsub(o,m.ri),m.ni.copy(g),h.vsub(i,m.rj),m.ri.vadd(o,m.ri),m.ri.vsub(s.position,m.ri),m.rj.vadd(i,m.rj),m.rj.vsub(a.position,m.rj),this.result.push(m),d++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(m,this.frictionResult)}}this.enableFrictionReduction&&d&&this.createFrictionFromAverage(d)};var pe=new a,fe=new a;d.prototype[r.types.CONVEXPOLYHEDRON]=d.prototype.convexConvex=function(e,t,o,i,n,r,s,a,l,c,u,h,g){var d=pe;if(!(o.distanceTo(i)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,o,n,i,r,d,h,g)){var p=[],f=fe;e.clipAgainstHull(o,n,t,i,r,d,-100,100,p);for(var m=0,y=0;y!==p.length;y++){if(u)return!0;var v=this.createContactEquation(s,a,e,t,l,c),E=v.ri,_=v.rj;d.negate(v.ni),p[y].normal.negate(f),f.mult(p[y].depth,f),p[y].point.vadd(f,E),_.copy(p[y].point),E.vsub(o,E),_.vsub(i,_),E.vadd(o,E),E.vsub(s.position,E),_.vadd(i,_),_.vsub(a.position,_),this.result.push(v),m++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(v,this.frictionResult)}this.enableFrictionReduction&&m&&this.createFrictionFromAverage(m)}};var me=new a,ye=new a,ve=new a;d.prototype[r.types.PLANE|r.types.PARTICLE]=d.prototype.planeParticle=function(e,t,o,i,n,r,s,a,l,c,u){var h=me;h.set(0,0,1),s.quaternion.vmult(h,h);var g=ye;if(i.vsub(s.position,g),h.dot(g)<=0){if(u)return!0;var d=this.createContactEquation(a,s,t,e,l,c);d.ni.copy(h),d.ni.negate(d.ni),d.ri.set(0,0,0);var p=ve;h.mult(h.dot(i),p),i.vsub(p,p),d.rj.copy(p),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult)}};var Ee=new a;d.prototype[r.types.PARTICLE|r.types.SPHERE]=d.prototype.sphereParticle=function(e,t,o,i,n,r,s,a,l,c,u){var h=Ee;if(h.set(0,0,1),i.vsub(o,h),h.norm2()<=e.radius*e.radius){if(u)return!0;var g=this.createContactEquation(a,s,t,e,l,c);h.normalize(),g.rj.copy(h),g.rj.mult(e.radius,g.rj),g.ni.copy(h),g.ni.negate(g.ni),g.ri.set(0,0,0),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}};var _e=new c,Te=new a,be=(new a,new a),Me=new a,Ae=new a;d.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(e,t,o,i,n,r,s,a,l,c,u){var h=-1,g=be,d=Ae,p=null,f=Te;if(f.copy(i),f.vsub(o,f),n.conjugate(_e),_e.vmult(f,f),e.pointIsInside(f)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(o,n),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(n);for(var m=0,y=e.faces.length;m!==y;m++){var v=[e.worldVertices[e.faces[m][0]]],E=e.worldFaceNormals[m];i.vsub(v[0],Me);var _=-E.dot(Me);if(null===p||Math.abs(_)<Math.abs(p)){if(u)return!0;p=_,h=m,g.copy(E),0}}if(-1!==h){var T=this.createContactEquation(a,s,t,e,l,c);g.mult(p,d),d.vadd(i,d),d.vsub(o,d),T.rj.copy(d),g.negate(T.ni),T.ri.set(0,0,0);var b=T.ri,M=T.rj;b.vadd(i,b),b.vsub(a.position,b),M.vadd(o,M),M.vsub(s.position,M),this.result.push(T),this.createFrictionEquationsFromContact(T,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},d.prototype[r.types.BOX|r.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(e,t,o,i,n,r,s,a,l,c,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,o,i,n,r,s,a,e,t,u)};var Se=new a,we=new a,Ce=[0];d.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(e,t,o,i,n,r,s,a,c,u,h){var g=t.data,d=t.elementSize,p=e.boundingSphereRadius,f=we,m=Ce,y=Se;l.pointToLocalFrame(i,r,o,y);var v=Math.floor((y.x-p)/d)-1,E=Math.ceil((y.x+p)/d)+1,_=Math.floor((y.y-p)/d)-1,T=Math.ceil((y.y+p)/d)+1;if(!(E<0||T<0||v>g.length||_>g[0].length)){v<0&&(v=0),E<0&&(E=0),_<0&&(_=0),T<0&&(T=0),v>=g.length&&(v=g.length-1),E>=g.length&&(E=g.length-1),T>=g[0].length&&(T=g[0].length-1),_>=g[0].length&&(_=g[0].length-1);var b=[];t.getRectMinMax(v,_,E,T,b);var M=b[0],A=b[1];if(!(y.z-p>A||y.z+p<M))for(var S=v;S<E;S++)for(var w=_;w<T;w++){var C=!1;if(t.getConvexTrianglePillar(S,w,!1),l.pointToWorldFrame(i,r,t.pillarOffset,f),o.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(C=this.convexConvex(e,t.pillarConvex,o,f,n,r,s,a,null,null,h,m,null)),h&&C)return!0;if(t.getConvexTrianglePillar(S,w,!0),l.pointToWorldFrame(i,r,t.pillarOffset,f),o.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(C=this.convexConvex(e,t.pillarConvex,o,f,n,r,s,a,null,null,h,m,null)),h&&C)return!0}}};var Ne=new a,Le=new a;d.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(e,t,o,i,n,r,s,a,c,u,h){var g=t.data,d=e.radius,p=t.elementSize,f=Le,m=Ne;l.pointToLocalFrame(i,r,o,m);var y=Math.floor((m.x-d)/p)-1,v=Math.ceil((m.x+d)/p)+1,E=Math.floor((m.y-d)/p)-1,_=Math.ceil((m.y+d)/p)+1;if(!(v<0||_<0||y>g.length||_>g[0].length)){y<0&&(y=0),v<0&&(v=0),E<0&&(E=0),_<0&&(_=0),y>=g.length&&(y=g.length-1),v>=g.length&&(v=g.length-1),_>=g[0].length&&(_=g[0].length-1),E>=g[0].length&&(E=g[0].length-1);var T=[];t.getRectMinMax(y,E,v,_,T);var b=T[0],M=T[1];if(!(m.z-d>M||m.z+d<b))for(var A=this.result,S=y;S<v;S++)for(var w=E;w<_;w++){var C=A.length,N=!1;if(t.getConvexTrianglePillar(S,w,!1),l.pointToWorldFrame(i,r,t.pillarOffset,f),o.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(N=this.sphereConvex(e,t.pillarConvex,o,f,n,r,s,a,e,t,h)),h&&N)return!0;if(t.getConvexTrianglePillar(S,w,!0),l.pointToWorldFrame(i,r,t.pillarOffset,f),o.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(N=this.sphereConvex(e,t.pillarConvex,o,f,n,r,s,a,e,t,h)),h&&N)return!0;if(A.length-C>2)return}}}},function(e,t,o){e.exports=r;var i=o(1),n=o(0);function r(){i.call(this),this.type=i.types.PLANE,this.worldNormal=new n,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}r.prototype=new i,r.prototype.constructor=r,r.prototype.computeWorldNormal=function(e){var t=this.worldNormal;t.set(0,0,1),e.vmult(t,t),this.worldNormalNeedsUpdate=!1},r.prototype.calculateLocalInertia=function(e,t){return t=t||new n},r.prototype.volume=function(){return Number.MAX_VALUE};var s=new n;r.prototype.calculateWorldAABB=function(e,t,o,i){s.set(0,0,1),t.vmult(s,s);var n=Number.MAX_VALUE;o.set(-n,-n,-n),i.set(n,n,n),1===s.x&&(i.x=e.x),1===s.y&&(i.y=e.y),1===s.z&&(i.z=e.z),-1===s.x&&(o.x=e.x),-1===s.y&&(o.y=e.y),-1===s.z&&(o.z=e.z)},r.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},function(e,t){function o(){this.matrix=[]}e.exports=o,o.prototype.get=function(e,t){if(e=e.index,(t=t.index)>e){var o=t;t=e,e=o}return this.matrix[(e*(e+1)>>1)+t-1]},o.prototype.set=function(e,t,o){if(e=e.index,(t=t.index)>e){var i=t;t=e,e=i}this.matrix[(e*(e+1)>>1)+t-1]=o?1:0},o.prototype.reset=function(){for(var e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0},o.prototype.setNumObjects=function(e){this.matrix.length=e*(e-1)>>1}},function(e,t,o){"use strict";o.r(t);const i={},n=Handlebars.compile(o(148));AFRAME.registerComponent("scene-panel",{schema:{name:{default:"Object"},type:{default:"obj"}},init:function(){let e=this;this.el.id||(this.el.id=Math.random().toString(16).substr(2)),this.id=this.el.id,this.$el=$(n({id:this.id,name:this.data.name,type:this.data.type})),this.$sceneTab=$("#scene-tab-"+this.data.type).prepend(this.$el),$("#scene-col-"+this.data.type).prepend('<a href="#" class="collection-item" data-type="env" id="scene-panel-col-'+this.id+'"><i class="fa fa-cube"></i> '+this.data.name+"</a>"),i[this.id]=new class{constructor(e,t){this.lastRot=0,this.canvas=e,this.obj=t,this.scene=new THREE.Scene,this.resize(),this.VIEW_ANGLE=45,this.ASPECT=this.SCREEN_WIDTH/this.SCREEN_HEIGHT,this.NEAR=.1,this.FAR=2e4,this.camera=new THREE.PerspectiveCamera(this.VIEW_ANGLE,this.ASPECT,this.NEAR,this.FAR),this.scene.add(this.camera),window.WebGLRenderingContext?this.renderer=new THREE.WebGLRenderer({antialias:!0,canvas:this.canvas}):this.renderer=new THREE.CanvasRenderer({canvas:this.canvas}),this.renderer.setSize(this.SCREEN_WIDTH,this.SCREEN_HEIGHT),this.light=new THREE.PointLight(16777215),this.light.position.set(0,15e3,1e4),this.scene.add(this.light),this.light2=new THREE.AmbientLight(4473924),this.scene.add(this.light2),this.objMesh=new THREE.Mesh(this.obj.object3DMap.mesh.geometry.clone(),this.obj.object3DMap.mesh.material.clone()),this.scene.add(this.objMesh),this.objMesh.geometry.computeBoundingSphere();let o=this.objMesh.geometry.boundingSphere.radius;this.camera.position.set(0,1*o,3*o),this.camera.lookAt(this.scene.position),this.rotVec=new THREE.Vector3(0,1,0),this.obj.addEventListener("materialtextureloaded",()=>{this.objMesh.material=this.obj.object3DMap.mesh.material.clone(),"a-sky"===this.obj.localName&&(this.objMesh.material.side=THREE.BackSide)}),"a-plane"===this.obj.localName&&(this.camera.position.set(0,1.6,0),this.camera.lookAt(new THREE.Vector3(0,0,o)),this.objMesh.rotateX(Math.PI/2*3),this.rotVec=new THREE.Vector3(0,0,1)),"a-sky"===this.obj.localName&&(this.camera.position.set(0,0,0),this.camera.lookAt(new THREE.Vector3(0,0,1)),this.objMesh.material.side=THREE.BackSide,window.Sky=this),this.animate()}resize(){this.canvas.style.width="100%",this.SCREEN_WIDTH=this.canvas.offsetWidth,this.SCREEN_HEIGHT=this.SCREEN_WIDTH*(9/16),this.canvas.style.height=this.SCREEN_HEIGHT+"px",this.canvas.setAttribute("width",this.SCREEN_WIDTH),this.canvas.setAttribute("height",this.SCREEN_HEIGHT),this.renderer&&this.renderer.setSize(this.SCREEN_WIDTH,this.SCREEN_HEIGHT)}animate(){if(requestAnimationFrame(()=>this.animate()),!(this.canvas.offsetWidth||this.canvas.offsetHeight||this.canvas.getClientRects().length))return;this.renderer.render(this.scene,this.camera);let e=Date.now();e-this.lastRot>30&&(this.lastRot=e,this.objMesh.rotateOnAxis(this.rotVec,.01))}remove(){}}($("#scene-panel-card-"+this.id+" .obj-preview").get(0),this.el),$("#scene-panel-card-"+this.id+" .card-image, #scene-panel-col-"+this.id).click(function(t){t.preventDefault(),$('.scene-tabs a[href="#scene-tab-'+e.data.type+'"]').click(),"card-title"!==t.target.className&&(e.$el.hasClass("active")?(e.$el.removeClass("active"),e.el.components["obj-config"].hide()):(e.$sceneTab.parent().find("div.active").removeClass("active"),e.$el.addClass("active"),e.el.components["obj-config"].show()))}),$("#scene-panel-card-"+this.id+" i").tooltip(),$("#scene-panel-card-"+this.id+" .card-title").keyup(function(t){e.el.setAttribute("scene-panel",{name:$(this).text().trim(),type:e.data.type}),e.el.dispatchEvent(new CustomEvent("updateName",{detail:$(this).text().trim()}))}),e.el.dispatchEvent(new CustomEvent("updateName",{detail:$(this).text().trim()})),this.$toggleVis=$("#scene-panel-card-"+this.id+" .toggle-vis"),this.$toggleVis.click(function(){e.el.setAttribute("visible",!e.el.components.visible.data)}),this.el.addEventListener("toggleVisible",function(t){e.$toggleVis.removeClass(t.detail?"fa-eye-slash":"fa-eye"),e.$toggleVis.addClass(t.detail?"fa-eye":"fa-eye-slash")}),this.$toggleGrav=$("#scene-panel-card-"+this.id+" .toggle-grav"),this.$toggleGrav.click(function(){let t=e.el.hasAttribute("dynamic-body");e.el.removeAttribute(t?"dynamic-body":"static-body"),e.el.setAttribute(t?"static-body":"dynamic-body","")}),this.el.addEventListener("toggleGravity",function(t){t.detail?e.$toggleGrav.addClass("green-text"):e.$toggleGrav.removeClass("green-text")}),$("#scene-panel-card-"+this.id+" .rename").click(()=>{$("#scene-panel-card-"+this.id+" .card-title").focus()})},remove:function(){i[this.id].remove(),delete i[this.id],$("#scene-panel-card-"+this.id).parent().remove()},tick:function(e,t){}}),$(document).ready(function(){const e=$("ul.scene-tabs"),t=function(t){for(let e in i)i[e].resize();e.trigger("resize");let o=0;$("#left-view-bottom .card:not(.add-obj)").each(function(){o=Math.max(o,$(this).height())}),$("#left-view-bottom .card.add-obj").height(o)};window.addEventListener("resize",t,!1),window.splitEvents.onDrag.push(t),t(),e.tabs({onShow:t}),$(".add-obj").click(function(e){let t=Math.random().toString(16).substr(2),o=$('<a-entity id="'+t+'" geometry="primitive: box;" scene-panel="name:New Object;" blockly static-body obj-config custom-events></a-entity>');$("a-scene").append(o),setTimeout(function(){$("#scene-panel-card-"+t+" .card-image").click(),setTimeout(function(){$("#settings-"+t).click()},50)},50)})})},function(e,t){var o,i,n=function(e,t){this.geometry=new THREE.BufferGeometry,this.vertices=new Float32Array(3*e*2),this.uvs=new Float32Array(2*e*2),this.width=t,this.geometry.addAttribute("position",new THREE.BufferAttribute(this.vertices,3).setDynamic(!0)),this.material=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16711680}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.drawMode=THREE.TriangleStripDrawMode,this.mesh.frustumCulled=!1,this.mesh.vertices=this.vertices,this.direction=new THREE.Vector3,this.numPoints=e};n.prototype={setDirection:function(e){var t=new THREE.Vector3(0,1,0);this.direction.copy(e).cross(t).normalize().multiplyScalar(this.width/2)},setWidth:function(e){this.width=e},setPoint:(o=new THREE.Vector3,i=new THREE.Vector3,function(e,t){o.copy(t).add(this.direction),i.copy(t).sub(this.direction);var n=6*e;this.vertices[n++]=o.x,this.vertices[n++]=o.y,this.vertices[n++]=o.z,this.vertices[n++]=i.x,this.vertices[n++]=i.y,this.vertices[n++]=i.z,this.geometry.attributes.position.needsUpdate=!0})},e.exports=n},function(e,t){function o(e,t,o,i){return e+t*i+.5*o*i*i}e.exports=function(e,t,i,n,r){return r.x=o(e.x,t.x,i.x,n),r.y=o(e.y,t.y,i.y,n),r.z=o(e.z,t.z,i.z,n),r}},function(e,t){e.exports="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAQCAYAAADXnxW3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAADJJREFUeNpEx7ENgDAAAzArK0JA6f8X9oewlcWStU1wBGdwB08wgjeYm79jc2nbYH0DAC/+CORJxO5fAAAAAElFTkSuQmCC)"},function(e,t,o){var i,n,r,s,a,l,c,u,h,g,d,p=o(43),f=o(42),m=o(41);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),o=t.length;--o>=0&&t.item(o)!==this;);return o>-1}),AFRAME.registerComponent("teleport-controls",{schema:{type:{default:"parabolic",oneOf:["parabolic","line"]},button:{default:"trackpad",oneOf:["trackpad","trigger","grip","menu"]},startEvents:{type:"array"},endEvents:{type:"array"},collisionEntities:{default:""},hitEntity:{type:"selector"},cameraRig:{type:"selector"},teleportOrigin:{type:"selector"},hitCylinderColor:{type:"color",default:"#99ff99"},hitCylinderRadius:{default:.25,min:0},hitCylinderHeight:{default:.3,min:0},maxLength:{default:10,min:0,if:{type:["line"]}},curveNumberPoints:{default:30,min:2,if:{type:["parabolic"]}},curveLineWidth:{default:.025},curveHitColor:{type:"color",default:"#99ff99"},curveMissColor:{type:"color",default:"#ff0000"},curveShootingSpeed:{default:5,min:0,if:{type:["parabolic"]}},defaultPlaneSize:{default:100},landingNormal:{type:"vec3",default:"0 1 0"},landingMaxAngle:{default:"45",min:0,max:360}},init:function(){var e,t,o,i,n=this.data,r=this.el;if(this.active=!1,this.obj=r.object3D,this.hitPoint=new THREE.Vector3,this.rigWorldPosition=new THREE.Vector3,this.newRigWorldPosition=new THREE.Vector3,this.teleportEventDetail={oldPosition:this.rigWorldPosition,newPosition:this.newRigWorldPosition,hitPoint:this.hitPoint},this.hit=!1,this.prevHitHeight=0,this.referenceNormal=new THREE.Vector3,this.curveMissColor=new THREE.Color,this.curveHitColor=new THREE.Color,this.raycaster=new THREE.Raycaster,this.defaultPlane=(this.data.defaultPlaneSize,(o=new THREE.PlaneBufferGeometry(100,100)).rotateX(-Math.PI/2),i=new THREE.MeshBasicMaterial({color:16776960}),new THREE.Mesh(o,i)),(e=this.teleportEntity=document.createElement("a-entity")).classList.add("teleportRay"),e.setAttribute("visible",!1),r.sceneEl.appendChild(this.teleportEntity),this.onButtonDown=this.onButtonDown.bind(this),this.onButtonUp=this.onButtonUp.bind(this),this.data.startEvents.length&&this.data.endEvents.length){for(t=0;t<this.data.startEvents.length;t++)r.addEventListener(this.data.startEvents[t],this.onButtonDown);for(t=0;t<this.data.endEvents.length;t++)r.addEventListener(this.data.endEvents[t],this.onButtonUp)}else r.addEventListener(n.button+"down",this.onButtonDown),r.addEventListener(n.button+"up",this.onButtonUp);this.queryCollisionEntities()},update:function(e){var t=this.data,o=AFRAME.utils.diff(t,e);this.referenceNormal.copy(t.landingNormal),this.curveMissColor.set(t.curveMissColor),this.curveHitColor.set(t.curveHitColor),(!this.line||"curveLineWidth"in o||"curveNumberPoints"in o||"type"in o)&&(this.line=function(e){var t="line"===e.type?2:e.curveNumberPoints;return new m(t,e.curveLineWidth)}(t),this.teleportEntity.setObject3D("mesh",this.line.mesh)),t.hitEntity?this.hitEntity=t.hitEntity:(!this.hitEntity||"hitCylinderColor"in o||"hitCylinderHeight"in o||"hitCylinderRadius"in o)&&(this.hitEntity&&this.hitEntity.parentNode.removeChild(this.hitEntity),this.hitEntity=function(e){var t,o,i;return(o=document.createElement("a-entity")).className="hitEntity",(i=document.createElement("a-entity")).setAttribute("geometry",{primitive:"torus",radius:e.hitCylinderRadius,radiusTubular:.01}),i.setAttribute("rotation",{x:90,y:0,z:0}),i.setAttribute("material",{shader:"flat",color:e.hitCylinderColor,side:"double",depthTest:!1}),o.appendChild(i),(t=document.createElement("a-entity")).setAttribute("position",{x:0,y:e.hitCylinderHeight/2,z:0}),t.setAttribute("geometry",{primitive:"cylinder",segmentsHeight:1,radius:e.hitCylinderRadius,height:e.hitCylinderHeight,openEnded:!0}),t.setAttribute("material",{shader:"flat",color:e.hitCylinderColor,side:"double",src:p,transparent:!0,depthTest:!1}),o.appendChild(t),o}(t),this.el.sceneEl.appendChild(this.hitEntity)),this.hitEntity.setAttribute("visible",!1),"collisionEntities"in o&&this.queryCollisionEntities()},remove:function(){var e=this.el,t=this.hitEntity,o=this.teleportEntity;t&&t.parentNode.removeChild(t),o&&o.parentNode.removeChild(o),e.sceneEl.removeEventListener("child-attached",this.childAttachHandler),e.sceneEl.removeEventListener("child-detached",this.childDetachHandler)},tick:(i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3(0,-9.8,0),s=new THREE.Vector3,a=new THREE.Vector3,l=new THREE.Quaternion,c=new THREE.Vector3,u=new THREE.Vector3,h=new THREE.Vector3,g=new THREE.Vector3,d=new THREE.Vector3,function(e,t){if(this.active){this.obj.matrixWorld.decompose(c,l,u);var o=h.set(0,0,-1).applyQuaternion(l).normalize();if(this.line.setDirection(d.copy(o)),this.obj.getWorldPosition(i),a.copy(i),this.teleportEntity.setAttribute("visible",!0),this.line.material.color.set(this.curveMissColor),this.hitEntity.setAttribute("visible",!1),this.hit=!1,"parabolic"===this.data.type){n.copy(o).multiplyScalar(this.data.curveShootingSpeed);for(var p=0;p<this.line.numPoints;p++){var m=p/(this.line.numPoints-1);f(i,n,r,m,s);var y=g.copy(s).sub(a).normalize();if(this.raycaster.far=y.length(),this.raycaster.set(a,y),this.checkMeshCollisions(p,s))break;a.copy(s)}}else"line"===this.data.type&&(s.copy(a).add(d.copy(o).multiplyScalar(this.data.maxLength)),this.raycaster.far=this.data.maxLength,this.raycaster.set(i,o),this.line.setPoint(0,i),this.checkMeshCollisions(1,s))}}),queryCollisionEntities:function(){var e,t=this.data,o=this.el;t.collisionEntities?(e=[].slice.call(o.sceneEl.querySelectorAll(t.collisionEntities)),this.collisionEntities=e,this.childAttachHandler=function(o){o.detail.el.matches(t.collisionEntities)&&e.push(o.detail.el)},o.sceneEl.addEventListener("child-attached",this.childAttachHandler),this.childDetachHandler=function(o){var i;o.detail.el.matches(t.collisionEntities)&&-1!==(i=e.indexOf(o.detail.el))&&e.splice(i,1)},o.sceneEl.addEventListener("child-detached",this.childDetachHandler)):this.collisionEntities=[]},onButtonDown:function(){this.active=!0},onButtonUp:function(){const e=new THREE.Vector3,t=new THREE.Vector3,o=new THREE.Vector3,i=new THREE.Vector3;return function(n){if(!this.active)return;if(this.active=!1,this.hitEntity.setAttribute("visible",!1),this.teleportEntity.setAttribute("visible",!1),!this.hit)return;const r=this.data.cameraRig||this.el.sceneEl.camera.el;r.object3D.getWorldPosition(this.rigWorldPosition),this.newRigWorldPosition.copy(this.hitPoint);const s=this.data.teleportOrigin;if(s&&(s.object3D.getWorldPosition(e),this.newRigWorldPosition.sub(e).add(this.rigWorldPosition)),this.newRigWorldPosition.y=this.rigWorldPosition.y+this.hitPoint.y-this.prevHitHeight,this.prevHitHeight=this.hitPoint.y,t.copy(this.newRigWorldPosition),r.object3D.parent&&r.object3D.parent.worldToLocal(t),r.setAttribute("position",t),!this.data.cameraRig)for(var a=document.querySelectorAll("a-entity[tracked-controls]"),l=0;l<a.length;l++)a[l].object3D.getWorldPosition(i),o.copy(this.newRigWorldPosition).sub(this.rigWorldPosition).add(i),a[l].setAttribute("position",o);this.el.emit("teleported",this.teleportEventDetail)}}(),checkMeshCollisions:function(e,t){var o=this.collisionEntities.map(function(e){return e.getObject3D("mesh")}).filter(function(e){return e});o=o.length?o:[this.defaultPlane];var i=this.raycaster.intersectObjects(o,!0);if(i.length>0&&!this.hit&&this.isValidNormalsAngle(i[0].face.normal)){var n=i[0].point;this.line.material.color.set(this.curveHitColor),this.hitEntity.setAttribute("position",n),this.hitEntity.setAttribute("visible",!0),this.hit=!0,this.hitPoint.copy(i[0].point);for(var r=e;r<this.line.numPoints;r++)this.line.setPoint(r,this.hitPoint);return!0}return this.line.setPoint(e,t),!1},isValidNormalsAngle:function(e){var t=this.referenceNormal.angleTo(e);return THREE.Math.RAD2DEG*t<=this.data.landingMaxAngle}})},function(e,t){var o,i=e.exports.Primitive={defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius",radialSegments:"tube.radialSegments",closed:"tube.closed"}},n=e.exports.Component={schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){var e=this.el,t=this.data,o=e.components.material;if(t.path.length){var i=new THREE.CatmullRomCurve3(t.path.map(function(e){return e=e.split(" "),new THREE.Vector3(Number(e[0]),Number(e[1]),Number(e[2]))})),n=new THREE.TubeGeometry(i,t.segments,t.radius,t.radialSegments,t.closed);o||((o={}).material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(n,o.material),this.el.setObject3D("mesh",this.mesh)}else console.error("[a-tube] `path` property expected but not found.")},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}};e.exports.registerAll=(o=!1,function(e){o||((e=e||window.AFRAME).registerComponent("tube",n),e.registerPrimitive("a-tube",i),o=!0)})},function(e,t){var o,i=e.exports.Primitive={defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",color:"ocean.color",opacity:"ocean.opacity"}},n=e.exports.Component={schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){var e=this.el,t=this.data,o=e.components.material,i=new THREE.PlaneGeometry(t.width,t.depth,t.density,t.density);i.mergeVertices(),this.waves=[];for(var n,r=0,s=i.vertices.length;r<s;r++)n=i.vertices[r],this.waves.push({z:n.z,ang:Math.random()*Math.PI*2,amp:t.amplitude+Math.random()*t.amplitudeVariance,speed:(t.speed+Math.random()*t.speedVariance)/1e3});o||((o={}).material=new THREE.MeshPhongMaterial({color:t.color,transparent:t.opacity<1,opacity:t.opacity,shading:THREE.FlatShading})),this.mesh=new THREE.Mesh(i,o.material),e.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(e,t){if(t){for(var o,i,n=this.mesh.geometry.vertices,r=0;o=n[r];r++)i=this.waves[r],o.z=i.z+Math.sin(i.ang)*i.amp,i.ang+=i.speed*t;this.mesh.geometry.verticesNeedUpdate=!0}}};e.exports.registerAll=(o=!1,function(e){o||((e=e||window.AFRAME).registerComponent("ocean",n),e.registerPrimitive("a-ocean",i),o=!0)})},function(e){e.exports={size:5,cellSize:10,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5},autogenerated:!0,cells:[{q:-1,r:0,s:1,h:1,walkable:!0,userData:{}},{q:0,r:-1,s:1,h:1,walkable:!0,userData:{}},{q:0,r:0,s:0,h:1,walkable:!0,userData:{}},{q:1,r:-1,s:0,h:1,walkable:!0,userData:{}},{q:-1,r:1,s:0,h:0,walkable:!0,userData:{}},{q:0,r:1,s:-1,h:0,walkable:!0,userData:{}},{q:1,r:0,s:-1,h:0,walkable:!0,userData:{}}]}},function(e,t){var o,i=e.exports={VERSION:"0.1.1",PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,SQRT3:Math.sqrt(3),TILE:"tile",ENT:"entity",STR:"structure",HEX:"hex",SQR:"square",ABS:"abstract"};i.Board=function(e,t){if(!e)throw new Error("You must pass in a grid system for the board to use.");this.tiles=[],this.tileGroup=null,this.group=new THREE.Object3D,this.grid=null,this.overlay=null,this.finder=new i.AStarFinder(t),i.Loader.init(),this.setGrid(e)},i.Board.prototype={setEntityOnTile:function(e,t){var o=this.grid.cellToPixel(t.cell);e.position.copy(o),e.position.y+=e.heightOffset||0,e.tile&&(e.tile.entity=null),e.tile=t,t.entity=e},addTile:function(e){-1===this.tiles.indexOf(e)&&(this.tiles.push(e),this.snapTileToGrid(e),e.position.y=0,this.tileGroup.add(e.mesh),this.grid.add(e.cell),e.cell.tile=e)},removeTile:function(e){if(e){var t=this.tiles.indexOf(e);this.grid.remove(e.cell),-1!==t&&this.tiles.splice(t,1),e.dispose()}},removeAllTiles:function(){if(this.tileGroup)for(var e=this.tileGroup.children,t=0;t<e.length;t++)this.tileGroup.remove(e[t])},getTileAtCell:function(e){var t=this.grid.cellToHash(e);return e.tile||(void 0!==this.grid.cells[t]?this.grid.cells[t].tile:null)},snapToGrid:function(e){var t=this.grid.pixelToCell(e);e.copy(this.grid.cellToPixel(t))},snapTileToGrid:function(e){if(e.cell)e.position.copy(this.grid.cellToPixel(e.cell));else{var t=this.grid.pixelToCell(e.position);e.position.copy(this.grid.cellToPixel(t))}return e},getRandomTile:function(){var e=i.Tools.randomInt(0,this.tiles.length-1);return this.tiles[e]},findPath:function(e,t,o){return this.finder.findPath(e.cell,t.cell,o,this.grid)},setGrid:function(e){this.group.remove(this.tileGroup),this.grid&&e!==this.grid&&(this.removeAllTiles(),this.tiles.forEach(function(e){this.grid.remove(e.cell),e.dispose()}),this.grid.dispose()),this.grid=e,this.tiles=[],this.tileGroup=new THREE.Object3D,this.group.add(this.tileGroup)},generateOverlay:function(e){var t=new THREE.LineBasicMaterial({color:0,opacity:.3});this.overlay&&this.group.remove(this.overlay),this.overlay=new THREE.Object3D,this.grid.generateOverlay(e,this.overlay,t),this.group.add(this.overlay)},generateTilemap:function(e){this.reset();var t=this.grid.generateTiles(e);this.tiles=t,this.tileGroup=new THREE.Object3D;for(var o=0;o<t.length;o++)this.tileGroup.add(t[o].mesh);this.group.add(this.tileGroup)},reset:function(){this.removeAllTiles(),this.tileGroup&&this.group.remove(this.tileGroup)}},i.Board.prototype.constructor=i.Board,i.Cell=function(e,t,o,n){this.q=e||0,this.r=t||0,this.s=o||0,this.h=n||1,this.tile=null,this.userData={},this.walkable=!0,this._calcCost=0,this._priority=0,this._visited=!1,this._parent=null,this.uniqueID=i.LinkedList.generateID()},i.Cell.prototype={set:function(e,t,o){return this.q=e,this.r=t,this.s=o,this},copy:function(e){return this.q=e.q,this.r=e.r,this.s=e.s,this.h=e.h,this.tile=e.tile||null,this.userData=e.userData||{},this.walkable=e.walkable,this},add:function(e){return this.q+=e.q,this.r+=e.r,this.s+=e.s,this},equals:function(e){return this.q===e.q&&this.r===e.r&&this.s===e.s}},i.Cell.prototype.constructor=i.Cell,i.HexGrid=function(e){e=e||{},this.type=i.HEX,this.size=5,this.cellSize=void 0===e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t,o=[];for(t=0;6>t;t++)o.push(this._createVertex(t));for(this.cellShape=new THREE.Shape,this.cellShape.moveTo(o[0].x,o[0].y),t=1;6>t;t++)this.cellShape.lineTo(o[t].x,o[t].y);this.cellShape.lineTo(o[0].x,o[0].y),this.cellShape.autoClose=!0,this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=o,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._cellWidth=2*this.cellSize,this._cellLength=.5*i.SQRT3*this._cellWidth,this._hashDelimeter=".",this._directions=[new i.Cell(1,-1,0),new i.Cell(1,0,-1),new i.Cell(0,1,-1),new i.Cell(-1,1,0),new i.Cell(-1,0,1),new i.Cell(0,-1,1)],this._diagonals=[new i.Cell(2,-1,-1),new i.Cell(1,1,-2),new i.Cell(-1,2,-1),new i.Cell(-2,1,1),new i.Cell(-1,-1,2),new i.Cell(1,-2,1)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new i.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},i.HexGrid.TWO_THIRDS=2/3,i.HexGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._cellWidth*.75,this._vec3.y=e.h,this._vec3.z=-(e.s-e.r)*this._cellLength*.5,this._vec3},pixelToCell:function(e){var t=e.x*(i.HexGrid.TWO_THIRDS/this.cellSize),o=(-e.x/3+i.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,o,-t-o),this._cubeRound(this._cel)},getCellAt:function(e){var t=e.x*(i.HexGrid.TWO_THIRDS/this.cellSize),o=(-e.x/3+i.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,o,-t-o),this._cubeRound(this._cel),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,o){var i,n,r=this._directions.length;for(this._list.length=0,i=0;r>i;i++)this._cel.copy(e),this._cel.add(this._directions[i]),!(n=this.cells[this.cellToHash(this._cel)])||o&&!o(e,n)||this._list.push(n);if(t)for(i=0;r>i;i++)this._cel.copy(e),this._cel.add(this._diagonals[i]),!(n=this.cells[this.cellToHash(this._cel)])||o&&!o(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,o=i.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===o)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r+this._hashDelimeter+e.s},distance:function(e,t){return Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r),Math.abs(e.s-t.s))+(t.h-e.h)},clearPath:function(){var e,t;for(e in this.cells)(t=this.cells[e])._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,o){var n=Math.abs(e.h);1>n&&(n=1);var r=this._geoCache[n];r||(this.extrudeSettings.amount=n,r=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[n]=r);var s=new i.Tile({size:this.cellSize,scale:t,cell:e,geometry:r,material:o});return e.tile=s,s},generateTiles:function(e){e=e||{};var t,o,n,r=[],s={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};for(t in s=i.Tools.merge(s,e),this.cellSize=s.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*i.SQRT3*this._cellWidth,this.autogenerated=!0,this.extrudeSettings=s.extrudeSettings,this.cells)n=this.cells[t],(o=this.generateTile(n,s.tileScale,s.material)).position.copy(this.cellToPixel(n)),o.position.y=0,r.push(o);return r},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,i.PI/2),t},generate:function(e){var t,o,n,r;for(e=e||{},this.size=void 0===e.size?this.size:e.size,t=-this.size;t<this.size+1;t++)for(o=-this.size;o<this.size+1;o++)n=-t-o,Math.abs(t)<=this.size&&Math.abs(o)<=this.size&&Math.abs(n)<=this.size&&(r=new i.Cell(t,o,n),this.add(r))},generateOverlay:function(e,t,o){var n,r,s,a=this.cellShape.createPointsGeometry();for(n=-e;e+1>n;n++)for(r=-e;e+1>r;r++)if(s=-n-r,Math.abs(n)<=e&&Math.abs(r)<=e&&Math.abs(s)<=e){this._cel.set(n,r,s);var l=new THREE.Line(a,o);l.position.copy(this.cellToPixel(this._cel)),l.rotation.x=90*i.DEG_TO_RAD,t.add(l)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,o){var n=this;i.Tools.getJSON({url:e,callback:function(e){n.fromJSON(e),t.call(o||null,e)},cache:!1,scope:n})},fromJSON:function(e){var t,o,n=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*i.SQRT3*this._cellWidth,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<n.length;t++)(o=new i.Cell).copy(n[t]),this.add(o)},toJSON:function(){var e,t,o={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},i=[];for(t in this.cells)e=this.cells[t],i.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return o.cells=i,o},_createVertex:function(e){var t=i.TAU/6*e;return new THREE.Vector3(this.cellSize*Math.cos(t),this.cellSize*Math.sin(t),0)},_cubeRound:function(e){var t=Math.round(e.q),o=Math.round(e.r),i=Math.round(e.s),n=Math.abs(t-e.q),r=Math.abs(o-e.r),s=Math.abs(i-e.s);return n>r&&n>s?t=-o-i:r>s?o=-t-i:i=-t-o,this._cel.set(t,o,i)}},i.HexGrid.prototype.constructor=i.HexGrid,i.SqrGrid=function(e){e=e||{},this.type=i.SQR,this.size=5,this.cellSize=void 0===e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t=[];t.push(new THREE.Vector3),t.push(new THREE.Vector3(-this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,-this.cellSize)),this.cellShape=new THREE.Shape,this.cellShape.moveTo(-this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,-this.cellSize),this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=t,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._fullCellSize=2*this.cellSize,this._hashDelimeter=".",this._directions=[new i.Cell(1,0,0),new i.Cell(0,-1,0),new i.Cell(-1,0,0),new i.Cell(0,1,0)],this._diagonals=[new i.Cell(-1,-1,0),new i.Cell(-1,1,0),new i.Cell(1,1,0),new i.Cell(1,-1,0)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new i.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},i.SqrGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._fullCellSize,this._vec3.y=e.h,this._vec3.z=e.r*this._fullCellSize,this._vec3},pixelToCell:function(e){var t=Math.round(e.x/this._fullCellSize),o=Math.round(e.z/this._fullCellSize);return this._cel.set(t,o,0)},getCellAt:function(e){var t=Math.round(e.x/this._fullCellSize),o=Math.round(e.z/this._fullCellSize);return this._cel.set(t,o),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,o){var i,n,r=this._directions.length;for(this._list.length=0,i=0;r>i;i++)this._cel.copy(e),this._cel.add(this._directions[i]),!(n=this.cells[this.cellToHash(this._cel)])||o&&!o(e,n)||this._list.push(n);if(t)for(i=0;r>i;i++)this._cel.copy(e),this._cel.add(this._diagonals[i]),!(n=this.cells[this.cellToHash(this._cel)])||o&&!o(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,o=i.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===o)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r},distance:function(e,t){return Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r))+(t.h-e.h)},clearPath:function(){var e,t;for(e in this.cells)(t=this.cells[e])._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,o){var n=Math.abs(e.h);1>n&&(n=1);var r=this._geoCache[n];r||(this.extrudeSettings.amount=n,r=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[n]=r);var s=new i.Tile({size:this.cellSize,scale:t,cell:e,geometry:r,material:o});return e.tile=s,s},generateTiles:function(e){e=e||{};var t,o,n,r=[],s={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};for(t in s=i.Tools.merge(s,e),this.cellSize=s.cellSize,this._fullCellSize=2*this.cellSize,this.autogenerated=!0,this.extrudeSettings=s.extrudeSettings,this.cells)n=this.cells[t],(o=this.generateTile(n,s.tileScale,s.material)).position.copy(this.cellToPixel(n)),o.position.y=0,r.push(o);return r},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,i.PI/2),t},generate:function(e){e=e||{},this.size=void 0===e.size?this.size:e.size;var t,o,n,r=Math.ceil(this.size/2);for(t=-r;r>t;t++)for(o=-r;r>o;o++)n=new i.Cell(t,o+1),this.add(n)},generateOverlay:function(e,t,o){var n,r,s=Math.ceil(e/2);for(n=-s;s>n;n++)for(r=-s;s>r;r++){this._cel.set(n,r);var a=new THREE.Line(this.cellGeo,o);a.position.copy(this.cellToPixel(this._cel)),a.rotation.x=90*i.DEG_TO_RAD,t.add(a)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,o){i.Tools.getJSON({url:e,callback:function(e){this.fromJSON(e),t.call(o||null,e)},cache:!1,scope:this})},fromJSON:function(e){var t,o,n=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._fullCellSize=2*this.cellSize,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<n.length;t++)(o=new i.Cell).copy(n[t]),this.add(o)},toJSON:function(){var e,t,o={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},i=[];for(t in this.cells)e=this.cells[t],i.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return o.cells=i,o}},i.SqrGrid.prototype.constructor=i.SqrGrid,i.Tile=function(e){e=e||{};var t={cell:null,geometry:null,material:null};if(!(t=i.Tools.merge(t,e)).cell||!t.geometry)throw new Error("Missing vg.Tile configuration");this.cell=t.cell,this.cell.tile&&this.cell.tile!==this&&this.cell.tile.dispose(),this.cell.tile=this,this.uniqueID=i.Tools.generateID(),this.geometry=t.geometry,this.material=t.material,this.material||(this.material=new THREE.MeshPhongMaterial({color:i.Tools.randomizeRGB("30, 30, 30",13)})),this.objectType=i.TILE,this.entity=null,this.userData={},this.selected=!1,this.highlight="0x0084cc",this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.userData.structure=this,this.position=this.mesh.position,this.rotation=this.mesh.rotation,this.rotation.x=-90*i.DEG_TO_RAD,this.mesh.scale.set(t.scale,t.scale,1),this.material.emissive?this._emissive=this.material.emissive.getHex():this._emissive=null},i.Tile.prototype={select:function(){return this.material.emissive&&this.material.emissive.setHex(this.highlight),this.selected=!0,this},deselect:function(){return null!==this._emissive&&this.material.emissive&&this.material.emissive.setHex(this._emissive),this.selected=!1,this},toggle:function(){return this.selected?this.deselect():this.select(),this},dispose:function(){this.cell&&this.cell.tile&&(this.cell.tile=null),this.cell=null,this.position=null,this.rotation=null,this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.mesh.userData.structure=null,this.mesh=null,this.material=null,this.userData=null,this.entity=null,this.geometry=null,this._emissive=null}},i.Tile.prototype.constructor=i.Tile,(o=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+""+Math.floor(1e3*Math.random()),this.sortArray=[]}).generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},(o.prototype={getNode:function(e){return this.objToNodeMap[e.uniqueID]},addNode:function(e){var t=new function(){this.obj=null,this.next=null,this.prev=null,this.free=!0};if(!e.uniqueID)try{e.uniqueID=o.generateID()}catch(e){return console.error("[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier"),null}return t.obj=e,t.free=!1,this.objToNodeMap[e.uniqueID]=t,t},swapObjects:function(e,t){this.objToNodeMap[e.obj.uniqueID]=null,this.objToNodeMap[t.uniqueID]=e,e.obj=t},add:function(e){var t=this.objToNodeMap[e.uniqueID];if(t){if(!1===t.free)return;t.obj=e,t.free=!1,t.next=null,t.prev=null}else t=this.addNode(e);if(this.first){if(!this.last)throw new Error("[LinkedList.add] No last in the list -- that shouldn't happen here");this.last.next=t,t.prev=this.last,this.last=t,t.next=null}else this.first=t,this.last=t,t.next=null,t.prev=null;this.length++,this.showDebug&&this.dump("after add")},has:function(e){return!!this.objToNodeMap[e.uniqueID]},moveUp:function(e){this.dump("before move up");var t=this.getNode(e);if(!t)throw"Oops, trying to move an object that isn't in the list";if(t.prev){var o=t.prev,i=o.prev;t==this.last&&(this.last=o);var n=t.next;i&&(i.next=t),t.next=o,t.prev=o.prev,o.next=n,o.prev=t,this.first==o&&(this.first=t)}},moveDown:function(e){var t=this.getNode(e);if(!t)throw"Oops, trying to move an object that isn't in the list";if(t.next){var o=t.next;this.moveUp(o.obj),this.last==o&&(this.last=t)}},sort:function(e){var t,o,i=this.sortArray,n=this.first;for(i.length=0;n;)i.push(n.obj),n=n.next;for(this.clear(),i.sort(e),o=i.length,t=0;o>t;t++)this.add(i[t])},remove:function(e){var t=this.getNode(e);return!(!t||t.free||(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.prev||(this.first=t.next),t.next||(this.last=t.prev),t.free=!0,t.prev=null,t.next=null,this.length--,0))},shift:function(){var e=this.first;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.first=e.next,e.next||(this.last=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},pop:function(){var e=this.last;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.last=e.prev,e.prev||(this.first=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},concat:function(e){for(var t=e.first;t;)this.add(t.obj),t=t.next},clear:function(){for(var e=this.first;e;)e.free=!0,e=e.next;this.first=null,this.length=0},dispose:function(){for(var e=this.first;e;)e.obj=null,e=e.next;this.first=null,this.objToNodeMap=null},dump:function(e){console.log("===================="+e+"=====================");for(var t=this.first;t;)console.log("{"+t.obj.toString()+"} previous="+(t.prev?t.prev.obj:"NULL")),t=t.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}}).constructor=o,i.LinkedList=o,function(){var e=function(e,t,o,i,n){this._listener=t,this.isOnce=o,this.context=i,this.signal=e,this._priority=n||0};(e.prototype={active:!0,params:null,execute:function(e){var t,o;return this.active&&this._listener&&(o=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,o),this.isOnce&&this.detach()),t},detach:function(){return this.isBound()?this.signal.remove(this._listener,this.context):null},isBound:function(){return!!this.signal&&!!this._listener},_destroy:function(){delete this.signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this.isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}}).constructor=e;var t=function(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){t.prototype.dispatch.apply(e,arguments)}};t.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(e,t){if("function"!=typeof e)throw new Error("Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))},_registerListener:function(t,o,i,n){var r,s=this._indexOfListener(t,i);if(-1!==s){if((r=this._bindings[s]).isOnce!==o)throw new Error("You cannot add"+(o?"":"Once")+"() then add"+(o?"Once":"")+"() the same listener without removing the relationship first.")}else r=new e(this,t,o,i,n),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(e){var t=this._bindings.length;do{t--}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var o,i=this._bindings.length;i--;)if((o=this._bindings[i])._listener===e&&o.context===t)return i;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,o){return this.validateListener(e,"add"),this._registerListener(e,!1,t,o)},addOnce:function(e,t,o){return this.validateListener(e,"addOnce"),this._registerListener(e,!0,t,o)},remove:function(e,t){this.validateListener(e,"remove");var o=this._indexOfListener(e,t);return-1!==o&&(this._bindings[o]._destroy(),this._bindings.splice(o,1)),e},removeAll:function(e){void 0===e&&(e=null);for(var t=this._bindings.length;t--;)e?this._bindings[t].context===e&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)):this._bindings[t]._destroy();e||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var e,t=Array.prototype.slice.call(arguments),o=this._bindings.length;if(this.memorize&&(this._prevParams=t),o){e=this._bindings.slice(),this._shouldPropagate=!0;do{o--}while(e[o]&&this._shouldPropagate&&!1!==e[o].execute(t))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},t.prototype.constructor=t,i.Signal=t}(),i.AStarFinder=function(e){e=e||{};var t={allowDiagonal:!1,heuristicFilter:null};t=i.Tools.merge(t,e),this.allowDiagonal=t.allowDiagonal,this.heuristicFilter=t.heuristicFilter,this.list=new i.LinkedList},i.AStarFinder.prototype={findPath:function(e,t,o,n){var r,s,a,l,c,u;for(o=o||this.heuristicFilter,n.clearPath(),this.list.clear(),this.list.add(e);this.list.length>0;){if(this.list.sort(this.compare),(r=this.list.shift())._visited=!0,r===t)return i.PathUtil.backtrace(t);for(c=0,u=(a=n.getNeighbors(r,this.allowDiagonal,o)).length;u>c;c++)if((l=a[c]).walkable&&(s=r._calcCost+n.distance(r,l),!l._visited||s<l._calcCost)){if(l._visited=!0,l._parent=r,l._calcCost=s,l._priority=s+n.distance(t,l),l===t)return i.PathUtil.backtrace(t);this.list.add(l)}}return null},compare:function(e,t){return e._priority-t._priority}},i.AStarFinder.prototype.constructor=i.AStarFinder,i.PathUtil={backtrace:function(e){for(var t=[e];e._parent;)e=e._parent,t.push(e);return t.reverse()},biBacktrace:function(e,t){var o=this.backtrace(e),i=this.backtrace(t);return o.concat(i.reverse())},pathLength:function(e){var t,o,i,n,r,s=0;for(t=1;t<e.length;++t)o=e[t-1],i=e[t],n=o[0]-i[0],r=o[1]-i[1],s+=Math.sqrt(n*n+r*r);return s},interpolate:function(e,t,o,i){var n,r,s,a,l,c,u=Math.abs,h=[];for(s=u(o-e),a=u(i-t),n=o>e?1:-1,r=i>t?1:-1,l=s-a;e!==o||t!==i;)h.push([e,t]),(c=2*l)>-a&&(l-=a,e+=n),s>c&&(l+=s,t+=r);return h},expandPath:function(e){var t,o,i,n,r,s,a=[],l=e.length;if(2>l)return a;for(r=0;l-1>r;++r)for(t=e[r],o=e[r+1],n=(i=this.interpolate(t[0],t[1],o[0],o[1])).length,s=0;n-1>s;++s)a.push(i[s]);return a.push(e[l-1]),a},smoothenPath:function(e,t){var o,i,n,r,s,a,l,c,u,h,g,d,p=t.length,f=t[0][0],m=t[0][1],y=t[p-1][0],v=t[p-1][1];for(s=[[o=f,i=m]],l=2;p>l;++l){for(n=(u=t[l])[0],r=u[1],h=this.interpolate(o,i,n,r),d=!1,c=1;c<h.length;++c)if(g=h[c],!e.isWalkableAt(g[0],g[1])){d=!0;break}d&&(a=t[l-1],s.push(a),o=a[0],i=a[1])}return s.push([y,v]),s},compressPath:function(e){if(e.length<3)return e;var t,o,i,n,r,s,a=[],l=e[0][0],c=e[0][1],u=e[1][0],h=e[1][1],g=u-l,d=h-c;for(g/=r=Math.sqrt(g*g+d*d),d/=r,a.push([l,c]),s=2;s<e.length;s++)t=u,o=h,i=g,n=d,g=(u=e[s][0])-t,d=(h=e[s][1])-o,d/=r=Math.sqrt(g*g+d*d),((g/=r)!==i||d!==n)&&a.push([t,o]);return a.push([u,h]),a}},i.Loader={manager:null,imageLoader:null,crossOrigin:!1,init:function(e){this.crossOrigin=e||!1,this.manager=new THREE.LoadingManager(function(){},function(){},function(){console.warn("Error loading images")}),this.imageLoader=new THREE.ImageLoader(this.manager),this.imageLoader.crossOrigin=e},loadTexture:function(e,t,o,i){var n=new THREE.Texture(null,t);return this.imageLoader.load(e,function(e){n.image=e,n.needsUpdate=!0,o&&o(n)},null,function(e){i&&i(e)}),n.sourceFile=e,n}},i.MouseCaster=function(e,t,o){this.down=!1,this.rightDown=!1,this.pickedObject=null,this.selectedObject=null,this.allHits=null,this.active=!0,this.shift=!1,this.ctrl=!1,this.wheel=0,this.position=new THREE.Vector3,this.screenPosition=new THREE.Vector2,this.signal=new i.Signal,this.group=e,this._camera=t,this._raycaster=new THREE.Raycaster,this._preventDefault=!1,(o=o||document).addEventListener("mousemove",this._onDocumentMouseMove.bind(this),!1),o.addEventListener("mousedown",this._onDocumentMouseDown.bind(this),!1),o.addEventListener("mouseup",this._onDocumentMouseUp.bind(this),!1),o.addEventListener("mousewheel",this._onMouseWheel.bind(this),!1),o.addEventListener("DOMMouseScroll",this._onMouseWheel.bind(this),!1)},i.MouseCaster.OVER="over",i.MouseCaster.OUT="out",i.MouseCaster.DOWN="down",i.MouseCaster.UP="up",i.MouseCaster.CLICK="click",i.MouseCaster.WHEEL="wheel",i.MouseCaster.prototype={update:function(){if(this.active){this._raycaster.setFromCamera(this.screenPosition,this._camera);var e,t,o=this._raycaster.intersectObject(this.group,!0);o.length>0?(t=(e=o[0]).object.userData.structure,this.pickedObject!=t&&(this.pickedObject&&this.signal.dispatch(i.MouseCaster.OUT,this.pickedObject),this.pickedObject=t,this.selectedObject=null,this.signal.dispatch(i.MouseCaster.OVER,this.pickedObject)),this.position.copy(e.point),this.screenPosition.z=e.distance):(this.pickedObject&&this.signal.dispatch(i.MouseCaster.OUT,this.pickedObject),this.pickedObject=null,this.selectedObject=null),this.allHits=o}},preventDefault:function(){this._preventDefault=!0},_onDocumentMouseDown:function(e){return(e=e||window.event).preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.pickedObject&&(this.selectedObject=this.pickedObject),this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.down=1===e.which,this.rightDown=3===e.which,void this.signal.dispatch(i.MouseCaster.DOWN,this.pickedObject))},_onDocumentMouseUp:function(e){return e.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.signal.dispatch(i.MouseCaster.UP,this.pickedObject),this.selectedObject&&this.pickedObject&&this.selectedObject.uniqueID===this.pickedObject.uniqueID&&this.signal.dispatch(i.MouseCaster.CLICK,this.pickedObject),this.down=1!==e.which&&this.down,void(this.rightDown=3!==e.which&&this.rightDown))},_onDocumentMouseMove:function(e){e.preventDefault(),this.screenPosition.x=e.clientX/window.innerWidth*2-1,this.screenPosition.y=-e.clientY/window.innerHeight*2+1},_onMouseWheel:function(e){if(this.active){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?this.wheel++:this.wheel--,this.signal.dispatch(i.MouseCaster.WHEEL,this.wheel)}}},i.MouseCaster.prototype.constructor=i.MouseCaster,i.Scene=function(e,t){var o={element:document.body,alpha:!0,antialias:!0,clearColor:"#fff",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:"PerspectiveCamera",cameraPosition:null,orthoZoom:4},n={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(o=i.Tools.merge(o,e),"boolean"!=typeof t&&(n=i.Tools.merge(n,t)),this.renderer=new THREE.WebGLRenderer({alpha:o.alpha,antialias:o.antialias}),this.renderer.setClearColor(o.clearColor,0),this.renderer.sortObjects=o.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=o.orthoZoom,this.container=new THREE.Scene,this.container.fog=o.fog,this.container.add(new THREE.AmbientLight(14540253)),o.lightPosition||o.light.position.set(-1,1,-1).normalize(),this.container.add(o.light),"OrthographicCamera"===o.cameraType){var r=window.innerWidth/this.orthoZoom,s=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(r/-2,r/2,s/2,s/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!t,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=n.minDistance,this.controls.maxDistance=n.maxDistance,this.controls.zoomSpeed=n.zoomSpeed,this.controls.noZoom=n.noZoom),o.cameraPosition&&this.camera.position.copy(o.cameraPosition),window.addEventListener("resize",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,"OrthographicCamera"===this.camera.type){var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(o.element)},i.Scene.prototype={attachTo:function(e){e.style.width=this.width+"px",e.style.height=this.height+"px",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),e.appendChild(this.renderer.domElement)},add:function(e){this.container.add(e)},remove:function(e){this.container.remove(e)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)this.orthoZoom=0;else{var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2,this.camera.updateProjectionMatrix()}},focusOn:function(e){this.camera.lookAt(e.position)}},i.Scene.prototype.constructor=i.Scene,i.SelectionManager=function(e){this.mouse=e,this.onSelect=new i.Signal,this.onDeselect=new i.Signal,this.selected=null,this.toggleSelection=!1,this.mouse.signal.add(this.onMouse,this)},i.SelectionManager.prototype={select:function(e,t){e&&(t=t||!0,this.selected!==e&&this.clearSelection(t),e.selected?this.toggleSelection&&(t&&this.onDeselect.dispatch(e),e.deselect()):e.select(),this.selected=e,t&&this.onSelect.dispatch(e))},clearSelection:function(e){e=e||!0,this.selected&&(e&&this.onDeselect.dispatch(this.selected),this.selected.deselect()),this.selected=null},onMouse:function(e,t){switch(e){case i.MouseCaster.DOWN:t||this.clearSelection();break;case i.MouseCaster.CLICK:this.select(t)}}},i.SelectionManager.prototype.constructor=i.SelectionManager,i.Tools={clamp:function(e,t,o){return Math.max(t,Math.min(o,e))},sign:function(e){return e&&e/Math.abs(e)},random:function(e,t){return 1===arguments.length?Math.random()*e-.5*e:Math.random()*(t-e)+e},randomInt:function(e,t){return 1===arguments.length?Math.random()*e-.5*e|0:Math.random()*(t-e+1)+e|0},normalize:function(e,t,o){return(e-t)/(o-t)},getShortRotation:function(e){return(e%=this.TAU)>this.PI?e-=this.TAU:e<-this.PI&&(e+=this.TAU),e},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(e){if("object"!=typeof e||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},merge:function(e,t){var o=this,i=Array.isArray(t),n=i&&[]||{};return i?(e=e||[],n=n.concat(e),t.forEach(function(t,i){void 0===n[i]?n[i]=t:o.isPlainObject(t)?n[i]=o.merge(e[i],t):-1===e.indexOf(t)&&n.push(t)}),n):(e&&o.isPlainObject(e)&&Object.keys(e).forEach(function(t){n[t]=e[t]}),Object.keys(t).forEach(function(i){t[i]&&o.isPlainObject(t[i])&&e[i]?n[i]=o.merge(e[i],t[i]):n[i]=t[i]}),n)},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},radixSort:function(e,t,o,i){if(t=t||0,o=o||e.length,i=i||31,!(t>=o-1||0>i)){for(var n=t,r=o,s=1<<i;r>n;)if(e[n]&s){--r;var a=e[n];e[n]=e[r],e[r]=a}else++n;this.radixSort(e,t,r,i-1),this.radixSort(e,r,o,i-1)}},randomizeRGB:function(e,t){var o,i,n=e.split(","),r="rgb(";for(t=this.randomInt(t),o=0;3>o;o++)0>(i=parseInt(n[o])+t)?i=0:i>255&&(i=255),r+=i+",";return(r=r.substring(0,r.length-1))+")"},getJSON:function(e){var t=new XMLHttpRequest,o=void 0!==e.cache&&e.cache?e.url:e.url+"?t="+Math.floor(1e4*Math.random())+Date.now();t.onreadystatechange=function(){if(200!==this.status)0!==this.status&&console.warn("[Tools.getJSON] Error: "+this.status+" ("+this.statusText+") :: "+e.url);else{var t=null;try{t=JSON.parse(this.responseText)}catch(e){return}e.callback.call(e.scope||null,t)}},t.open("GET",o,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json"),t.send("")}}},function(e,t,o){var i,n=o(48),r=o(47),s=e.exports.Primitive={defaultComponents:{hexgrid:{}},mappings:{src:"hexgrid.src"}},a=e.exports.Component={dependencies:["material"],schema:{src:{type:"asset"}},init:function(){var e=this.data;e.src?fetch(e.src).then(function(e){e.json()}).then(function(e){this.addMesh(e)}):this.addMesh(r)},addMesh:function(e){var t=new n.HexGrid;t.fromJSON(e);var o=new n.Board(t);o.generateTilemap(),this.el.setObject3D("mesh",o.group),this.addMaterial()},addMaterial:function(){var e=(this.el.components.material||{}).material;e&&this.el.object3D.traverse(function(t){t.isMesh&&(t.material=e)})},remove:function(){this.el.removeObject3D("mesh")}};e.exports.registerAll=(i=!1,function(e){i||((e=e||window.AFRAME).registerComponent("hexgrid",a),e.registerPrimitive("a-hexgrid",s),i=!0)})},function(e,t){var o,i=e.exports={defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.rawgit.com/donmccurdy/aframe-extras/v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}};e.exports.registerAll=(o=!1,function(e){o||((e=e||window.AFRAME).registerPrimitive("a-grid",i),o=!0)})},function(e,t,o){e.exports={"a-grid":o(50),"a-hexgrid":o(49),"a-ocean":o(46),"a-tube":o(45),registerAll:function(e){this._registered||(e=e||window.AFRAME,this["a-grid"].registerAll(e),this["a-hexgrid"].registerAll(e),this["a-ocean"].registerAll(e),this["a-tube"].registerAll(e),this._registered=!0)}}},function(e,t,o){const i=o(22);e.exports=class{constructor(){this.portals=[]}push(e,t){void 0===t&&(t=e),this.portals.push({left:e,right:t})}stringPull(){const e=this.portals,t=[];let o,n,r,s=0,a=0,l=0;o=e[0].left,n=e[0].left,r=e[0].right,t.push(o);for(let c=1;c<e.length;c++){const u=e[c].left,h=e[c].right;if(i.triarea2(o,r,h)<=0){if(!(i.vequal(o,r)||i.triarea2(o,n,h)>0)){t.push(n),n=o=n,r=o,a=s=a,l=s,c=s;continue}r=h,l=c}if(i.triarea2(o,n,u)>=0){if(!(i.vequal(o,n)||i.triarea2(o,r,u)<0)){t.push(r),n=o=r,r=o,a=s=l,l=s,c=s;continue}n=u,a=c}}return 0!==t.length&&i.vequal(t[t.length-1],e[e.length-1].left)||t.push(e[e.length-1].left),this.path=t,t}}},function(e,t){e.exports=class{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e}remove(e){const t=this.content.indexOf(e),o=this.content.pop();t!==this.content.length-1&&(this.content[t]=o,this.scoreFunction(o)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const t=this.content[e];for(;e>0;){const o=(e+1>>1)-1,i=this.content[o];if(!(this.scoreFunction(t)<this.scoreFunction(i)))break;this.content[o]=t,this.content[e]=i,e=o}}bubbleUp(e){const t=this.content.length,o=this.content[e],i=this.scoreFunction(o);for(;;){const n=e+1<<1,r=n-1;let s,a=null;if(r<t){const e=this.content[r];(s=this.scoreFunction(e))<i&&(a=r)}if(n<t){const e=this.content[n];this.scoreFunction(e)<(null===a?i:s)&&(a=n)}if(null===a)break;this.content[e]=this.content[a],this.content[a]=o,e=a}}}},function(e,t,o){const i=o(53),n=o(22);e.exports=class{static init(e){for(let t=0;t<e.length;t++){const o=e[t];o.f=0,o.g=0,o.h=0,o.cost=1,o.visited=!1,o.closed=!1,o.parent=null}}static cleanUp(e){for(let t=0;t<e.length;t++){const o=e[t];delete o.f,delete o.g,delete o.h,delete o.cost,delete o.visited,delete o.closed,delete o.parent}}static heap(){return new i(function(e){return e.f})}static search(e,t,o){this.init(e);const i=this.heap();for(i.push(t);i.size()>0;){const t=i.pop();if(t===o){let e=t;const o=[];for(;e.parent;)o.push(e),e=e.parent;return this.cleanUp(o),o.reverse()}t.closed=!0;const n=this.neighbours(e,t);for(let e=0,r=n.length;e<r;e++){const r=n[e];if(r.closed)continue;const s=t.g+r.cost,a=r.visited;if(!a||s<r.g){if(r.visited=!0,r.parent=t,!r.centroid||!o.centroid)throw new Error("Unexpected state");r.h=r.h||this.heuristic(r.centroid,o.centroid),r.g=s,r.f=r.g+r.h,a?i.rescoreElement(r):i.push(r)}}}return[]}static heuristic(e,t){return n.distanceToSquared(e,t)}static neighbours(e,t){const o=[];for(let i=0;i<t.neighbours.length;i++)o.push(e[t.neighbours[i]]);return o}}},function(e,t,o){const i=o(22),n=o(54),r=o(52);var s=1,a=function(e){console.log("Vertices:",e.vertices.length,"polygons:",e.faces.length);var t=[],o=e.vertices,n=e.faceVertexUvs;e.faces.forEach(e=>{t.push({id:s++,vertexIds:[e.a,e.b,e.c],centroid:e.centroid,normal:e.normal,neighbours:[]})});var r={polygons:t,vertices:o,faceVertexUvs:n};return t.forEach(e=>{!function(e,t){e.neighbours=[];for(var o=0,n=t.polygons.length;o<n;o++)e!==t.polygons[o]&&(e.centroid.distanceToSquared(t.polygons[o].centroid)>1e4||i.array_intersect(e.vertexIds,t.polygons[o].vertexIds).length>=2&&e.neighbours.push(t.polygons[o]))}(e,r)}),r},l=function(e){var t={};e.vertices.forEach(e=>{e.x=i.roundNumber(e.x,2),e.y=i.roundNumber(e.y,2),e.z=i.roundNumber(e.z,2)}),t.vertices=e.vertices;var o=function(e){var t=[],o=0,i=function(e){e.neighbours.forEach(t=>{void 0===t.group&&(t.group=e.group,i(t))})};return e.polygons.forEach(e=>{void 0===e.group&&(e.group=o++,i(e)),t[e.group]||(t[e.group]=[]),t[e.group].push(e)}),console.log("Groups built: ",t.length),t}(e);t.groups=[];var n,r,s,a,l=function(e,t){for(var o=0;o<e.length;o++)if(t===e[o])return o};return o.forEach(e=>{var o=[];e.forEach(t=>{var c=[];t.neighbours.forEach(t=>{c.push(l(e,t))});var u=[];t.neighbours.forEach(e=>{u.push((n=e,r=t.vertexIds,s=n.vertexIds,a=[],r.forEach(e=>{s.includes(e)&&a.push(e)}),a.length<2?[]:(a.includes(r[0])&&a.includes(r[r.length-1])&&r.push(r.shift()),a.includes(s[0])&&a.includes(s[s.length-1])&&s.push(s.shift()),a=[],r.forEach(e=>{s.includes(e)&&a.push(e)}),a)))}),t.centroid.x=i.roundNumber(t.centroid.x,2),t.centroid.y=i.roundNumber(t.centroid.y,2),t.centroid.z=i.roundNumber(t.centroid.z,2),o.push({id:l(e,t),neighbours:c,vertexIds:t.vertexIds,centroid:t.centroid,portals:u})}),t.groups.push(o)}),t},c={};e.exports={buildNodes:function(e){var t=function(e){return i.computeCentroids(e),e.mergeVertices(),a(e)}(e);return l(t)},setZoneData:function(e,t){c[e]=t},getGroup:function(e,t){if(!c[e])return null;var o=null,n=Math.pow(50,2);return c[e].groups.forEach((e,r)=>{e.forEach(e=>{var s=i.distanceToSquared(e.centroid,t);s<n&&(o=r,n=s)})}),o},getRandomNode:function(e,t,o,n){if(!c[e])return new THREE.Vector3;o=o||null,n=n||0;var r=[];return c[e].groups[t].forEach(e=>{o&&n?i.distanceToSquared(o,e.centroid)<n*n&&r.push(e.centroid):r.push(e.centroid)}),i.sample(r)||new THREE.Vector3},getClosestNode:function(e,t,o,n=!1){const r=c[t].groups[o],s=c[t].vertices;let a=null,l=1/0;return r.forEach(t=>{const o=i.distanceToSquared(t.centroid,e);o<l&&(!n||i.isVectorInPolygon(e,t,s))&&(a=t,l=o)}),a},findPath:function(e,t,o,i){const s=c[o].groups[i],a=c[o].vertices,l=this.getClosestNode(e,o,i),u=this.getClosestNode(t,o,i,!0);if(!l||!u)return null;const h=n.search(s,l,u),g=function(e,t){for(var o=0;o<e.neighbours.length;o++)if(e.neighbours[o]===t.id)return e.portals[o]},d=new r;d.push(e);for(let e=0;e<h.length;e++){const t=h[e],o=h[e+1];if(o){const e=g(t,o);d.push(a[e[0]],a[e[1]])}}d.push(t),d.stringPull();const p=d.path.map(e=>new THREE.Vector3(e.x,e.y,e.z));return p.shift(),p}}},function(e,t,o){var i=o(55);e.exports={init:function(){this.navMesh=null,this.nodes=null,this.controllers=new Set},setNavMesh:function(e){var t=e.geometry.isBufferGeometry?(new THREE.Geometry).fromBufferGeometry(e.geometry):e.geometry;this.navMesh=new THREE.Mesh(t),this.nodes=i.buildNodes(this.navMesh.geometry),i.setZoneData("level",this.nodes)},getNavMesh:function(){return this.navMesh},addController:function(e){this.controllers.add(e)},removeController:function(e){this.controllers.remove(e)},getPath:function(e,t){var o=e.el.object3D.position,n=i.getGroup("level",o);return i.findPath(o,t,"level",n)}}},function(e,t){var o,i,n;e.exports={schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addController(this),this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeController(this)},update:function(){this.path.length=0},tick:(o=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,function(e,t){var r=this.el,s=this.data,a=this.raycaster,l=s.speed*t/1e3;if(s.active){if(this.path.length||(this.path=this.system.getPath(this.el.object3D,o.copy(s.destination)),this.path=this.path||[],r.emit("nav-start")),!this.path.length)return console.warn("[nav] Unable to find path to %o.",s.destination),this.el.setAttribute("nav-controller",{active:!1}),void r.emit("nav-end");var c,u=r.object3D.position,h=this.path[0];if(i.subVectors(h,u),i.length()<l){if(this.path.shift(),!this.path.length)return this.el.setAttribute("nav-controller",{active:!1}),void r.emit("nav-end");c=this.path[0]}else n.copy(i.setLength(l)).add(u),c=h;c.y=u.y,r.object3D.lookAt(c),a.ray.origin.copy(n),a.ray.origin.y+=1.5,a.ray.direction.y=-1;var g=a.intersectObject(this.system.getNavMesh());g.length?(i.subVectors(g[0].point,u),u.add(i.setLength(l))):u.copy(n)}})}},function(e,t){e.exports={init:function(){this.system=this.el.sceneEl.systems.nav,this.loadNavMesh(),this.el.addEventListener("model-loaded",this.loadNavMesh.bind(this))},loadNavMesh:function(){var e,t=this.el.getObject3D("mesh");t&&(t.traverse(function(t){t.isMesh&&(e=t)}),e&&this.system.setNavMesh(e))}}},function(e,t,o){e.exports={"nav-mesh":o(58),"nav-controller":o(57),system:o(56),registerAll:function(e){this._registered||((e=e||window.AFRAME).components["nav-mesh"]||e.registerComponent("nav-mesh",this["nav-mesh"]),e.components["nav-controller"]||e.registerComponent("nav-controller",this["nav-controller"]),e.systems.nav||e.registerSystem("nav",this.system),this._registered=!0)}}},function(e,t){e.exports={dependencies:["velocity"],schema:{axis:{default:"x",oneOf:["x","y","z"]},min:{default:0},max:{default:0},speed:{default:1}},init:function(){var e={x:0,y:0,z:0};e[this.data.axis]=this.data.speed,this.el.setAttribute("velocity",e),this.el.sceneEl.addBehavior&&this.el.sceneEl.addBehavior(this)},remove:function(){},update:function(){this.tick()},tick:function(){var e=this.data,t=this.el.getAttribute("velocity"),o=this.el.getAttribute("position");t[e.axis]>0&&o[e.axis]>e.max?(t[e.axis]=-e.speed,this.el.setAttribute("velocity",t)):t[e.axis]<0&&o[e.axis]<e.min&&(t[e.axis]=e.speed,this.el.setAttribute("velocity",t))}}},function(e,t){var o,i,n,r;e.exports={schema:{objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},remove:function(){this.pause()},play:function(){var e=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(e,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){var e,t=this.data;e=t.objects?this.el.sceneEl.querySelectorAll(t.objects):this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:(o=new THREE.Vector3,i=new THREE.Vector3,new THREE.Vector3,n=new THREE.Vector3,r=new Map,function(){var e,t,s=this.el,a=this.data,l=[];s.getObject3D("mesh")&&(r.clear(),o.copy(s.object3D.getWorldPosition()),s.object3D.getWorldScale(n),e=a.radius*(t=n,Math.max.apply(null,t.toArray())),this.els.forEach(function(t){var n,s,a,c,u,h;t.isEntity&&(s=t.getObject3D("mesh"))&&(c=(new THREE.Box3).setFromObject(s),h=c.getSize(),u=Math.max(h.x,h.y,h.z)/2,n=Math.sqrt(2*u*u),c.getCenter(i),n&&(a=o.distanceTo(i))<n+e&&(l.push(t),r.set(t,a)))}),l.sort(function(e,t){return r.get(e)>r.get(t)?1:-1}).forEach(this.handleHit),0===l.length&&s.emit("hit",{el:null}),this.collisions.filter(function(e){return!r.has(e)}).forEach(this.handleHitEnd),this.collisions=l)}),handleHit:function(e){e.emit("hit"),e.addState(this.data.state),this.el.emit("hit",{el:e})},handleHitEnd:function(e){e.emit("hitend"),e.removeState(this.data.state),this.el.emit("hitend",{el:e})}}},function(e,t){e.exports={init:function(){this.el.addEventListener("model-loaded",function(e){e.detail.model.traverse(function(e){e.isMesh&&e.geometry.computeVertexNormals()})})}}},function(e,t){var o,i,n,r,s=window.CANNON;e.exports={dependencies:["velocity"],schema:{mass:{default:5},radius:{default:1.3},height:{default:1.764},linearDamping:{default:.05},enableSlopes:{default:!0}},init:function(){this.system=this.el.sceneEl.systems.physics,this.system.addBehavior(this,this.system.Phase.SIMULATE);var e=this.el,t=this.data,o=(new s.Vec3).copy(e.getAttribute("position"));this.body=new s.Body({material:this.system.material,position:o,mass:t.mass,linearDamping:t.linearDamping,fixedRotation:!0}),this.body.addShape(new s.Sphere(t.radius),new s.Vec3(0,t.radius-t.height,0)),this.body.el=this.el,this.el.body=this.body,this.system.addBody(this.body)},remove:function(){this.system.removeBody(this.body),this.system.removeBehavior(this,this.system.Phase.SIMULATE),delete this.el.body},step:(o=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,function(e,t){if(t){var s,a,l=this.body,c=this.data,u=-1/0;t=Math.min(t,1e3*this.system.data.maxInterval),r.set(0,0,0),o.copy(this.el.getAttribute("velocity")),l.velocity.copy(o),l.position.copy(this.el.getAttribute("position"));for(var h,g=0;h=this.system.world.contacts[g];g++)if(h.enabled){if(l.id===h.bi.id)h.ni.negate(n);else{if(l.id!==h.bj.id)continue;n.copy(h.ni)}l.velocity.dot(n)<-1e-6&&n.y<=.5?o=o.projectOnPlane(n):n.y>.5&&(s=l.id===h.bi.id?Math.abs(h.rj.y+h.bj.position.y):Math.abs(h.ri.y+h.bi.position.y))>u&&(u=s,r.copy(n),a=l.id===h.bi.id?h.bj:h.bi)}if(i.copy(o).normalize(),a&&i.y<.5?(c.enableSlopes?r.y<1-1e-6&&r.copy(this.raycastToGround(a,r)):r.set(0,1,0),o=o.projectOnPlane(r)):o.add(this.system.world.gravity.scale(4*t/1e3)),a&&a.el&&a.el.components.velocity){var d=a.el.getAttribute("velocity");l.position.copy({x:l.position.x+d.x*t/1e3,y:l.position.y+d.y*t/1e3,z:l.position.z+d.z*t/1e3}),this.el.setAttribute("position",l.position)}l.velocity.copy(o),this.el.setAttribute("velocity",o)}}),raycastToGround:function(e,t){var o,i,n=this.body.position,r=this.body.position.clone();return r.y-=this.data.height,(o=new s.Ray(n,r))._updateDirection(),o.intersectBody(e),o.hasHit?(i=o.result.hitNormalWorld,Math.abs(i.y)>Math.abs(t.y)?i:t):t}}},function(e,t){e.exports={dependencies:["velocity"],schema:{on:{default:"keydown:Space gamepadbuttondown:0"},playerHeight:{default:1.764},maxJumps:{default:1},distance:{default:5},soundJump:{default:""},soundLand:{default:""},debug:{default:!1}},init:function(){this.velocity=0,this.numJumps=0;var e=this.beginJump.bind(this),t=this.data.on.split(" ");this.bindings={};for(var o=0;o<t.length;o++)this.bindings[t[o]]=e,this.el.addEventListener(t[o],e);this.bindings.collide=this.onCollide.bind(this),this.el.addEventListener("collide",this.bindings.collide)},remove:function(){for(var e in this.bindings)this.bindings.hasOwnProperty(e)&&(this.el.removeEventListener(e,this.bindings[e]),delete this.bindings[e]);this.el.removeEventListener("collide",this.bindings.collide),delete this.bindings.collide},beginJump:function(){if(this.numJumps<this.data.maxJumps){var e=this.data,t=Math.sqrt(-2*e.distance*-24.8),o=this.el.getAttribute("velocity");this.el.setAttribute("velocity",{x:o.x,y:t,z:o.z}),this.numJumps++}},onCollide:function(){this.numJumps=0}}},function(e,t){e.exports={init:function(){this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){var e=this.el;e.addEventListener("hit",this.onHit),e.addEventListener("gripdown",this.onGripClose),e.addEventListener("gripup",this.onGripOpen),e.addEventListener("trackpaddown",this.onGripClose),e.addEventListener("trackpadup",this.onGripOpen),e.addEventListener("triggerdown",this.onGripClose),e.addEventListener("triggerup",this.onGripOpen)},pause:function(){var e=this.el;e.removeEventListener("hit",this.onHit),e.removeEventListener("gripdown",this.onGripClose),e.removeEventListener("gripup",this.onGripOpen),e.removeEventListener("trackpaddown",this.onGripClose),e.removeEventListener("trackpadup",this.onGripOpen),e.removeEventListener("triggerdown",this.onGripClose),e.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(e){this.grabbing=!0},onGripOpen:function(e){var t=this.hitEl;this.grabbing=!1,t&&(t.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.physics.world.removeConstraint(this.constraint),this.constraint=null)},onHit:function(e){var t=e.detail.el;t&&!t.is(this.GRABBED_STATE)&&this.grabbing&&!this.hitEl&&(t.addState(this.GRABBED_STATE),this.hitEl=t,this.constraint=new CANNON.LockConstraint(this.el.body,t.body),this.physics.world.addConstraint(this.constraint))}}},function(e,t){e.exports={schema:{path:{default:""},extension:{default:"jpg"},format:{default:"RGBFormat"},enableBackground:{default:!1}},init:function(){var e=this.data;this.texture=(new THREE.CubeTextureLoader).load([e.path+"posx."+e.extension,e.path+"negx."+e.extension,e.path+"posy."+e.extension,e.path+"negy."+e.extension,e.path+"posz."+e.extension,e.path+"negz."+e.extension]),this.texture.format=THREE[e.format],e.enableBackground&&(this.el.sceneEl.object3D.background=this.texture),this.applyEnvMap(),this.el.addEventListener("object3dset",this.applyEnvMap.bind(this))},applyEnvMap:function(){var e=this.el.getObject3D("mesh"),t=this.texture;e&&e.traverse(function(e){e.material&&"envMap"in e.material&&(e.material.envMap=t,e.material.needsUpdate=!0)})}}},function(e,t){e.exports={schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){var e=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!e)throw new Error("No `checkpoint-controls` component found.");e.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}}},function(e,t,o){var i=o(26);e.exports={checkpoint:o(67),"cube-env-map":o(66),grab:o(65),"jump-ability":o(64),"kinematic-body":o(63),"mesh-smooth":o(62),"sphere-collider":o(61),"toggle-velocity":o(60),registerAll:function(e){this._registered||(e=e||window.AFRAME,i.registerAll(),e.components.checkpoint||e.registerComponent("checkpoint",this.checkpoint),e.components["cube-env-map"]||e.registerComponent("cube-env-map",this["cube-env-map"]),e.components.grab||e.registerComponent("grab",this.grab),e.components["jump-ability"]||e.registerComponent("jump-ability",this["jump-ability"]),e.components["kinematic-body"]||e.registerComponent("kinematic-body",this["kinematic-body"]),e.components["mesh-smooth"]||e.registerComponent("mesh-smooth",this["mesh-smooth"]),e.components["sphere-collider"]||e.registerComponent("sphere-collider",this["sphere-collider"]),e.components["toggle-velocity"]||e.registerComponent("toggle-velocity",this["toggle-velocity"]),this._registered=!0)}}},function(e,t){e.exports=THREE.PLYLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.propertyNameMapping={}},THREE.PLYLoader.prototype={constructor:THREE.PLYLoader,load:function(e,t,o,i){var n=this,r=new THREE.XHRLoader(this.manager);r.setResponseType("arraybuffer"),r.load(e,function(e){t(n.parse(e))},o,i)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},bin2str:function(e){for(var t=new Uint8Array(e),o="",i=0;i<e.byteLength;i++)o+=String.fromCharCode(t[i]);return o},isASCII:function(e){return"ascii"===this.parseHeader(this.bin2str(e)).format},parse:function(e){return e instanceof ArrayBuffer?this.isASCII(e)?this.parseASCII(this.bin2str(e)):this.parseBinary(e):this.parseASCII(e)},parseHeader:function(e){var t="",o=0,i=/ply([\s\S]*)end_header\s/.exec(e);null!==i&&(t=i[1],o=i[0].length);var n,r,s,a,l,c={comments:[],elements:[],headerLength:o},u=t.split("\n"),h=void 0;for(var g=0;g<u.length;g++){var d=u[g];if(""!==(d=d.trim()))switch(n=(r=d.split(/\s+/)).shift(),d=r.join(" "),n){case"format":c.format=r[0],c.version=r[1];break;case"comment":c.comments.push(d);break;case"element":void 0!==h&&c.elements.push(h),(h=Object()).name=r[0],h.count=parseInt(r[1]),h.properties=[];break;case"property":h.properties.push((s=r,a=this.propertyNameMapping,l=void 0,"list"===(l={type:s[0]}).type?(l.name=s[3],l.countType=s[1],l.itemType=s[2]):l.name=s[1],l.name in a&&(l.name=a[l.name]),l));break;default:console.log("unhandled",n,r)}}return void 0!==h&&c.elements.push(h),c},parseASCIINumber:function(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}},parseASCIIElement:function(e,t){for(var o=t.split(/\s+/),i=Object(),n=0;n<e.length;n++)if("list"===e[n].type){for(var r=[],s=this.parseASCIINumber(o.shift(),e[n].countType),a=0;a<s;a++)r.push(this.parseASCIINumber(o.shift(),e[n].itemType));i[e[n].name]=r}else i[e[n].name]=this.parseASCIINumber(o.shift(),e[n].type);return i},parseASCII:function(e){var t,o=new THREE.Geometry,i=this.parseHeader(e),n="";null!==(t=/end_header\s([\s\S]*)$/.exec(e))&&(n=t[1]);var r=n.split("\n"),s=0,a=0;o.useColor=!1;for(var l=0;l<r.length;l++){var c=r[l];if(""!==(c=c.trim())){a>=i.elements[s].count&&(s++,a=0);var u=this.parseASCIIElement(i.elements[s].properties,c);this.handleElement(o,i.elements[s].name,u),a++}}return this.postProcess(o)},postProcess:function(e){if(e.useColor){for(var t=0;t<e.faces.length;t++)e.faces[t].vertexColors=[e.colors[e.faces[t].a],e.colors[e.faces[t].b],e.colors[e.faces[t].c]];e.elementsNeedUpdate=!0}return e.computeBoundingSphere(),e},handleElement:function(e,t,o){if("vertex"===t){if(e.vertices.push(new THREE.Vector3(o.x,o.y,o.z)),"red"in o&&"green"in o&&"blue"in o){e.useColor=!0;var i=new THREE.Color;i.setRGB(o.red/255,o.green/255,o.blue/255),e.colors.push(i)}}else if("face"===t){var n=o.vertex_indices||o.vertex_index;3===n.length?e.faces.push(new THREE.Face3(n[0],n[1],n[2])):4===n.length&&e.faces.push(new THREE.Face3(n[0],n[1],n[3]),new THREE.Face3(n[1],n[2],n[3]))}},binaryRead:function(e,t,o,i){switch(o){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,i),2];case"uint16":case"ushort":return[e.getUint16(t,i),2];case"int32":case"int":return[e.getInt32(t,i),4];case"uint32":case"uint":return[e.getUint32(t,i),4];case"float32":case"float":return[e.getFloat32(t,i),4];case"float64":case"double":return[e.getFloat64(t,i),8]}},binaryReadElement:function(e,t,o,i){for(var n,r=Object(),s=0,a=0;a<o.length;a++)if("list"===o[a].type){var l=[],c=(n=this.binaryRead(e,t+s,o[a].countType,i))[0];s+=n[1];for(var u=0;u<c;u++)n=this.binaryRead(e,t+s,o[a].itemType,i),l.push(n[0]),s+=n[1];r[o[a].name]=l}else n=this.binaryRead(e,t+s,o[a].type,i),r[o[a].name]=n[0],s+=n[1];return[r,s]},parseBinary:function(e){for(var t,o=new THREE.Geometry,i=this.parseHeader(this.bin2str(e)),n="binary_little_endian"===i.format,r=new DataView(e,i.headerLength),s=0,a=0;a<i.elements.length;a++)for(var l=0;l<i.elements[a].count;l++){s+=(t=this.binaryReadElement(r,s,i.elements[a].properties,n))[1];var c=t[0];this.handleElement(o,i.elements[a].name,c)}return this.postProcess(o)}}},function(e,t,o){THREE.PLYLoader=o(69),e.exports.System={init:function(){this.cache={}},getOrLoadGeometry:function(e,t){var o=this.cache,i=o[e];return!t&&i?i:(o[e]=new Promise(function(t){(new THREE.PLYLoader).load(e,function(e){t(e)})}),o[e])}},e.exports.Component={schema:{skipCache:{type:"boolean",default:!1},src:{type:"asset"}},init:function(){this.model=null},update:function(){var e=this.data,t=this.el;e.src?this.system.getOrLoadGeometry(e.src,e.skipCache).then(function(e){var o=function(e){return new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,vertexColors:THREE.VertexColors,shininess:0}))}(e);t.setObject3D("mesh",o),t.emit("model-loaded",{format:"ply",model:o})}):console.warn("[%s] `src` property is required.",this.name)},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},function(e,t){e.exports={schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var e,t=this.data;t.src&&(this.remove(),e=new THREE.ObjectLoader,t.crossorigin&&e.setCrossOrigin(t.crossorigin),e.load(t.src,function(e){e.traverse(function(e){e instanceof THREE.SkinnedMesh&&e.material&&(e.material.skinning=!!(e.geometry&&e.geometry.bones||[]).length)}),this.load(e)}.bind(this)))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"json",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},function(e,t){e.exports={schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var e,t=this.data;t.src&&(this.remove(),e=new THREE.JSONLoader,t.crossorigin&&(e.crossOrigin=t.crossorigin),e.load(t.src,function(e,t){t.forEach(function(t){t.vertexColors=(e.faces[0]||{}).color?THREE.FaceColors:THREE.NoColors,t.skinning=!!(e.bones||[]).length,t.morphTargets=!!(e.morphTargets||[]).length,t.morphNormals=!!(e.morphNormals||[]).length});var o=(e.bones||[]).length?new THREE.SkinnedMesh(e,new THREE.MultiMaterial(t)):new THREE.Mesh(e,new THREE.MultiMaterial(t));this.load(o)}.bind(this)))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"json",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},function(e,t){function o(e){const t=document.getElementById(e),o=t.parentNode;try{o&&o.removeChild(t)}catch(e){}}function i(e,t,i){return new i(function(i,n){const r=t.timeout||5e3,s="script_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),a=function(e,t){var o=document.createElement("script");return o.type="text/javascript",o.async=!0,o.id=t,o.src=e,o}(e,s),l=setTimeout(function(){n(new Error("Script request to "+e+" timed out")),o(s)},r),c=function(e){clearTimeout(e)};a.addEventListener("load",function(e){i({ok:!0}),c(l),o(s)}),a.addEventListener("error",function(t){n(new Error("Script request to "+e+" failed "+t)),c(l),o(s)}),function(e){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(a)})}e.exports=function(e){return e=e||{},function(t,o){return i(t,o=o||{},e.Promise||Promise)}}},function(e,t,o){var i=o(73)();e.exports={schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=r().then(function(){this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")}.bind(this))},update:function(){var e=this,t=this.el,o=this.data;o&&(this.remove(),this.loaderPromise.then(function(){this.loader.load(o,function(o){e.model=o.scene,e.model.animations=o.animations,t.setObject3D("mesh",e.model),t.emit("model-loaded",{format:"gltf",model:e.model})})}.bind(this)))},remove:function(){this.model&&this.el.removeObject3D("mesh")}};var n,r=function(){return n=n||i("https://rawgit.com/mrdoob/three.js/r86/examples/js/loaders/GLTFLoader.js")}},function(e,t){!function(){function t(e){var t,o=e.properties.Content,i=e.properties.RelativeFilename||e.properties.Filename,n=i.slice(i.lastIndexOf(".")+1).toLowerCase();switch(n){case"bmp":t="image/bmp";break;case"jpg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;default:return void console.warn("FBXLoader: No support image type "+n)}if("string"==typeof o)return"data:"+t+";base64,"+o;var r=new Uint8Array(o);return window.URL.createObjectURL(new Blob([r],{type:t}))}function o(e,t,o,i){var n,r=e.id,s=e.name,a=e.properties.FileName,l=e.properties.RelativeFilename,c=i.get(r).children;if(void 0!==c&&c.length>0&&o.has(c[0].ID))n=o.get(c[0].ID);else if(void 0!==l&&"/"!==l[0]&&null===l.match(/^[a-zA-Z]:/))n=l;else{var u=a.split(/[\\\/]/);n=u.length>0?u[u.length-1]:a}var h=t.path;0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||t.setPath(void 0);var g=t.load(n);g.name=s,g.FBX_ID=r;var d=e.properties.WrapModeU,p=e.properties.WrapModeV,f=void 0!==d?d.value:0,m=void 0!==p?p.value:0;return g.wrapS=0===f?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,g.wrapT=0===m?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,t.setPath(h),g}function i(e,t,o){var i=e.id,n=e.attrName,r=e.properties.ShadingModel;if("object"==typeof r&&(r=r.value),!o.has(i))return null;var s,a=o.get(i).children,l=function(e,t,o){var i={};e.Diffuse&&(i.color=x(e.Diffuse));e.Specular&&(i.specular=x(e.Specular));e.Shininess&&(i.shininess=e.Shininess.value);e.Emissive&&(i.emissive=x(e.Emissive));e.EmissiveFactor&&(i.emissiveIntensity=e.EmissiveFactor.value);e.Opacity&&(i.opacity=e.Opacity.value);i.opacity<1&&(i.transparent=!0);for(var n=0,r=o.length;n<r;++n){var s=o[n],a=s.relationship;switch(a){case"DiffuseColor":case' "DiffuseColor':i.map=t.get(s.ID);break;case"Bump":case' "Bump':i.bumpMap=t.get(s.ID);break;case"NormalMap":case' "NormalMap':i.normalMap=t.get(s.ID);break;case"AmbientColor":case"EmissiveColor":case' "AmbientColor':case' "EmissiveColor':default:console.warn("THREE.FBXLoader: Unknown texture application of type %s, skipping texture.",a)}}return i}(e.properties,t,a);switch(r.toLowerCase()){case"phong":s=new THREE.MeshPhongMaterial;break;case"lambert":s=new THREE.MeshLambertMaterial;break;default:console.warn("THREE.FBXLoader: No implementation given for material type %s in FBXLoader.js. Defaulting to standard material.",r),s=new THREE.MeshStandardMaterial({color:3342591})}return s.setValues(l),s.name=n,s}function n(e,t){for(var o={},i=e.children,n=0,r=i.length;n<r;++n){var s=i[n],a=t[s.ID],l={FBX_ID:s.ID,index:n,indices:[],weights:[],transform:O(a.subNodes.Transform.properties.a),transformLink:O(a.subNodes.TransformLink.properties.a),linkMode:a.properties.Mode};"Indexes"in a.subNodes&&(l.indices=R(a.subNodes.Indexes.properties.a),l.weights=I(a.subNodes.Weights.properties.a)),o[s.ID]=l}return{map:o,bones:[]}}function r(e,t,o){switch(e.attrType){case"Mesh":return function(e,t,o){for(var i=0;i<t.children.length;++i){var n=o[t.children[i].ID];if(void 0!==n)break}return function(e,t){var o=new M,i=e.subNodes,n=I(i.Vertices.properties.a),r=R(i.PolygonVertexIndex.properties.a);if(i.LayerElementNormal)var s=function(e){var t=e.properties.MappingInformationType,o=e.properties.ReferenceInformationType,i=I(e.subNodes.Normals.properties.a),n=[];"IndexToDirect"===o&&("NormalIndex"in e.subNodes?n=R(e.subNodes.NormalIndex.properties.a):"NormalsIndex"in e.subNodes&&(n=R(e.subNodes.NormalsIndex.properties.a)));return{dataSize:3,buffer:i,indices:n,mappingType:t,referenceType:o}}(i.LayerElementNormal[0]);if(i.LayerElementUV)var a=function(e){var t=e.properties.MappingInformationType,o=e.properties.ReferenceInformationType,i=I(e.subNodes.UV.properties.a),n=[];"IndexToDirect"===o&&(n=R(e.subNodes.UVIndex.properties.a));return{dataSize:2,buffer:i,indices:n,mappingType:t,referenceType:o}}(i.LayerElementUV[0]);if(i.LayerElementColor)var c=function(e){var t=e.properties.MappingInformationType,o=e.properties.ReferenceInformationType,i=I(e.subNodes.Colors.properties.a),n=[];"IndexToDirect"===o&&(n=I(e.subNodes.ColorIndex.properties.a));return{dataSize:4,buffer:i,indices:n,mappingType:t,referenceType:o}}(i.LayerElementColor[0]);if(i.LayerElementMaterial)var u=function(e){var t=e.properties.MappingInformationType,o=e.properties.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:o};for(var i=R(e.subNodes.Materials.properties.a),n=[],r=0,s=i.length;r<s;++r)n.push(r);return{dataSize:1,buffer:i,indices:n,mappingType:t,referenceType:o}}(i.LayerElementMaterial[0]);var h={};if(t){var g=t.map;for(var d in g)for(var p=g[d],f=p.indices,m=0;m<f.length;m++){var y=f[m],v=p.weights[m];void 0===h[y]&&(h[y]=[]),h[y].push({id:p.index,weight:v})}}for(var E=[],T=0,A=!1,S=0;S<r.length;S++){var w=r[S],C=!1;w<0&&(w^=-1,r[S]=w,C=!0);var N=new _,L=[],D=[];if(N.position.fromArray(n,3*w),t){if(void 0!==h[w])for(var x=h[w],m=0,O=x.length;m<O;m++)D.push(x[m].weight),L.push(x[m].id);if(D.length>4){A||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),A=!0);var k=[0,0,0,0],B=[0,0,0,0];D.forEach(function(e,t){var o=e,i=L[t];B.forEach(function(e,t,n){if(o>e){n[t]=o,o=e;var r=k[t];k[t]=i,i=r}})}),L=k,D=B}for(var P=D.length;P<4;++P)D[P]=0,L[P]=0;N.skinWeights.fromArray(D),N.skinIndices.fromArray(L)}if(s&&N.normal.fromArray(l(S,T,w,s)),a&&N.uv.fromArray(l(S,T,w,a)),c&&N.color.fromArray(l(S,T,w,c)),E.push(N),C){var U=new b;if(U.genTrianglesFromVertices(E),void 0!==u){var F=l(S,T,w,u);U.materialIndex=F[0]}else U.materialIndex=0;o.faces.push(U),E=[],T++,C=!1}}var H=o.flattenToBuffers(),j=new THREE.BufferGeometry;j.name=e.name,j.addAttribute("position",new THREE.Float32BufferAttribute(H.vertexBuffer,3)),H.normalBuffer.length>0&&j.addAttribute("normal",new THREE.Float32BufferAttribute(H.normalBuffer,3));H.uvBuffer.length>0&&j.addAttribute("uv",new THREE.Float32BufferAttribute(H.uvBuffer,2));i.LayerElementColor&&j.addAttribute("color",new THREE.Float32BufferAttribute(H.colorBuffer,3));t&&(j.addAttribute("skinIndex",new THREE.Float32BufferAttribute(H.skinIndexBuffer,4)),j.addAttribute("skinWeight",new THREE.Float32BufferAttribute(H.skinWeightBuffer,4)),j.FBX_Deformer=t);for(var z=H.materialIndexBuffer,V=z[0],G=0,P=0;P<z.length;++P)z[P]!==V&&(j.addGroup(G,P-G,V),V=z[P],G=P);return j}(e,n)}(e,t,o);case"NurbsCurve":return function(e){if(void 0===THREE.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var t=parseInt(e.properties.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.properties.Order,e.id),new THREE.BufferGeometry;for(var o,i,n=t-1,r=I(e.subNodes.KnotVector.properties.a),s=[],a=I(e.subNodes.Points.properties.a),l=0,c=a.length;l<c;l+=4)s.push((new THREE.Vector4).fromArray(a,l));if("Closed"===e.properties.Form)s.push(s[0]);else if("Periodic"===e.properties.Form){o=n,i=r.length-1-o;for(var l=0;l<n;++l)s.push(s[l])}for(var u=new THREE.NURBSCurve(n,r,s,o,i).getPoints(7*s.length),h=new Float32Array(3*u.length),l=0,c=u.length;l<c;++l)u[l].toArray(h,3*l);var g=new THREE.BufferGeometry;return g.addAttribute("position",new THREE.BufferAttribute(h,3)),g}(e)}}e.exports=THREE.FBXLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},Object.assign(THREE.FBXLoader.prototype,{load:function(e,t,o,i){var n=this,r=THREE.Loader.prototype.extractUrlBase(e),s=new THREE.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(o){try{var s=n.parse(o,r);t(s)}catch(t){window.setTimeout(function(){i&&i(t),n.manager.itemError(e)},0)}},o,i)},parse:function(e,s){var a,l,g;if(g="Kaydara FBX Binary  \0",(l=e).byteLength>=g.length&&g===k(l,0,g.length))a=(new S).parse(e);else{var d=k(e);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],o=0;function i(t){var i=e[t-1];return e=e.slice(o+t),o++,i}for(var n=0;n<t.length;++n){var r=i(1);if(r===t[n])return!1}return!0}(d))throw new Error("THREE.FBXLoader: Unknown format.");if(N(d)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+N(d));a=(new A).parse(d)}var p=function(e){var t=new Map;if("Connections"in e)for(var o=e.Connections.properties.connections,i=0,n=o.length;i<n;++i){var r=o[i];t.has(r[0])||t.set(r[0],{parents:[],children:[]});var s={ID:r[1],relationship:r[2]};t.get(r[0]).parents.push(s),t.has(r[1])||t.set(r[1],{parents:[],children:[]});var a={ID:r[0],relationship:r[2]};t.get(r[1]).children.push(a)}return t}(a),f=function(e){var o=new Map;if("Video"in e.Objects.subNodes){var i=e.Objects.subNodes.Video;for(var n in i){var r=i[n];if("Content"in r.properties){var s=t(i[n]);o.set(parseInt(n),s)}}}return o}(a),y=function(e,t,o){var n=new Map;if("Material"in e.Objects.subNodes){var r=e.Objects.subNodes.Material;for(var s in r){var a=i(r[s],t,o);null!==a&&n.set(parseInt(s),a)}}return n}(a,function(e,t,i,n){var r=new Map;if("Texture"in e.Objects.subNodes){var s=e.Objects.subNodes.Texture;for(var a in s){var l=o(s[a],t,i,n);r.set(parseInt(a),l)}}return r}(a,new THREE.TextureLoader(this.manager).setPath(s),f,p),p),v=function(e,t){var o={};if("Deformer"in e.Objects.subNodes){var i=e.Objects.subNodes.Deformer;for(var r in i){var s=i[r];if("Skin"===s.attrType){var a=t.get(parseInt(r)),l=n(a,i);l.FBX_ID=parseInt(r),o[r]=l}}}return o}(a,p);return function(e,t,o,i,n){var r=new THREE.Group,s=e.Objects.subNodes.Model,a=[],l=new Map;for(var g in s){for(var d=parseInt(g),p=s[g],f=t.get(d),y=null,v=0;v<f.parents.length;++v)for(var E in o){var _=o[E],T=_.map,b=T[f.parents[v].ID];if(b){var M=y;y=new THREE.Bone,_.bones[b.index]=y,null!==M&&y.add(M)}}if(!y)switch(p.attrType){case"Mesh":for(var A=null,S=null,w=[],C=0,N=f.children.length;C<N;++C){var L=f.children[C];i.has(L.ID)&&(A=i.get(L.ID)),n.has(L.ID)&&w.push(n.get(L.ID))}if(w.length>1?S=w:w.length>0?S=w[0]:(S=new THREE.MeshStandardMaterial({color:3342591}),w.push(S)),"color"in A.attributes)for(var R=0,x=w.length;R<x;++R)w[R].vertexColors=THREE.VertexColors;if(A.FBX_Deformer){for(var k=0,F=w.length;k<F;++k)w[k].skinning=!0;y=new THREE.SkinnedMesh(A,S)}else y=new THREE.Mesh(A,S);break;case"NurbsCurve":for(var A=null,C=0,N=f.children.length;C<N;++C){var L=f.children[C];i.has(L.ID)&&(A=i.get(L.ID))}S=new THREE.LineBasicMaterial({color:3342591,linewidth:5}),y=new THREE.Line(A,S);break;default:y=new THREE.Object3D}y.name=p.attrName.replace(/:/,"").replace(/_/,"").replace(/-/,""),y.FBX_ID=d,a.push(y),l.set(d,y)}for(var H=0,j=a.length;H<j;++H){var y=a[H],p=s[y.FBX_ID];if("Lcl_Translation"in p.properties&&y.position.fromArray(I(p.properties.Lcl_Translation.value)),"Lcl_Rotation"in p.properties){var z=I(p.properties.Lcl_Rotation.value).map(B);z.push("ZYX"),y.rotation.fromArray(z)}if("Lcl_Scaling"in p.properties&&y.scale.fromArray(I(p.properties.Lcl_Scaling.value)),"PreRotation"in p.properties){var V=(new THREE.Euler).setFromVector3(D(p.properties.PreRotation).multiplyScalar(P),"ZYX");V=(new THREE.Quaternion).setFromEuler(V);var G=(new THREE.Quaternion).setFromEuler(y.rotation);V.multiply(G),y.rotation.setFromQuaternion(V,"ZYX")}for(var f=t.get(y.FBX_ID),W=0;W<f.parents.length;W++){var Y=U(a,function(e){return e.FBX_ID===f.parents[W].ID});if(Y>-1){a[Y].add(y);break}}null===y.parent&&r.add(y)}r.updateMatrixWorld(!0);var X=e.Objects.subNodes.Pose;for(var g in X)if("BindPose"===X[g].attrType){X=X[g];break}if(X)for(var K=X.subNodes.PoseNode,Q=new Map,q=0,J=K.length;q<J;++q){var p=K[q],$=O(p.subNodes.Matrix.properties.a);Q.set(parseInt(p.id),$)}for(var E in o){var _=o[E],T=_.map;for(var Z in T){var b=T[Z],ee=b.index,te=_.bones[ee];if(!Q.has(te.FBX_ID))break;var oe=Q.get(te.FBX_ID);te.matrixWorld.copy(oe)}_.skeleton=new THREE.Skeleton(_.bones);for(var f=t.get(_.FBX_ID),ie=f.parents,ne=0,re=ie.length;ne<re;++ne){var se=ie[ne];if(i.has(se.ID))for(var ae=se.ID,le=t.get(ae),v=0;v<le.parents.length;++v)if(l.has(le.parents[v].ID)){var y=l.get(le.parents[v].ID);y.bind(_.skeleton,y.matrixWorld);break}}}r.updateMatrixWorld(!0),r.skeleton={bones:a};var ce=function(e,t,o){var i=e.Objects.subNodes.AnimationCurveNode,n=e.Objects.subNodes.AnimationCurve,r=e.Objects.subNodes.AnimationLayer,s=e.Objects.subNodes.AnimationStack,a={curves:new Map,layers:{},stacks:{},length:0,fps:30,frames:0},l=[];for(var g in i)if(g.match(/\d+/)){var d=c(e,i[g],t,o);l.push(d)}for(var p=new Map,f=0;f<l.length;++f)null!==l[f]&&p.set(l[f].id,l[f]);var m=[];for(g in n)if(g.match(/\d+/)){var y=u(n[g]);if(!t.has(y.id))continue;m.push(y);var v=t.get(y.id).parents[0],E=v.ID,_=v.relationship,T="";if(_.match(/X/))T="x";else if(_.match(/Y/))T="y";else{if(!_.match(/Z/))continue;T="z"}p.get(E).curves[T]=y}for(var g in p.forEach(function(e){var t=e.containerBoneID;if(a.curves.has(t)||a.curves.set(t,{T:null,R:null,S:null}),a.curves.get(t)[e.attr]=e,"R"===e.attr){var o=e.curves;if(null===o.x&&(o.x={version:null,times:[0],values:[0]}),null===o.y&&(o.y={version:null,times:[0],values:[0]}),null===o.z&&(o.z={version:null,times:[0],values:[0]}),o.x.values=o.x.values.map(B),o.y.values=o.y.values.map(B),o.z.values=o.z.values.map(B),null!==e.preRotations){var i=(new THREE.Euler).setFromVector3(e.preRotations,"ZYX");i=(new THREE.Quaternion).setFromEuler(i);for(var n=new THREE.Euler,r=new THREE.Quaternion,s=0;s<o.x.times.length;++s)n.set(o.x.values[s],o.y.values[s],o.z.values[s],"ZYX"),r.setFromEuler(n).premultiply(i),n.setFromQuaternion(r,"ZYX"),o.x.values[s]=n.x,o.y.values[s]=n.y,o.z.values[s]=n.z}}}),r){for(var b=[],M=t.get(parseInt(g)).children,A=0;A<M.length;A++)if(p.has(M[A].ID)){var S=p.get(M[A].ID),w=S.containerBoneID;void 0===b[w]&&(b[w]={T:null,R:null,S:null}),b[w][S.attr]=S}a.layers[g]=b}for(var g in s){for(var C=[],M=t.get(parseInt(g)).children,N={max:0,min:Number.MAX_VALUE},A=0;A<M.length;++A){var L=a.layers[M[A].ID];if(void 0!==L){C.push(L);for(var I=0,R=L.length;I<R;++I){var b=L[I];b&&h(b,N)}}}N.max>N.min&&(a.stacks[g]={name:s[g].attrName,layers:C,length:N.max-N.min,frames:30*(N.max-N.min)})}return a}(e,t,r);return function(e,t){void 0===e.animations&&(e.animations=[]);var o=t.stacks;for(var i in o){for(var n=o[i],r={name:n.name,fps:30,length:n.length,hierarchy:[]},s=e.skeleton.bones,a=0,l=s.length;a<l;++a){var c=s[a],u=c.name.replace(/.*:/,""),h=U(s,function(e){return c.parent===e});r.hierarchy.push({parent:h,name:u,keys:[]})}for(var g=0;g<=n.frames;g++)for(var a=0,l=s.length;a<l;++a)for(var c=s[a],d=a,p=n.layers[0][d],f=0,y=r.hierarchy.length;f<y;++f){var v=r.hierarchy[f];v.name===c.name&&v.keys.push(m(t,p,c,g))}e.animations.push(THREE.AnimationClip.parseAnimation(r,s))}}(r,ce),r}(a,p,v,function(e,t,o){var i=new Map;if("Geometry"in e.Objects.subNodes){var n=e.Objects.subNodes.Geometry;for(var s in n){var a=t.get(parseInt(s)),l=r(n[s],a,o);i.set(parseInt(s),l)}}return i}(a,p,v),y)}});var s=[],a={ByPolygonVertex:{Direct:function(e,t,o,i){var n=e*i.dataSize,r=e*i.dataSize+i.dataSize;return H(s,i.buffer,n,r)},IndexToDirect:function(e,t,o,i){var n=i.indices[e],r=n*i.dataSize,a=n*i.dataSize+i.dataSize;return H(s,i.buffer,r,a)}},ByPolygon:{Direct:function(e,t,o,i){var n=t*i.dataSize,r=t*i.dataSize+i.dataSize;return H(s,i.buffer,n,r)},IndexToDirect:function(e,t,o,i){var n=i.indices[t],r=n*i.dataSize,a=n*i.dataSize+i.dataSize;return H(s,i.buffer,r,a)}},ByVertice:{Direct:function(e,t,o,i){var n=o*i.dataSize,r=o*i.dataSize+i.dataSize;return H(s,i.buffer,n,r)}},AllSame:{IndexToDirect:function(e,t,o,i){var n=i.indices[0]*i.dataSize,r=i.indices[0]*i.dataSize+i.dataSize;return H(s,i.buffer,n,r)}}};function l(e,t,o,i){return a[i.mappingType][i.referenceType](e,t,o,i)}function c(e,t,o,i){var n=e.Objects.subNodes.Model,r={id:t.id,attr:t.attrName,internalID:t.id,attrX:!1,attrY:!1,attrZ:!1,containerBoneID:-1,containerID:-1,curves:{x:null,y:null,z:null},preRotations:null};if(!r.attr.match(/S|R|T/))return null;for(var s in t.properties)s.match(/X/)&&(r.attrX=!0),s.match(/Y/)&&(r.attrY=!0),s.match(/Z/)&&(r.attrZ=!0);for(var a=o.get(r.id).parents,l=a.length-1;l>=0;--l){var c=U(i.skeleton.bones,function(e){return e.FBX_ID===a[l].ID});if(c>-1){r.containerBoneID=c,r.containerID=a[l].ID;var u=n[r.containerID.toString()];"PreRotation"in u.properties&&(r.preRotations=D(u.properties.PreRotation).multiplyScalar(Math.PI/180));break}}return r}function u(e){return{version:null,id:e.id,internalID:e.id,times:I(e.subNodes.KeyTime.properties.a).map(L),values:I(e.subNodes.KeyValueFloat.properties.a),attrFlag:R(e.subNodes.KeyAttrFlags.properties.a),attrData:I(e.subNodes.KeyAttrDataFloat.properties.a)}}function h(e,t){e.R&&g(e.R.curves,t),e.S&&g(e.S.curves,t),e.T&&g(e.T.curves,t)}function g(e,t){e.x&&d(e.x,t),e.y&&d(e.y,t),e.z&&d(e.z,t)}function d(e,t){t.max=e.times[e.times.length-1]>t.max?e.times[e.times.length-1]:t.max,t.min=e.times[0]<t.min?e.times[0]:t.min}var p=new THREE.Euler,f=new THREE.Quaternion;function m(e,t,o,i){var n={time:i/e.fps,pos:o.position.toArray(),rot:o.quaternion.toArray(),scl:o.scale.toArray()};if(void 0===t)return n;try{if(v(t,"T")&&E(t.T,i)&&(n.pos=[t.T.curves.x.values[i],t.T.curves.y.values[i],t.T.curves.z.values[i]]),v(t,"R")&&E(t.R,i)){var r=t.R.curves.x.values[i],s=t.R.curves.y.values[i],a=t.R.curves.z.values[i];f.setFromEuler(p.set(r,s,a,"ZYX")),n.rot=f.toArray()}v(t,"S")&&E(t.S,i)&&(n.scl=[t.S.curves.x.values[i],t.S.curves.y.values[i],t.S.curves.z.values[i]])}catch(e){console.log("THREE.FBXLoader: ",o),console.log("THREE.FBXLoader: ",e)}return n}var y=["x","y","z"];function v(e,t){if(void 0===e)return!1;var o=e[t];return!!o&&y.every(function(e){return null!==o.curves[e]})}function E(e,t){return y.every(function(o){return function(e,t){return void 0!==e.values[t]}(e.curves[o],t)})}function _(){this.position=new THREE.Vector3,this.normal=new THREE.Vector3,this.uv=new THREE.Vector2,this.color=new THREE.Vector3,this.skinIndices=new THREE.Vector4(0,0,0,0),this.skinWeights=new THREE.Vector4(0,0,0,0)}function T(){this.vertices=[]}function b(){this.triangles=[],this.materialIndex=0}function M(){this.faces=[],this.skeleton=null}function A(){}function S(){}function w(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function C(){}function N(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function L(e){return e/46186158e3}function I(e){for(var t=e.split(","),o=0,i=t.length;o<i;o++)t[o]=parseFloat(t[o]);return t}function R(e){for(var t=e.split(","),o=0,i=t.length;o<i;o++)t[o]=parseInt(t[o]);return t}function D(e){return(new THREE.Vector3).fromArray(e.value)}function x(e){return(new THREE.Color).fromArray(e.value)}function O(e){return(new THREE.Matrix4).fromArray(I(e))}function k(e,t,o){void 0===t&&(t=0),void 0===o&&(o=e.byteLength);var i=new Uint8Array(e,t,o);if(void 0!==window.TextDecoder)return(new TextDecoder).decode(i);for(var n="",r=0,s=i.length;r<s;r++)n+=String.fromCharCode(i[r]);return n}function B(e){return e*P}Object.assign(_.prototype,{copy:function(e){var t=e||new _;return t.position.copy(this.position),t.normal.copy(this.normal),t.uv.copy(this.uv),t.skinIndices.copy(this.skinIndices),t.skinWeights.copy(this.skinWeights),t},flattenToBuffers:function(e,t,o,i,n,r){this.position.toArray(e,e.length),this.normal.toArray(t,t.length),this.uv.toArray(o,o.length),this.color.toArray(i,i.length),this.skinIndices.toArray(n,n.length),this.skinWeights.toArray(r,r.length)}}),Object.assign(T.prototype,{copy:function(e){for(var t=e||new T,o=0;o<this.vertices.length;++o)this.vertices[o].copy(t.vertices[o]);return t},flattenToBuffers:function(e,t,o,i,n,r){for(var s=this.vertices,a=0,l=s.length;a<l;++a)s[a].flattenToBuffers(e,t,o,i,n,r)}}),Object.assign(b.prototype,{copy:function(e){for(var t=e||new b,o=0;o<this.triangles.length;++o)this.triangles[o].copy(t.triangles[o]);return t.materialIndex=this.materialIndex,t},genTrianglesFromVertices:function(e){for(var t=2;t<e.length;++t){var o=new T;o.vertices[0]=e[0],o.vertices[1]=e[t-1],o.vertices[2]=e[t],this.triangles.push(o)}},flattenToBuffers:function(e,t,o,i,n,r,s){for(var a=this.triangles,l=this.materialIndex,c=0,u=a.length;c<u;++c)a[c].flattenToBuffers(e,t,o,i,n,r),F(s,[l,l,l])}}),Object.assign(M.prototype,{flattenToBuffers:function(){for(var e=[],t=[],o=[],i=[],n=[],r=[],s=[],a=this.faces,l=0,c=a.length;l<c;++l)a[l].flattenToBuffers(e,t,o,i,n,r,s);return{vertexBuffer:e,normalBuffer:t,uvBuffer:o,colorBuffer:i,skinIndexBuffer:n,skinWeightBuffer:r,materialIndexBuffer:s}}}),Object.assign(A.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new C,this.nodeStack=[],this.currentProp=[],this.currentPropName="";for(var t=e.split("\n"),o=0,i=t.length;o<i;o++){if(!(l=t[o]).match(/^[\s\t]*;/)&&!l.match(/^[\s\t]*$/)){var n=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):(.*){","");if(c=l.match(n)){for(var r=c[1].trim().replace(/^"/,"").replace(/"$/,""),s=c[2].split(","),a=0,l=s.length;a<l;a++)s[a]=s[a].trim().replace(/^"/,"").replace(/"$/,"");this.parseNodeBegin(l,r,s||null)}else{var c,u=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)");if(c=l.match(u)){var h=c[1].replace(/^"/,"").replace(/"$/,"").trim(),g=c[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===h&&","===g&&(g=t[++o].replace(/"/g,"").trim()),this.parseNodeProperty(l,h,g)}else{var d=new RegExp("^\\t{"+(this.currentIndent-1)+"}}");l.match(d)?this.nodeEnd():l.match(/^[^\s\t}]/)&&this.parseNodePropertyContinued(l)}}}}return this.allNodes},parseNodeBegin:function(e,t,o){var i={name:t,properties:{},subNodes:{}},n=this.parseNodeAttr(o),r=this.getCurrentNode();if(0===this.currentIndent)this.allNodes.add(t,i);else if(t in r.subNodes){var s=r.subNodes[t];this.isFlattenNode(r.subNodes[t])&&(""===n.id?(r.subNodes[t]=[],r.subNodes[t].push(s)):(r.subNodes[t]={},r.subNodes[t][s.id]=s)),""===n.id?r.subNodes[t].push(i):r.subNodes[t][n.id]=i}else"number"==typeof n.id||n.id.match(/^\d+$/)?(r.subNodes[t]={},r.subNodes[t][n.id]=i):r.subNodes[t]=i;o&&(i.id=n.id,i.attrName=n.name,i.attrType=n.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var o="",i="";return e.length>1&&(o=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:t,name:o,type:i}},parseNodeProperty:function(e,t,o){var i=this.getCurrentNode(),n=i.name;if(void 0!==n&&n.match(/Properties(\d)+/))return void this.parseNodeSpecialProperty(e,t,o);if("C"===t){var r=o.split(",").slice(1),s=parseInt(r[0]),a=parseInt(r[1]),l=o.split(",").slice(3);t="connections",F(o=[s,a],l),void 0===i.properties[t]&&(i.properties[t]=[])}if("Node"===t){var c=parseInt(o);i.properties.id=c,i.id=c}t in i.properties?Array.isArray(i.properties[t])?i.properties[t].push(o):i.properties[t]+=o:Array.isArray(i.properties[t])?i.properties[t].push(o):i.properties[t]=o,this.setCurrentProp(i.properties,t)},parseNodePropertyContinued:function(e){this.currentProp[this.currentPropName]+=e},parseNodeSpecialProperty:function(e,t,o){for(var i=o.split('",'),n=0,r=i.length;n<r;n++)i[n]=i[n].trim().replace(/^\"/,"").replace(/\s/,"_");var s=i[0],a=i[1],l=i[2],c=i[3],u=i[4];switch(a){case"int":u=parseInt(u);break;case"double":u=parseFloat(u);break;case"ColorRGB":case"Vector3D":u=I(u)}this.getPrevNode().properties[s]={type:a,type2:l,flag:c,value:u},this.setCurrentProp(this.getPrevNode().properties,s)},nodeEnd:function(){this.popStack()},isFlattenNode:function(e){return"subNodes"in e&&"properties"in e}}),Object.assign(S.prototype,{parse:function(e){var t=new w(e);t.skip(23);var o=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+o);for(var i=new C;!this.endOfContent(t);){var n=this.parseNode(t,o);null!==n&&i.add(n.name,n)}return i},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var o=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32(),n=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),r=e.getString(n);if(0===o)return null;for(var s=[],a=0;a<i;a++)s.push(this.parseProperty(e));var l=s.length>0?s[0]:"",c=s.length>1?s[1]:"",u=s.length>2?s[2]:"",h={},g={},d=!1;for(1===i&&e.getOffset()===o&&(d=!0);o>e.getOffset();){var p=this.parseNode(e,t);if(null!==p)if(!0!==p.singleProperty)if("Connections"!==r||"C"!==p.name)if(p.name.match(/^Properties\d+$/)){var f=Object.keys(p.properties);for(a=0,M=f.length;a<M;a++){var m=f[a];g[m]=p.properties[m]}}else if(r.match(/^Properties\d+$/)&&"P"===p.name){var y,v=p.propertyList[0],E=p.propertyList[1],_=p.propertyList[2],T=p.propertyList[3];0===v.indexOf("Lcl ")&&(v=v.replace("Lcl ","Lcl_")),0===E.indexOf("Lcl ")&&(E=E.replace("Lcl ","Lcl_")),y="ColorRGB"===E||"Vector"===E||"Vector3D"===E||0===E.indexOf("Lcl_")?[p.propertyList[4],p.propertyList[5],p.propertyList[6]]:p.propertyList[4],0===E.indexOf("Lcl_")&&(y=y.toString()),g[v]={type:E,type2:_,flag:T,value:y}}else void 0===h[p.name]?"number"==typeof p.id?(h[p.name]={},h[p.name][p.id]=p):h[p.name]=p:""===p.id?(Array.isArray(h[p.name])||(h[p.name]=[h[p.name]]),h[p.name].push(p)):void 0===h[p.name][p.id]?h[p.name][p.id]=p:(Array.isArray(h[p.name][p.id])||(h[p.name][p.id]=[h[p.name][p.id]]),h[p.name][p.id].push(p));else{for(var b=[],a=1,M=p.propertyList.length;a<M;a++)b[a-1]=p.propertyList[a];void 0===g.connections&&(g.connections=[]),g.connections.push(b)}else{var A=p.propertyList[0];Array.isArray(A)?(p.properties[p.name]=p.propertyList[0],h[p.name]=p,p.properties.a=A.toString()):g[p.name]=A}}return{singleProperty:d,id:l,attrName:c,attrType:u,name:r,properties:g,propertyList:s,subNodes:h}},parseProperty:function(e){var t=e.getChar();switch(t){case"F":return e.getFloat32();case"D":return e.getFloat64();case"L":return e.getInt64();case"I":return e.getInt32();case"Y":return e.getInt16();case"C":return e.getBoolean();case"f":case"d":case"l":case"i":case"b":var o=e.getUint32(),i=e.getUint32(),n=e.getUint32();if(0===i)switch(t){case"f":return e.getFloat32Array(o);case"d":return e.getFloat64Array(o);case"l":return e.getInt64Array(o);case"i":return e.getInt32Array(o);case"b":return e.getBooleanArray(o)}if(void 0===window.Zlib)throw new Error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var r=new w(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(n))).decompress().buffer);switch(t){case"f":return r.getFloat32Array(o);case"d":return r.getFloat64Array(o);case"l":return r.getInt64Array(o);case"i":return r.getInt32Array(o);case"b":return r.getBooleanArray(o)}case"S":var s=e.getUint32();return e.getString(s);case"R":s=e.getUint32();return e.getArrayBuffer(s);default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}),Object.assign(w.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getBoolean());return t},getInt8:function(){var e=this.dv.getInt8(this.offset);return this.offset+=1,e},getInt8Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getInt8());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint8Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getUint8());return t},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt16Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getInt16());return t},getUint16:function(){var e=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},getUint16Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getUint16());return t},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getUint32Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getUint32());return t},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getUint64Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getUint64());return t},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],o=0;o<e;o++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getChar:function(){return String.fromCharCode(this.getUint8())},getString:function(e){for(var t="";e>0;){var o=this.getUint8();if(e--,0===o)break;t+=String.fromCharCode(o)}return this.skip(e),t}}),Object.assign(C.prototype,{add:function(e,t){this[e]=t},searchConnectionParent:function(e){if(void 0===this.__cache_search_connection_parent&&(this.__cache_search_connection_parent=[]),void 0!==this.__cache_search_connection_parent[e])return this.__cache_search_connection_parent[e];this.__cache_search_connection_parent[e]=[];for(var t=this.Connections.properties.connections,o=[],i=0;i<t.length;++i)if(t[i][0]==e){var n=0===t[i][1]?-1:t[i][1];o.push(n)}return o.length>0?(F(this.__cache_search_connection_parent[e],o),o):(this.__cache_search_connection_parent[e]=[-1],[-1])},searchConnectionChildren:function(e){if(void 0===this.__cache_search_connection_children&&(this.__cache_search_connection_children=[]),void 0!==this.__cache_search_connection_children[e])return this.__cache_search_connection_children[e];this.__cache_search_connection_children[e]=[];for(var t=this.Connections.properties.connections,o=[],i=0;i<t.length;++i)t[i][1]==e&&o.push(0===t[i][0]?-1:t[i][0]);return o.length>0?(F(this.__cache_search_connection_children[e],o),o):(this.__cache_search_connection_children[e]=[],[])},searchConnectionType:function(e,t){var o=e+","+t;if(void 0===this.__cache_search_connection_type&&(this.__cache_search_connection_type={}),void 0!==this.__cache_search_connection_type[o])return this.__cache_search_connection_type[o];this.__cache_search_connection_type[o]="";for(var i=this.Connections.properties.connections,n=0;n<i.length;++n)if(i[n][0]==e&&i[n][1]==t)return this.__cache_search_connection_type[o]=i[n][2],i[n][2];return this.__cache_search_connection_type[e]=null,null}});var P=Math.PI/180;function U(e,t){for(var o=0,i=e.length;o<i;o++)if(t(e[o]))return o;return-1}function F(e,t){for(var o=0,i=e.length,n=t.length;o<n;o++,i++)e[i]=t[o]}function H(e,t,o,i){for(var n=o,r=0;n<i;n++,r++)e[r]=t[n];return e}}()},function(e,t,o){THREE.FBXLoader=o(75),e.exports={schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var e,t=this.data;t.src&&(this.remove(),e=new THREE.FBXLoader,t.crossorigin&&e.setCrossOrigin(t.crossorigin),e.load(t.src,this.load.bind(this)))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"fbx",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},function(e,t){var o={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};function i(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}e.exports={schema:{clip:{default:"*"},duration:{default:0},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(o)},repetitions:{default:1/0,min:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];var e=this.el.getObject3D("mesh");e?this.load(e):this.el.addEventListener("model-loaded",function(e){this.load(e.detail.model)}.bind(this))},load:function(e){var t=this.el;this.model=e,this.mixer=new THREE.AnimationMixer(e),this.mixer.addEventListener("loop",function(e){t.emit("animation-loop",{action:e.action,loopDelta:e.loopDelta})}.bind(this)),this.mixer.addEventListener("finished",function(e){t.emit("animation-finished",{action:e.action,direction:e.direction})}.bind(this)),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(e){e&&(this.stopAction(),this.data.clip&&this.playAction())},stopAction:function(){for(var e=this.data,t=0;t<this.activeActions.length;t++)e.crossFadeDuration?this.activeActions[t].fadeOut(e.crossFadeDuration):this.activeActions[t].stop();this.activeActions.length=0},playAction:function(){if(this.mixer){var e=this.model,t=this.data,n=e.animations||(e.geometry||{}).animations||[];if(n.length)for(var r,s,a=(r=t.clip,new RegExp("^"+r.split(/\*+/).map(i).join(".*")+"$")),l=0;s=n[l];l++)if(s.name.match(a)){var c=this.mixer.clipAction(s,e);c.enabled=!0,t.duration&&c.setDuration(t.duration),c.setLoop(o[t.loop],t.repetitions).fadeIn(t.crossFadeDuration).play(),this.activeActions.push(c)}}},tick:function(e,t){this.mixer&&!isNaN(t)&&this.mixer.update(t/1e3)}}},function(e,t,o){e.exports={"animation-mixer":o(77),"fbx-model":o(76),"gltf-model-legacy":o(74),"json-model":o(72),"object-model":o(71),"ply-model":o(70),registerAll:function(e){this._registered||((e=e||window.AFRAME).components["animation-mixer"]||e.registerComponent("animation-mixer",this["animation-mixer"]),e.systems["ply-model"]||e.registerSystem("ply-model",this["ply-model"].System),e.components["ply-model"]||e.registerComponent("ply-model",this["ply-model"].Component),e.components["fbx-model"]||e.registerComponent("fbx-model",this["fbx-model"]),e.components["gltf-model-legacy"]||e.registerComponent("gltf-model-legacy",this["gltf-model-legacy"]),e.components["json-model"]||e.registerComponent("json-model",this["json-model"]),e.components["object-model"]||e.registerComponent("object-model",this["object-model"]),this._registered=!0)}}},function(e,t){var o=Math.PI/2;e.exports={dependencies:["velocity","rotation"],schema:{enabled:{default:!0},movementEnabled:{default:!0},movementControls:{default:["gamepad","keyboard","touch","hmd"]},rotationEnabled:{default:!0},rotationControls:{default:["hmd","gamepad","mouse"]},movementSpeed:{default:5},movementEasing:{default:15},movementEasingY:{default:0},movementAcceleration:{default:80},rotationSensitivity:{default:.05},fly:{default:!1}},init:function(){var e=this.el.getAttribute("rotation");this.el.hasAttribute("look-controls")&&this.data.rotationEnabled&&console.error("[universal-controls] The `universal-controls` component is a replacement for `look-controls`, and cannot be used in combination with it."),this.velocity=new THREE.Vector3,this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(e.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(e.y),this.yaw.add(this.pitch),this.heading=new THREE.Euler(0,0,0,"YXZ"),this.el.sceneEl.hasLoaded?this.injectControls():this.el.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(){this.el.sceneEl.hasLoaded&&this.injectControls()},injectControls:function(){var e,t,o=this.data;for(e=0;e<o.movementControls.length;e++)t=o.movementControls[e]+"-controls",this.el.components[t]||this.el.setAttribute(t,"");for(e=0;e<o.rotationControls.length;e++)t=o.rotationControls[e]+"-controls",this.el.components[t]||this.el.setAttribute(t,"")},tick:function(e,t){t&&(this.data.rotationEnabled&&this.updateRotation(t),this.data.movementEnabled&&t/1e3>.2?(this.velocity.set(0,0,0),this.el.setAttribute("velocity",this.velocity)):this.updateVelocity(t))},updateRotation:function(e){for(var t,i,n=this.data,r=0,s=n.rotationControls.length;r<s;r++)if((t=this.el.components[n.rotationControls[r]+"-controls"])&&t.isRotationActive()){if(t.getRotationDelta)(i=t.getRotationDelta(e)).multiplyScalar(n.rotationSensitivity),this.yaw.rotation.y-=i.x,this.pitch.rotation.x-=i.y,this.pitch.rotation.x=Math.max(-o,Math.min(o,this.pitch.rotation.x)),this.el.setAttribute("rotation",{x:THREE.Math.radToDeg(this.pitch.rotation.x),y:THREE.Math.radToDeg(this.yaw.rotation.y),z:0});else{if(!t.getRotation)throw new Error("Incompatible rotation controls: %s",n.rotationControls[r]);this.el.setAttribute("rotation",t.getRotation())}break}},updateVelocity:function(e){var t,o,i=this.velocity,n=this.data;if(n.movementEnabled)for(var r=0,s=n.movementControls.length;r<s;r++)if((t=this.el.components[n.movementControls[r]+"-controls"])&&t.isVelocityActive()){if(!t.getVelocityDelta){if(t.getVelocity)return void this.el.setAttribute("velocity",t.getVelocity());if(t.getPositionDelta)return i.copy(t.getPositionDelta(e).multiplyScalar(1e3/e)),void this.el.setAttribute("velocity",i);throw new Error("Incompatible movement controls: ",n.movementControls[r])}o=t.getVelocityDelta(e);break}if(i.copy(this.el.getAttribute("velocity")),i.x-=i.x*n.movementEasing*e/1e3,i.y-=i.y*n.movementEasingY*e/1e3,i.z-=i.z*n.movementEasing*e/1e3,o&&n.movementEnabled){o.length()>1?o.setLength(this.data.movementAcceleration*e/1e3):o.multiplyScalar(this.data.movementAcceleration*e/1e3);var a=this.el.getAttribute("rotation");a&&(this.heading.set(n.fly?THREE.Math.degToRad(a.x):0,THREE.Math.degToRad(a.y),0),o.applyEuler(this.heading)),i.add(o)}this.el.setAttribute("velocity",i)}}},function(e,t){e.exports={schema:{enabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchend",this.onTouchEnd)):e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.el.sceneEl.canvas;e&&(e.removeEventListener("touchstart",this.onTouchStart),e.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-1:0,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(e){this.isMoving=!0,e.preventDefault()},onTouchEnd:function(e){this.isMoving=!1,e.preventDefault()}}},function(e,t){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,e.exports={schema:{enabled:{default:!0},pointerlockEnabled:{default:!0},sensitivity:{default:.04}},init:function(){this.mouseDown=!1,this.pointerLocked=!1,this.lookVector=new THREE.Vector2,this.bindMethods()},update:function(e){var t=this.data;e.pointerlockEnabled&&!t.pointerlockEnabled&&this.pointerLocked&&document.exitPointerLock()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.lookVector.set(0,0)},remove:function(){this.pause()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this)},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas,o=this.data;t?(t.addEventListener("mousedown",this.onMouseDown,!1),t.addEventListener("mousemove",this.onMouseMove,!1),t.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("mouseout",this.onMouseUp,!1),o.pointerlockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))):e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.el.sceneEl.canvas;e&&(e.removeEventListener("mousedown",this.onMouseDown,!1),e.removeEventListener("mousemove",this.onMouseMove,!1),e.removeEventListener("mouseup",this.onMouseUp,!1),e.removeEventListener("mouseout",this.onMouseUp,!1)),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1)},isRotationActive:function(){return this.data.enabled&&(this.mouseDown||this.pointerLocked)},getRotationDelta:function(){var e=this.lookVector.clone().multiplyScalar(this.data.sensitivity);return this.lookVector.set(0,0),e},onMouseMove:function(e){var t=this.previousMouseEvent;if(this.data.enabled&&(this.mouseDown||this.pointerLocked)){var o=e.movementX||e.mozMovementX||0,i=e.movementY||e.mozMovementY||0;this.pointerLocked||(o=e.screenX-t.screenX,i=e.screenY-t.screenY),this.lookVector.x+=o,this.lookVector.y+=i,this.previousMouseEvent=e}},onMouseDown:function(e){var t=this.el.sceneEl.canvas,o=(AFRAME.INSPECTOR||{}).opened;this.mouseDown=!0,this.previousMouseEvent=e,!this.data.pointerlockEnabled||this.pointerLocked||o||(t.requestPointerLock?t.requestPointerLock():t.mozRequestPointerLock&&t.mozRequestPointerLock())},onMouseUp:function(){this.mouseDown=!1},onPointerLockChange:function(){this.pointerLocked=!(!document.pointerLockElement&&!document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1}}},function(e,t,o){!function(e){var t="KeyboardEvent"in e;t||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0,e.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1,e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2,e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3;var o=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,n=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,r=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function s(e,t){return-1!==String(e).indexOf(t)}var a=s(navigator.platform,"Win")?"win":s(navigator.platform,"Mac")?"mac":s(navigator.platform,"CrOS")?"cros":s(navigator.platform,"Linux")?"linux":s(navigator.userAgent,"iPad")||s(navigator.platform,"iPod")||s(navigator.platform,"iPhone")?"ios":"",l=s(navigator.userAgent,"Chrome/")?"chrome":s(navigator.vendor,"Apple")?"safari":s(navigator.userAgent,"MSIE")?"ie":s(navigator.userAgent,"Gecko/")?"moz":s(navigator.userAgent,"Opera/")?"opera":"",c=l+"-"+a;function u(e,t,o){c!==t&&l!==t&&a!==t||Object.keys(o).forEach(function(t){e[t]=o[t]})}var h={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:n},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:r},97:{code:"Numpad1",keyCap:"1",location:r},98:{code:"Numpad2",keyCap:"2",location:r},99:{code:"Numpad3",keyCap:"3",location:r},100:{code:"Numpad4",keyCap:"4",location:r},101:{code:"Numpad5",keyCap:"5",location:r},102:{code:"Numpad6",keyCap:"6",location:r},103:{code:"Numpad7",keyCap:"7",location:r},104:{code:"Numpad8",keyCap:"8",location:r},105:{code:"Numpad9",keyCap:"9",location:r},106:{code:"NumpadMultiply",keyCap:"*",location:r},107:{code:"NumpadAdd",keyCap:"+",location:r},108:{code:"NumpadComma",keyCap:",",location:r},109:{code:"NumpadSubtract",keyCap:"-",location:r},110:{code:"NumpadDecimal",keyCap:".",location:r},111:{code:"NumpadDivide",keyCap:"/",location:r},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:r},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:n},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:n},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:n},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};u(h,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:r},189:{code:"NumpadSubtract",keyCap:"-",location:r}}),u(h,"moz-mac",{12:{code:"NumLock",location:r},173:{code:"Minus",keyCap:"-"}}),u(h,"moz-win",{173:{code:"Minus",keyCap:"-"}}),u(h,"chrome-mac",{93:{code:"OSRight",location:n}}),u(h,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),u(h,"ios",{10:{code:"Enter",location:o}}),u(h,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:n},229:{code:"KeyQ",keyCap:"Q"}});var g={};"cros"===a&&(g["U+00A0"]={code:"ShiftLeft",location:i},g["U+00A1"]={code:"ShiftRight",location:n},g["U+00A2"]={code:"ControlLeft",location:i},g["U+00A3"]={code:"ControlRight",location:n},g["U+00A4"]={code:"AltLeft",location:i},g["U+00A5"]={code:"AltRight",location:n}),"chrome-mac"===c&&(g["U+0010"]={code:"ContextMenu"}),"safari-mac"===c&&(g["U+0010"]={code:"ContextMenu"}),"ios"===a&&(g["U+0010"]={code:"Function"},g["U+001C"]={code:"ArrowLeft"},g["U+001D"]={code:"ArrowRight"},g["U+001E"]={code:"ArrowUp"},g["U+001F"]={code:"ArrowDown"},g["U+0001"]={code:"Home"},g["U+0004"]={code:"End"},g["U+000B"]={code:"PageUp"},g["U+000C"]={code:"PageDown"});var d=[];d[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},d[n]={16:{code:"ShiftRight",location:n},17:{code:"ControlRight",location:n},18:{code:"AltRight",location:n}},d[r]={13:{code:"NumpadEnter",location:r}},u(d[r],"moz",{109:{code:"NumpadSubtract",location:r},107:{code:"NumpadAdd",location:r}}),u(d[i],"moz-mac",{224:{code:"OSLeft",location:i}}),u(d[n],"moz-mac",{224:{code:"OSRight",location:n}}),u(d[n],"moz-win",{91:{code:"OSRight",location:n}}),u(d[n],"mac",{93:{code:"OSRight",location:n}}),u(d[r],"chrome-mac",{12:{code:"NumLock",location:r}}),u(d[r],"safari-mac",{12:{code:"NumLock",location:r},187:{code:"NumpadAdd",location:r},189:{code:"NumpadSubtract",location:r},190:{code:"NumpadDecimal",location:r},191:{code:"NumpadDivide",location:r}});var p={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};u(p,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var f,m,y,v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},E=(f=h,m="code",y={},Object.keys(f).forEach(function(e){var t=f[e];m in t&&(y[t[m]]=t)}),y);try{var _=t&&"location"in new KeyboardEvent("")}catch(e){}function T(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,o=function(){if(_||"keyLocation"in e){var o=_?e.location:e.keyLocation;if(o&&t in d[o])return d[o][t]}return"keyIdentifier"in e&&e.keyIdentifier in g?g[e.keyIdentifier]:t in h?h[t]:null}();if(!o)return null;var i,n=(i=p[o.code])?e.shiftKey&&"shiftKey"in i?i.shiftKey:i.key:o.code;return{code:o.code,key:n,location:o.location,keyCap:o.keyCap}}"KeyboardEvent"in e&&"defineProperty"in Object&&function(){function e(e,t,o){t in e||Object.defineProperty(e,t,o)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=T(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return v.hasOwnProperty(e)?v[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=T(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=T(this);return e&&"location"in e?e.location:o}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=function(e,t){if(e=String(e),!E.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var o=E[e];return o.keyCap||o.code||"Undefined"}),e.identifyKey=function(e){if(!("code"in e)){var t=T(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:o,e.locale=""}}}(window)},function(e,t,o){o(82);var i=window.KeyboardEvent;e.exports={schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){var e=this.data,t=this.getKeys();return this.dVelocity.set(0,0,0),e.enabled&&((t.KeyW||t.ArrowUp)&&(this.dVelocity.z-=1),(t.KeyA||t.ArrowLeft)&&(this.dVelocity.x-=1),(t.KeyS||t.ArrowDown)&&(this.dVelocity.z+=1),(t.KeyD||t.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(this.localKeys[e.code]=!0,this.emit(e))},onKeyUp:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(delete this.localKeys[e.code],this.emit(e))},onBlur:function(){for(var e in this.localKeys)this.localKeys.hasOwnProperty(e)&&delete this.localKeys[e]},emit:function(e){"__keyboard-controls-proxy"in e&&this.el.emit(e.type,e),this.el.emit(e.type+":"+e.code,new i(e.type,e)),this.data.debug&&console.log(e.type+":"+e.code)},isPressed:function(e){return e in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){var e=this.el.sceneEl.components["proxy-controls"];return e&&e.isConnected()}}},function(e,t){var o=THREE.Math.radToDeg,i=AFRAME.utils.device.isMobile();function n(e){return 0===e.x&&0===e.y&&0===e.z}e.exports={schema:{enabled:{default:!0},standing:{default:!0}},init:function(){this.isPositionCalibrated=!1,this.dolly=new THREE.Object3D,this.hmdEuler=new THREE.Euler,this.previousHMDPosition=new THREE.Vector3,this.deltaHMDPosition=new THREE.Vector3,this.vrControls=new THREE.VRControls(this.dolly),this.rotation=new THREE.Vector3},update:function(){var e=this.data,t=this.vrControls;t.standing=e.standing,t.update()},tick:function(){this.vrControls.update()},remove:function(){this.vrControls.dispose()},isRotationActive:function(){var e=this.hmdEuler;return!(!this.data.enabled||!this.el.sceneEl.is("vr-mode")&&!i)&&(e.setFromQuaternion(this.dolly.quaternion,"YXZ"),!n(e))},getRotation:function(){var e=this.hmdEuler;return this.rotation.set(o(e.x),o(e.y),o(e.z))},isVelocityActive:function(){var e=this.deltaHMDPosition,t=this.previousHMDPosition,o=this.calculateHMDPosition();return this.isPositionCalibrated=this.isPositionCalibrated||!n(t),!(!this.data.enabled||!this.el.sceneEl.is("vr-mode")||i)&&(e.copy(o).sub(t),t.copy(o),this.isPositionCalibrated&&!n(e))},getPositionDelta:function(){return this.deltaHMDPosition},calculateHMDPosition:function(){var e=this.dolly,t=new THREE.Vector3;return e.updateMatrix(),t.setFromMatrixPosition(e.matrix),t}}},function(e,t){e.exports=function(e,t,o){this.type=e,this.index=t,this.pressed=o.pressed,this.value=o.value}},function(e,t){e.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},function(e,t,o){var i=o(86),n=o(85);e.exports={GamepadButton:i,schema:{controller:{default:0,oneOf:[0,1,2,3]},enabled:{default:!0},debug:{default:!1}},init:function(){var e=this.el.sceneEl;this.prevTime=window.performance.now(),this.buttons={},e.addBehavior(this)},update:function(){this.tick()},tick:function(){this.updateButtonState()},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getDpad(),t=this.getJoystick(0),o=e.x||t.x,i=e.y||t.y;return Math.abs(o)>.2||Math.abs(i)>.2},getVelocityDelta:function(){var e=this.getDpad(),t=this.getJoystick(0),o=e.x||t.x,i=e.y||t.y,n=new THREE.Vector3;return Math.abs(o)>.2&&(n.x+=o),Math.abs(i)>.2&&(n.z+=i),n},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getJoystick(1);return Math.abs(e.x)>.2||Math.abs(e.y)>.2},getRotationDelta:function(){var e=this.getJoystick(1);return Math.abs(e.x)<=.2&&(e.x=0),Math.abs(e.y)<=.2&&(e.y=0),e},updateButtonState:function(){var e=this.getGamepad();if(this.data.enabled&&e)for(var t=0;t<e.buttons.length;t++)e.buttons[t].pressed&&!this.buttons[t]?this.emit(new n("gamepadbuttondown",t,e.buttons[t])):!e.buttons[t].pressed&&this.buttons[t]&&this.emit(new n("gamepadbuttonup",t,e.buttons[t])),this.buttons[t]=e.buttons[t].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(e){this.el.emit(e.type,e),this.el.emit(e.type+":"+e.index,new n(e.type,e.index,e))},getGamepad:function(){var e=navigator.getGamepads&&navigator.getGamepads()[this.data.controller],t=this.el.sceneEl.components["proxy-controls"];return t&&t.isConnected()&&t.getGamepad(this.data.controller)||e},getButton:function(e){return this.getGamepad().buttons[e]},getAxis:function(e){return this.getGamepad().axes[e]},getJoystick:function(e){var t=this.getGamepad();switch(e){case 0:return new THREE.Vector2(t.axes[0],t.axes[1]);case 1:return new THREE.Vector2(t.axes[2],t.axes[3]);default:throw new Error('Unexpected joystick index "%d".',e)}},getDpad:function(){var e=this.getGamepad();return e.buttons[i.DPAD_RIGHT]?new THREE.Vector2((e.buttons[i.DPAD_RIGHT].pressed?1:0)+(e.buttons[i.DPAD_LEFT].pressed?-1:0),(e.buttons[i.DPAD_UP].pressed?-1:0)+(e.buttons[i.DPAD_DOWN].pressed?1:0)):new THREE.Vector2},isConnected:function(){var e=this.getGamepad();return!(!e||!e.connected)},getID:function(){return this.getGamepad().id}}},function(e,t){e.exports={schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(e){var t=this.el;this.active&&this.checkpoint!==e&&(this.checkpoint&&t.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=e,this.sync(),this.position.distanceTo(this.targetPosition)<.1?this.checkpoint=null:(t.emit("navigation-start",{checkpoint:e}),"teleport"===this.data.mode&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,t.emit("navigation-end",{checkpoint:e}))))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(this.active){var e=this.data,t=this.offset,o=this.position,i=this.targetPosition,n=this.checkpoint;return this.sync(),o.distanceTo(i)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:n}),t.set(0,0,0)):(t.setLength(e.animateSpeed),t)}},sync:function(){var e=this.offset,t=this.position,o=this.targetPosition;t.copy(this.el.getAttribute("position")),o.copy(this.checkpoint.object3D.getWorldPosition()),o.add(this.checkpoint.components.checkpoint.getOffset()),e.copy(o).sub(t)}}},function(e,t){e.exports={GRAVITY:-9.8,MAX_INTERVAL:4/60,ITERATIONS:10,CONTACT_MATERIAL:{friction:.01,restitution:.3,contactEquationStiffness:1e8,contactEquationRelaxation:3,frictionEquationStiffness:1e8,frictionEquationRegularization:3}}},function(e,t,o){var i=o(11),n=o(89),r=n.GRAVITY,s=n.CONTACT_MATERIAL;e.exports={schema:{gravity:{default:r},iterations:{default:n.ITERATIONS},friction:{default:s.friction},restitution:{default:s.restitution},contactEquationStiffness:{default:s.contactEquationStiffness},contactEquationRelaxation:{default:s.contactEquationRelaxation},frictionEquationStiffness:{default:s.frictionEquationStiffness},frictionEquationRegularization:{default:s.frictionEquationRegularization},maxInterval:{default:4/60},debug:{default:!1}},Phase:{SIMULATE:"sim",RENDER:"render"},init:function(){var e=this.data;this.debug=e.debug,this.children={},this.children[this.Phase.SIMULATE]=[],this.children[this.Phase.RENDER]=[],this.listeners={},this.world=new i.World,this.world.quatNormalizeSkip=0,this.world.quatNormalizeFast=!1,this.world.solver.iterations=e.iterations,this.world.gravity.set(0,e.gravity,0),this.world.broadphase=new i.NaiveBroadphase,this.material=new i.Material({name:"defaultMaterial"}),this.contactMaterial=new i.ContactMaterial(this.material,this.material,{friction:e.friction,restitution:e.restitution,contactEquationStiffness:e.contactEquationStiffness,contactEquationRelaxation:e.contactEquationRelaxation,frictionEquationStiffness:e.frictionEquationStiffness,frictionEquationRegularization:e.frictionEquationRegularization}),this.world.addContactMaterial(this.contactMaterial)},tick:function(e,t){if(t){var o;for(this.world.step(Math.min(t/1e3,this.data.maxInterval)),o=0;o<this.children[this.Phase.SIMULATE].length;o++)this.children[this.Phase.SIMULATE][o].step(e,t);for(o=0;o<this.children[this.Phase.RENDER].length;o++)this.children[this.Phase.RENDER][o].step(e,t)}},addBody:function(e){this.listeners[e.id]=function(t){e.el.emit("collide",t)},e.addEventListener("collide",this.listeners[e.id]),this.world.addBody(e)},removeBody:function(e){e.removeEventListener("collide",this.listeners[e.id]),delete this.listeners[e.id],this.world.removeBody(e)},addBehavior:function(e,t){this.children[t].push(e)},removeBehavior:function(e,t){this.children[t].splice(this.children[t].indexOf(e),1)},update:function(e){var t=this.data;t.debug!==e.debug&&console.warn("[physics] `debug` cannot be changed dynamically."),t.maxInterval,e.maxInterval,t.gravity!==e.gravity&&this.world.gravity.set(0,t.gravity,0),this.contactMaterial.friction=t.friction,this.contactMaterial.restitution=t.restitution,this.contactMaterial.contactEquationStiffness=t.contactEquationStiffness,this.contactMaterial.contactEquationRelaxation=t.contactEquationRelaxation,this.contactMaterial.frictionEquationStiffness=t.frictionEquationStiffness,this.contactMaterial.frictionEquationRegularization=t.frictionEquationRegularization}}},function(e,t,o){var i=o(11);e.exports={dependencies:["dynamic-body"],multiple:!0,schema:{type:{default:"lock",oneOf:["coneTwist","distance","hinge","lock","pointToPoint"]},target:{type:"selector"},maxForce:{default:1e6,min:0},collideConnected:{default:!0},wakeUpBodies:{default:!0},distance:{default:0,min:0},pivot:{type:"vec3"},targetPivot:{type:"vec3"},axis:{type:"vec3",default:{x:0,y:0,z:1}},targetAxis:{type:"vec3",default:{x:0,y:0,z:1}}},init:function(){this.system=this.el.sceneEl.systems.physics,this.constraint=null},remove:function(){this.constraint&&(this.system.world.removeConstraint(this.constraint),this.constraint=null)},update:function(){var e=this.el,t=this.data;this.remove(),e.body&&t.target.body?(this.constraint=this.createConstraint(),this.system.world.addConstraint(this.constraint)):(e.body?t.target:e).addEventListener("body-loaded",this.update.bind(this,{}))},createConstraint:function(){var e,t=this.data,o=new i.Vec3(t.pivot.x,t.pivot.y,t.pivot.z),n=new i.Vec3(t.targetPivot.x,t.targetPivot.y,t.targetPivot.z),r=new i.Vec3(t.axis.x,t.axis.y,t.axis.z),s=new i.Vec3(t.targetAxis.x,t.targetAxis.y,t.targetAxis.z);switch(t.type){case"lock":e=new i.LockConstraint(this.el.body,t.target.body,{maxForce:t.maxForce});break;case"distance":e=new i.DistanceConstraint(this.el.body,t.target.body,t.distance,t.maxForce);break;case"hinge":e=new i.HingeConstraint(this.el.body,t.target.body,{pivotA:o,pivotB:n,axisA:r,axisB:s,maxForce:t.maxForce});break;case"coneTwist":e=new i.ConeTwistConstraint(this.el.body,t.target.body,{pivotA:o,pivotB:n,axisA:r,axisB:s,maxForce:t.maxForce});break;case"pointToPoint":e=new i.PointToPointConstraint(this.el.body,o,t.target.body,n,t.maxForce);break;default:throw new Error("[constraint] Unexpected type: "+t.type)}return e.collideConnected=t.collideConnected,e}}},function(e,t,o){var i=o(28);e.exports=AFRAME.utils.extend({},i,{step:function(){this.syncToPhysics()}})},function(e,t,o){var i=o(11);i.shape2mesh=function(e){for(var t=new THREE.Object3D,o=0;o<e.shapes.length;o++){var n,r=e.shapes[o];switch(r.type){case i.Shape.types.SPHERE:var s=new THREE.SphereGeometry(r.radius,8,8);n=new THREE.Mesh(s,this.currentMaterial);break;case i.Shape.types.PARTICLE:n=new THREE.Mesh(this.particleGeo,this.particleMaterial);var a=this.settings;n.scale.set(a.particleSize,a.particleSize,a.particleSize);break;case i.Shape.types.PLANE:var l=new THREE.PlaneGeometry(10,10,4,4);n=new THREE.Object3D;var c=new THREE.Object3D,u=new THREE.Mesh(l,this.currentMaterial);u.scale.set(100,100,100),c.add(u),u.castShadow=!0,u.receiveShadow=!0,n.add(c);break;case i.Shape.types.BOX:var h=new THREE.BoxGeometry(2*r.halfExtents.x,2*r.halfExtents.y,2*r.halfExtents.z);n=new THREE.Mesh(h,this.currentMaterial);break;case i.Shape.types.CONVEXPOLYHEDRON:for(var g=new THREE.Geometry,d=0;d<r.vertices.length;d++){var p=r.vertices[d];g.vertices.push(new THREE.Vector3(p.x,p.y,p.z))}for(d=0;d<r.faces.length;d++)for(var f=r.faces[d],m=f[0],y=1;y<f.length-1;y++){var v=f[y],E=f[y+1];g.faces.push(new THREE.Face3(m,v,E))}g.computeBoundingSphere(),g.computeFaceNormals(),n=new THREE.Mesh(g,this.currentMaterial);break;case i.Shape.types.HEIGHTFIELD:l=new THREE.Geometry;for(var _=new i.Vec3,T=new i.Vec3,b=new i.Vec3,M=0;M<r.data.length-1;M++)for(var A=0;A<r.data[M].length-1;A++)for(var S=0;S<2;S++){r.getConvexTrianglePillar(M,A,0===S),_.copy(r.pillarConvex.vertices[0]),T.copy(r.pillarConvex.vertices[1]),b.copy(r.pillarConvex.vertices[2]),_.vadd(r.pillarOffset,_),T.vadd(r.pillarOffset,T),b.vadd(r.pillarOffset,b),l.vertices.push(new THREE.Vector3(_.x,_.y,_.z),new THREE.Vector3(T.x,T.y,T.z),new THREE.Vector3(b.x,b.y,b.z));d=l.vertices.length-3;l.faces.push(new THREE.Face3(d,d+1,d+2))}l.computeBoundingSphere(),l.computeFaceNormals(),n=new THREE.Mesh(l,this.currentMaterial);break;case i.Shape.types.TRIMESH:for(l=new THREE.Geometry,_=new i.Vec3,T=new i.Vec3,b=new i.Vec3,d=0;d<r.indices.length/3;d++){r.getTriangleVertices(d,_,T,b),l.vertices.push(new THREE.Vector3(_.x,_.y,_.z),new THREE.Vector3(T.x,T.y,T.z),new THREE.Vector3(b.x,b.y,b.z));y=l.vertices.length-3;l.faces.push(new THREE.Face3(y,y+1,y+2))}l.computeBoundingSphere(),l.computeFaceNormals(),n=new THREE.Mesh(l,this.currentMaterial);break;default:throw"Visual type not recognized: "+r.type}if(n.receiveShadow=!0,n.castShadow=!0,n.children)for(d=0;d<n.children.length;d++)if(n.children[d].castShadow=!0,n.children[d].receiveShadow=!0,n.children[d])for(y=0;y<n.children[d].length;y++)n.children[d].children[y].castShadow=!0,n.children[d].children[y].receiveShadow=!0;var w=e.shapeOffsets[o],C=e.shapeOrientations[o];n.position.set(w.x,w.y,w.z),n.quaternion.set(C.x,C.y,C.z,C.w),t.add(n)}return t},e.exports=i.shape2mesh},function(e,t){e.exports=function(){var e,t,o,i,n,r,s,a,l,c,u,h,g,d,p,f,m,y,v,E=[],_=[],T=0;var b=function(){var e=new THREE.Vector3,t=new THREE.Vector3,o=new THREE.Vector3;return function(i,n,r){return e.subVectors(r,i),t.subVectors(n,i),o.crossVectors(e,t),o.normalize()}}();function M(e,t){if(void 0!==e.normal)return e.normal;var o=t[e[0]],i=t[e[1]],n=t[e[2]];return u.subVectors(i,o),h.subVectors(n,o),p.crossVectors(h,u),p.normalize(),e.normal=p.clone()}function A(e,t,o){var i=o[e[0]],n=[],r=M(e,o);t.sort(function(e,t){return n[e.x/3]=void 0!==n[e.x/3]?n[e.x/3]:r.dot(g.subVectors(e,i)),n[t.x/3]=void 0!==n[t.x/3]?n[t.x/3]:r.dot(d.subVectors(t,i)),n[e.x/3]-n[t.x/3]});var s=t.length;for(1===s&&(n[t[0].x/3]=r.dot(g.subVectors(t[0],i)));s-- >0&&n[t[s].x/3]>0;);s+1<t.length&&n[t[s+1].x/3]>0&&(e.visiblePoints=t.splice(s+1))}function S(e,t){for(var o,i=E.length,n=[e],r=t.indexOf(e.visiblePoints.pop());i-- >0;)(o=E[i])!==e&&M(o,t).dot(f.subVectors(t[r],t[o[0]]))>0&&n.push(o);var s,a,l,c,u=i=n.length,h=1===i,g=[],d=0,p=[];n[0][0],n[0][1],n[0][1],n[0][2],n[0][2],n[0][0];if(1===n.length)g=[(o=n[0])[0],o[1],o[1],o[2],o[2],o[0]],_.indexOf(o)>-1&&_.splice(_.indexOf(o),1),o.visiblePoints&&(p=p.concat(o.visiblePoints)),E.splice(E.indexOf(o),1);else for(;i-- >0;){var m;for(o=n[i],_.indexOf(o)>-1&&_.splice(_.indexOf(o),1),o.visiblePoints&&(p=p.concat(o.visiblePoints)),E.splice(E.indexOf(o),1),cEdgeIndex=0;cEdgeIndex<3;){for(m=!1,u=n.length,l=o[cEdgeIndex],c=o[(cEdgeIndex+1)%3];u-- >0&&!m;)if(d=0,(s=n[u])!==o)for(;d<3&&!m;)a=d+1,m=s[d]===l&&s[a%3]===c||s[d]===c&&s[a%3]===l,d++;m&&!h||(g.push(l),g.push(c)),cEdgeIndex++}}i=0;for(var y,v=g.length/2;i<v;)A(y=[g[2*i+1],r,g[2*i]],p,t),E.push(y),void 0!==y.visiblePoints&&_.push(y),i++}var w=function(){var e=new THREE.Vector3,t=new THREE.Vector3,o=new THREE.Vector3;return function(i,n,r){e.subVectors(n,i),t.subVectors(r,i),o.subVectors(r,n);var s=t.dot(e);if(s<0)return t.dot(t);var a=e.dot(e);return s>=a?o.dot(o):t.dot(t)-s*s/a}}();return function(M){for(u=new THREE.Vector3,h=new THREE.Vector3,new THREE.Vector3,g=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,y=new THREE.Vector3,v=new THREE.Vector3,points=M.vertices,E=[],_=[],x=e=points.length,t=points.slice(0,6),T=0;x-- >0;)points[x].x<t[0].x&&(t[0]=points[x]),points[x].x>t[1].x&&(t[1]=points[x]),points[x].y<t[2].y&&(t[2]=points[x]),points[x].y<t[3].y&&(t[3]=points[x]),points[x].z<t[4].z&&(t[4]=points[x]),points[x].z<t[5].z&&(t[5]=points[x]);for(i=x=6;x-- >0;)for(i=x-1;i-- >0;)T<(o=t[x].distanceToSquared(t[i]))&&(T=o,n=t[x],r=t[i]);for(x=6,T=0;x-- >0;)o=w(n,r,t[x]),T<o&&(T=o,s=t[x]);for(l=b(n,r,s),c=l.dot(n),T=0,x=e;x-- >0;)o=Math.abs(points[x].dot(l)-c),T<o&&(T=o,a=points[x]);var C=points.indexOf(n),N=points.indexOf(r),L=points.indexOf(s),I=points.indexOf(a),R=[[L,N,C],[N,I,C],[L,I,N],[C,I,L]];m.subVectors(r,n).normalize(),y.subVectors(s,n).normalize(),v.subVectors(a,n).normalize(),v.dot((new THREE.Vector3).crossVectors(y,m))<0&&(R[0].reverse(),R[1].reverse(),R[2].reverse(),R[3].reverse());var D=points.slice();D.splice(D.indexOf(n),1),D.splice(D.indexOf(r),1),D.splice(D.indexOf(s),1),D.splice(D.indexOf(a),1);for(var x=R.length;x-- >0;)A(R[x],D,points),void 0!==R[x].visiblePoints&&_.push(R[x]),E.push(R[x]);!function(e){for(;_.length>0;)S(_.shift(),e)}(points);for(var O=E.length;O-- >0;)M.faces[O]=new THREE.Face3(E[O][2],E[O][1],E[O][0],E[O].normal);return M.normalsNeedUpdate=!0,M}}()},function(e,t,o){var i=o(11),n=o(94),r=Math.PI/2,s={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron",MESH:"Trimesh"},a=function(e,t){var o;if((t=t||{}).type===s.BOX)return c(e);if(t.type===s.CYLINDER)return function(e,t){var o,n,s,a=new THREE.Box3,l=["x","y","z"],c=t.cylinderAxis||"y",u=l.splice(l.indexOf(c),1)&&l;return a.setFromObject(e),isFinite(a.min.lengthSq())?(n=a.max[c]-a.min[c],s=.5*Math.max(a.max[u[0]]-a.min[u[0]],a.max[u[1]]-a.min[u[1]]),(o=new i.Cylinder(s,s,n,12))._type=i.Shape.types.CYLINDER,o.radiusTop=s,o.radiusBottom=s,o.height=n,o.numSegments=12,o.orientation=new i.Quaternion,o.orientation.setFromEuler("y"===c?r:0,"z"===c?r:0,0,"XYZ").normalize(),o):null}(e,t);if(t.type===s.SPHERE)return function(e,t){if(t.sphereRadius)return new i.Sphere(t.sphereRadius);var o=u(e);return o?(o.computeBoundingSphere(),new i.Sphere(o.boundingSphere.radius)):null}(e,t);if(t.type===s.HULL)return function(e){var t,o,r,s,a=u(e);if(!a||!a.vertices.length)return null;for(t=0;t<a.vertices.length;t++)a.vertices[t].x+=1e-4*(Math.random()-.5),a.vertices[t].y+=1e-4*(Math.random()-.5),a.vertices[t].z+=1e-4*(Math.random()-.5);for(s=n(a),o=new Array(s.vertices.length),t=0;t<s.vertices.length;t++)o[t]=new i.Vec3(s.vertices[t].x,s.vertices[t].y,s.vertices[t].z);for(r=new Array(s.faces.length),t=0;t<s.faces.length;t++)r[t]=[s.faces[t].a,s.faces[t].b,s.faces[t].c];return new i.ConvexPolyhedron(o,r)}(e);if(t.type===s.MESH)return(o=u(e))?function(e){var t,o=h(e);return o.length?(t=Object.keys(o).map(Number),new i.Trimesh(o,t)):null}(o):null;if(t.type)throw new Error('[CANNON.mesh2shape] Invalid type "%s".',t.type);if(!(o=u(e)))return null;switch(o.metadata?o.metadata.type:o.type){case"BoxGeometry":case"BoxBufferGeometry":return l(o);case"CylinderGeometry":case"CylinderBufferGeometry":return function(e){var t,o=e.metadata?e.metadata.parameters:e.parameters;return(t=new i.Cylinder(o.radiusTop,o.radiusBottom,o.height,o.radialSegments))._type=i.Shape.types.CYLINDER,t.radiusTop=o.radiusTop,t.radiusBottom=o.radiusBottom,t.height=o.height,t.numSegments=o.radialSegments,t.orientation=new i.Quaternion,t.orientation.setFromEuler(THREE.Math.degToRad(-90),0,0,"XYZ").normalize(),t}(o);case"PlaneGeometry":case"PlaneBufferGeometry":return function(e){e.computeBoundingBox();var t=e.boundingBox;return new i.Box(new i.Vec3((t.max.x-t.min.x)/2||.1,(t.max.y-t.min.y)/2||.1,(t.max.z-t.min.z)/2||.1))}(o);case"SphereGeometry":case"SphereBufferGeometry":return function(e){var t=e.metadata?e.metadata.parameters:e.parameters;return new i.Sphere(t.radius)}(o);case"TubeGeometry":case"Geometry":case"BufferGeometry":return c(e);default:return console.warn('Unrecognized geometry: "%s". Using bounding box as shape.',o.type),l(o)}};function l(e){if(!h(e).length)return null;e.computeBoundingBox();var t=e.boundingBox;return new i.Box(new i.Vec3((t.max.x-t.min.x)/2,(t.max.y-t.min.y)/2,(t.max.z-t.min.z)/2))}function c(e){var t,o,n,r=new THREE.Box3;return r.setFromObject(e),isFinite(r.min.lengthSq())?(t=new i.Box(new i.Vec3((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2)),e.updateMatrixWorld(),(n=new THREE.Vector3).setFromMatrixPosition(e.matrixWorld),(o=r.translate(n.negate()).getCenter()).lengthSq()&&(t.offset=o),t):null}function u(e){var t,o,i=function(e){var t=[];return e.traverse(function(e){"Mesh"===e.type&&t.push(e)}),t}(e),n=new THREE.Geometry,r=new THREE.Geometry;if(0===i.length)return null;if(1===i.length){var s=new THREE.Vector3,a=new THREE.Quaternion,l=new THREE.Vector3;return i[0].geometry.isBufferGeometry?i[0].geometry.attributes.position&&i[0].geometry.attributes.position.itemSize>2&&n.fromBufferGeometry(i[0].geometry):n=i[0].geometry.clone(),n.metadata=i[0].geometry.metadata,i[0].updateMatrixWorld(),i[0].matrixWorld.decompose(s,a,l),n.scale(l.x,l.y,l.z)}for(;o=i.pop();)if(o.updateMatrixWorld(),o.geometry.isBufferGeometry){if(o.geometry.attributes.position&&o.geometry.attributes.position.itemSize>2){var c=new THREE.Geometry;c.fromBufferGeometry(o.geometry),r.merge(c,o.matrixWorld),c.dispose()}}else r.merge(o.geometry,o.matrixWorld);return(t=new THREE.Matrix4).scale(e.scale),r.applyMatrix(t),r}function h(e){return e.attributes||(e=(new THREE.BufferGeometry).fromGeometry(e)),(e.attributes.position||{}).array||[]}a.Type=s,e.exports=i.mesh2shape=a},function(e,t,o){var i=o(28);e.exports=AFRAME.utils.extend({},i,{dependencies:["quaternion","velocity"],schema:AFRAME.utils.extend({},i.schema,{mass:{default:5},linearDamping:{default:.01},angularDamping:{default:.01}}),step:function(){this.syncFromPhysics()}})},function(e,t){e.exports={schema:{type:"vec4"},play:function(){var e=this.el,t=e.object3D.quaternion;e.hasAttribute("rotation")&&(e.components.rotation.update(),e.setAttribute("quaternion",{x:t.x,y:t.y,z:t.z,w:t.w}),e.removeAttribute("rotation"),this.update())},update:function(){var e=this.data;this.el.object3D.quaternion.set(e.x,e.y,e.z,e.w)}}},function(e,t){e.exports={schema:{type:"vec3"},init:function(){this.system=this.el.sceneEl.systems.physics,this.system&&this.system.addBehavior(this,this.system.Phase.RENDER)},remove:function(){this.system&&this.system.removeBehavior(this,this.system.Phase.RENDER)},tick:function(e,t){t&&(this.system||this.step(e,t))},step:function(e,t){if(t){var o=this.el.sceneEl.systems.physics||{data:{maxInterval:1/60}},i=this.el.getAttribute("velocity")||{x:0,y:0,z:0},n=this.el.getAttribute("position")||{x:0,y:0,z:0};t=Math.min(t,1e3*o.data.maxInterval),this.el.setAttribute("position",{x:n.x+i.x*t/1e3,y:n.y+i.y*t/1e3,z:n.z+i.z*t/1e3})}}}},function(e,t,o){e.exports={velocity:o(98),quaternion:o(97),registerAll:function(e){this._registered||((e=e||window.AFRAME).components.velocity||e.registerComponent("velocity",this.velocity),e.components.quaternion||e.registerComponent("quaternion",this.quaternion),this._registered=!0)}}},function(e,t){function o(){this.data={keys:[]}}e.exports=o,o.prototype.get=function(e,t){if(e>t){var o=t;t=e,e=o}return this.data[e+"-"+t]},o.prototype.set=function(e,t,o){if(e>t){var i=t;t=e,e=i}var n=e+"-"+t;this.get(e,t)||this.data.keys.push(n),this.data[n]=o},o.prototype.reset=function(){for(var e=this.data,t=e.keys;t.length>0;){delete e[t.pop()]}}},function(e,t){function o(){this.current=[],this.previous=[]}function i(e,t){e.push((4294901760&t)>>16,65535&t)}e.exports=o,o.prototype.getKey=function(e,t){if(t<e){var o=t;t=e,e=o}return e<<16|t},o.prototype.set=function(e,t){for(var o=this.getKey(e,t),i=this.current,n=0;o>i[n];)n++;if(o!==i[n]){for(t=i.length-1;t>=n;t--)i[t+1]=i[t];i[n]=o}},o.prototype.tick=function(){var e=this.current;this.current=this.previous,this.previous=e,this.current.length=0},o.prototype.getDiff=function(e,t){for(var o=this.current,n=this.previous,r=o.length,s=n.length,a=0,l=0;l<r;l++){for(var c=o[l];c>n[a];)a++;c===n[a]||i(e,c)}a=0;for(l=0;l<s;l++){for(var u=n[l];u>o[a];)a++;o[a]===u||i(t,u)}}},function(e,t,o){e.exports=v;o(1);var i=o(0),n=o(2),r=o(33),s=(o(3),o(24),o(37)),a=o(25),l=o(39),c=o(101),u=o(13),h=o(34),g=o(4),d=o(100),p=o(12),f=o(6),m=o(19),y=o(31);function v(e){e=e||{},a.apply(this),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==e.quatNormalizeSkip?e.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==e.quatNormalizeFast&&e.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new i,e.gravity&&this.gravity.copy(e.gravity),this.broadphase=void 0!==e.broadphase?e.broadphase:new y,this.bodies=[],this.solver=void 0!==e.solver?e.solver:new r,this.constraints=[],this.narrowphase=new s(this),this.collisionMatrix=new l,this.collisionMatrixPrevious=new l,this.bodyOverlapKeeper=new c,this.shapeOverlapKeeper=new c,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new d,this.defaultMaterial=new u("default"),this.defaultContactMaterial=new h(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}v.prototype=new a;new f;var E=new m;if(v.prototype.getContactMaterial=function(e,t){return this.contactMaterialTable.get(e.id,t.id)},v.prototype.numObjects=function(){return this.bodies.length},v.prototype.collisionMatrixTick=function(){var e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()},v.prototype.add=v.prototype.addBody=function(e){-1===this.bodies.indexOf(e)&&(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof g&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))},v.prototype.addConstraint=function(e){this.constraints.push(e)},v.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)},v.prototype.rayTest=function(e,t,o){o instanceof p?this.raycastClosest(e,t,{skipBackfaces:!0},o):this.raycastAll(e,t,{skipBackfaces:!0},o)},v.prototype.raycastAll=function(e,t,o,i){return o.mode=m.ALL,o.from=e,o.to=t,o.callback=i,E.intersectWorld(this,o)},v.prototype.raycastAny=function(e,t,o,i){return o.mode=m.ANY,o.from=e,o.to=t,o.result=i,E.intersectWorld(this,o)},v.prototype.raycastClosest=function(e,t,o,i){return o.mode=m.CLOSEST,o.from=e,o.to=t,o.result=i,E.intersectWorld(this,o)},v.prototype.remove=function(e){e.world=null;var t=this.bodies.length-1,o=this.bodies,i=o.indexOf(e);if(-1!==i){o.splice(i,1);for(var n=0;n!==o.length;n++)o[n].index=n;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}},v.prototype.removeBody=v.prototype.remove,v.prototype.getBodyById=function(e){return this.idToBodyMap[e]},v.prototype.getShapeById=function(e){for(var t=this.bodies,o=0,i=t.length;o<i;o++)for(var n=t[o].shapes,r=0,s=n.length;r<s;r++){var a=n[r];if(a.id===e)return a}},v.prototype.addMaterial=function(e){this.materials.push(e)},v.prototype.addContactMaterial=function(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)},"undefined"==typeof performance&&(performance={}),!performance.now){var _=Date.now();performance.timing&&performance.timing.navigationStart&&(_=performance.timing.navigationStart),performance.now=function(){return Date.now()-_}}new i;v.prototype.step=function(e,t,o){if(o=o||10,0===(t=t||0))this.internalStep(e),this.time+=e;else{this.accumulator+=t;for(var i=0;this.accumulator>=e&&i<o;)this.internalStep(e),this.accumulator-=e,i++;for(var n=this.accumulator%e/e,r=0;r!==this.bodies.length;r++){var s=this.bodies[r];s.previousPosition.lerp(s.position,n,s.interpolatedPosition),s.previousQuaternion.slerp(s.quaternion,n,s.interpolatedQuaternion),s.previousQuaternion.normalize()}this.time+=t}};var T,b,M,A,S,w,C={type:"postStep"},N={type:"preStep"},L={type:g.COLLIDE_EVENT_NAME,body:null,contact:null},I=[],R=[],D=[],x=[];new i,new i,new i,new i,new i,new i,new i,new i,new i,new n,new n,new n,new i;v.prototype.internalStep=function(e){this.dt=e;var t,o=this.contacts,i=D,n=x,r=this.numObjects(),s=this.bodies,a=this.solver,l=this.gravity,c=this.doProfiling,u=this.profile,h=g.DYNAMIC,d=this.constraints,p=R,f=(l.norm(),l.x),m=l.y,y=l.z,v=0;for(c&&(t=performance.now()),v=0;v!==r;v++){if((B=s[v]).type===h){var E=B.force,_=B.mass;E.x+=_*f,E.y+=_*m,E.z+=_*y}}v=0;for(var T=this.subsystems.length;v!==T;v++)this.subsystems[v].update();c&&(t=performance.now()),i.length=0,n.length=0,this.broadphase.collisionPairs(this,i,n),c&&(u.broadphase=performance.now()-t);var b=d.length;for(v=0;v!==b;v++){if(!(H=d[v]).collideConnected)for(var M=i.length-1;M>=0;M-=1)(H.bodyA===i[M]&&H.bodyB===n[M]||H.bodyB===i[M]&&H.bodyA===n[M])&&(i.splice(M,1),n.splice(M,1))}this.collisionMatrixTick(),c&&(t=performance.now());var A=I,S=o.length;for(v=0;v!==S;v++)A.push(o[v]);o.length=0;var w=this.frictionEquations.length;for(v=0;v!==w;v++)p.push(this.frictionEquations[v]);this.frictionEquations.length=0,this.narrowphase.getContacts(i,n,this,o,A,this.frictionEquations,p),c&&(u.narrowphase=performance.now()-t),c&&(t=performance.now());for(v=0;v<this.frictionEquations.length;v++)a.addEquation(this.frictionEquations[v]);for(var O=o.length,k=0;k!==O;k++){var B=(H=o[k]).bi,P=H.bj,U=H.si,F=H.sj;(B.material&&P.material&&this.getContactMaterial(B.material,P.material)||this.defaultContactMaterial).friction;if(B.material&&P.material&&(B.material.friction>=0&&P.material.friction>=0&&B.material.friction*P.material.friction,B.material.restitution>=0&&P.material.restitution>=0&&(H.restitution=B.material.restitution*P.material.restitution)),a.addEquation(H),B.allowSleep&&B.type===g.DYNAMIC&&B.sleepState===g.SLEEPING&&P.sleepState===g.AWAKE&&P.type!==g.STATIC)P.velocity.norm2()+P.angularVelocity.norm2()>=2*Math.pow(P.sleepSpeedLimit,2)&&(B._wakeUpAfterNarrowphase=!0);if(P.allowSleep&&P.type===g.DYNAMIC&&P.sleepState===g.SLEEPING&&B.sleepState===g.AWAKE&&B.type!==g.STATIC)B.velocity.norm2()+B.angularVelocity.norm2()>=2*Math.pow(B.sleepSpeedLimit,2)&&(P._wakeUpAfterNarrowphase=!0);this.collisionMatrix.set(B,P,!0),this.collisionMatrixPrevious.get(B,P)||(L.body=P,L.contact=H,B.dispatchEvent(L),L.body=B,P.dispatchEvent(L)),this.bodyOverlapKeeper.set(B.id,P.id),this.shapeOverlapKeeper.set(U.id,F.id)}for(this.emitContactEvents(),c&&(u.makeContactConstraints=performance.now()-t,t=performance.now()),v=0;v!==r;v++){(B=s[v])._wakeUpAfterNarrowphase&&(B.wakeUp(),B._wakeUpAfterNarrowphase=!1)}b=d.length;for(v=0;v!==b;v++){var H;(H=d[v]).update();M=0;for(var j=H.equations.length;M!==j;M++){var z=H.equations[M];a.addEquation(z)}}a.solve(e,this),c&&(u.solve=performance.now()-t),a.removeAllEquations();var V=Math.pow;for(v=0;v!==r;v++){if((B=s[v]).type&h){var G=V(1-B.linearDamping,e),W=B.velocity;W.mult(G,W);var Y=B.angularVelocity;if(Y){var X=V(1-B.angularDamping,e);Y.mult(X,Y)}}}for(this.dispatchEvent(N),v=0;v!==r;v++){(B=s[v]).preStep&&B.preStep.call(B)}c&&(t=performance.now());var K=this.stepnumber%(this.quatNormalizeSkip+1)==0,Q=this.quatNormalizeFast;for(v=0;v!==r;v++)s[v].integrate(e,K,Q);for(this.clearForces(),this.broadphase.dirty=!0,c&&(u.integrate=performance.now()-t),this.time+=e,this.stepnumber+=1,this.dispatchEvent(C),v=0;v!==r;v++){var q=(B=s[v]).postStep;q&&q.call(B)}if(this.allowSleep)for(v=0;v!==r;v++)s[v].sleepTick(this.time)},v.prototype.emitContactEvents=(T=[],b=[],M={type:"beginContact",bodyA:null,bodyB:null},A={type:"endContact",bodyA:null,bodyB:null},S={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},w={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},function(){var e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(T,b),e){for(var o=0,i=T.length;o<i;o+=2)M.bodyA=this.getBodyById(T[o]),M.bodyB=this.getBodyById(T[o+1]),this.dispatchEvent(M);M.bodyA=M.bodyB=null}if(t){for(o=0,i=b.length;o<i;o+=2)A.bodyA=this.getBodyById(b[o]),A.bodyB=this.getBodyById(b[o+1]),this.dispatchEvent(A);A.bodyA=A.bodyB=null}T.length=b.length=0;var n=this.hasAnyEventListener("beginShapeContact"),r=this.hasAnyEventListener("endShapeContact");if((n||r)&&this.shapeOverlapKeeper.getDiff(T,b),n){for(o=0,i=T.length;o<i;o+=2){var s=this.getShapeById(T[o]),a=this.getShapeById(T[o+1]);S.shapeA=s,S.shapeB=a,S.bodyA=s.body,S.bodyB=a.body,this.dispatchEvent(S)}S.bodyA=S.bodyB=S.shapeA=S.shapeB=null}if(r){for(o=0,i=b.length;o<i;o+=2)s=this.getShapeById(b[o]),a=this.getShapeById(b[o+1]),w.shapeA=s,w.shapeB=a,w.bodyA=s.body,w.bodyB=a.body,this.dispatchEvent(w);w.bodyA=w.bodyB=w.shapeA=w.shapeB=null}}),v.prototype.clearForces=function(){for(var e=this.bodies,t=e.length,o=0;o!==t;o++){var i=e[o];i.force,i.torque;i.force.set(0,0,0),i.torque.set(0,0,0)}}},function(e,t,o){var i=o(6),n=o(0);function r(e){e=e||{},this.root=e.root||null,this.aabb=e.aabb?e.aabb.clone():new i,this.data=[],this.children=[]}function s(e,t){(t=t||{}).root=null,t.aabb=e,r.call(this,t),this.maxDepth=void 0!==t.maxDepth?t.maxDepth:8}e.exports=s,s.prototype=new r,r.prototype.reset=function(e,t){this.children.length=this.data.length=0},r.prototype.insert=function(e,t,o){var i=this.data;if(o=o||0,!this.aabb.contains(e))return!1;var n=this.children;if(o<(this.maxDepth||this.root.maxDepth)){var r=!1;n.length||(this.subdivide(),r=!0);for(var s=0;8!==s;s++)if(n[s].insert(e,t,o+1))return!0;r&&(n.length=0)}return i.push(t),!0};var a=new n;r.prototype.subdivide=function(){var e=this.aabb,t=e.lowerBound,o=e.upperBound,s=this.children;s.push(new r({aabb:new i({lowerBound:new n(0,0,0)})}),new r({aabb:new i({lowerBound:new n(1,0,0)})}),new r({aabb:new i({lowerBound:new n(1,1,0)})}),new r({aabb:new i({lowerBound:new n(1,1,1)})}),new r({aabb:new i({lowerBound:new n(0,1,1)})}),new r({aabb:new i({lowerBound:new n(0,0,1)})}),new r({aabb:new i({lowerBound:new n(1,0,1)})}),new r({aabb:new i({lowerBound:new n(0,1,0)})})),o.vsub(t,a),a.scale(.5,a);for(var l=this.root||this,c=0;8!==c;c++){var u=s[c];u.root=l;var h=u.aabb.lowerBound;h.x*=a.x,h.y*=a.y,h.z*=a.z,h.vadd(t,h),h.vadd(a,u.aabb.upperBound)}},r.prototype.aabbQuery=function(e,t){this.data,this.children;for(var o=[this];o.length;){var i=o.pop();i.aabb.overlaps(e)&&Array.prototype.push.apply(t,i.data),Array.prototype.push.apply(o,i.children)}return t};var l=new i;r.prototype.rayQuery=function(e,t,o){return e.getAABB(l),l.toLocalFrame(t,l),this.aabbQuery(l,o),o},r.prototype.removeEmptyNodes=function(){for(var e=[this];e.length;){for(var t=e.pop(),o=t.children.length-1;o>=0;o--)t.children[o].data.length||t.children.splice(o,1);Array.prototype.push.apply(e,t.children)}}},function(e,t,o){e.exports=l;var i=o(1),n=o(0),r=(o(2),o(9)),s=o(6),a=o(103);function l(e,t){i.call(this),this.type=i.types.TRIMESH,this.vertices=new Float32Array(e),this.indices=new Int16Array(t),this.normals=new Float32Array(t.length),this.aabb=new s,this.edges=null,this.scale=new n(1,1,1),this.tree=new a,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}l.prototype=new i,l.prototype.constructor=l;var c=new n;l.prototype.updateTree=function(){var e=this.tree;e.reset(),e.aabb.copy(this.aabb);var t=this.scale;e.aabb.lowerBound.x*=1/t.x,e.aabb.lowerBound.y*=1/t.y,e.aabb.lowerBound.z*=1/t.z,e.aabb.upperBound.x*=1/t.x,e.aabb.upperBound.y*=1/t.y,e.aabb.upperBound.z*=1/t.z;for(var o=new s,i=new n,r=new n,a=new n,l=[i,r,a],c=0;c<this.indices.length/3;c++){var u=3*c;this._getUnscaledVertex(this.indices[u],i),this._getUnscaledVertex(this.indices[u+1],r),this._getUnscaledVertex(this.indices[u+2],a),o.setFromPoints(l),e.insert(o,c)}e.removeEmptyNodes()};var u=new s;l.prototype.getTrianglesInAABB=function(e,t){u.copy(e);var o=this.scale,i=o.x,n=o.y,r=o.z,s=u.lowerBound,a=u.upperBound;return s.x/=i,s.y/=n,s.z/=r,a.x/=i,a.y/=n,a.z/=r,this.tree.aabbQuery(u,t)},l.prototype.setScale=function(e){var t=this.scale.x===this.scale.y===this.scale.z,o=e.x===e.y===e.z;t&&o||this.updateNormals(),this.scale.copy(e),this.updateAABB(),this.updateBoundingSphereRadius()},l.prototype.updateNormals=function(){for(var e=c,t=this.normals,o=0;o<this.indices.length/3;o++){var i=3*o,n=this.indices[i],r=this.indices[i+1],s=this.indices[i+2];this.getVertex(n,f),this.getVertex(r,m),this.getVertex(s,y),l.computeNormal(m,f,y,e),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z}},l.prototype.updateEdges=function(){for(var e={},t=function(t,o){e[n<r?n+"_"+r:r+"_"+n]=!0},o=0;o<this.indices.length/3;o++){var i=3*o,n=this.indices[i],r=this.indices[i+1];this.indices[i+2];t(),t(),t()}var s=Object.keys(e);this.edges=new Int16Array(2*s.length);for(o=0;o<s.length;o++){var a=s[o].split("_");this.edges[2*o]=parseInt(a[0],10),this.edges[2*o+1]=parseInt(a[1],10)}},l.prototype.getEdgeVertex=function(e,t,o){var i=this.edges[2*e+(t?1:0)];this.getVertex(i,o)};var h=new n,g=new n;l.prototype.getEdgeVector=function(e,t){var o=h,i=g;this.getEdgeVertex(e,0,o),this.getEdgeVertex(e,1,i),i.vsub(o,t)};var d=new n,p=new n;l.computeNormal=function(e,t,o,i){t.vsub(e,p),o.vsub(t,d),d.cross(p,i),i.isZero()||i.normalize()};var f=new n,m=new n,y=new n;l.prototype.getVertex=function(e,t){var o=this.scale;return this._getUnscaledVertex(e,t),t.x*=o.x,t.y*=o.y,t.z*=o.z,t},l.prototype._getUnscaledVertex=function(e,t){var o=3*e,i=this.vertices;return t.set(i[o],i[o+1],i[o+2])},l.prototype.getWorldVertex=function(e,t,o,i){return this.getVertex(e,i),r.pointToWorldFrame(t,o,i,i),i},l.prototype.getTriangleVertices=function(e,t,o,i){var n=3*e;this.getVertex(this.indices[n],t),this.getVertex(this.indices[n+1],o),this.getVertex(this.indices[n+2],i)},l.prototype.getNormal=function(e,t){var o=3*e;return t.set(this.normals[o],this.normals[o+1],this.normals[o+2])};var v=new s;l.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(v);var o=v.upperBound.x-v.lowerBound.x,i=v.upperBound.y-v.lowerBound.y,n=v.upperBound.z-v.lowerBound.z;return t.set(1/12*e*(2*i*2*i+2*n*2*n),1/12*e*(2*o*2*o+2*n*2*n),1/12*e*(2*i*2*i+2*o*2*o))};var E=new n;l.prototype.computeLocalAABB=function(e){var t=e.lowerBound,o=e.upperBound,i=this.vertices.length,n=(this.vertices,E);this.getVertex(0,n),t.copy(n),o.copy(n);for(var r=0;r!==i;r++)this.getVertex(r,n),n.x<t.x?t.x=n.x:n.x>o.x&&(o.x=n.x),n.y<t.y?t.y=n.y:n.y>o.y&&(o.y=n.y),n.z<t.z?t.z=n.z:n.z>o.z&&(o.z=n.z)},l.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},l.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,o=new n,i=0,r=t.length/3;i!==r;i++){this.getVertex(i,o);var s=o.norm2();s>e&&(e=s)}this.boundingSphereRadius=Math.sqrt(e)};new n;var _=new r,T=new s;l.prototype.calculateWorldAABB=function(e,t,o,i){var n=_,r=T;n.position=e,n.quaternion=t,this.aabb.toWorldFrame(n,r),o.copy(r.lowerBound),i.copy(r.upperBound)},l.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},l.createTorus=function(e,t,o,i,n){e=e||1,t=t||.5,o=o||8,i=i||6,n=n||2*Math.PI;for(var r=[],s=[],a=0;a<=o;a++)for(var c=0;c<=i;c++){var u=c/i*n,h=a/o*Math.PI*2,g=(e+t*Math.cos(h))*Math.cos(u),d=(e+t*Math.cos(h))*Math.sin(u),p=t*Math.sin(h);r.push(g,d,p)}for(a=1;a<=o;a++)for(c=1;c<=i;c++){var f=(i+1)*a+c-1,m=(i+1)*(a-1)+c-1,y=(i+1)*(a-1)+c,v=(i+1)*a+c;s.push(f,m,v),s.push(m,y,v)}return new l(r,s)}},function(e,t,o){var i=o(0);function n(e,t,o){o=o||{},this.restLength="number"==typeof o.restLength?o.restLength:1,this.stiffness=o.stiffness||100,this.damping=o.damping||1,this.bodyA=e,this.bodyB=t,this.localAnchorA=new i,this.localAnchorB=new i,o.localAnchorA&&this.localAnchorA.copy(o.localAnchorA),o.localAnchorB&&this.localAnchorB.copy(o.localAnchorB),o.worldAnchorA&&this.setWorldAnchorA(o.worldAnchorA),o.worldAnchorB&&this.setWorldAnchorB(o.worldAnchorB)}e.exports=n,n.prototype.setWorldAnchorA=function(e){this.bodyA.pointToLocalFrame(e,this.localAnchorA)},n.prototype.setWorldAnchorB=function(e){this.bodyB.pointToLocalFrame(e,this.localAnchorB)},n.prototype.getWorldAnchorA=function(e){this.bodyA.pointToWorldFrame(this.localAnchorA,e)},n.prototype.getWorldAnchorB=function(e){this.bodyB.pointToWorldFrame(this.localAnchorB,e)};var r=new i,s=new i,a=new i,l=new i,c=new i,u=new i,h=new i,g=new i,d=new i,p=new i,f=new i;n.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,o=this.restLength,i=this.bodyA,n=this.bodyB,m=r,y=s,v=a,E=l,_=f,T=c,b=u,M=h,A=g,S=d,w=p;this.getWorldAnchorA(T),this.getWorldAnchorB(b),T.vsub(i.position,M),b.vsub(n.position,A),b.vsub(T,m);var C=m.norm();y.copy(m),y.normalize(),n.velocity.vsub(i.velocity,v),n.angularVelocity.cross(A,_),v.vadd(_,v),i.angularVelocity.cross(M,_),v.vsub(_,v),y.mult(-e*(C-o)-t*v.dot(y),E),i.force.vsub(E,i.force),n.force.vadd(E,n.force),M.cross(E,S),A.cross(E,w),i.torque.vsub(S,i.torque),n.torque.vadd(w,n.torque)}},function(e,t,o){e.exports=r;o(0),o(2);var i=o(18),n=o(4);function r(e){for(i.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=e,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}r.prototype=new i;var s=[],a=[],l={bodies:[]},c=n.STATIC;function u(e){for(var t=e.length,o=0;o!==t;o++){var i=e[o];if(!(i.visited||i.body.type&c))return i}return!1}var h=[];function g(e,t,o,i){for(h.push(e),e.visited=!0,t(e,o,i);h.length;)for(var n,r=h.pop();n=u(r.children);)n.visited=!0,t(n,o,i),h.push(n)}function d(e,t,o){t.push(e.body);for(var i=e.eqs.length,n=0;n!==i;n++){var r=e.eqs[n];-1===o.indexOf(r)&&o.push(r)}}function p(e,t){return t.id-e.id}r.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},r.prototype.solve=function(e,t){for(var o=s,i=this.nodePool,n=t.bodies,r=this.equations,c=r.length,h=n.length,f=this.subsolver;i.length<h;)i.push(this.createNode());o.length=h;for(var m=0;m<h;m++)o[m]=i[m];for(m=0;m!==h;m++){var y=o[m];y.body=n[m],y.children.length=0,y.eqs.length=0,y.visited=!1}for(var v=0;v!==c;v++){var E=r[v],_=(m=n.indexOf(E.bi),n.indexOf(E.bj)),T=o[m],b=o[_];T.children.push(b),T.eqs.push(E),b.children.push(T),b.eqs.push(E)}var M,A=0,S=a;f.tolerance=this.tolerance,f.iterations=this.iterations;for(var w=l;M=u(o);){S.length=0,w.bodies.length=0,g(M,d,w.bodies,S);var C=S.length;S=S.sort(p);for(m=0;m!==C;m++)f.addEquation(S[m]);f.solve(e,w);f.removeAllEquations(),A++}return A}},function(e,t,o){e.exports=n;o(1);var i=o(0);o(2),o(30),o(4),o(13);function n(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}n.prototype.add=function(e){this.particles.push(e),this.neighbors.length<this.particles.length&&this.neighbors.push([])},n.prototype.remove=function(e){var t=this.particles.indexOf(e);-1!==t&&(this.particles.splice(t,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var r=new i;n.prototype.getNeighbors=function(e,t){for(var o=this.particles.length,i=e.id,n=this.smoothingRadius*this.smoothingRadius,s=r,a=0;a!==o;a++){var l=this.particles[a];l.position.vsub(e.position,s),i!==l.id&&s.norm2()<n&&t.push(l)}};var s=new i,a=new i,l=new i,c=new i,u=new i,h=new i;n.prototype.update=function(){for(var e=this.particles.length,t=s,o=this.speedOfSound,i=this.eps,n=0;n!==e;n++){var r=this.particles[n];(S=this.neighbors[n]).length=0,this.getNeighbors(r,S),S.push(this.particles[n]);for(var g=S.length,d=0,p=0;p!==g;p++){r.position.vsub(S[p].position,t);var f=t.norm(),m=this.w(f);d+=S[p].mass*m}this.densities[n]=d,this.pressures[n]=o*o*(this.densities[n]-this.density)}var y=a,v=l,E=c,_=u,T=h;for(n=0;n!==e;n++){var b,M,A=this.particles[n];y.set(0,0,0),v.set(0,0,0);var S;for(g=(S=this.neighbors[n]).length,p=0;p!==g;p++){var w=S[p];A.position.vsub(w.position,_);var C=_.norm();b=-w.mass*(this.pressures[n]/(this.densities[n]*this.densities[n]+i)+this.pressures[p]/(this.densities[p]*this.densities[p]+i)),this.gradw(_,E),E.mult(b,E),y.vadd(E,y),w.velocity.vsub(A.velocity,T),T.mult(1/(1e-4+this.densities[n]*this.densities[p])*this.viscosity*w.mass,T),M=this.nablaw(C),T.mult(M,T),v.vadd(T,v)}v.mult(A.mass,v),y.mult(A.mass,y),A.force.vadd(v,A.force),A.force.vadd(y,A.force)}},n.prototype.w=function(e){var t=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(t,9))*Math.pow(t*t-e*e,3)},n.prototype.gradw=function(e,t){var o=e.norm(),i=this.smoothingRadius;e.mult(945/(32*Math.PI*Math.pow(i,9))*Math.pow(i*i-o*o,2),t)},n.prototype.nablaw=function(e){var t=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(t,9))*(t*t-e*e)*(7*e*e-3*t*t)}},function(e,t,o){o(1);var i=o(20);function n(e){i.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var t=this.axisList;this._addBodyHandler=function(e){t.push(e.body)},this._removeBodyHandler=function(e){var o=t.indexOf(e.body);-1!==o&&t.splice(o,1)},e&&this.setWorld(e)}e.exports=n,n.prototype=new i,n.prototype.setWorld=function(e){this.axisList.length=0;for(var t=0;t<e.bodies.length;t++)this.axisList.push(e.bodies[t]);e.removeEventListener("addBody",this._addBodyHandler),e.removeEventListener("removeBody",this._removeBodyHandler),e.addEventListener("addBody",this._addBodyHandler),e.addEventListener("removeBody",this._removeBodyHandler),this.world=e,this.dirty=!0},n.insertionSortX=function(e){for(var t=1,o=e.length;t<o;t++){for(var i=e[t],n=t-1;n>=0&&!(e[n].aabb.lowerBound.x<=i.aabb.lowerBound.x);n--)e[n+1]=e[n];e[n+1]=i}return e},n.insertionSortY=function(e){for(var t=1,o=e.length;t<o;t++){for(var i=e[t],n=t-1;n>=0&&!(e[n].aabb.lowerBound.y<=i.aabb.lowerBound.y);n--)e[n+1]=e[n];e[n+1]=i}return e},n.insertionSortZ=function(e){for(var t=1,o=e.length;t<o;t++){for(var i=e[t],n=t-1;n>=0&&!(e[n].aabb.lowerBound.z<=i.aabb.lowerBound.z);n--)e[n+1]=e[n];e[n+1]=i}return e},n.prototype.collisionPairs=function(e,t,o){var i,r,s=this.axisList,a=s.length,l=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),i=0;i!==a;i++){var c=s[i];for(r=i+1;r<a;r++){var u=s[r];if(this.needBroadphaseCollision(c,u)){if(!n.checkBounds(c,u,l))break;this.intersectionTest(c,u,t,o)}}}},n.prototype.sortList=function(){for(var e=this.axisList,t=this.axisIndex,o=e.length,i=0;i!==o;i++){var r=e[i];r.aabbNeedsUpdate&&r.computeAABB()}0===t?n.insertionSortX(e):1===t?n.insertionSortY(e):2===t&&n.insertionSortZ(e)},n.checkBounds=function(e,t,o){var i,n;0===o?(i=e.position.x,n=t.position.x):1===o?(i=e.position.y,n=t.position.y):2===o&&(i=e.position.z,n=t.position.z);var r=e.boundingRadius,s=t.boundingRadius;return n-s<i+r},n.prototype.autoDetectAxis=function(){for(var e=0,t=0,o=0,i=0,n=0,r=0,s=this.axisList,a=s.length,l=1/a,c=0;c!==a;c++){var u=s[c],h=u.position.x;e+=h,t+=h*h;var g=u.position.y;o+=g,i+=g*g;var d=u.position.z;n+=d,r+=d*d}var p=t-e*e*l,f=i-o*o*l,m=r-n*n*l;this.axisIndex=p>f?p>m?0:2:f>m?1:2},n.prototype.aabbQuery=function(e,t,o){o=o||[],this.dirty&&(this.sortList(),this.dirty=!1);var i=this.axisIndex,n="x";1===i&&(n="y"),2===i&&(n="z");for(var r=this.axisList,s=(t.lowerBound[n],t.upperBound[n],0);s<r.length;s++){var a=r[s];a.aabbNeedsUpdate&&a.computeAABB(),a.aabb.overlaps(t)&&o.push(a)}return o}},function(e,t,o){var i=o(4),n=o(29),r=o(21),s=o(0),a=o(32);function l(e){if(this.wheelBodies=[],this.coordinateSystem=void 0===e.coordinateSystem?new s(1,2,3):e.coordinateSystem.clone(),this.chassisBody=e.chassisBody,!this.chassisBody){var t=new r(new s(5,2,.5));this.chassisBody=new i(1,t)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}e.exports=l,l.prototype.addWheel=function(e){var t=(e=e||{}).body;t||(t=new i(1,new n(1.2))),this.wheelBodies.push(t),this.wheelForces.push(0);new s;var o=void 0!==e.position?e.position.clone():new s,r=new s;this.chassisBody.pointToWorldFrame(o,r),t.position.set(r.x,r.y,r.z);var l=void 0!==e.axis?e.axis.clone():new s(0,1,0);this.wheelAxes.push(l);var c=new a(this.chassisBody,t,{pivotA:o,axisA:l,pivotB:s.ZERO,axisB:l,collideConnected:!1});return this.constraints.push(c),this.wheelBodies.length-1},l.prototype.setSteeringValue=function(e,t){var o=this.wheelAxes[t],i=Math.cos(e),n=Math.sin(e),r=o.x,s=o.y;this.constraints[t].axisA.set(i*r-n*s,n*r+i*s,0)},l.prototype.setMotorSpeed=function(e,t){var o=this.constraints[t];o.enableMotor(),o.motorTargetVelocity=e},l.prototype.disableMotor=function(e){this.constraints[e].disableMotor()};var c=new s;l.prototype.setWheelForce=function(e,t){this.wheelForces[t]=e},l.prototype.applyWheelForce=function(e,t){var o=this.wheelAxes[t],i=this.wheelBodies[t],n=i.torque;o.scale(e,c),i.vectorToWorldFrame(c,c),n.vadd(c,n)},l.prototype.addToWorld=function(e){for(var t=this.constraints,o=this.wheelBodies.concat([this.chassisBody]),i=0;i<o.length;i++)e.addBody(o[i]);for(i=0;i<t.length;i++)e.addConstraint(t[i]);e.addEventListener("preStep",this._update.bind(this))},l.prototype._update=function(){for(var e=this.wheelForces,t=0;t<e.length;t++)this.applyWheelForce(e[t],t)},l.prototype.removeFromWorld=function(e){for(var t=this.constraints,o=this.wheelBodies.concat([this.chassisBody]),i=0;i<o.length;i++)e.remove(o[i]);for(i=0;i<t.length;i++)e.removeConstraint(t[i])};var u=new s;l.prototype.getWheelSpeed=function(e){var t=this.wheelAxes[e],o=this.wheelBodies[e].angularVelocity;return this.chassisBody.vectorToWorldFrame(t,u),o.dot(u)}},function(e,t,o){var i=o(0),n=o(9),r=o(12),s=o(14);function a(e){e=s.defaults(e,{chassisConnectionPointLocal:new i,chassisConnectionPointWorld:new i,directionLocal:new i,directionWorld:new i,axleLocal:new i,axleWorld:new i,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=e.maxSuspensionTravel,this.customSlidingRotationalSpeed=e.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=e.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=e.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=e.chassisConnectionPointWorld.clone(),this.directionLocal=e.directionLocal.clone(),this.directionWorld=e.directionWorld.clone(),this.axleLocal=e.axleLocal.clone(),this.axleWorld=e.axleWorld.clone(),this.suspensionRestLength=e.suspensionRestLength,this.suspensionMaxLength=e.suspensionMaxLength,this.radius=e.radius,this.suspensionStiffness=e.suspensionStiffness,this.dampingCompression=e.dampingCompression,this.dampingRelaxation=e.dampingRelaxation,this.frictionSlip=e.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=e.rollInfluence,this.maxSuspensionForce=e.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=e.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new r,this.worldTransform=new n,this.isInContact=!1}e.exports=a;var l=new i,c=new i;l=new i;a.prototype.updateWheel=function(e){var t=this.raycastResult;if(this.isInContact){var o=t.hitNormalWorld.dot(t.directionWorld);t.hitPointWorld.vsub(e.position,c),e.getVelocityAtWorldPoint(c,l);var i=t.hitNormalWorld.dot(l);if(o>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var n=-1/o;this.suspensionRelativeVelocity=i*n,this.clippedInvContactDotSuspension=n}}else t.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.hitNormalWorld),this.clippedInvContactDotSuspension=1}},function(e,t,o){o(4);var i=o(0),n=o(2),r=(o(12),o(19)),s=o(110);function a(e){this.chassisBody=e.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==e.indexRightAxis?e.indexRightAxis:1,this.indexForwardAxis=void 0!==e.indexForwardAxis?e.indexForwardAxis:0,this.indexUpAxis=void 0!==e.indexUpAxis?e.indexUpAxis:2}e.exports=a;new i,new i,new i;var l=new i,c=new i,u=new i;new r;a.prototype.addWheel=function(e){var t=new s(e=e||{}),o=this.wheelInfos.length;return this.wheelInfos.push(t),o},a.prototype.setSteeringValue=function(e,t){this.wheelInfos[t].steering=e};new i;a.prototype.applyEngineForce=function(e,t){this.wheelInfos[t].engineForce=e},a.prototype.setBrake=function(e,t){this.wheelInfos[t].brake=e},a.prototype.addToWorld=function(e){this.constraints;e.addBody(this.chassisBody);var t=this;this.preStepCallback=function(){t.updateVehicle(e.dt)},e.addEventListener("preStep",this.preStepCallback),this.world=e},a.prototype.getVehicleAxisWorld=function(e,t){t.set(0===e?1:0,1===e?1:0,2===e?1:0),this.chassisBody.vectorToWorldFrame(t,t)},a.prototype.updateVehicle=function(e){for(var t=this.wheelInfos,o=t.length,n=this.chassisBody,r=0;r<o;r++)this.updateWheelTransform(r);this.currentVehicleSpeedKmHour=3.6*n.velocity.norm();var s=new i;this.getVehicleAxisWorld(this.indexForwardAxis,s),s.dot(n.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(r=0;r<o;r++)this.castRay(t[r]);this.updateSuspension(e);var a=new i,l=new i;for(r=0;r<o;r++){var c=(d=t[r]).suspensionForce;c>d.maxSuspensionForce&&(c=d.maxSuspensionForce),d.raycastResult.hitNormalWorld.scale(c*e,a),d.raycastResult.hitPointWorld.vsub(n.position,l),n.applyImpulse(a,l)}this.updateFriction(e);var u=new i,h=new i,g=new i;for(r=0;r<o;r++){var d=t[r];n.getVelocityAtWorldPoint(d.chassisConnectionPointWorld,g);var p=1;switch(this.indexUpAxis){case 1:p=-1}if(d.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,h);var f=h.dot(d.raycastResult.hitNormalWorld);d.raycastResult.hitNormalWorld.scale(f,u),h.vsub(u,h);var m=h.dot(g);d.deltaRotation=p*m*e/d.radius}!d.sliding&&d.isInContact||0===d.engineForce||!d.useCustomSlidingRotationalSpeed||(d.deltaRotation=(d.engineForce>0?1:-1)*d.customSlidingRotationalSpeed*e),Math.abs(d.brake)>Math.abs(d.engineForce)&&(d.deltaRotation=0),d.rotation+=d.deltaRotation,d.deltaRotation*=.99}},a.prototype.updateSuspension=function(e){for(var t=this.chassisBody.mass,o=this.wheelInfos,i=o.length,n=0;n<i;n++){var r=o[n];if(r.isInContact){var s,a=r.suspensionRestLength-r.suspensionLength;s=r.suspensionStiffness*a*r.clippedInvContactDotSuspension;var l=r.suspensionRelativeVelocity;s-=(l<0?r.dampingCompression:r.dampingRelaxation)*l,r.suspensionForce=s*t,r.suspensionForce<0&&(r.suspensionForce=0)}else r.suspensionForce=0}},a.prototype.removeFromWorld=function(e){this.constraints;e.remove(this.chassisBody),e.removeEventListener("preStep",this.preStepCallback),this.world=null};var h=new i,g=new i;a.prototype.castRay=function(e){var t=h,o=g;this.updateWheelTransformWorld(e);var n=this.chassisBody,r=-1,s=e.suspensionRestLength+e.radius;e.directionWorld.scale(s,t);var a=e.chassisConnectionPointWorld;a.vadd(t,o);var l=e.raycastResult;l.reset();var c=n.collisionResponse;n.collisionResponse=!1,this.world.rayTest(a,o,l),n.collisionResponse=c;var u=l.body;if(e.raycastResult.groundObject=0,u){r=l.distance,e.raycastResult.hitNormalWorld=l.hitNormalWorld,e.isInContact=!0;var d=l.distance;e.suspensionLength=d-e.radius;var p=e.suspensionRestLength-e.maxSuspensionTravel,f=e.suspensionRestLength+e.maxSuspensionTravel;e.suspensionLength<p&&(e.suspensionLength=p),e.suspensionLength>f&&(e.suspensionLength=f,e.raycastResult.reset());var m=e.raycastResult.hitNormalWorld.dot(e.directionWorld),y=new i;n.getVelocityAtWorldPoint(e.raycastResult.hitPointWorld,y);var v=e.raycastResult.hitNormalWorld.dot(y);if(m>=-.1)e.suspensionRelativeVelocity=0,e.clippedInvContactDotSuspension=10;else{var E=-1/m;e.suspensionRelativeVelocity=v*E,e.clippedInvContactDotSuspension=E}}else e.suspensionLength=e.suspensionRestLength+0*e.maxSuspensionTravel,e.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.raycastResult.hitNormalWorld),e.clippedInvContactDotSuspension=1;return r},a.prototype.updateWheelTransformWorld=function(e){e.isInContact=!1;var t=this.chassisBody;t.pointToWorldFrame(e.chassisConnectionPointLocal,e.chassisConnectionPointWorld),t.vectorToWorldFrame(e.directionLocal,e.directionWorld),t.vectorToWorldFrame(e.axleLocal,e.axleWorld)},a.prototype.updateWheelTransform=function(e){var t=l,o=c,i=u,r=this.wheelInfos[e];this.updateWheelTransformWorld(r),r.directionLocal.scale(-1,t),o.copy(r.axleLocal),t.cross(o,i),i.normalize(),o.normalize();var s=r.steering,a=new n;a.setFromAxisAngle(t,s);var h=new n;h.setFromAxisAngle(o,r.rotation);var g=r.worldTransform.quaternion;this.chassisBody.quaternion.mult(a,g),g.mult(h,g),g.normalize();var d=r.worldTransform.position;d.copy(r.directionWorld),d.scale(r.suspensionLength,d),d.vadd(r.chassisConnectionPointWorld,d)};var d=[new i(1,0,0),new i(0,1,0),new i(0,0,1)];a.prototype.getWheelTransformWorld=function(e){return this.wheelInfos[e].worldTransform};var p=new i,f=[],m=[];a.prototype.updateFriction=function(e){for(var t=p,o=this.wheelInfos,n=o.length,r=this.chassisBody,s=m,a=f,l=0;l<n;l++){(g=(w=o[l]).raycastResult.body)&&0,w.sideImpulse=0,w.forwardImpulse=0,s[l]||(s[l]=new i),a[l]||(a[l]=new i)}for(l=0;l<n;l++){if(g=(w=o[l]).raycastResult.body){var c=a[l];this.getWheelTransformWorld(l).vectorToWorldFrame(d[this.indexRightAxis],c);var u=w.raycastResult.hitNormalWorld,h=c.dot(u);u.scale(h,t),c.vsub(t,c),c.normalize(),u.cross(c,s[l]),s[l].normalize(),w.sideImpulse=L(r,w.raycastResult.hitPointWorld,g,w.raycastResult.hitPointWorld,c),w.sideImpulse*=1}}this.sliding=!1;for(l=0;l<n;l++){var g=(w=o[l]).raycastResult.body,y=0;if(w.slipInfo=1,g){var v=w.brake?w.brake:0;y=_(r,g,w.raycastResult.hitPointWorld,s[l],v);var E=v/(y+=w.engineForce*e);w.slipInfo*=E}if(w.forwardImpulse=0,w.skidInfo=1,g){w.skidInfo=1;var T=w.suspensionForce*e*w.frictionSlip,b=T*T;w.forwardImpulse=y;var M=.5*w.forwardImpulse,A=1*w.sideImpulse,S=M*M+A*A;if(w.sliding=!1,S>b){this.sliding=!0,w.sliding=!0;E=T/Math.sqrt(S);w.skidInfo*=E}}}if(this.sliding)for(l=0;l<n;l++){0!==(w=o[l]).sideImpulse&&w.skidInfo<1&&(w.forwardImpulse*=w.skidInfo,w.sideImpulse*=w.skidInfo)}for(l=0;l<n;l++){var w=o[l],C=new i;if(w.raycastResult.hitPointWorld.vsub(r.position,C),0!==w.forwardImpulse){var N=new i;s[l].scale(w.forwardImpulse,N),r.applyImpulse(N,C)}if(0!==w.sideImpulse){g=w.raycastResult.body;var I=new i;w.raycastResult.hitPointWorld.vsub(g.position,I);var R=new i;a[l].scale(w.sideImpulse,R),r.vectorToLocalFrame(C,C),C["xyz"[this.indexUpAxis]]*=w.rollInfluence,r.vectorToWorldFrame(C,C),r.applyImpulse(R,C),R.scale(-1,R),g.applyImpulse(R,I)}}};var y=new i,v=new i,E=new i;function _(e,t,o,i,n){var r=0,s=o,a=y,l=v,c=E;e.getVelocityAtWorldPoint(s,a),t.getVelocityAtWorldPoint(s,l),a.vsub(l,c);return n<(r=-i.dot(c)*(1/(S(e,o,i)+S(t,o,i))))&&(r=n),r<-n&&(r=-n),r}var T=new i,b=new i,M=new i,A=new i;function S(e,t,o){var i=T,n=b,r=M,s=A;return t.vsub(e.position,i),i.cross(o,n),e.invInertiaWorld.vmult(n,s),s.cross(i,r),e.invMass+o.dot(r)}var w=new i,C=new i,N=new i;function L(e,t,o,i,n,r){if(n.norm2()>1.1)return 0;var s=w,a=C,l=N;e.getVelocityAtWorldPoint(t,s),o.getVelocityAtWorldPoint(i,a),s.vsub(a,l);return-.2*n.dot(l)*(1/(e.invMass+o.invMass))}},function(e,t){function o(){this.matrix={}}e.exports=o,o.prototype.get=function(e,t){if(e=e.id,(t=t.id)>e){var o=t;t=e,e=o}return e+"-"+t in this.matrix},o.prototype.set=function(e,t,o){if(e=e.id,(t=t.id)>e){var i=t;t=e,e=i}o?this.matrix[e+"-"+t]=!0:delete this.matrix[e+"-"+t]},o.prototype.reset=function(){this.matrix={}},o.prototype.setNumObjects=function(e){}},function(e,t,o){e.exports=s;o(8);var i=o(17),n=o(16),r=(o(23),o(3),o(0));function s(e,t,o){var s=void 0!==(o=o||{}).maxForce?o.maxForce:1e6,a=new r,l=new r,c=new r;e.position.vadd(t.position,c),c.scale(.5,c),t.pointToLocalFrame(c,l),e.pointToLocalFrame(c,a),i.call(this,e,a,t,l,s),this.xA=e.vectorToLocalFrame(r.UNIT_X),this.xB=t.vectorToLocalFrame(r.UNIT_X),this.yA=e.vectorToLocalFrame(r.UNIT_Y),this.yB=t.vectorToLocalFrame(r.UNIT_Y),this.zA=e.vectorToLocalFrame(r.UNIT_Z),this.zB=t.vectorToLocalFrame(r.UNIT_Z);var u=this.rotationalEquation1=new n(e,t,o),h=this.rotationalEquation2=new n(e,t,o),g=this.rotationalEquation3=new n(e,t,o);this.equations.push(u,h,g)}s.prototype=new i,s.constructor=s;new r,new r;s.prototype.update=function(){var e=this.bodyA,t=this.bodyB,o=(this.motorEquation,this.rotationalEquation1),n=this.rotationalEquation2,r=this.rotationalEquation3;i.prototype.update.call(this),e.vectorToWorldFrame(this.xA,o.axisA),t.vectorToWorldFrame(this.yB,o.axisB),e.vectorToWorldFrame(this.yA,n.axisA),t.vectorToWorldFrame(this.zB,n.axisB),e.vectorToWorldFrame(this.zA,r.axisA),t.vectorToWorldFrame(this.xB,r.axisB)}},function(e,t,o){var i=o(1),n=o(10),r=o(0),s=o(14);function a(e,t){t=s.defaults(t,{maxValue:null,minValue:null,elementSize:1}),this.data=e,this.maxValue=t.maxValue,this.minValue=t.minValue,this.elementSize=t.elementSize,null===t.minValue&&this.updateMinValue(),null===t.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,i.call(this),this.pillarConvex=new n,this.pillarOffset=new r,this.type=i.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}e.exports=a,a.prototype=new i,a.prototype.update=function(){this._cachedPillars={}},a.prototype.updateMinValue=function(){for(var e=this.data,t=e[0][0],o=0;o!==e.length;o++)for(var i=0;i!==e[o].length;i++){var n=e[o][i];n<t&&(t=n)}this.minValue=t},a.prototype.updateMaxValue=function(){for(var e=this.data,t=e[0][0],o=0;o!==e.length;o++)for(var i=0;i!==e[o].length;i++){var n=e[o][i];n>t&&(t=n)}this.maxValue=t},a.prototype.setHeightValueAtIndex=function(e,t,o){this.data[e][t]=o,this.clearCachedConvexTrianglePillar(e,t,!1),e>0&&(this.clearCachedConvexTrianglePillar(e-1,t,!0),this.clearCachedConvexTrianglePillar(e-1,t,!1)),t>0&&(this.clearCachedConvexTrianglePillar(e,t-1,!0),this.clearCachedConvexTrianglePillar(e,t-1,!1)),t>0&&e>0&&this.clearCachedConvexTrianglePillar(e-1,t-1,!0)},a.prototype.getRectMinMax=function(e,t,o,i,n){n=n||[];for(var r=this.data,s=this.minValue,a=e;a<=o;a++)for(var l=t;l<=i;l++){var c=r[a][l];c>s&&(s=c)}n[0]=this.minValue,n[1]=s},a.prototype.getIndexOfPosition=function(e,t,o,i){var n=this.elementSize,r=this.data,s=Math.floor(e/n),a=Math.floor(t/n);return o[0]=s,o[1]=a,i&&(s<0&&(s=0),a<0&&(a=0),s>=r.length-1&&(s=r.length-1),a>=r[0].length-1&&(a=r[0].length-1)),!(s<0||a<0||s>=r.length-1||a>=r[0].length-1)};var l=[],c=new r,u=new r,h=new r,g=new r;a.prototype.getTriangleAt=function(e,t,o,i,n,r){var s=l;this.getIndexOfPosition(e,t,s,o);var a=s[0],c=s[1],u=this.data;o&&(a=Math.min(u.length-2,Math.max(0,a)),c=Math.min(u[0].length-2,Math.max(0,c)));var h=this.elementSize,g=Math.pow(e/h-a,2)+Math.pow(t/h-c,2)>Math.pow(e/h-(a+1),2)+Math.pow(t/h-(c+1),2);return this.getTriangle(a,c,g,i,n,r),g};var d=new r,p=new r,f=new r,m=new r,y=new r;a.prototype.getNormalAt=function(e,t,o,i){var n=d,r=p,s=f,a=m,l=y;this.getTriangleAt(e,t,o,n,r,s),r.vsub(n,a),s.vsub(n,l),a.cross(l,i),i.normalize()},a.prototype.getAabbAtIndex=function(e,t,o){var i=this.data,n=this.elementSize;o.lowerBound.set(e*n,t*n,i[e][t]),o.upperBound.set((e+1)*n,(t+1)*n,i[e+1][t+1])},a.prototype.getHeightAt=function(e,t,o){var i=this.data,n=u,r=h,s=g,a=l;this.getIndexOfPosition(e,t,a,o);var d=a[0],p=a[1];o&&(d=Math.min(i.length-2,Math.max(0,d)),p=Math.min(i[0].length-2,Math.max(0,p)));var f=this.getTriangleAt(e,t,o,n,r,s);!function(e,t,o,i,n,r,s,a,l){l.x=((r-a)*(e-s)+(s-n)*(t-a))/((r-a)*(o-s)+(s-n)*(i-a)),l.y=((a-i)*(e-s)+(o-s)*(t-a))/((r-a)*(o-s)+(s-n)*(i-a)),l.z=1-l.x-l.y}(e,t,n.x,n.y,r.x,r.y,s.x,s.y,c);var m=c;return f?i[d+1][p+1]*m.x+i[d][p+1]*m.y+i[d+1][p]*m.z:i[d][p]*m.x+i[d+1][p]*m.y+i[d][p+1]*m.z},a.prototype.getCacheConvexTrianglePillarKey=function(e,t,o){return e+"_"+t+"_"+(o?1:0)},a.prototype.getCachedConvexTrianglePillar=function(e,t,o){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,o)]},a.prototype.setCachedConvexTrianglePillar=function(e,t,o,i,n){this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,o)]={convex:i,offset:n}},a.prototype.clearCachedConvexTrianglePillar=function(e,t,o){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,o)]},a.prototype.getTriangle=function(e,t,o,i,n,r){var s=this.data,a=this.elementSize;o?(i.set((e+1)*a,(t+1)*a,s[e+1][t+1]),n.set(e*a,(t+1)*a,s[e][t+1]),r.set((e+1)*a,t*a,s[e+1][t])):(i.set(e*a,t*a,s[e][t]),n.set((e+1)*a,t*a,s[e+1][t]),r.set(e*a,(t+1)*a,s[e][t+1]))},a.prototype.getConvexTrianglePillar=function(e,t,o){var i=this.pillarConvex,s=this.pillarOffset;if(this.cacheEnabled){if(a=this.getCachedConvexTrianglePillar(e,t,o))return this.pillarConvex=a.convex,void(this.pillarOffset=a.offset);i=new n,s=new r,this.pillarConvex=i,this.pillarOffset=s}var a=this.data,l=this.elementSize,c=i.faces;i.vertices.length=6;for(var u=0;u<6;u++)i.vertices[u]||(i.vertices[u]=new r);c.length=5;for(u=0;u<5;u++)c[u]||(c[u]=[]);var h=i.vertices,g=(Math.min(a[e][t],a[e+1][t],a[e][t+1],a[e+1][t+1])-this.minValue)/2+this.minValue;o?(s.set((e+.75)*l,(t+.75)*l,g),h[0].set(.25*l,.25*l,a[e+1][t+1]-g),h[1].set(-.75*l,.25*l,a[e][t+1]-g),h[2].set(.25*l,-.75*l,a[e+1][t]-g),h[3].set(.25*l,.25*l,-g-1),h[4].set(-.75*l,.25*l,-g-1),h[5].set(.25*l,-.75*l,-g-1),c[0][0]=0,c[0][1]=1,c[0][2]=2,c[1][0]=5,c[1][1]=4,c[1][2]=3,c[2][0]=2,c[2][1]=5,c[2][2]=3,c[2][3]=0,c[3][0]=3,c[3][1]=4,c[3][2]=1,c[3][3]=0,c[4][0]=1,c[4][1]=4,c[4][2]=5,c[4][3]=2):(s.set((e+.25)*l,(t+.25)*l,g),h[0].set(-.25*l,-.25*l,a[e][t]-g),h[1].set(.75*l,-.25*l,a[e+1][t]-g),h[2].set(-.25*l,.75*l,a[e][t+1]-g),h[3].set(-.25*l,-.25*l,-g-1),h[4].set(.75*l,-.25*l,-g-1),h[5].set(-.25*l,.75*l,-g-1),c[0][0]=0,c[0][1]=1,c[0][2]=2,c[1][0]=5,c[1][1]=4,c[1][2]=3,c[2][0]=0,c[2][1]=2,c[2][2]=5,c[2][3]=3,c[3][0]=1,c[3][1]=0,c[3][2]=3,c[3][3]=4,c[4][0]=4,c[4][1]=5,c[4][2]=2,c[4][3]=1),i.computeNormals(),i.computeEdges(),i.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(e,t,o,i,s)},a.prototype.calculateLocalInertia=function(e,t){return(t=t||new r).set(0,0,0),t},a.prototype.volume=function(){return Number.MAX_VALUE},a.prototype.calculateWorldAABB=function(e,t,o,i){o.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),i.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},a.prototype.updateBoundingSphereRadius=function(){var e=this.data,t=this.elementSize;this.boundingSphereRadius=new r(e.length*t,e[0].length*t,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()},a.prototype.setHeightsFromImage=function(e,t){var o=document.createElement("canvas");o.width=e.width,o.height=e.height;var i=o.getContext("2d");i.drawImage(e,0,0);var n=i.getImageData(0,0,e.width,e.height),r=this.data;r.length=0,this.elementSize=Math.abs(t.x)/n.width;for(var s=0;s<n.height;s++){for(var a=[],l=0;l<n.width;l++){var c=(n.data[4*(s*n.height+l)]+n.data[4*(s*n.height+l)+1]+n.data[4*(s*n.height+l)+2])/4/255*t.z;t.x<0?a.push(c):a.unshift(c)}t.y<0?r.unshift(a):r.push(a)}this.updateMaxValue(),this.updateMinValue(),this.update()}},function(e,t,o){e.exports=s;var i=o(20),n=o(0),r=o(1);function s(e,t,o,r,s){i.apply(this),this.nx=o||10,this.ny=r||10,this.nz=s||10,this.aabbMin=e||new n(100,100,100),this.aabbMax=t||new n(-100,-100,-100);var a=this.nx*this.ny*this.nz;if(a<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=a,this.binLengths.length=a;for(var l=0;l<a;l++)this.bins[l]=[],this.binLengths[l]=0}s.prototype=new i,s.prototype.constructor=s;var a=new n;new n;s.prototype.collisionPairs=function(e,t,o){for(var i=e.numObjects(),n=e.bodies,s=this.aabbMax,l=this.aabbMin,c=this.nx,u=this.ny,h=this.nz,g=u*h,d=h,p=1,f=s.x,m=s.y,y=s.z,v=l.x,E=l.y,_=l.z,T=c/(f-v),b=u/(m-E),M=h/(y-_),A=(f-v)/c,S=(m-E)/u,w=(y-_)/h,C=.5*Math.sqrt(A*A+S*S+w*w),N=r.types,L=N.SPHERE,I=N.PLANE,R=(N.BOX,N.COMPOUND,N.CONVEXPOLYHEDRON,this.bins),D=this.binLengths,x=this.bins.length,O=0;O!==x;O++)D[O]=0;var k=Math.ceil;l=Math.min,s=Math.max;function B(e,t,o,i,n,r,s){var a=(e-v)*T|0,l=(t-E)*b|0,f=(o-_)*M|0,m=k((i-v)*T),y=k((n-E)*b),A=k((r-_)*M);a<0?a=0:a>=c&&(a=c-1),l<0?l=0:l>=u&&(l=u-1),f<0?f=0:f>=h&&(f=h-1),m<0?m=0:m>=c&&(m=c-1),y<0?y=0:y>=u&&(y=u-1),A<0?A=0:A>=h&&(A=h-1),l*=d,f*=p,m*=g,y*=d,A*=p;for(var S=a*=g;S<=m;S+=g)for(var w=l;w<=y;w+=d)for(var C=f;C<=A;C+=p){var N=S+w+C;R[N][D[N]++]=s}}for(O=0;O!==i;O++){var P=(oe=n[O]).shape;switch(P.type){case L:var U=oe.position.x,F=oe.position.y,H=oe.position.z,j=P.radius;B(U-j,F-j,H-j,U+j,F+j,H+j,oe);break;case I:P.worldNormalNeedsUpdate&&P.computeWorldNormal(oe.quaternion);var z=P.worldNormal,V=v+.5*A-oe.position.x,G=E+.5*S-oe.position.y,W=_+.5*w-oe.position.z,Y=a;Y.set(V,G,W);for(var X=0,K=0;X!==c;X++,K+=g,Y.y=G,Y.x+=A)for(var Q=0,q=0;Q!==u;Q++,q+=d,Y.z=W,Y.y+=S)for(var J=0,$=0;J!==h;J++,$+=p,Y.z+=w)if(Y.dot(z)<C){var Z=K+q+$;R[Z][D[Z]++]=oe}break;default:oe.aabbNeedsUpdate&&oe.computeAABB(),B(oe.aabb.lowerBound.x,oe.aabb.lowerBound.y,oe.aabb.lowerBound.z,oe.aabb.upperBound.x,oe.aabb.upperBound.y,oe.aabb.upperBound.z,oe)}}for(O=0;O!==x;O++){var ee=D[O];if(ee>1){var te=R[O];for(X=0;X!==ee;X++){var oe=te[X];for(Q=0;Q!==X;Q++){var ie=te[Q];this.needBroadphaseCollision(oe,ie)&&this.intersectionTest(oe,ie,t,o)}}}}this.makePairsUnique(t,o)}},function(e,t,o){e.exports=r;var i=o(8),n=o(3);function r(e,t,o,r){i.call(this,e,t),void 0===o&&(o=e.position.distanceTo(t.position)),void 0===r&&(r=1e6),this.distance=o;var s=this.distanceEquation=new n(e,t);this.equations.push(s),s.minForce=-r,s.maxForce=r}r.prototype=new i,r.prototype.update=function(){var e=this.bodyA,t=this.bodyB,o=this.distanceEquation,i=.5*this.distance,n=o.ni;t.position.vsub(e.position,n),n.normalize(),n.mult(i,o.ri),n.mult(-i,o.rj)}},function(e,t,o){e.exports=s;var i=o(1),n=o(0),r=(o(2),o(10));function s(e,t,o,s){var a=s,l=[],c=[],u=[],h=[],g=[],d=Math.cos,p=Math.sin;l.push(new n(t*d(0),t*p(0),.5*-o)),h.push(0),l.push(new n(e*d(0),e*p(0),.5*o)),g.push(1);for(var f=0;f<a;f++){var m=2*Math.PI/a*(f+1),y=2*Math.PI/a*(f+.5);f<a-1?(l.push(new n(t*d(m),t*p(m),.5*-o)),h.push(2*f+2),l.push(new n(e*d(m),e*p(m),.5*o)),g.push(2*f+3),u.push([2*f+2,2*f+3,2*f+1,2*f])):u.push([0,1,2*f+1,2*f]),(a%2==1||f<a/2)&&c.push(new n(d(y),p(y),0))}u.push(g),c.push(new n(0,0,1));var v=[];for(f=0;f<h.length;f++)v.push(h[h.length-f-1]);u.push(v),this.type=i.types.CONVEXPOLYHEDRON,r.call(this,l,u,c)}s.prototype=new r},function(e,t,o){e.exports=r;var i=o(0),n=(o(5),o(7));function r(e,t,o){var r=void 0!==(o=o||{}).maxForce?o.maxForce:1e6;n.call(this,e,t,-r,r),this.axisA=o.axisA?o.axisA.clone():new i(1,0,0),this.axisB=o.axisB?o.axisB.clone():new i(0,1,0),this.angle=void 0!==o.angle?o.angle:0}r.prototype=new n,r.prototype.constructor=r;var s=new i,a=new i;r.prototype.computeB=function(e){var t=this.a,o=this.b,i=this.axisA,n=this.axisB,r=s,l=a,c=this.jacobianElementA,u=this.jacobianElementB;return i.cross(n,r),n.cross(i,l),c.rotational.copy(l),u.rotational.copy(r),-(Math.cos(this.angle)-i.dot(n))*t-this.computeGW()*o-e*this.computeGiMf()}},function(e,t,o){e.exports=a;o(8);var i=o(17),n=o(118),r=o(16),s=(o(3),o(0));function a(e,t,o){var a=void 0!==(o=o||{}).maxForce?o.maxForce:1e6,l=o.pivotA?o.pivotA.clone():new s,c=o.pivotB?o.pivotB.clone():new s;this.axisA=o.axisA?o.axisA.clone():new s,this.axisB=o.axisB?o.axisB.clone():new s,i.call(this,e,l,t,c,a),this.collideConnected=!!o.collideConnected,this.angle=void 0!==o.angle?o.angle:0;var u=this.coneEquation=new n(e,t,o),h=this.twistEquation=new r(e,t,o);this.twistAngle=void 0!==o.twistAngle?o.twistAngle:0,u.maxForce=0,u.minForce=-a,h.maxForce=0,h.minForce=-a,this.equations.push(u,h)}a.prototype=new i,a.constructor=a;new s,new s;a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,o=this.coneEquation,n=this.twistEquation;i.prototype.update.call(this),e.vectorToWorldFrame(this.axisA,o.axisA),t.vectorToWorldFrame(this.axisB,o.axisB),this.axisA.tangents(n.axisA,n.axisA),e.vectorToWorldFrame(n.axisA,n.axisA),this.axisB.tangents(n.axisB,n.axisB),t.vectorToWorldFrame(n.axisB,n.axisB),o.angle=this.angle,n.maxAngle=this.twistAngle}},function(e,t,o){e.exports=n;var i=o(0);function n(){this.spatial=new i,this.rotational=new i}n.prototype.multiplyElement=function(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)},n.prototype.multiplyVectors=function(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}},function(e){e.exports={_from:"github:donmccurdy/cannon.js#v0.6.2-dev1",_id:"cannon@0.6.2",_inBundle:!1,_location:"/cannon",_phantomChildren:{},_requested:{type:"git",raw:"cannon@github:donmccurdy/cannon.js#v0.6.2-dev1",name:"cannon",escapedName:"cannon",rawSpec:"github:donmccurdy/cannon.js#v0.6.2-dev1",saveSpec:"github:donmccurdy/cannon.js#v0.6.2-dev1",fetchSpec:null,gitCommittish:"v0.6.2-dev1"},_requiredBy:["/aframe-physics-system"],_resolved:"github:donmccurdy/cannon.js#022e8ba53fa83abf0ad8a0e4fd08623123838a17",_spec:"cannon@github:donmccurdy/cannon.js#v0.6.2-dev1",_where:"D:\\21299527\\a-blocks\\node_modules\\aframe-physics-system",author:{name:"Stefan Hedman",email:"schteppe@gmail.com",url:"http://steffe.se"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},bundleDependencies:!1,dependencies:{},deprecated:!1,description:"A lightweight 3D physics engine written in JavaScript.",devDependencies:{browserify:"*",grunt:"~0.4.0","grunt-browserify":"^2.1.4","grunt-contrib-concat":"~0.1.3","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"^0.5.1","grunt-contrib-yuidoc":"^0.5.2",jshint:"latest",nodeunit:"^0.9.0","uglify-js":"latest"},engines:{node:"*"},homepage:"https://github.com/schteppe/cannon.js",keywords:["cannon.js","cannon","physics","engine","3d"],licenses:[{type:"MIT"}],main:"./src/Cannon.js",name:"cannon",repository:{type:"git",url:"git+https://github.com/schteppe/cannon.js.git"},version:"0.6.2"}},function(e,t,o){var i=o(26);e.exports={"checkpoint-controls":o(88),"gamepad-controls":o(87),"hmd-controls":o(84),"keyboard-controls":o(83),"mouse-controls":o(81),"touch-controls":o(80),"universal-controls":o(79),registerAll:function(e){this._registered||(e=e||window.AFRAME,i.registerAll(),e.components["checkpoint-controls"]||e.registerComponent("checkpoint-controls",this["checkpoint-controls"]),e.components["gamepad-controls"]||e.registerComponent("gamepad-controls",this["gamepad-controls"]),e.components["hmd-controls"]||e.registerComponent("hmd-controls",this["hmd-controls"]),e.components["keyboard-controls"]||e.registerComponent("keyboard-controls",this["keyboard-controls"]),e.components["mouse-controls"]||e.registerComponent("mouse-controls",this["mouse-controls"]),e.components["touch-controls"]||e.registerComponent("touch-controls",this["touch-controls"]),e.components["universal-controls"]||e.registerComponent("universal-controls",this["universal-controls"]),this._registered=!0)}}},function(e,t,o){e.exports={controls:o(122),loaders:o(78),misc:o(68),pathfinding:o(59),physics:o(26),primitives:o(51),registerAll:function(){this.controls.registerAll(),this.loaders.registerAll(),this.misc.registerAll(),this.pathfinding.registerAll(),this.physics.registerAll(),this.primitives.registerAll()}}},function(e,t){AFRAME.registerComponent("camera-rig",{schema:{position:{default:{x:0,y:1.6,z:0},type:"vec3"}},init:function(){this.lastVRPos={x:0,y:0,z:0},this.lhand=$("#leftHand").get(0),this.rhand=$("#rightHand").get(0),this.el.sceneEl.is("vr-mode")||(this.el.setAttribute("position",this.data.position),this.el.setAttribute("visible",!1)),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},onEnterVR:function(){this.el.setAttribute("position",this.lastVRPos),this.el.setAttribute("visible",!0),this.lhand.setAttribute("static-body","shape: sphere; sphereRadius: 0.05;"),this.rhand.setAttribute("static-body","shape: sphere; sphereRadius: 0.05;")},onExitVR:function(){this.lastVRPos=this.el.getAttribute("position"),this.el.setAttribute("position",this.data.position),this.el.setAttribute("visible",!1),this.lhand.removeAttribute("static-body"),this.rhand.removeAttribute("static-body")}})},function(e,t){AFRAME.registerComponent("custom-events",{schema:{},init:function(){this.lastVis=!0,this.el.components.visible&&(this.lastVis=this.el.components.visible.data),this.lastGrav=this.el.hasAttribute("dynamic-body"),this.lastGeom="",this.el.components.geometry&&(this.lastGeom=JSON.stringify(this.el.components.geometry.data)),this.el.dispatchEvent(new CustomEvent("toggleVisible",{detail:this.lastVis})),this.el.dispatchEvent(new CustomEvent("toggleGravity",{detail:this.lastGrav}))},tick:function(e,t){this.el.components.visible.data!==this.lastVis&&(this.lastVis=this.el.components.visible.data,this.el.dispatchEvent(new CustomEvent("toggleVisible",{detail:this.lastVis}))),this.el.hasAttribute("dynamic-body")!==this.lastGrav&&(this.lastGrav=!this.lastGrav,this.el.dispatchEvent(new CustomEvent("toggleGravity",{detail:this.lastGrav})));let o=JSON.stringify(this.el.components.geometry.data);if(this.lastGeom!==o){if(this.el.components.geometry.oldData){let e=this.el.hasAttribute("dynamic-body")?"dynamic-body":"static-body",t=this.el.components[e].data;this.el.removeAttribute(e),this.el.setAttribute(e,t)}this.lastGeom=o,this.el.dispatchEvent(new CustomEvent("updateGeometry",{detail:this.el.components.geometry.data}))}}})},function(e,t){e.exports="(function(){\r\n\tlet mat = self.el.getAttribute('material');\r\n\tmat.color = ({{{colour}}}) || '#ff0000';\r\n\tself.el.setAttribute('material', mat);\r\n\tself.el.dispatchEvent(new CustomEvent('materialtextureloaded',{}));\r\n})();"},function(e,t,o){const i=o(15),n={set_colour:Handlebars.compile(o(126))};i.Blocks.props_colour_set={init:function(){this.appendValueInput("COLOUR").setCheck("Colour").appendField("set colour to"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(20),this.setTooltip("Sets the colour of the object to the specified colour. If you have a texture, you won't see the colour."),this.setHelpUrl("")}},i.JavaScript.props_colour_set=function(e){var t={colour:i.JavaScript.valueToCode(e,"COLOUR",i.JavaScript.ORDER_ATOMIC)};return 0===t.colour.indexOf("#")&&(t.colour='"'+t.colour+'"'),n.set_colour(t)}},function(e,t){e.exports="(function(){\n  if(!self.blockstore.waits['{{{id}}}']) self.blockstore.waits['{{{id}}}'] = [];\n  self.blockstore.waits['{{{id}}}'].push(self._time + ({{{sec}}})*1000);\n}).apply(self);"},function(e,t){e.exports="(function(){\n  var msg = {{{msg}}};\n  var $toastContent = $('<form action><div class=\"input-field\" style=\"display:inline-block;\"><input id=\"msg\"><label for=\"msg\"></label></div><button class=\"btn blue\" type=\"submit\">Ok</button></form>');\n  $toastContent.find('label').text(msg);\n  $toastContent.find('input').attr('type', '{{type}}');\n  Materialize.toast($toastContent);\n  $toastContent.submit(function(e){\n    e.preventDefault();\n    self.vars.{{var}} = $toastContent.find('input').val();\n    {{#if isNum}} self.vars.{{var}} = Number(self.vars.{{var}}) || 0;{{/if}}\n    $toastContent.parent().remove();\n    self.callbacks['{{{id}}}'].apply(self);\n  });\n}).apply(self);"},function(e,t,o){const i=o(15),n={prompt:Handlebars.compile(o(129)),wait:Handlebars.compile(o(128))};window.colourRandom=function(){return"#"+Math.random().toString(16).substr(2,6)},i.JavaScript.variables_get=function(e){return["self.vars."+i.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),i.Variables.VARIABLE_CATEGORY_NAME),i.JavaScript.ORDER_ATOMIC]},i.JavaScript.variables_set=function(e){var t=i.JavaScript.valueToCode(e,"VALUE",i.JavaScript.ORDER_ASSIGNMENT)||"0";return"self.vars."+i.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),i.Variables.VARIABLE_CATEGORY_NAME)+" = "+t+";\n"},i.JavaScript.math_change=function(e){var t=i.JavaScript.valueToCode(e,"DELTA",i.JavaScript.ORDER_ADDITION)||"0",o="self.vars."+i.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),i.Variables.VARIABLE_CATEGORY_NAME);return o+" = (typeof "+o+" == 'number' ? "+o+" : 0) + "+t+";\n"},i.JavaScript.text_print=function(e){return"Materialize.toast($('<span></span>').text("+(i.JavaScript.valueToCode(e,"TEXT",i.JavaScript.ORDER_NONE)||"''")+"), 1000);\n"},i.Blocks.text_async_prompt={init:function(){this.appendValueInput("MSG").setCheck("String").appendField("to").appendField(new i.FieldVariable("item"),"VAR").appendField("ask for").appendField(new i.FieldDropdown([["text","text"],["number","number"]]),"TYPE").appendField("from user with the message"),this.appendStatementInput("CALLBACK").setCheck(null).appendField("and then:"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(160),this.setTooltip("This will ask the user for a text/number using the given message, and store it to the selected variable."),this.setHelpUrl("")},_isAsync:!0},i.JavaScript.text_async_prompt=function(e){var t={msg:i.JavaScript.valueToCode(e,"MSG",i.JavaScript.ORDER_NONE)||"''",type:e.getFieldValue("TYPE"),var:e.getFieldValue("VAR"),id:e.id};return t.isNum="number"===t.type,n.prompt(t)},i.Blocks.time_async_wait={init:function(){this.appendValueInput("SEC").setCheck("Number").appendField("wait for"),this.appendDummyInput().appendField("seconds, then"),this.appendStatementInput("CALLBACK").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(40),this.setTooltip("This will pause and wait for the number of seconds and then run the code inside."),this.setHelpUrl("")},_isAsync:!0},i.JavaScript.time_async_wait=function(e){var t={sec:i.JavaScript.valueToCode(e,"SEC",i.JavaScript.ORDER_NONE)||"0",id:e.id};return n.wait(t)}},function(e,t){e.exports="(function(){\n  var vec = {x: self.el.components.{{type}}.data.x, y: self.el.components.{{type}}.data.y, z: self.el.components.{{type}}.data.z};\n  vec.{{dir}} = ({{val}});\n  if(self.el.hasAttribute('dynamic-body')){\n    if('{{type}}' === 'rotation') self.el.body.quaternion.setFromEuler(vec.x % 360, vec.y % 360, vec.z % 360);\n    else self.el.body.position.set(vec.x, vec.y, vec.z);\n  } else {\n    self.el.setAttribute('{{type}}', vec.x + ' ' + vec.y + ' ' + vec.z);\n  }\n}).apply(self);\n"},function(e,t){e.exports="(function(){\n  var degrees = ({{{degrees}}}) || 0;\n  var dir = {{{dir}}} || 'F';\n  if(dir === 'L' || dir === 'D' || dir === 'B') degrees = degrees*-1;\n  var rot = self.el.components.rotation.data;\n  if(dir === 'L' || dir === 'R' || dir === 'Y') rot.y {{#if rotRelative}}+{{/if}}= degrees;\n  if(dir === 'U' || dir === 'D' || dir === 'X') rot.x {{#if rotRelative}}+{{/if}}= degrees;\n  if(dir === 'B' || dir === 'F' || dir === 'Z') rot.z {{#if rotRelative}}+{{/if}}= degrees;\n\n  if(self.el.hasAttribute('dynamic-body')){\n    self.el.body.quaternion.setFromEuler(rot.x % 360, rot.y % 360, rot.z % 360);\n  } else {\n    self.el.setAttribute('rotation', rot.x % 360 + ' ' + rot.y % 360 + ' ' + rot.z % 360);\n  }\n}).apply(self);"},function(e,t){e.exports="(function(){\n  var steps = ({{{steps}}})*0.001 || 0;\n  var dir = {{{dir}}} || 'F';\n  if(dir === 'L' || dir === 'D' || dir === 'B') steps = steps*-1;\n  var vec = new THREE.Vector3(\n    (dir === 'L' || dir === 'R' || dir === 'X') ? steps : 0,\n    (dir === 'U' || dir === 'D' || dir === 'Y') ? steps : 0,\n    (dir === 'B' || dir === 'F' || dir === 'Z') ? steps : 0\n  );\n  {{#if rotRelative}}\n    if(!(dir === 'X' || dir === 'Y' || dir === 'Z')) {\n      var rot = self.el.components.rotation.data;\n      vec.applyEuler(new THREE.Euler(\n        (rot.x / 180) * Math.PI,\n        (rot.y / 180) * Math.PI,\n        (rot.z / 180) * Math.PI\n      ));\n    }\n  {{/if}}\n  {{#if posRelative}}\n    var pos = self.el.components.position.data;\n    vec.set(pos.x + vec.x, pos.y + vec.y, pos.z + vec.z);\n  {{/if}}\n  if(self.el.hasAttribute('dynamic-body')){\n    self.el.body.position.set(vec.x, vec.y, vec.z);\n  } else {\n    self.el.setAttribute('position', vec.toArray().join(' '));\n  }\n}).apply(self);"},function(e,t,o){const i=o(15),n={move:Handlebars.compile(o(133)),rotate:Handlebars.compile(o(132)),set:Handlebars.compile(o(131))};i.Blocks.position_move={init:function(){this.appendValueInput("DIRECTION").setCheck("Direction").appendField("Move"),this.appendValueInput("STEPS").setCheck("Number").appendField("by"),this.appendDummyInput().appendField("steps"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(240),this.setTooltip("1 step is 1 mm. x, y and z are global, the rest are relative to rotation."),this.setHelpUrl("")}},i.JavaScript.position_move=function(e){let t={dir:i.JavaScript.valueToCode(e,"DIRECTION",i.JavaScript.ORDER_NONE)||'"F"',steps:i.JavaScript.valueToCode(e,"STEPS",i.JavaScript.ORDER_NONE)||"0",rotRelative:!0,posRelative:!0};return n.move(t)},i.Blocks.position_rotate={init:function(){this.appendValueInput("DIRECTION").setCheck("Direction").appendField("Turn"),this.appendValueInput("DEGREES").setCheck("Number").appendField("by"),this.appendDummyInput().appendField("degrees"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(240),this.setTooltip("Up and Down turn around X, Left and Right turn around Y and Backwards and Forwards turn around Z."),this.setHelpUrl("")}},i.JavaScript.position_rotate=function(e){let t={dir:i.JavaScript.valueToCode(e,"DIRECTION",i.JavaScript.ORDER_NONE)||'"F"',degrees:i.JavaScript.valueToCode(e,"DEGREES",i.JavaScript.ORDER_NONE)||"0",rotRelative:!0};return n.rotate(t)},i.Blocks.position_direction={init:function(){this.appendDummyInput().appendField(new i.FieldDropdown([["Forwards","F"],["Backwards","B"],["Left","L"],["Right","R"],["Up","U"],["Down","D"],["X","X"],["Y","Y"],["Z","Z"]]),"DIR"),this.setOutput(!0,"Direction"),this.setColour(240),this.setTooltip("x, y and z are global, the rest are relative to rotation."),this.setHelpUrl("")}},i.JavaScript.position_direction=function(e){return['"'+e.getFieldValue("DIR")+'"',i.JavaScript.ORDER_NONE]},i.Blocks.position_getpos={init:function(){this.appendDummyInput().appendField(new i.FieldDropdown([["x (left-right)","x"],["y (up-down)","y"],["z (backwards-forwards)","z"]]),"DIR").appendField("position"),this.setOutput(!0,null),this.setColour(240),this.setTooltip("An objects position consists of three values; x, y and z."),this.setHelpUrl("")}},i.JavaScript.position_getpos=function(e){return["(self.el.components.position.data."+e.getFieldValue("DIR")+"*1000)",i.JavaScript.ORDER_NONE]},i.Blocks.position_getrot={init:function(){this.appendDummyInput().appendField(new i.FieldDropdown([["x (up-down)","x"],["y (left-right)","y"],["z (backwards-forwards)","z"]]),"DIR").appendField("rotation"),this.setOutput(!0,null),this.setColour(240),this.setTooltip("An objects rotation consists of three values; x, y and z. (in degrees)"),this.setHelpUrl("")}},i.JavaScript.position_getrot=function(e){return["(self.el.components.rotation.data."+e.getFieldValue("DIR")+")",i.JavaScript.ORDER_NONE]},i.Blocks.position_setpos={init:function(){this.appendValueInput("VAL").setCheck("Number").appendField("Set").appendField(new i.FieldDropdown([["x (left-right)","x"],["y (up-down)","y"],["z (backwards-forwards)","z"]]),"DIR").appendField("position to"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(240),this.setTooltip("An objects position consists of three values; x, y and z."),this.setHelpUrl("")}},i.JavaScript.position_setpos=function(e){var t={dir:e.getFieldValue("DIR"),val:i.JavaScript.valueToCode(e,"VAL",i.JavaScript.ORDER_NONE)||"0",type:"position"};return n.set(t)},i.Blocks.position_setrot={init:function(){this.appendValueInput("VAL").setCheck("Number").appendField("Set").appendField(new i.FieldDropdown([["x (up-down)","x"],["y (left-right)","y"],["z (backwards-forwards)","z"]]),"DIR").appendField("rotation to"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(240),this.setTooltip("An objects position consists of three values; x, y and z."),this.setHelpUrl("")}},i.JavaScript.position_setrot=function(e){var t={dir:e.getFieldValue("DIR"),val:i.JavaScript.valueToCode(e,"VAL",i.JavaScript.ORDER_NONE)||"0",type:"rotation"};return n.set(t)}},function(e,t){e.exports="var time = arguments[0];\nvar delta = arguments[1];\nif(!self.blockstore['interval_{{id}}']) self.blockstore['interval_{{id}}'] = time;\nif(time - self.blockstore['interval_{{id}}'] < ({{sec}})*1000) return;\nself.blockstore['interval_{{id}}'] = time;\n"},function(e,t,o){const i=o(15),n={interval:Handlebars.compile(o(135))};i.BlockSvg.START_HAT=!0,i.Blocks.aframeevent_tick={init:function(){this.appendDummyInput().appendField("Run forever"),this.setNextStatement(!0,null),this.setColour(40),this.setTooltip("Happens every time we draw a frame of the animation."),this.setHelpUrl("")}},i.JavaScript.aframeevent_tick=function(e){return"var time = arguments[0];var delta = arguments[1];"},i.Blocks.aframeevent_interval={init:function(){this.appendDummyInput().appendField("Run every").appendField(new i.FieldNumber(2,0),"SEC").appendField("seconds"),this.setNextStatement(!0,null),this.setColour(40),this.setTooltip("Only runs your code between the set interval"),this.setHelpUrl("")}},i.JavaScript.aframeevent_interval=function(e){var t={sec:e.getFieldValue("SEC"),id:e.id};return n.interval(t)};const r=function(){let e=[["Left Hand","leftHand"],["Right Hand","rightHand"]];return $("a-entity[scene-panel]").each(function(){e.push([$(this).get(0).components["scene-panel"].data.name,$(this).attr("id")])}),e};i.Blocks.aframeevent_collision={init:function(){this.appendDummyInput().appendField("Run when I touch ").appendField(new i.FieldDropdown(r),"ID"),this.setNextStatement(!0,null),this.setColour(40),this.setTooltip("Runs when this object touches another."),this.setHelpUrl("")}},i.JavaScript.aframeevent_collision=function(e){return`var event = arguments[0]; if(event.detail.body.el.id === event.detail.target.el.id || event.detail.body.el.id !== '${e.getFieldValue("ID")}') return;\n`}},function(e,t){e.exports='<xml id="toolbox" style="display: none">\n    <category web-class="toolbox-name" name="{{name}}" disabled="true"></category>\n    <sep></sep>\n    <category id="catEvents" colour="40" name="Events">\n        <block type="aframeevent_tick"></block>\n        <block type="aframeevent_interval"></block>\n        <block type="time_async_wait">\n            <value name="SEC">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="aframeevent_collision"></block>\n    </category>\n    <category id="catPos" colour="240" name="Position">\n        <block type="position_move">\n            <value name="DIRECTION">\n                <block type="position_direction">\n                    <field name="DIR">F</field>\n                </block>\n            </value>\n            <value name="STEPS">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="position_rotate">\n            <value name="DIRECTION">\n                <block type="position_direction">\n                    <field name="DIR">L</field>\n                </block>\n            </value>\n            <value name="DEGREES">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="position_direction">\n            <field name="DIR">F</field>\n        </block>\n        <block type="position_getpos"> </block>\n        <block type="position_getrot"> </block>\n        <block type="position_setpos">\n            <value name="VAL">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="position_setrot">\n            <value name="VAL">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <sep></sep>\n    <category id="catLogic" colour="210" name="Logic">\n        <block type="controls_if"></block>\n        <block type="logic_compare"></block>\n        <block type="logic_operation"></block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean"></block>\n        <block type="logic_null"></block>\n        <block type="logic_ternary"></block>\n    </category>\n    <category id="catLoops" colour="120" name="Loops">\n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_whileUntil"></block>\n        <block type="controls_for">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n            <value name="BY">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_forEach"></block>\n        <block type="controls_flow_statements"></block>\n    </category>\n    <category id="catMath" colour="230" name="Math">\n        <block type="math_number"></block>\n        <block type="math_arithmetic">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_single">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">9</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_trig">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">45</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constant"></block>\n        <block type="math_number_property">\n            <value name="NUMBER_TO_CHECK">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_change">\n            <value name="DELTA">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_round">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">3.1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_on_list"></block>\n        <block type="math_modulo">\n            <value name="DIVIDEND">\n                <shadow type="math_number">\n                    <field name="NUM">64</field>\n                </shadow>\n            </value>\n            <value name="DIVISOR">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constrain">\n            <value name="VALUE">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="LOW">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="HIGH">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_int">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_float"></block>\n    </category>\n    <category id="catText" colour="160" name="Text">\n        <block type="text"></block>\n        <block type="text_join"></block>\n        <block type="text_append">\n            <value name="TEXT">\n                <shadow type="text"></shadow>\n            </value>\n        </block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_isEmpty">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n            <value name="FIND">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_charAt">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_getSubstring">\n            <value name="STRING">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_changeCase">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_trim">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_print">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_async_prompt">\n            <value name="MSG">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n            <value name="CALLBACK">\n                <shadow type="text_print">\n                    <value name="TEXT">\n                        <shadow type="variables_get">\n                            <field name="VAR">item</field>\n                        </shadow>\n                    </value>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catLists" colour="260" name="Lists">\n        <block type="lists_create_with">\n            <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with"></block>\n        <block type="lists_repeat">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getIndex">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_setIndex">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getSublist">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_split">\n            <value name="DELIM">\n                <shadow type="text">\n                    <field name="TEXT">,</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_sort"></block>\n    </category>\n    <category id="catColour" colour="20" name="Color">\n        <block type="colour_picker"></block>\n        <block type="colour_random"></block>\n        <block type="colour_rgb">\n            <value name="RED">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n            <value name="GREEN">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="BLUE">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="colour_blend">\n            <value name="COLOUR1">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#ff0000</field>\n                </shadow>\n            </value>\n            <value name="COLOUR2">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#3333ff</field>\n                </shadow>\n            </value>\n            <value name="RATIO">\n                <shadow type="math_number">\n                    <field name="NUM">0.5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="props_colour_set">\n            <value name="COLOUR">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#ff0000</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <sep></sep>\n    <category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>\n    <category id="catFunctions" colour="290" custom="PROCEDURE" name="Functions"></category>\n</xml>'},function(e,t){e.exports=function(e){"use strict";return e.Python=new e.Generator("Python"),e.Python.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip"),e.Python.ORDER_ATOMIC=0,e.Python.ORDER_COLLECTION=1,e.Python.ORDER_STRING_CONVERSION=1,e.Python.ORDER_MEMBER=2.1,e.Python.ORDER_FUNCTION_CALL=2.2,e.Python.ORDER_EXPONENTIATION=3,e.Python.ORDER_UNARY_SIGN=4,e.Python.ORDER_BITWISE_NOT=4,e.Python.ORDER_MULTIPLICATIVE=5,e.Python.ORDER_ADDITIVE=6,e.Python.ORDER_BITWISE_SHIFT=7,e.Python.ORDER_BITWISE_AND=8,e.Python.ORDER_BITWISE_XOR=9,e.Python.ORDER_BITWISE_OR=10,e.Python.ORDER_RELATIONAL=11,e.Python.ORDER_LOGICAL_NOT=12,e.Python.ORDER_LOGICAL_AND=13,e.Python.ORDER_LOGICAL_OR=14,e.Python.ORDER_CONDITIONAL=15,e.Python.ORDER_LAMBDA=16,e.Python.ORDER_NONE=99,e.Python.ORDER_OVERRIDES=[[e.Python.ORDER_FUNCTION_CALL,e.Python.ORDER_MEMBER],[e.Python.ORDER_FUNCTION_CALL,e.Python.ORDER_FUNCTION_CALL],[e.Python.ORDER_MEMBER,e.Python.ORDER_MEMBER],[e.Python.ORDER_MEMBER,e.Python.ORDER_FUNCTION_CALL],[e.Python.ORDER_LOGICAL_NOT,e.Python.ORDER_LOGICAL_NOT],[e.Python.ORDER_LOGICAL_AND,e.Python.ORDER_LOGICAL_AND],[e.Python.ORDER_LOGICAL_OR,e.Python.ORDER_LOGICAL_OR]],e.Python.init=function(t){e.Python.PASS=this.INDENT+"pass\n",e.Python.definitions_=Object.create(null),e.Python.functionNames_=Object.create(null),e.Python.variableDB_?e.Python.variableDB_.reset():e.Python.variableDB_=new e.Names(e.Python.RESERVED_WORDS_),e.Python.variableDB_.setVariableMap(t.getVariableMap());for(var o=[],i=e.Variables.allDeveloperVariables(t),n=0;n<i.length;n++)o.push(e.Python.variableDB_.getName(i[n],e.Names.DEVELOPER_VARIABLE_TYPE)+" = None");for(t=e.Variables.allUsedVarModels(t),n=0;n<t.length;n++)o.push(e.Python.variableDB_.getName(t[n].getId(),e.Variables.NAME_TYPE)+" = None");e.Python.definitions_.variables=o.join("\n")},e.Python.finish=function(t){var o,i=[],n=[];for(o in e.Python.definitions_){var r=e.Python.definitions_[o];r.match(/^(from\s+\S+\s+)?import\s+\S+/)?i.push(r):n.push(r)}return delete e.Python.definitions_,delete e.Python.functionNames_,e.Python.variableDB_.reset(),(i.join("\n")+"\n\n"+n.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+t},e.Python.scrubNakedValue=function(e){return e+"\n"},e.Python.quote_=function(e){var t="'";return-1!==(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/%/g,"\\%")).indexOf("'")&&(-1===e.indexOf('"')?t='"':e=e.replace(/'/g,"\\'")),t+e+t},e.Python.scrub_=function(t,o){var i="";if(!t.outputConnection||!t.outputConnection.targetConnection){var n=t.getCommentText();(n=e.utils.wrap(n,e.Python.COMMENT_WRAP-3))&&(i=t.getProcedureDef?i+'"""'+n+'\n"""\n':i+e.Python.prefixLines(n+"\n","# "));for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==e.INPUT_VALUE&&(n=t.inputList[r].connection.targetBlock())&&(n=e.Python.allNestedComments(n))&&(i+=e.Python.prefixLines(n,"# "))}return r=t.nextConnection&&t.nextConnection.targetBlock(),i+o+(r=e.Python.blockToCode(r))},e.Python.getAdjustedInt=function(t,o,i,n){i=i||0,t.workspace.options.oneBasedIndex&&i--;var r=t.workspace.options.oneBasedIndex?"1":"0";return t=e.Python.valueToCode(t,o,i?e.Python.ORDER_ADDITIVE:e.Python.ORDER_NONE)||r,e.isNumber(t)?(t=parseInt(t,10)+i,n&&(t=-t)):(t=0<i?"int("+t+" + "+i+")":0>i?"int("+t+" - "+-i+")":"int("+t+")",n&&(t="-"+t)),t},e.Python.colour={},e.Python.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.Python.ORDER_ATOMIC]},e.Python.colour_random=function(t){return e.Python.definitions_.import_random="import random",["'#%06x' % random.randint(0, 2**24 - 1)",e.Python.ORDER_FUNCTION_CALL]},e.Python.colour_rgb=function(t){return[e.Python.provideFunction_("colour_rgb",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b):","  r = round(min(100, max(0, r)) * 2.55)","  g = round(min(100, max(0, g)) * 2.55)","  b = round(min(100, max(0, b)) * 2.55)","  return '#%02x%02x%02x' % (r, g, b)"])+"("+(e.Python.valueToCode(t,"RED",e.Python.ORDER_NONE)||0)+", "+(e.Python.valueToCode(t,"GREEN",e.Python.ORDER_NONE)||0)+", "+(t=e.Python.valueToCode(t,"BLUE",e.Python.ORDER_NONE)||0)+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.colour_blend=function(t){return[e.Python.provideFunction_("colour_blend",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(colour1, colour2, ratio):","  r1, r2 = int(colour1[1:3], 16), int(colour2[1:3], 16)","  g1, g2 = int(colour1[3:5], 16), int(colour2[3:5], 16)","  b1, b2 = int(colour1[5:7], 16), int(colour2[5:7], 16)","  ratio = min(1, max(0, ratio))","  r = round(r1 * (1 - ratio) + r2 * ratio)","  g = round(g1 * (1 - ratio) + g2 * ratio)","  b = round(b1 * (1 - ratio) + b2 * ratio)","  return '#%02x%02x%02x' % (r, g, b)"])+"("+(e.Python.valueToCode(t,"COLOUR1",e.Python.ORDER_NONE)||"'#000000'")+", "+(e.Python.valueToCode(t,"COLOUR2",e.Python.ORDER_NONE)||"'#000000'")+", "+(t=e.Python.valueToCode(t,"RATIO",e.Python.ORDER_NONE)||0)+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.lists={},e.Python.lists_create_empty=function(t){return["[]",e.Python.ORDER_ATOMIC]},e.Python.lists_create_with=function(t){for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.Python.valueToCode(t,"ADD"+i,e.Python.ORDER_NONE)||"None";return["["+o.join(", ")+"]",e.Python.ORDER_ATOMIC]},e.Python.lists_repeat=function(t){return["["+(e.Python.valueToCode(t,"ITEM",e.Python.ORDER_NONE)||"None")+"] * "+(t=e.Python.valueToCode(t,"NUM",e.Python.ORDER_MULTIPLICATIVE)||"0"),e.Python.ORDER_MULTIPLICATIVE]},e.Python.lists_length=function(t){return["len("+(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"[]")+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.lists_isEmpty=function(t){return["not len("+(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"[]")+")",e.Python.ORDER_LOGICAL_NOT]},e.Python.lists_indexOf=function(t){var o=e.Python.valueToCode(t,"FIND",e.Python.ORDER_NONE)||"[]",i=e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"''";if(t.workspace.options.oneBasedIndex)var n=" 0",r=" + 1",s="";else n=" -1",r="",s=" - 1";return"FIRST"==t.getFieldValue("END")?[(t=e.Python.provideFunction_("first_index",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, elem):","  try: index = my_list.index(elem)"+r,"  except: index ="+n,"  return index"]))+"("+i+", "+o+")",e.Python.ORDER_FUNCTION_CALL]:[(t=e.Python.provideFunction_("last_index",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, elem):","  try: index = len(my_list) - my_list[::-1].index(elem)"+s,"  except: index ="+n,"  return index"]))+"("+i+", "+o+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.lists_getIndex=function(t){var o=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",n=e.Python.valueToCode(t,"VALUE","RANDOM"==i?e.Python.ORDER_NONE:e.Python.ORDER_MEMBER)||"[]";switch(i){case"FIRST":if("GET"==o)return[n+"[0]",e.Python.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".pop(0)",e.Python.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".pop(0)\n";break;case"LAST":if("GET"==o)return[n+"[-1]",e.Python.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".pop()",e.Python.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".pop()\n";break;case"FROM_START":if(t=e.Python.getAdjustedInt(t,"AT"),"GET"==o)return[n+"["+t+"]",e.Python.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".pop("+t+")",e.Python.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".pop("+t+")\n";break;case"FROM_END":if(t=e.Python.getAdjustedInt(t,"AT",1,!0),"GET"==o)return[n+"["+t+"]",e.Python.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".pop("+t+")",e.Python.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".pop("+t+")\n";break;case"RANDOM":if(e.Python.definitions_.import_random="import random","GET"==o)return["random.choice("+n+")",e.Python.ORDER_FUNCTION_CALL];if(n=e.Python.provideFunction_("lists_remove_random_item",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  x = int(random.random() * len(myList))","  return myList.pop(x)"])+"("+n+")","GET_REMOVE"==o)return[n,e.Python.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+"\n"}throw"Unhandled combination (lists_getIndex)."},e.Python.lists_setIndex=function(t){var o=e.Python.valueToCode(t,"LIST",e.Python.ORDER_MEMBER)||"[]",i=t.getFieldValue("MODE")||"GET",n=t.getFieldValue("WHERE")||"FROM_START",r=e.Python.valueToCode(t,"TO",e.Python.ORDER_NONE)||"None";switch(n){case"FIRST":if("SET"==i)return o+"[0] = "+r+"\n";if("INSERT"==i)return o+".insert(0, "+r+")\n";break;case"LAST":if("SET"==i)return o+"[-1] = "+r+"\n";if("INSERT"==i)return o+".append("+r+")\n";break;case"FROM_START":if(t=e.Python.getAdjustedInt(t,"AT"),"SET"==i)return o+"["+t+"] = "+r+"\n";if("INSERT"==i)return o+".insert("+t+", "+r+")\n";break;case"FROM_END":if(t=e.Python.getAdjustedInt(t,"AT",1,!0),"SET"==i)return o+"["+t+"] = "+r+"\n";if("INSERT"==i)return o+".insert("+t+", "+r+")\n";break;case"RANDOM":if(e.Python.definitions_.import_random="import random",o.match(/^\w+$/)?t="":(n=(t=e.Python.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE))+" = "+o+"\n",o=t,t=n),t+=(n=e.Python.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE))+" = int(random.random() * len("+o+"))\n","SET"==i)return t+(o+"[")+n+"] = "+r+"\n";if("INSERT"==i)return t+(o+".insert(")+n+", "+r+")\n"}throw"Unhandled combination (lists_setIndex)."},e.Python.lists_getSublist=function(t){var o=e.Python.valueToCode(t,"LIST",e.Python.ORDER_MEMBER)||"[]",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");switch(i){case"FROM_START":"0"==(i=e.Python.getAdjustedInt(t,"AT1"))&&(i="");break;case"FROM_END":i=e.Python.getAdjustedInt(t,"AT1",1,!0);break;case"FIRST":i="";break;default:throw"Unhandled option (lists_getSublist)"}switch(n){case"FROM_START":t=e.Python.getAdjustedInt(t,"AT2",1);break;case"FROM_END":t=e.Python.getAdjustedInt(t,"AT2",0,!0),e.isNumber(String(t))?"0"==t&&(t=""):(e.Python.definitions_.import_sys="import sys",t+=" or sys.maxsize");break;case"LAST":t="";break;default:throw"Unhandled option (lists_getSublist)"}return[o+"["+i+" : "+t+"]",e.Python.ORDER_MEMBER]},e.Python.lists_sort=function(t){var o=e.Python.valueToCode(t,"LIST",e.Python.ORDER_NONE)||"[]",i=t.getFieldValue("TYPE");return t="1"===t.getFieldValue("DIRECTION")?"False":"True",[e.Python.provideFunction_("lists_sort",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, type, reverse):","  def try_float(s):","    try:","      return float(s)","    except:","      return 0","  key_funcs = {",'    "NUMERIC": try_float,','    "TEXT": str,','    "IGNORE_CASE": lambda s: str(s).lower()',"  }","  key_func = key_funcs[type]","  list_cpy = list(my_list)","  return sorted(list_cpy, key=key_func, reverse=reverse)"])+"("+o+', "'+i+'", '+t+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.lists_split=function(t){var o=t.getFieldValue("MODE");if("SPLIT"==o)t=(o=e.Python.valueToCode(t,"INPUT",e.Python.ORDER_MEMBER)||"''")+".split("+(t=e.Python.valueToCode(t,"DELIM",e.Python.ORDER_NONE))+")";else{if("JOIN"!=o)throw"Unknown mode: "+o;o=e.Python.valueToCode(t,"INPUT",e.Python.ORDER_NONE)||"[]",t=(t=e.Python.valueToCode(t,"DELIM",e.Python.ORDER_MEMBER)||"''")+".join("+o+")"}return[t,e.Python.ORDER_FUNCTION_CALL]},e.Python.lists_reverse=function(t){return["list(reversed("+(e.Python.valueToCode(t,"LIST",e.Python.ORDER_NONE)||"[]")+"))",e.Python.ORDER_FUNCTION_CALL]},e.Python.logic={},e.Python.controls_if=function(t){var o=0,i="";do{var n=e.Python.valueToCode(t,"IF"+o,e.Python.ORDER_NONE)||"False",r=e.Python.statementToCode(t,"DO"+o)||e.Python.PASS;i+=(0==o?"if ":"elif ")+n+":\n"+r,++o}while(t.getInput("IF"+o));return t.getInput("ELSE")&&(i+="else:\n"+(r=e.Python.statementToCode(t,"ELSE")||e.Python.PASS)),i},e.Python.controls_ifelse=e.Python.controls_if,e.Python.logic_compare=function(t){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i=e.Python.ORDER_RELATIONAL;return[(e.Python.valueToCode(t,"A",i)||"0")+" "+o+" "+(t=e.Python.valueToCode(t,"B",i)||"0"),i]},e.Python.logic_operation=function(t){var o="AND"==t.getFieldValue("OP")?"and":"or",i="and"==o?e.Python.ORDER_LOGICAL_AND:e.Python.ORDER_LOGICAL_OR,n=e.Python.valueToCode(t,"A",i);if(t=e.Python.valueToCode(t,"B",i),n||t){var r="and"==o?"True":"False";n||(n=r),t||(t=r)}else t=n="False";return[n+" "+o+" "+t,i]},e.Python.logic_negate=function(t){return["not "+(e.Python.valueToCode(t,"BOOL",e.Python.ORDER_LOGICAL_NOT)||"True"),e.Python.ORDER_LOGICAL_NOT]},e.Python.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"True":"False",e.Python.ORDER_ATOMIC]},e.Python.logic_null=function(t){return["None",e.Python.ORDER_ATOMIC]},e.Python.logic_ternary=function(t){var o=e.Python.valueToCode(t,"IF",e.Python.ORDER_CONDITIONAL)||"False";return[(e.Python.valueToCode(t,"THEN",e.Python.ORDER_CONDITIONAL)||"None")+" if "+o+" else "+(t=e.Python.valueToCode(t,"ELSE",e.Python.ORDER_CONDITIONAL)||"None"),e.Python.ORDER_CONDITIONAL]},e.Python.loops={},e.Python.controls_repeat_ext=function(t){var o=t.getField("TIMES")?String(parseInt(t.getFieldValue("TIMES"),10)):e.Python.valueToCode(t,"TIMES",e.Python.ORDER_NONE)||"0";o=e.isNumber(o)?parseInt(o,10):"int("+o+")";var i=e.Python.statementToCode(t,"DO");return i=e.Python.addLoopTrap(i,t.id)||e.Python.PASS,"for "+e.Python.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE)+" in range("+o+"):\n"+i},e.Python.controls_repeat=e.Python.controls_repeat_ext,e.Python.controls_whileUntil=function(t){var o="UNTIL"==t.getFieldValue("MODE"),i=e.Python.valueToCode(t,"BOOL",o?e.Python.ORDER_LOGICAL_NOT:e.Python.ORDER_NONE)||"False",n=e.Python.statementToCode(t,"DO");return n=e.Python.addLoopTrap(n,t.id)||e.Python.PASS,o&&(i="not "+i),"while "+i+":\n"+n},e.Python.controls_for=function(t){var o=e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Python.valueToCode(t,"FROM",e.Python.ORDER_NONE)||"0",n=e.Python.valueToCode(t,"TO",e.Python.ORDER_NONE)||"0",r=e.Python.valueToCode(t,"BY",e.Python.ORDER_NONE)||"1",s=e.Python.statementToCode(t,"DO");s=e.Python.addLoopTrap(s,t.id)||e.Python.PASS;var a="",l=function(){return e.Python.provideFunction_("upRange",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start <= stop:","    yield start","    start += abs(step)"])},c=function(){return e.Python.provideFunction_("downRange",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start >= stop:","    yield start","    start -= abs(step)"])};if(t=function(e,t,o){return"("+e+" <= "+t+") and "+l()+"("+e+", "+t+", "+o+") or "+c()+"("+e+", "+t+", "+o+")"},e.isNumber(i)&&e.isNumber(n)&&e.isNumber(r))i=parseFloat(i),n=parseFloat(n),r=Math.abs(parseFloat(r)),0==i%1&&0==n%1&&0==r%1?(i<=n?(n++,t=0==i&&1==r?n:i+", "+n,1!=r&&(t+=", "+r)):t=i+", "+--n+", -"+r,t="range("+t+")"):(t=i<n?l():c(),t+="("+i+", "+n+", "+r+")");else{var u=function(t,i){if(e.isNumber(t))t=parseFloat(t);else if(t.match(/^\w+$/))t="float("+t+")";else{var n=e.Python.variableDB_.getDistinctName(o+i,e.Variables.NAME_TYPE);a+=n+" = float("+t+")\n",t=n}return t};i=u(i,"_start"),n=u(n,"_end"),u(r,"_inc"),t="number"==typeof i&&"number"==typeof n?i<n?l():c():t(i,n,r)}return a+="for "+o+" in "+t+":\n"+s},e.Python.controls_forEach=function(t){var o=e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Python.valueToCode(t,"LIST",e.Python.ORDER_RELATIONAL)||"[]",n=e.Python.statementToCode(t,"DO");return"for "+o+" in "+i+":\n"+(n=e.Python.addLoopTrap(n,t.id)||e.Python.PASS)},e.Python.controls_flow_statements=function(e){switch(e.getFieldValue("FLOW")){case"BREAK":return"break\n";case"CONTINUE":return"continue\n"}throw"Unknown flow statement."},e.Python.math={},e.Python.addReservedWords("math,random,Number"),e.Python.math_number=function(t){if(1/0==(t=parseFloat(t.getFieldValue("NUM")))){t='float("inf")';var o=e.Python.ORDER_FUNCTION_CALL}else-1/0==t?(t='-float("inf")',o=e.Python.ORDER_UNARY_SIGN):o=0>t?e.Python.ORDER_UNARY_SIGN:e.Python.ORDER_ATOMIC;return[t,o]},e.Python.math_arithmetic=function(t){var o={ADD:[" + ",e.Python.ORDER_ADDITIVE],MINUS:[" - ",e.Python.ORDER_ADDITIVE],MULTIPLY:[" * ",e.Python.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",e.Python.ORDER_MULTIPLICATIVE],POWER:[" ** ",e.Python.ORDER_EXPONENTIATION]}[t.getFieldValue("OP")],i=o[0];return o=o[1],[(e.Python.valueToCode(t,"A",o)||"0")+i+(t=e.Python.valueToCode(t,"B",o)||"0"),o]},e.Python.math_single=function(t){var o=t.getFieldValue("OP");if("NEG"==o){var i=e.Python.valueToCode(t,"NUM",e.Python.ORDER_UNARY_SIGN)||"0";return["-"+i,e.Python.ORDER_UNARY_SIGN]}switch(e.Python.definitions_.import_math="import math",t="SIN"==o||"COS"==o||"TAN"==o?e.Python.valueToCode(t,"NUM",e.Python.ORDER_MULTIPLICATIVE)||"0":e.Python.valueToCode(t,"NUM",e.Python.ORDER_NONE)||"0",o){case"ABS":i="math.fabs("+t+")";break;case"ROOT":i="math.sqrt("+t+")";break;case"LN":i="math.log("+t+")";break;case"LOG10":i="math.log10("+t+")";break;case"EXP":i="math.exp("+t+")";break;case"POW10":i="math.pow(10,"+t+")";break;case"ROUND":i="round("+t+")";break;case"ROUNDUP":i="math.ceil("+t+")";break;case"ROUNDDOWN":i="math.floor("+t+")";break;case"SIN":i="math.sin("+t+" / 180.0 * math.pi)";break;case"COS":i="math.cos("+t+" / 180.0 * math.pi)";break;case"TAN":i="math.tan("+t+" / 180.0 * math.pi)"}if(i)return[i,e.Python.ORDER_FUNCTION_CALL];switch(o){case"ASIN":i="math.asin("+t+") / math.pi * 180";break;case"ACOS":i="math.acos("+t+") / math.pi * 180";break;case"ATAN":i="math.atan("+t+") / math.pi * 180";break;default:throw"Unknown math operator: "+o}return[i,e.Python.ORDER_MULTIPLICATIVE]},e.Python.math_constant=function(t){var o={PI:["math.pi",e.Python.ORDER_MEMBER],E:["math.e",e.Python.ORDER_MEMBER],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",e.Python.ORDER_MULTIPLICATIVE],SQRT2:["math.sqrt(2)",e.Python.ORDER_MEMBER],SQRT1_2:["math.sqrt(1.0 / 2)",e.Python.ORDER_MEMBER],INFINITY:["float('inf')",e.Python.ORDER_ATOMIC]};return"INFINITY"!=(t=t.getFieldValue("CONSTANT"))&&(e.Python.definitions_.import_math="import math"),o[t]},e.Python.math_number_property=function(t){var o=e.Python.valueToCode(t,"NUMBER_TO_CHECK",e.Python.ORDER_MULTIPLICATIVE)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return e.Python.definitions_.import_math="import math",e.Python.definitions_.from_numbers_import_Number="from numbers import Number",[e.Python.provideFunction_("math_isPrime",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(n):","  # https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  # If n is not a number but a string, try parsing it.","  if not isinstance(n, Number):","    try:","      n = float(n)","    except:","      return False","  if n == 2 or n == 3:","    return True","  # False if n is negative, is 1, or not whole, or if n is divisible by 2 or 3.","  if n <= 1 or n % 1 != 0 or n % 2 == 0 or n % 3 == 0:","    return False","  # Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for x in range(6, int(math.sqrt(n)) + 2, 6):","    if n % (x - 1) == 0 or n % (x + 1) == 0:","      return False","  return True"])+"("+o+")",e.Python.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var n=o+" % 2 == 0";break;case"ODD":n=o+" % 2 == 1";break;case"WHOLE":n=o+" % 1 == 0";break;case"POSITIVE":n=o+" > 0";break;case"NEGATIVE":n=o+" < 0";break;case"DIVISIBLE_BY":if(!(t=e.Python.valueToCode(t,"DIVISOR",e.Python.ORDER_MULTIPLICATIVE))||"0"==t)return["False",e.Python.ORDER_ATOMIC];n=o+" % "+t+" == 0"}return[n,e.Python.ORDER_RELATIONAL]},e.Python.math_change=function(t){e.Python.definitions_.from_numbers_import_Number="from numbers import Number";var o=e.Python.valueToCode(t,"DELTA",e.Python.ORDER_ADDITIVE)||"0";return(t=e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE))+" = ("+t+" if isinstance("+t+", Number) else 0) + "+o+"\n"},e.Python.math_round=e.Python.math_single,e.Python.math_trig=e.Python.math_single,e.Python.math_on_list=function(t){var o=t.getFieldValue("OP");switch(t=e.Python.valueToCode(t,"LIST",e.Python.ORDER_NONE)||"[]",o){case"SUM":o="sum("+t+")";break;case"MIN":o="min("+t+")";break;case"MAX":o="max("+t+")";break;case"AVERAGE":e.Python.definitions_.from_numbers_import_Number="from numbers import Number",o=(o=e.Python.provideFunction_("math_mean",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  localList = [e for e in myList if isinstance(e, Number)]","  if not localList: return","  return float(sum(localList)) / len(localList)"]))+"("+t+")";break;case"MEDIAN":e.Python.definitions_.from_numbers_import_Number="from numbers import Number",o=(o=e.Python.provideFunction_("math_median",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  localList = sorted([e for e in myList if isinstance(e, Number)])","  if not localList: return","  if len(localList) % 2 == 0:","    return (localList[len(localList) // 2 - 1] + localList[len(localList) // 2]) / 2.0","  else:","    return localList[(len(localList) - 1) // 2]"]))+"("+t+")";break;case"MODE":o=(o=e.Python.provideFunction_("math_modes",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(some_list):","  modes = []","  # Using a lists of [item, count] to keep count rather than dict",'  # to avoid "unhashable" errors when the counted item is itself a list or dict.',"  counts = []","  maxCount = 1","  for item in some_list:","    found = False","    for count in counts:","      if count[0] == item:","        count[1] += 1","        maxCount = max(maxCount, count[1])","        found = True","    if not found:","      counts.append([item, 1])","  for counted_item, item_count in counts:","    if item_count == maxCount:","      modes.append(counted_item)","  return modes"]))+"("+t+")";break;case"STD_DEV":e.Python.definitions_.import_math="import math",o=(o=e.Python.provideFunction_("math_standard_deviation",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(numbers):","  n = len(numbers)","  if n == 0: return","  mean = float(sum(numbers)) / n","  variance = sum((x - mean) ** 2 for x in numbers) / n","  return math.sqrt(variance)"]))+"("+t+")";break;case"RANDOM":e.Python.definitions_.import_random="import random",o="random.choice("+t+")";break;default:throw"Unknown operator: "+o}return[o,e.Python.ORDER_FUNCTION_CALL]},e.Python.math_modulo=function(t){return[(e.Python.valueToCode(t,"DIVIDEND",e.Python.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=e.Python.valueToCode(t,"DIVISOR",e.Python.ORDER_MULTIPLICATIVE)||"0"),e.Python.ORDER_MULTIPLICATIVE]},e.Python.math_constrain=function(t){return["min(max("+(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"0")+", "+(e.Python.valueToCode(t,"LOW",e.Python.ORDER_NONE)||"0")+"), "+(t=e.Python.valueToCode(t,"HIGH",e.Python.ORDER_NONE)||"float('inf')")+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.math_random_int=function(t){return e.Python.definitions_.import_random="import random",["random.randint("+(e.Python.valueToCode(t,"FROM",e.Python.ORDER_NONE)||"0")+", "+(t=e.Python.valueToCode(t,"TO",e.Python.ORDER_NONE)||"0")+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.math_random_float=function(t){return e.Python.definitions_.import_random="import random",["random.random()",e.Python.ORDER_FUNCTION_CALL]},e.Python.procedures={},e.Python.procedures_defreturn=function(t){for(var o,i=[],n=t.workspace,r=e.Variables.allUsedVarModels(n)||[],s=0;o=r[s];s++)o=o.name,-1==t.arguments_.indexOf(o)&&i.push(e.Python.variableDB_.getName(o,e.Variables.NAME_TYPE));for(n=e.Variables.allDeveloperVariables(n),s=0;s<n.length;s++)i.push(e.Python.variableDB_.getName(n[s],e.Names.DEVELOPER_VARIABLE_TYPE));i=i.length?e.Python.INDENT+"global "+i.join(", ")+"\n":"",n=e.Python.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),r=e.Python.statementToCode(t,"STACK"),e.Python.STATEMENT_PREFIX&&(s=t.id.replace(/\$/g,"$$$$"),r=e.Python.prefixLines(e.Python.STATEMENT_PREFIX.replace(/%1/g,"'"+s+"'"),e.Python.INDENT)+r),e.Python.INFINITE_LOOP_TRAP&&(r=e.Python.INFINITE_LOOP_TRAP.replace(/%1/g,'"'+t.id+'"')+r),(o=e.Python.valueToCode(t,"RETURN",e.Python.ORDER_NONE)||"")?o=e.Python.INDENT+"return "+o+"\n":r||(r=e.Python.PASS);var a=[];for(s=0;s<t.arguments_.length;s++)a[s]=e.Python.variableDB_.getName(t.arguments_[s],e.Variables.NAME_TYPE);return i="def "+n+"("+a.join(", ")+"):\n"+i+r+o,i=e.Python.scrub_(t,i),e.Python.definitions_["%"+n]=i,null},e.Python.procedures_defnoreturn=e.Python.procedures_defreturn,e.Python.procedures_callreturn=function(t){for(var o=e.Python.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Python.valueToCode(t,"ARG"+n,e.Python.ORDER_NONE)||"None";return[o+"("+i.join(", ")+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.procedures_callnoreturn=function(t){for(var o=e.Python.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Python.valueToCode(t,"ARG"+n,e.Python.ORDER_NONE)||"None";return o+"("+i.join(", ")+")\n"},e.Python.procedures_ifreturn=function(t){var o="if "+(e.Python.valueToCode(t,"CONDITION",e.Python.ORDER_NONE)||"False")+":\n";return t.hasReturnValue_?(t=e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"None",o+=e.Python.INDENT+"return "+t+"\n"):o+=e.Python.INDENT+"return\n",o},e.Python.texts={},e.Python.text=function(t){return[e.Python.quote_(t.getFieldValue("TEXT")),e.Python.ORDER_ATOMIC]},e.Python.text_join=function(t){switch(t.itemCount_){case 0:return["''",e.Python.ORDER_ATOMIC];case 1:return["str("+(e.Python.valueToCode(t,"ADD0",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_FUNCTION_CALL];case 2:var o=e.Python.valueToCode(t,"ADD0",e.Python.ORDER_NONE)||"''";return["str("+o+") + str("+(t=e.Python.valueToCode(t,"ADD1",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_ADDITIVE];default:o=[];for(var i=0;i<t.itemCount_;i++)o[i]=e.Python.valueToCode(t,"ADD"+i,e.Python.ORDER_NONE)||"''";return[t="''.join([str("+(t=e.Python.variableDB_.getDistinctName("x",e.Variables.NAME_TYPE))+") for "+t+" in ["+o.join(", ")+"]])",e.Python.ORDER_FUNCTION_CALL]}},e.Python.text_append=function(t){var o=e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE);return o+" = str("+o+") + str("+(t=e.Python.valueToCode(t,"TEXT",e.Python.ORDER_NONE)||"''")+")\n"},e.Python.text_length=function(t){return["len("+(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_FUNCTION_CALL]},e.Python.text_isEmpty=function(t){return["not len("+(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_LOGICAL_NOT]},e.Python.text_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"find":"rfind",i=e.Python.valueToCode(t,"FIND",e.Python.ORDER_NONE)||"''";return o=(e.Python.valueToCode(t,"VALUE",e.Python.ORDER_MEMBER)||"''")+"."+o+"("+i+")",t.workspace.options.oneBasedIndex?[o+" + 1",e.Python.ORDER_ADDITIVE]:[o,e.Python.ORDER_FUNCTION_CALL]},e.Python.text_charAt=function(t){var o=t.getFieldValue("WHERE")||"FROM_START",i=e.Python.valueToCode(t,"VALUE",e.Python.ORDER_MEMBER)||"''";switch(o){case"FIRST":return[i+"[0]",e.Python.ORDER_MEMBER];case"LAST":return[i+"[-1]",e.Python.ORDER_MEMBER];case"FROM_START":return[i+"["+(t=e.Python.getAdjustedInt(t,"AT"))+"]",e.Python.ORDER_MEMBER];case"FROM_END":return[i+"["+(t=e.Python.getAdjustedInt(t,"AT",1,!0))+"]",e.Python.ORDER_MEMBER];case"RANDOM":return e.Python.definitions_.import_random="import random",[e.Python.provideFunction_("text_random_letter",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(text):","  x = int(random.random() * len(text))","  return text[x];"])+"("+i+")",e.Python.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt)."},e.Python.text_getSubstring=function(t){var o=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),n=e.Python.valueToCode(t,"STRING",e.Python.ORDER_MEMBER)||"''";switch(o){case"FROM_START":"0"==(o=e.Python.getAdjustedInt(t,"AT1"))&&(o="");break;case"FROM_END":o=e.Python.getAdjustedInt(t,"AT1",1,!0);break;case"FIRST":o="";break;default:throw"Unhandled option (text_getSubstring)"}switch(i){case"FROM_START":t=e.Python.getAdjustedInt(t,"AT2",1);break;case"FROM_END":t=e.Python.getAdjustedInt(t,"AT2",0,!0),e.isNumber(String(t))?"0"==t&&(t=""):(e.Python.definitions_.import_sys="import sys",t+=" or sys.maxsize");break;case"LAST":t="";break;default:throw"Unhandled option (text_getSubstring)"}return[n+"["+o+" : "+t+"]",e.Python.ORDER_MEMBER]},e.Python.text_changeCase=function(t){var o={UPPERCASE:".upper()",LOWERCASE:".lower()",TITLECASE:".title()"}[t.getFieldValue("CASE")];return[(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_MEMBER)||"''")+o,e.Python.ORDER_FUNCTION_CALL]},e.Python.text_trim=function(t){var o={LEFT:".lstrip()",RIGHT:".rstrip()",BOTH:".strip()"}[t.getFieldValue("MODE")];return[(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_MEMBER)||"''")+o,e.Python.ORDER_FUNCTION_CALL]},e.Python.text_print=function(t){return"print("+(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_NONE)||"''")+")\n"},e.Python.text_prompt_ext=function(t){var o=e.Python.provideFunction_("text_prompt",["def "+e.Python.FUNCTION_NAME_PLACEHOLDER_+"(msg):","  try:","    return raw_input(msg)","  except NameError:","    return input(msg)"]);return o=o+"("+(t.getField("TEXT")?e.Python.quote_(t.getFieldValue("TEXT")):e.Python.valueToCode(t,"TEXT",e.Python.ORDER_NONE)||"''")+")","NUMBER"==t.getFieldValue("TYPE")&&(o="float("+o+")"),[o,e.Python.ORDER_FUNCTION_CALL]},e.Python.text_prompt=e.Python.text_prompt_ext,e.Python.text_count=function(t){return[(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_MEMBER)||"''")+".count("+(t=e.Python.valueToCode(t,"SUB",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_MEMBER]},e.Python.text_replace=function(t){return[(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_MEMBER)||"''")+".replace("+(e.Python.valueToCode(t,"FROM",e.Python.ORDER_NONE)||"''")+", "+(t=e.Python.valueToCode(t,"TO",e.Python.ORDER_NONE)||"''")+")",e.Python.ORDER_MEMBER]},e.Python.text_reverse=function(t){return[(e.Python.valueToCode(t,"TEXT",e.Python.ORDER_MEMBER)||"''")+"[::-1]",e.Python.ORDER_MEMBER]},e.Python.variables={},e.Python.variables_get=function(t){return[e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.Python.ORDER_ATOMIC]},e.Python.variables_set=function(t){var o=e.Python.valueToCode(t,"VALUE",e.Python.ORDER_NONE)||"0";return e.Python.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+o+"\n"},e.Python.variablesDynamic={},e.Python.variables_get_dynamic=e.Python.variables_get,e.Python.variables_set_dynamic=e.Python.variables_set,e.Python}},function(e,t){e.exports=function(e){"use strict";return e.PHP=new e.Generator("PHP"),e.PHP.addReservedWords("__halt_compiler,abstract,and,array,as,break,callable,case,catch,class,clone,const,continue,declare,default,die,do,echo,else,elseif,empty,enddeclare,endfor,endforeach,endif,endswitch,endwhile,eval,exit,extends,final,for,foreach,function,global,goto,if,implements,include,include_once,instanceof,insteadof,interface,isset,list,namespace,new,or,print,private,protected,public,require,require_once,return,static,switch,throw,trait,try,unset,use,var,while,xor,PHP_VERSION,PHP_MAJOR_VERSION,PHP_MINOR_VERSION,PHP_RELEASE_VERSION,PHP_VERSION_ID,PHP_EXTRA_VERSION,PHP_ZTS,PHP_DEBUG,PHP_MAXPATHLEN,PHP_OS,PHP_SAPI,PHP_EOL,PHP_INT_MAX,PHP_INT_SIZE,DEFAULT_INCLUDE_PATH,PEAR_INSTALL_DIR,PEAR_EXTENSION_DIR,PHP_EXTENSION_DIR,PHP_PREFIX,PHP_BINDIR,PHP_BINARY,PHP_MANDIR,PHP_LIBDIR,PHP_DATADIR,PHP_SYSCONFDIR,PHP_LOCALSTATEDIR,PHP_CONFIG_FILE_PATH,PHP_CONFIG_FILE_SCAN_DIR,PHP_SHLIB_SUFFIX,E_ERROR,E_WARNING,E_PARSE,E_NOTICE,E_CORE_ERROR,E_CORE_WARNING,E_COMPILE_ERROR,E_COMPILE_WARNING,E_USER_ERROR,E_USER_WARNING,E_USER_NOTICE,E_DEPRECATED,E_USER_DEPRECATED,E_ALL,E_STRICT,__COMPILER_HALT_OFFSET__,TRUE,FALSE,NULL,__CLASS__,__DIR__,__FILE__,__FUNCTION__,__LINE__,__METHOD__,__NAMESPACE__,__TRAIT__"),e.PHP.ORDER_ATOMIC=0,e.PHP.ORDER_CLONE=1,e.PHP.ORDER_NEW=1,e.PHP.ORDER_MEMBER=2.1,e.PHP.ORDER_FUNCTION_CALL=2.2,e.PHP.ORDER_POWER=3,e.PHP.ORDER_INCREMENT=4,e.PHP.ORDER_DECREMENT=4,e.PHP.ORDER_BITWISE_NOT=4,e.PHP.ORDER_CAST=4,e.PHP.ORDER_SUPPRESS_ERROR=4,e.PHP.ORDER_INSTANCEOF=5,e.PHP.ORDER_LOGICAL_NOT=6,e.PHP.ORDER_UNARY_PLUS=7.1,e.PHP.ORDER_UNARY_NEGATION=7.2,e.PHP.ORDER_MULTIPLICATION=8.1,e.PHP.ORDER_DIVISION=8.2,e.PHP.ORDER_MODULUS=8.3,e.PHP.ORDER_ADDITION=9.1,e.PHP.ORDER_SUBTRACTION=9.2,e.PHP.ORDER_STRING_CONCAT=9.3,e.PHP.ORDER_BITWISE_SHIFT=10,e.PHP.ORDER_RELATIONAL=11,e.PHP.ORDER_EQUALITY=12,e.PHP.ORDER_REFERENCE=13,e.PHP.ORDER_BITWISE_AND=13,e.PHP.ORDER_BITWISE_XOR=14,e.PHP.ORDER_BITWISE_OR=15,e.PHP.ORDER_LOGICAL_AND=16,e.PHP.ORDER_LOGICAL_OR=17,e.PHP.ORDER_IF_NULL=18,e.PHP.ORDER_CONDITIONAL=19,e.PHP.ORDER_ASSIGNMENT=20,e.PHP.ORDER_LOGICAL_AND_WEAK=21,e.PHP.ORDER_LOGICAL_XOR=22,e.PHP.ORDER_LOGICAL_OR_WEAK=23,e.PHP.ORDER_COMMA=24,e.PHP.ORDER_NONE=99,e.PHP.ORDER_OVERRIDES=[[e.PHP.ORDER_MEMBER,e.PHP.ORDER_FUNCTION_CALL],[e.PHP.ORDER_MEMBER,e.PHP.ORDER_MEMBER],[e.PHP.ORDER_LOGICAL_NOT,e.PHP.ORDER_LOGICAL_NOT],[e.PHP.ORDER_MULTIPLICATION,e.PHP.ORDER_MULTIPLICATION],[e.PHP.ORDER_ADDITION,e.PHP.ORDER_ADDITION],[e.PHP.ORDER_LOGICAL_AND,e.PHP.ORDER_LOGICAL_AND],[e.PHP.ORDER_LOGICAL_OR,e.PHP.ORDER_LOGICAL_OR]],e.PHP.init=function(t){e.PHP.definitions_=Object.create(null),e.PHP.functionNames_=Object.create(null),e.PHP.variableDB_?e.PHP.variableDB_.reset():e.PHP.variableDB_=new e.Names(e.PHP.RESERVED_WORDS_,"$"),e.PHP.variableDB_.setVariableMap(t.getVariableMap());for(var o=[],i=e.Variables.allDeveloperVariables(t),n=0;n<i.length;n++)o.push(e.PHP.variableDB_.getName(i[n],e.Names.DEVELOPER_VARIABLE_TYPE)+";");for(t=e.Variables.allUsedVarModels(t),n=0;i=t[n];n++)o.push(e.PHP.variableDB_.getName(i.getId(),e.Variables.NAME_TYPE)+";");e.PHP.definitions_.variables=o.join("\n")},e.PHP.finish=function(t){var o,i=[];for(o in e.PHP.definitions_)i.push(e.PHP.definitions_[o]);return delete e.PHP.definitions_,delete e.PHP.functionNames_,e.PHP.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},e.PHP.scrubNakedValue=function(e){return e+";\n"},e.PHP.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},e.PHP.scrub_=function(t,o){var i="";if(!t.outputConnection||!t.outputConnection.targetConnection){var n=t.getCommentText();(n=e.utils.wrap(n,e.PHP.COMMENT_WRAP-3))&&(i+=e.PHP.prefixLines(n,"// ")+"\n");for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==e.INPUT_VALUE&&(n=t.inputList[r].connection.targetBlock())&&(n=e.PHP.allNestedComments(n))&&(i+=e.PHP.prefixLines(n,"// "))}return r=t.nextConnection&&t.nextConnection.targetBlock(),i+o+(r=e.PHP.blockToCode(r))},e.PHP.getAdjusted=function(t,o,i,n,r){i=i||0,r=r||e.PHP.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<i?e.PHP.valueToCode(t,o,e.PHP.ORDER_ADDITION)||s:0>i?e.PHP.valueToCode(t,o,e.PHP.ORDER_SUBTRACTION)||s:n?e.PHP.valueToCode(t,o,e.PHP.ORDER_UNARY_NEGATION)||s:e.PHP.valueToCode(t,o,r)||s,e.isNumber(t))t=parseFloat(t)+i,n&&(t=-t);else{if(0<i){t=t+" + "+i;var a=e.PHP.ORDER_ADDITION}else 0>i&&(t=t+" - "+-i,a=e.PHP.ORDER_SUBTRACTION);n&&(t=i?"-("+t+")":"-"+t,a=e.PHP.ORDER_UNARY_NEGATION),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},e.PHP.colour={},e.PHP.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.PHP.ORDER_ATOMIC]},e.PHP.colour_random=function(t){return[e.PHP.provideFunction_("colour_random",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"() {","  return '#' . str_pad(dechex(mt_rand(0, 0xFFFFFF)), 6, '0', STR_PAD_LEFT);","}"])+"()",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.colour_rgb=function(t){var o=e.PHP.valueToCode(t,"RED",e.PHP.ORDER_COMMA)||0,i=e.PHP.valueToCode(t,"GREEN",e.PHP.ORDER_COMMA)||0;return t=e.PHP.valueToCode(t,"BLUE",e.PHP.ORDER_COMMA)||0,[e.PHP.provideFunction_("colour_rgb",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($r, $g, $b) {","  $r = round(max(min($r, 100), 0) * 2.55);","  $g = round(max(min($g, 100), 0) * 2.55);","  $b = round(max(min($b, 100), 0) * 2.55);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+o+", "+i+", "+t+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.colour_blend=function(t){var o=e.PHP.valueToCode(t,"COLOUR1",e.PHP.ORDER_COMMA)||"'#000000'",i=e.PHP.valueToCode(t,"COLOUR2",e.PHP.ORDER_COMMA)||"'#000000'";return t=e.PHP.valueToCode(t,"RATIO",e.PHP.ORDER_COMMA)||.5,[e.PHP.provideFunction_("colour_blend",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($c1, $c2, $ratio) {","  $ratio = max(min($ratio, 1), 0);","  $r1 = hexdec(substr($c1, 1, 2));","  $g1 = hexdec(substr($c1, 3, 2));","  $b1 = hexdec(substr($c1, 5, 2));","  $r2 = hexdec(substr($c2, 1, 2));","  $g2 = hexdec(substr($c2, 3, 2));","  $b2 = hexdec(substr($c2, 5, 2));","  $r = round($r1 * (1 - $ratio) + $r2 * $ratio);","  $g = round($g1 * (1 - $ratio) + $g2 * $ratio);","  $b = round($b1 * (1 - $ratio) + $b2 * $ratio);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+o+", "+i+", "+t+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists={},e.PHP.lists_create_empty=function(t){return["array()",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_create_with=function(t){for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.PHP.valueToCode(t,"ADD"+i,e.PHP.ORDER_COMMA)||"null";return[o="array("+o.join(", ")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_repeat=function(t){return[e.PHP.provideFunction_("lists_repeat",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value, $count) {","  $array = array();","  for ($index = 0; $index < $count; $index++) {","    $array[] = $value;","  }","  return $array;","}"])+"("+(e.PHP.valueToCode(t,"ITEM",e.PHP.ORDER_COMMA)||"null")+", "+(t=e.PHP.valueToCode(t,"NUM",e.PHP.ORDER_COMMA)||"0")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_length=function(t){return[e.PHP.provideFunction_("length",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(t=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"''")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_isEmpty=function(t){return["empty("+(e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_FUNCTION_CALL)||"array()")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_indexOf=function(t){var o=e.PHP.valueToCode(t,"FIND",e.PHP.ORDER_NONE)||"''",i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_MEMBER)||"[]";if(t.workspace.options.oneBasedIndex)var n=" 0",r=" + 1";else n=" -1",r="";return[("FIRST"==t.getFieldValue("END")?e.PHP.provideFunction_("indexOf",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) return $index"+r+";","  }","  return "+n+";","}"]):e.PHP.provideFunction_("lastIndexOf",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  $last = "+n+";","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) $last = $index"+r+";","  }","  return $last;","}"]))+"("+i+", "+o+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_getIndex=function(t){var o=t.getFieldValue("MODE")||"GET";switch(t.getFieldValue("WHERE")||"FROM_START"){case"FIRST":if("GET"==o){var i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_MEMBER)||"array()";return[i+"[0]",e.PHP.ORDER_MEMBER]}if("GET_REMOVE"==o)return["array_shift("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+")",e.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==o)return"array_shift("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+");\n";break;case"LAST":if("GET"==o)return["end("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+")",e.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return["array_pop("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+")",e.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==o)return"array_pop("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+");\n";break;case"FROM_START":var n=e.PHP.getAdjusted(t,"AT");if("GET"==o)return[(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_MEMBER)||"array()")+"["+n+"]",e.PHP.ORDER_MEMBER];if("GET_REMOVE"==o)return["array_splice("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_COMMA)||"array()")+", "+n+", 1)[0]",e.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==o)return"array_splice("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_COMMA)||"array()")+", "+n+", 1);\n";break;case"FROM_END":if("GET"==o)return["array_slice("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_COMMA)||"array()")+", "+(n=e.PHP.getAdjusted(t,"AT",1,!0))+", 1)[0]",e.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o||"REMOVE"==o){if(i="array_splice("+(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()")+", count("+i+") - "+(n=e.PHP.getAdjusted(t,"AT",1,!1,e.PHP.ORDER_SUBTRACTION))+", 1)[0]","GET_REMOVE"==o)return[i,e.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==o)return i+";\n"}break;case"RANDOM":if(i=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"array()","GET"==o)return[(o=e.PHP.provideFunction_("lists_get_random_item",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  return $list[rand(0,count($list)-1)];","}"]))+"("+i+")",e.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return[(o=e.PHP.provideFunction_("lists_get_remove_random_item",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  $x = rand(0,count($list)-1);","  unset($list[$x]);","  return array_values($list);","}"]))+"("+i+")",e.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==o)return(o=e.PHP.provideFunction_("lists_remove_random_item",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  unset($list[rand(0,count($list)-1)]);","}"]))+"("+i+");\n"}throw"Unhandled combination (lists_getIndex)."},e.PHP.lists_setIndex=function(t){var o=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",n=e.PHP.valueToCode(t,"TO",e.PHP.ORDER_ASSIGNMENT)||"null";switch(i){case"FIRST":if("SET"==o)return(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_MEMBER)||"array()")+"[0] = "+n+";\n";if("INSERT"==o)return"array_unshift("+(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()")+", "+n+");\n";break;case"LAST":if(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()","SET"==o)return(o=e.PHP.provideFunction_("lists_set_last_item",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $value) {","  $list[count($list) - 1] = $value;","}"]))+"("+i+", "+n+");\n";if("INSERT"==o)return"array_push("+i+", "+n+");\n";break;case"FROM_START":var r=e.PHP.getAdjusted(t,"AT");if("SET"==o)return(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_MEMBER)||"array()")+"["+r+"] = "+n+";\n";if("INSERT"==o)return"array_splice("+(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()")+", "+r+", 0, "+n+");\n";break;case"FROM_END":if(i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()",r=e.PHP.getAdjusted(t,"AT",1),"SET"==o)return(o=e.PHP.provideFunction_("lists_set_from_end",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  $list[count($list) - $at] = $value;","}"]))+"("+i+", "+r+", "+n+");\n";if("INSERT"==o)return(o=e.PHP.provideFunction_("lists_insert_from_end",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  return array_splice($list, count($list) - $at, 0, $value);","}"]))+"("+i+", "+r+", "+n+");\n";break;case"RANDOM":if((i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_REFERENCE)||"array()").match(/^\$\w+$/)?t="":(r=(t=e.PHP.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE))+" = &"+i+";\n",i=t,t=r),t+=(r=e.PHP.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE))+" = rand(0, count("+i+")-1);\n","SET"==o)return t+(i+"[")+r+"] = "+n+";\n";if("INSERT"==o)return t+"array_splice("+i+", "+r+", 0, "+n+");\n"}throw"Unhandled combination (lists_setIndex)."},e.PHP.lists_getSublist=function(t){var o=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"!=i||"LAST"!=n)if(o.match(/^\$\w+$/)||"FROM_END"!=i&&"FROM_START"==n){switch(i){case"FROM_START":var r=e.PHP.getAdjusted(t,"AT1");break;case"FROM_END":r="count("+o+") - "+(r=e.PHP.getAdjusted(t,"AT1",1,!1,e.PHP.ORDER_SUBTRACTION));break;case"FIRST":r="0";break;default:throw"Unhandled option (lists_getSublist)."}switch(n){case"FROM_START":i=(t=e.PHP.getAdjusted(t,"AT2",0,!1,e.PHP.ORDER_SUBTRACTION))+" - ",i=e.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")",i+=" + 1";break;case"FROM_END":i="count("+o+") - "+(t=e.PHP.getAdjusted(t,"AT2",0,!1,e.PHP.ORDER_SUBTRACTION))+" - ",i=e.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")";break;case"LAST":i="count("+o+") - ",i=e.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")";break;default:throw"Unhandled option (lists_getSublist)."}o="array_slice("+o+", "+r+", "+i+")"}else r=e.PHP.getAdjusted(t,"AT1"),t=e.PHP.getAdjusted(t,"AT2"),o=e.PHP.provideFunction_("lists_get_sublist",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = count($list) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START'){","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = count($list) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = count($list) - $at1;","  } else {","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  return array_slice($list, $at1, $length);","}"])+"("+o+", '"+i+"', "+r+", '"+n+"', "+t+")";return[o,e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_sort=function(t){var o=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"array()",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e.PHP.provideFunction_("lists_sort",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $type, $direction) {","  $sortCmpFuncs = array(",'    "NUMERIC" => "strnatcasecmp",','    "TEXT" => "strcmp",','    "IGNORE_CASE" => "strcasecmp"',"  );","  $sortCmp = $sortCmpFuncs[$type];","  $list2 = $list;","  usort($list2, $sortCmp);","  if ($direction == -1) {","    $list2 = array_reverse($list2);","  }","  return $list2;","}"])+"("+o+', "'+t+'", '+i+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_split=function(t){var o=e.PHP.valueToCode(t,"INPUT",e.PHP.ORDER_COMMA),i=e.PHP.valueToCode(t,"DELIM",e.PHP.ORDER_COMMA)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))o||(o="''"),t="explode";else{if("JOIN"!=t)throw"Unknown mode: "+t;o||(o="array()"),t="implode"}return[t+"("+i+", "+o+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.lists_reverse=function(t){return["array_reverse("+(e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_COMMA)||"[]")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.logic={},e.PHP.controls_if=function(t){var o=0,i="";do{var n=e.PHP.valueToCode(t,"IF"+o,e.PHP.ORDER_NONE)||"false",r=e.PHP.statementToCode(t,"DO"+o);i+=(0<o?" else ":"")+"if ("+n+") {\n"+r+"}",++o}while(t.getInput("IF"+o));return t.getInput("ELSE")&&(i+=" else {\n"+(r=e.PHP.statementToCode(t,"ELSE"))+"}"),i+"\n"},e.PHP.controls_ifelse=e.PHP.controls_if,e.PHP.logic_compare=function(t){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==o||"!="==o?e.PHP.ORDER_EQUALITY:e.PHP.ORDER_RELATIONAL;return[(e.PHP.valueToCode(t,"A",i)||"0")+" "+o+" "+(t=e.PHP.valueToCode(t,"B",i)||"0"),i]},e.PHP.logic_operation=function(t){var o="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==o?e.PHP.ORDER_LOGICAL_AND:e.PHP.ORDER_LOGICAL_OR,n=e.PHP.valueToCode(t,"A",i);if(t=e.PHP.valueToCode(t,"B",i),n||t){var r="&&"==o?"true":"false";n||(n=r),t||(t=r)}else t=n="false";return[n+" "+o+" "+t,i]},e.PHP.logic_negate=function(t){var o=e.PHP.ORDER_LOGICAL_NOT;return["!"+(e.PHP.valueToCode(t,"BOOL",o)||"true"),o]},e.PHP.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",e.PHP.ORDER_ATOMIC]},e.PHP.logic_null=function(t){return["null",e.PHP.ORDER_ATOMIC]},e.PHP.logic_ternary=function(t){return[(e.PHP.valueToCode(t,"IF",e.PHP.ORDER_CONDITIONAL)||"false")+" ? "+(e.PHP.valueToCode(t,"THEN",e.PHP.ORDER_CONDITIONAL)||"null")+" : "+(t=e.PHP.valueToCode(t,"ELSE",e.PHP.ORDER_CONDITIONAL)||"null"),e.PHP.ORDER_CONDITIONAL]},e.PHP.loops={},e.PHP.controls_repeat_ext=function(t){var o=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):e.PHP.valueToCode(t,"TIMES",e.PHP.ORDER_ASSIGNMENT)||"0",i=e.PHP.statementToCode(t,"DO");i=e.PHP.addLoopTrap(i,t.id),t="";var n=e.PHP.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE),r=o;return o.match(/^\w+$/)||e.isNumber(o)||(t+=(r=e.PHP.variableDB_.getDistinctName("repeat_end",e.Variables.NAME_TYPE))+" = "+o+";\n"),t+"for ("+n+" = 0; "+n+" < "+r+"; "+n+"++) {\n"+i+"}\n"},e.PHP.controls_repeat=e.PHP.controls_repeat_ext,e.PHP.controls_whileUntil=function(t){var o="UNTIL"==t.getFieldValue("MODE"),i=e.PHP.valueToCode(t,"BOOL",o?e.PHP.ORDER_LOGICAL_NOT:e.PHP.ORDER_NONE)||"false",n=e.PHP.statementToCode(t,"DO");return n=e.PHP.addLoopTrap(n,t.id),o&&(i="!"+i),"while ("+i+") {\n"+n+"}\n"},e.PHP.controls_for=function(t){var o=e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.PHP.valueToCode(t,"FROM",e.PHP.ORDER_ASSIGNMENT)||"0",n=e.PHP.valueToCode(t,"TO",e.PHP.ORDER_ASSIGNMENT)||"0",r=e.PHP.valueToCode(t,"BY",e.PHP.ORDER_ASSIGNMENT)||"1",s=e.PHP.statementToCode(t,"DO");if(s=e.PHP.addLoopTrap(s,t.id),e.isNumber(i)&&e.isNumber(n)&&e.isNumber(r)){var a=parseFloat(i)<=parseFloat(n);t="for ("+o+" = "+i+"; "+o+(a?" <= ":" >= ")+n+"; "+o,t=(1==(o=Math.abs(parseFloat(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+o)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||e.isNumber(i)||(t+=(a=e.PHP.variableDB_.getDistinctName(o+"_start",e.Variables.NAME_TYPE))+" = "+i+";\n"),i=n,n.match(/^\w+$/)||e.isNumber(n)||(t+=(i=e.PHP.variableDB_.getDistinctName(o+"_end",e.Variables.NAME_TYPE))+" = "+n+";\n"),t+=(n=e.PHP.variableDB_.getDistinctName(o+"_inc",e.Variables.NAME_TYPE))+" = ",t=(t=e.isNumber(r)?t+(Math.abs(r)+";\n"):t+"abs("+r+");\n")+"if ("+a+" > "+i+") {\n"+(e.PHP.INDENT+n)+" = -"+n+";\n",t+="}\n",t+="for ("+o+" = "+a+"; "+n+" >= 0 ? "+o+" <= "+i+" : "+o+" >= "+i+"; "+o+" += "+n+") {\n"+s+"}\n";return t},e.PHP.controls_forEach=function(t){var o=e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_ASSIGNMENT)||"[]",n=e.PHP.statementToCode(t,"DO");return"foreach ("+i+" as "+o+") {\n"+(n=e.PHP.addLoopTrap(n,t.id))+"}\n"},e.PHP.controls_flow_statements=function(e){switch(e.getFieldValue("FLOW")){case"BREAK":return"break;\n";case"CONTINUE":return"continue;\n"}throw"Unknown flow statement."},e.PHP.math={},e.PHP.math_number=function(t){var o=0<=(t=parseFloat(t.getFieldValue("NUM")))?e.PHP.ORDER_ATOMIC:e.PHP.ORDER_UNARY_NEGATION;return 1/0==t?t="INF":-1/0==t&&(t="-INF"),[t,o]},e.PHP.math_arithmetic=function(t){var o={ADD:[" + ",e.PHP.ORDER_ADDITION],MINUS:[" - ",e.PHP.ORDER_SUBTRACTION],MULTIPLY:[" * ",e.PHP.ORDER_MULTIPLICATION],DIVIDE:[" / ",e.PHP.ORDER_DIVISION],POWER:[" ** ",e.PHP.ORDER_POWER]}[t.getFieldValue("OP")],i=o[0];return o=o[1],[(e.PHP.valueToCode(t,"A",o)||"0")+i+(t=e.PHP.valueToCode(t,"B",o)||"0"),o]},e.PHP.math_single=function(t){var o=t.getFieldValue("OP");if("NEG"==o)return"-"==(t=e.PHP.valueToCode(t,"NUM",e.PHP.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,e.PHP.ORDER_UNARY_NEGATION];switch(t="SIN"==o||"COS"==o||"TAN"==o?e.PHP.valueToCode(t,"NUM",e.PHP.ORDER_DIVISION)||"0":e.PHP.valueToCode(t,"NUM",e.PHP.ORDER_NONE)||"0",o){case"ABS":var i="abs("+t+")";break;case"ROOT":i="sqrt("+t+")";break;case"LN":i="log("+t+")";break;case"EXP":i="exp("+t+")";break;case"POW10":i="pow(10,"+t+")";break;case"ROUND":i="round("+t+")";break;case"ROUNDUP":i="ceil("+t+")";break;case"ROUNDDOWN":i="floor("+t+")";break;case"SIN":i="sin("+t+" / 180 * pi())";break;case"COS":i="cos("+t+" / 180 * pi())";break;case"TAN":i="tan("+t+" / 180 * pi())"}if(i)return[i,e.PHP.ORDER_FUNCTION_CALL];switch(o){case"LOG10":i="log("+t+") / log(10)";break;case"ASIN":i="asin("+t+") / pi() * 180";break;case"ACOS":i="acos("+t+") / pi() * 180";break;case"ATAN":i="atan("+t+") / pi() * 180";break;default:throw"Unknown math operator: "+o}return[i,e.PHP.ORDER_DIVISION]},e.PHP.math_constant=function(t){return{PI:["M_PI",e.PHP.ORDER_ATOMIC],E:["M_E",e.PHP.ORDER_ATOMIC],GOLDEN_RATIO:["(1 + sqrt(5)) / 2",e.PHP.ORDER_DIVISION],SQRT2:["M_SQRT2",e.PHP.ORDER_ATOMIC],SQRT1_2:["M_SQRT1_2",e.PHP.ORDER_ATOMIC],INFINITY:["INF",e.PHP.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},e.PHP.math_number_property=function(t){var o=e.PHP.valueToCode(t,"NUMBER_TO_CHECK",e.PHP.ORDER_MODULUS)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[e.PHP.provideFunction_("math_isPrime",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if ($n == 2 || $n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (!is_numeric($n) || $n <= 1 || $n % 1 != 0 || $n % 2 == 0 || $n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for ($x = 6; $x <= sqrt($n) + 1; $x += 6) {","    if ($n % ($x - 1) == 0 || $n % ($x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",e.JavaScript.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var n=o+" % 2 == 0";break;case"ODD":n=o+" % 2 == 1";break;case"WHOLE":n="is_int("+o+")";break;case"POSITIVE":n=o+" > 0";break;case"NEGATIVE":n=o+" < 0";break;case"DIVISIBLE_BY":n=o+" % "+(t=e.PHP.valueToCode(t,"DIVISOR",e.PHP.ORDER_MODULUS)||"0")+" == 0"}return[n,e.PHP.ORDER_EQUALITY]},e.PHP.math_change=function(t){var o=e.PHP.valueToCode(t,"DELTA",e.PHP.ORDER_ADDITION)||"0";return e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" += "+o+";\n"},e.PHP.math_round=e.PHP.math_single,e.PHP.math_trig=e.PHP.math_single,e.PHP.math_on_list=function(t){var o=t.getFieldValue("OP");switch(o){case"SUM":t="array_sum("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MIN":t="min("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MAX":t="max("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"AVERAGE":t=(o=e.PHP.provideFunction_("math_mean",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($myList) {","  return array_sum($myList) / count($myList);","}"]))+"("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_NONE)||"array()")+")";break;case"MEDIAN":t=(o=e.PHP.provideFunction_("math_median",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($arr) {","  sort($arr,SORT_NUMERIC);","  return (count($arr) % 2) ? $arr[floor(count($arr)/2)] : ","      ($arr[floor(count($arr)/2)] + $arr[floor(count($arr)/2) - 1]) / 2;","}"]))+"("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_NONE)||"[]")+")";break;case"MODE":t=(o=e.PHP.provideFunction_("math_modes",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($values) {","  if (empty($values)) return array();","  $counts = array_count_values($values);","  arsort($counts); // Sort counts in descending order","  $modes = array_keys($counts, current($counts), true);","  return $modes;","}"]))+"("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(o=e.PHP.provideFunction_("math_standard_deviation",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($numbers) {","  $n = count($numbers);","  if (!$n) return null;","  $mean = array_sum($numbers) / count($numbers);","  foreach($numbers as $key => $num) $devs[$key] = pow($num - $mean, 2);","  return sqrt(array_sum($devs) / (count($devs) - 1));","}"]))+"("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(o=e.PHP.provideFunction_("math_random_list",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  $x = rand(0, count($list)-1);","  return $list[$x];","}"]))+"("+(t=e.PHP.valueToCode(t,"LIST",e.PHP.ORDER_NONE)||"[]")+")";break;default:throw"Unknown operator: "+o}return[t,e.PHP.ORDER_FUNCTION_CALL]},e.PHP.math_modulo=function(t){return[(e.PHP.valueToCode(t,"DIVIDEND",e.PHP.ORDER_MODULUS)||"0")+" % "+(t=e.PHP.valueToCode(t,"DIVISOR",e.PHP.ORDER_MODULUS)||"0"),e.PHP.ORDER_MODULUS]},e.PHP.math_constrain=function(t){return["min(max("+(e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_COMMA)||"0")+", "+(e.PHP.valueToCode(t,"LOW",e.PHP.ORDER_COMMA)||"0")+"), "+(t=e.PHP.valueToCode(t,"HIGH",e.PHP.ORDER_COMMA)||"Infinity")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.math_random_int=function(t){var o=e.PHP.valueToCode(t,"FROM",e.PHP.ORDER_COMMA)||"0";return t=e.PHP.valueToCode(t,"TO",e.PHP.ORDER_COMMA)||"0",[e.PHP.provideFunction_("math_random_int",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($a, $b) {","  if ($a > $b) {","    return rand($b, $a);","  }","  return rand($a, $b);","}"])+"("+o+", "+t+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.math_random_float=function(t){return["(float)rand()/(float)getrandmax()",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.procedures={},e.PHP.procedures_defreturn=function(t){for(var o,i=[],n=t.workspace,r=e.Variables.allUsedVarModels(n)||[],s=0;o=r[s];s++)o=o.name,-1==t.arguments_.indexOf(o)&&i.push(e.PHP.variableDB_.getName(o,e.Variables.NAME_TYPE));for(n=e.Variables.allDeveloperVariables(n),s=0;s<n.length;s++)i.push(e.PHP.variableDB_.getName(n[s],e.Names.DEVELOPER_VARIABLE_TYPE));i=i.length?e.PHP.INDENT+"global "+i.join(", ")+";\n":"",n=e.PHP.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),r=e.PHP.statementToCode(t,"STACK"),e.PHP.STATEMENT_PREFIX&&(s=t.id.replace(/\$/g,"$$$$"),r=e.PHP.prefixLines(e.PHP.STATEMENT_PREFIX.replace(/%1/g,"'"+s+"'"),e.PHP.INDENT)+r),e.PHP.INFINITE_LOOP_TRAP&&(r=e.PHP.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t.id+"'")+r),(o=e.PHP.valueToCode(t,"RETURN",e.PHP.ORDER_NONE)||"")&&(o=e.PHP.INDENT+"return "+o+";\n");var a=[];for(s=0;s<t.arguments_.length;s++)a[s]=e.PHP.variableDB_.getName(t.arguments_[s],e.Variables.NAME_TYPE);return i="function "+n+"("+a.join(", ")+") {\n"+i+r+o+"}",i=e.PHP.scrub_(t,i),e.PHP.definitions_["%"+n]=i,null},e.PHP.procedures_defnoreturn=e.PHP.procedures_defreturn,e.PHP.procedures_callreturn=function(t){for(var o=e.PHP.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.PHP.valueToCode(t,"ARG"+n,e.PHP.ORDER_COMMA)||"null";return[o+"("+i.join(", ")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.procedures_callnoreturn=function(t){for(var o=e.PHP.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.PHP.valueToCode(t,"ARG"+n,e.PHP.ORDER_COMMA)||"null";return o+"("+i.join(", ")+");\n"},e.PHP.procedures_ifreturn=function(t){var o="if ("+(e.PHP.valueToCode(t,"CONDITION",e.PHP.ORDER_NONE)||"false")+") {\n";return t.hasReturnValue_?(t=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"null",o+=e.PHP.INDENT+"return "+t+";\n"):o+=e.PHP.INDENT+"return;\n",o+"}\n"},e.PHP.texts={},e.PHP.text=function(t){return[e.PHP.quote_(t.getFieldValue("TEXT")),e.PHP.ORDER_ATOMIC]},e.PHP.text_join=function(t){if(0==t.itemCount_)return["''",e.PHP.ORDER_ATOMIC];if(1==t.itemCount_)return[e.PHP.valueToCode(t,"ADD0",e.PHP.ORDER_NONE)||"''",e.PHP.ORDER_FUNCTION_CALL];if(2==t.itemCount_){var o=e.PHP.valueToCode(t,"ADD0",e.PHP.ORDER_NONE)||"''";return[o+" . "+(t=e.PHP.valueToCode(t,"ADD1",e.PHP.ORDER_NONE)||"''"),e.PHP.ORDER_ADDITION]}o=Array(t.itemCount_);for(var i=0;i<t.itemCount_;i++)o[i]=e.PHP.valueToCode(t,"ADD"+i,e.PHP.ORDER_COMMA)||"''";return[t="implode('', array("+o.join(",")+"))",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_append=function(t){return e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" .= "+(t=e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_ASSIGNMENT)||"''")+";\n"},e.PHP.text_length=function(t){return[e.PHP.provideFunction_("length",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(t=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"''")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_isEmpty=function(t){return["empty("+(e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"''")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"strpos":"strrpos",i=e.PHP.valueToCode(t,"FIND",e.PHP.ORDER_NONE)||"''",n=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_NONE)||"''";if(t.workspace.options.oneBasedIndex)var r=" 0",s=" + 1";else r=" -1",s="";return[e.PHP.provideFunction_("FIRST"==t.getFieldValue("END")?"text_indexOf":"text_lastIndexOf",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $search) {","  $pos = "+o+"($text, $search);","  return $pos === false ? "+r+" : $pos"+s+";","}"])+"("+n+", "+i+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_charAt=function(t){var o=t.getFieldValue("WHERE")||"FROM_START",i=e.PHP.valueToCode(t,"VALUE","RANDOM"==o?e.PHP.ORDER_NONE:e.PHP.ORDER_COMMA)||"''";switch(o){case"FIRST":return["substr("+i+", 0, 1)",e.PHP.ORDER_FUNCTION_CALL];case"LAST":return["substr("+i+", -1)",e.PHP.ORDER_FUNCTION_CALL];case"FROM_START":return["substr("+i+", "+(t=e.PHP.getAdjusted(t,"AT"))+", 1)",e.PHP.ORDER_FUNCTION_CALL];case"FROM_END":return["substr("+i+", "+(t=e.PHP.getAdjusted(t,"AT",1,!0))+", 1)",e.PHP.ORDER_FUNCTION_CALL];case"RANDOM":return[e.PHP.provideFunction_("text_random_letter",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text) {","  return $text[rand(0, strlen($text) - 1)];","}"])+"("+i+")",e.PHP.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt)."},e.PHP.text_getSubstring=function(t){var o=e.PHP.valueToCode(t,"STRING",e.PHP.ORDER_FUNCTION_CALL)||"''",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"!=i||"LAST"!=n){var r=e.PHP.getAdjusted(t,"AT1");t=e.PHP.getAdjusted(t,"AT2"),o=e.PHP.provideFunction_("text_get_substring",["function "+e.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = strlen($text) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START'){","    throw new Exception('Unhandled option (text_get_substring).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = strlen($text) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = strlen($text) - $at1;","  } else {","    throw new Exception('Unhandled option (text_get_substring).');","  }","  return substr($text, $at1, $length);","}"])+"("+o+", '"+i+"', "+r+", '"+n+"', "+t+")"}return[o,e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_changeCase=function(t){var o=e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_NONE)||"''";if("UPPERCASE"==t.getFieldValue("CASE"))var i="strtoupper("+o+")";else"LOWERCASE"==t.getFieldValue("CASE")?i="strtolower("+o+")":"TITLECASE"==t.getFieldValue("CASE")&&(i="ucwords(strtolower("+o+"))");return[i,e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_trim=function(t){return[{LEFT:"ltrim",RIGHT:"rtrim",BOTH:"trim"}[t.getFieldValue("MODE")]+"("+(t=e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_NONE)||"''")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_print=function(t){return"print("+(e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_NONE)||"''")+");\n"},e.PHP.text_prompt_ext=function(t){var o="readline("+(t.getField("TEXT")?e.PHP.quote_(t.getFieldValue("TEXT")):e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(o="floatval("+o+")"),[o,e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_prompt=e.PHP.text_prompt_ext,e.PHP.text_count=function(t){var o=e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_MEMBER)||"''";return["strlen("+(t=e.PHP.valueToCode(t,"SUB",e.PHP.ORDER_NONE)||"''")+") === 0 ? strlen("+o+") + 1 : substr_count("+o+", "+t+")",e.PHP.ORDER_CONDITIONAL]},e.PHP.text_replace=function(t){var o=e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_MEMBER)||"''";return["str_replace("+(e.PHP.valueToCode(t,"FROM",e.PHP.ORDER_NONE)||"''")+", "+(t=e.PHP.valueToCode(t,"TO",e.PHP.ORDER_NONE)||"''")+", "+o+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.text_reverse=function(t){return["strrev("+(e.PHP.valueToCode(t,"TEXT",e.PHP.ORDER_MEMBER)||"''")+")",e.PHP.ORDER_FUNCTION_CALL]},e.PHP.variables={},e.PHP.variables_get=function(t){return[e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.PHP.ORDER_ATOMIC]},e.PHP.variables_set=function(t){var o=e.PHP.valueToCode(t,"VALUE",e.PHP.ORDER_ASSIGNMENT)||"0";return e.PHP.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+o+";\n"},e.PHP.variablesDynamic={},e.PHP.variables_get_dynamic=e.PHP.variables_get,e.PHP.variables_set_dynamic=e.PHP.variables_set,e.PHP}},function(e,t){e.exports=function(e){"use strict";return e.Dart=new e.Generator("Dart"),e.Dart.addReservedWords("assert,break,case,catch,class,const,continue,default,do,else,enum,extends,false,final,finally,for,if,in,is,new,null,rethrow,return,super,switch,this,throw,true,try,var,void,while,with,print,identityHashCode,identical,BidirectionalIterator,Comparable,double,Function,int,Invocation,Iterable,Iterator,List,Map,Match,num,Pattern,RegExp,Set,StackTrace,String,StringSink,Type,bool,DateTime,Deprecated,Duration,Expando,Null,Object,RuneIterator,Runes,Stopwatch,StringBuffer,Symbol,Uri,Comparator,AbstractClassInstantiationError,ArgumentError,AssertionError,CastError,ConcurrentModificationError,CyclicInitializationError,Error,Exception,FallThroughError,FormatException,IntegerDivisionByZeroException,NoSuchMethodError,NullThrownError,OutOfMemoryError,RangeError,StackOverflowError,StateError,TypeError,UnimplementedError,UnsupportedError"),e.Dart.ORDER_ATOMIC=0,e.Dart.ORDER_UNARY_POSTFIX=1,e.Dart.ORDER_UNARY_PREFIX=2,e.Dart.ORDER_MULTIPLICATIVE=3,e.Dart.ORDER_ADDITIVE=4,e.Dart.ORDER_SHIFT=5,e.Dart.ORDER_BITWISE_AND=6,e.Dart.ORDER_BITWISE_XOR=7,e.Dart.ORDER_BITWISE_OR=8,e.Dart.ORDER_RELATIONAL=9,e.Dart.ORDER_EQUALITY=10,e.Dart.ORDER_LOGICAL_AND=11,e.Dart.ORDER_LOGICAL_OR=12,e.Dart.ORDER_IF_NULL=13,e.Dart.ORDER_CONDITIONAL=14,e.Dart.ORDER_CASCADE=15,e.Dart.ORDER_ASSIGNMENT=16,e.Dart.ORDER_NONE=99,e.Dart.init=function(t){e.Dart.definitions_=Object.create(null),e.Dart.functionNames_=Object.create(null),e.Dart.variableDB_?e.Dart.variableDB_.reset():e.Dart.variableDB_=new e.Names(e.Dart.RESERVED_WORDS_),e.Dart.variableDB_.setVariableMap(t.getVariableMap());for(var o=[],i=e.Variables.allDeveloperVariables(t),n=0;n<i.length;n++)o.push(e.Dart.variableDB_.getName(i[n],e.Names.DEVELOPER_VARIABLE_TYPE));for(t=e.Variables.allUsedVarModels(t),n=0;n<t.length;n++)o.push(e.Dart.variableDB_.getName(t[n].getId(),e.Variables.NAME_TYPE));o.length&&(e.Dart.definitions_.variables="var "+o.join(", ")+";")},e.Dart.finish=function(t){t&&(t=e.Dart.prefixLines(t,e.Dart.INDENT)),t="main() {\n"+t+"}";var o,i=[],n=[];for(o in e.Dart.definitions_){var r=e.Dart.definitions_[o];r.match(/^import\s/)?i.push(r):n.push(r)}return delete e.Dart.definitions_,delete e.Dart.functionNames_,e.Dart.variableDB_.reset(),(i.join("\n")+"\n\n"+n.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+t},e.Dart.scrubNakedValue=function(e){return e+";\n"},e.Dart.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\$/g,"\\$").replace(/'/g,"\\'"))+"'"},e.Dart.scrub_=function(t,o){var i="";if(!t.outputConnection||!t.outputConnection.targetConnection){var n=t.getCommentText();(n=e.utils.wrap(n,e.Dart.COMMENT_WRAP-3))&&(i=t.getProcedureDef?i+e.Dart.prefixLines(n+"\n","/// "):i+e.Dart.prefixLines(n+"\n","// "));for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==e.INPUT_VALUE&&(n=t.inputList[r].connection.targetBlock())&&(n=e.Dart.allNestedComments(n))&&(i+=e.Dart.prefixLines(n,"// "))}return r=t.nextConnection&&t.nextConnection.targetBlock(),i+o+(r=e.Dart.blockToCode(r))},e.Dart.getAdjusted=function(t,o,i,n,r){i=i||0,r=r||e.Dart.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=i?e.Dart.valueToCode(t,o,e.Dart.ORDER_ADDITIVE)||s:n?e.Dart.valueToCode(t,o,e.Dart.ORDER_UNARY_PREFIX)||s:e.Dart.valueToCode(t,o,r)||s,e.isNumber(t))t=parseInt(t,10)+i,n&&(t=-t);else{if(0<i){t=t+" + "+i;var a=e.Dart.ORDER_ADDITIVE}else 0>i&&(t=t+" - "+-i,a=e.Dart.ORDER_ADDITIVE);n&&(t=i?"-("+t+")":"-"+t,a=e.Dart.ORDER_UNARY_PREFIX),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},e.Dart.colour={},e.Dart.addReservedWords("Math"),e.Dart.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.Dart.ORDER_ATOMIC]},e.Dart.colour_random=function(t){return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[e.Dart.provideFunction_("colour_random",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"() {","  String hex = '0123456789abcdef';","  var rnd = new Math.Random();","  return '#${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}'","      '${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}'","      '${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}';","}"])+"()",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.colour_rgb=function(t){var o=e.Dart.valueToCode(t,"RED",e.Dart.ORDER_NONE)||0,i=e.Dart.valueToCode(t,"GREEN",e.Dart.ORDER_NONE)||0;return t=e.Dart.valueToCode(t,"BLUE",e.Dart.ORDER_NONE)||0,e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[e.Dart.provideFunction_("colour_rgb",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(num r, num g, num b) {","  num rn = (Math.max(Math.min(r, 100), 0) * 2.55).round();","  String rs = rn.toInt().toRadixString(16);","  rs = '0$rs';","  rs = rs.substring(rs.length - 2);","  num gn = (Math.max(Math.min(g, 100), 0) * 2.55).round();","  String gs = gn.toInt().toRadixString(16);","  gs = '0$gs';","  gs = gs.substring(gs.length - 2);","  num bn = (Math.max(Math.min(b, 100), 0) * 2.55).round();","  String bs = bn.toInt().toRadixString(16);","  bs = '0$bs';","  bs = bs.substring(bs.length - 2);","  return '#$rs$gs$bs';","}"])+"("+o+", "+i+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.colour_blend=function(t){var o=e.Dart.valueToCode(t,"COLOUR1",e.Dart.ORDER_NONE)||"'#000000'",i=e.Dart.valueToCode(t,"COLOUR2",e.Dart.ORDER_NONE)||"'#000000'";return t=e.Dart.valueToCode(t,"RATIO",e.Dart.ORDER_NONE)||.5,e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[e.Dart.provideFunction_("colour_blend",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String c1, String c2, num ratio) {","  ratio = Math.max(Math.min(ratio, 1), 0);","  int r1 = int.parse('0x${c1.substring(1, 3)}');","  int g1 = int.parse('0x${c1.substring(3, 5)}');","  int b1 = int.parse('0x${c1.substring(5, 7)}');","  int r2 = int.parse('0x${c2.substring(1, 3)}');","  int g2 = int.parse('0x${c2.substring(3, 5)}');","  int b2 = int.parse('0x${c2.substring(5, 7)}');","  num rn = (r1 * (1 - ratio) + r2 * ratio).round();","  String rs = rn.toInt().toRadixString(16);","  num gn = (g1 * (1 - ratio) + g2 * ratio).round();","  String gs = gn.toInt().toRadixString(16);","  num bn = (b1 * (1 - ratio) + b2 * ratio).round();","  String bs = bn.toInt().toRadixString(16);","  rs = '0$rs';","  rs = rs.substring(rs.length - 2);","  gs = '0$gs';","  gs = gs.substring(gs.length - 2);","  bs = '0$bs';","  bs = bs.substring(bs.length - 2);","  return '#$rs$gs$bs';","}"])+"("+o+", "+i+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists={},e.Dart.addReservedWords("Math"),e.Dart.lists_create_empty=function(t){return["[]",e.Dart.ORDER_ATOMIC]},e.Dart.lists_create_with=function(t){for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.Dart.valueToCode(t,"ADD"+i,e.Dart.ORDER_NONE)||"null";return["["+o.join(", ")+"]",e.Dart.ORDER_ATOMIC]},e.Dart.lists_repeat=function(t){var o=e.Dart.valueToCode(t,"ITEM",e.Dart.ORDER_NONE)||"null";return["new List.filled("+(e.Dart.valueToCode(t,"NUM",e.Dart.ORDER_NONE)||"0")+", "+o+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_length=function(t){return[(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"[]")+".length",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_isEmpty=function(t){return[(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"[]")+".isEmpty",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=e.Dart.valueToCode(t,"FIND",e.Dart.ORDER_NONE)||"''";return o=(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"[]")+"."+o+"("+i+")",t.workspace.options.oneBasedIndex?[o+" + 1",e.Dart.ORDER_ADDITIVE]:[o,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_getIndex=function(t){function o(){var t=e.Dart.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE),o="List "+t+" = "+r+";\n";return r=t,o}var i=t.getFieldValue("MODE")||"GET",n=t.getFieldValue("WHERE")||"FROM_START",r=e.Dart.valueToCode(t,"VALUE","RANDOM"==n||"FROM_END"==n?e.Dart.ORDER_NONE:e.Dart.ORDER_UNARY_POSTFIX)||"[]";if(("RANDOM"!=n||"REMOVE"!=i)&&"FROM_END"!=n||r.match(/^\w+$/))switch(n){case"FIRST":if("GET"==i)return[r+".first",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeAt(0)",e.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeAt(0);\n";break;case"LAST":if("GET"==i)return[r+".last",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeLast()",e.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeLast();\n";break;case"FROM_START":if(n=e.Dart.getAdjusted(t,"AT"),"GET"==i)return[r+"["+n+"]",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeAt("+n+")",e.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeAt("+n+");\n";break;case"FROM_END":if(n=e.Dart.getAdjusted(t,"AT",1,!1,e.Dart.ORDER_ADDITIVE),"GET"==i)return[r+"["+r+".length - "+n+"]",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i||"REMOVE"==i){if(t=r+".removeAt("+r+".length - "+n+")","GET_REMOVE"==i)return[t,e.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return t+";\n"}break;case"RANDOM":if(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;","REMOVE"==i)return"int "+(i=e.Dart.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE))+" = new Math.Random().nextInt("+r+".length);\n"+r+".removeAt("+i+");\n";if("GET"==i)return[(i=e.Dart.provideFunction_("lists_get_random_item",["dynamic "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list[x];","}"]))+"("+r+")",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[(i=e.Dart.provideFunction_("lists_remove_random_item",["dynamic "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list.removeAt(x);","}"]))+"("+r+")",e.Dart.ORDER_UNARY_POSTFIX]}else{if("RANDOM"==n)return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",(t=o())+"int "+(i=e.Dart.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE))+" = new Math.Random().nextInt("+r+".length);\n"+r+".removeAt("+i+");\n";if("REMOVE"==i)return n=e.Dart.getAdjusted(t,"AT",1,!1,e.Dart.ORDER_ADDITIVE),(t=o())+(r+".removeAt(")+r+".length - "+n+");\n";if("GET"==i)return n=e.Dart.getAdjusted(t,"AT",1),[(i=e.Dart.provideFunction_("lists_get_from_end",["dynamic "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list[x];","}"]))+"("+r+", "+n+")",e.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return n=e.Dart.getAdjusted(t,"AT",1),[(i=e.Dart.provideFunction_("lists_remove_from_end",["dynamic "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list.removeAt(x);","}"]))+"("+r+", "+n+")",e.Dart.ORDER_UNARY_POSTFIX]}throw"Unhandled combination (lists_getIndex)."},e.Dart.lists_setIndex=function(t){function o(){if(r.match(/^\w+$/))return"";var t=e.Dart.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE),o="List "+t+" = "+r+";\n";return r=t,o}var i=t.getFieldValue("MODE")||"GET",n=t.getFieldValue("WHERE")||"FROM_START",r=e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_UNARY_POSTFIX)||"[]",s=e.Dart.valueToCode(t,"TO",e.Dart.ORDER_ASSIGNMENT)||"null";switch(n){case"FIRST":if("SET"==i)return r+"[0] = "+s+";\n";if("INSERT"==i)return r+".insert(0, "+s+");\n";break;case"LAST":if("SET"==i)return(t=o())+(r+"[")+r+".length - 1] = "+s+";\n";if("INSERT"==i)return r+".add("+s+");\n";break;case"FROM_START":if(n=e.Dart.getAdjusted(t,"AT"),"SET"==i)return r+"["+n+"] = "+s+";\n";if("INSERT"==i)return r+".insert("+n+", "+s+");\n";break;case"FROM_END":if(n=e.Dart.getAdjusted(t,"AT",1,!1,e.Dart.ORDER_ADDITIVE),t=o(),"SET"==i)return t+(r+"[")+r+".length - "+n+"] = "+s+";\n";if("INSERT"==i)return t+(r+".insert(")+r+".length - "+n+", "+s+");\n";break;case"RANDOM":if(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",t=o(),t+="int "+(n=e.Dart.variableDB_.getDistinctName("tmp_x",e.Variables.NAME_TYPE))+" = new Math.Random().nextInt("+r+".length);\n","SET"==i)return t+(r+"[")+n+"] = "+s+";\n";if("INSERT"==i)return t+(r+".insert(")+n+", "+s+");\n"}throw"Unhandled combination (lists_setIndex)."},e.Dart.lists_getSublist=function(t){var o=e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_UNARY_POSTFIX)||"[]",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if(o.match(/^\w+$/)||"FROM_END"!=i&&"FROM_START"==n){switch(i){case"FROM_START":var r=e.Dart.getAdjusted(t,"AT1");break;case"FROM_END":r=o+".length - "+(r=e.Dart.getAdjusted(t,"AT1",1,!1,e.Dart.ORDER_ADDITIVE));break;case"FIRST":r="0";break;default:throw"Unhandled option (lists_getSublist)."}switch(n){case"FROM_START":var s=e.Dart.getAdjusted(t,"AT2",1);break;case"FROM_END":s=o+".length - "+(s=e.Dart.getAdjusted(t,"AT2",0,!1,e.Dart.ORDER_ADDITIVE));break;case"LAST":break;default:throw"Unhandled option (lists_getSublist)."}t="LAST"==n?o+".sublist("+r+")":o+".sublist("+r+", "+s+")"}else r=e.Dart.getAdjusted(t,"AT1"),s=e.Dart.getAdjusted(t,"AT2"),t=e.Dart.provideFunction_("lists_get_sublist",["List "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(list, where1, at1, where2, at2) {","  int getAt(where, at) {","    if (where == 'FROM_END') {","      at = list.length - 1 - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = list.length - 1;","    } else if (where != 'FROM_START') {","      throw 'Unhandled option (lists_getSublist).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return list.sublist(at1, at2);","}"])+"("+o+", '"+i+"', "+r+", '"+n+"', "+s+")";return[t,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_sort=function(t){var o=e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_NONE)||"[]",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e.Dart.provideFunction_("lists_sort",["List "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(list, type, direction) {","  var compareFuncs = {",'    "NUMERIC": (a, b) => direction * a.compareTo(b),','    "TEXT": (a, b) => direction * a.toString().compareTo(b.toString()),','    "IGNORE_CASE": ',"       (a, b) => direction * ","      a.toString().toLowerCase().compareTo(b.toString().toLowerCase())","  };","  list = new List.from(list);","  var compare = compareFuncs[type];","  list.sort(compare);","  return list;","}"])+"("+o+', "'+t+'", '+i+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_split=function(t){var o=e.Dart.valueToCode(t,"INPUT",e.Dart.ORDER_UNARY_POSTFIX),i=e.Dart.valueToCode(t,"DELIM",e.Dart.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))o||(o="''"),t="split";else{if("JOIN"!=t)throw"Unknown mode: "+t;o||(o="[]"),t="join"}return[o+"."+t+"("+i+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.lists_reverse=function(t){return["new List.from("+(e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_NONE)||"[]")+".reversed)",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.logic={},e.Dart.controls_if=function(t){var o=0,i="";do{var n=e.Dart.valueToCode(t,"IF"+o,e.Dart.ORDER_NONE)||"false",r=e.Dart.statementToCode(t,"DO"+o);i+=(0<o?"else ":"")+"if ("+n+") {\n"+r+"}",++o}while(t.getInput("IF"+o));return t.getInput("ELSE")&&(i+=" else {\n"+(r=e.Dart.statementToCode(t,"ELSE"))+"}"),i+"\n"},e.Dart.controls_ifelse=e.Dart.controls_if,e.Dart.logic_compare=function(t){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==o||"!="==o?e.Dart.ORDER_EQUALITY:e.Dart.ORDER_RELATIONAL;return[(e.Dart.valueToCode(t,"A",i)||"0")+" "+o+" "+(t=e.Dart.valueToCode(t,"B",i)||"0"),i]},e.Dart.logic_operation=function(t){var o="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==o?e.Dart.ORDER_LOGICAL_AND:e.Dart.ORDER_LOGICAL_OR,n=e.Dart.valueToCode(t,"A",i);if(t=e.Dart.valueToCode(t,"B",i),n||t){var r="&&"==o?"true":"false";n||(n=r),t||(t=r)}else t=n="false";return[n+" "+o+" "+t,i]},e.Dart.logic_negate=function(t){var o=e.Dart.ORDER_UNARY_PREFIX;return["!"+(e.Dart.valueToCode(t,"BOOL",o)||"true"),o]},e.Dart.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",e.Dart.ORDER_ATOMIC]},e.Dart.logic_null=function(t){return["null",e.Dart.ORDER_ATOMIC]},e.Dart.logic_ternary=function(t){return[(e.Dart.valueToCode(t,"IF",e.Dart.ORDER_CONDITIONAL)||"false")+" ? "+(e.Dart.valueToCode(t,"THEN",e.Dart.ORDER_CONDITIONAL)||"null")+" : "+(t=e.Dart.valueToCode(t,"ELSE",e.Dart.ORDER_CONDITIONAL)||"null"),e.Dart.ORDER_CONDITIONAL]},e.Dart.loops={},e.Dart.controls_repeat_ext=function(t){var o=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):e.Dart.valueToCode(t,"TIMES",e.Dart.ORDER_ASSIGNMENT)||"0",i=e.Dart.statementToCode(t,"DO");i=e.Dart.addLoopTrap(i,t.id),t="";var n=e.Dart.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE),r=o;return o.match(/^\w+$/)||e.isNumber(o)||(t+="var "+(r=e.Dart.variableDB_.getDistinctName("repeat_end",e.Variables.NAME_TYPE))+" = "+o+";\n"),t+"for (int "+n+" = 0; "+n+" < "+r+"; "+n+"++) {\n"+i+"}\n"},e.Dart.controls_repeat=e.Dart.controls_repeat_ext,e.Dart.controls_whileUntil=function(t){var o="UNTIL"==t.getFieldValue("MODE"),i=e.Dart.valueToCode(t,"BOOL",o?e.Dart.ORDER_UNARY_PREFIX:e.Dart.ORDER_NONE)||"false",n=e.Dart.statementToCode(t,"DO");return n=e.Dart.addLoopTrap(n,t.id),o&&(i="!"+i),"while ("+i+") {\n"+n+"}\n"},e.Dart.controls_for=function(t){var o=e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Dart.valueToCode(t,"FROM",e.Dart.ORDER_ASSIGNMENT)||"0",n=e.Dart.valueToCode(t,"TO",e.Dart.ORDER_ASSIGNMENT)||"0",r=e.Dart.valueToCode(t,"BY",e.Dart.ORDER_ASSIGNMENT)||"1",s=e.Dart.statementToCode(t,"DO");if(s=e.Dart.addLoopTrap(s,t.id),e.isNumber(i)&&e.isNumber(n)&&e.isNumber(r)){var a=parseFloat(i)<=parseFloat(n);t="for ("+o+" = "+i+"; "+o+(a?" <= ":" >= ")+n+"; "+o,t=(1==(o=Math.abs(parseFloat(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+o)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||e.isNumber(i)||(t+="var "+(a=e.Dart.variableDB_.getDistinctName(o+"_start",e.Variables.NAME_TYPE))+" = "+i+";\n"),i=n,n.match(/^\w+$/)||e.isNumber(n)||(t+="var "+(i=e.Dart.variableDB_.getDistinctName(o+"_end",e.Variables.NAME_TYPE))+" = "+n+";\n"),t+="num "+(n=e.Dart.variableDB_.getDistinctName(o+"_inc",e.Variables.NAME_TYPE))+" = ",t=(t=e.isNumber(r)?t+(Math.abs(r)+";\n"):t+"("+r+").abs();\n")+"if ("+a+" > "+i+") {\n"+(e.Dart.INDENT+n)+" = -"+n+";\n",t+="}\n",t+="for ("+o+" = "+a+"; "+n+" >= 0 ? "+o+" <= "+i+" : "+o+" >= "+i+"; "+o+" += "+n+") {\n"+s+"}\n";return t},e.Dart.controls_forEach=function(t){var o=e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_ASSIGNMENT)||"[]",n=e.Dart.statementToCode(t,"DO");return"for (var "+o+" in "+i+") {\n"+(n=e.Dart.addLoopTrap(n,t.id))+"}\n"},e.Dart.controls_flow_statements=function(e){switch(e.getFieldValue("FLOW")){case"BREAK":return"break;\n";case"CONTINUE":return"continue;\n"}throw"Unknown flow statement."},e.Dart.math={},e.Dart.addReservedWords("Math"),e.Dart.math_number=function(t){if(1/0==(t=parseFloat(t.getFieldValue("NUM")))){t="double.INFINITY";var o=e.Dart.ORDER_UNARY_POSTFIX}else-1/0==t?(t="-double.INFINITY",o=e.Dart.ORDER_UNARY_PREFIX):o=0>t?e.Dart.ORDER_UNARY_PREFIX:e.Dart.ORDER_ATOMIC;return[t,o]},e.Dart.math_arithmetic=function(t){var o={ADD:[" + ",e.Dart.ORDER_ADDITIVE],MINUS:[" - ",e.Dart.ORDER_ADDITIVE],MULTIPLY:[" * ",e.Dart.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",e.Dart.ORDER_MULTIPLICATIVE],POWER:[null,e.Dart.ORDER_NONE]}[t.getFieldValue("OP")],i=o[0];o=o[1];var n=e.Dart.valueToCode(t,"A",o)||"0";return t=e.Dart.valueToCode(t,"B",o)||"0",i?[n+i+t,o]:(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["Math.pow("+n+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX])},e.Dart.math_single=function(t){var o=t.getFieldValue("OP");if("NEG"==o)return"-"==(t=e.Dart.valueToCode(t,"NUM",e.Dart.ORDER_UNARY_PREFIX)||"0")[0]&&(t=" "+t),["-"+t,e.Dart.ORDER_UNARY_PREFIX];switch(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",t="ABS"==o||"ROUND"==o.substring(0,5)?e.Dart.valueToCode(t,"NUM",e.Dart.ORDER_UNARY_POSTFIX)||"0":"SIN"==o||"COS"==o||"TAN"==o?e.Dart.valueToCode(t,"NUM",e.Dart.ORDER_MULTIPLICATIVE)||"0":e.Dart.valueToCode(t,"NUM",e.Dart.ORDER_NONE)||"0",o){case"ABS":var i=t+".abs()";break;case"ROOT":i="Math.sqrt("+t+")";break;case"LN":i="Math.log("+t+")";break;case"EXP":i="Math.exp("+t+")";break;case"POW10":i="Math.pow(10,"+t+")";break;case"ROUND":i=t+".round()";break;case"ROUNDUP":i=t+".ceil()";break;case"ROUNDDOWN":i=t+".floor()";break;case"SIN":i="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":i="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":i="Math.tan("+t+" / 180 * Math.PI)"}if(i)return[i,e.Dart.ORDER_UNARY_POSTFIX];switch(o){case"LOG10":i="Math.log("+t+") / Math.log(10)";break;case"ASIN":i="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":i="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":i="Math.atan("+t+") / Math.PI * 180";break;default:throw"Unknown math operator: "+o}return[i,e.Dart.ORDER_MULTIPLICATIVE]},e.Dart.math_constant=function(t){var o={PI:["Math.PI",e.Dart.ORDER_UNARY_POSTFIX],E:["Math.E",e.Dart.ORDER_UNARY_POSTFIX],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",e.Dart.ORDER_MULTIPLICATIVE],SQRT2:["Math.SQRT2",e.Dart.ORDER_UNARY_POSTFIX],SQRT1_2:["Math.SQRT1_2",e.Dart.ORDER_UNARY_POSTFIX],INFINITY:["double.INFINITY",e.Dart.ORDER_ATOMIC]};return"INFINITY"!=(t=t.getFieldValue("CONSTANT"))&&(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;"),o[t]},e.Dart.math_number_property=function(t){var o=e.Dart.valueToCode(t,"NUMBER_TO_CHECK",e.Dart.ORDER_MULTIPLICATIVE);if(!o)return["false",e.Python.ORDER_ATOMIC];var i=t.getFieldValue("PROPERTY");if("PRIME"==i)return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[e.Dart.provideFunction_("math_isPrime",["bool "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is null, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (n == null || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",e.Dart.ORDER_UNARY_POSTFIX];switch(i){case"EVEN":var n=o+" % 2 == 0";break;case"ODD":n=o+" % 2 == 1";break;case"WHOLE":n=o+" % 1 == 0";break;case"POSITIVE":n=o+" > 0";break;case"NEGATIVE":n=o+" < 0";break;case"DIVISIBLE_BY":if(!(t=e.Dart.valueToCode(t,"DIVISOR",e.Dart.ORDER_MULTIPLICATIVE)))return["false",e.Python.ORDER_ATOMIC];n=o+" % "+t+" == 0"}return[n,e.Dart.ORDER_EQUALITY]},e.Dart.math_change=function(t){var o=e.Dart.valueToCode(t,"DELTA",e.Dart.ORDER_ADDITIVE)||"0";return(t=e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE))+" = ("+t+" is num ? "+t+" : 0) + "+o+";\n"},e.Dart.math_round=e.Dart.math_single,e.Dart.math_trig=e.Dart.math_single,e.Dart.math_on_list=function(t){var o=t.getFieldValue("OP");switch(t=e.Dart.valueToCode(t,"LIST",e.Dart.ORDER_NONE)||"[]",o){case"SUM":o=(o=e.Dart.provideFunction_("math_sum",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  num sumVal = 0;","  myList.forEach((num entry) {sumVal += entry;});","  return sumVal;","}"]))+"("+t+")";break;case"MIN":e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o=(o=e.Dart.provideFunction_("math_min",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  if (myList.isEmpty) return null;","  num minVal = myList[0];","  myList.forEach((num entry) {minVal = Math.min(minVal, entry);});","  return minVal;","}"]))+"("+t+")";break;case"MAX":e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o=(o=e.Dart.provideFunction_("math_max",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  if (myList.isEmpty) return null;","  num maxVal = myList[0];","  myList.forEach((num entry) {maxVal = Math.max(maxVal, entry);});","  return maxVal;","}"]))+"("+t+")";break;case"AVERAGE":o=(o=e.Dart.provideFunction_("math_mean",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only.","  List localList = new List.from(myList);","  localList.removeWhere((a) => a is! num);","  if (localList.isEmpty) return null;","  num sumVal = 0;","  localList.forEach((num entry) {sumVal += entry;});","  return sumVal / localList.length;","}"]))+"("+t+")";break;case"MEDIAN":o=(o=e.Dart.provideFunction_("math_median",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only, then sort, then return middle value","  // or the average of two middle values if list has an even number of elements.","  List localList = new List.from(myList);","  localList.removeWhere((a) => a is! num);","  if (localList.isEmpty) return null;","  localList.sort((a, b) => (a - b));","  int index = localList.length ~/ 2;","  if (localList.length % 2 == 1) {","    return localList[index];","  } else {","    return (localList[index - 1] + localList[index]) / 2;","  }","}"]))+"("+t+")";break;case"MODE":e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o=(o=e.Dart.provideFunction_("math_modes",["List "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List values) {","  List modes = [];","  List counts = [];","  int maxCount = 0;","  for (int i = 0; i < values.length; i++) {","    var value = values[i];","    bool found = false;","    int thisCount;","    for (int j = 0; j < counts.length; j++) {","      if (counts[j][0] == value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.add([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (int j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.add(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+t+")";break;case"STD_DEV":e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o=(o=e.Dart.provideFunction_("math_standard_deviation",["num "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only.","  List numbers = new List.from(myList);","  numbers.removeWhere((a) => a is! num);","  if (numbers.isEmpty) return null;","  num n = numbers.length;","  num sum = 0;","  numbers.forEach((x) => sum += x);","  num mean = sum / n;","  num sumSquare = 0;","  numbers.forEach((x) => sumSquare += Math.pow(x - mean, 2));","  return Math.sqrt(sumSquare / n);","}"]))+"("+t+")";break;case"RANDOM":e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o=(o=e.Dart.provideFunction_("math_random_item",["dynamic "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  int x = new Math.Random().nextInt(myList.length);","  return myList[x];","}"]))+"("+t+")";break;default:throw"Unknown operator: "+o}return[o,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.math_modulo=function(t){return[(e.Dart.valueToCode(t,"DIVIDEND",e.Dart.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=e.Dart.valueToCode(t,"DIVISOR",e.Dart.ORDER_MULTIPLICATIVE)||"0"),e.Dart.ORDER_MULTIPLICATIVE]},e.Dart.math_constrain=function(t){return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["Math.min(Math.max("+(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_NONE)||"0")+", "+(e.Dart.valueToCode(t,"LOW",e.Dart.ORDER_NONE)||"0")+"), "+(t=e.Dart.valueToCode(t,"HIGH",e.Dart.ORDER_NONE)||"double.INFINITY")+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.math_random_int=function(t){e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;";var o=e.Dart.valueToCode(t,"FROM",e.Dart.ORDER_NONE)||"0";return t=e.Dart.valueToCode(t,"TO",e.Dart.ORDER_NONE)||"0",[e.Dart.provideFunction_("math_random_int",["int "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(num a, num b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    num c = a;","    a = b;","    b = c;","  }","  return new Math.Random().nextInt(b - a + 1) + a;","}"])+"("+o+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.math_random_float=function(t){return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["new Math.Random().nextDouble()",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.procedures={},e.Dart.procedures_defreturn=function(t){var o=e.Dart.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=e.Dart.statementToCode(t,"STACK");if(e.Dart.STATEMENT_PREFIX){var n=t.id.replace(/\$/g,"$$$$");i=e.Dart.prefixLines(e.Dart.STATEMENT_PREFIX.replace(/%1/g,"'"+n+"'"),e.Dart.INDENT)+i}e.Dart.INFINITE_LOOP_TRAP&&(i=e.Dart.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t.id+"'")+i),(n=e.Dart.valueToCode(t,"RETURN",e.Dart.ORDER_NONE)||"")&&(n=e.Dart.INDENT+"return "+n+";\n");for(var r=n?"dynamic":"void",s=[],a=0;a<t.arguments_.length;a++)s[a]=e.Dart.variableDB_.getName(t.arguments_[a],e.Variables.NAME_TYPE);return i=r+" "+o+"("+s.join(", ")+") {\n"+i+n+"}",i=e.Dart.scrub_(t,i),e.Dart.definitions_["%"+o]=i,null},e.Dart.procedures_defnoreturn=e.Dart.procedures_defreturn,e.Dart.procedures_callreturn=function(t){for(var o=e.Dart.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Dart.valueToCode(t,"ARG"+n,e.Dart.ORDER_NONE)||"null";return[o+"("+i.join(", ")+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.procedures_callnoreturn=function(t){for(var o=e.Dart.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Dart.valueToCode(t,"ARG"+n,e.Dart.ORDER_NONE)||"null";return o+"("+i.join(", ")+");\n"},e.Dart.procedures_ifreturn=function(t){var o="if ("+(e.Dart.valueToCode(t,"CONDITION",e.Dart.ORDER_NONE)||"false")+") {\n";return t.hasReturnValue_?(t=e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_NONE)||"null",o+=e.Dart.INDENT+"return "+t+";\n"):o+=e.Dart.INDENT+"return;\n",o+"}\n"},e.Dart.texts={},e.Dart.addReservedWords("Html,Math"),e.Dart.text=function(t){return[e.Dart.quote_(t.getFieldValue("TEXT")),e.Dart.ORDER_ATOMIC]},e.Dart.text_join=function(t){switch(t.itemCount_){case 0:return["''",e.Dart.ORDER_ATOMIC];case 1:return[(e.Dart.valueToCode(t,"ADD0",e.Dart.ORDER_UNARY_POSTFIX)||"''")+".toString()",e.Dart.ORDER_UNARY_POSTFIX];default:for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.Dart.valueToCode(t,"ADD"+i,e.Dart.ORDER_NONE)||"''";return[t="["+o.join(",")+"].join()",e.Dart.ORDER_UNARY_POSTFIX]}},e.Dart.text_append=function(t){var o=e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE);return o+" = ["+o+", "+(t=e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_NONE)||"''")+"].join();\n"},e.Dart.text_length=function(t){return[(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"''")+".length",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_isEmpty=function(t){return[(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"''")+".isEmpty",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=e.Dart.valueToCode(t,"FIND",e.Dart.ORDER_NONE)||"''";return o=(e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"''")+"."+o+"("+i+")",t.workspace.options.oneBasedIndex?[o+" + 1",e.Dart.ORDER_ADDITIVE]:[o,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_charAt=function(t){var o=t.getFieldValue("WHERE")||"FROM_START",i=e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_UNARY_POSTFIX)||"''";switch(o){case"FIRST":return[i+"[0]",e.Dart.ORDER_UNARY_POSTFIX];case"FROM_START":return[i+"["+(t=e.Dart.getAdjusted(t,"AT"))+"]",e.Dart.ORDER_UNARY_POSTFIX];case"LAST":case"FROM_END":return t=e.Dart.getAdjusted(t,"AT",1),[(o=e.Dart.provideFunction_("text_get_from_end",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String text, num x) {","  return text[text.length - x];","}"]))+"("+i+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX];case"RANDOM":return e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[(o=e.Dart.provideFunction_("text_random_letter",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String text) {","  int x = new Math.Random().nextInt(text.length);","  return text[x];","}"]))+"("+i+")",e.Dart.ORDER_UNARY_POSTFIX]}throw"Unhandled option (text_charAt)."},e.Dart.text_getSubstring=function(t){var o=e.Dart.valueToCode(t,"STRING",e.Dart.ORDER_UNARY_POSTFIX)||"''",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"==i&&"LAST"==n)t=o;else if(o.match(/^'?\w+'?$/)||"FROM_END"!=i&&"FROM_START"==n){switch(i){case"FROM_START":var r=e.Dart.getAdjusted(t,"AT1");break;case"FROM_END":r=o+".length - "+(r=e.Dart.getAdjusted(t,"AT1",1,!1,e.Dart.ORDER_ADDITIVE));break;case"FIRST":r="0";break;default:throw"Unhandled option (text_getSubstring)."}switch(n){case"FROM_START":var s=e.Dart.getAdjusted(t,"AT2",1);break;case"FROM_END":s=o+".length - "+(s=e.Dart.getAdjusted(t,"AT2",0,!1,e.Dart.ORDER_ADDITIVE));break;case"LAST":break;default:throw"Unhandled option (text_getSubstring)."}t="LAST"==n?o+".substring("+r+")":o+".substring("+r+", "+s+")"}else r=e.Dart.getAdjusted(t,"AT1"),s=e.Dart.getAdjusted(t,"AT2"),t=e.Dart.provideFunction_("text_get_substring",["List "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(text, where1, at1, where2, at2) {","  int getAt(where, at) {","    if (where == 'FROM_END') {","      at = text.length - 1 - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = text.length - 1;","    } else if (where != 'FROM_START') {","      throw 'Unhandled option (text_getSubstring).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return text.substring(at1, at2);","}"])+"("+o+", '"+i+"', "+r+", '"+n+"', "+s+")";return[t,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_changeCase=function(t){var o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=e.Dart.valueToCode(t,"TEXT",o?e.Dart.ORDER_UNARY_POSTFIX:e.Dart.ORDER_NONE)||"''",[o?t+o:e.Dart.provideFunction_("text_toTitleCase",["String "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String str) {","  RegExp exp = new RegExp(r'\\b');","  List<String> list = str.split(exp);","  final title = new StringBuffer();","  for (String part in list) {","    if (part.length > 0) {","      title.write(part[0].toUpperCase());","      if (part.length > 0) {","        title.write(part.substring(1).toLowerCase());","      }","    }","  }","  return title.toString();","}"])+"("+t+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_trim=function(t){var o={LEFT:".replaceFirst(new RegExp(r'^\\s+'), '')",RIGHT:".replaceFirst(new RegExp(r'\\s+$'), '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_UNARY_POSTFIX)||"''")+o,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_print=function(t){return"print("+(e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_NONE)||"''")+");\n"},e.Dart.text_prompt_ext=function(t){e.Dart.definitions_.import_dart_html="import 'dart:html' as Html;";var o="Html.prompt("+(t.getField("TEXT")?e.Dart.quote_(t.getFieldValue("TEXT")):e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_NONE)||"''")+", '')";return"NUMBER"==t.getFieldValue("TYPE")&&(e.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",o="Math.parseDouble("+o+")"),[o,e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_prompt=e.Dart.text_prompt_ext,e.Dart.text_count=function(t){var o=e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_UNARY_POSTFIX)||"''";return t=e.Dart.valueToCode(t,"SUB",e.Dart.ORDER_NONE)||"''",[e.Dart.provideFunction_("text_count",["int "+e.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String haystack, String needle) {","  if (needle.length == 0) {","    return haystack.length + 1;","  }","  int index = 0;","  int count = 0;","  while (index != -1) {","    index = haystack.indexOf(needle, index);","    if (index != -1) {","      count++;","     index += needle.length;","    }","  }","  return count;","}"])+"("+o+", "+t+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_replace=function(t){return[(e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_UNARY_POSTFIX)||"''")+".replaceAll("+(e.Dart.valueToCode(t,"FROM",e.Dart.ORDER_NONE)||"''")+", "+(t=e.Dart.valueToCode(t,"TO",e.Dart.ORDER_NONE)||"''")+")",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.text_reverse=function(t){return["new String.fromCharCodes("+(e.Dart.valueToCode(t,"TEXT",e.Dart.ORDER_UNARY_POSTFIX)||"''")+".runes.toList().reversed)",e.Dart.ORDER_UNARY_POSTFIX]},e.Dart.variables={},e.Dart.variables_get=function(t){return[e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.Dart.ORDER_ATOMIC]},e.Dart.variables_set=function(t){var o=e.Dart.valueToCode(t,"VALUE",e.Dart.ORDER_ASSIGNMENT)||"0";return e.Dart.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+o+";\n"},e.Dart.variablesDynamic={},e.Dart.variables_get_dynamic=e.Dart.variables_get,e.Dart.variables_set_dynamic=e.Dart.variables_set,e.Dart}},function(e,t){e.exports=function(e){"use strict";return e.Lua=new e.Generator("Lua"),e.Lua.addReservedWords("_,__inext,assert,bit,colors,colours,coroutine,disk,dofile,error,fs,fetfenv,getmetatable,gps,help,io,ipairs,keys,loadfile,loadstring,math,native,next,os,paintutils,pairs,parallel,pcall,peripheral,print,printError,rawequal,rawget,rawset,read,rednet,redstone,rs,select,setfenv,setmetatable,sleep,string,table,term,textutils,tonumber,tostring,turtle,type,unpack,vector,write,xpcall,_VERSION,__indext,HTTP,and,break,do,else,elseif,end,false,for,function,if,in,local,nil,not,or,repeat,return,then,true,until,while,add,sub,mul,div,mod,pow,unm,concat,len,eq,lt,le,index,newindex,call,assert,collectgarbage,dofile,error,_G,getmetatable,inpairs,load,loadfile,next,pairs,pcall,print,rawequal,rawget,rawlen,rawset,select,setmetatable,tonumber,tostring,type,_VERSION,xpcall,require,package,string,table,math,bit32,io,file,os,debug"),e.Lua.ORDER_ATOMIC=0,e.Lua.ORDER_HIGH=1,e.Lua.ORDER_EXPONENTIATION=2,e.Lua.ORDER_UNARY=3,e.Lua.ORDER_MULTIPLICATIVE=4,e.Lua.ORDER_ADDITIVE=5,e.Lua.ORDER_CONCATENATION=6,e.Lua.ORDER_RELATIONAL=7,e.Lua.ORDER_AND=8,e.Lua.ORDER_OR=9,e.Lua.ORDER_NONE=99,e.Lua.init=function(t){e.Lua.definitions_=Object.create(null),e.Lua.functionNames_=Object.create(null),e.Lua.variableDB_?e.Lua.variableDB_.reset():e.Lua.variableDB_=new e.Names(e.Lua.RESERVED_WORDS_),e.Lua.variableDB_.setVariableMap(t.getVariableMap())},e.Lua.finish=function(t){var o,i=[];for(o in e.Lua.definitions_)i.push(e.Lua.definitions_[o]);return delete e.Lua.definitions_,delete e.Lua.functionNames_,e.Lua.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},e.Lua.scrubNakedValue=function(e){return"local _ = "+e+"\n"},e.Lua.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},e.Lua.scrub_=function(t,o){var i="";if(!t.outputConnection||!t.outputConnection.targetConnection){var n=t.getCommentText();(n=e.utils.wrap(n,e.Lua.COMMENT_WRAP-3))&&(i+=e.Lua.prefixLines(n,"-- ")+"\n");for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==e.INPUT_VALUE&&(n=t.inputList[r].connection.targetBlock())&&(n=e.Lua.allNestedComments(n))&&(i+=e.Lua.prefixLines(n,"-- "))}return r=t.nextConnection&&t.nextConnection.targetBlock(),i+o+(r=e.Lua.blockToCode(r))},e.Lua.colour={},e.Lua.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.Lua.ORDER_ATOMIC]},e.Lua.colour_random=function(t){return['string.format("#%06x", math.random(0, 2^24 - 1))',e.Lua.ORDER_HIGH]},e.Lua.colour_rgb=function(t){return[e.Lua.provideFunction_("colour_rgb",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b)","  r = math.floor(math.min(100, math.max(0, r)) * 2.55 + .5)","  g = math.floor(math.min(100, math.max(0, g)) * 2.55 + .5)","  b = math.floor(math.min(100, math.max(0, b)) * 2.55 + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"])+"("+(e.Lua.valueToCode(t,"RED",e.Lua.ORDER_NONE)||0)+", "+(e.Lua.valueToCode(t,"GREEN",e.Lua.ORDER_NONE)||0)+", "+(t=e.Lua.valueToCode(t,"BLUE",e.Lua.ORDER_NONE)||0)+")",e.Lua.ORDER_HIGH]},e.Lua.colour_blend=function(t){return[e.Lua.provideFunction_("colour_blend",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(colour1, colour2, ratio)","  local r1 = tonumber(string.sub(colour1, 2, 3), 16)","  local r2 = tonumber(string.sub(colour2, 2, 3), 16)","  local g1 = tonumber(string.sub(colour1, 4, 5), 16)","  local g2 = tonumber(string.sub(colour2, 4, 5), 16)","  local b1 = tonumber(string.sub(colour1, 6, 7), 16)","  local b2 = tonumber(string.sub(colour2, 6, 7), 16)","  local ratio = math.min(1, math.max(0, ratio))","  local r = math.floor(r1 * (1 - ratio) + r2 * ratio + .5)","  local g = math.floor(g1 * (1 - ratio) + g2 * ratio + .5)","  local b = math.floor(b1 * (1 - ratio) + b2 * ratio + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"])+"("+(e.Lua.valueToCode(t,"COLOUR1",e.Lua.ORDER_NONE)||"'#000000'")+", "+(e.Lua.valueToCode(t,"COLOUR2",e.Lua.ORDER_NONE)||"'#000000'")+", "+(t=e.Lua.valueToCode(t,"RATIO",e.Lua.ORDER_NONE)||0)+")",e.Lua.ORDER_HIGH]},e.Lua.lists={},e.Lua.lists_create_empty=function(t){return["{}",e.Lua.ORDER_ATOMIC]},e.Lua.lists_create_with=function(t){for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.Lua.valueToCode(t,"ADD"+i,e.Lua.ORDER_NONE)||"None";return["{"+o.join(", ")+"}",e.Lua.ORDER_ATOMIC]},e.Lua.lists_repeat=function(t){return[e.Lua.provideFunction_("create_list_repeated",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(item, count)","  local t = {}","  for i = 1, count do","    table.insert(t, item)","  end","  return t","end"])+"("+(e.Lua.valueToCode(t,"ITEM",e.Lua.ORDER_NONE)||"None")+", "+(t=e.Lua.valueToCode(t,"NUM",e.Lua.ORDER_NONE)||"0")+")",e.Lua.ORDER_HIGH]},e.Lua.lists_length=function(t){return["#"+(e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_UNARY)||"{}"),e.Lua.ORDER_UNARY]},e.Lua.lists_isEmpty=function(t){return["#"+(e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_UNARY)||"{}")+" == 0",e.Lua.ORDER_RELATIONAL]},e.Lua.lists_indexOf=function(t){var o=e.Lua.valueToCode(t,"FIND",e.Lua.ORDER_NONE)||"''",i=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"{}";return[("FIRST"==t.getFieldValue("END")?e.Lua.provideFunction_("first_index",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for k, v in ipairs(t) do","    if v == elem then","      return k","    end","  end","  return 0","end"]):e.Lua.provideFunction_("last_index",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for i = #t, 1, -1 do","    if t[i] == elem then","      return i","    end","  end","  return 0","end"]))+"("+i+", "+o+")",e.Lua.ORDER_HIGH]},e.Lua.lists.getIndex_=function(e,t,o){return"FIRST"==t?"1":"FROM_END"==t?"#"+e+" + 1 - "+o:"LAST"==t?"#"+e:"RANDOM"==t?"math.random(#"+e+")":o},e.Lua.lists_getIndex=function(t){var o=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",n=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_HIGH)||"{}",r=e.Lua.lists.getIndex_;if("LAST"!=i&&"FROM_END"!=i&&"RANDOM"!=i||n.match(/^\w+$/))return s="GET"==o&&"FROM_END"==i?e.Lua.ORDER_ADDITIVE:e.Lua.ORDER_NONE,t=r(n,i,t=e.Lua.valueToCode(t,"AT",s)||"1"),"GET"==o?[n+"["+t+"]",e.Lua.ORDER_HIGH]:(i="table.remove("+n+", "+t+")","GET_REMOVE"==o?[i,e.Lua.ORDER_HIGH]:i+"\n");if("REMOVE"==o){var s="FROM_END"==i?e.Lua.ORDER_ADDITIVE:e.Lua.ORDER_NONE;return t=e.Lua.valueToCode(t,"AT",s)||"1",(o=e.Lua.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE))+" = "+n+"\ntable.remove("+o+", "+(t=r(o,i,t))+")\n"}return t=e.Lua.valueToCode(t,"AT",e.Lua.ORDER_NONE)||"1",[("GET"==o?e.Lua.provideFunction_("list_get_"+i.toLowerCase(),["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==i||"FROM_START"==i?", at)":")"),"  return t["+r("t",i,"at")+"]","end"]):e.Lua.provideFunction_("list_remove_"+i.toLowerCase(),["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==i||"FROM_START"==i?", at)":")"),"  return table.remove(t, "+r("t",i,"at")+")","end"]))+"("+n+("FROM_END"==i||"FROM_START"==i?", "+t:"")+")",e.Lua.ORDER_HIGH]},e.Lua.lists_setIndex=function(t){var o=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_HIGH)||"{}",i=t.getFieldValue("MODE")||"SET",n=t.getFieldValue("WHERE")||"FROM_START",r=e.Lua.valueToCode(t,"AT",e.Lua.ORDER_ADDITIVE)||"1";t=e.Lua.valueToCode(t,"TO",e.Lua.ORDER_NONE)||"None";var s=e.Lua.lists.getIndex_,a="";if(("LAST"==n||"FROM_END"==n||"RANDOM"==n)&&!o.match(/^\w+$/)){var l=e.Lua.variableDB_.getDistinctName("tmp_list",e.Variables.NAME_TYPE);a=l+" = "+o+"\n",o=l}return(a="SET"==i?a+(o+"[")+s(o,n,r)+"] = "+t:a+"table.insert("+o+", "+s(o,n,r)+("LAST"==n?" + 1":"")+", "+t+")")+"\n"},e.Lua.lists_getSublist=function(t){var o=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_NONE)||"{}",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2"),r=e.Lua.valueToCode(t,"AT1",e.Lua.ORDER_NONE)||"1";t=e.Lua.valueToCode(t,"AT2",e.Lua.ORDER_NONE)||"1";var s=e.Lua.lists.getIndex_;return[e.Lua.provideFunction_("list_sublist_"+i.toLowerCase()+"_"+n.toLowerCase(),["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(source"+("FROM_END"==i||"FROM_START"==i?", at1":"")+("FROM_END"==n||"FROM_START"==n?", at2":"")+")","  local t = {}","  local start = "+s("source",i,"at1"),"  local finish = "+s("source",n,"at2"),"  for i = start, finish do","    table.insert(t, source[i])","  end","  return t","end"])+"("+o+("FROM_END"==i||"FROM_START"==i?", "+r:"")+("FROM_END"==n||"FROM_START"==n?", "+t:"")+")",e.Lua.ORDER_HIGH]},e.Lua.lists_sort=function(t){var o=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_NONE)||"{}",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e.Lua.provideFunction_("list_sort",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(list, typev, direction)","  local t = {}","  for n,v in pairs(list) do table.insert(t, v) end","  local compareFuncs = {","    NUMERIC = function(a, b)","      return (tonumber(tostring(a)) or 0)","          < (tonumber(tostring(b)) or 0) end,","    TEXT = function(a, b)","      return tostring(a) < tostring(b) end,","    IGNORE_CASE = function(a, b)","      return string.lower(tostring(a)) < string.lower(tostring(b)) end","  }","  local compareTemp = compareFuncs[typev]","  local compare = compareTemp","  if direction == -1","  then compare = function(a, b) return compareTemp(b, a) end","  end","  table.sort(t, compare)","  return t","end"])+"("+o+',"'+t+'", '+i+")",e.Lua.ORDER_HIGH]},e.Lua.lists_split=function(t){var o=e.Lua.valueToCode(t,"INPUT",e.Lua.ORDER_NONE),i=e.Lua.valueToCode(t,"DELIM",e.Lua.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))o||(o="''"),t=e.Lua.provideFunction_("list_string_split",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input, delim)","  local t = {}","  local pos = 1","  while true do","    next_delim = string.find(input, delim, pos)","    if next_delim == nil then","      table.insert(t, string.sub(input, pos))","      break","    else","      table.insert(t, string.sub(input, pos, next_delim-1))","      pos = next_delim + #delim","    end","  end","  return t","end"]);else{if("JOIN"!=t)throw"Unknown mode: "+t;o||(o="{}"),t="table.concat"}return[t+"("+o+", "+i+")",e.Lua.ORDER_HIGH]},e.Lua.lists_reverse=function(t){return t=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_NONE)||"{}",e.Lua.provideFunction_("list_reverse",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input)","  local reversed = {}","  for i = #input, 1, -1 do","    table.insert(reversed, input[i])","  end","  return reversed","end"]),["list_reverse("+t+")",e.Lua.ORDER_HIGH]},e.Lua.logic={},e.Lua.controls_if=function(t){var o=0,i="";do{var n=e.Lua.valueToCode(t,"IF"+o,e.Lua.ORDER_NONE)||"false",r=e.Lua.statementToCode(t,"DO"+o);i+=(0<o?"else":"")+"if "+n+" then\n"+r,++o}while(t.getInput("IF"+o));return t.getInput("ELSE")&&(i+="else\n"+(r=e.Lua.statementToCode(t,"ELSE"))),i+"end\n"},e.Lua.controls_ifelse=e.Lua.controls_if,e.Lua.logic_compare=function(t){var o={EQ:"==",NEQ:"~=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")];return[(e.Lua.valueToCode(t,"A",e.Lua.ORDER_RELATIONAL)||"0")+" "+o+" "+(t=e.Lua.valueToCode(t,"B",e.Lua.ORDER_RELATIONAL)||"0"),e.Lua.ORDER_RELATIONAL]},e.Lua.logic_operation=function(t){var o="AND"==t.getFieldValue("OP")?"and":"or",i="and"==o?e.Lua.ORDER_AND:e.Lua.ORDER_OR,n=e.Lua.valueToCode(t,"A",i);if(t=e.Lua.valueToCode(t,"B",i),n||t){var r="and"==o?"true":"false";n||(n=r),t||(t=r)}else t=n="false";return[n+" "+o+" "+t,i]},e.Lua.logic_negate=function(t){return["not "+(e.Lua.valueToCode(t,"BOOL",e.Lua.ORDER_UNARY)||"true"),e.Lua.ORDER_UNARY]},e.Lua.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",e.Lua.ORDER_ATOMIC]},e.Lua.logic_null=function(t){return["nil",e.Lua.ORDER_ATOMIC]},e.Lua.logic_ternary=function(t){return[(e.Lua.valueToCode(t,"IF",e.Lua.ORDER_AND)||"false")+" and "+(e.Lua.valueToCode(t,"THEN",e.Lua.ORDER_AND)||"nil")+" or "+(t=e.Lua.valueToCode(t,"ELSE",e.Lua.ORDER_OR)||"nil"),e.Lua.ORDER_OR]},e.Lua.loops={},e.Lua.CONTINUE_STATEMENT="goto continue\n",e.Lua.addContinueLabel=function(t){return-1<t.indexOf(e.Lua.CONTINUE_STATEMENT)?t+e.Lua.INDENT+"::continue::\n":t},e.Lua.controls_repeat=function(t){var o=parseInt(t.getFieldValue("TIMES"),10);return t=e.Lua.statementToCode(t,"DO")||"",t=e.Lua.addContinueLabel(t),"for "+e.Lua.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE)+" = 1, "+o+" do\n"+t+"end\n"},e.Lua.controls_repeat_ext=function(t){var o=e.Lua.valueToCode(t,"TIMES",e.Lua.ORDER_NONE)||"0";return o=e.isNumber(o)?parseInt(o,10):"math.floor("+o+")",t=e.Lua.statementToCode(t,"DO")||"\n",t=e.Lua.addContinueLabel(t),"for "+e.Lua.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE)+" = 1, "+o+" do\n"+t+"end\n"},e.Lua.controls_whileUntil=function(t){var o="UNTIL"==t.getFieldValue("MODE"),i=e.Lua.valueToCode(t,"BOOL",o?e.Lua.ORDER_UNARY:e.Lua.ORDER_NONE)||"false",n=e.Lua.statementToCode(t,"DO")||"\n";return n=e.Lua.addLoopTrap(n,t.id),n=e.Lua.addContinueLabel(n),o&&(i="not "+i),"while "+i+" do\n"+n+"end\n"},e.Lua.controls_for=function(t){var o=e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Lua.valueToCode(t,"FROM",e.Lua.ORDER_NONE)||"0",n=e.Lua.valueToCode(t,"TO",e.Lua.ORDER_NONE)||"0",r=e.Lua.valueToCode(t,"BY",e.Lua.ORDER_NONE)||"1",s=e.Lua.statementToCode(t,"DO")||"\n";if(s=e.Lua.addLoopTrap(s,t.id),s=e.Lua.addContinueLabel(s),t="",e.isNumber(i)&&e.isNumber(n)&&e.isNumber(r)){var a=parseFloat(i)<=parseFloat(n);r=Math.abs(parseFloat(r)),a=(a?"":"-")+r}else t="",t+=(a=e.Lua.variableDB_.getDistinctName(o+"_inc",e.Variables.NAME_TYPE))+" = ",t=(t=e.isNumber(r)?t+(Math.abs(r)+"\n"):t+"math.abs("+r+")\n")+"if ("+i+") > ("+n+") then\n"+(e.Lua.INDENT+a)+" = -"+a+"\n",t+="end\n";return t+"for "+o+" = "+i+", "+n+", "+a+" do\n"+s+"end\n"},e.Lua.controls_forEach=function(t){var o=e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_NONE)||"{}";return t=e.Lua.statementToCode(t,"DO")||"\n","for _, "+o+" in ipairs("+i+") do \n"+(t=e.Lua.addContinueLabel(t))+"end\n"},e.Lua.controls_flow_statements=function(t){switch(t.getFieldValue("FLOW")){case"BREAK":return"break\n";case"CONTINUE":return e.Lua.CONTINUE_STATEMENT}throw"Unknown flow statement."},e.Lua.math={},e.Lua.math_number=function(t){return[t=parseFloat(t.getFieldValue("NUM")),0>t?e.Lua.ORDER_UNARY:e.Lua.ORDER_ATOMIC]},e.Lua.math_arithmetic=function(t){var o={ADD:[" + ",e.Lua.ORDER_ADDITIVE],MINUS:[" - ",e.Lua.ORDER_ADDITIVE],MULTIPLY:[" * ",e.Lua.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",e.Lua.ORDER_MULTIPLICATIVE],POWER:[" ^ ",e.Lua.ORDER_EXPONENTIATION]}[t.getFieldValue("OP")],i=o[0];return o=o[1],[(e.Lua.valueToCode(t,"A",o)||"0")+i+(t=e.Lua.valueToCode(t,"B",o)||"0"),o]},e.Lua.math_single=function(t){var o=t.getFieldValue("OP");if("NEG"==o)return["-"+(t=e.Lua.valueToCode(t,"NUM",e.Lua.ORDER_UNARY)||"0"),e.Lua.ORDER_UNARY];switch(t="SIN"==o||"COS"==o||"TAN"==o?e.Lua.valueToCode(t,"NUM",e.Lua.ORDER_MULTIPLICATIVE)||"0":e.Lua.valueToCode(t,"NUM",e.Lua.ORDER_NONE)||"0",o){case"ABS":o="math.abs("+t+")";break;case"ROOT":o="math.sqrt("+t+")";break;case"LN":o="math.log("+t+")";break;case"LOG10":o="math.log10("+t+")";break;case"EXP":o="math.exp("+t+")";break;case"POW10":o="math.pow(10,"+t+")";break;case"ROUND":o="math.floor("+t+" + .5)";break;case"ROUNDUP":o="math.ceil("+t+")";break;case"ROUNDDOWN":o="math.floor("+t+")";break;case"SIN":o="math.sin(math.rad("+t+"))";break;case"COS":o="math.cos(math.rad("+t+"))";break;case"TAN":o="math.tan(math.rad("+t+"))";break;case"ASIN":o="math.deg(math.asin("+t+"))";break;case"ACOS":o="math.deg(math.acos("+t+"))";break;case"ATAN":o="math.deg(math.atan("+t+"))";break;default:throw"Unknown math operator: "+o}return[o,e.Lua.ORDER_HIGH]},e.Lua.math_constant=function(t){return{PI:["math.pi",e.Lua.ORDER_HIGH],E:["math.exp(1)",e.Lua.ORDER_HIGH],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",e.Lua.ORDER_MULTIPLICATIVE],SQRT2:["math.sqrt(2)",e.Lua.ORDER_HIGH],SQRT1_2:["math.sqrt(1 / 2)",e.Lua.ORDER_HIGH],INFINITY:["math.huge",e.Lua.ORDER_HIGH]}[t.getFieldValue("CONSTANT")]},e.Lua.math_number_property=function(t){var o=e.Lua.valueToCode(t,"NUMBER_TO_CHECK",e.Lua.ORDER_MULTIPLICATIVE)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[e.Lua.provideFunction_("math_isPrime",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(n)","  -- https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if n == 2 or n == 3 then","    return true","  end","  -- False if n is NaN, negative, is 1, or not whole.","  -- And false if n is divisible by 2 or 3.","  if not(n > 1) or n % 1 ~= 0 or n % 2 == 0 or n % 3 == 0 then","    return false","  end","  -- Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for x = 6, math.sqrt(n) + 1.5, 6 do","    if n % (x - 1) == 0 or n % (x + 1) == 0 then","      return false","    end","  end","  return true","end"])+"("+o+")",e.Lua.ORDER_HIGH];switch(i){case"EVEN":var n=o+" % 2 == 0";break;case"ODD":n=o+" % 2 == 1";break;case"WHOLE":n=o+" % 1 == 0";break;case"POSITIVE":n=o+" > 0";break;case"NEGATIVE":n=o+" < 0";break;case"DIVISIBLE_BY":if(!(t=e.Lua.valueToCode(t,"DIVISOR",e.Lua.ORDER_MULTIPLICATIVE))||"0"==t)return["nil",e.Lua.ORDER_ATOMIC];n=o+" % "+t+" == 0"}return[n,e.Lua.ORDER_RELATIONAL]},e.Lua.math_change=function(t){var o=e.Lua.valueToCode(t,"DELTA",e.Lua.ORDER_ADDITIVE)||"0";return(t=e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE))+" = "+t+" + "+o+"\n"},e.Lua.math_round=e.Lua.math_single,e.Lua.math_trig=e.Lua.math_single,e.Lua.math_on_list=function(t){function o(){return e.Lua.provideFunction_("math_sum",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local result = 0","  for _, v in ipairs(t) do","    result = result + v","  end","  return result","end"])}var i=t.getFieldValue("OP");switch(t=e.Lua.valueToCode(t,"LIST",e.Lua.ORDER_NONE)||"{}",i){case"SUM":i=o();break;case"MIN":i=e.Lua.provideFunction_("math_min",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = math.huge","  for _, v in ipairs(t) do","    if v < result then","      result = v","    end","  end","  return result","end"]);break;case"AVERAGE":i=e.Lua.provideFunction_("math_average",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  return "+o()+"(t) / #t","end"]);break;case"MAX":i=e.Lua.provideFunction_("math_max",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = -math.huge","  for _, v in ipairs(t) do","    if v > result then","      result = v","    end","  end","  return result","end"]);break;case"MEDIAN":i=e.Lua.provideFunction_("math_median",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  if #t == 0 then","    return 0","  end","  local temp={}","  for _, v in ipairs(t) do",'    if type(v) == "number" then',"      table.insert(temp, v)","    end","  end","  table.sort(temp)","  if #temp % 2 == 0 then","    return (temp[#temp/2] + temp[(#temp/2)+1]) / 2","  else","    return temp[math.ceil(#temp/2)]","  end","end"]);break;case"MODE":i=e.Lua.provideFunction_("math_modes",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  local counts={}","  for _, v in ipairs(t) do","    if counts[v] == nil then","      counts[v] = 1","    else","      counts[v] = counts[v] + 1","    end","  end","  local biggestCount = 0","  for _, v  in pairs(counts) do","    if v > biggestCount then","      biggestCount = v","    end","  end","  local temp={}","  for k, v in pairs(counts) do","    if v == biggestCount then","      table.insert(temp, k)","    end","  end","  return temp","end"]);break;case"STD_DEV":i=e.Lua.provideFunction_("math_standard_deviation",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local m","  local vm","  local total = 0","  local count = 0","  local result","  m = #t == 0 and 0 or "+o()+"(t) / #t","  for _, v in ipairs(t) do","    if type(v) == 'number' then","      vm = v - m","      total = total + (vm * vm)","      count = count + 1","    end","  end","  result = math.sqrt(total / (count-1))","  return result","end"]);break;case"RANDOM":i=e.Lua.provideFunction_("math_random_list",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return nil","  end","  return t[math.random(#t)]","end"]);break;default:throw"Unknown operator: "+i}return[i+"("+t+")",e.Lua.ORDER_HIGH]},e.Lua.math_modulo=function(t){return[(e.Lua.valueToCode(t,"DIVIDEND",e.Lua.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=e.Lua.valueToCode(t,"DIVISOR",e.Lua.ORDER_MULTIPLICATIVE)||"0"),e.Lua.ORDER_MULTIPLICATIVE]},e.Lua.math_constrain=function(t){return["math.min(math.max("+(e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"0")+", "+(e.Lua.valueToCode(t,"LOW",e.Lua.ORDER_NONE)||"-math.huge")+"), "+(t=e.Lua.valueToCode(t,"HIGH",e.Lua.ORDER_NONE)||"math.huge")+")",e.Lua.ORDER_HIGH]},e.Lua.math_random_int=function(t){return["math.random("+(e.Lua.valueToCode(t,"FROM",e.Lua.ORDER_NONE)||"0")+", "+(t=e.Lua.valueToCode(t,"TO",e.Lua.ORDER_NONE)||"0")+")",e.Lua.ORDER_HIGH]},e.Lua.math_random_float=function(t){return["math.random()",e.Lua.ORDER_HIGH]},e.Lua.procedures={},e.Lua.procedures_defreturn=function(t){var o=e.Lua.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=e.Lua.statementToCode(t,"STACK");if(e.Lua.STATEMENT_PREFIX){var n=t.id.replace(/\$/g,"$$$$");i=e.Lua.prefixLines(e.Lua.STATEMENT_PREFIX.replace(/%1/g,"'"+n+"'"),e.Lua.INDENT)+i}e.Lua.INFINITE_LOOP_TRAP&&(i=e.Lua.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t.id+"'")+i),(n=e.Lua.valueToCode(t,"RETURN",e.Lua.ORDER_NONE)||"")?n=e.Lua.INDENT+"return "+n+"\n":i||(i="");for(var r=[],s=0;s<t.arguments_.length;s++)r[s]=e.Lua.variableDB_.getName(t.arguments_[s],e.Variables.NAME_TYPE);return i="function "+o+"("+r.join(", ")+")\n"+i+n+"end\n",i=e.Lua.scrub_(t,i),e.Lua.definitions_["%"+o]=i,null},e.Lua.procedures_defnoreturn=e.Lua.procedures_defreturn,e.Lua.procedures_callreturn=function(t){for(var o=e.Lua.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Lua.valueToCode(t,"ARG"+n,e.Lua.ORDER_NONE)||"nil";return[o+"("+i.join(", ")+")",e.Lua.ORDER_HIGH]},e.Lua.procedures_callnoreturn=function(t){for(var o=e.Lua.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.Lua.valueToCode(t,"ARG"+n,e.Lua.ORDER_NONE)||"nil";return o+"("+i.join(", ")+")\n"},e.Lua.procedures_ifreturn=function(t){var o="if "+(e.Lua.valueToCode(t,"CONDITION",e.Lua.ORDER_NONE)||"false")+" then\n";return t.hasReturnValue_?(t=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"nil",o+=e.Lua.INDENT+"return "+t+"\n"):o+=e.Lua.INDENT+"return\n",o+"end\n"},e.Lua.texts={},e.Lua.text=function(t){return[e.Lua.quote_(t.getFieldValue("TEXT")),e.Lua.ORDER_ATOMIC]},e.Lua.text_join=function(t){if(0==t.itemCount_)return["''",e.Lua.ORDER_ATOMIC];if(1==t.itemCount_)return["tostring("+(e.Lua.valueToCode(t,"ADD0",e.Lua.ORDER_NONE)||"''")+")",e.Lua.ORDER_HIGH];if(2==t.itemCount_){var o=e.Lua.valueToCode(t,"ADD0",e.Lua.ORDER_CONCATENATION)||"''";return[o+" .. "+(t=e.Lua.valueToCode(t,"ADD1",e.Lua.ORDER_CONCATENATION)||"''"),e.Lua.ORDER_CONCATENATION]}o=[];for(var i=0;i<t.itemCount_;i++)o[i]=e.Lua.valueToCode(t,"ADD"+i,e.Lua.ORDER_NONE)||"''";return[t="table.concat({"+o.join(", ")+"})",e.Lua.ORDER_HIGH]},e.Lua.text_append=function(t){var o=e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE);return o+" = "+o+" .. "+(t=e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_CONCATENATION)||"''")+"\n"},e.Lua.text_length=function(t){return["#"+(e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_UNARY)||"''"),e.Lua.ORDER_UNARY]},e.Lua.text_isEmpty=function(t){return["#"+(e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_UNARY)||"''")+" == 0",e.Lua.ORDER_RELATIONAL]},e.Lua.text_indexOf=function(t){var o=e.Lua.valueToCode(t,"FIND",e.Lua.ORDER_NONE)||"''",i=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"''";return[("FIRST"==t.getFieldValue("END")?e.Lua.provideFunction_("firstIndexOf",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr) ","  local i = string.find(str, substr, 1, true)","  if i == nil then","    return 0","  else","    return i","  end","end"]):e.Lua.provideFunction_("lastIndexOf",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr)","  local i = string.find(string.reverse(str), string.reverse(substr), 1, true)","  if i then","    return #str + 2 - i - #substr","  end","  return 0","end"]))+"("+i+", "+o+")",e.Lua.ORDER_HIGH]},e.Lua.text_charAt=function(t){var o=t.getFieldValue("WHERE")||"FROM_START",i=e.Lua.valueToCode(t,"AT","FROM_END"==o?e.Lua.ORDER_UNARY:e.Lua.ORDER_NONE)||"1";if(t=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"''","RANDOM"==o)t=(o=e.Lua.provideFunction_("text_random_letter",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local index = math.random(string.len(str))","  return string.sub(str, index, index)","end"]))+"("+t+")";else{if("FIRST"==o)i="1";else if("LAST"==o)i="-1";else if("FROM_START"!=o){if("FROM_END"!=o)throw"Unhandled option (text_charAt).";i="-"+i}i.match(/^-?\w*$/)?t="string.sub("+t+", "+i+", "+i+")":t=(o=e.Lua.provideFunction_("text_char_at",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, index)","  return string.sub(str, index, index)","end"]))+"("+t+", "+i+")"}return[t,e.Lua.ORDER_HIGH]},e.Lua.text_getSubstring=function(t){var o=e.Lua.valueToCode(t,"STRING",e.Lua.ORDER_NONE)||"''",i=t.getFieldValue("WHERE1"),n=e.Lua.valueToCode(t,"AT1","FROM_END"==i?e.Lua.ORDER_UNARY:e.Lua.ORDER_NONE)||"1";if("FIRST"==i)i=1;else if("FROM_START"==i)i=n;else{if("FROM_END"!=i)throw"Unhandled option (text_getSubstring)";i="-"+n}if(n=t.getFieldValue("WHERE2"),t=e.Lua.valueToCode(t,"AT2","FROM_END"==n?e.Lua.ORDER_UNARY:e.Lua.ORDER_NONE)||"1","LAST"==n)t=-1;else if("FROM_START"!=n){if("FROM_END"!=n)throw"Unhandled option (text_getSubstring)";t="-"+t}return["string.sub("+o+", "+i+", "+t+")",e.Lua.ORDER_HIGH]},e.Lua.text_changeCase=function(t){var o=t.getFieldValue("CASE");if(t=e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''","UPPERCASE"==o)var i="string.upper";else"LOWERCASE"==o?i="string.lower":"TITLECASE"==o&&(i=e.Lua.provideFunction_("text_titlecase",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local buf = {}","  local inWord = false","  for i = 1, #str do","    local c = string.sub(str, i, i)","    if inWord then","      table.insert(buf, string.lower(c))",'      if string.find(c, "%s") then',"        inWord = false","      end","    else","      table.insert(buf, string.upper(c))","      inWord = true","    end","  end","  return table.concat(buf)","end"]));return[i+"("+t+")",e.Lua.ORDER_HIGH]},e.Lua.text_trim=function(t){var o={LEFT:"^%s*(,-)",RIGHT:"(.-)%s*$",BOTH:"^%s*(.-)%s*$"}[t.getFieldValue("MODE")];return["string.gsub("+(e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''")+', "'+o+'", "%1")',e.Lua.ORDER_HIGH]},e.Lua.text_print=function(t){return"print("+(e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''")+")\n"},e.Lua.text_prompt_ext=function(t){var o=t.getField("TEXT")?e.Lua.quote_(t.getFieldValue("TEXT")):e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''";return o=e.Lua.provideFunction_("text_prompt",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(msg)","  io.write(msg)","  io.flush()","  return io.read()","end"])+"("+o+")","NUMBER"==t.getFieldValue("TYPE")&&(o="tonumber("+o+", 10)"),[o,e.Lua.ORDER_HIGH]},e.Lua.text_prompt=e.Lua.text_prompt_ext,e.Lua.text_count=function(t){var o=e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''";return t=e.Lua.valueToCode(t,"SUB",e.Lua.ORDER_NONE)||"''",[e.Lua.provideFunction_("text_count",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle)","  if #needle == 0 then","    return #haystack + 1","  end","  local i = 1","  local count = 0","  while true do","    i = string.find(haystack, needle, i, true)","    if i == nil then","      break","    end","    count = count + 1","    i = i + #needle","  end","  return count","end"])+"("+o+", "+t+")",e.Lua.ORDER_HIGH]},e.Lua.text_replace=function(t){var o=e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_NONE)||"''",i=e.Lua.valueToCode(t,"FROM",e.Lua.ORDER_NONE)||"''";return t=e.Lua.valueToCode(t,"TO",e.Lua.ORDER_NONE)||"''",[e.Lua.provideFunction_("text_replace",["function "+e.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement)","  local buf = {}","  local i = 1","  while i <= #haystack do","    if string.sub(haystack, i, i + #needle - 1) == needle then","      for j = 1, #replacement do","        table.insert(buf, string.sub(replacement, j, j))","      end","      i = i + #needle","    else","      table.insert(buf, string.sub(haystack, i, i))","      i = i + 1","    end","  end","  return table.concat(buf)","end"])+"("+o+", "+i+", "+t+")",e.Lua.ORDER_HIGH]},e.Lua.text_reverse=function(t){return["string.reverse("+(e.Lua.valueToCode(t,"TEXT",e.Lua.ORDER_HIGH)||"''")+")",e.Lua.ORDER_HIGH]},e.Lua.variables={},e.Lua.variables_get=function(t){return[e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.Lua.ORDER_ATOMIC]},e.Lua.variables_set=function(t){var o=e.Lua.valueToCode(t,"VALUE",e.Lua.ORDER_NONE)||"0";return e.Lua.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+o+"\n"},e.Lua.variablesDynamic={},e.Lua.variables_get_dynamic=e.Lua.variables_get,e.Lua.variables_set_dynamic=e.Lua.variables_set,e.Lua}},function(e,t){e.exports=function(e){"use strict";return e.JavaScript=new e.Generator("JavaScript"),e.JavaScript.addReservedWords("Blockly,break,case,catch,continue,debugger,default,delete,do,else,finally,for,function,if,in,instanceof,new,return,switch,this,throw,try,typeof,var,void,while,with,class,enum,export,extends,import,super,implements,interface,let,package,private,protected,public,static,yield,const,null,true,false,Array,ArrayBuffer,Boolean,Date,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Error,eval,EvalError,Float32Array,Float64Array,Function,Infinity,Int16Array,Int32Array,Int8Array,isFinite,isNaN,Iterator,JSON,Math,NaN,Number,Object,parseFloat,parseInt,RangeError,ReferenceError,RegExp,StopIteration,String,SyntaxError,TypeError,Uint16Array,Uint32Array,Uint8Array,Uint8ClampedArray,undefined,uneval,URIError,applicationCache,closed,Components,content,_content,controllers,crypto,defaultStatus,dialogArguments,directories,document,frameElement,frames,fullScreen,globalStorage,history,innerHeight,innerWidth,length,location,locationbar,localStorage,menubar,messageManager,mozAnimationStartTime,mozInnerScreenX,mozInnerScreenY,mozPaintCount,name,navigator,opener,outerHeight,outerWidth,pageXOffset,pageYOffset,parent,performance,personalbar,pkcs11,returnValue,screen,screenX,screenY,scrollbars,scrollMaxX,scrollMaxY,scrollX,scrollY,self,sessionStorage,sidebar,status,statusbar,toolbar,top,URL,window,addEventListener,alert,atob,back,blur,btoa,captureEvents,clearImmediate,clearInterval,clearTimeout,close,confirm,disableExternalCapture,dispatchEvent,dump,enableExternalCapture,escape,find,focus,forward,GeckoActiveXObject,getAttention,getAttentionWithCycleCount,getComputedStyle,getSelection,home,matchMedia,maximize,minimize,moveBy,moveTo,mozRequestAnimationFrame,open,openDialog,postMessage,print,prompt,QueryInterface,releaseEvents,removeEventListener,resizeBy,resizeTo,restore,routeEvent,scroll,scrollBy,scrollByLines,scrollByPages,scrollTo,setCursor,setImmediate,setInterval,setResizable,setTimeout,showModalDialog,sizeToContent,stop,unescape,updateCommands,XPCNativeWrapper,XPCSafeJSObjectWrapper,onabort,onbeforeunload,onblur,onchange,onclick,onclose,oncontextmenu,ondevicemotion,ondeviceorientation,ondragdrop,onerror,onfocus,onhashchange,onkeydown,onkeypress,onkeyup,onload,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup,onmozbeforepaint,onpaint,onpopstate,onreset,onresize,onscroll,onselect,onsubmit,onunload,onpageshow,onpagehide,Image,Option,Worker,Event,Range,File,FileReader,Blob,BlobBuilder,Attr,CDATASection,CharacterData,Comment,console,DocumentFragment,DocumentType,DomConfiguration,DOMError,DOMErrorHandler,DOMException,DOMImplementation,DOMImplementationList,DOMImplementationRegistry,DOMImplementationSource,DOMLocator,DOMObject,DOMString,DOMStringList,DOMTimeStamp,DOMUserData,Entity,EntityReference,MediaQueryList,MediaQueryListListener,NameList,NamedNodeMap,Node,NodeFilter,NodeIterator,NodeList,Notation,Plugin,PluginArray,ProcessingInstruction,SharedWorker,Text,TimeRanges,Treewalker,TypeInfo,UserDataHandler,Worker,WorkerGlobalScope,HTMLDocument,HTMLElement,HTMLAnchorElement,HTMLAppletElement,HTMLAudioElement,HTMLAreaElement,HTMLBaseElement,HTMLBaseFontElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLKeygenElement,HTMLLabelElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMenuElement,HTMLMetaElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableCellElement,HTMLTableDataCellElement,HTMLTableHeaderCellElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTimeElement,HTMLTitleElement,HTMLTrackElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement,HTMLCanvasElement,CanvasRenderingContext2D,CanvasGradient,CanvasPattern,TextMetrics,ImageData,CanvasPixelArray,HTMLAudioElement,HTMLVideoElement,NotifyAudioAvailableEvent,HTMLCollection,HTMLAllCollection,HTMLFormControlsCollection,HTMLOptionsCollection,HTMLPropertiesCollection,DOMTokenList,DOMSettableTokenList,DOMStringMap,RadioNodeList,SVGDocument,SVGElement,SVGAElement,SVGAltGlyphElement,SVGAltGlyphDefElement,SVGAltGlyphItemElement,SVGAnimationElement,SVGAnimateElement,SVGAnimateColorElement,SVGAnimateMotionElement,SVGAnimateTransformElement,SVGSetElement,SVGCircleElement,SVGClipPathElement,SVGColorProfileElement,SVGCursorElement,SVGDefsElement,SVGDescElement,SVGEllipseElement,SVGFilterElement,SVGFilterPrimitiveStandardAttributes,SVGFEBlendElement,SVGFEColorMatrixElement,SVGFEComponentTransferElement,SVGFECompositeElement,SVGFEConvolveMatrixElement,SVGFEDiffuseLightingElement,SVGFEDisplacementMapElement,SVGFEDistantLightElement,SVGFEFloodElement,SVGFEGaussianBlurElement,SVGFEImageElement,SVGFEMergeElement,SVGFEMergeNodeElement,SVGFEMorphologyElement,SVGFEOffsetElement,SVGFEPointLightElement,SVGFESpecularLightingElement,SVGFESpotLightElement,SVGFETileElement,SVGFETurbulenceElement,SVGComponentTransferFunctionElement,SVGFEFuncRElement,SVGFEFuncGElement,SVGFEFuncBElement,SVGFEFuncAElement,SVGFontElement,SVGFontFaceElement,SVGFontFaceFormatElement,SVGFontFaceNameElement,SVGFontFaceSrcElement,SVGFontFaceUriElement,SVGForeignObjectElement,SVGGElement,SVGGlyphElement,SVGGlyphRefElement,SVGGradientElement,SVGLinearGradientElement,SVGRadialGradientElement,SVGHKernElement,SVGImageElement,SVGLineElement,SVGMarkerElement,SVGMaskElement,SVGMetadataElement,SVGMissingGlyphElement,SVGMPathElement,SVGPathElement,SVGPatternElement,SVGPolylineElement,SVGPolygonElement,SVGRectElement,SVGScriptElement,SVGStopElement,SVGStyleElement,SVGSVGElement,SVGSwitchElement,SVGSymbolElement,SVGTextElement,SVGTextPathElement,SVGTitleElement,SVGTRefElement,SVGTSpanElement,SVGUseElement,SVGViewElement,SVGVKernElement,SVGAngle,SVGColor,SVGICCColor,SVGElementInstance,SVGElementInstanceList,SVGLength,SVGLengthList,SVGMatrix,SVGNumber,SVGNumberList,SVGPaint,SVGPoint,SVGPointList,SVGPreserveAspectRatio,SVGRect,SVGStringList,SVGTransform,SVGTransformList,SVGAnimatedAngle,SVGAnimatedBoolean,SVGAnimatedEnumeration,SVGAnimatedInteger,SVGAnimatedLength,SVGAnimatedLengthList,SVGAnimatedNumber,SVGAnimatedNumberList,SVGAnimatedPreserveAspectRatio,SVGAnimatedRect,SVGAnimatedString,SVGAnimatedTransformList,SVGPathSegList,SVGPathSeg,SVGPathSegArcAbs,SVGPathSegArcRel,SVGPathSegClosePath,SVGPathSegCurvetoCubicAbs,SVGPathSegCurvetoCubicRel,SVGPathSegCurvetoCubicSmoothAbs,SVGPathSegCurvetoCubicSmoothRel,SVGPathSegCurvetoQuadraticAbs,SVGPathSegCurvetoQuadraticRel,SVGPathSegCurvetoQuadraticSmoothAbs,SVGPathSegCurvetoQuadraticSmoothRel,SVGPathSegLinetoAbs,SVGPathSegLinetoHorizontalAbs,SVGPathSegLinetoHorizontalRel,SVGPathSegLinetoRel,SVGPathSegLinetoVerticalAbs,SVGPathSegLinetoVerticalRel,SVGPathSegMovetoAbs,SVGPathSegMovetoRel,ElementTimeControl,TimeEvent,SVGAnimatedPathData,SVGAnimatedPoints,SVGColorProfileRule,SVGCSSRule,SVGExternalResourcesRequired,SVGFitToViewBox,SVGLangSpace,SVGLocatable,SVGRenderingIntent,SVGStylable,SVGTests,SVGTextContentElement,SVGTextPositioningElement,SVGTransformable,SVGUnitTypes,SVGURIReference,SVGViewSpec,SVGZoomAndPan"),e.JavaScript.ORDER_ATOMIC=0,e.JavaScript.ORDER_NEW=1.1,e.JavaScript.ORDER_MEMBER=1.2,e.JavaScript.ORDER_FUNCTION_CALL=2,e.JavaScript.ORDER_INCREMENT=3,e.JavaScript.ORDER_DECREMENT=3,e.JavaScript.ORDER_BITWISE_NOT=4.1,e.JavaScript.ORDER_UNARY_PLUS=4.2,e.JavaScript.ORDER_UNARY_NEGATION=4.3,e.JavaScript.ORDER_LOGICAL_NOT=4.4,e.JavaScript.ORDER_TYPEOF=4.5,e.JavaScript.ORDER_VOID=4.6,e.JavaScript.ORDER_DELETE=4.7,e.JavaScript.ORDER_AWAIT=4.8,e.JavaScript.ORDER_EXPONENTIATION=5,e.JavaScript.ORDER_MULTIPLICATION=5.1,e.JavaScript.ORDER_DIVISION=5.2,e.JavaScript.ORDER_MODULUS=5.3,e.JavaScript.ORDER_SUBTRACTION=6.1,e.JavaScript.ORDER_ADDITION=6.2,e.JavaScript.ORDER_BITWISE_SHIFT=7,e.JavaScript.ORDER_RELATIONAL=8,e.JavaScript.ORDER_IN=8,e.JavaScript.ORDER_INSTANCEOF=8,e.JavaScript.ORDER_EQUALITY=9,e.JavaScript.ORDER_BITWISE_AND=10,e.JavaScript.ORDER_BITWISE_XOR=11,e.JavaScript.ORDER_BITWISE_OR=12,e.JavaScript.ORDER_LOGICAL_AND=13,e.JavaScript.ORDER_LOGICAL_OR=14,e.JavaScript.ORDER_CONDITIONAL=15,e.JavaScript.ORDER_ASSIGNMENT=16,e.JavaScript.ORDER_YIELD=16.5,e.JavaScript.ORDER_COMMA=17,e.JavaScript.ORDER_NONE=99,e.JavaScript.ORDER_OVERRIDES=[[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_LOGICAL_NOT,e.JavaScript.ORDER_LOGICAL_NOT],[e.JavaScript.ORDER_MULTIPLICATION,e.JavaScript.ORDER_MULTIPLICATION],[e.JavaScript.ORDER_ADDITION,e.JavaScript.ORDER_ADDITION],[e.JavaScript.ORDER_LOGICAL_AND,e.JavaScript.ORDER_LOGICAL_AND],[e.JavaScript.ORDER_LOGICAL_OR,e.JavaScript.ORDER_LOGICAL_OR]],e.JavaScript.init=function(t){e.JavaScript.definitions_=Object.create(null),e.JavaScript.functionNames_=Object.create(null),e.JavaScript.variableDB_?e.JavaScript.variableDB_.reset():e.JavaScript.variableDB_=new e.Names(e.JavaScript.RESERVED_WORDS_),e.JavaScript.variableDB_.setVariableMap(t.getVariableMap());for(var o=[],i=e.Variables.allDeveloperVariables(t),n=0;n<i.length;n++)o.push(e.JavaScript.variableDB_.getName(i[n],e.Names.DEVELOPER_VARIABLE_TYPE));for(t=e.Variables.allUsedVarModels(t),n=0;n<t.length;n++)o.push(e.JavaScript.variableDB_.getName(t[n].getId(),e.Variables.NAME_TYPE));o.length&&(e.JavaScript.definitions_.variables="var "+o.join(", ")+";")},e.JavaScript.finish=function(t){var o,i=[];for(o in e.JavaScript.definitions_)i.push(e.JavaScript.definitions_[o]);return delete e.JavaScript.definitions_,delete e.JavaScript.functionNames_,e.JavaScript.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},e.JavaScript.scrubNakedValue=function(e){return e+";\n"},e.JavaScript.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},e.JavaScript.scrub_=function(t,o){var i="";if(!t.outputConnection||!t.outputConnection.targetConnection){var n=t.getCommentText();(n=e.utils.wrap(n,e.JavaScript.COMMENT_WRAP-3))&&(i=t.getProcedureDef?i+"/**\n"+e.JavaScript.prefixLines(n+"\n"," * ")+" */\n":i+e.JavaScript.prefixLines(n+"\n","// "));for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==e.INPUT_VALUE&&(n=t.inputList[r].connection.targetBlock())&&(n=e.JavaScript.allNestedComments(n))&&(i+=e.JavaScript.prefixLines(n,"// "))}return r=t.nextConnection&&t.nextConnection.targetBlock(),i+o+(r=e.JavaScript.blockToCode(r))},e.JavaScript.getAdjusted=function(t,o,i,n,r){i=i||0,r=r||e.JavaScript.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<i?e.JavaScript.valueToCode(t,o,e.JavaScript.ORDER_ADDITION)||s:0>i?e.JavaScript.valueToCode(t,o,e.JavaScript.ORDER_SUBTRACTION)||s:n?e.JavaScript.valueToCode(t,o,e.JavaScript.ORDER_UNARY_NEGATION)||s:e.JavaScript.valueToCode(t,o,r)||s,e.isNumber(t))t=parseFloat(t)+i,n&&(t=-t);else{if(0<i){t=t+" + "+i;var a=e.JavaScript.ORDER_ADDITION}else 0>i&&(t=t+" - "+-i,a=e.JavaScript.ORDER_SUBTRACTION);n&&(t=i?"-("+t+")":"-"+t,a=e.JavaScript.ORDER_UNARY_NEGATION),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},e.JavaScript.colour={},e.JavaScript.colour_picker=function(t){return["'"+t.getFieldValue("COLOUR")+"'",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.colour_random=function(t){return[e.JavaScript.provideFunction_("colourRandom",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_rgb=function(t){var o=e.JavaScript.valueToCode(t,"RED",e.JavaScript.ORDER_COMMA)||0,i=e.JavaScript.valueToCode(t,"GREEN",e.JavaScript.ORDER_COMMA)||0;return t=e.JavaScript.valueToCode(t,"BLUE",e.JavaScript.ORDER_COMMA)||0,[e.JavaScript.provideFunction_("colourRgb",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+i+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_blend=function(t){var o=e.JavaScript.valueToCode(t,"COLOUR1",e.JavaScript.ORDER_COMMA)||"'#000000'",i=e.JavaScript.valueToCode(t,"COLOUR2",e.JavaScript.ORDER_COMMA)||"'#000000'";return t=e.JavaScript.valueToCode(t,"RATIO",e.JavaScript.ORDER_COMMA)||.5,[e.JavaScript.provideFunction_("colourBlend",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+i+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists={},e.JavaScript.lists_create_empty=function(t){return["[]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_create_with=function(t){for(var o=Array(t.itemCount_),i=0;i<t.itemCount_;i++)o[i]=e.JavaScript.valueToCode(t,"ADD"+i,e.JavaScript.ORDER_COMMA)||"null";return["["+o.join(", ")+"]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_repeat=function(t){return[e.JavaScript.provideFunction_("listsRepeat",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(e.JavaScript.valueToCode(t,"ITEM",e.JavaScript.ORDER_COMMA)||"null")+", "+(t=e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_COMMA)||"0")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_length=function(t){return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.lists_isEmpty=function(t){return["!"+(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.lists_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=e.JavaScript.valueToCode(t,"FIND",e.JavaScript.ORDER_NONE)||"''";return o=(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+"."+o+"("+i+")",t.workspace.options.oneBasedIndex?[o+" + 1",e.JavaScript.ORDER_ADDITION]:[o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_getIndex=function(t){var o=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",n=e.JavaScript.valueToCode(t,"VALUE","RANDOM"==i?e.JavaScript.ORDER_COMMA:e.JavaScript.ORDER_MEMBER)||"[]";switch(i){case"FIRST":if("GET"==o)return[n+"[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".shift()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return n+".shift();\n";break;case"LAST":if("GET"==o)return[n+".slice(-1)[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".pop()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return n+".pop();\n";break;case"FROM_START":if(t=e.JavaScript.getAdjusted(t,"AT"),"GET"==o)return[n+"["+t+"]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[n+".splice("+t+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".splice("+t+", 1);\n";break;case"FROM_END":if(t=e.JavaScript.getAdjusted(t,"AT",1,!0),"GET"==o)return[n+".slice("+t+")[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return[n+".splice("+t+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+".splice("+t+", 1);";break;case"RANDOM":if(n=e.JavaScript.provideFunction_("listsGetRandomItem",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+n+", "+("GET"!=o)+")","GET"==o||"GET_REMOVE"==o)return[n,e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return n+";\n"}throw"Unhandled combination (lists_getIndex)."},e.JavaScript.lists_setIndex=function(t){function o(){if(i.match(/^\w+$/))return"";var t=e.JavaScript.variableDB_.getDistinctName("tmpList",e.Variables.NAME_TYPE),o="var "+t+" = "+i+";\n";return i=t,o}var i=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",n=t.getFieldValue("MODE")||"GET",r=t.getFieldValue("WHERE")||"FROM_START",s=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"null";switch(r){case"FIRST":if("SET"==n)return i+"[0] = "+s+";\n";if("INSERT"==n)return i+".unshift("+s+");\n";break;case"LAST":if("SET"==n)return(t=o())+(i+"[")+i+".length - 1] = "+s+";\n";if("INSERT"==n)return i+".push("+s+");\n";break;case"FROM_START":if(r=e.JavaScript.getAdjusted(t,"AT"),"SET"==n)return i+"["+r+"] = "+s+";\n";if("INSERT"==n)return i+".splice("+r+", 0, "+s+");\n";break;case"FROM_END":if(r=e.JavaScript.getAdjusted(t,"AT",1,!1,e.JavaScript.ORDER_SUBTRACTION),t=o(),"SET"==n)return t+(i+"[")+i+".length - "+r+"] = "+s+";\n";if("INSERT"==n)return t+(i+".splice(")+i+".length - "+r+", 0, "+s+");\n";break;case"RANDOM":if(t=o(),t+="var "+(r=e.JavaScript.variableDB_.getDistinctName("tmpX",e.Variables.NAME_TYPE))+" = Math.floor(Math.random() * "+i+".length);\n","SET"==n)return t+(i+"[")+r+"] = "+s+";\n";if("INSERT"==n)return t+(i+".splice(")+r+", 0, "+s+");\n"}throw"Unhandled combination (lists_setIndex)."},e.JavaScript.lists.getIndex_=function(e,t,o){return"FIRST"==t?"0":"FROM_END"==t?e+".length - 1 - "+o:"LAST"==t?e+".length - 1":o},e.JavaScript.lists_getSublist=function(t){var o=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"==i&&"LAST"==n)o+=".slice(0)";else if(o.match(/^\w+$/)||"FROM_END"!=i&&"FROM_START"==n){switch(i){case"FROM_START":var r=e.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":r=o+".length - "+(r=e.JavaScript.getAdjusted(t,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":r="0";break;default:throw"Unhandled option (lists_getSublist)."}switch(n){case"FROM_START":t=e.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=o+".length - "+(t=e.JavaScript.getAdjusted(t,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=o+".length";break;default:throw"Unhandled option (lists_getSublist)."}o=o+".slice("+r+", "+t+")"}else{r=e.JavaScript.getAdjusted(t,"AT1"),t=e.JavaScript.getAdjusted(t,"AT2");var s=e.JavaScript.lists.getIndex_,a={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=e.JavaScript.provideFunction_("subsequence"+a[i]+a[n],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==i||"FROM_START"==i?", at1":"")+("FROM_END"==n||"FROM_START"==n?", at2":"")+") {","  var start = "+s("sequence",i,"at1")+";","  var end = "+s("sequence",n,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+o+("FROM_END"==i||"FROM_START"==i?", "+r:"")+("FROM_END"==n||"FROM_START"==n?", "+t:"")+")"}return[o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_sort=function(t){var o=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[o+".slice().sort("+e.JavaScript.provideFunction_("listsGetSortCompare",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return parseFloat(a) - parseFloat(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+t+'", '+i+"))",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_split=function(t){var o=e.JavaScript.valueToCode(t,"INPUT",e.JavaScript.ORDER_MEMBER),i=e.JavaScript.valueToCode(t,"DELIM",e.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))o||(o="''"),t="split";else{if("JOIN"!=t)throw"Unknown mode: "+t;o||(o="[]"),t="join"}return[o+"."+t+"("+i+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_reverse=function(t){return[(e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.logic={},e.JavaScript.controls_if=function(t){var o=0,i="";do{var n=e.JavaScript.valueToCode(t,"IF"+o,e.JavaScript.ORDER_NONE)||"false",r=e.JavaScript.statementToCode(t,"DO"+o);i+=(0<o?" else ":"")+"if ("+n+") {\n"+r+"}",++o}while(t.getInput("IF"+o));return t.getInput("ELSE")&&(i+=" else {\n"+(r=e.JavaScript.statementToCode(t,"ELSE"))+"}"),i+"\n"},e.JavaScript.controls_ifelse=e.JavaScript.controls_if,e.JavaScript.logic_compare=function(t){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==o||"!="==o?e.JavaScript.ORDER_EQUALITY:e.JavaScript.ORDER_RELATIONAL;return[(e.JavaScript.valueToCode(t,"A",i)||"0")+" "+o+" "+(t=e.JavaScript.valueToCode(t,"B",i)||"0"),i]},e.JavaScript.logic_operation=function(t){var o="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==o?e.JavaScript.ORDER_LOGICAL_AND:e.JavaScript.ORDER_LOGICAL_OR,n=e.JavaScript.valueToCode(t,"A",i);if(t=e.JavaScript.valueToCode(t,"B",i),n||t){var r="&&"==o?"true":"false";n||(n=r),t||(t=r)}else t=n="false";return[n+" "+o+" "+t,i]},e.JavaScript.logic_negate=function(t){var o=e.JavaScript.ORDER_LOGICAL_NOT;return["!"+(e.JavaScript.valueToCode(t,"BOOL",o)||"true"),o]},e.JavaScript.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_null=function(t){return["null",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_ternary=function(t){return[(e.JavaScript.valueToCode(t,"IF",e.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(e.JavaScript.valueToCode(t,"THEN",e.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(t=e.JavaScript.valueToCode(t,"ELSE",e.JavaScript.ORDER_CONDITIONAL)||"null"),e.JavaScript.ORDER_CONDITIONAL]},e.JavaScript.loops={},e.JavaScript.controls_repeat_ext=function(t){var o=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):e.JavaScript.valueToCode(t,"TIMES",e.JavaScript.ORDER_ASSIGNMENT)||"0",i=e.JavaScript.statementToCode(t,"DO");i=e.JavaScript.addLoopTrap(i,t.id),t="";var n=e.JavaScript.variableDB_.getDistinctName("count",e.Variables.NAME_TYPE),r=o;return o.match(/^\w+$/)||e.isNumber(o)||(t+="var "+(r=e.JavaScript.variableDB_.getDistinctName("repeat_end",e.Variables.NAME_TYPE))+" = "+o+";\n"),t+"for (var "+n+" = 0; "+n+" < "+r+"; "+n+"++) {\n"+i+"}\n"},e.JavaScript.controls_repeat=e.JavaScript.controls_repeat_ext,e.JavaScript.controls_whileUntil=function(t){var o="UNTIL"==t.getFieldValue("MODE"),i=e.JavaScript.valueToCode(t,"BOOL",o?e.JavaScript.ORDER_LOGICAL_NOT:e.JavaScript.ORDER_NONE)||"false",n=e.JavaScript.statementToCode(t,"DO");return n=e.JavaScript.addLoopTrap(n,t.id),o&&(i="!"+i),"while ("+i+") {\n"+n+"}\n"},e.JavaScript.controls_for=function(t){var o=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.JavaScript.valueToCode(t,"FROM",e.JavaScript.ORDER_ASSIGNMENT)||"0",n=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"0",r=e.JavaScript.valueToCode(t,"BY",e.JavaScript.ORDER_ASSIGNMENT)||"1",s=e.JavaScript.statementToCode(t,"DO");if(s=e.JavaScript.addLoopTrap(s,t.id),e.isNumber(i)&&e.isNumber(n)&&e.isNumber(r)){var a=parseFloat(i)<=parseFloat(n);t="for ("+o+" = "+i+"; "+o+(a?" <= ":" >= ")+n+"; "+o,t=(1==(o=Math.abs(parseFloat(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+o)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||e.isNumber(i)||(t+="var "+(a=e.JavaScript.variableDB_.getDistinctName(o+"_start",e.Variables.NAME_TYPE))+" = "+i+";\n"),i=n,n.match(/^\w+$/)||e.isNumber(n)||(t+="var "+(i=e.JavaScript.variableDB_.getDistinctName(o+"_end",e.Variables.NAME_TYPE))+" = "+n+";\n"),t+="var "+(n=e.JavaScript.variableDB_.getDistinctName(o+"_inc",e.Variables.NAME_TYPE))+" = ",t=(t=e.isNumber(r)?t+(Math.abs(r)+";\n"):t+"Math.abs("+r+");\n")+"if ("+a+" > "+i+") {\n"+(e.JavaScript.INDENT+n)+" = -"+n+";\n",t+="}\n",t+="for ("+o+" = "+a+"; "+n+" >= 0 ? "+o+" <= "+i+" : "+o+" >= "+i+"; "+o+" += "+n+") {\n"+s+"}\n";return t},e.JavaScript.controls_forEach=function(t){var o=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),i=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_ASSIGNMENT)||"[]",n=e.JavaScript.statementToCode(t,"DO");n=e.JavaScript.addLoopTrap(n,t.id),t="";var r=i;return i.match(/^\w+$/)||(t+="var "+(r=e.JavaScript.variableDB_.getDistinctName(o+"_list",e.Variables.NAME_TYPE))+" = "+i+";\n"),t+"for (var "+(i=e.JavaScript.variableDB_.getDistinctName(o+"_index",e.Variables.NAME_TYPE))+" in "+r+") {\n"+(n=e.JavaScript.INDENT+o+" = "+r+"["+i+"];\n"+n)+"}\n"},e.JavaScript.controls_flow_statements=function(e){switch(e.getFieldValue("FLOW")){case"BREAK":return"break;\n";case"CONTINUE":return"continue;\n"}throw"Unknown flow statement."},e.JavaScript.math={},e.JavaScript.math_number=function(t){return[t=parseFloat(t.getFieldValue("NUM")),0<=t?e.JavaScript.ORDER_ATOMIC:e.JavaScript.ORDER_UNARY_NEGATION]},e.JavaScript.math_arithmetic=function(t){var o={ADD:[" + ",e.JavaScript.ORDER_ADDITION],MINUS:[" - ",e.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",e.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",e.JavaScript.ORDER_DIVISION],POWER:[null,e.JavaScript.ORDER_COMMA]}[t.getFieldValue("OP")],i=o[0];o=o[1];var n=e.JavaScript.valueToCode(t,"A",o)||"0";return t=e.JavaScript.valueToCode(t,"B",o)||"0",i?[n+i+t,o]:["Math.pow("+n+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_single=function(t){var o=t.getFieldValue("OP");if("NEG"==o)return"-"==(t=e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,e.JavaScript.ORDER_UNARY_NEGATION];switch(t="SIN"==o||"COS"==o||"TAN"==o?e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_DIVISION)||"0":e.JavaScript.valueToCode(t,"NUM",e.JavaScript.ORDER_NONE)||"0",o){case"ABS":var i="Math.abs("+t+")";break;case"ROOT":i="Math.sqrt("+t+")";break;case"LN":i="Math.log("+t+")";break;case"EXP":i="Math.exp("+t+")";break;case"POW10":i="Math.pow(10,"+t+")";break;case"ROUND":i="Math.round("+t+")";break;case"ROUNDUP":i="Math.ceil("+t+")";break;case"ROUNDDOWN":i="Math.floor("+t+")";break;case"SIN":i="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":i="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":i="Math.tan("+t+" / 180 * Math.PI)"}if(i)return[i,e.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"LOG10":i="Math.log("+t+") / Math.log(10)";break;case"ASIN":i="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":i="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":i="Math.atan("+t+") / Math.PI * 180";break;default:throw"Unknown math operator: "+o}return[i,e.JavaScript.ORDER_DIVISION]},e.JavaScript.math_constant=function(t){return{PI:["Math.PI",e.JavaScript.ORDER_MEMBER],E:["Math.E",e.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",e.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",e.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",e.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",e.JavaScript.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},e.JavaScript.math_number_property=function(t){var o=e.JavaScript.valueToCode(t,"NUMBER_TO_CHECK",e.JavaScript.ORDER_MODULUS)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[e.JavaScript.provideFunction_("mathIsPrime",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",e.JavaScript.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var n=o+" % 2 == 0";break;case"ODD":n=o+" % 2 == 1";break;case"WHOLE":n=o+" % 1 == 0";break;case"POSITIVE":n=o+" > 0";break;case"NEGATIVE":n=o+" < 0";break;case"DIVISIBLE_BY":n=o+" % "+(t=e.JavaScript.valueToCode(t,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[n,e.JavaScript.ORDER_EQUALITY]},e.JavaScript.math_change=function(t){var o=e.JavaScript.valueToCode(t,"DELTA",e.JavaScript.ORDER_ADDITION)||"0";return(t=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE))+" = (typeof "+t+" == 'number' ? "+t+" : 0) + "+o+";\n"},e.JavaScript.math_round=e.JavaScript.math_single,e.JavaScript.math_trig=e.JavaScript.math_single,e.JavaScript.math_on_list=function(t){var o=t.getFieldValue("OP");switch(o){case"SUM":t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t="Math.min.apply(null, "+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_COMMA)||"[]")+")";break;case"MAX":t="Math.max.apply(null, "+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_COMMA)||"[]")+")";break;case"AVERAGE":t=(o=e.JavaScript.provideFunction_("mathMean",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":t=(o=e.JavaScript.provideFunction_("mathMedian",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":t=(o=e.JavaScript.provideFunction_("mathModes",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(o=e.JavaScript.provideFunction_("mathStandardDeviation",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(o=e.JavaScript.provideFunction_("mathRandomList",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(t=e.JavaScript.valueToCode(t,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw"Unknown operator: "+o}return[t,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_modulo=function(t){return[(e.JavaScript.valueToCode(t,"DIVIDEND",e.JavaScript.ORDER_MODULUS)||"0")+" % "+(t=e.JavaScript.valueToCode(t,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0"),e.JavaScript.ORDER_MODULUS]},e.JavaScript.math_constrain=function(t){return["Math.min(Math.max("+(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_COMMA)||"0")+", "+(e.JavaScript.valueToCode(t,"LOW",e.JavaScript.ORDER_COMMA)||"0")+"), "+(t=e.JavaScript.valueToCode(t,"HIGH",e.JavaScript.ORDER_COMMA)||"Infinity")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_int=function(t){var o=e.JavaScript.valueToCode(t,"FROM",e.JavaScript.ORDER_COMMA)||"0";return t=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_COMMA)||"0",[e.JavaScript.provideFunction_("mathRandomInt",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+o+", "+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_float=function(t){return["Math.random()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures={},e.JavaScript.procedures_defreturn=function(t){var o=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=e.JavaScript.statementToCode(t,"STACK");if(e.JavaScript.STATEMENT_PREFIX){var n=t.id.replace(/\$/g,"$$$$");i=e.JavaScript.prefixLines(e.JavaScript.STATEMENT_PREFIX.replace(/%1/g,"'"+n+"'"),e.JavaScript.INDENT)+i}e.JavaScript.INFINITE_LOOP_TRAP&&(i=e.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t.id+"'")+i),(n=e.JavaScript.valueToCode(t,"RETURN",e.JavaScript.ORDER_NONE)||"")&&(n=e.JavaScript.INDENT+"return "+n+";\n");for(var r=[],s=0;s<t.arguments_.length;s++)r[s]=e.JavaScript.variableDB_.getName(t.arguments_[s],e.Variables.NAME_TYPE);return i="function "+o+"("+r.join(", ")+") {\n"+i+n+"}",i=e.JavaScript.scrub_(t,i),e.JavaScript.definitions_["%"+o]=i,null},e.JavaScript.procedures_defnoreturn=e.JavaScript.procedures_defreturn,e.JavaScript.procedures_callreturn=function(t){for(var o=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.JavaScript.valueToCode(t,"ARG"+n,e.JavaScript.ORDER_COMMA)||"null";return[o+"("+i.join(", ")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures_callnoreturn=function(t){for(var o=e.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),e.Procedures.NAME_TYPE),i=[],n=0;n<t.arguments_.length;n++)i[n]=e.JavaScript.valueToCode(t,"ARG"+n,e.JavaScript.ORDER_COMMA)||"null";return o+"("+i.join(", ")+");\n"},e.JavaScript.procedures_ifreturn=function(t){var o="if ("+(e.JavaScript.valueToCode(t,"CONDITION",e.JavaScript.ORDER_NONE)||"false")+") {\n";return t.hasReturnValue_?(t=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_NONE)||"null",o+=e.JavaScript.INDENT+"return "+t+";\n"):o+=e.JavaScript.INDENT+"return;\n",o+"}\n"},e.JavaScript.texts={},e.JavaScript.text=function(t){return[e.JavaScript.quote_(t.getFieldValue("TEXT")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.text_join=function(t){switch(t.itemCount_){case 0:return["''",e.JavaScript.ORDER_ATOMIC];case 1:return["String("+(e.JavaScript.valueToCode(t,"ADD0",e.JavaScript.ORDER_NONE)||"''")+")",e.JavaScript.ORDER_FUNCTION_CALL];case 2:var o=e.JavaScript.valueToCode(t,"ADD0",e.JavaScript.ORDER_NONE)||"''";return["String("+o+") + String("+(t=e.JavaScript.valueToCode(t,"ADD1",e.JavaScript.ORDER_NONE)||"''")+")",e.JavaScript.ORDER_ADDITION];default:o=Array(t.itemCount_);for(var i=0;i<t.itemCount_;i++)o[i]=e.JavaScript.valueToCode(t,"ADD"+i,e.JavaScript.ORDER_COMMA)||"''";return[t="["+o.join(",")+"].join('')",e.JavaScript.ORDER_FUNCTION_CALL]}},e.JavaScript.text_append=function(t){var o=e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE);return o+" = String("+o+") + String("+(t=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''")+");\n"},e.JavaScript.text_length=function(t){return[(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_isEmpty=function(t){return["!"+(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.text_indexOf=function(t){var o="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=e.JavaScript.valueToCode(t,"FIND",e.JavaScript.ORDER_NONE)||"''";return o=(e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+"."+o+"("+i+")",t.workspace.options.oneBasedIndex?[o+" + 1",e.JavaScript.ORDER_ADDITION]:[o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_charAt=function(t){var o=t.getFieldValue("WHERE")||"FROM_START",i=e.JavaScript.valueToCode(t,"VALUE","RANDOM"==o?e.JavaScript.ORDER_NONE:e.JavaScript.ORDER_MEMBER)||"''";switch(o){case"FIRST":return[i+".charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[i+".slice(-1)",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[i+".charAt("+(t=e.JavaScript.getAdjusted(t,"AT"))+")",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[i+".slice("+(t=e.JavaScript.getAdjusted(t,"AT",1,!0))+").charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[e.JavaScript.provideFunction_("textRandomLetter",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+i+")",e.JavaScript.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt)."},e.JavaScript.text.getIndex_=function(e,t,o){return"FIRST"==t?"0":"FROM_END"==t?e+".length - 1 - "+o:"LAST"==t?e+".length - 1":o},e.JavaScript.text_getSubstring=function(t){var o=e.JavaScript.valueToCode(t,"STRING",e.JavaScript.ORDER_FUNCTION_CALL)||"''",i=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"!=i||"LAST"!=n)if(o.match(/^'?\w+'?$/)||"FROM_END"!=i&&"LAST"!=i&&"FROM_END"!=n&&"LAST"!=n){switch(i){case"FROM_START":var r=e.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":r=o+".length - "+(r=e.JavaScript.getAdjusted(t,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":r="0";break;default:throw"Unhandled option (text_getSubstring)."}switch(n){case"FROM_START":t=e.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=o+".length - "+(t=e.JavaScript.getAdjusted(t,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=o+".length";break;default:throw"Unhandled option (text_getSubstring)."}o=o+".slice("+r+", "+t+")"}else{r=e.JavaScript.getAdjusted(t,"AT1"),t=e.JavaScript.getAdjusted(t,"AT2");var s=e.JavaScript.text.getIndex_,a={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=e.JavaScript.provideFunction_("subsequence"+a[i]+a[n],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==i||"FROM_START"==i?", at1":"")+("FROM_END"==n||"FROM_START"==n?", at2":"")+") {","  var start = "+s("sequence",i,"at1")+";","  var end = "+s("sequence",n,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+o+("FROM_END"==i||"FROM_START"==i?", "+r:"")+("FROM_END"==n||"FROM_START"==n?", "+t:"")+")"}return[o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_changeCase=function(t){var o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=e.JavaScript.valueToCode(t,"TEXT",o?e.JavaScript.ORDER_MEMBER:e.JavaScript.ORDER_NONE)||"''",[o?t+o:e.JavaScript.provideFunction_("textToTitleCase",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+t+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_trim=function(t){var o={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_print=function(t){return"window.alert("+(e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''")+");\n"},e.JavaScript.text_prompt_ext=function(t){var o="window.prompt("+(t.getField("TEXT")?e.JavaScript.quote_(t.getFieldValue("TEXT")):e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(o="parseFloat("+o+")"),[o,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_prompt=e.JavaScript.text_prompt_ext,e.JavaScript.text_count=function(t){var o=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''";return t=e.JavaScript.valueToCode(t,"SUB",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textCount",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+o+", "+t+")",e.JavaScript.ORDER_SUBTRACTION]},e.JavaScript.text_replace=function(t){var o=e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''",i=e.JavaScript.valueToCode(t,"FROM",e.JavaScript.ORDER_NONE)||"''";return t=e.JavaScript.valueToCode(t,"TO",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textReplace",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+o+", "+i+", "+t+")",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_reverse=function(t){return[(e.JavaScript.valueToCode(t,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",e.JavaScript.ORDER_MEMBER]},e.JavaScript.variables={},e.JavaScript.variables_get=function(t){return[e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.variables_set=function(t){var o=e.JavaScript.valueToCode(t,"VALUE",e.JavaScript.ORDER_ASSIGNMENT)||"0";return e.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),e.Variables.NAME_TYPE)+" = "+o+";\n"},e.JavaScript.variablesDynamic={},e.JavaScript.variables_get_dynamic=e.JavaScript.variables_get,e.JavaScript.variables_set_dynamic=e.JavaScript.variables_set,e.JavaScript}},function(e,t){e.exports=function(e){var t=e.goog;return e.Blocks={},e.Blocks.colour={},e.Constants={},e.Constants.Colour={},e.Constants.Colour.HUE=20,e.Blocks.colour.HUE=e.Constants.Colour.HUE,e.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",colour:"%{BKY_COLOUR_HUE}",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",colour:"%{BKY_COLOUR_HUE}",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",colour:"%{BKY_COLOUR_HUE}",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",colour:"%{BKY_COLOUR_HUE}",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),e.Blocks.lists={},e.Constants.Lists={},e.Constants.Lists.HUE=260,e.Blocks.lists.HUE=e.Constants.Lists.HUE,e.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",colour:"%{BKY_LISTS_HUE}",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",colour:"%{BKY_LISTS_HUE}",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,colour:"%{BKY_LISTS_HUE}",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:"%{BKY_LISTS_HUE}",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:"%{BKY_LISTS_HUE}",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),e.Blocks.lists_create_with={init:function(){this.setHelpUrl(e.Msg.LISTS_CREATE_WITH_HELPURL),this.setColour(e.Blocks.lists.HUE),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new e.Mutator(["lists_create_with_item"])),this.setTooltip(e.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("items",this.itemCount_),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},decompose:function(e){var t=e.newBlock("lists_create_with_container");t.initSvg();for(var o=t.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var n=e.newBlock("lists_create_with_item");n.initSvg(),o.connect(n.previousConnection),o=n.nextConnection}return t},compose:function(t){var o=t.getInputTargetBlock("STACK");for(t=[];o;)t.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var i=this.getInput("ADD"+o).connection.targetConnection;i&&-1==t.indexOf(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),o=0;o<this.itemCount_;o++)e.Mutator.reconnect(t[o],this,"ADD"+o)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");for(var t=0;e;){var o=this.getInput("ADD"+t);e.valueConnection_=o&&o.connection.targetConnection,t++,e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(e.Msg.LISTS_CREATE_EMPTY_TITLE);for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var o=this.appendValueInput("ADD"+t);0==t&&o.appendField(e.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},e.Blocks.lists_create_with_container={init:function(){this.setColour(e.Blocks.lists.HUE),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_create_with_item={init:function(){this.setColour(e.Blocks.lists.HUE),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_indexOf={init:function(){var t=[[e.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[e.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(e.Msg.LISTS_INDEX_OF_HELPURL),this.setColour(e.Blocks.lists.HUE),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new e.FieldDropdown(t),"END"),this.setInputsInline(!0);var o=this;this.setTooltip(function(){return e.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"0":"-1")})}},e.Blocks.lists_getIndex={init:function(){var t=[[e.Msg.LISTS_GET_INDEX_GET,"GET"],[e.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[e.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_GET_INDEX_HELPURL),this.setColour(e.Blocks.lists.HUE),t=new e.FieldDropdown(t,function(e){this.sourceBlock_.updateStatement_("REMOVE"==e)}),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),e.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var o=this;this.setTooltip(function(){var t=o.getFieldValue("MODE"),i=o.getFieldValue("WHERE"),n="";switch(t+" "+i){case"GET FROM_START":case"GET FROM_END":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":n=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!=i&&"FROM_END"!=i||(n+="  "+("FROM_START"==i?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),n})},mutationToDom:function(){var t=document.createElement("mutation");t.setAttribute("statement",!this.outputConnection);var o=this.getInput("AT").type==e.INPUT_VALUE;return t.setAttribute("at",o),t},domToMutation:function(e){var t="true"==e.getAttribute("statement");this.updateStatement_(t),e="false"!=e.getAttribute("at"),this.updateAt_(e)},updateStatement_:function(e){e!=!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new e.FieldDropdown(this.WHERE_OPTIONS,function(e){var o="FROM_START"==e||"FROM_END"==e;if(o!=t){var i=this.sourceBlock_;return i.updateAt_(o),i.setFieldValue(e,"WHERE"),null}});this.getInput("AT").appendField(o,"WHERE"),e.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_setIndex={init:function(){var t=[[e.Msg.LISTS_SET_INDEX_SET,"SET"],[e.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_SET_INDEX_HELPURL),this.setColour(e.Blocks.lists.HUE),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new e.FieldDropdown(t),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(e.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var o=this;this.setTooltip(function(){var t=o.getFieldValue("MODE"),i=o.getFieldValue("WHERE"),n="";switch(t+" "+i){case"SET FROM_START":case"SET FROM_END":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":n=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!=i&&"FROM_END"!=i||(n+="  "+e.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),n})},mutationToDom:function(){var t=document.createElement("mutation"),o=this.getInput("AT").type==e.INPUT_VALUE;return t.setAttribute("at",o),t},domToMutation:function(e){e="false"!=e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new e.FieldDropdown(this.WHERE_OPTIONS,function(e){var o="FROM_START"==e||"FROM_END"==e;if(o!=t){var i=this.sourceBlock_;return i.updateAt_(o),i.setFieldValue(e,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(o,"WHERE")}},e.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.LISTS_GET_SUBLIST_HELPURL),this.setColour(e.Blocks.lists.HUE),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var t=document.createElement("mutation"),o=this.getInput("AT1").type==e.INPUT_VALUE;return t.setAttribute("at1",o),o=this.getInput("AT2").type==e.INPUT_VALUE,t.setAttribute("at2",o),t},domToMutation:function(e){var t="true"==e.getAttribute("at1");e="true"==e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(t,o){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),o?(this.appendValueInput("AT"+t).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t);var i=new e.FieldDropdown(this["WHERE_OPTIONS_"+t],function(e){var i="FROM_START"==e||"FROM_END"==e;if(i!=o){var n=this.sourceBlock_;return n.updateAt_(t,i),n.setFieldValue(e,"WHERE"+t),null}});this.getInput("AT"+t).appendField(i,"WHERE"+t),1==t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_sort={init:function(){this.jsonInit({message0:e.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[e.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[e.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[e.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[e.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[e.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",colour:e.Blocks.lists.HUE,tooltip:e.Msg.LISTS_SORT_TOOLTIP,helpUrl:e.Msg.LISTS_SORT_HELPURL})}},e.Blocks.lists_split={init:function(){var t=this,o=new e.FieldDropdown([[e.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[e.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(e){t.updateType_(e)});this.setHelpUrl(e.Msg.LISTS_SPLIT_HELPURL),this.setColour(e.Blocks.lists.HUE),this.appendValueInput("INPUT").setCheck("String").appendField(o,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(e.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var o=t.getFieldValue("MODE");if("SPLIT"==o)return e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==o)return e.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw"Unknown mode: "+o})},updateType_:function(e){"SPLIT"==e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))}},e.Blocks.logic={},e.Constants.Logic={},e.Constants.Logic.HUE=210,e.Blocks.logic.HUE=e.Constants.Logic.HUE,e.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOGIC_HUE}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",colour:"%{BKY_LOGIC_HUE}",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",colour:"%{BKY_LOGIC_HUE}",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),e.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,colour:"%{BKY_LOGIC_HUE}",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),e.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},e.Extensions.register("logic_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Logic.TOOLTIPS_BY_OP)),e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var e=document.createElement("mutation");return this.elseifCount_&&e.setAttribute("elseif",this.elseifCount_),this.elseCount_&&e.setAttribute("else",1),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.updateShape_()},decompose:function(e){var t=e.newBlock("controls_if_if");t.initSvg();for(var o=t.nextConnection,i=1;i<=this.elseifCount_;i++){var n=e.newBlock("controls_if_elseif");n.initSvg(),o.connect(n.previousConnection),o=n.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),o.connect(e.previousConnection)),t},compose:function(t){var o=t.nextConnection.targetBlock();this.elseCount_=this.elseifCount_=0,t=[null];for(var i=[null],n=null;o;){switch(o.type){case"controls_if_elseif":this.elseifCount_++,t.push(o.valueConnection_),i.push(o.statementConnection_);break;case"controls_if_else":this.elseCount_++,n=o.statementConnection_;break;default:throw"Unknown block type."}o=o.nextConnection&&o.nextConnection.targetBlock()}for(this.updateShape_(),o=1;o<=this.elseifCount_;o++)e.Mutator.reconnect(t[o],this,"IF"+o),e.Mutator.reconnect(i[o],this,"DO"+o);e.Mutator.reconnect(n,this,"ELSE")},saveConnections:function(e){e=e.nextConnection.targetBlock();for(var t=1;e;){switch(e.type){case"controls_if_elseif":var o=this.getInput("IF"+t),i=this.getInput("DO"+t);e.valueConnection_=o&&o.connection.targetConnection,e.statementConnection_=i&&i.connection.targetConnection,t++;break;case"controls_if_else":i=this.getInput("ELSE"),e.statementConnection_=i&&i.connection.targetConnection;break;default:throw"Unknown block type."}e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var t=1;this.getInput("IF"+t);)this.removeInput("IF"+t),this.removeInput("DO"+t),t++;for(t=1;t<=this.elseifCount_;t++)this.appendValueInput("IF"+t).setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+t).appendField(e.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(e.Msg.CONTROLS_IF_MSG_ELSE)}},e.Extensions.registerMutator("controls_if_mutator",e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_4:"":e.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},e.Extensions.register("controls_if_tooltip",e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),e.Constants.Logic.fixLogicCompareRtlOpLabels=function(){var e={LT:"<",LTE:"",GT:">",GTE:""},o=this.getField("OP");if(o){o=o.getOptions();for(var i=0;i<o.length;++i){var n=o[i],r=e[n[1]];t.isString(n[0])&&r&&(n[0]=r)}}},e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={prevBlocks_:[null,null],onchange:function(t){var o=this.getInputTargetBlock("A"),i=this.getInputTargetBlock("B");if(o&&i&&!o.outputConnection.checkType_(i.outputConnection)){for(e.Events.setGroup(t.group),t=0;t<this.prevBlocks_.length;t++){var n=this.prevBlocks_[t];n!==o&&n!==i||(n.unplug(),n.bumpNeighbours_())}e.Events.setGroup(!1)}this.prevBlocks_[0]=o,this.prevBlocks_[1]=i}},e.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.RTL&&e.Constants.Logic.fixLogicCompareRtlOpLabels.apply(this),this.mixin(e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},e.Extensions.register("logic_compare",e.Constants.Logic.LOGIC_COMPARE_EXTENSION),e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(t){var o=this.getInputTargetBlock("THEN"),i=this.getInputTargetBlock("ELSE"),n=this.outputConnection.targetConnection;if((o||i)&&n)for(var r=0;2>r;r++){var s=1==r?o:i;s&&!s.outputConnection.checkType_(n)&&(e.Events.setGroup(t.group),n===this.prevParentConnection_?(this.unplug(),n.getSourceBlock().bumpNeighbours_()):(s.unplug(),s.bumpNeighbours_()),e.Events.setGroup(!1))}this.prevParentConnection_=n}},e.Extensions.registerMixin("logic_ternary",e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),e.Blocks.loops={},e.Constants.Loops={},e.Constants.Loops.HUE=120,e.Blocks.loops.HUE=e.Constants.Loops.HUE,e.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,colour:"%{BKY_LOOPS_HUE}",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),e.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},e.Extensions.register("controls_whileUntil_tooltip",e.Extensions.buildTooltipForDropdown("MODE",e.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},e.Extensions.register("controls_flow_tooltip",e.Extensions.buildTooltipForDropdown("FLOW",e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(o){var i=this.getFieldValue("VAR");if(!this.isCollapsed()&&null!=i){var n={enabled:!0};n.text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",i),(i=t.dom.createDom("field",null,i)).setAttribute("name","VAR"),(i=t.dom.createDom("block",null,i)).setAttribute("type","variables_get"),n.callback=e.ContextMenu.callbackFactory(this,i),o.push(n)}}},e.Extensions.registerMixin("contextMenu_newGetVariableBlock",e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),e.Extensions.register("controls_for_tooltip",e.Extensions.buildTooltipWithFieldValue("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),e.Extensions.register("controls_forEach_tooltip",e.Extensions.buildTooltipWithFieldValue("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],onchange:function(){if(this.workspace.isDragging&&!this.workspace.isDragging()){var t=!1,o=this;do{if(-1!=this.LOOP_TYPES.indexOf(o.type)){t=!0;break}o=o.getSurroundParent()}while(o);t?(this.setWarningText(null),this.isInFlyout||this.setDisabled(!1)):(this.setWarningText(e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0))}}},e.Extensions.registerMixin("controls_flow_in_loop_check",e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),e.Blocks.math={},e.Constants.Math={},e.Constants.Math.HUE=230,e.Blocks.math.HUE=e.Constants.Math.HUE,e.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,colour:"%{BKY_VARIABLES_HUE}",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",colour:"%{BKY_MATH_HUE}",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",colour:"%{BKY_MATH_HUE}",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"}]),e.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},e.Extensions.register("math_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Math.TOOLTIPS_BY_OP)),e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var e=document.createElement("mutation"),t="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",t),e},domToMutation:function(e){e="true"==e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){var t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}},e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(e){this.sourceBlock_.updateShape_("DIVISIBLE_BY"==e)})},e.Extensions.registerMutator("math_is_divisibleby_mutator",e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),e.Constants.Math.CHANGE_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return e.Msg.MATH_CHANGE_TOOLTIP.replace("%1",this.getFieldValue("VAR"))}.bind(this))},e.Extensions.register("math_change_tooltip",e.Extensions.buildTooltipWithFieldValue("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),e.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(e){"MODE"==e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){this.updateType_(e.getAttribute("op"))}},e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))},e.Extensions.registerMutator("math_modes_of_list_mutator",e.Constants.Math.LIST_MODES_MUTATOR_MIXIN,e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),e.Blocks.procedures={},e.Blocks.procedures.HUE=290,e.Blocks.procedures_defnoreturn={init:function(){var t=new e.FieldTextInput("",e.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setColour(e.Blocks.procedures.HUE),this.setTooltip(e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(t){this.hasStatements_!==t&&(t?(this.appendStatementInput("STACK").appendField(e.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=t)},updateParams_:function(){for(var t=!1,o={},i=0;i<this.arguments_.length;i++){if(o["arg_"+this.arguments_[i].toLowerCase()]){t=!0;break}o["arg_"+this.arguments_[i].toLowerCase()]=!0}t?this.setWarningText(e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null),t="",this.arguments_.length&&(t=e.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),e.Events.disable();try{this.setFieldValue(t,"PARAMS")}finally{e.Events.enable()}},mutationToDom:function(e){var t=document.createElement("mutation");e&&t.setAttribute("name",this.getFieldValue("NAME"));for(var o=0;o<this.argumentVarModels_.length;o++){var i=document.createElement("arg"),n=this.argumentVarModels_[o];i.setAttribute("name",n.name),i.setAttribute("varId",n.getId()),e&&this.paramIds_&&i.setAttribute("paramId",this.paramIds_[o]),t.appendChild(i)}return this.hasStatements_||t.setAttribute("statements","false"),t},domToMutation:function(t){this.arguments_=[],this.argumentVarModels_=[];for(var o,i=0;o=t.childNodes[i];i++)if("arg"==o.nodeName.toLowerCase()){var n=o.getAttribute("name");o=o.getAttribute("varId"),this.arguments_.push(n),n=e.Variables.getOrCreateVariablePackage(this.workspace,o,n,""),this.argumentVarModels_.push(n)}this.updateParams_(),e.Procedures.mutateCallers(this),this.setStatements_("false"!==t.getAttribute("statements"))},decompose:function(t){var o=t.newBlock("procedures_mutatorcontainer");o.initSvg(),this.getInput("RETURN")?o.setFieldValue(this.hasStatements_?"TRUE":"FALSE","STATEMENTS"):o.getInput("STATEMENT_INPUT").setVisible(!1);for(var i=o.getInput("STACK").connection,n=0;n<this.arguments_.length;n++){var r=t.newBlock("procedures_mutatorarg");r.initSvg(),r.setFieldValue(this.arguments_[n],"NAME"),r.oldLocation=n,i.connect(r.previousConnection),i=r.nextConnection}return e.Procedures.mutateCallers(this),o},compose:function(t){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var o=t.getInputTargetBlock("STACK");o;){var i=o.getFieldValue("NAME");this.arguments_.push(i),i=this.workspace.getVariable(i,""),this.argumentVarModels_.push(i),this.paramIds_.push(o.id),o=o.nextConnection&&o.nextConnection.targetBlock()}this.updateParams_(),e.Procedures.mutateCallers(this),null!==(t=t.getFieldValue("STATEMENTS"))&&(t="TRUE"==t,this.hasStatements_!=t)&&(t?(this.setStatements_(!0),e.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(t=this.getInput("STACK").connection,(this.statementConnection_=t.targetConnection)&&((t=t.targetBlock()).unplug(),t.bumpNeighbours_()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,t){var o=this.workspace.getVariableById(e);if(""==o.type){o=o.name;for(var i=this.workspace.getVariableById(t),n=!1,r=0;r<this.argumentVarModels_.length;r++)this.argumentVarModels_[r].getId()==e&&(this.arguments_[r]=i.name,this.argumentVarModels_[r]=i,n=!0);n&&this.displayRenamedVar_(o,i.name)}},updateVarName:function(e){for(var t=e.name,o=!1,i=0;i<this.argumentVarModels_.length;i++)if(this.argumentVarModels_[i].getId()==e.getId()){var n=this.arguments_[i];this.arguments_[i]=t,o=!0}o&&this.displayRenamedVar_(n,t)},displayRenamedVar_:function(t,o){if(this.updateParams_(),this.mutator.isVisible())for(var i,n=this.mutator.workspace_.getAllBlocks(),r=0;i=n[r];r++)"procedures_mutatorarg"==i.type&&e.Names.equals(t,i.getFieldValue("NAME"))&&i.setFieldValue(o,"NAME")},customContextMenu:function(o){var i={enabled:!0},n=this.getFieldValue("NAME");i.text=e.Msg.PROCEDURES_CREATE_DO.replace("%1",n);var r=t.dom.createDom("mutation");r.setAttribute("name",n);for(var s=0;s<this.arguments_.length;s++)(n=t.dom.createDom("arg")).setAttribute("name",this.arguments_[s]),r.appendChild(n);if((r=t.dom.createDom("block",null,r)).setAttribute("type",this.callType_),i.callback=e.ContextMenu.callbackFactory(this,r),o.push(i),!this.isCollapsed())for(s=0;s<this.arguments_.length;s++)i={enabled:!0},n=this.arguments_[s],i.text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",n),(r=t.dom.createDom("field",null,n)).setAttribute("name","VAR"),(r=t.dom.createDom("block",null,r)).setAttribute("type","variables_get"),i.callback=e.ContextMenu.callbackFactory(this,r),o.push(i)},callType_:"procedures_callnoreturn"},e.Blocks.procedures_defreturn={init:function(){var t=new e.FieldTextInput("",e.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(e.ALIGN_RIGHT).appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setColour(e.Blocks.procedures.HUE),this.setTooltip(e.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:e.Blocks.procedures_defnoreturn.setStatements_,updateParams_:e.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:e.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_defnoreturn.domToMutation,decompose:e.Blocks.procedures_defnoreturn.decompose,compose:e.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:e.Blocks.procedures_defnoreturn.getVars,getVarModels:e.Blocks.procedures_defnoreturn.getVarModels,renameVarById:e.Blocks.procedures_defnoreturn.renameVarById,updateVarName:e.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:e.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:e.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},e.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(e.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new e.FieldCheckbox("TRUE"),"STATEMENTS"),this.setColour(e.Blocks.procedures.HUE),this.setTooltip(e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.procedures_mutatorarg={init:function(){var t=new e.FieldTextInput("x",this.validator_);t.oldShowEditorFn_=t.showEditor_,t.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(t,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(e.Blocks.procedures.HUE),this.setTooltip(e.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,t.onFinishEditing_=this.deleteIntermediateVars_,t.createdVariables_=[],t.onFinishEditing_("x")},validator_:function(t){var o=e.Mutator.findParentWs(this.sourceBlock_.workspace);if(!(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;var i=o.getVariable(t,"");return i&&i.name!=t&&o.renameVarById(i.getId(),t),i||(i=o.createVariable(t,""))&&this.createdVariables_&&this.createdVariables_.push(i),t},deleteIntermediateVars_:function(t){var o=e.Mutator.findParentWs(this.sourceBlock_.workspace);if(o)for(var i=0;i<this.createdVariables_.length;i++){var n=this.createdVariables_[i];n.name!=t&&o.deleteVariableById(n.getId())}}},e.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField(this.id,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(e.Blocks.procedures.HUE),this.setHelpUrl(e.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(t,o){e.Names.equals(t,this.getProcedureCall())&&(this.setFieldValue(o,"NAME"),this.setTooltip((this.outputConnection?e.Msg.PROCEDURES_CALLRETURN_TOOLTIP:e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",o)))},setProcedureParameters_:function(o,i){var n=e.Procedures.getDefinition(this.getProcedureCall(),this.workspace),r=n&&n.mutator&&n.mutator.isVisible();if(r||(this.quarkConnections_={},this.quarkIds_=null),i)if(t.array.equals(this.arguments_,o))this.quarkIds_=i;else{if(i.length!=o.length)throw"Error: paramNames and paramIds must be the same length.";this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},o.join("\n")==this.arguments_.join("\n")?this.quarkIds_=i:this.quarkIds_=[]),n=this.rendered,this.rendered=!1;for(var s=0;s<this.arguments_.length;s++){var a=this.getInput("ARG"+s);a&&(a=a.connection.targetConnection,this.quarkConnections_[this.quarkIds_[s]]=a,r&&a&&-1==i.indexOf(this.quarkIds_[s])&&(a.disconnect(),a.getSourceBlock().bumpNeighbours_()))}for(this.arguments_=[].concat(o),this.argumentVarModels_=[],s=0;s<this.arguments_.length;s++)r=e.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[s],""),this.argumentVarModels_.push(r);if(this.updateShape_(),this.quarkIds_=i)for(s=0;s<this.arguments_.length;s++)(r=this.quarkIds_[s])in this.quarkConnections_&&(a=this.quarkConnections_[r],e.Mutator.reconnect(a,this,"ARG"+s)||delete this.quarkConnections_[r]);(this.rendered=n)&&this.render()}},updateShape_:function(){for(var t=0;t<this.arguments_.length;t++){var o=this.getField("ARGNAME"+t);if(o){e.Events.disable();try{o.setValue(this.arguments_[t])}finally{e.Events.enable()}}else o=new e.FieldLabel(this.arguments_[t]),this.appendValueInput("ARG"+t).setAlign(e.ALIGN_RIGHT).appendField(o,"ARGNAME"+t).init()}for(;this.getInput("ARG"+t);)this.removeInput("ARG"+t),t++;(t=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(t.appendField(e.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),t.init()):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom:function(){var e=document.createElement("mutation");e.setAttribute("name",this.getProcedureCall());for(var t=0;t<this.arguments_.length;t++){var o=document.createElement("arg");o.setAttribute("name",this.arguments_[t]),e.appendChild(o)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];for(var o,i=[],n=0;o=e.childNodes[n];n++)"arg"==o.nodeName.toLowerCase()&&(t.push(o.getAttribute("name")),i.push(o.getAttribute("paramId")));this.setProcedureParameters_(t,i)},getVarModels:function(){return this.argumentVarModels_},onchange:function(o){if(this.workspace&&!this.workspace.isFlyout)if(o.type==e.Events.BLOCK_CREATE&&-1!=o.ids.indexOf(this.id)){var i=this.getProcedureCall();if(!(i=e.Procedures.getDefinition(i,this.workspace))||i.type==this.defType_&&JSON.stringify(i.arguments_)==JSON.stringify(this.arguments_)||(i=null),!i){e.Events.setGroup(o.group),o=t.dom.createDom("xml"),(i=t.dom.createDom("block")).setAttribute("type",this.defType_);var n=this.getRelativeToSurfaceXY(),r=n.y+2*e.SNAP_RADIUS;i.setAttribute("x",n.x+e.SNAP_RADIUS*(this.RTL?-1:1)),i.setAttribute("y",r),n=this.mutationToDom(),i.appendChild(n),(n=t.dom.createDom("field")).setAttribute("name","NAME"),n.appendChild(document.createTextNode(this.getProcedureCall())),i.appendChild(n),o.appendChild(i),e.Xml.domToWorkspace(o,this.workspace),e.Events.setGroup(!1)}}else o.type==e.Events.BLOCK_DELETE&&(i=this.getProcedureCall(),(i=e.Procedures.getDefinition(i,this.workspace))||(e.Events.setGroup(o.group),this.dispose(!0,!1),e.Events.setGroup(!1)))},customContextMenu:function(t){var o={enabled:!0};o.text=e.Msg.PROCEDURES_HIGHLIGHT_DEF;var i=this.getProcedureCall(),n=this.workspace;o.callback=function(){var t=e.Procedures.getDefinition(i,n);t&&t.select()},t.push(o)},defType_:"procedures_defnoreturn"},e.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setColour(e.Blocks.procedures.HUE),this.setHelpUrl(e.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:e.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:e.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:e.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:e.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:e.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_callnoreturn.domToMutation,getVarModels:e.Blocks.procedures_callnoreturn.getVarModels,onchange:e.Blocks.procedures_callnoreturn.onchange,customContextMenu:e.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},e.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(e.Blocks.procedures.HUE),this.setTooltip(e.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("value",Number(this.hasReturnValue_)),e},domToMutation:function(t){this.hasReturnValue_=1==t.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(){if(this.workspace.isDragging&&!this.workspace.isDragging()){var t=!1,o=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(o.type)){t=!0;break}o=o.getSurroundParent()}while(o);t?("procedures_defnoreturn"==o.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=o.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setDisabled(!1)):(this.setWarningText(e.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},e.Blocks.texts={},e.Constants.Text={},e.Constants.Text.HUE=160,e.Blocks.texts.HUE=e.Constants.Text.HUE,e.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",colour:"%{BKY_TEXTS_HUE}",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",colour:"%{BKY_TEXTS_HUE}",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],colour:"%{BKY_TEXTS_HUE}",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,colour:"%{BKY_TEXTS_HUE}",tooltip:"{%BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:"%{BKY_TEXTS_HUE}",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:"%{BKY_TEXTS_HUE}",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:"%{BKY_TEXTS_HUE}",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",colour:"%{BKY_TEXTS_HUE}",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",colour:"%{BKY_TEXTS_HUE}",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),e.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setColour(e.Blocks.texts.HUE),this.appendValueInput("STRING").setCheck("String").appendField(e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var t=document.createElement("mutation"),o=this.getInput("AT1").type==e.INPUT_VALUE;return t.setAttribute("at1",o),o=this.getInput("AT2").type==e.INPUT_VALUE,t.setAttribute("at2",o),t},domToMutation:function(e){var t="true"==e.getAttribute("at1");e="true"==e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(t,o){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),o?(this.appendValueInput("AT"+t).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t),2==t&&e.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL));var i=new e.FieldDropdown(this["WHERE_OPTIONS_"+t],function(e){var i="FROM_START"==e||"FROM_END"==e;if(i!=o){var n=this.sourceBlock_;return n.updateAt_(t,i),n.setFieldValue(e,"WHERE"+t),null}});this.getInput("AT"+t).appendField(i,"WHERE"+t),1==t&&this.moveInputBefore("AT1","AT2")}},e.Blocks.text_changeCase={init:function(){var t=[[e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(e.Msg.TEXT_CHANGECASE_HELPURL),this.setColour(e.Blocks.texts.HUE),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(t),"CASE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_CHANGECASE_TOOLTIP)}},e.Blocks.text_trim={init:function(){var t=[[e.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[e.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[e.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(e.Msg.TEXT_TRIM_HELPURL),this.setColour(e.Blocks.texts.HUE),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(t),"MODE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_TRIM_TOOLTIP)}},e.Blocks.text_print={init:function(){this.jsonInit({message0:e.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:e.Blocks.texts.HUE,tooltip:e.Msg.TEXT_PRINT_TOOLTIP,helpUrl:e.Msg.TEXT_PRINT_HELPURL})}},e.Blocks.text_prompt_ext={init:function(){var t=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setColour(e.Blocks.texts.HUE);var o=this;t=new e.FieldDropdown(t,function(e){o.updateType_(e)}),this.appendValueInput("TEXT").appendField(t,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(e){this.outputConnection.setCheck("NUMBER"==e?"Number":"String")},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}},e.Blocks.text_prompt={init:function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN);var t=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],o=this;this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setColour(e.Blocks.texts.HUE),t=new e.FieldDropdown(t,function(e){o.updateType_(e)}),this.appendDummyInput().appendField(t,"TYPE").appendField(this.newQuote_(!0)).appendField(new e.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:e.Blocks.text_prompt_ext.updateType_,mutationToDom:e.Blocks.text_prompt_ext.mutationToDom,domToMutation:e.Blocks.text_prompt_ext.domToMutation},e.Blocks.text_count={init:function(){this.jsonInit({message0:e.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,colour:e.Blocks.texts.HUE,tooltip:e.Msg.TEXT_COUNT_TOOLTIP,helpUrl:e.Msg.TEXT_COUNT_HELPURL})}},e.Blocks.text_replace={init:function(){this.jsonInit({message0:e.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,colour:e.Blocks.texts.HUE,tooltip:e.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:e.Msg.TEXT_REPLACE_HELPURL})}},e.Blocks.text_reverse={init:function(){this.jsonInit({message0:e.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,colour:e.Blocks.texts.HUE,tooltip:e.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:e.Msg.TEXT_REVERSE_HELPURL})}},e.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(var t,o=0;t=this.inputList[o];o++)for(var i,n=0;i=t.fieldRow[n];n++)if(e==i.name)return t.insertFieldAt(n,this.newQuote_(!0)),void t.insertFieldAt(n+2,this.newQuote_(!1));console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(t){return t=this.RTL?!t:t,new e.FieldImage(t?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,t?"":"")}},e.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("items",this.itemCount_),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},decompose:function(e){var t=e.newBlock("text_create_join_container");t.initSvg();for(var o=t.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var n=e.newBlock("text_create_join_item");n.initSvg(),o.connect(n.previousConnection),o=n.nextConnection}return t},compose:function(t){var o=t.getInputTargetBlock("STACK");for(t=[];o;)t.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var i=this.getInput("ADD"+o).connection.targetConnection;i&&-1==t.indexOf(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),o=0;o<this.itemCount_;o++)e.Mutator.reconnect(t[o],this,"ADD"+o)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");for(var t=0;e;){var o=this.getInput("ADD"+t);e.valueConnection_=o&&o.connection.targetConnection,t++,e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var o=this.appendValueInput("ADD"+t);0==t&&o.appendField(e.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},e.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new e.Mutator(["text_create_join_item"]))},e.Constants.Text.TEXT_APPEND_TOOLTIP_EXTENSION=function(){var t=this;this.setTooltip(function(){return e.Msg.TEXT_APPEND_TOOLTIP?e.Msg.TEXT_APPEND_TOOLTIP.replace("%1",t.getFieldValue("VAR")):""})},e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var t=this;this.setTooltip(function(){return e.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",t.workspace.options.oneBasedIndex?"0":"-1")})},e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("at",!!this.isAt_),e},domToMutation:function(e){e="false"!=e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(t){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),t&&(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)),e.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_CHARAT_TAIL)),this.isAt_=t}},e.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(e){var t="FROM_START"==e||"FROM_END"==e;if(t!=this.isAt_){var o=this.sourceBlock_;return o.updateAt_(t),o.setFieldValue(e,"WHERE"),null}}),this.updateAt_(!0);var t=this;this.setTooltip(function(){var o=t.getFieldValue("WHERE"),i=e.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==o||"FROM_END"==o)&&(o="FROM_START"==o?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(i+="  "+o.replace("%1",t.workspace.options.oneBasedIndex?"#1":"#0")),i})},e.Extensions.register("text_indexOf_tooltip",e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),e.Extensions.register("text_quotes",e.Constants.Text.TEXT_QUOTES_EXTENSION),e.Extensions.register("text_append_tooltip",e.Constants.Text.TEXT_APPEND_TOOLTIP_EXTENSION),e.Extensions.registerMutator("text_join_mutator",e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,e.Constants.Text.TEXT_JOIN_EXTENSION),e.Extensions.registerMutator("text_charAt_mutator",e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,e.Constants.Text.TEXT_CHARAT_EXTENSION),e.Blocks.variables={},e.Constants.Variables={},e.Constants.Variables.HUE=330,e.Blocks.variables.HUE=e.Constants.Variables.HUE,e.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,colour:"%{BKY_VARIABLES_HUE}",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,colour:"%{BKY_VARIABLES_HUE}",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(o){if(!this.isInFlyout){if("variables_get"==this.type)var i="variables_set",n=e.Msg.VARIABLES_GET_CREATE_SET;else i="variables_get",n=e.Msg.VARIABLES_SET_CREATE_GET;var r={enabled:0<this.workspace.remainingCapacity()},s=this.getFieldValue("VAR");r.text=n.replace("%1",s),(n=t.dom.createDom("field",null,s)).setAttribute("name","VAR"),(n=t.dom.createDom("block",null,n)).setAttribute("type",i),r.callback=e.ContextMenu.callbackFactory(this,n),o.push(r)}}},e.Extensions.registerMixin("contextMenu_variableSetterGetter",e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Constants.VariablesDynamic={},e.Constants.VariablesDynamic.HUE=310,e.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,colour:"%{BKY_VARIABLES_DYNAMIC_HUE}",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,colour:"%{BKY_VARIABLES_DYNAMIC_HUE}",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(o){if(!this.isInFlyout){if("variables_get_dynamic"==this.type)var i="variables_set_dynamic",n=e.Msg.VARIABLES_GET_CREATE_SET;else i="variables_get_dynamic",n=e.Msg.VARIABLES_SET_CREATE_GET;var r={enabled:0<this.workspace.remainingCapacity()},s=this.getFieldValue("VAR");r.text=n.replace("%1",s),(n=t.dom.createDom("field",null,s)).setAttribute("name","VAR"),s=this.workspace.getVariable(s),n.setAttribute("variabletype",s.type),(s=t.dom.createDom("block",null,n)).setAttribute("type",i),r.callback=e.ContextMenu.callbackFactory(this,s),o.push(r)}},onchange:function(){var e=this.getFieldValue("VAR");e=this.workspace.getVariableById(e),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(e.type):this.getInput("VALUE").connection.setCheck(e.type)}},e.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Blocks}},function(e,t){var o={Msg:{}};e.exports=function(){"use strict";return o.Msg.ADD_COMMENT="Add Comment",o.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",o.Msg.CHANGE_VALUE_TITLE="Change value:",o.Msg.CLEAN_UP="Clean up Blocks",o.Msg.COLLAPSE_ALL="Collapse Blocks",o.Msg.COLLAPSE_BLOCK="Collapse Block",o.Msg.COLOUR_BLEND_COLOUR1="colour 1",o.Msg.COLOUR_BLEND_COLOUR2="colour 2",o.Msg.COLOUR_BLEND_HELPURL="http://meyerweb.com/eric/tools/color-blend/",o.Msg.COLOUR_BLEND_RATIO="ratio",o.Msg.COLOUR_BLEND_TITLE="blend",o.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",o.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",o.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",o.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",o.Msg.COLOUR_RANDOM_TITLE="random colour",o.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",o.Msg.COLOUR_RGB_BLUE="blue",o.Msg.COLOUR_RGB_GREEN="green",o.Msg.COLOUR_RGB_HELPURL="http://www.december.com/html/spec/colorper.html",o.Msg.COLOUR_RGB_RED="red",o.Msg.COLOUR_RGB_TITLE="colour with",o.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",o.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",o.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",o.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",o.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",o.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",o.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",o.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",o.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",o.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",o.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",o.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",o.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",o.Msg.CONTROLS_IF_MSG_ELSE="else",o.Msg.CONTROLS_IF_MSG_ELSEIF="else if",o.Msg.CONTROLS_IF_MSG_IF="if",o.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",o.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",o.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",o.Msg.CONTROLS_REPEAT_INPUT_DO="do",o.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",o.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",o.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",o.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",o.Msg.DELETE_BLOCK="Delete Block",o.Msg.DELETE_VARIABLE="Delete the '%1' variable",o.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",o.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",o.Msg.DISABLE_BLOCK="Disable Block",o.Msg.DUPLICATE_BLOCK="Duplicate",o.Msg.ENABLE_BLOCK="Enable Block",o.Msg.EXPAND_ALL="Expand Blocks",o.Msg.EXPAND_BLOCK="Expand Block",o.Msg.EXTERNAL_INPUTS="External Inputs",o.Msg.HELP="Help",o.Msg.INLINE_INPUTS="Inline Inputs",o.Msg.IOS_CANCEL="Cancel",o.Msg.IOS_ERROR="Error",o.Msg.IOS_OK="OK",o.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",o.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",o.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",o.Msg.IOS_PROCEDURES_INPUTS="INPUTS",o.Msg.IOS_VARIABLES_ADD_BUTTON="Add",o.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",o.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",o.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",o.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",o.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",o.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",o.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",o.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",o.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",o.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",o.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",o.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",o.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",o.Msg.LISTS_GET_INDEX_FIRST="first",o.Msg.LISTS_GET_INDEX_FROM_END="# from end",o.Msg.LISTS_GET_INDEX_FROM_START="#",o.Msg.LISTS_GET_INDEX_GET="get",o.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",o.Msg.LISTS_GET_INDEX_LAST="last",o.Msg.LISTS_GET_INDEX_RANDOM="random",o.Msg.LISTS_GET_INDEX_REMOVE="remove",o.Msg.LISTS_GET_INDEX_TAIL="",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",o.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",o.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",o.Msg.LISTS_GET_SUBLIST_END_LAST="to last",o.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",o.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",o.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",o.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",o.Msg.LISTS_GET_SUBLIST_TAIL="",o.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",o.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",o.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",o.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",o.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",o.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",o.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",o.Msg.LISTS_INLIST="in list",o.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",o.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",o.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",o.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",o.Msg.LISTS_LENGTH_TITLE="length of %1",o.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",o.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",o.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",o.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",o.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",o.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",o.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",o.Msg.LISTS_SET_INDEX_INPUT_TO="as",o.Msg.LISTS_SET_INDEX_INSERT="insert at",o.Msg.LISTS_SET_INDEX_SET="set",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",o.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",o.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",o.Msg.LISTS_SORT_ORDER_DESCENDING="descending",o.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",o.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",o.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",o.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",o.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",o.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",o.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",o.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",o.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",o.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",o.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",o.Msg.LOGIC_BOOLEAN_FALSE="false",o.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",o.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",o.Msg.LOGIC_BOOLEAN_TRUE="true",o.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",o.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",o.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",o.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",o.Msg.LOGIC_NEGATE_TITLE="not %1",o.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",o.Msg.LOGIC_NULL="null",o.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",o.Msg.LOGIC_NULL_TOOLTIP="Returns null.",o.Msg.LOGIC_OPERATION_AND="and",o.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",o.Msg.LOGIC_OPERATION_OR="or",o.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",o.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",o.Msg.LOGIC_TERNARY_CONDITION="test",o.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",o.Msg.LOGIC_TERNARY_IF_FALSE="if false",o.Msg.LOGIC_TERNARY_IF_TRUE="if true",o.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",o.Msg.MATH_ADDITION_SYMBOL="+",o.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",o.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",o.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",o.Msg.MATH_CHANGE_TITLE="change %1 by %2",o.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",o.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",o.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",o.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",o.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",o.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",o.Msg.MATH_DIVISION_SYMBOL="",o.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",o.Msg.MATH_IS_EVEN="is even",o.Msg.MATH_IS_NEGATIVE="is negative",o.Msg.MATH_IS_ODD="is odd",o.Msg.MATH_IS_POSITIVE="is positive",o.Msg.MATH_IS_PRIME="is prime",o.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",o.Msg.MATH_IS_WHOLE="is whole",o.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",o.Msg.MATH_MODULO_TITLE="remainder of %1  %2",o.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",o.Msg.MATH_MULTIPLICATION_SYMBOL="",o.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",o.Msg.MATH_NUMBER_TOOLTIP="A number.",o.Msg.MATH_ONLIST_HELPURL="",o.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",o.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",o.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",o.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",o.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",o.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",o.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",o.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",o.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",o.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",o.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",o.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",o.Msg.MATH_POWER_SYMBOL="^",o.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",o.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",o.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",o.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",o.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",o.Msg.MATH_ROUND_OPERATOR_ROUND="round",o.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",o.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",o.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",o.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",o.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",o.Msg.MATH_SINGLE_OP_ROOT="square root",o.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",o.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",o.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",o.Msg.MATH_SUBTRACTION_SYMBOL="-",o.Msg.MATH_TRIG_ACOS="acos",o.Msg.MATH_TRIG_ASIN="asin",o.Msg.MATH_TRIG_ATAN="atan",o.Msg.MATH_TRIG_COS="cos",o.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",o.Msg.MATH_TRIG_SIN="sin",o.Msg.MATH_TRIG_TAN="tan",o.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",o.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",o.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",o.Msg.NEW_NUMBER_VARIABLE="Create number variable...",o.Msg.NEW_STRING_VARIABLE="Create string variable...",o.Msg.NEW_VARIABLE="Create variable...",o.Msg.NEW_VARIABLE_TITLE="New variable name:",o.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",o.Msg.ORDINAL_NUMBER_SUFFIX="",o.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",o.Msg.PROCEDURES_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",o.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",o.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CREATE_DO="Create '%1'",o.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",o.Msg.PROCEDURES_DEFNORETURN_DO="",o.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",o.Msg.PROCEDURES_DEFNORETURN_TITLE="to",o.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",o.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFRETURN_RETURN="return",o.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",o.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",o.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",o.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",o.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",o.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",o.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",o.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",o.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",o.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",o.Msg.REDO="Redo",o.Msg.REMOVE_COMMENT="Remove Comment",o.Msg.RENAME_VARIABLE="Rename variable...",o.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",o.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_APPEND_TITLE="to %1 append text %2",o.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",o.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",o.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",o.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",o.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",o.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",o.Msg.TEXT_CHARAT_FIRST="get first letter",o.Msg.TEXT_CHARAT_FROM_END="get letter # from end",o.Msg.TEXT_CHARAT_FROM_START="get letter #",o.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",o.Msg.TEXT_CHARAT_LAST="get last letter",o.Msg.TEXT_CHARAT_RANDOM="get random letter",o.Msg.TEXT_CHARAT_TAIL="",o.Msg.TEXT_CHARAT_TITLE="in text %1 %2",o.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",o.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",o.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",o.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",o.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",o.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",o.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",o.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",o.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",o.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",o.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",o.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",o.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",o.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",o.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",o.Msg.TEXT_GET_SUBSTRING_TAIL="",o.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",o.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",o.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",o.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",o.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",o.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",o.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",o.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",o.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",o.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",o.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",o.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",o.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_LENGTH_TITLE="length of %1",o.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",o.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",o.Msg.TEXT_PRINT_TITLE="print %1",o.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",o.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",o.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",o.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",o.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",o.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",o.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",o.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",o.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",o.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",o.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",o.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",o.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",o.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",o.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",o.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",o.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",o.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",o.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",o.Msg.TODAY="Today",o.Msg.UNDO="Undo",o.Msg.VARIABLES_DEFAULT_NAME="item",o.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",o.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",o.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",o.Msg.VARIABLES_SET="set %1 to %2",o.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",o.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",o.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",o.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",o.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",o.Msg.PROCEDURES_DEFRETURN_TITLE=o.Msg.PROCEDURES_DEFNORETURN_TITLE,o.Msg.CONTROLS_IF_IF_TITLE_IF=o.Msg.CONTROLS_IF_MSG_IF,o.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_IF_MSG_THEN=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=o.Msg.CONTROLS_IF_MSG_ELSE,o.Msg.PROCEDURES_DEFRETURN_PROCEDURE=o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,o.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.MATH_CHANGE_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.PROCEDURES_DEFRETURN_DO=o.Msg.PROCEDURES_DEFNORETURN_DO,o.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=o.Msg.CONTROLS_IF_MSG_ELSEIF,o.Msg.LISTS_GET_INDEX_HELPURL=o.Msg.LISTS_INDEX_OF_HELPURL,o.Msg.CONTROLS_FOREACH_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.CONTROLS_FOR_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.LISTS_CREATE_WITH_ITEM_TITLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.TEXT_APPEND_VARIABLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.PROCEDURES_DEFRETURN_COMMENT=o.Msg.PROCEDURES_DEFNORETURN_COMMENT,o.Msg.MATH_HUE="230",o.Msg.LOOPS_HUE="120",o.Msg.LISTS_HUE="260",o.Msg.LOGIC_HUE="210",o.Msg.VARIABLES_HUE="330",o.Msg.TEXTS_HUE="160",o.Msg.PROCEDURES_HUE="290",o.Msg.COLOUR_HUE="20",o.Msg.VARIABLES_DYNAMIC_HUE="310",o.Msg}},function(module,exports){module.exports=function(){"use strict";var $jscomp=$jscomp||{};$jscomp.scope={};var COMPILED=!0,goog=goog||{};goog.global=window,goog.isDef=function(e){return void 0!==e},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.exportPath_=function(e,t,o){e=e.split("."),o=o||goog.global,e[0]in o||!o.execScript||o.execScript("var "+e[0]);for(var i;e.length&&(i=e.shift());)!e.length&&goog.isDef(t)?o[i]=t:o=o[i]&&o[i]!==Object.prototype[i]?o[i]:o[i]={}},goog.define=function(e,t){var o=t;if(!COMPILED){var i=goog.global.CLOSURE_UNCOMPILED_DEFINES,n=goog.global.CLOSURE_DEFINES;i&&void 0===i.nodeType&&Object.prototype.hasOwnProperty.call(i,e)?o=i[e]:n&&void 0===n.nodeType&&Object.prototype.hasOwnProperty.call(n,e)&&(o=n[e])}goog.exportPath_(e,o)},goog.DEBUG=!1,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var o=e;(o=o.substring(0,o.lastIndexOf(".")))&&!goog.getObjectByName(o);)goog.implicitNamespaces_[o]=!0}goog.exportPath_(e,t)},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e];if(!goog.implicitNamespaces_[e])return null!=(e=goog.getObjectByName(e))?e:null}return null},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){for(var o=e.split("."),i=t||goog.global,n=0;n<o.length;n++)if(i=i[o[n]],!goog.isDefAndNotNull(i))return null;return i},goog.globalize=function(e,t){var o,i=t||goog.global;for(o in e)i[o]=e[o]},goog.addDependency=function(e,t,o,i){if(goog.DEPENDENCIES_ENABLED){var n=goog.getLoader_();n&&n.addDependency(e,t,o,i)}},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_&&goog.getLoader_().earlyProcessLoad(e),!COMPILED){if(goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{var o=goog.getLoader_();o?o.load(e):goog.logToConsole_("Could not load "+e+" because there is no debug loader.")}finally{goog.moduleLoaderState_=t}}return null}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.TRANSPILER="transpile.js",goog.DEBUG_LOADER="",goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(e){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(e){return"(function(){"+e+"\n;})();\n"},goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1},goog.isFunction(e))var o=e.call(void 0,{});else{if(!goog.isString(e))throw Error("Invalid module definition");goog.useSafari10Workaround()&&(e=goog.workaroundSafari10EvalBug(e)),o=goog.loadModuleFromSource_.call(void 0,e)}var i=goog.moduleLoaderState_.moduleName;if(!goog.isString(i)||!i)throw Error('Invalid module name "'+i+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(i,o):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof o&&null!=o&&Object.seal(o),goog.loadedModules_[i]=o}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.transpile_=function(a,b){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);if(f){if(function(){eval(f+"\n//# sourceURL="+e)}.call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,c=goog.global.$jscomp,d=c.transpile}}return d||(d=c.transpile=function(e,t){return goog.logToConsole_(t+" requires transpilation but no transpiler was found."),e}),d(a,b)},goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var o=Object.prototype.toString.call(e);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();for(var o in t="array"==t?[]:{},e)t[o]=goog.cloneObject(e[o]);return t}return e},goog.bindNative_=function(e,t,o){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,o){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,i),e.apply(t,o)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,o){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=o.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.mixin=function(e,t){for(var o in t)e[o]=t[o]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(e){}if(void 0!==goog.global._evalTest_){try{delete goog.global._evalTest_}catch(e){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var t=goog.global.document,o=t.createElement("SCRIPT");o.type="text/javascript",o.defer=!1,o.appendChild(t.createTextNode(e)),t.head.appendChild(o),t.head.removeChild(o)}}},goog.evalWorksForGlobals_=null,goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var o=function(e){return goog.cssNameMapping_[e]||e},i=function(e){e=e.split("-");for(var t=[],i=0;i<e.length;i++)t.push(o(e[i]));return t.join("-")};return i=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?o:i:function(e){return e},i=t?e+"-"+i(t):i(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(i):i},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,t){return t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,o){return null!=t&&o in t?t[o]:e})),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,o){goog.exportPath_(e,t,o)},goog.exportProperty=function(e,t,o){e[t]=o},goog.inherits=function(e,t){function o(){}o.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new o,e.prototype.constructor=e,e.base=function(e,o,i){for(var n=Array(arguments.length-2),r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t.prototype[o].apply(e,n)}},goog.base=function(e,t,o){var i=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!i)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(i.superClass_){for(var n=Array(arguments.length-1),r=1;r<arguments.length;r++)n[r-1]=arguments[r];return i.superClass_.constructor.apply(e,n)}for(n=Array(arguments.length-2),r=2;r<arguments.length;r++)n[r-2]=arguments[r];r=!1;for(var s=e.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[t]===i)r=!0;else if(r)return s.prototype[t].apply(e,n);if(e[t]===i)return e.constructor.prototype[t].apply(e,n);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var o=t.constructor,i=t.statics;return o&&o!=Object.prototype.constructor||(o=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),o=goog.defineClass.createSealingConstructor_(o,e),e&&goog.inherits(o,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(o.prototype,t),null!=i&&(i instanceof Function?i(o):goog.defineClass.applyProperties_(o,i)),o},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var o=!goog.defineClass.isUnsealable_(t),i=function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],this.constructor===i&&o&&Object.seal instanceof Function&&Object.seal(t),t};return i},goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);for(var i=0;i<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;i++)o=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i],Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},goog.tagUnsealableClass=function(e){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var e=goog.global.document,t=e.currentScript;for(t=(e=t?[t]:e.getElementsByTagName("SCRIPT")).length-1;0<=t;--t){var o=e[t].src,i=o.lastIndexOf("?");if(i=-1==i?o.length:i,"base.js"==o.substr(i-7,7)){goog.basePath=o.substr(0,i-7);break}}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function a(e,t){d?c[e]=!0:t()?c[e]=!1:d=c[e]=!0}function b(a){try{return!!eval(a)}catch(e){return!1}}var c={es3:!1},d=!1,e=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";return a("es5",function(){return b("[1,].length==1")}),a("es6",function(){var t=e.match(/Edge\/(\d+)(\.\d)*/i);return!(t&&15>Number(t[1]))&&b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')}),a("es6-impl",function(){return!0}),a("es7",function(){return b("2 ** 2 == 4")}),a("es8",function(){return b("async () => 1, true")}),a("es_next",function(){return b("({...rest} = {}), true")}),c},goog.Transpiler.prototype.needsTranspile=function(e){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(this.requiresTranspilation_||(this.requiresTranspilation_=this.createRequiresTranspilation_()),e in this.requiresTranspilation_)return this.requiresTranspilation_[e];throw Error("Unknown language mode: "+e)},goog.Transpiler.prototype.transpile=function(e,t){return goog.transpile_(e,t)},goog.transpiler_=new goog.Transpiler,goog.DebugLoader=function(){this.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},this.oldIeWaiting_=!1,this.queuedModules_=[],this.lastNonModuleScriptIndex_=0},goog.DebugLoader.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader.prototype.earlyProcessLoad=function(e){goog.DebugLoader.IS_OLD_IE_&&this.maybeProcessDeferredDep_(e)},goog.DebugLoader.prototype.load=function(e){var t=this.getPathFromDeps_(e);if(!t)throw e="goog.require could not find: "+e,this.logToConsole(e),Error(e);var o=[],i={},n=this.dependencies_,r=this,s=function(e){if(!(e in n.written||e in n.visited)){if(n.visited[e]=!0,e in n.requires)for(var t in n.requires[e])if(!r.isProvided(t)){if(!(t in n.nameToPath))throw Error("Undefined nameToPath for "+t);s(n.nameToPath[t])}e in i||(i[e]=!0,o.push(e))}};for(s(t),e=0;e<o.length;e++)t=o[e],this.dependencies_.written[t]=!0;for(e=0;e<o.length;e++){if(!(t=o[e]))throw Error("Undefined script input");var a=n.loadFlags[t]||{},l=a.lang||"es3";l=this.getTranspiler().needsTranspile(l),"goog"==a.module||l?this.importProcessedScript_(goog.basePath+t,"goog"==a.module,l):this.importScript_(goog.basePath+t)}},goog.DebugLoader.prototype.addDependency=function(e,t,o,i){var n;e=e.replace(/\\/g,"/");var r=this.dependencies_;i&&"boolean"!=typeof i||(i=i?{module:"goog"}:{});for(var s=0;n=t[s];s++)r.nameToPath[n]=e,r.loadFlags[e]=i;for(i=0;t=o[i];i++)e in r.requires||(r.requires[e]={}),r.requires[e][t]=!0},goog.DebugLoader.prototype.importScript_=function(e,t){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this))(e,t)&&(this.dependencies_.written[e]=!0)},goog.DebugLoader.prototype.importProcessedScript_=function(e,t,o){this.importScript_("",'goog.debugLoader_.retrieveAndExec_("'+e+'", '+t+", "+o+");")},goog.DebugLoader.prototype.retrieveAndExec_=function(e,t,o){if(!COMPILED){var i=e;e=this.normalizePath(e);var n=goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this),r=this.loadFileSync(e);if(null==r)throw Error('Load of "'+e+'" failed');o&&(r=this.getTranspiler().transpile(r,e)),r=t?this.wrapModule_(e,r):r+"\n//# sourceURL="+e,goog.DebugLoader.IS_OLD_IE_&&this.oldIeWaiting_?(this.dependencies_.deferred[i]=r,this.queuedModules_.push(i)):n(e,r)}},goog.DebugLoader.prototype.wrapModule_=function(e,t){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(t+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+t+"\n;return exports});\n//# sourceURL="+e+"\n"},goog.DebugLoader.prototype.loadQueuedModules_=function(){var e=this.queuedModules_.length;if(0<e){var t=this.queuedModules_;this.queuedModules_=[];for(var o=0;o<e;o++)this.maybeProcessDeferredPath_(t[o])}this.oldIeWaiting_=!1},goog.DebugLoader.prototype.maybeProcessDeferredDep_=function(e){this.isDeferredModule_(e)&&this.allDepsAreAvailable_(e)&&(e=this.getPathFromDeps_(e),this.maybeProcessDeferredPath_(goog.basePath+e))},goog.DebugLoader.prototype.isDeferredModule_=function(e){var t=(e=this.getPathFromDeps_(e))&&this.dependencies_.loadFlags[e]||{},o=t.lang||"es3";return!(!e||"goog"!=t.module&&!this.getTranspiler().needsTranspile(o))&&goog.basePath+e in this.dependencies_.deferred},goog.DebugLoader.prototype.allDepsAreAvailable_=function(e){if((e=this.getPathFromDeps_(e))&&e in this.dependencies_.requires)for(var t in this.dependencies_.requires[e])if(!this.isProvided(t)&&!this.isDeferredModule_(t))return!1;return!0},goog.DebugLoader.prototype.maybeProcessDeferredPath_=function(e){if(e in this.dependencies_.deferred){var t=this.dependencies_.deferred[e];delete this.dependencies_.deferred[e],goog.globalEval(t)}},goog.DebugLoader.prototype.writeScriptSrcNode_=function(e){goog.global.document.write('<script type="text/javascript" src="'+e+'"><\/script>')},goog.DebugLoader.prototype.appendScriptSrcNode_=function(e){var t=goog.global.document,o=t.createElement("script");o.type="text/javascript",o.src=e,o.defer=!1,o.async=!1,t.head.appendChild(o)},goog.DebugLoader.prototype.writeScriptTag_=function(e,t){if(this.inHtmlDocument()){var o=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==o.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}if(void 0===t)if(goog.DebugLoader.IS_OLD_IE_){this.oldIeWaiting_=!0;var i=" onreadystatechange='goog.debugLoader_.onScriptLoad_(this, "+ ++this.lastNonModuleScriptIndex_+")' ";o.write('<script type="text/javascript" src="'+e+'"'+i+"><\/script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?this.appendScriptSrcNode_(e):this.writeScriptSrcNode_(e);else o.write('<script type="text/javascript">'+this.protectScriptTag_(t)+"<\/script>");return!0}return!1},goog.DebugLoader.prototype.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader.prototype.onScriptLoad_=function(e,t){return"complete"==e.readyState&&this.lastNonModuleScriptIndex_==t&&this.loadQueuedModules_(),!0},goog.DebugLoader.prototype.getPathFromDeps_=function(e){return e in this.dependencies_.nameToPath?this.dependencies_.nameToPath[e]:null},goog.DebugLoader.prototype.getTranspiler=function(){return goog.transpiler_},goog.DebugLoader.prototype.isProvided=function(e){return goog.isProvided_(e)},goog.DebugLoader.prototype.inHtmlDocument=function(){return goog.inHtmlDocument_()},goog.DebugLoader.prototype.logToConsole=function(e){goog.logToConsole_(e)},goog.DebugLoader.prototype.loadFileSync=function(e){return goog.loadFileSync_(e)},goog.DebugLoader.prototype.normalizePath=function(e){return goog.normalizePath_(e)},goog.debugLoader_=null,goog.registerDebugLoader=function(e){if(goog.debugLoader_)throw Error("Debug loader already registered!");if(!(e instanceof goog.DebugLoader))throw Error("Not a goog.DebugLoader.");goog.debugLoader_=e},goog.getLoader_=function(){if(!goog.debugLoader_&&goog.DEBUG_LOADER)throw Error("Loaded debug loader file but no loader was registered!");return goog.debugLoader_||(goog.debugLoader_=new goog.DebugLoader),goog.debugLoader_},function(){if(goog.DEBUG_LOADER){var e=new goog.DebugLoader;e.importScript_(goog.basePath+goog.DEBUG_LOADER)}goog.global.CLOSURE_NO_DEPS||(e=e||new goog.DebugLoader,goog.DEBUG_LOADER||goog.registerDebugLoader(e),e.importScript_(goog.basePath+"deps.js"))}()),goog.debug={},goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(e,t){goog.debug.Error.call(this,goog.asserts.subs_(e,t)),this.messagePattern=e},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.subs_=function(e,t){for(var o=e.split("%s"),i="",n=o.length-1,r=0;r<n;r++)i+=o[r]+(r<t.length?t[r]:"%s");return i+o[n]},goog.asserts.doAssertFailure_=function(e,t,o,i){var n="Assertion failed";if(o){n+=": "+o;var r=i}else e&&(n+=": "+e,r=t);e=new goog.asserts.AssertionError(""+n,r||[]),goog.asserts.errorHandler_(e)},goog.asserts.setErrorHandler=function(e){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=e)},goog.asserts.assert=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.fail=function(e,t){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertString=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(e)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertFunction=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObject=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertArray=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertBoolean=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertElement=function(e,t,o){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertInstanceof=function(e,t,o,i){return!goog.asserts.ENABLE_ASSERTS||e instanceof t||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(t),goog.asserts.getType_(e)],o,Array.prototype.slice.call(arguments,3)),e},goog.asserts.assertFinite=function(e,t,o){return!goog.asserts.ENABLE_ASSERTS||"number"==typeof e&&isFinite(e)||goog.asserts.doAssertFailure_("Expected %s to be a finite number but it is not.",[e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=!1,goog.array.peek=function(e){return e[e.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.indexOf.call(e,t,o)}:function(e,t,o){if(o=null==o?0:0>o?Math.max(0,e.length+o):o,goog.isString(e))return goog.isString(t)&&1==t.length?e.indexOf(t,o):-1;for(;o<e.length;o++)if(o in e&&e[o]===t)return o;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.lastIndexOf.call(e,t,null==o?e.length-1:o)}:function(e,t,o){if(0>(o=null==o?e.length-1:o)&&(o=Math.max(0,e.length+o)),goog.isString(e))return goog.isString(t)&&1==t.length?e.lastIndexOf(t,o):-1;for(;0<=o;o--)if(o in e&&e[o]===t)return o;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,t,o){goog.asserts.assert(null!=e.length),Array.prototype.forEach.call(e,t,o)}:function(e,t,o){for(var i=e.length,n=goog.isString(e)?e.split(""):e,r=0;r<i;r++)r in n&&t.call(o,n[r],r,e)},goog.array.forEachRight=function(e,t,o){var i=e.length,n=goog.isString(e)?e.split(""):e;for(--i;0<=i;--i)i in n&&t.call(o,n[i],i,e)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.filter.call(e,t,o)}:function(e,t,o){for(var i=e.length,n=[],r=0,s=goog.isString(e)?e.split(""):e,a=0;a<i;a++)if(a in s){var l=s[a];t.call(o,l,a,e)&&(n[r++]=l)}return n},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.map.call(e,t,o)}:function(e,t,o){for(var i=e.length,n=Array(i),r=goog.isString(e)?e.split(""):e,s=0;s<i;s++)s in r&&(n[s]=t.call(o,r[s],s,e));return n},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(e,t,o,i){return goog.asserts.assert(null!=e.length),i&&(t=goog.bind(t,i)),Array.prototype.reduce.call(e,t,o)}:function(e,t,o,i){var n=o;return goog.array.forEach(e,function(o,r){n=t.call(i,n,o,r,e)}),n},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(e,t,o,i){return goog.asserts.assert(null!=e.length),goog.asserts.assert(null!=t),i&&(t=goog.bind(t,i)),Array.prototype.reduceRight.call(e,t,o)}:function(e,t,o,i){var n=o;return goog.array.forEachRight(e,function(o,r){n=t.call(i,n,o,r,e)}),n},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.some.call(e,t,o)}:function(e,t,o){for(var i=e.length,n=goog.isString(e)?e.split(""):e,r=0;r<i;r++)if(r in n&&t.call(o,n[r],r,e))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.every.call(e,t,o)}:function(e,t,o){for(var i=e.length,n=goog.isString(e)?e.split(""):e,r=0;r<i;r++)if(r in n&&!t.call(o,n[r],r,e))return!1;return!0},goog.array.count=function(e,t,o){var i=0;return goog.array.forEach(e,function(e,n,r){t.call(o,e,n,r)&&++i},o),i},goog.array.find=function(e,t,o){return 0>(t=goog.array.findIndex(e,t,o))?null:goog.isString(e)?e.charAt(t):e[t]},goog.array.findIndex=function(e,t,o){for(var i=e.length,n=goog.isString(e)?e.split(""):e,r=0;r<i;r++)if(r in n&&t.call(o,n[r],r,e))return r;return-1},goog.array.findRight=function(e,t,o){return 0>(t=goog.array.findIndexRight(e,t,o))?null:goog.isString(e)?e.charAt(t):e[t]},goog.array.findIndexRight=function(e,t,o){var i=e.length,n=goog.isString(e)?e.split(""):e;for(--i;0<=i;i--)if(i in n&&t.call(o,n[i],i,e))return i;return-1},goog.array.contains=function(e,t){return 0<=goog.array.indexOf(e,t)},goog.array.isEmpty=function(e){return 0==e.length},goog.array.clear=function(e){if(!goog.isArray(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0},goog.array.insert=function(e,t){goog.array.contains(e,t)||e.push(t)},goog.array.insertAt=function(e,t,o){goog.array.splice(e,o,0,t)},goog.array.insertArrayAt=function(e,t,o){goog.partial(goog.array.splice,e,o,0).apply(null,t)},goog.array.insertBefore=function(e,t,o){var i;2==arguments.length||0>(i=goog.array.indexOf(e,o))?e.push(t):goog.array.insertAt(e,t,i)},goog.array.remove=function(e,t){var o,i=goog.array.indexOf(e,t);return(o=0<=i)&&goog.array.removeAt(e,i),o},goog.array.removeLast=function(e,t){var o=goog.array.lastIndexOf(e,t);return 0<=o&&(goog.array.removeAt(e,o),!0)},goog.array.removeAt=function(e,t){return goog.asserts.assert(null!=e.length),1==Array.prototype.splice.call(e,t,1).length},goog.array.removeIf=function(e,t,o){return 0<=(t=goog.array.findIndex(e,t,o))&&(goog.array.removeAt(e,t),!0)},goog.array.removeAllIf=function(e,t,o){var i=0;return goog.array.forEachRight(e,function(n,r){t.call(o,n,r,e)&&goog.array.removeAt(e,r)&&i++}),i},goog.array.concat=function(e){return Array.prototype.concat.apply([],arguments)},goog.array.join=function(e){return Array.prototype.concat.apply([],arguments)},goog.array.toArray=function(e){var t=e.length;if(0<t){for(var o=Array(t),i=0;i<t;i++)o[i]=e[i];return o}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(e,t){for(var o=1;o<arguments.length;o++){var i=arguments[o];if(goog.isArrayLike(i)){var n=e.length||0,r=i.length||0;e.length=n+r;for(var s=0;s<r;s++)e[n+s]=i[s]}else e.push(i)}},goog.array.splice=function(e,t,o,i){return goog.asserts.assert(null!=e.length),Array.prototype.splice.apply(e,goog.array.slice(arguments,1))},goog.array.slice=function(e,t,o){return goog.asserts.assert(null!=e.length),2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,o)},goog.array.removeDuplicates=function(e,t,o){t=t||e;var i=function(e){return goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e};o=o||i,i={};for(var n=0,r=0;r<e.length;){var s=e[r++],a=o(s);Object.prototype.hasOwnProperty.call(i,a)||(i[a]=!0,t[n++]=s)}t.length=n},goog.array.binarySearch=function(e,t,o){return goog.array.binarySearch_(e,o||goog.array.defaultCompare,!1,t)},goog.array.binarySelect=function(e,t,o){return goog.array.binarySearch_(e,t,!0,void 0,o)},goog.array.binarySearch_=function(e,t,o,i,n){for(var r,s=0,a=e.length;s<a;){var l=s+a>>1,c=o?t.call(n,e[l],l,e):t(i,e[l]);0<c?s=l+1:(a=l,r=!c)}return r?s:~s},goog.array.sort=function(e,t){e.sort(t||goog.array.defaultCompare)},goog.array.stableSort=function(e,t){for(var o=Array(e.length),i=0;i<e.length;i++)o[i]={index:i,value:e[i]};var n=t||goog.array.defaultCompare;for(goog.array.sort(o,function(e,t){return n(e.value,t.value)||e.index-t.index}),i=0;i<e.length;i++)e[i]=o[i].value},goog.array.sortByKey=function(e,t,o){var i=o||goog.array.defaultCompare;goog.array.sort(e,function(e,o){return i(t(e),t(o))})},goog.array.sortObjectsByKey=function(e,t,o){goog.array.sortByKey(e,function(e){return e[t]},o)},goog.array.isSorted=function(e,t,o){t=t||goog.array.defaultCompare;for(var i=1;i<e.length;i++){var n=t(e[i-1],e[i]);if(0<n||0==n&&o)return!1}return!0},goog.array.equals=function(e,t,o){if(!goog.isArrayLike(e)||!goog.isArrayLike(t)||e.length!=t.length)return!1;var i=e.length;o=o||goog.array.defaultCompareEquality;for(var n=0;n<i;n++)if(!o(e[n],t[n]))return!1;return!0},goog.array.compare3=function(e,t,o){o=o||goog.array.defaultCompare;for(var i=Math.min(e.length,t.length),n=0;n<i;n++){var r=o(e[n],t[n]);if(0!=r)return r}return goog.array.defaultCompare(e.length,t.length)},goog.array.defaultCompare=function(e,t){return e>t?1:e<t?-1:0},goog.array.inverseDefaultCompare=function(e,t){return-goog.array.defaultCompare(e,t)},goog.array.defaultCompareEquality=function(e,t){return e===t},goog.array.binaryInsert=function(e,t,o){return 0>(o=goog.array.binarySearch(e,t,o))&&(goog.array.insertAt(e,t,-(o+1)),!0)},goog.array.binaryRemove=function(e,t,o){return 0<=(t=goog.array.binarySearch(e,t,o))&&goog.array.removeAt(e,t)},goog.array.bucket=function(e,t,o){for(var i={},n=0;n<e.length;n++){var r=e[n],s=t.call(o,r,n,e);goog.isDef(s)&&(i[s]||(i[s]=[])).push(r)}return i},goog.array.toObject=function(e,t,o){var i={};return goog.array.forEach(e,function(n,r){i[t.call(o,n,r,e)]=n}),i},goog.array.range=function(e,t,o){var i=[],n=0,r=e;if(o=o||1,void 0!==t&&(n=e,r=t),0>o*(r-n))return[];if(0<o)for(e=n;e<r;e+=o)i.push(e);else for(e=n;e>r;e+=o)i.push(e);return i},goog.array.repeat=function(e,t){for(var o=[],i=0;i<t;i++)o[i]=e;return o},goog.array.flatten=function(e){for(var t=[],o=0;o<arguments.length;o++){var i=arguments[o];if(goog.isArray(i))for(var n=0;n<i.length;n+=8192){var r=goog.array.slice(i,n,n+8192);r=goog.array.flatten.apply(null,r);for(var s=0;s<r.length;s++)t.push(r[s])}else t.push(i)}return t},goog.array.rotate=function(e,t){return goog.asserts.assert(null!=e.length),e.length&&(0<(t%=e.length)?Array.prototype.unshift.apply(e,e.splice(-t,t)):0>t&&Array.prototype.push.apply(e,e.splice(0,-t))),e},goog.array.moveItem=function(e,t,o){goog.asserts.assert(0<=t&&t<e.length),goog.asserts.assert(0<=o&&o<e.length),t=Array.prototype.splice.call(e,t,1),Array.prototype.splice.call(e,o,0,t[0])},goog.array.zip=function(e){if(!arguments.length)return[];for(var t=[],o=arguments[0].length,i=1;i<arguments.length;i++)arguments[i].length<o&&(o=arguments[i].length);for(i=0;i<o;i++){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r][i]);t.push(n)}return t},goog.array.shuffle=function(e,t){for(var o=t||Math.random,i=e.length-1;0<i;i--){var n=Math.floor(o()*(i+1)),r=e[i];e[i]=e[n],e[n]=r}},goog.array.copyByIndex=function(e,t){var o=[];return goog.array.forEach(t,function(t){o.push(e[t])}),o},goog.array.concatMap=function(e,t,o){return goog.array.concat.apply([],goog.array.map(e,t,o))},goog.math={},goog.math.randomInt=function(e){return Math.floor(Math.random()*e)},goog.math.uniformRandom=function(e,t){return e+Math.random()*(t-e)},goog.math.clamp=function(e,t,o){return Math.min(Math.max(e,t),o)},goog.math.modulo=function(e,t){var o=e%t;return 0>o*t?o+t:o},goog.math.lerp=function(e,t,o){return e+o*(t-e)},goog.math.nearlyEquals=function(e,t,o){return Math.abs(e-t)<=(o||1e-6)},goog.math.standardAngle=function(e){return goog.math.modulo(e,360)},goog.math.standardAngleInRadians=function(e){return goog.math.modulo(e,2*Math.PI)},goog.math.toRadians=function(e){return e*Math.PI/180},goog.math.toDegrees=function(e){return 180*e/Math.PI},goog.math.angleDx=function(e,t){return t*Math.cos(goog.math.toRadians(e))},goog.math.angleDy=function(e,t){return t*Math.sin(goog.math.toRadians(e))},goog.math.angle=function(e,t,o,i){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(i-t,o-e)))},goog.math.angleDifference=function(e,t){var o=goog.math.standardAngle(t)-goog.math.standardAngle(e);return 180<o?o-=360:-180>=o&&(o=360+o),o},goog.math.sign=function(e){return 0<e?1:0>e?-1:e},goog.math.longestCommonSubsequence=function(e,t,o,i){o=o||function(e,t){return e==t},i=i||function(t,o){return e[t]};for(var n=e.length,r=t.length,s=[],a=0;a<n+1;a++)s[a]=[],s[a][0]=0;for(var l=0;l<r+1;l++)s[0][l]=0;for(a=1;a<=n;a++)for(l=1;l<=r;l++)o(e[a-1],t[l-1])?s[a][l]=s[a-1][l-1]+1:s[a][l]=Math.max(s[a-1][l],s[a][l-1]);var c=[];for(a=n,l=r;0<a&&0<l;)o(e[a-1],t[l-1])?(c.unshift(i(a-1,l-1)),a--,l--):s[a-1][l]>s[a][l-1]?a--:l--;return c},goog.math.sum=function(e){return goog.array.reduce(arguments,function(e,t){return e+t},0)},goog.math.average=function(e){return goog.math.sum.apply(null,arguments)/arguments.length},goog.math.sampleVariance=function(e){var t=arguments.length;if(2>t)return 0;var o=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(e){return Math.pow(e-o,2)}))/(t-1)},goog.math.standardDeviation=function(e){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))},goog.math.isInt=function(e){return isFinite(e)&&0==e%1},goog.math.isFiniteNumber=function(e){return isFinite(e)},goog.math.isNegativeZero=function(e){return 0==e&&0>1/e},goog.math.log10Floor=function(e){if(0<e){var t=Math.round(Math.log(e)*Math.LOG10E);return t-(parseFloat("1e"+t)>e?1:0)}return 0==e?-1/0:NaN},goog.math.safeFloor=function(e,t){return goog.asserts.assert(!goog.isDef(t)||0<t),Math.floor(e+(t||2e-15))},goog.math.safeCeil=function(e,t){return goog.asserts.assert(!goog.isDef(t)||0<t),Math.ceil(e-(t||2e-15))},goog.math.Coordinate=function(e,t){this.x=goog.isDef(e)?e:0,this.y=goog.isDef(t)?t:0},goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)},goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}),goog.math.Coordinate.prototype.equals=function(e){return e instanceof goog.math.Coordinate&&goog.math.Coordinate.equals(this,e)},goog.math.Coordinate.equals=function(e,t){return e==t||!(!e||!t)&&(e.x==t.x&&e.y==t.y)},goog.math.Coordinate.distance=function(e,t){var o=e.x-t.x,i=e.y-t.y;return Math.sqrt(o*o+i*i)},goog.math.Coordinate.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},goog.math.Coordinate.azimuth=function(e){return goog.math.angle(0,0,e.x,e.y)},goog.math.Coordinate.squaredDistance=function(e,t){var o=e.x-t.x,i=e.y-t.y;return o*o+i*i},goog.math.Coordinate.difference=function(e,t){return new goog.math.Coordinate(e.x-t.x,e.y-t.y)},goog.math.Coordinate.sum=function(e,t){return new goog.math.Coordinate(e.x+t.x,e.y+t.y)},goog.math.Coordinate.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},goog.math.Coordinate.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},goog.math.Coordinate.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},goog.math.Coordinate.prototype.translate=function(e,t){return e instanceof goog.math.Coordinate?(this.x+=e.x,this.y+=e.y):(this.x+=Number(e),goog.isNumber(t)&&(this.y+=t)),this},goog.math.Coordinate.prototype.scale=function(e,t){var o=goog.isNumber(t)?t:e;return this.x*=e,this.y*=o,this},goog.math.Coordinate.prototype.rotateRadians=function(e,t){var o=t||new goog.math.Coordinate(0,0),i=this.x,n=this.y,r=Math.cos(e),s=Math.sin(e);this.x=(i-o.x)*r-(n-o.y)*s+o.x,this.y=(i-o.x)*s+(n-o.y)*r+o.y},goog.math.Coordinate.prototype.rotateDegrees=function(e,t){this.rotateRadians(goog.math.toRadians(e),t)},goog.string={},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:""},goog.string.startsWith=function(e,t){return 0==e.lastIndexOf(t,0)},goog.string.endsWith=function(e,t){var o=e.length-t.length;return 0<=o&&e.indexOf(t,o)==o},goog.string.caseInsensitiveStartsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(0,t.length))},goog.string.caseInsensitiveEndsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(e.length-t.length,t.length))},goog.string.caseInsensitiveEquals=function(e,t){return e.toLowerCase()==t.toLowerCase()},goog.string.subs=function(e,t){for(var o=e.split("%s"),i="",n=Array.prototype.slice.call(arguments,1);n.length&&1<o.length;)i+=o.shift()+n.shift();return i+o.join("%s")},goog.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=function(e){return/^[\s\xa0]*$/.test(e)},goog.string.isEmptyString=function(e){return 0==e.length},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(e){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},goog.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)},goog.string.isNumeric=function(e){return!/[^0-9]/.test(e)},goog.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)},goog.string.isSpace=function(e){return" "==e},goog.string.isUnicodeChar=function(e){return 1==e.length&&" "<=e&&"~">=e||""<=e&&"">=e},goog.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")},goog.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},goog.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=function(e,t){var o=String(e).toLowerCase(),i=String(t).toLowerCase();return o<i?-1:o==i?0:1},goog.string.numberAwareCompare_=function(e,t,o){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var i=e.toLowerCase().match(o),n=t.toLowerCase().match(o),r=Math.min(i.length,n.length),s=0;s<r;s++){o=i[s];var a=n[s];if(o!=a)return e=parseInt(o,10),!isNaN(e)&&(t=parseInt(a,10),!isNaN(t)&&e-t)?e-t:o<a?-1:1}return i.length!=n.length?i.length-n.length:e<t?-1:1},goog.string.intAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\D+/g)},goog.string.floatAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(e){return encodeURIComponent(String(e))},goog.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},goog.string.newLineToBr=function(e,t){return e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>")},goog.string.htmlEscape=function(e,t){if(t)e=e.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(e))return e;-1!=e.indexOf("&")&&(e=e.replace(goog.string.AMP_RE_,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(goog.string.LT_RE_,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(goog.string.GT_RE_,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(goog.string.QUOT_RE_,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(goog.string.NULL_RE_,"&#0;")),goog.string.DETECT_DOUBLE_ESCAPING&&-1!=e.indexOf("e")&&(e=e.replace(goog.string.E_RE_,"&#101;"))}return e},goog.string.AMP_RE_=/&/g,goog.string.LT_RE_=/</g,goog.string.GT_RE_=/>/g,goog.string.QUOT_RE_=/"/g,goog.string.SINGLE_QUOTE_RE_=/'/g,goog.string.NULL_RE_=/\x00/g,goog.string.E_RE_=/e/g,goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,goog.string.unescapeEntities=function(e){return goog.string.contains(e,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(e):goog.string.unescapePureXmlEntities_(e):e},goog.string.unescapeEntitiesWithDocument=function(e,t){return goog.string.contains(e,"&")?goog.string.unescapeEntitiesUsingDom_(e,t):e},goog.string.unescapeEntitiesUsingDom_=function(e,t){var o={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},i=t?t.createElement("div"):goog.global.document.createElement("div");return e.replace(goog.string.HTML_ENTITY_PATTERN_,function(e,t){var n=o[e];if(n)return n;if("#"==t.charAt(0)){var r=Number("0"+t.substr(1));isNaN(r)||(n=String.fromCharCode(r))}return n||(i.innerHTML=e+" ",n=i.firstChild.nodeValue.slice(0,-1)),o[e]=n})},goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==t.charAt(0)){var o=Number("0"+t.substr(1));if(!isNaN(o))return String.fromCharCode(o)}return e}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(e,t){return goog.string.newLineToBr(e.replace(/  /g," &#160;"),t)},goog.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(e,t){for(var o=t.length,i=0;i<o;i++){var n=1==o?t:t.charAt(i);if(e.charAt(0)==n&&e.charAt(e.length-1)==n)return e.substring(1,e.length-1)}return e},goog.string.truncate=function(e,t,o){return o&&(e=goog.string.unescapeEntities(e)),e.length>t&&(e=e.substring(0,t-3)+"..."),o&&(e=goog.string.htmlEscape(e)),e},goog.string.truncateMiddle=function(e,t,o,i){if(o&&(e=goog.string.unescapeEntities(e)),i&&e.length>t){i>t&&(i=t);var n=e.length-i;e=e.substring(0,t-i)+"..."+e.substring(n)}else e.length>t&&(i=Math.floor(t/2),n=e.length-i,e=e.substring(0,i+t%2)+"..."+e.substring(n));return o&&(e=goog.string.htmlEscape(e)),e},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(e){e=String(e);for(var t=['"'],o=0;o<e.length;o++){var i=e.charAt(o),n=i.charCodeAt(0);t[o+1]=goog.string.specialEscapeChars_[i]||(31<n&&127>n?i:goog.string.escapeChar(i))}return t.push('"'),t.join("")},goog.string.escapeString=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=goog.string.escapeChar(e.charAt(o));return t.join("")},goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[e];if(e in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e];var t=e.charCodeAt(0);if(31<t&&127>t)var o=e;else 256>t?(o="\\x",(16>t||256<t)&&(o+="0")):(o="\\u",4096>t&&(o+="0")),o+=t.toString(16).toUpperCase();return goog.string.jsEscapeCache_[e]=o},goog.string.contains=function(e,t){return-1!=e.indexOf(t)},goog.string.caseInsensitiveContains=function(e,t){return goog.string.contains(e.toLowerCase(),t.toLowerCase())},goog.string.countOf=function(e,t){return e&&t?e.split(t).length-1:0},goog.string.removeAt=function(e,t,o){var i=e;return 0<=t&&t<e.length&&0<o&&(i=e.substr(0,t)+e.substr(t+o,e.length-t-o)),i},goog.string.remove=function(e,t){return e.replace(t,"")},goog.string.removeAll=function(e,t){var o=new RegExp(goog.string.regExpEscape(t),"g");return e.replace(o,"")},goog.string.replaceAll=function(e,t,o){return t=new RegExp(goog.string.regExpEscape(t),"g"),e.replace(t,o.replace(/\$/g,"$$$$"))},goog.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){return Array(t+1).join(e)},goog.string.padNumber=function(e,t,o){return-1==(o=(e=goog.isDef(o)?e.toFixed(o):String(e)).indexOf("."))&&(o=e.length),goog.string.repeat("0",Math.max(0,t-o))+e},goog.string.makeSafe=function(e){return null==e?"":String(e)},goog.string.buildString=function(e){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=function(e,t){for(var o=0,i=goog.string.trim(String(e)).split("."),n=goog.string.trim(String(t)).split("."),r=Math.max(i.length,n.length),s=0;0==o&&s<r;s++){var a=i[s]||"",l=n[s]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""],0==a[0].length&&0==l[0].length)break;o=0==a[1].length?0:parseInt(a[1],10);var c=0==l[1].length?0:parseInt(l[1],10);o=goog.string.compareElements_(o,c)||goog.string.compareElements_(0==a[2].length,0==l[2].length)||goog.string.compareElements_(a[2],l[2]),a=a[3],l=l[3]}while(0==o)}return o},goog.string.compareElements_=function(e,t){return e<t?-1:e>t?1:0},goog.string.hashCode=function(e){for(var t=0,o=0;o<e.length;++o)t=31*t+e.charCodeAt(o)>>>0;return t},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(e){var t=Number(e);return 0==t&&goog.string.isEmptyOrWhitespace(e)?NaN:t},goog.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)},goog.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)},goog.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},goog.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(e,t){var o=goog.isString(t)?goog.string.regExpEscape(t):"\\s";return e.replace(new RegExp("(^"+(o?"|["+o+"]+":"")+")([a-z])","g"),function(e,t,o){return t+o.toUpperCase()})},goog.string.capitalize=function(e){return String(e.charAt(0)).toUpperCase()+String(e.substr(1)).toLowerCase()},goog.string.parseInt=function(e){return isFinite(e)&&(e=String(e)),goog.isString(e)?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN},goog.string.splitLimit=function(e,t,o){e=e.split(t);for(var i=[];0<o&&e.length;)i.push(e.shift()),o--;return e.length&&i.push(e.join(t)),i},goog.string.lastComponent=function(e,t){if(!t)return e;"string"==typeof t&&(t=[t]);for(var o=-1,i=0;i<t.length;i++)if(""!=t[i]){var n=e.lastIndexOf(t[i]);n>o&&(o=n)}return-1==o?e:e.slice(o+1)},goog.string.editDistance=function(e,t){var o=[],i=[];if(e==t)return 0;if(!e.length||!t.length)return Math.max(e.length,t.length);for(var n=0;n<t.length+1;n++)o[n]=n;for(n=0;n<e.length;n++){i[0]=n+1;for(var r=0;r<t.length;r++)i[r+1]=Math.min(i[r]+1,o[r+1]+1,o[r]+Number(e[n]!=t[r]));for(r=0;r<o.length;r++)o[r]=i[r]}return i[t.length]},goog.labs={},goog.labs.userAgent={},goog.labs.userAgent.util={},goog.labs.userAgent.util.getNativeUserAgentString_=function(){var e=goog.labs.userAgent.util.getNavigator_();return e&&(e=e.userAgent)?e:""},goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator},goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_(),goog.labs.userAgent.util.setUserAgent=function(e){goog.labs.userAgent.util.userAgent_=e||goog.labs.userAgent.util.getNativeUserAgentString_()},goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_},goog.labs.userAgent.util.matchUserAgent=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(t,e)},goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(t,e)},goog.labs.userAgent.util.extractVersionTuples=function(e){for(var t,o=RegExp("(\\w[\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),i=[];t=o.exec(e);)i.push([t[1],t[2],t[3]||void 0]);return i},goog.object={},goog.object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},goog.object.forEach=function(e,t,o){for(var i in e)t.call(o,e[i],i,e)},goog.object.filter=function(e,t,o){var i,n={};for(i in e)t.call(o,e[i],i,e)&&(n[i]=e[i]);return n},goog.object.map=function(e,t,o){var i,n={};for(i in e)n[i]=t.call(o,e[i],i,e);return n},goog.object.some=function(e,t,o){for(var i in e)if(t.call(o,e[i],i,e))return!0;return!1},goog.object.every=function(e,t,o){for(var i in e)if(!t.call(o,e[i],i,e))return!1;return!0},goog.object.getCount=function(e){var t,o=0;for(t in e)o++;return o},goog.object.getAnyKey=function(e){for(var t in e)return t},goog.object.getAnyValue=function(e){for(var t in e)return e[t]},goog.object.contains=function(e,t){return goog.object.containsValue(e,t)},goog.object.getValues=function(e){var t,o=[],i=0;for(t in e)o[i++]=e[t];return o},goog.object.getKeys=function(e){var t,o=[],i=0;for(t in e)o[i++]=t;return o},goog.object.getValueByKeys=function(e,t){var o=goog.isArrayLike(t),i=o?t:arguments;for(o=o?0:1;o<i.length;o++){if(null==e)return;e=e[i[o]]}return e},goog.object.containsKey=function(e,t){return null!==e&&t in e},goog.object.containsValue=function(e,t){for(var o in e)if(e[o]==t)return!0;return!1},goog.object.findKey=function(e,t,o){for(var i in e)if(t.call(o,e[i],i,e))return i},goog.object.findValue=function(e,t,o){return(t=goog.object.findKey(e,t,o))&&e[t]},goog.object.isEmpty=function(e){for(var t in e)return!1;return!0},goog.object.clear=function(e){for(var t in e)delete e[t]},goog.object.remove=function(e,t){var o;return(o=t in e)&&delete e[t],o},goog.object.add=function(e,t,o){if(null!==e&&t in e)throw Error('The object already contains the key "'+t+'"');goog.object.set(e,t,o)},goog.object.get=function(e,t,o){return null!==e&&t in e?e[t]:o},goog.object.set=function(e,t,o){e[t]=o},goog.object.setIfUndefined=function(e,t,o){return t in e?e[t]:e[t]=o},goog.object.setWithReturnValueIfNotSet=function(e,t,o){return t in e?e[t]:(o=o(),e[t]=o)},goog.object.equals=function(e,t){for(var o in e)if(!(o in t)||e[o]!==t[o])return!1;for(o in t)if(!(o in e))return!1;return!0},goog.object.clone=function(e){var t,o={};for(t in e)o[t]=e[t];return o},goog.object.unsafeClone=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(goog.isFunction(e.clone))return e.clone();for(var o in t="array"==t?[]:{},e)t[o]=goog.object.unsafeClone(e[o]);return t}return e},goog.object.transpose=function(e){var t,o={};for(t in e)o[e[t]]=t;return o},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(e,t){for(var o,i,n=1;n<arguments.length;n++){for(o in i=arguments[n])e[o]=i[o];for(var r=0;r<goog.object.PROTOTYPE_FIELDS_.length;r++)o=goog.object.PROTOTYPE_FIELDS_[r],Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}},goog.object.create=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var o={},i=0;i<t;i+=2)o[arguments[i]]=arguments[i+1];return o},goog.object.createSet=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var o={},i=0;i<t;i++)o[arguments[i]]=!0;return o},goog.object.createImmutableView=function(e){var t=e;return Object.isFrozen&&!Object.isFrozen(e)&&(t=Object.create(e),Object.freeze(t)),t},goog.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)},goog.object.getAllPropertyNames=function(e,t,o){if(!e)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(e);for(var i={};e&&(e!==Object.prototype||t)&&(e!==Function.prototype||o);){for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++)i[n[r]]=!0;e=Object.getPrototypeOf(e)}return goog.object.getKeys(i)},goog.labs.userAgent.browser={},goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")},goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")},goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))},goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")},goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")},goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()},goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())},goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_,goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_,goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_,goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_,goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_,goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_,goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_,goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_,goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_,goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")},goog.labs.userAgent.browser.getVersion=function(){function e(e){return e=goog.array.find(e,i),o[e]||""}var t=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(t);t=goog.labs.userAgent.util.extractVersionTuples(t);var o={};goog.array.forEach(t,function(e){o[e[0]]=e[1]});var i=goog.partial(goog.object.containsKey,o);return goog.labs.userAgent.browser.isOpera()?e(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?e(["Edge"]):goog.labs.userAgent.browser.isChrome()?e(["Chrome","CriOS"]):(t=t[2])&&t[1]||""},goog.labs.userAgent.browser.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),e)},goog.labs.userAgent.browser.getIEVersion_=function(e){var t=/rv: *([\d\.]*)/.exec(e);if(t&&t[1])return t[1];t="";var o=/MSIE +([\d\.]+)/.exec(e);if(o&&o[1])if(e=/Trident\/(\d.\d)/.exec(e),"7.0"==o[1])if(e&&e[1])switch(e[1]){case"4.0":t="8.0";break;case"5.0":t="9.0";break;case"6.0":t="10.0";break;case"7.0":t="11.0"}else t="7.0";else t=o[1];return t},goog.labs.userAgent.engine={},goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")},goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(e){e=goog.labs.userAgent.util.extractVersionTuples(e);var t,o=goog.labs.userAgent.engine.getEngineTuple_(e);if(o)return"Gecko"==o[0]?goog.labs.userAgent.engine.getVersionForKey_(e,"Firefox"):o[1];if((e=e[0])&&(t=e[2])&&(t=/Trident\/([^\s;]+)/.exec(t)))return t[1]}return""},goog.labs.userAgent.engine.getEngineTuple_=function(e){if(!goog.labs.userAgent.engine.isEdge())return e[1];for(var t=0;t<e.length;t++){var o=e[t];if("Edge"==o[0])return o}},goog.labs.userAgent.engine.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),e)},goog.labs.userAgent.engine.getVersionForKey_=function(e,t){var o=goog.array.find(e,function(e){return t==e[0]});return o&&o[1]||""},goog.labs.userAgent.platform={},goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")},goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")},goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()},goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")},goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")},goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")},goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")},goog.labs.userAgent.platform.isChromecast=function(){return goog.labs.userAgent.util.matchUserAgent("CrKey")},goog.labs.userAgent.platform.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent(),t="";return goog.labs.userAgent.platform.isWindows()?t=(e=(t=/Windows (?:NT|Phone) ([0-9.]+)/).exec(e))?e[1]:"0.0":goog.labs.userAgent.platform.isIos()?t=(e=(t=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/).exec(e))&&e[1].replace(/_/g,"."):goog.labs.userAgent.platform.isMacintosh()?t=(e=(t=/Mac OS X ([0-9_.]+)/).exec(e))?e[1].replace(/_/g,"."):"10":goog.labs.userAgent.platform.isAndroid()?t=(e=(t=/Android\s+([^\);]+)(\)|;)/).exec(e))&&e[1]:goog.labs.userAgent.platform.isChromeOS()&&(t=(e=(t=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/).exec(e))&&e[1]),t||""},goog.labs.userAgent.platform.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),e)},goog.reflect={},goog.reflect.object=function(e,t){return t},goog.reflect.objectProperty=function(e,t){return e},goog.reflect.sinkValue=function(e){return goog.reflect.sinkValue[" "](e),e},goog.reflect.sinkValue[" "]=goog.nullFunction,goog.reflect.canAccessProperty=function(e,t){try{return goog.reflect.sinkValue(e[t]),!0}catch(e){}return!1},goog.reflect.cache=function(e,t,o,i){return i=i?i(t):t,Object.prototype.hasOwnProperty.call(e,i)?e[i]:e[i]=o(t)},goog.userAgent={},goog.userAgent.ASSUME_IE=!1,goog.userAgent.ASSUME_EDGE=!1,goog.userAgent.ASSUME_GECKO=!1,goog.userAgent.ASSUME_WEBKIT=!1,goog.userAgent.ASSUME_MOBILE_WEBKIT=!1,goog.userAgent.ASSUME_OPERA=!1,goog.userAgent.ASSUME_ANY_VERSION=!1,goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA,goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()},goog.userAgent.getNavigator=function(){return goog.global.navigator||null},goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera(),goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE(),goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge(),goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE,goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko(),goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit(),goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")},goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_(),goog.userAgent.SAFARI=goog.userAgent.WEBKIT,goog.userAgent.determinePlatform_=function(){var e=goog.userAgent.getNavigator();return e&&e.platform||""},goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_(),goog.userAgent.ASSUME_MAC=!1,goog.userAgent.ASSUME_WINDOWS=!1,goog.userAgent.ASSUME_LINUX=!1,goog.userAgent.ASSUME_X11=!1,goog.userAgent.ASSUME_ANDROID=!1,goog.userAgent.ASSUME_IPHONE=!1,goog.userAgent.ASSUME_IPAD=!1,goog.userAgent.ASSUME_IPOD=!1,goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD,goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh(),goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows(),goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()},goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_(),goog.userAgent.isX11_=function(){var e=goog.userAgent.getNavigator();return!!e&&goog.string.contains(e.appVersion||"","X11")},goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_(),goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid(),goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone(),goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod(),goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos(),goog.userAgent.determineVersion_=function(){var e="",t=goog.userAgent.getVersionRegexResult_();return t&&(e=t?t[1]:""),goog.userAgent.IE&&(null!=(t=goog.userAgent.getDocumentMode_())&&t>parseFloat(e))?String(t):e},goog.userAgent.getVersionRegexResult_=function(){var e=goog.userAgent.getUserAgentString();return goog.userAgent.GECKO?/rv:([^\);]+)(\)|;)/.exec(e):goog.userAgent.EDGE?/Edge\/([\d\.]+)/.exec(e):goog.userAgent.IE?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):goog.userAgent.WEBKIT?/WebKit\/(\S+)/.exec(e):goog.userAgent.OPERA?/(?:Version)[ \/]?(\S+)/.exec(e):void 0},goog.userAgent.getDocumentMode_=function(){var e=goog.global.document;return e?e.documentMode:void 0},goog.userAgent.VERSION=goog.userAgent.determineVersion_(),goog.userAgent.compare=function(e,t){return goog.string.compareVersions(e,t)},goog.userAgent.isVersionOrHigherCache_={},goog.userAgent.isVersionOrHigher=function(e){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,e,function(){return 0<=goog.string.compareVersions(goog.userAgent.VERSION,e)})},goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher,goog.userAgent.isDocumentModeOrHigher=function(e){return Number(goog.userAgent.DOCUMENT_MODE)>=e},goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher,goog.userAgent.DOCUMENT_MODE=function(){var e=goog.global.document,t=goog.userAgent.getDocumentMode_();if(e&&goog.userAgent.IE)return t||("CSS1Compat"==e.compatMode?parseInt(goog.userAgent.VERSION,10):5)}(),goog.Thenable=function(){},goog.Thenable.prototype.then=function(e,t,o){},goog.Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable",goog.Thenable.addImplementation=function(e){e.prototype.then=e.prototype.then,COMPILED?e.prototype[goog.Thenable.IMPLEMENTED_BY_PROP]=!0:e.prototype.$goog_Thenable=!0},goog.Thenable.isImplementedBy=function(e){if(!e)return!1;try{return COMPILED?!!e[goog.Thenable.IMPLEMENTED_BY_PROP]:!!e.$goog_Thenable}catch(e){return!1}},goog.async={},goog.async.FreeList=function(e,t,o){this.limit_=o,this.create_=e,this.reset_=t,this.occupants_=0,this.head_=null},goog.async.FreeList.prototype.get=function(){if(0<this.occupants_){this.occupants_--;var e=this.head_;this.head_=e.next,e.next=null}else e=this.create_();return e},goog.async.FreeList.prototype.put=function(e){this.reset_(e),this.occupants_<this.limit_&&(this.occupants_++,e.next=this.head_,this.head_=e)},goog.async.FreeList.prototype.occupants=function(){return this.occupants_},goog.async.WorkQueue=function(){this.workTail_=this.workHead_=null},goog.async.WorkQueue.DEFAULT_MAX_UNUSED=100,goog.async.WorkQueue.freelist_=new goog.async.FreeList(function(){return new goog.async.WorkItem},function(e){e.reset()},goog.async.WorkQueue.DEFAULT_MAX_UNUSED),goog.async.WorkQueue.prototype.add=function(e,t){var o=this.getUnusedItem_();o.set(e,t),this.workTail_?this.workTail_.next=o:(goog.asserts.assert(!this.workHead_),this.workHead_=o),this.workTail_=o},goog.async.WorkQueue.prototype.remove=function(){var e=null;return this.workHead_&&(e=this.workHead_,this.workHead_=this.workHead_.next,this.workHead_||(this.workTail_=null),e.next=null),e},goog.async.WorkQueue.prototype.returnUnused=function(e){goog.async.WorkQueue.freelist_.put(e)},goog.async.WorkQueue.prototype.getUnusedItem_=function(){return goog.async.WorkQueue.freelist_.get()},goog.async.WorkItem=function(){this.next=this.scope=this.fn=null},goog.async.WorkItem.prototype.set=function(e,t){this.fn=e,this.scope=t,this.next=null},goog.async.WorkItem.prototype.reset=function(){this.next=this.scope=this.fn=null},goog.debug.entryPointRegistry={},goog.debug.EntryPointMonitor=function(){},goog.debug.entryPointRegistry.refList_=[],goog.debug.entryPointRegistry.monitors_=[],goog.debug.entryPointRegistry.monitorsMayExist_=!1,goog.debug.entryPointRegistry.register=function(e){if(goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=e,goog.debug.entryPointRegistry.monitorsMayExist_)for(var t=goog.debug.entryPointRegistry.monitors_,o=0;o<t.length;o++)e(goog.bind(t[o].wrap,t[o]))},goog.debug.entryPointRegistry.monitorAll=function(e){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var t=goog.bind(e.wrap,e),o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](t);goog.debug.entryPointRegistry.monitors_.push(e)},goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(e){var t=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(e==t[t.length-1],"Only the most recent monitor can be unwrapped."),e=goog.bind(e.unwrap,e);for(var o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](e);t.length--},goog.dom.HtmlElement=function(){},goog.dom.TagName=function(e){this.tagName_=e},goog.dom.TagName.prototype.toString=function(){return this.tagName_},goog.dom.TagName.A=new goog.dom.TagName("A"),goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR"),goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM"),goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS"),goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET"),goog.dom.TagName.AREA=new goog.dom.TagName("AREA"),goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE"),goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE"),goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO"),goog.dom.TagName.B=new goog.dom.TagName("B"),goog.dom.TagName.BASE=new goog.dom.TagName("BASE"),goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT"),goog.dom.TagName.BDI=new goog.dom.TagName("BDI"),goog.dom.TagName.BDO=new goog.dom.TagName("BDO"),goog.dom.TagName.BIG=new goog.dom.TagName("BIG"),goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE"),goog.dom.TagName.BODY=new goog.dom.TagName("BODY"),goog.dom.TagName.BR=new goog.dom.TagName("BR"),goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON"),goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS"),goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION"),goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER"),goog.dom.TagName.CITE=new goog.dom.TagName("CITE"),goog.dom.TagName.CODE=new goog.dom.TagName("CODE"),goog.dom.TagName.COL=new goog.dom.TagName("COL"),goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP"),goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND"),goog.dom.TagName.DATA=new goog.dom.TagName("DATA"),goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST"),goog.dom.TagName.DD=new goog.dom.TagName("DD"),goog.dom.TagName.DEL=new goog.dom.TagName("DEL"),goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS"),goog.dom.TagName.DFN=new goog.dom.TagName("DFN"),goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG"),goog.dom.TagName.DIR=new goog.dom.TagName("DIR"),goog.dom.TagName.DIV=new goog.dom.TagName("DIV"),goog.dom.TagName.DL=new goog.dom.TagName("DL"),goog.dom.TagName.DT=new goog.dom.TagName("DT"),goog.dom.TagName.EM=new goog.dom.TagName("EM"),goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED"),goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET"),goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION"),goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE"),goog.dom.TagName.FONT=new goog.dom.TagName("FONT"),goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER"),goog.dom.TagName.FORM=new goog.dom.TagName("FORM"),goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME"),goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET"),goog.dom.TagName.H1=new goog.dom.TagName("H1"),goog.dom.TagName.H2=new goog.dom.TagName("H2"),goog.dom.TagName.H3=new goog.dom.TagName("H3"),goog.dom.TagName.H4=new goog.dom.TagName("H4"),goog.dom.TagName.H5=new goog.dom.TagName("H5"),goog.dom.TagName.H6=new goog.dom.TagName("H6"),goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD"),goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER"),goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP"),goog.dom.TagName.HR=new goog.dom.TagName("HR"),goog.dom.TagName.HTML=new goog.dom.TagName("HTML"),goog.dom.TagName.I=new goog.dom.TagName("I"),goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME"),goog.dom.TagName.IMG=new goog.dom.TagName("IMG"),goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT"),goog.dom.TagName.INS=new goog.dom.TagName("INS"),goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX"),goog.dom.TagName.KBD=new goog.dom.TagName("KBD"),goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN"),goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL"),goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND"),goog.dom.TagName.LI=new goog.dom.TagName("LI"),goog.dom.TagName.LINK=new goog.dom.TagName("LINK"),goog.dom.TagName.MAIN=new goog.dom.TagName("MAIN"),goog.dom.TagName.MAP=new goog.dom.TagName("MAP"),goog.dom.TagName.MARK=new goog.dom.TagName("MARK"),goog.dom.TagName.MATH=new goog.dom.TagName("MATH"),goog.dom.TagName.MENU=new goog.dom.TagName("MENU"),goog.dom.TagName.MENUITEM=new goog.dom.TagName("MENUITEM"),goog.dom.TagName.META=new goog.dom.TagName("META"),goog.dom.TagName.METER=new goog.dom.TagName("METER"),goog.dom.TagName.NAV=new goog.dom.TagName("NAV"),goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES"),goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT"),goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT"),goog.dom.TagName.OL=new goog.dom.TagName("OL"),goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP"),goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION"),goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT"),goog.dom.TagName.P=new goog.dom.TagName("P"),goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM"),goog.dom.TagName.PICTURE=new goog.dom.TagName("PICTURE"),goog.dom.TagName.PRE=new goog.dom.TagName("PRE"),goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS"),goog.dom.TagName.Q=new goog.dom.TagName("Q"),goog.dom.TagName.RP=new goog.dom.TagName("RP"),goog.dom.TagName.RT=new goog.dom.TagName("RT"),goog.dom.TagName.RTC=new goog.dom.TagName("RTC"),goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY"),goog.dom.TagName.S=new goog.dom.TagName("S"),goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP"),goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT"),goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION"),goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT"),goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL"),goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE"),goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN"),goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE"),goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG"),goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE"),goog.dom.TagName.SUB=new goog.dom.TagName("SUB"),goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY"),goog.dom.TagName.SUP=new goog.dom.TagName("SUP"),goog.dom.TagName.SVG=new goog.dom.TagName("SVG"),goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE"),goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY"),goog.dom.TagName.TD=new goog.dom.TagName("TD"),goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE"),goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA"),goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT"),goog.dom.TagName.TH=new goog.dom.TagName("TH"),goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD"),goog.dom.TagName.TIME=new goog.dom.TagName("TIME"),goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE"),goog.dom.TagName.TR=new goog.dom.TagName("TR"),goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK"),goog.dom.TagName.TT=new goog.dom.TagName("TT"),goog.dom.TagName.U=new goog.dom.TagName("U"),goog.dom.TagName.UL=new goog.dom.TagName("UL"),goog.dom.TagName.VAR=new goog.dom.TagName("VAR"),goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO"),goog.dom.TagName.WBR=new goog.dom.TagName("WBR"),goog.functions={},goog.functions.constant=function(e){return function(){return e}},goog.functions.FALSE=goog.functions.constant(!1),goog.functions.TRUE=goog.functions.constant(!0),goog.functions.NULL=goog.functions.constant(null),goog.functions.identity=function(e,t){return e},goog.functions.error=function(e){return function(){throw Error(e)}},goog.functions.fail=function(e){return function(){throw e}},goog.functions.lock=function(e,t){return t=t||0,function(){return e.apply(this,Array.prototype.slice.call(arguments,0,t))}},goog.functions.nth=function(e){return function(){return arguments[e]}},goog.functions.partialRight=function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=Array.prototype.slice.call(arguments);return t.push.apply(t,o),e.apply(this,t)}},goog.functions.withReturnValue=function(e,t){return goog.functions.sequence(e,goog.functions.constant(t))},goog.functions.equalTo=function(e,t){return function(o){return t?e==o:e===o}},goog.functions.compose=function(e,t){var o=arguments,i=o.length;return function(){var e;i&&(e=o[i-1].apply(this,arguments));for(var t=i-2;0<=t;t--)e=o[t].call(this,e);return e}},goog.functions.sequence=function(e){var t=arguments,o=t.length;return function(){for(var e,i=0;i<o;i++)e=t[i].apply(this,arguments);return e}},goog.functions.and=function(e){var t=arguments,o=t.length;return function(){for(var e=0;e<o;e++)if(!t[e].apply(this,arguments))return!1;return!0}},goog.functions.or=function(e){var t=arguments,o=t.length;return function(){for(var e=0;e<o;e++)if(t[e].apply(this,arguments))return!0;return!1}},goog.functions.not=function(e){return function(){return!e.apply(this,arguments)}},goog.functions.create=function(e,t){var o=function(){};return o.prototype=e.prototype,o=new o,e.apply(o,Array.prototype.slice.call(arguments,1)),o},goog.functions.CACHE_RETURN_VALUE=!0,goog.functions.cacheReturnValue=function(e){var t,o=!1;return function(){return goog.functions.CACHE_RETURN_VALUE?(o||(t=e(),o=!0),t):e()}},goog.functions.once=function(e){var t=e;return function(){if(t){var e=t;t=null,e()}}},goog.functions.debounce=function(e,t,o){var i=0;return function(n){goog.global.clearTimeout(i);var r=arguments;i=goog.global.setTimeout(function(){e.apply(o,r)},t)}},goog.functions.throttle=function(e,t,o){var i=0,n=!1,r=[],s=function(){i=0,n&&(n=!1,a())},a=function(){i=goog.global.setTimeout(s,t),e.apply(o,r)};return function(e){r=arguments,i?n=!0:a()}},goog.functions.rateLimit=function(e,t,o){var i=0,n=function(){i=0};return function(r){i||(i=goog.global.setTimeout(n,t),e.apply(o,arguments))}},goog.async.throwException=function(e){goog.global.setTimeout(function(){throw e},0)},goog.async.nextTick=function(e,t,o){var i=e;t&&(i=goog.bind(e,t)),i=goog.async.nextTick.wrapCallback_(i),goog.isFunction(goog.global.setImmediate)&&(o||goog.async.nextTick.useSetImmediate_())?goog.global.setImmediate(i):(goog.async.nextTick.setImmediate_||(goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_()),goog.async.nextTick.setImmediate_(i))},goog.async.nextTick.useSetImmediate_=function(){return!(goog.global.Window&&goog.global.Window.prototype&&!goog.labs.userAgent.browser.isEdge()&&goog.global.Window.prototype.setImmediate==goog.global.setImmediate)},goog.async.nextTick.getSetImmediateEmulator_=function(){var e=goog.global.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto()&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var o="callImmediate"+Math.random(),i="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=goog.bind(function(e){"*"!=i&&e.origin!=i||e.data!=o||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(o,i)}}}),void 0!==e&&!goog.labs.userAgent.browser.isIE()){var t=new e,o={},i=o;return t.port1.onmessage=function(){if(goog.isDef(o.next)){var e=(o=o.next).cb;o.cb=null,e()}},function(e){i.next={cb:e},i=i.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){goog.global.setTimeout(e,0)}},goog.async.nextTick.wrapCallback_=goog.functions.identity,goog.debug.entryPointRegistry.register(function(e){goog.async.nextTick.wrapCallback_=e}),goog.async.run=function(e,t){goog.async.run.schedule_||goog.async.run.initializeRunner_(),goog.async.run.workQueueScheduled_||(goog.async.run.schedule_(),goog.async.run.workQueueScheduled_=!0),goog.async.run.workQueue_.add(e,t)},goog.async.run.initializeRunner_=function(){if(-1!=String(goog.global.Promise).indexOf("[native code]")){var e=goog.global.Promise.resolve(void 0);goog.async.run.schedule_=function(){e.then(goog.async.run.processWorkQueue)}}else goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue)}},goog.async.run.forceNextTick=function(e){goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue),e&&e(goog.async.run.processWorkQueue)}},goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue,goog.DEBUG&&(goog.async.run.resetQueue=function(){goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue}),goog.async.run.processWorkQueue=function(){for(var e;e=goog.async.run.workQueue_.remove();){try{e.fn.call(e.scope)}catch(e){goog.async.throwException(e)}goog.async.run.workQueue_.returnUnused(e)}goog.async.run.workQueueScheduled_=!1},goog.promise={},goog.promise.Resolver=function(){},goog.Promise=function(e,t){if(this.state_=goog.Promise.State_.PENDING,this.result_=void 0,this.callbackEntriesTail_=this.callbackEntries_=this.parent_=null,this.executing_=!1,0<goog.Promise.UNHANDLED_REJECTION_DELAY?this.unhandledRejectionId_=0:0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1),goog.Promise.LONG_STACK_TRACES&&(this.stack_=[],this.addStackTrace_(Error("created")),this.currentStep_=0),e!=goog.nullFunction)try{var o=this;e.call(t,function(e){o.resolve_(goog.Promise.State_.FULFILLED,e)},function(e){if(goog.DEBUG&&!(e instanceof goog.Promise.CancellationError))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}o.resolve_(goog.Promise.State_.REJECTED,e)})}catch(e){this.resolve_(goog.Promise.State_.REJECTED,e)}},goog.Promise.LONG_STACK_TRACES=!1,goog.Promise.UNHANDLED_REJECTION_DELAY=0,goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3},goog.Promise.CallbackEntry_=function(){this.next=this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.CallbackEntry_.prototype.reset=function(){this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.DEFAULT_MAX_UNUSED=100,goog.Promise.freelist_=new goog.async.FreeList(function(){return new goog.Promise.CallbackEntry_},function(e){e.reset()},goog.Promise.DEFAULT_MAX_UNUSED),goog.Promise.getCallbackEntry_=function(e,t,o){var i=goog.Promise.freelist_.get();return i.onFulfilled=e,i.onRejected=t,i.context=o,i},goog.Promise.returnEntry_=function(e){goog.Promise.freelist_.put(e)},goog.Promise.resolve=function(e){if(e instanceof goog.Promise)return e;var t=new goog.Promise(goog.nullFunction);return t.resolve_(goog.Promise.State_.FULFILLED,e),t},goog.Promise.reject=function(e){return new goog.Promise(function(t,o){o(e)})},goog.Promise.resolveThen_=function(e,t,o){goog.Promise.maybeThen_(e,t,o,null)||goog.async.run(goog.partial(t,e))},goog.Promise.race=function(e){return new goog.Promise(function(t,o){e.length||t(void 0);for(var i,n=0;n<e.length;n++)i=e[n],goog.Promise.resolveThen_(i,t,o)})},goog.Promise.all=function(e){return new goog.Promise(function(t,o){var i=e.length,n=[];if(i)for(var r,s=function(e,o){i--,n[e]=o,0==i&&t(n)},a=function(e){o(e)},l=0;l<e.length;l++)r=e[l],goog.Promise.resolveThen_(r,goog.partial(s,l),a);else t(n)})},goog.Promise.allSettled=function(e){return new goog.Promise(function(t,o){var i=e.length,n=[];if(i)for(var r,s=function(e,o,r){i--,n[e]=o?{fulfilled:!0,value:r}:{fulfilled:!1,reason:r},0==i&&t(n)},a=0;a<e.length;a++)r=e[a],goog.Promise.resolveThen_(r,goog.partial(s,a,!0),goog.partial(s,a,!1));else t(n)})},goog.Promise.firstFulfilled=function(e){return new goog.Promise(function(t,o){var i=e.length,n=[];if(i)for(var r,s=function(e){t(e)},a=function(e,t){i--,n[e]=t,0==i&&o(n)},l=0;l<e.length;l++)r=e[l],goog.Promise.resolveThen_(r,s,goog.partial(a,l));else t(void 0)})},goog.Promise.withResolver=function(){var e,t,o=new goog.Promise(function(o,i){e=o,t=i});return new goog.Promise.Resolver_(o,e,t)},goog.Promise.prototype.then=function(e,t,o){return null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function."),null!=t&&goog.asserts.assertFunction(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addChildPromise_(goog.isFunction(e)?e:null,goog.isFunction(t)?t:null,o)},goog.Thenable.addImplementation(goog.Promise),goog.Promise.prototype.thenVoid=function(e,t,o){null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function."),null!=t&&goog.asserts.assertFunction(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addCallbackEntry_(goog.Promise.getCallbackEntry_(e||goog.nullFunction,t||null,o))},goog.Promise.prototype.thenAlways=function(e,t){goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenAlways"));var o=goog.Promise.getCallbackEntry_(e,e,t);return o.always=!0,this.addCallbackEntry_(o),this},goog.Promise.prototype.thenCatch=function(e,t){return goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenCatch")),this.addChildPromise_(null,e,t)},goog.Promise.prototype.cancel=function(e){this.state_==goog.Promise.State_.PENDING&&goog.async.run(function(){var t=new goog.Promise.CancellationError(e);this.cancelInternal_(t)},this)},goog.Promise.prototype.cancelInternal_=function(e){this.state_==goog.Promise.State_.PENDING&&(this.parent_?(this.parent_.cancelChild_(this,e),this.parent_=null):this.resolve_(goog.Promise.State_.REJECTED,e))},goog.Promise.prototype.cancelChild_=function(e,t){if(this.callbackEntries_){for(var o=0,i=null,n=null,r=this.callbackEntries_;r&&(r.always||(o++,r.child==e&&(i=r),!(i&&1<o)));r=r.next)i||(n=r);i&&(this.state_==goog.Promise.State_.PENDING&&1==o?this.cancelInternal_(t):(n?this.removeEntryAfter_(n):this.popEntry_(),this.executeCallback_(i,goog.Promise.State_.REJECTED,t)))}},goog.Promise.prototype.addCallbackEntry_=function(e){this.hasEntry_()||this.state_!=goog.Promise.State_.FULFILLED&&this.state_!=goog.Promise.State_.REJECTED||this.scheduleCallbacks_(),this.queueEntry_(e)},goog.Promise.prototype.addChildPromise_=function(e,t,o){var i=goog.Promise.getCallbackEntry_(null,null,null);return i.child=new goog.Promise(function(n,r){i.onFulfilled=e?function(t){try{var i=e.call(o,t);n(i)}catch(e){r(e)}}:n,i.onRejected=t?function(e){try{var i=t.call(o,e);!goog.isDef(i)&&e instanceof goog.Promise.CancellationError?r(e):n(i)}catch(e){r(e)}}:r}),i.child.parent_=this,this.addCallbackEntry_(i),i.child},goog.Promise.prototype.unblockAndFulfill_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.FULFILLED,e)},goog.Promise.prototype.unblockAndReject_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.REJECTED,e)},goog.Promise.prototype.resolve_=function(e,t){this.state_==goog.Promise.State_.PENDING&&(this===t&&(e=goog.Promise.State_.REJECTED,t=new TypeError("Promise cannot resolve to itself")),this.state_=goog.Promise.State_.BLOCKED,goog.Promise.maybeThen_(t,this.unblockAndFulfill_,this.unblockAndReject_,this)||(this.result_=t,this.state_=e,this.parent_=null,this.scheduleCallbacks_(),e!=goog.Promise.State_.REJECTED||t instanceof goog.Promise.CancellationError||goog.Promise.addUnhandledRejection_(this,t)))},goog.Promise.maybeThen_=function(e,t,o,i){if(e instanceof goog.Promise)return e.thenVoid(t,o,i),!0;if(goog.Thenable.isImplementedBy(e))return e.then(t,o,i),!0;if(goog.isObject(e))try{var n=e.then;if(goog.isFunction(n))return goog.Promise.tryThen_(e,n,t,o,i),!0}catch(e){return o.call(i,e),!0}return!1},goog.Promise.tryThen_=function(e,t,o,i,n){var r=!1,s=function(e){r||(r=!0,i.call(n,e))};try{t.call(e,function(e){r||(r=!0,o.call(n,e))},s)}catch(e){s(e)}},goog.Promise.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,goog.async.run(this.executeCallbacks_,this))},goog.Promise.prototype.hasEntry_=function(){return!!this.callbackEntries_},goog.Promise.prototype.queueEntry_=function(e){goog.asserts.assert(null!=e.onFulfilled),this.callbackEntriesTail_?this.callbackEntriesTail_.next=e:this.callbackEntries_=e,this.callbackEntriesTail_=e},goog.Promise.prototype.popEntry_=function(){var e=null;return this.callbackEntries_&&(e=this.callbackEntries_,this.callbackEntries_=e.next,e.next=null),this.callbackEntries_||(this.callbackEntriesTail_=null),null!=e&&goog.asserts.assert(null!=e.onFulfilled),e},goog.Promise.prototype.removeEntryAfter_=function(e){goog.asserts.assert(this.callbackEntries_),goog.asserts.assert(null!=e),e.next==this.callbackEntriesTail_&&(this.callbackEntriesTail_=e),e.next=e.next.next},goog.Promise.prototype.executeCallbacks_=function(){for(var e;e=this.popEntry_();)goog.Promise.LONG_STACK_TRACES&&this.currentStep_++,this.executeCallback_(e,this.state_,this.result_);this.executing_=!1},goog.Promise.prototype.executeCallback_=function(e,t,o){if(t==goog.Promise.State_.REJECTED&&e.onRejected&&!e.always&&this.removeUnhandledRejection_(),e.child)e.child.parent_=null,goog.Promise.invokeCallback_(e,t,o);else try{e.always?e.onFulfilled.call(e.context):goog.Promise.invokeCallback_(e,t,o)}catch(e){goog.Promise.handleRejection_.call(null,e)}goog.Promise.returnEntry_(e)},goog.Promise.invokeCallback_=function(e,t,o){t==goog.Promise.State_.FULFILLED?e.onFulfilled.call(e.context,o):e.onRejected&&e.onRejected.call(e.context,o)},goog.Promise.prototype.addStackTrace_=function(e){if(goog.Promise.LONG_STACK_TRACES&&goog.isString(e.stack)){var t=e.stack.split("\n",4)[3];e=e.message,e+=Array(11-e.length).join(" "),this.stack_.push(e+t)}},goog.Promise.prototype.appendLongStack_=function(e){if(goog.Promise.LONG_STACK_TRACES&&e&&goog.isString(e.stack)&&this.stack_.length){for(var t=["Promise trace:"],o=this;o;o=o.parent_){for(var i=this.currentStep_;0<=i;i--)t.push(o.stack_[i]);t.push("Value: ["+(o.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] <"+String(o.result_)+">")}e.stack+="\n\n"+t.join("\n")}},goog.Promise.prototype.removeUnhandledRejection_=function(){if(0<goog.Promise.UNHANDLED_REJECTION_DELAY)for(var e=this;e&&e.unhandledRejectionId_;e=e.parent_)goog.global.clearTimeout(e.unhandledRejectionId_),e.unhandledRejectionId_=0;else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY)for(e=this;e&&e.hadUnhandledRejection_;e=e.parent_)e.hadUnhandledRejection_=!1},goog.Promise.addUnhandledRejection_=function(e,t){0<goog.Promise.UNHANDLED_REJECTION_DELAY?e.unhandledRejectionId_=goog.global.setTimeout(function(){e.appendLongStack_(t),goog.Promise.handleRejection_.call(null,t)},goog.Promise.UNHANDLED_REJECTION_DELAY):0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(e.hadUnhandledRejection_=!0,goog.async.run(function(){e.hadUnhandledRejection_&&(e.appendLongStack_(t),goog.Promise.handleRejection_.call(null,t))}))},goog.Promise.handleRejection_=goog.async.throwException,goog.Promise.setUnhandledRejectionHandler=function(e){goog.Promise.handleRejection_=e},goog.Promise.CancellationError=function(e){goog.debug.Error.call(this,e)},goog.inherits(goog.Promise.CancellationError,goog.debug.Error),goog.Promise.CancellationError.prototype.name="cancel",goog.Promise.Resolver_=function(e,t,o){this.promise=e,this.resolve=t,this.reject=o},goog.disposable={},goog.disposable.IDisposable=function(){},goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod,goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod,goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(goog.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=Error().stack),goog.Disposable.instances_[goog.getUid(this)]=this),this.disposed_=this.disposed_,this.onDisposeCallbacks_=this.onDisposeCallbacks_},goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2},goog.Disposable.MONITORING_MODE=0,goog.Disposable.INCLUDE_STACK_ON_CREATION=!0,goog.Disposable.instances_={},goog.Disposable.getUndisposedObjects=function(){var e,t=[];for(e in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(e)&&t.push(goog.Disposable.instances_[Number(e)]);return t},goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}},goog.Disposable.prototype.disposed_=!1,goog.Disposable.prototype.isDisposed=function(){return this.disposed_},goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed,goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var e=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(e))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&this.onDisposeCallbacks_&&0<this.onDisposeCallbacks_.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete goog.Disposable.instances_[e]}},goog.Disposable.prototype.registerDisposable=function(e){this.addOnDisposeCallback(goog.partial(goog.dispose,e))},goog.Disposable.prototype.addOnDisposeCallback=function(e,t){this.disposed_?goog.isDef(t)?e.call(t):e():(this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(goog.isDef(t)?goog.bind(e,t):e))},goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()},goog.Disposable.isDisposed=function(e){return!(!e||"function"!=typeof e.isDisposed)&&e.isDisposed()},goog.dispose=function(e){e&&"function"==typeof e.dispose&&e.dispose()},goog.disposeAll=function(e){for(var t=0,o=arguments.length;t<o;++t){var i=arguments[t];goog.isArrayLike(i)?goog.disposeAll.apply(null,i):goog.dispose(i)}},goog.debug.errorcontext={},goog.debug.errorcontext.addErrorContext=function(e,t,o){e[goog.debug.errorcontext.CONTEXT_KEY_]||(e[goog.debug.errorcontext.CONTEXT_KEY_]={}),e[goog.debug.errorcontext.CONTEXT_KEY_][t]=o},goog.debug.errorcontext.getErrorContext=function(e){return e[goog.debug.errorcontext.CONTEXT_KEY_]||{}},goog.debug.errorcontext.CONTEXT_KEY_="__closure__error__context__984382",goog.debug.LOGGING_ENABLED=goog.DEBUG,goog.debug.FORCE_SLOPPY_STACKS=!1,goog.debug.catchErrors=function(e,t,o){var i=(o=o||goog.global).onerror,n=!!t;goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("535.3")&&(n=!n),o.onerror=function(t,o,r,s,a){return i&&i(t,o,r,s,a),e({message:t,fileName:o,line:r,lineNumber:r,col:s,error:a}),n}},goog.debug.expose=function(e,t){if(void 0===e)return"undefined";if(null==e)return"NULL";var o,i=[];for(o in e)if(t||!goog.isFunction(e[o])){var n=o+" = ";try{n+=e[o]}catch(e){n+="*** "+e+" ***"}i.push(n)}return i.join("\n")},goog.debug.deepExpose=function(e,t){var o=[],i=[],n={},r=function(e,s){var a=s+"  ";try{if(goog.isDef(e))if(goog.isNull(e))o.push("NULL");else if(goog.isString(e))o.push('"'+e.replace(/\n/g,"\n"+s)+'"');else if(goog.isFunction(e))o.push(String(e).replace(/\n/g,"\n"+s));else if(goog.isObject(e)){goog.hasUid(e)||i.push(e);var l=goog.getUid(e);if(n[l])o.push("*** reference loop detected (id="+l+") ***");else{for(var c in n[l]=!0,o.push("{"),e)!t&&goog.isFunction(e[c])||(o.push("\n"),o.push(a),o.push(c+" = "),r(e[c],a));o.push("\n"+s+"}"),delete n[l]}}else o.push(e);else o.push("undefined")}catch(e){o.push("*** "+e+" ***")}};r(e,"");for(var s=0;s<i.length;s++)goog.removeUid(i[s]);return o.join("")},goog.debug.exposeArray=function(e){for(var t=[],o=0;o<e.length;o++)goog.isArray(e[o])?t.push(goog.debug.exposeArray(e[o])):t.push(e[o]);return"[ "+t.join(", ")+" ]"},goog.debug.normalizeErrorObject=function(e){var t=goog.getObjectByName("window.location.href");if(goog.isString(e))return{message:e,name:"Unknown error",lineNumber:"Not available",fileName:t,stack:"Not available"};var o=!1;try{var i=e.lineNumber||e.line||"Not available"}catch(e){i="Not available",o=!0}try{var n=e.fileName||e.filename||e.sourceURL||goog.global.$googDebugFname||t}catch(e){n="Not available",o=!0}return!o&&e.lineNumber&&e.fileName&&e.stack&&e.message&&e.name?e:{message:e.message||"Not available",name:e.name||"UnknownError",lineNumber:i,fileName:n,stack:e.stack||"Not available"}},goog.debug.enhanceError=function(e,t){if(e instanceof Error)var o=e;else o=Error(e),Error.captureStackTrace&&Error.captureStackTrace(o,goog.debug.enhanceError);if(o.stack||(o.stack=goog.debug.getStacktrace(goog.debug.enhanceError)),t){for(var i=0;o["message"+i];)++i;o["message"+i]=String(t)}return o},goog.debug.enhanceErrorWithContext=function(e,t){var o=goog.debug.enhanceError(e);if(t)for(var i in t)goog.debug.errorcontext.addErrorContext(o,i,t[i]);return o},goog.debug.getStacktraceSimple=function(e){if(!goog.debug.FORCE_SLOPPY_STACKS){var t=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(t)return t}t=[];for(var o=arguments.callee.caller,i=0;o&&(!e||i<e);){t.push(goog.debug.getFunctionName(o)),t.push("()\n");try{o=o.caller}catch(e){t.push("[exception trying to get caller]\n");break}if(++i>=goog.debug.MAX_STACK_DEPTH){t.push("[...long stack...]");break}}return e&&i>=e?t.push("[...reached max depth limit...]"):t.push("[end]"),t.join("")},goog.debug.MAX_STACK_DEPTH=50,goog.debug.getNativeStackTrace_=function(e){var t=Error();if(Error.captureStackTrace)return Error.captureStackTrace(t,e),String(t.stack);try{throw t}catch(e){t=e}return(e=t.stack)?String(e):null},goog.debug.getStacktrace=function(e){var t;return goog.debug.FORCE_SLOPPY_STACKS||(t=goog.debug.getNativeStackTrace_(e||goog.debug.getStacktrace)),t||(t=goog.debug.getStacktraceHelper_(e||arguments.callee.caller,[])),t},goog.debug.getStacktraceHelper_=function(e,t){var o=[];if(goog.array.contains(t,e))o.push("[...circular reference...]");else if(e&&t.length<goog.debug.MAX_STACK_DEPTH){o.push(goog.debug.getFunctionName(e)+"(");for(var i=e.arguments,n=0;i&&n<i.length;n++){0<n&&o.push(", ");var r=i[n];switch(typeof r){case"object":r=r?"object":"null";break;case"string":break;case"number":r=String(r);break;case"boolean":r=r?"true":"false";break;case"function":r=(r=goog.debug.getFunctionName(r))?r:"[fn]";break;default:r=typeof r}40<r.length&&(r=r.substr(0,40)+"..."),o.push(r)}t.push(e),o.push(")\n");try{o.push(goog.debug.getStacktraceHelper_(e.caller,t))}catch(e){o.push("[exception trying to get caller]\n")}}else e?o.push("[...long stack...]"):o.push("[end]");return o.join("")},goog.debug.setFunctionResolver=function(e){goog.debug.fnNameResolver_=e},goog.debug.getFunctionName=function(e){if(goog.debug.fnNameCache_[e])return goog.debug.fnNameCache_[e];if(goog.debug.fnNameResolver_){var t=goog.debug.fnNameResolver_(e);if(t)return goog.debug.fnNameCache_[e]=t}return e=String(e),goog.debug.fnNameCache_[e]||(t=/function ([^\(]+)/.exec(e),goog.debug.fnNameCache_[e]=t?t[1]:"[Anonymous]"),goog.debug.fnNameCache_[e]},goog.debug.makeWhitespaceVisible=function(e){return e.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")},goog.debug.runtimeType=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},goog.debug.fnNameCache_={},goog.debug.freezeInternal_=goog.DEBUG&&Object.freeze||function(e){return e},goog.debug.freeze=function(e){return goog.debug.freezeInternal_(e)},goog.events={},$jscomp.scope.purify=function(e){return e()},goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.maxTouchPoints&&!goog.global.navigator.msMaxTouchPoints),POINTER_EVENTS:"PointerEvent"in goog.global,MSPOINTER_EVENTS:"MSPointerEvent"in goog.global&&!(!goog.global.navigator||!goog.global.navigator.msPointerEnabled),PASSIVE_EVENTS:(0,$jscomp.scope.purify)(function(){if(!goog.global.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});return goog.global.addEventListener("test",goog.nullFunction,t),goog.global.removeEventListener("test",goog.nullFunction,t),e})},goog.events.EventId=function(e){this.id=e},goog.events.EventId.prototype.toString=function(){return this.id},goog.events.Event=function(e,t){this.type=e instanceof goog.events.EventId?String(e):e,this.currentTarget=this.target=t,this.defaultPrevented=this.propagationStopped_=!1,this.returnValue_=!0},goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0},goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0,this.returnValue_=!1},goog.events.Event.stopPropagation=function(e){e.stopPropagation()},goog.events.Event.preventDefault=function(e){e.preventDefault()},goog.events.getVendorPrefixedName_=function(e){return goog.userAgent.WEBKIT?"webkit"+e:goog.userAgent.OPERA?"o"+e.toLowerCase():e.toLowerCase()},goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTIONCHANGE:"selectionchange",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:"focusin",FOCUSOUT:"focusout",CHANGE:"change",RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DEVICEMOTION:"devicemotion",DEVICEORIENTATION:"deviceorientation",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",DURATIONCHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",LOADEDDATA:"loadeddata",LOADEDMETADATA:"loadedmetadata",PAUSE:"pause",PLAY:"play",PLAYING:"playing",RATECHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIMEUPDATE:"timeupdate",VOLUMECHANGE:"volumechange",WAITING:"waiting",SOURCEOPEN:"sourceopen",SOURCEENDED:"sourceended",SOURCECLOSED:"sourceclosed",ABORT:"abort",UPDATE:"update",UPDATESTART:"updatestart",UPDATEEND:"updateend",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",INSTALL:"install",ACTIVATE:"activate",FETCH:"fetch",FOREIGNFETCH:"foreignfetch",MESSAGEERROR:"messageerror",STATECHANGE:"statechange",UPDATEFOUND:"updatefound",CONTROLLERCHANGE:"controllerchange",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:goog.userAgent.IE?"textinput":"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",BEFOREINPUT:"beforeinput",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",AFTERPRINT:"afterprint",BEFOREINSTALLPROMPT:"beforeinstallprompt",APPINSTALLED:"appinstalled"},goog.events.getPointerFallbackEventName_=function(e,t,o){return goog.events.BrowserFeature.POINTER_EVENTS?e:goog.events.BrowserFeature.MSPOINTER_EVENTS?t:o},goog.events.PointerFallbackEventType={POINTERDOWN:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERDOWN,goog.events.EventType.MSPOINTERDOWN,goog.events.EventType.MOUSEDOWN),POINTERUP:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERUP,goog.events.EventType.MSPOINTERUP,goog.events.EventType.MOUSEUP),POINTERCANCEL:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERCANCEL,goog.events.EventType.MSPOINTERCANCEL,"mousecancel"),POINTERMOVE:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERMOVE,goog.events.EventType.MSPOINTERMOVE,goog.events.EventType.MOUSEMOVE),POINTEROVER:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTEROVER,goog.events.EventType.MSPOINTEROVER,goog.events.EventType.MOUSEOVER),POINTEROUT:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTEROUT,goog.events.EventType.MSPOINTEROUT,goog.events.EventType.MOUSEOUT),POINTERENTER:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERENTER,goog.events.EventType.MSPOINTERENTER,goog.events.EventType.MOUSEENTER),POINTERLEAVE:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERLEAVE,goog.events.EventType.MSPOINTERLEAVE,goog.events.EventType.MOUSELEAVE)},goog.events.BrowserEvent=function(e,t){goog.events.Event.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.platformModifierKey=!1,this.pointerId=0,this.pointerType="",this.event_=null,e&&this.init(e,t)},goog.inherits(goog.events.BrowserEvent,goog.events.Event),goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2},goog.events.BrowserEvent.PointerType={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"},goog.events.BrowserEvent.IEButtonMap=goog.debug.freeze([1,4,2]),goog.events.BrowserEvent.IE_BUTTON_MAP=goog.events.BrowserEvent.IEButtonMap,goog.events.BrowserEvent.IE_POINTER_TYPE_MAP=goog.debug.freeze({2:goog.events.BrowserEvent.PointerType.TOUCH,3:goog.events.BrowserEvent.PointerType.PEN,4:goog.events.BrowserEvent.PointerType.MOUSE}),goog.events.BrowserEvent.prototype.init=function(e,t){var o=this.type=e.type,i=e.changedTouches?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.currentTarget=t;var n=e.relatedTarget;n?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(n,"nodeName")||(n=null)):o==goog.events.EventType.MOUSEOVER?n=e.fromElement:o==goog.events.EventType.MOUSEOUT&&(n=e.toElement),this.relatedTarget=n,goog.isNull(i)?(this.offsetX=goog.userAgent.WEBKIT||void 0!==e.offsetX?e.offsetX:e.layerX,this.offsetY=goog.userAgent.WEBKIT||void 0!==e.offsetY?e.offsetY:e.layerY,this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=e.button,this.keyCode=e.keyCode||0,this.key=e.key||"",this.charCode=e.charCode||("keypress"==o?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.platformModifierKey=goog.userAgent.MAC?e.metaKey:e.ctrlKey,this.pointerId=e.pointerId||0,this.pointerType=goog.events.BrowserEvent.getPointerType_(e),this.state=e.state,this.event_=e,e.defaultPrevented&&this.preventDefault()};goog.events.BrowserEvent.prototype.isButton=function(e){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==e:"click"==this.type?e==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IE_BUTTON_MAP[e])},goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)},goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this),this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0},goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var e=this.event_;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}},goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_},goog.events.BrowserEvent.getPointerType_=function(e){return goog.isString(e.pointerType)?e.pointerType:goog.events.BrowserEvent.IE_POINTER_TYPE_MAP[e.pointerType]||""},goog.events.Listenable=function(){},goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0),goog.events.Listenable.addImplementation=function(e){e.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0},goog.events.Listenable.isImplementedBy=function(e){return!(!e||!e[goog.events.Listenable.IMPLEMENTED_BY_PROP])},goog.events.ListenableKey=function(){},goog.events.ListenableKey.counter_=0,goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_},goog.events.Listener=function(e,t,o,i,n,r){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack),this.listener=e,this.proxy=t,this.src=o,this.type=i,this.capture=!!n,this.handler=r,this.key=goog.events.ListenableKey.reserveKey(),this.removed=this.callOnce=!1},goog.events.Listener.ENABLE_MONITORING=!1,goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0,this.handler=this.src=this.proxy=this.listener=null},goog.events.ListenerMap=function(e){this.src=e,this.listeners={},this.typeCount_=0},goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_},goog.events.ListenerMap.prototype.getListenerCount=function(){var e,t=0;for(e in this.listeners)t+=this.listeners[e].length;return t},goog.events.ListenerMap.prototype.add=function(e,t,o,i,n){var r=e.toString();(e=this.listeners[r])||(e=this.listeners[r]=[],this.typeCount_++);var s=goog.events.ListenerMap.findListenerIndex_(e,t,i,n);return-1<s?(t=e[s],o||(t.callOnce=!1)):((t=new goog.events.Listener(t,null,this.src,r,!!i,n)).callOnce=o,e.push(t)),t},goog.events.ListenerMap.prototype.remove=function(e,t,o,i){if(!((e=e.toString())in this.listeners))return!1;var n=this.listeners[e];return-1<(t=goog.events.ListenerMap.findListenerIndex_(n,t,o,i))&&(n[t].markAsRemoved(),goog.array.removeAt(n,t),0==n.length&&(delete this.listeners[e],this.typeCount_--),!0)},goog.events.ListenerMap.prototype.removeByKey=function(e){var t=e.type;if(!(t in this.listeners))return!1;var o=goog.array.remove(this.listeners[t],e);return o&&(e.markAsRemoved(),0==this.listeners[t].length&&(delete this.listeners[t],this.typeCount_--)),o},goog.events.ListenerMap.prototype.removeAll=function(e){e=e&&e.toString();var t,o=0;for(t in this.listeners)if(!e||t==e){for(var i=this.listeners[t],n=0;n<i.length;n++)++o,i[n].markAsRemoved();delete this.listeners[t],this.typeCount_--}return o},goog.events.ListenerMap.prototype.getListeners=function(e,t){var o=this.listeners[e.toString()],i=[];if(o)for(var n=0;n<o.length;++n){var r=o[n];r.capture==t&&i.push(r)}return i},goog.events.ListenerMap.prototype.getListener=function(e,t,o,i){var n=-1;return(e=this.listeners[e.toString()])&&(n=goog.events.ListenerMap.findListenerIndex_(e,t,o,i)),-1<n?e[n]:null},goog.events.ListenerMap.prototype.hasListener=function(e,t){var o=goog.isDef(e),i=o?e.toString():"",n=goog.isDef(t);return goog.object.some(this.listeners,function(e,r){for(var s=0;s<e.length;++s)if(!(o&&e[s].type!=i||n&&e[s].capture!=t))return!0;return!1})},goog.events.ListenerMap.findListenerIndex_=function(e,t,o,i){for(var n=0;n<e.length;++n){var r=e[n];if(!r.removed&&r.listener==t&&r.capture==!!o&&r.handler==i)return n}return-1},goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0),goog.events.onString_="on",goog.events.onStringMap_={},goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2},goog.events.CAPTURE_SIMULATION_MODE=2,goog.events.listenerCountEstimate_=0,goog.events.listen=function(e,t,o,i,n){if(i&&i.once)return goog.events.listenOnce(e,t,o,i,n);if(goog.isArray(t)){for(var r=0;r<t.length;r++)goog.events.listen(e,t[r],o,i,n);return null}return o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(e)?(i=goog.isObject(i)?!!i.capture:!!i,e.listen(t,o,i,n)):goog.events.listen_(e,t,o,!1,i,n)},goog.events.listen_=function(e,t,o,i,n,r){if(!t)throw Error("Invalid event type");var s=goog.isObject(n)?!!n.capture:!!n;if(s&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL)return goog.asserts.fail("Can not register capture listener in IE8-."),null;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var a=goog.events.getListenerMap_(e);if(a||(e[goog.events.LISTENER_MAP_PROP_]=a=new goog.events.ListenerMap(e)),(o=a.add(t,o,i,s,r)).proxy)return o;if(i=goog.events.getProxy(),o.proxy=i,i.src=e,i.listener=o,e.addEventListener)goog.events.BrowserFeature.PASSIVE_EVENTS||(n=s),void 0===n&&(n=!1),e.addEventListener(t.toString(),i,n);else if(e.attachEvent)e.attachEvent(goog.events.getOnString_(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");goog.asserts.assert("change"===t,"MediaQueryList only has a change event"),e.addListener(i)}return goog.events.listenerCountEstimate_++,o},goog.events.getProxy=function(){var e=goog.events.handleBrowserEvent_,t=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(o){return e.call(t.src,t.listener,o)}:function(o){if(!(o=e.call(t.src,t.listener,o)))return o};return t},goog.events.listenOnce=function(e,t,o,i,n){if(goog.isArray(t)){for(var r=0;r<t.length;r++)goog.events.listenOnce(e,t[r],o,i,n);return null}return o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(e)?(i=goog.isObject(i)?!!i.capture:!!i,e.listenOnce(t,o,i,n)):goog.events.listen_(e,t,o,!0,i,n)},goog.events.listenWithWrapper=function(e,t,o,i,n){t.listen(e,o,i,n)},goog.events.unlisten=function(e,t,o,i,n){if(goog.isArray(t)){for(var r=0;r<t.length;r++)goog.events.unlisten(e,t[r],o,i,n);return null}return i=goog.isObject(i)?!!i.capture:!!i,o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(e)?e.unlisten(t,o,i,n):!!e&&(!(!(e=goog.events.getListenerMap_(e))||!(t=e.getListener(t,o,i,n)))&&goog.events.unlistenByKey(t))},goog.events.unlistenByKey=function(e){if(goog.isNumber(e)||!e||e.removed)return!1;var t=e.src;if(goog.events.Listenable.isImplementedBy(t))return t.unlistenByKey(e);var o=e.type,i=e.proxy;return t.removeEventListener?t.removeEventListener(o,i,e.capture):t.detachEvent?t.detachEvent(goog.events.getOnString_(o),i):t.addListener&&t.removeListener&&t.removeListener(i),goog.events.listenerCountEstimate_--,(o=goog.events.getListenerMap_(t))?(o.removeByKey(e),0==o.getTypeCount()&&(o.src=null,t[goog.events.LISTENER_MAP_PROP_]=null)):e.markAsRemoved(),!0},goog.events.unlistenWithWrapper=function(e,t,o,i,n){t.unlisten(e,o,i,n)},goog.events.removeAll=function(e,t){if(!e)return 0;if(goog.events.Listenable.isImplementedBy(e))return e.removeAllListeners(t);var o=goog.events.getListenerMap_(e);if(!o)return 0;var i,n=0,r=t&&t.toString();for(i in o.listeners)if(!r||i==r)for(var s=o.listeners[i].concat(),a=0;a<s.length;++a)goog.events.unlistenByKey(s[a])&&++n;return n},goog.events.getListeners=function(e,t,o){return goog.events.Listenable.isImplementedBy(e)?e.getListeners(t,o):e&&(e=goog.events.getListenerMap_(e))?e.getListeners(t,o):[]},goog.events.getListener=function(e,t,o,i,n){return o=goog.events.wrapListener(o),i=!!i,goog.events.Listenable.isImplementedBy(e)?e.getListener(t,o,i,n):e&&(e=goog.events.getListenerMap_(e))?e.getListener(t,o,i,n):null},goog.events.hasListener=function(e,t,o){return goog.events.Listenable.isImplementedBy(e)?e.hasListener(t,o):!!(e=goog.events.getListenerMap_(e))&&e.hasListener(t,o)},goog.events.expose=function(e){var t,o=[];for(t in e)e[t]&&e[t].id?o.push(t+" = "+e[t]+" ("+e[t].id+")"):o.push(t+" = "+e[t]);return o.join("\n")},goog.events.getOnString_=function(e){return e in goog.events.onStringMap_?goog.events.onStringMap_[e]:goog.events.onStringMap_[e]=goog.events.onString_+e},goog.events.fireListeners=function(e,t,o,i){return goog.events.Listenable.isImplementedBy(e)?e.fireListeners(t,o,i):goog.events.fireListeners_(e,t,o,i)},goog.events.fireListeners_=function(e,t,o,i){var n=!0;if((e=goog.events.getListenerMap_(e))&&(t=e.listeners[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var r=t[e];r&&r.capture==o&&!r.removed&&(r=goog.events.fireListener(r,i),n=n&&!1!==r)}return n},goog.events.fireListener=function(e,t){var o=e.listener,i=e.handler||e.src;return e.callOnce&&goog.events.unlistenByKey(e),o.call(i,t)},goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_},goog.events.dispatchEvent=function(e,t){return goog.asserts.assert(goog.events.Listenable.isImplementedBy(e),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance."),e.dispatchEvent(t)},goog.events.protectBrowserEventEntryPoint=function(e){goog.events.handleBrowserEvent_=e.protectEntryPoint(goog.events.handleBrowserEvent_)},goog.events.handleBrowserEvent_=function(e,t){if(e.removed)return!0;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var o=t||goog.getObjectByName("window.event"),i=new goog.events.BrowserEvent(o,this),n=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(o)){goog.events.markIeEvent_(o),o=[];for(var r=i.currentTarget;r;r=r.parentNode)o.push(r);r=e.type;for(var s=o.length-1;!i.propagationStopped_&&0<=s;s--){i.currentTarget=o[s];var a=goog.events.fireListeners_(o[s],r,!0,i);n=n&&a}for(s=0;!i.propagationStopped_&&s<o.length;s++)i.currentTarget=o[s],a=goog.events.fireListeners_(o[s],r,!1,i),n=n&&a}}else n=goog.events.fireListener(e,i);return n}return goog.events.fireListener(e,new goog.events.BrowserEvent(t,this))},goog.events.markIeEvent_=function(e){var t=!1;if(0==e.keyCode)try{return void(e.keyCode=-1)}catch(e){t=!0}(t||void 0==e.returnValue)&&(e.returnValue=!0)},goog.events.isMarkedIeEvent_=function(e){return 0>e.keyCode||void 0!=e.returnValue},goog.events.uniqueIdCounter_=0,goog.events.getUniqueId=function(e){return e+"_"+goog.events.uniqueIdCounter_++},goog.events.getListenerMap_=function(e){return(e=e[goog.events.LISTENER_MAP_PROP_])instanceof goog.events.ListenerMap?e:null},goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0),goog.events.wrapListener=function(e){return goog.asserts.assert(e,"Listener can not be null."),goog.isFunction(e)?e:(goog.asserts.assert(e.handleEvent,"An object listener must have handleEvent method."),e[goog.events.LISTENER_WRAPPER_PROP_]||(e[goog.events.LISTENER_WRAPPER_PROP_]=function(t){return e.handleEvent(t)}),e[goog.events.LISTENER_WRAPPER_PROP_])},goog.debug.entryPointRegistry.register(function(e){goog.events.handleBrowserEvent_=e(goog.events.handleBrowserEvent_)}),goog.events.EventTarget=function(){goog.Disposable.call(this),this.eventTargetListeners_=new goog.events.ListenerMap(this),this.actualEventTarget_=this,this.parentEventTarget_=null},goog.inherits(goog.events.EventTarget,goog.Disposable),goog.events.Listenable.addImplementation(goog.events.EventTarget),goog.events.EventTarget.MAX_ANCESTORS_=1e3,goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_},goog.events.EventTarget.prototype.setParentEventTarget=function(e){this.parentEventTarget_=e},goog.events.EventTarget.prototype.addEventListener=function(e,t,o,i){goog.events.listen(this,e,t,o,i)},goog.events.EventTarget.prototype.removeEventListener=function(e,t,o,i){goog.events.unlisten(this,e,t,o,i)},goog.events.EventTarget.prototype.dispatchEvent=function(e){this.assertInitialized_();var t=this.getParentEventTarget();if(t)for(var o=[],i=1;t;t=t.getParentEventTarget())o.push(t),goog.asserts.assert(++i<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop");return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,e,o)},goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this),this.removeAllListeners(),this.parentEventTarget_=null},goog.events.EventTarget.prototype.listen=function(e,t,o,i){return this.assertInitialized_(),this.eventTargetListeners_.add(String(e),t,!1,o,i)},goog.events.EventTarget.prototype.listenOnce=function(e,t,o,i){return this.eventTargetListeners_.add(String(e),t,!0,o,i)},goog.events.EventTarget.prototype.unlisten=function(e,t,o,i){return this.eventTargetListeners_.remove(String(e),t,o,i)},goog.events.EventTarget.prototype.unlistenByKey=function(e){return this.eventTargetListeners_.removeByKey(e)},goog.events.EventTarget.prototype.removeAllListeners=function(e){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(e):0},goog.events.EventTarget.prototype.fireListeners=function(e,t,o){if(!(e=this.eventTargetListeners_.listeners[String(e)]))return!0;e=e.concat();for(var i=!0,n=0;n<e.length;++n){var r=e[n];if(r&&!r.removed&&r.capture==t){var s=r.listener,a=r.handler||r.src;r.callOnce&&this.unlistenByKey(r),i=!1!==s.call(a,o)&&i}}return i&&0!=o.returnValue_},goog.events.EventTarget.prototype.getListeners=function(e,t){return this.eventTargetListeners_.getListeners(String(e),t)},goog.events.EventTarget.prototype.getListener=function(e,t,o,i){return this.eventTargetListeners_.getListener(String(e),t,o,i)},goog.events.EventTarget.prototype.hasListener=function(e,t){var o=goog.isDef(e)?String(e):void 0;return this.eventTargetListeners_.hasListener(o,t)},goog.events.EventTarget.prototype.setTargetForTesting=function(e){this.actualEventTarget_=e},goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},goog.events.EventTarget.dispatchEventInternal_=function(e,t,o){var i=t.type||t;if(goog.isString(t))t=new goog.events.Event(t,e);else if(t instanceof goog.events.Event)t.target=t.target||e;else{var n=t;t=new goog.events.Event(i,e),goog.object.extend(t,n)}if(n=!0,o)for(var r=o.length-1;!t.propagationStopped_&&0<=r;r--){var s=t.currentTarget=o[r];n=s.fireListeners(i,!0,t)&&n}if(t.propagationStopped_||(n=(s=t.currentTarget=e).fireListeners(i,!0,t)&&n,t.propagationStopped_||(n=s.fireListeners(i,!1,t)&&n)),o)for(r=0;!t.propagationStopped_&&r<o.length;r++)n=(s=t.currentTarget=o[r]).fireListeners(i,!1,t)&&n;return n},goog.Timer=function(e,t){goog.events.EventTarget.call(this),this.interval_=e||1,this.timerObject_=t||goog.Timer.defaultTimerObject,this.boundTick_=goog.bind(this.tick_,this),this.last_=goog.now()},goog.inherits(goog.Timer,goog.events.EventTarget),goog.Timer.MAX_TIMEOUT_=2147483647,goog.Timer.INVALID_TIMEOUT_ID_=-1,goog.Timer.prototype.enabled=!1,goog.Timer.defaultTimerObject=goog.global,goog.Timer.intervalScale=.8,goog.Timer.prototype.timer_=null,goog.Timer.prototype.getInterval=function(){return this.interval_},goog.Timer.prototype.setInterval=function(e){this.interval_=e,this.timer_&&this.enabled?(this.stop(),this.start()):this.timer_&&this.stop()},goog.Timer.prototype.tick_=function(){if(this.enabled){var e=goog.now()-this.last_;0<e&&e<this.interval_*goog.Timer.intervalScale?this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-e):(this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null),this.dispatchTick(),this.enabled&&(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now()))}},goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)},goog.Timer.prototype.start=function(){this.enabled=!0,this.timer_||(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now())},goog.Timer.prototype.stop=function(){this.enabled=!1,this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null)},goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this),this.stop(),delete this.timerObject_},goog.Timer.TICK="tick",goog.Timer.callOnce=function(e,t,o){if(goog.isFunction(e))o&&(e=goog.bind(e,o));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=goog.bind(e.handleEvent,e)}return Number(t)>goog.Timer.MAX_TIMEOUT_?goog.Timer.INVALID_TIMEOUT_ID_:goog.Timer.defaultTimerObject.setTimeout(e,t||0)},goog.Timer.clear=function(e){goog.Timer.defaultTimerObject.clearTimeout(e)},goog.Timer.promise=function(e,t){var o=null;return new goog.Promise(function(i,n){(o=goog.Timer.callOnce(function(){i(t)},e))==goog.Timer.INVALID_TIMEOUT_ID_&&n(Error("Failed to schedule timer."))}).thenCatch(function(e){throw goog.Timer.clear(o),e})},goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)},goog.dom.asserts={},goog.dom.asserts.assertIsLocation=function(e){if(goog.asserts.ENABLE_ASSERTS){var t=goog.dom.asserts.getWindow_(e);void 0!==t.Location&&void 0!==t.Element&&goog.asserts.assert(e&&(e instanceof t.Location||!(e instanceof t.Element)),"Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(e))}return e},goog.dom.asserts.assertIsElementType_=function(e,t){if(goog.asserts.ENABLE_ASSERTS){var o=goog.dom.asserts.getWindow_(e);void 0!==o[t]&&void 0!==o.Location&&void 0!==o.Element&&goog.asserts.assert(e&&(e instanceof o[t]||!(e instanceof o.Location||e instanceof o.Element)),"Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,goog.dom.asserts.debugStringForType_(e))}return e},goog.dom.asserts.assertIsHTMLAnchorElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLAnchorElement")},goog.dom.asserts.assertIsHTMLButtonElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLButtonElement")},goog.dom.asserts.assertIsHTMLLinkElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLLinkElement")},goog.dom.asserts.assertIsHTMLImageElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLImageElement")},goog.dom.asserts.assertIsHTMLVideoElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLVideoElement")},goog.dom.asserts.assertIsHTMLInputElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLInputElement")},goog.dom.asserts.assertIsHTMLEmbedElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLEmbedElement")},goog.dom.asserts.assertIsHTMLFormElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFormElement")},goog.dom.asserts.assertIsHTMLFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFrameElement")},goog.dom.asserts.assertIsHTMLIFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLIFrameElement")},goog.dom.asserts.assertIsHTMLObjectElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLObjectElement")},goog.dom.asserts.assertIsHTMLScriptElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLScriptElement")},goog.dom.asserts.debugStringForType_=function(e){return goog.isObject(e)?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):void 0===e?"undefined":null===e?"null":typeof e},goog.dom.asserts.getWindow_=function(e){return(e=e&&e.ownerDocument)&&(e.defaultView||e.parentWindow)||goog.global},goog.dom.tags={},goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},goog.dom.tags.isVoidTag=function(e){return!0===goog.dom.tags.VOID_TAGS_[e]},goog.string.TypedString=function(){},goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="",this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_},goog.string.Const.prototype.implementsGoogStringTypedString=!0,goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_},goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"},goog.string.Const.unwrap=function(e){return e instanceof goog.string.Const&&e.constructor===goog.string.Const&&e.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_?e.stringConstValueWithSecurityContract__googStringSecurityPrivate_:(goog.asserts.fail("expected object of type Const, got '"+e+"'"),"type_error:Const")},goog.string.Const.from=function(e){return goog.string.Const.create__googStringSecurityPrivate_(e)},goog.string.Const.TYPE_MARKER_={},goog.string.Const.create__googStringSecurityPrivate_=function(e){var t=new goog.string.Const;return t.stringConstValueWithSecurityContract__googStringSecurityPrivate_=e,t},goog.string.Const.EMPTY=goog.string.Const.from(""),goog.html={},goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="",this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0,goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeScript.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeScript.fromConstantAndArgs=function(e,t){for(var o=[],i=1;i<arguments.length;i++)o.push(goog.html.SafeScript.stringify_(arguments[i]));return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("("+goog.string.Const.unwrap(e)+")("+o.join(", ")+");")},goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_},goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"}),goog.html.SafeScript.unwrap=function(e){return e instanceof goog.html.SafeScript&&e.constructor===goog.html.SafeScript&&e.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeScriptWrappedValue_:(goog.asserts.fail("expected object of type SafeScript, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeScript")},goog.html.SafeScript.stringify_=function(e){return JSON.stringify(e).replace(/</g,"\\x3c")},goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_=e,this},goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(""),goog.fs={},goog.fs.url={},goog.fs.url.createObjectUrl=function(e){return goog.fs.url.getUrlObject_().createObjectURL(e)},goog.fs.url.revokeObjectUrl=function(e){goog.fs.url.getUrlObject_().revokeObjectURL(e)},goog.fs.url.getUrlObject_=function(){var e=goog.fs.url.findUrlObject_();if(null!=e)return e;throw Error("This browser doesn't seem to support blob URLs")},goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null},goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()},goog.i18n={},goog.i18n.bidi={},goog.i18n.bidi.FORCE_RTL=!1,goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4)),goog.i18n.bidi.Format={LRE:"",RLE:"",PDF:"",LRM:"",RLM:""},goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0},goog.i18n.bidi.RIGHT="right",goog.i18n.bidi.LEFT="left",goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT,goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,goog.i18n.bidi.toDir=function(e,t){return"number"==typeof e?0<e?goog.i18n.bidi.Dir.LTR:0>e?goog.i18n.bidi.Dir.RTL:t?null:goog.i18n.bidi.Dir.NEUTRAL:null==e?null:e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.ltrChars_="A-Za-z--------",goog.i18n.bidi.rtlChars_="----",goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g,goog.i18n.bidi.stripHtmlIfNeeded_=function(e,t){return t?e.replace(goog.i18n.bidi.htmlSkipReg_,""):e},goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.hasAnyRtl=function(e,t){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl,goog.i18n.bidi.hasAnyLtr=function(e,t){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.isRtlChar=function(e){return goog.i18n.bidi.rtlRe_.test(e)},goog.i18n.bidi.isLtrChar=function(e){return goog.i18n.bidi.ltrRe_.test(e)},goog.i18n.bidi.isNeutralChar=function(e){return!goog.i18n.bidi.isLtrChar(e)&&!goog.i18n.bidi.isRtlChar(e)},goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.startsWithRtl=function(e,t){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl,goog.i18n.bidi.startsWithLtr=function(e,t){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr,goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/,goog.i18n.bidi.isNeutralText=function(e,t){return e=goog.i18n.bidi.stripHtmlIfNeeded_(e,t),goog.i18n.bidi.isRequiredLtrRe_.test(e)||!goog.i18n.bidi.hasAnyLtr(e)&&!goog.i18n.bidi.hasAnyRtl(e)},goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$"),goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$"),goog.i18n.bidi.endsWithLtr=function(e,t){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr,goog.i18n.bidi.endsWithRtl=function(e,t){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl,goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i,goog.i18n.bidi.isRtlLanguage=function(e){return goog.i18n.bidi.rtlLocalesRe_.test(e)},goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g,goog.i18n.bidi.guardBracketInText=function(e,t){var o=(void 0===t?goog.i18n.bidi.hasAnyRtl(e):t)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return e.replace(goog.i18n.bidi.bracketGuardTextRe_,o+"$&"+o)},goog.i18n.bidi.enforceRtlInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+e+"</span>"},goog.i18n.bidi.enforceRtlInText=function(e){return goog.i18n.bidi.Format.RLE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.enforceLtrInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+e+"</span>"},goog.i18n.bidi.enforceLtrInText=function(e){return goog.i18n.bidi.Format.LRE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g,goog.i18n.bidi.leftRe_=/left/gi,goog.i18n.bidi.rightRe_=/right/gi,goog.i18n.bidi.tempRe_=/%%%%/g,goog.i18n.bidi.mirrorCSS=function(e){return e.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)},goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g,goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g,goog.i18n.bidi.normalizeHebrewQuote=function(e){return e.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1")},goog.i18n.bidi.wordSeparatorRe_=/\s+/,goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/,goog.i18n.bidi.rtlDetectionThreshold_=.4,goog.i18n.bidi.estimateDirection=function(e,t){for(var o=0,i=0,n=!1,r=goog.i18n.bidi.stripHtmlIfNeeded_(e,t).split(goog.i18n.bidi.wordSeparatorRe_),s=0;s<r.length;s++){var a=r[s];goog.i18n.bidi.startsWithRtl(a)?(o++,i++):goog.i18n.bidi.isRequiredLtrRe_.test(a)?n=!0:goog.i18n.bidi.hasAnyLtr(a)?i++:goog.i18n.bidi.hasNumeralsRe_.test(a)&&(n=!0)}return 0==i?n?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:o/i>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.detectRtlDirectionality=function(e,t){return goog.i18n.bidi.estimateDirection(e,t)==goog.i18n.bidi.Dir.RTL},goog.i18n.bidi.setElementDirAndAlign=function(e,t){e&&(t=goog.i18n.bidi.toDir(t))&&(e.style.textAlign=t==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,e.dir=t==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")},goog.i18n.bidi.setElementDirByTextDirectionality=function(e,t){switch(goog.i18n.bidi.estimateDirection(t)){case goog.i18n.bidi.Dir.LTR:e.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:e.dir="rtl";break;default:e.removeAttribute("dir")}},goog.i18n.bidi.DirectionalString=function(){},goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="",this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0,goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_},goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.html.TrustedResourceUrl.prototype.cloneWithParams=function(e){var t,o=goog.html.TrustedResourceUrl.unwrap(this),i=/\?/.test(o)?"&":"?";for(t in e)for(var n=goog.isArray(e[t])?e[t]:[e[t]],r=0;r<n.length;r++)null!=n[r]&&(o+=i+encodeURIComponent(t)+"="+encodeURIComponent(String(n[r])),i="&");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(o)},goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"}),goog.html.TrustedResourceUrl.unwrap=function(e){return e instanceof goog.html.TrustedResourceUrl&&e.constructor===goog.html.TrustedResourceUrl&&e.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_:(goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+e+"' of type "+goog.typeOf(e)),"type_error:TrustedResourceUrl")},goog.html.TrustedResourceUrl.format=function(e,t){var o=goog.string.Const.unwrap(e);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(o))throw Error("Invalid TrustedResourceUrl format: "+o);var i=o.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,function(e,i){if(!Object.prototype.hasOwnProperty.call(t,i))throw Error('Found marker, "'+i+'", in format string, "'+o+'", but no valid label mapping found in args: '+JSON.stringify(t));var n=t[i];return n instanceof goog.string.Const?goog.string.Const.unwrap(n):encodeURIComponent(String(n))});return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(i)},goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g,goog.html.TrustedResourceUrl.BASE_URL_=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,goog.html.TrustedResourceUrl.formatWithParams=function(e,t,o){return goog.html.TrustedResourceUrl.format(e,t).cloneWithParams(o)},goog.html.TrustedResourceUrl.fromConstant=function(e){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))},goog.html.TrustedResourceUrl.fromConstants=function(e){for(var t="",o=0;o<e.length;o++)t+=goog.string.Const.unwrap(e[o]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(e){var t=new goog.html.TrustedResourceUrl;return t.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=e,t},goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez",goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0,goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_},goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeUrl.unwrap=function(e){return e instanceof goog.html.SafeUrl&&e.constructor===goog.html.SafeUrl&&e.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeUrl, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeUrl")},goog.html.SafeUrl.fromConstant=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))},goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:audio\/(?:3gpp|3gpp2|aac|midi|mp4|mpeg|ogg|x-m4a|x-wav|webm)|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime))$/i,goog.html.SafeUrl.fromBlob=function(e){return e=goog.html.SAFE_MIME_TYPE_PATTERN_.test(e.type)?goog.fs.url.createObjectUrl(e):goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i,goog.html.SafeUrl.fromDataUrl=function(e){var t=e.match(goog.html.DATA_URL_PATTERN_);return t=t&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(t[1]),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t?e:goog.html.SafeUrl.INNOCUOUS_STRING)},goog.html.SafeUrl.fromTelUrl=function(e){return goog.string.caseInsensitiveStartsWith(e,"tel:")||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.fromTrustedResourceUrl=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(e))},goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,goog.html.SafeUrl.sanitize=function(e){return e instanceof goog.html.SafeUrl?e:(e=e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),goog.html.SAFE_URL_PATTERN_.test(e)||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeUrl.sanitizeAssertUnchanged=function(e){return e instanceof goog.html.SafeUrl?e:(e=e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(e))||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(e){var t=new goog.html.SafeUrl;return t.privateDoNotAccessOrElseSafeHtmlWrappedValue_=e,t},goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank"),goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="",this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyle.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeStyle.EMPTY:(goog.html.SafeStyle.checkStyle_(e),goog.asserts.assert(goog.string.endsWith(e,";"),"Last character of style string is not ';': "+e),goog.asserts.assert(goog.string.contains(e,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+e),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeStyle.checkStyle_=function(e){goog.asserts.assert(!/[<>]/.test(e),"Forbidden characters in style string: "+e)},goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_},goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"}),goog.html.SafeStyle.unwrap=function(e){return e instanceof goog.html.SafeStyle&&e.constructor===goog.html.SafeStyle&&e.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeStyleWrappedValue_:(goog.asserts.fail("expected object of type SafeStyle, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeStyle")},goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_=e,this},goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez",goog.html.SafeStyle.create=function(e){var t,o="";for(t in e){if(!/^[-_a-zA-Z0-9]+$/.test(t))throw Error("Name allows only [-_a-zA-Z0-9], got: "+t);var i=e[t];null!=i&&(o+=t+":"+(i=goog.isArray(i)?goog.array.map(i,goog.html.SafeStyle.sanitizePropertyValue_).join(" "):goog.html.SafeStyle.sanitizePropertyValue_(i))+";")}return o?(goog.html.SafeStyle.checkStyle_(o),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)):goog.html.SafeStyle.EMPTY},goog.html.SafeStyle.sanitizePropertyValue_=function(e){return e instanceof goog.html.SafeUrl?'url("'+goog.html.SafeUrl.unwrap(e).replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")':(e=e instanceof goog.string.Const?goog.string.Const.unwrap(e):goog.html.SafeStyle.sanitizePropertyValueString_(String(e)),goog.asserts.assert(!/[{;}]/.test(e),"Value does not allow [{;}]."),e)},goog.html.SafeStyle.sanitizePropertyValueString_=function(e){var t=e.replace(goog.html.SafeUrl.FUNCTIONS_RE_,"$1").replace(goog.html.SafeUrl.URL_RE_,"url");return goog.html.SafeStyle.VALUE_RE_.test(t)?goog.html.SafeStyle.hasBalancedQuotes_(e)?goog.html.SafeStyle.sanitizeUrl_(e):(goog.asserts.fail("String value requires balanced quotes, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING)},goog.html.SafeStyle.hasBalancedQuotes_=function(e){for(var t=!0,o=!0,i=0;i<e.length;i++){var n=e.charAt(i);"'"==n&&o?t=!t:'"'==n&&t&&(o=!o)}return t&&o},goog.html.SafeStyle.VALUE_ALLOWED_CHARS_="[-,.\"'%_!# a-zA-Z0-9]",goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$"),goog.html.SafeUrl.URL_RE_=RegExp("\\b(url\\([ \t\n]*)('[ -&(-\\[\\]-~]*'|\"[ !#-\\[\\]-~]*\"|[!#-&*-\\[\\]-~]*)([ \t\n]*\\))","g"),goog.html.SafeUrl.FUNCTIONS_RE_=RegExp("\\b(hsl|hsla|rgb|rgba|(rotate|scale|translate)(X|Y|Z|3d)?)\\([-0-9a-z.%, ]+\\)","g"),goog.html.SafeStyle.sanitizeUrl_=function(e){return e.replace(goog.html.SafeUrl.URL_RE_,function(e,t,o,i){var n="";return o=o.replace(/^(['"])(.*)\1$/,function(e,t,o){return n=t,o}),e=goog.html.SafeUrl.sanitize(o).getTypedStringValue(),t+n+e+n+i})},goog.html.SafeStyle.concat=function(e){var t="",o=function(e){goog.isArray(e)?goog.array.forEach(e,o):t+=goog.html.SafeStyle.unwrap(e)};return goog.array.forEach(arguments,o),t?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t):goog.html.SafeStyle.EMPTY},goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="",this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyleSheet.createRule=function(e,t){if(goog.string.contains(e,"<"))throw Error("Selector does not allow '<', got: "+e);var o=e.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(o))throw Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and strings, got: "+e);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(o))throw Error("() and [] in selector must be balanced, got: "+e);return t instanceof goog.html.SafeStyle||(t=goog.html.SafeStyle.create(t)),o=e+"{"+goog.html.SafeStyle.unwrap(t)+"}",goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(o)},goog.html.SafeStyleSheet.hasBalancedBrackets_=function(e){for(var t={"(":")","[":"]"},o=[],i=0;i<e.length;i++){var n=e[i];if(t[n])o.push(t[n]);else if(goog.object.contains(t,n)&&o.pop()!=n)return!1}return 0==o.length},goog.html.SafeStyleSheet.concat=function(e){var t="",o=function(e){goog.isArray(e)?goog.array.forEach(e,o):t+=goog.html.SafeStyleSheet.unwrap(e)};return goog.array.forEach(arguments,o),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t)},goog.html.SafeStyleSheet.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeStyleSheet.EMPTY:(goog.asserts.assert(!goog.string.contains(e,"<"),"Forbidden '<' character in style sheet string: "+e),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_},goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"}),goog.html.SafeStyleSheet.unwrap=function(e){return e instanceof goog.html.SafeStyleSheet&&e.constructor===goog.html.SafeStyleSheet&&e.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_:(goog.asserts.fail("expected object of type SafeStyleSheet, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeStyleSheet")},goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=e,this},goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_,this.dir_=null},goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_},goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0,goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_},goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeHtml.unwrap=function(e){return e instanceof goog.html.SafeHtml&&e.constructor===goog.html.SafeHtml&&e.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeHtml, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeHtml")},goog.html.SafeHtml.htmlEscape=function(e){if(e instanceof goog.html.SafeHtml)return e;var t=null;return e.implementsGoogI18nBidiDirectionalString&&(t=e.getDirection()),e=e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(e),t)},goog.html.SafeHtml.htmlEscapePreservingNewlines=function(e){return e instanceof goog.html.SafeHtml?e:(e=goog.html.SafeHtml.htmlEscape(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(e)),e.getDirection()))},goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(e){return e instanceof goog.html.SafeHtml?e:(e=goog.html.SafeHtml.htmlEscape(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(e)),e.getDirection()))},goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape,goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/,goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.html.SafeHtml.create=function(e,t,o){return goog.html.SafeHtml.verifyTagName(String(e)),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(e),t,o)},goog.html.SafeHtml.verifyTagName=function(e){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(e))throw Error("Invalid tag name <"+e+">.");if(e.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error("Tag name <"+e+"> is not allowed for SafeHtml.")},goog.html.SafeHtml.createIframe=function(e,t,o,i){e&&goog.html.TrustedResourceUrl.unwrap(e);var n={};return n.src=e||null,n.srcdoc=t&&goog.html.SafeHtml.unwrap(t),e=goog.html.SafeHtml.combineAttributes(n,{sandbox:""},o),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",e,i)},goog.html.SafeHtml.createSandboxIframe=function(e,t,o,i){if(!goog.html.SafeHtml.canUseSandboxIframe())throw Error("The browser does not support sandboxed iframes.");var n={};return n.src=e?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e)):null,n.srcdoc=t||null,n.sandbox="",e=goog.html.SafeHtml.combineAttributes(n,{},o),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",e,i)},goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox"in goog.global.HTMLIFrameElement.prototype},goog.html.SafeHtml.createScriptSrc=function(e,t){goog.html.TrustedResourceUrl.unwrap(e);var o=goog.html.SafeHtml.combineAttributes({src:e},{},t);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",o)},goog.html.SafeHtml.createScript=function(e,t){for(var o in t){var i=o.toLowerCase();if("language"==i||"src"==i||"text"==i||"type"==i)throw Error('Cannot set "'+i+'" attribute')}for(o="",e=goog.array.concat(e),i=0;i<e.length;i++)o+=goog.html.SafeScript.unwrap(e[i]);return o=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(o,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",t,o)},goog.html.SafeHtml.createStyle=function(e,t){var o=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},t),i="";e=goog.array.concat(e);for(var n=0;n<e.length;n++)i+=goog.html.SafeStyleSheet.unwrap(e[n]);return i=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(i,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",o,i)},goog.html.SafeHtml.createMetaRefresh=function(e,t){var o=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e));return(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.contains(o,";")&&(o="'"+o.replace(/'/g,"%27")+"'"),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(t||0)+"; url="+o})},goog.html.SafeHtml.getAttrNameAndValue_=function(e,t,o){if(o instanceof goog.string.Const)o=goog.string.Const.unwrap(o);else if("style"==t.toLowerCase())o=goog.html.SafeHtml.getStyleValue_(o);else{if(/^on/i.test(t))throw Error('Attribute "'+t+'" requires goog.string.Const value, "'+o+'" given.');if(t.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(o instanceof goog.html.TrustedResourceUrl)o=goog.html.TrustedResourceUrl.unwrap(o);else if(o instanceof goog.html.SafeUrl)o=goog.html.SafeUrl.unwrap(o);else{if(!goog.isString(o))throw Error('Attribute "'+t+'" on tag "'+e+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+o+'" given.');o=goog.html.SafeUrl.sanitize(o).getTypedStringValue()}}return o.implementsGoogStringTypedString&&(o=o.getTypedStringValue()),goog.asserts.assert(goog.isString(o)||goog.isNumber(o),"String or number value expected, got "+typeof o+" with value: "+o),t+'="'+goog.string.htmlEscape(String(o))+'"'},goog.html.SafeHtml.getStyleValue_=function(e){if(!goog.isObject(e))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof e+" given: "+e);return e instanceof goog.html.SafeStyle||(e=goog.html.SafeStyle.create(e)),goog.html.SafeStyle.unwrap(e)},goog.html.SafeHtml.createWithDir=function(e,t,o,i){return(t=goog.html.SafeHtml.create(t,o,i)).dir_=e,t},goog.html.SafeHtml.concat=function(e){var t=goog.i18n.bidi.Dir.NEUTRAL,o="",i=function(e){goog.isArray(e)?goog.array.forEach(e,i):(e=goog.html.SafeHtml.htmlEscape(e),o+=goog.html.SafeHtml.unwrap(e),e=e.getDirection(),t==goog.i18n.bidi.Dir.NEUTRAL?t=e:e!=goog.i18n.bidi.Dir.NEUTRAL&&t!=e&&(t=null))};return goog.array.forEach(arguments,i),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(o,t)},goog.html.SafeHtml.concatWithDir=function(e,t){var o=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));return o.dir_=e,o},goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(e,t){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(e,t)},goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e,t){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=e,this.dir_=t,this},goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(e,t,o){var i=null,n="<"+e+goog.html.SafeHtml.stringifyAttributes(e,t);return goog.isDefAndNotNull(o)?goog.isArray(o)||(o=[o]):o=[],goog.dom.tags.isVoidTag(e.toLowerCase())?(goog.asserts.assert(!o.length,"Void tag <"+e+"> does not allow content."),n+=">"):(i=goog.html.SafeHtml.concat(o),n+=">"+goog.html.SafeHtml.unwrap(i)+"</"+e+">",i=i.getDirection()),(e=t&&t.dir)&&(i=/^(ltr|rtl|auto)$/i.test(e)?goog.i18n.bidi.Dir.NEUTRAL:null),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(n,i)},goog.html.SafeHtml.stringifyAttributes=function(e,t){var o="";if(t)for(var i in t){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(i))throw Error('Invalid attribute name "'+i+'".');var n=t[i];goog.isDefAndNotNull(n)&&(o+=" "+goog.html.SafeHtml.getAttrNameAndValue_(e,i,n))}return o},goog.html.SafeHtml.combineAttributes=function(e,t,o){var i,n={};for(i in e)goog.asserts.assert(i.toLowerCase()==i,"Must be lower case"),n[i]=e[i];for(i in t)goog.asserts.assert(i.toLowerCase()==i,"Must be lower case"),n[i]=t[i];for(i in o){var r=i.toLowerCase();if(r in e)throw Error('Cannot override "'+r+'" attribute, got "'+i+'" with value "'+o[i]+'"');r in t&&delete n[r],n[i]=o[i]}return n},goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL),goog.dom.safe={},goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"},goog.dom.safe.insertAdjacentHtml=function(e,t,o){e.insertAdjacentHTML(t,goog.html.SafeHtml.unwrap(o))},goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.dom.safe.setInnerHtml=function(e,t){if(goog.asserts.ENABLE_ASSERTS){var o=e.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[o])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+e.tagName+".")}e.innerHTML=goog.html.SafeHtml.unwrap(t)},goog.dom.safe.setOuterHtml=function(e,t){e.outerHTML=goog.html.SafeHtml.unwrap(t)},goog.dom.safe.setFormElementAction=function(e,t){var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);goog.dom.asserts.assertIsHTMLFormElement(e).action=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setButtonFormAction=function(e,t){var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);goog.dom.asserts.assertIsHTMLButtonElement(e).formaction=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setInputFormAction=function(e,t){var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);goog.dom.asserts.assertIsHTMLInputElement(e).formaction=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setStyle=function(e,t){e.style.cssText=goog.html.SafeStyle.unwrap(t)},goog.dom.safe.documentWrite=function(e,t){e.write(goog.html.SafeHtml.unwrap(t))},goog.dom.safe.setAnchorHref=function(e,t){goog.dom.asserts.assertIsHTMLAnchorElement(e);var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);e.href=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setImageSrc=function(e,t){goog.dom.asserts.assertIsHTMLImageElement(e);var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);e.src=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setVideoSrc=function(e,t){goog.dom.asserts.assertIsHTMLVideoElement(e);var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);e.src=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setEmbedSrc=function(e,t){goog.dom.asserts.assertIsHTMLEmbedElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setFrameSrc=function(e,t){goog.dom.asserts.assertIsHTMLFrameElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setIframeSrc=function(e,t){goog.dom.asserts.assertIsHTMLIFrameElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setIframeSrcdoc=function(e,t){goog.dom.asserts.assertIsHTMLIFrameElement(e),e.srcdoc=goog.html.SafeHtml.unwrap(t)},goog.dom.safe.setLinkHrefAndRel=function(e,t,o){goog.dom.asserts.assertIsHTMLLinkElement(e),e.rel=o,goog.string.caseInsensitiveContains(o,"stylesheet")?(goog.asserts.assert(t instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),e.href=goog.html.TrustedResourceUrl.unwrap(t)):e.href=t instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(t):t instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(t):goog.html.SafeUrl.sanitizeAssertUnchanged(t).getTypedStringValue()},goog.dom.safe.setObjectData=function(e,t){goog.dom.asserts.assertIsHTMLObjectElement(e),e.data=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setScriptSrc=function(e,t){goog.dom.asserts.assertIsHTMLScriptElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setScriptContent=function(e,t){goog.dom.asserts.assertIsHTMLScriptElement(e),e.text=goog.html.SafeScript.unwrap(t)},goog.dom.safe.setLocationHref=function(e,t){goog.dom.asserts.assertIsLocation(e);var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);e.href=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.replaceLocation=function(e,t){goog.dom.asserts.assertIsLocation(e);var o=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t);e.replace(goog.html.SafeUrl.unwrap(o))},goog.dom.safe.openInWindow=function(e,t,o,i,n){return e=e instanceof goog.html.SafeUrl?e:goog.html.SafeUrl.sanitizeAssertUnchanged(e),(t||window).open(goog.html.SafeUrl.unwrap(e),o?goog.string.Const.unwrap(o):"",i,n)},goog.html.uncheckedconversions={},goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(e,t,o){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(t,o||null)},goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.math.Size=function(e,t){this.width=e,this.height=t},goog.math.Size.equals=function(e,t){return e==t||!(!e||!t)&&(e.width==t.width&&e.height==t.height)},goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)},goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"}),goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)},goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)},goog.math.Size.prototype.area=function(){return this.width*this.height},goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)},goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height},goog.math.Size.prototype.isEmpty=function(){return!this.area()},goog.math.Size.prototype.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},goog.math.Size.prototype.fitsInside=function(e){return this.width<=e.width&&this.height<=e.height},goog.math.Size.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},goog.math.Size.prototype.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},goog.math.Size.prototype.scale=function(e,t){var o=goog.isNumber(t)?t:e;return this.width*=e,this.height*=o,this},goog.math.Size.prototype.scaleToCover=function(e){return e=this.aspectRatio()<=e.aspectRatio()?e.width/this.width:e.height/this.height,this.scale(e)},goog.math.Size.prototype.scaleToFit=function(e){return e=this.aspectRatio()>e.aspectRatio()?e.width/this.width:e.height/this.height,this.scale(e)},goog.dom.ASSUME_QUIRKS_MODE=!1,goog.dom.ASSUME_STANDARDS_MODE=!1,goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE,goog.dom.getDomHelper=function(e){return e?new goog.dom.DomHelper(goog.dom.getOwnerDocument(e)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)},goog.dom.getDocument=function(){return document},goog.dom.getElement=function(e){return goog.dom.getElementHelper_(document,e)},goog.dom.getElementHelper_=function(e,t){return goog.isString(t)?e.getElementById(t):t},goog.dom.getRequiredElement=function(e){return goog.dom.getRequiredElementHelper_(document,e)},goog.dom.getRequiredElementHelper_=function(e,t){goog.asserts.assertString(t);var o=goog.dom.getElementHelper_(e,t);return goog.asserts.assertElement(o,"No element found with id: "+t)},goog.dom.$=goog.dom.getElement,goog.dom.getElementsByTagName=function(e,t){return(t||document).getElementsByTagName(String(e))},goog.dom.getElementsByTagNameAndClass=function(e,t,o){return goog.dom.getElementsByTagNameAndClass_(document,e,t,o)},goog.dom.getElementByTagNameAndClass=function(e,t,o){return goog.dom.getElementByTagNameAndClass_(document,e,t,o)},goog.dom.getElementsByClass=function(e,t){var o=t||document;return goog.dom.canUseQuerySelector_(o)?o.querySelectorAll("."+e):goog.dom.getElementsByTagNameAndClass_(document,"*",e,t)},goog.dom.getElementByClass=function(e,t){var o=t||document;return(o.getElementsByClassName?o.getElementsByClassName(e)[0]:goog.dom.getElementByTagNameAndClass_(document,"*",e,t))||null},goog.dom.getRequiredElementByClass=function(e,t){var o=goog.dom.getElementByClass(e,t);return goog.asserts.assert(o,"No element found with className: "+e)},goog.dom.canUseQuerySelector_=function(e){return!(!e.querySelectorAll||!e.querySelector)},goog.dom.getElementsByTagNameAndClass_=function(e,t,o,i){if(e=i||e,t=t&&"*"!=t?String(t).toUpperCase():"",goog.dom.canUseQuerySelector_(e)&&(t||o))return e.querySelectorAll(t+(o?"."+o:""));if(o&&e.getElementsByClassName){if(e=e.getElementsByClassName(o),t){i={};for(var n,r=0,s=0;n=e[s];s++)t==n.nodeName&&(i[r++]=n);return i.length=r,i}return e}if(e=e.getElementsByTagName(t||"*"),o){for(i={},s=r=0;n=e[s];s++)"function"==typeof(t=n.className).split&&goog.array.contains(t.split(/\s+/),o)&&(i[r++]=n);return i.length=r,i}return e},goog.dom.getElementByTagNameAndClass_=function(e,t,o,i){var n=i||e,r=t&&"*"!=t?String(t).toUpperCase():"";return goog.dom.canUseQuerySelector_(n)&&(r||o)?n.querySelector(r+(o?"."+o:"")):goog.dom.getElementsByTagNameAndClass_(e,t,o,i)[0]||null},goog.dom.$$=goog.dom.getElementsByTagNameAndClass,goog.dom.setProperties=function(e,t){goog.object.forEach(t,function(t,o){t&&t.implementsGoogStringTypedString&&(t=t.getTypedStringValue()),"style"==o?e.style.cssText=t:"class"==o?e.className=t:"for"==o?e.htmlFor=t:goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(o)?e.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[o],t):goog.string.startsWith(o,"aria-")||goog.string.startsWith(o,"data-")?e.setAttribute(o,t):e[o]=t})},goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},goog.dom.getViewportSize=function(e){return goog.dom.getViewportSize_(e||window)},goog.dom.getViewportSize_=function(e){return e=e.document,e=goog.dom.isCss1CompatMode_(e)?e.documentElement:e.body,new goog.math.Size(e.clientWidth,e.clientHeight)},goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)},goog.dom.getDocumentHeightForWindow=function(e){return goog.dom.getDocumentHeight_(e)},goog.dom.getDocumentHeight_=function(e){var t=e.document,o=0;if(t){o=t.body;var i=t.documentElement;if(!i||!o)return 0;if(e=goog.dom.getViewportSize_(e).height,goog.dom.isCss1CompatMode_(t)&&i.scrollHeight)o=i.scrollHeight!=e?i.scrollHeight:i.offsetHeight;else{t=i.scrollHeight;var n=i.offsetHeight;i.clientHeight!=n&&(t=o.scrollHeight,n=o.offsetHeight),o=t>e?t>n?t:n:t<n?t:n}}return o},goog.dom.getPageScroll=function(e){return goog.dom.getDomHelper((e||goog.global||window).document).getDocumentScroll()},goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)},goog.dom.getDocumentScroll_=function(e){var t=goog.dom.getDocumentScrollElement_(e);return e=goog.dom.getWindow_(e),goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&e.pageYOffset!=t.scrollTop?new goog.math.Coordinate(t.scrollLeft,t.scrollTop):new goog.math.Coordinate(e.pageXOffset||t.scrollLeft,e.pageYOffset||t.scrollTop)},goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)},goog.dom.getDocumentScrollElement_=function(e){return e.scrollingElement?e.scrollingElement:!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(e)?e.documentElement:e.body||e.documentElement},goog.dom.getWindow=function(e){return e?goog.dom.getWindow_(e):window},goog.dom.getWindow_=function(e){return e.parentWindow||e.defaultView},goog.dom.createDom=function(e,t,o){return goog.dom.createDom_(document,arguments)},goog.dom.createDom_=function(e,t){var o=String(t[0]),i=t[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){if(o=["<",o],i.name&&o.push(' name="',goog.string.htmlEscape(i.name),'"'),i.type){o.push(' type="',goog.string.htmlEscape(i.type),'"');var n={};goog.object.extend(n,i),delete n.type,i=n}o.push(">"),o=o.join("")}return o=e.createElement(o),i&&(goog.isString(i)?o.className=i:goog.isArray(i)?o.className=i.join(" "):goog.dom.setProperties(o,i)),2<t.length&&goog.dom.append_(e,o,t,2),o},goog.dom.append_=function(e,t,o,i){function n(o){o&&t.appendChild(goog.isString(o)?e.createTextNode(o):o)}for(;i<o.length;i++){var r=o[i];goog.isArrayLike(r)&&!goog.dom.isNodeLike(r)?goog.array.forEach(goog.dom.isNodeList(r)?goog.array.toArray(r):r,n):n(r)}},goog.dom.$dom=goog.dom.createDom,goog.dom.createElement=function(e){return goog.dom.createElement_(document,e)},goog.dom.createElement_=function(e,t){return e.createElement(String(t))},goog.dom.createTextNode=function(e){return document.createTextNode(String(e))},goog.dom.createTable=function(e,t,o){return goog.dom.createTable_(document,e,t,!!o)},goog.dom.createTable_=function(e,t,o,i){for(var n=goog.dom.createElement_(e,"TABLE"),r=n.appendChild(goog.dom.createElement_(e,"TBODY")),s=0;s<t;s++){for(var a=goog.dom.createElement_(e,"TR"),l=0;l<o;l++){var c=goog.dom.createElement_(e,"TD");i&&goog.dom.setTextContent(c,goog.string.Unicode.NBSP),a.appendChild(c)}r.appendChild(a)}return n},goog.dom.constHtmlToNode=function(e){var t=goog.array.map(arguments,goog.string.Const.unwrap);return t=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a Node later, so it will be automatically balanced."),t.join("")),goog.dom.safeHtmlToNode(t)},goog.dom.safeHtmlToNode=function(e){return goog.dom.safeHtmlToNode_(document,e)},goog.dom.safeHtmlToNode_=function(e,t){var o=goog.dom.createElement_(e,"DIV");return goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(goog.dom.safe.setInnerHtml(o,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,t)),o.removeChild(o.firstChild)):goog.dom.safe.setInnerHtml(o,t),goog.dom.childrenToNode_(e,o)},goog.dom.childrenToNode_=function(e,t){if(1==t.childNodes.length)return t.removeChild(t.firstChild);for(var o=e.createDocumentFragment();t.firstChild;)o.appendChild(t.firstChild);return o},goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)},goog.dom.isCss1CompatMode_=function(e){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==e.compatMode},goog.dom.canHaveChildren=function(e){if(e.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(e.tagName){case"APPLET":case"AREA":case"BASE":case"BR":case"COL":case"COMMAND":case"EMBED":case"FRAME":case"HR":case"IMG":case"INPUT":case"IFRAME":case"ISINDEX":case"KEYGEN":case"LINK":case"NOFRAMES":case"NOSCRIPT":case"META":case"OBJECT":case"PARAM":case"SCRIPT":case"SOURCE":case"STYLE":case"TRACK":case"WBR":return!1}return!0},goog.dom.appendChild=function(e,t){e.appendChild(t)},goog.dom.append=function(e,t){goog.dom.append_(goog.dom.getOwnerDocument(e),e,arguments,1)},goog.dom.removeChildren=function(e){for(var t;t=e.firstChild;)e.removeChild(t)},goog.dom.insertSiblingBefore=function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t)},goog.dom.insertSiblingAfter=function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)},goog.dom.insertChildAt=function(e,t,o){e.insertBefore(t,e.childNodes[o]||null)},goog.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},goog.dom.replaceNode=function(e,t){var o=t.parentNode;o&&o.replaceChild(e,t)},goog.dom.flattenElement=function(e){var t,o=e.parentNode;if(o&&o.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(e.removeNode)return e.removeNode(!1);for(;t=e.firstChild;)o.insertBefore(t,e);return goog.dom.removeNode(e)}},goog.dom.getChildren=function(e){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=e.children?e.children:goog.array.filter(e.childNodes,function(e){return e.nodeType==goog.dom.NodeType.ELEMENT})},goog.dom.getFirstElementChild=function(e){return goog.isDef(e.firstElementChild)?e.firstElementChild:goog.dom.getNextElementNode_(e.firstChild,!0)},goog.dom.getLastElementChild=function(e){return goog.isDef(e.lastElementChild)?e.lastElementChild:goog.dom.getNextElementNode_(e.lastChild,!1)},goog.dom.getNextElementSibling=function(e){return goog.isDef(e.nextElementSibling)?e.nextElementSibling:goog.dom.getNextElementNode_(e.nextSibling,!0)},goog.dom.getPreviousElementSibling=function(e){return goog.isDef(e.previousElementSibling)?e.previousElementSibling:goog.dom.getNextElementNode_(e.previousSibling,!1)},goog.dom.getNextElementNode_=function(e,t){for(;e&&e.nodeType!=goog.dom.NodeType.ELEMENT;)e=t?e.nextSibling:e.previousSibling;return e},goog.dom.getNextNode=function(e){if(!e)return null;if(e.firstChild)return e.firstChild;for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null},goog.dom.getPreviousNode=function(e){if(!e)return null;if(!e.previousSibling)return e.parentNode;for(e=e.previousSibling;e&&e.lastChild;)e=e.lastChild;return e},goog.dom.isNodeLike=function(e){return goog.isObject(e)&&0<e.nodeType},goog.dom.isElement=function(e){return goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT},goog.dom.isWindow=function(e){return goog.isObject(e)&&e.window==e},goog.dom.getParentElement=function(e){var t;return!goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10")&&goog.global.SVGElement&&e instanceof goog.global.SVGElement||!(t=e.parentElement)?(t=e.parentNode,goog.dom.isElement(t)?t:null):t},goog.dom.contains=function(e,t){if(!e||!t)return!1;if(e.contains&&t.nodeType==goog.dom.NodeType.ELEMENT)return e==t||e.contains(t);if(void 0!==e.compareDocumentPosition)return e==t||!!(16&e.compareDocumentPosition(t));for(;t&&e!=t;)t=t.parentNode;return t==e},goog.dom.compareNodeOrder=function(e,t){if(e==t)return 0;if(e.compareDocumentPosition)return 2&e.compareDocumentPosition(t)?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(e.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(t.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in e||e.parentNode&&"sourceIndex"in e.parentNode){var o=e.nodeType==goog.dom.NodeType.ELEMENT,i=t.nodeType==goog.dom.NodeType.ELEMENT;if(o&&i)return e.sourceIndex-t.sourceIndex;var n=e.parentNode,r=t.parentNode;return n==r?goog.dom.compareSiblingOrder_(e,t):!o&&goog.dom.contains(n,t)?-1*goog.dom.compareParentsDescendantNodeIe_(e,t):!i&&goog.dom.contains(r,e)?goog.dom.compareParentsDescendantNodeIe_(t,e):(o?e.sourceIndex:n.sourceIndex)-(i?t.sourceIndex:r.sourceIndex)}return(o=(i=goog.dom.getOwnerDocument(e)).createRange()).selectNode(e),o.collapse(!0),(i=i.createRange()).selectNode(t),i.collapse(!0),o.compareBoundaryPoints(goog.global.Range.START_TO_END,i)},goog.dom.compareParentsDescendantNodeIe_=function(e,t){var o=e.parentNode;if(o==t)return-1;for(var i=t;i.parentNode!=o;)i=i.parentNode;return goog.dom.compareSiblingOrder_(i,e)},goog.dom.compareSiblingOrder_=function(e,t){for(var o=t;o=o.previousSibling;)if(o==e)return-1;return 1},goog.dom.findCommonAncestor=function(e){var t,o=arguments.length;if(!o)return null;if(1==o)return arguments[0];var i=[],n=1/0;for(t=0;t<o;t++){for(var r=[],s=arguments[t];s;)r.unshift(s),s=s.parentNode;i.push(r),n=Math.min(n,r.length)}for(r=null,t=0;t<n;t++){s=i[0][t];for(var a=1;a<o;a++)if(s!=i[a][t])return r;r=s}return r},goog.dom.getOwnerDocument=function(e){return goog.asserts.assert(e,"Node cannot be null or undefined."),e.nodeType==goog.dom.NodeType.DOCUMENT?e:e.ownerDocument||e.document},goog.dom.getFrameContentDocument=function(e){return e.contentDocument||e.contentWindow.document},goog.dom.getFrameContentWindow=function(e){try{return e.contentWindow||(e.contentDocument?goog.dom.getWindow(e.contentDocument):null)}catch(e){}return null},goog.dom.setTextContent=function(e,t){if(goog.asserts.assert(null!=e,"goog.dom.setTextContent expects a non-null value for node"),"textContent"in e)e.textContent=t;else if(e.nodeType==goog.dom.NodeType.TEXT)e.data=String(t);else if(e.firstChild&&e.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;e.lastChild!=e.firstChild;)e.removeChild(e.lastChild);e.firstChild.data=String(t)}else{goog.dom.removeChildren(e);var o=goog.dom.getOwnerDocument(e);e.appendChild(o.createTextNode(String(t)))}},goog.dom.getOuterHtml=function(e){if(goog.asserts.assert(null!==e,"goog.dom.getOuterHtml expects a non-null value for element"),"outerHTML"in e)return e.outerHTML;var t=goog.dom.getOwnerDocument(e);return(t=goog.dom.createElement_(t,"DIV")).appendChild(e.cloneNode(!0)),t.innerHTML},goog.dom.findNode=function(e,t){var o=[];return goog.dom.findNodes_(e,t,o,!0)?o[0]:void 0},goog.dom.findNodes=function(e,t){var o=[];return goog.dom.findNodes_(e,t,o,!1),o},goog.dom.findNodes_=function(e,t,o,i){if(null!=e)for(e=e.firstChild;e;){if(t(e)&&(o.push(e),i)||goog.dom.findNodes_(e,t,o,i))return!0;e=e.nextSibling}return!1},goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"},goog.dom.isFocusableTabIndex=function(e){return goog.dom.hasSpecifiedTabIndex_(e)&&goog.dom.isTabIndexFocusable_(e)},goog.dom.setFocusableTabIndex=function(e,t){t?e.tabIndex=0:(e.tabIndex=-1,e.removeAttribute("tabIndex"))},goog.dom.isFocusable=function(e){var t;return(t=goog.dom.nativelySupportsFocus_(e)?!e.disabled&&(!goog.dom.hasSpecifiedTabIndex_(e)||goog.dom.isTabIndexFocusable_(e)):goog.dom.isFocusableTabIndex(e))&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(e):t},goog.dom.hasSpecifiedTabIndex_=function(e){return goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9")?(e=e.getAttributeNode("tabindex"),goog.isDefAndNotNull(e)&&e.specified):e.hasAttribute("tabindex")},goog.dom.isTabIndexFocusable_=function(e){return e=e.tabIndex,goog.isNumber(e)&&0<=e&&32768>e},goog.dom.nativelySupportsFocus_=function(e){return"A"==e.tagName||"INPUT"==e.tagName||"TEXTAREA"==e.tagName||"SELECT"==e.tagName||"BUTTON"==e.tagName},goog.dom.hasNonZeroBoundingRect_=function(e){return e=!goog.isFunction(e.getBoundingClientRect)||goog.userAgent.IE&&null==e.parentElement?{height:e.offsetHeight,width:e.offsetWidth}:e.getBoundingClientRect(),goog.isDefAndNotNull(e)&&0<e.height&&0<e.width},goog.dom.getTextContent=function(e){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&null!==e&&"innerText"in e)e=goog.string.canonicalizeNewlines(e.innerText);else{var t=[];goog.dom.getTextContent_(e,t,!0),e=t.join("")}return e=(e=e.replace(/ \xAD /g," ").replace(/\xAD/g,"")).replace(/\u200B/g,""),goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(e=e.replace(/ +/g," "))," "!=e&&(e=e.replace(/^\s*/,"")),e},goog.dom.getRawTextContent=function(e){var t=[];return goog.dom.getTextContent_(e,t,!1),t.join("")},goog.dom.getTextContent_=function(e,t,o){if(!(e.nodeName in goog.dom.TAGS_TO_IGNORE_))if(e.nodeType==goog.dom.NodeType.TEXT)o?t.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(e.nodeValue);else if(e.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)t.push(goog.dom.PREDEFINED_TAG_VALUES_[e.nodeName]);else for(e=e.firstChild;e;)goog.dom.getTextContent_(e,t,o),e=e.nextSibling},goog.dom.getNodeTextLength=function(e){return goog.dom.getTextContent(e).length},goog.dom.getNodeTextOffset=function(e,t){for(var o=t||goog.dom.getOwnerDocument(e).body,i=[];e&&e!=o;){for(var n=e;n=n.previousSibling;)i.unshift(goog.dom.getTextContent(n));e=e.parentNode}return goog.string.trimLeft(i.join("")).replace(/ +/g," ").length},goog.dom.getNodeAtOffset=function(e,t,o){e=[e];for(var i=0,n=null;0<e.length&&i<t;)if(!((n=e.pop()).nodeName in goog.dom.TAGS_TO_IGNORE_))if(n.nodeType==goog.dom.NodeType.TEXT){var r=n.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");i+=r.length}else if(n.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)i+=goog.dom.PREDEFINED_TAG_VALUES_[n.nodeName].length;else for(r=n.childNodes.length-1;0<=r;r--)e.push(n.childNodes[r]);return goog.isObject(o)&&(o.remainder=n?n.nodeValue.length+t-i-1:0,o.node=n),n},goog.dom.isNodeList=function(e){if(e&&"number"==typeof e.length){if(goog.isObject(e))return"function"==typeof e.item||"string"==typeof e.item;if(goog.isFunction(e))return"function"==typeof e.item}return!1},goog.dom.getAncestorByTagNameAndClass=function(e,t,o,i){if(!t&&!o)return null;var n=t?String(t).toUpperCase():null;return goog.dom.getAncestor(e,function(e){return(!n||e.nodeName==n)&&(!o||goog.isString(e.className)&&goog.array.contains(e.className.split(/\s+/),o))},!0,i)},goog.dom.getAncestorByClass=function(e,t,o){return goog.dom.getAncestorByTagNameAndClass(e,null,t,o)},goog.dom.getAncestor=function(e,t,o,i){for(e&&!o&&(e=e.parentNode),o=0;e&&(null==i||o<=i);){if(goog.asserts.assert("parentNode"!=e.name),t(e))return e;e=e.parentNode,o++}return null},goog.dom.getActiveElement=function(e){try{return e&&e.activeElement}catch(e){}return null},goog.dom.getPixelRatio=function(){var e=goog.dom.getWindow();return goog.isDef(e.devicePixelRatio)?e.devicePixelRatio:e.matchMedia?goog.dom.matchesPixelRatio_(3)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(1)||.75:1},goog.dom.matchesPixelRatio_=function(e){return goog.dom.getWindow().matchMedia("(min-resolution: "+e+"dppx),(min--moz-device-pixel-ratio: "+e+"),(min-resolution: "+96*e+"dpi)").matches?e:0},goog.dom.getCanvasContext2D=function(e){return e.getContext("2d")},goog.dom.DomHelper=function(e){this.document_=e||goog.global.document||document},goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper,goog.dom.DomHelper.prototype.setDocument=function(e){this.document_=e},goog.dom.DomHelper.prototype.getDocument=function(){return this.document_},goog.dom.DomHelper.prototype.getElement=function(e){return goog.dom.getElementHelper_(this.document_,e)},goog.dom.DomHelper.prototype.getRequiredElement=function(e){return goog.dom.getRequiredElementHelper_(this.document_,e)},goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement,goog.dom.DomHelper.prototype.getElementsByTagName=function(e,t){return(t||this.document_).getElementsByTagName(String(e))},goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(e,t,o){return goog.dom.getElementsByTagNameAndClass_(this.document_,e,t,o)},goog.dom.DomHelper.prototype.getElementByTagNameAndClass=function(e,t,o){return goog.dom.getElementByTagNameAndClass_(this.document_,e,t,o)},goog.dom.DomHelper.prototype.getElementsByClass=function(e,t){return goog.dom.getElementsByClass(e,t||this.document_)},goog.dom.DomHelper.prototype.getElementByClass=function(e,t){return goog.dom.getElementByClass(e,t||this.document_)},goog.dom.DomHelper.prototype.getRequiredElementByClass=function(e,t){return goog.dom.getRequiredElementByClass(e,t||this.document_)},goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass,goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties,goog.dom.DomHelper.prototype.getViewportSize=function(e){return goog.dom.getViewportSize(e||this.getWindow())},goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())},goog.dom.DomHelper.prototype.createDom=function(e,t,o){return goog.dom.createDom_(this.document_,arguments)},goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom,goog.dom.DomHelper.prototype.createElement=function(e){return goog.dom.createElement_(this.document_,e)},goog.dom.DomHelper.prototype.createTextNode=function(e){return this.document_.createTextNode(String(e))},goog.dom.DomHelper.prototype.createTable=function(e,t,o){return goog.dom.createTable_(this.document_,e,t,!!o)},goog.dom.DomHelper.prototype.safeHtmlToNode=function(e){return goog.dom.safeHtmlToNode_(this.document_,e)},goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)},goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)},goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)},goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)},goog.dom.DomHelper.prototype.getActiveElement=function(e){return goog.dom.getActiveElement(e||this.document_)},goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild,goog.dom.DomHelper.prototype.append=goog.dom.append,goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren,goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren,goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore,goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter,goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt,goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode,goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode,goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement,goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren,goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild,goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild,goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling,goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling,goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode,goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode,goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike,goog.dom.DomHelper.prototype.isElement=goog.dom.isElement,goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow,goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement,goog.dom.DomHelper.prototype.contains=goog.dom.contains,goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder,goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor,goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument,goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument,goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow,goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent,goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml,goog.dom.DomHelper.prototype.findNode=goog.dom.findNode,goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes,goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex,goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex,goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable,goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent,goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength,goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset,goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset,goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList,goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass,goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass,goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor,goog.dom.DomHelper.prototype.getCanvasContext2D=goog.dom.getCanvasContext2D,goog.color={},goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},goog.color.parse=function(e){var t={};e=String(e);var o=goog.color.prependHashIfNecessaryHelper(e);if(goog.color.isValidHexColor_(o))return t.hex=goog.color.normalizeHex(o),t.type="hex",t;if((o=goog.color.isValidRgbColor_(e)).length)return t.hex=goog.color.rgbArrayToHex(o),t.type="rgb",t;if(goog.color.names&&(o=goog.color.names[e.toLowerCase()]))return t.hex=o,t.type="named",t;throw Error(e+" is not a valid color string")},goog.color.isValidColor=function(e){var t=goog.color.prependHashIfNecessaryHelper(e);return!!(goog.color.isValidHexColor_(t)||goog.color.isValidRgbColor_(e).length||goog.color.names&&goog.color.names[e.toLowerCase()])},goog.color.parseRgb=function(e){var t=goog.color.isValidRgbColor_(e);if(!t.length)throw Error(e+" is not a valid RGB color");return t},goog.color.hexToRgbStyle=function(e){return goog.color.rgbStyle_(goog.color.hexToRgb(e))},goog.color.hexTripletRe_=/#(.)(.)(.)/,goog.color.normalizeHex=function(e){if(!goog.color.isValidHexColor_(e))throw Error("'"+e+"' is not a valid hex color");return 4==e.length&&(e=e.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3")),e.toLowerCase()},goog.color.hexToRgb=function(e){return e=goog.color.normalizeHex(e),[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),e=parseInt(e.substr(5,2),16)]},goog.color.rgbToHex=function(e,t,o){if(e=Number(e),t=Number(t),o=Number(o),e!=(255&e)||t!=(255&t)||o!=(255&o))throw Error('"('+e+","+t+","+o+'") is not a valid RGB color');return"#"+(e=goog.color.prependZeroIfNecessaryHelper(e.toString(16)))+(t=goog.color.prependZeroIfNecessaryHelper(t.toString(16)))+(o=goog.color.prependZeroIfNecessaryHelper(o.toString(16)))},goog.color.rgbArrayToHex=function(e){return goog.color.rgbToHex(e[0],e[1],e[2])},goog.color.rgbToHsl=function(e,t,o){e/=255,t/=255,o/=255;var i=Math.max(e,t,o),n=Math.min(e,t,o),r=0,s=0,a=.5*(i+n);return i!=n&&(i==e?r=60*(t-o)/(i-n):i==t?r=60*(o-e)/(i-n)+120:i==o&&(r=60*(e-t)/(i-n)+240),s=0<a&&.5>=a?(i-n)/(2*a):(i-n)/(2-2*a)),[Math.round(r+360)%360,s,a]},goog.color.rgbArrayToHsl=function(e){return goog.color.rgbToHsl(e[0],e[1],e[2])},goog.color.hueToRgb_=function(e,t,o){return 0>o?o+=1:1<o&&--o,1>6*o?e+6*(t-e)*o:1>2*o?t:2>3*o?e+(t-e)*(2/3-o)*6:e},goog.color.hslToRgb=function(e,t,o){if(e/=360,0==t)o=t=e=255*o;else{var i=.5>o?o*(1+t):o+t-t*o,n=2*o-i;o=255*goog.color.hueToRgb_(n,i,e+1/3),t=255*goog.color.hueToRgb_(n,i,e),e=255*goog.color.hueToRgb_(n,i,e-1/3)}return[Math.round(o),Math.round(t),Math.round(e)]},goog.color.hslArrayToRgb=function(e){return goog.color.hslToRgb(e[0],e[1],e[2])},goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i,goog.color.isValidHexColor_=function(e){return goog.color.validHexColorRe_.test(e)},goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/,goog.color.isNormalizedHexColor_=function(e){return goog.color.normalizedHexColorRe_.test(e)},goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,goog.color.isValidRgbColor_=function(e){var t=e.match(goog.color.rgbColorRe_);if(t){e=Number(t[1]);var o=Number(t[2]);if(t=Number(t[3]),0<=e&&255>=e&&0<=o&&255>=o&&0<=t&&255>=t)return[e,o,t]}return[]},goog.color.prependZeroIfNecessaryHelper=function(e){return 1==e.length?"0"+e:e},goog.color.prependHashIfNecessaryHelper=function(e){return"#"==e.charAt(0)?e:"#"+e},goog.color.rgbStyle_=function(e){return"rgb("+e.join(",")+")"},goog.color.hsvToRgb=function(e,t,o){var i=0,n=0,r=0;if(0==t)r=n=i=o;else{var s=Math.floor(e/60),a=e/60-s;e=o*(1-t);var l=o*(1-t*a);switch(t=o*(1-t*(1-a)),s){case 1:i=l,n=o,r=e;break;case 2:i=e,n=o,r=t;break;case 3:i=e,n=l,r=o;break;case 4:i=t,n=e,r=o;break;case 5:i=o,n=e,r=l;break;case 6:case 0:i=o,n=t,r=e}}return[Math.floor(i),Math.floor(n),Math.floor(r)]},goog.color.rgbToHsv=function(e,t,o){var i=Math.max(Math.max(e,t),o),n=Math.min(Math.min(e,t),o);if(n==i)n=e=0;else{var r=i-n;n=r/i,0>(e=60*(e==i?(t-o)/r:t==i?2+(o-e)/r:4+(e-t)/r))&&(e+=360),360<e&&(e-=360)}return[e,n,i]},goog.color.rgbArrayToHsv=function(e){return goog.color.rgbToHsv(e[0],e[1],e[2])},goog.color.hsvArrayToRgb=function(e){return goog.color.hsvToRgb(e[0],e[1],e[2])},goog.color.hexToHsl=function(e){return e=goog.color.hexToRgb(e),goog.color.rgbToHsl(e[0],e[1],e[2])},goog.color.hslToHex=function(e,t,o){return goog.color.rgbArrayToHex(goog.color.hslToRgb(e,t,o))},goog.color.hslArrayToHex=function(e){return goog.color.rgbArrayToHex(goog.color.hslToRgb(e[0],e[1],e[2]))},goog.color.hexToHsv=function(e){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(e))},goog.color.hsvToHex=function(e,t,o){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(e,t,o))},goog.color.hsvArrayToHex=function(e){return goog.color.hsvToHex(e[0],e[1],e[2])},goog.color.hslDistance=function(e,t){var o=.5>=e[2]?e[1]*e[2]:e[1]*(1-e[2]),i=.5>=t[2]?t[1]*t[2]:t[1]*(1-t[2]);return(e[2]-t[2])*(e[2]-t[2])+o*o+i*i-2*o*i*Math.cos(2*(e[0]/360-t[0]/360)*Math.PI)},goog.color.blend=function(e,t,o){return o=goog.math.clamp(o,0,1),[Math.round(o*e[0]+(1-o)*t[0]),Math.round(o*e[1]+(1-o)*t[1]),Math.round(o*e[2]+(1-o)*t[2])]},goog.color.darken=function(e,t){return goog.color.blend([0,0,0],e,t)},goog.color.lighten=function(e,t){return goog.color.blend([255,255,255],e,t)},goog.color.highContrast=function(e,t){for(var o=[],i=0;i<t.length;i++)o.push({color:t[i],diff:goog.color.yiqBrightnessDiff_(t[i],e)+goog.color.colorDiff_(t[i],e)});return o.sort(function(e,t){return t.diff-e.diff}),o[0].color},goog.color.yiqBrightness_=function(e){return Math.round((299*e[0]+587*e[1]+114*e[2])/1e3)},goog.color.yiqBrightnessDiff_=function(e,t){return Math.abs(goog.color.yiqBrightness_(e)-goog.color.yiqBrightness_(t))},goog.color.colorDiff_=function(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])+Math.abs(e[2]-t[2])},goog.dom.vendor={},goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null},goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null},goog.dom.vendor.getPrefixedPropertyName=function(e,t){if(t&&e in t)return e;var o=goog.dom.vendor.getVendorJsPrefix();return o?(o=o.toLowerCase(),o+=goog.string.toTitleCase(e),!goog.isDef(t)||o in t?o:null):null},goog.dom.vendor.getPrefixedEventType=function(e){return((goog.dom.vendor.getVendorJsPrefix()||"")+e).toLowerCase()},goog.math.Box=function(e,t,o,i){this.top=e,this.right=t,this.bottom=o,this.left=i},goog.math.Box.boundingBox=function(e){for(var t=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),o=1;o<arguments.length;o++)t.expandToIncludeCoordinate(arguments[o]);return t},goog.math.Box.prototype.getWidth=function(){return this.right-this.left},goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top},goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)},goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"}),goog.math.Box.prototype.contains=function(e){return goog.math.Box.contains(this,e)},goog.math.Box.prototype.expand=function(e,t,o,i){return goog.isObject(e)?(this.top-=e.top,this.right+=e.right,this.bottom+=e.bottom,this.left-=e.left):(this.top-=e,this.right+=Number(t),this.bottom+=Number(o),this.left-=Number(i)),this},goog.math.Box.prototype.expandToInclude=function(e){this.left=Math.min(this.left,e.left),this.top=Math.min(this.top,e.top),this.right=Math.max(this.right,e.right),this.bottom=Math.max(this.bottom,e.bottom)},goog.math.Box.prototype.expandToIncludeCoordinate=function(e){this.top=Math.min(this.top,e.y),this.right=Math.max(this.right,e.x),this.bottom=Math.max(this.bottom,e.y),this.left=Math.min(this.left,e.x)},goog.math.Box.equals=function(e,t){return e==t||!(!e||!t)&&(e.top==t.top&&e.right==t.right&&e.bottom==t.bottom&&e.left==t.left)},goog.math.Box.contains=function(e,t){return!(!e||!t)&&(t instanceof goog.math.Box?t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom:t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom)},goog.math.Box.relativePositionX=function(e,t){return t.x<e.left?t.x-e.left:t.x>e.right?t.x-e.right:0},goog.math.Box.relativePositionY=function(e,t){return t.y<e.top?t.y-e.top:t.y>e.bottom?t.y-e.bottom:0},goog.math.Box.distance=function(e,t){var o=goog.math.Box.relativePositionX(e,t),i=goog.math.Box.relativePositionY(e,t);return Math.sqrt(o*o+i*i)},goog.math.Box.intersects=function(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom},goog.math.Box.intersectsWithPadding=function(e,t,o){return e.left<=t.right+o&&t.left<=e.right+o&&e.top<=t.bottom+o&&t.top<=e.bottom+o},goog.math.Box.prototype.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},goog.math.Box.prototype.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},goog.math.Box.prototype.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this},goog.math.Box.prototype.translate=function(e,t){return e instanceof goog.math.Coordinate?(this.left+=e.x,this.right+=e.x,this.top+=e.y,this.bottom+=e.y):(goog.asserts.assertNumber(e),this.left+=e,this.right+=e,goog.isNumber(t)&&(this.top+=t,this.bottom+=t)),this},goog.math.Box.prototype.scale=function(e,t){var o=goog.isNumber(t)?t:e;return this.left*=e,this.right*=e,this.top*=o,this.bottom*=o,this},goog.math.IRect=function(){},goog.math.Rect=function(e,t,o,i){this.left=e,this.top=t,this.width=o,this.height=i},goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)},goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)},goog.math.Rect.createFromPositionAndSize=function(e,t){return new goog.math.Rect(e.x,e.y,t.width,t.height)},goog.math.Rect.createFromBox=function(e){return new goog.math.Rect(e.left,e.top,e.right-e.left,e.bottom-e.top)},goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"}),goog.math.Rect.equals=function(e,t){return e==t||!(!e||!t)&&(e.left==t.left&&e.width==t.width&&e.top==t.top&&e.height==t.height)},goog.math.Rect.prototype.intersection=function(e){var t=Math.max(this.left,e.left),o=Math.min(this.left+this.width,e.left+e.width);if(t<=o){var i=Math.max(this.top,e.top);if(i<=(e=Math.min(this.top+this.height,e.top+e.height)))return this.left=t,this.top=i,this.width=o-t,this.height=e-i,!0}return!1},goog.math.Rect.intersection=function(e,t){var o=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width);if(o<=i){var n=Math.max(e.top,t.top),r=Math.min(e.top+e.height,t.top+t.height);if(n<=r)return new goog.math.Rect(o,n,i-o,r-n)}return null},goog.math.Rect.intersects=function(e,t){return e.left<=t.left+t.width&&t.left<=e.left+e.width&&e.top<=t.top+t.height&&t.top<=e.top+e.height},goog.math.Rect.prototype.intersects=function(e){return goog.math.Rect.intersects(this,e)},goog.math.Rect.difference=function(e,t){var o=goog.math.Rect.intersection(e,t);if(!o||!o.height||!o.width)return[e.clone()];o=[];var i=e.top,n=e.height,r=e.left+e.width,s=e.top+e.height,a=t.left+t.width,l=t.top+t.height;return t.top>e.top&&(o.push(new goog.math.Rect(e.left,e.top,e.width,t.top-e.top)),i=t.top,n-=t.top-e.top),l<s&&(o.push(new goog.math.Rect(e.left,l,e.width,s-l)),n=l-i),t.left>e.left&&o.push(new goog.math.Rect(e.left,i,t.left-e.left,n)),a<r&&o.push(new goog.math.Rect(a,i,r-a,n)),o},goog.math.Rect.prototype.difference=function(e){return goog.math.Rect.difference(this,e)},goog.math.Rect.prototype.boundingRect=function(e){var t=Math.max(this.left+this.width,e.left+e.width),o=Math.max(this.top+this.height,e.top+e.height);this.left=Math.min(this.left,e.left),this.top=Math.min(this.top,e.top),this.width=t-this.left,this.height=o-this.top},goog.math.Rect.boundingRect=function(e,t){if(!e||!t)return null;var o=new goog.math.Rect(e.left,e.top,e.width,e.height);return o.boundingRect(t),o},goog.math.Rect.prototype.contains=function(e){return e instanceof goog.math.Coordinate?e.x>=this.left&&e.x<=this.left+this.width&&e.y>=this.top&&e.y<=this.top+this.height:this.left<=e.left&&this.left+this.width>=e.left+e.width&&this.top<=e.top&&this.top+this.height>=e.top+e.height},goog.math.Rect.prototype.squaredDistance=function(e){var t=e.x<this.left?this.left-e.x:Math.max(e.x-(this.left+this.width),0);return t*t+(e=e.y<this.top?this.top-e.y:Math.max(e.y-(this.top+this.height),0))*e},goog.math.Rect.prototype.distance=function(e){return Math.sqrt(this.squaredDistance(e))},goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)},goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)},goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)},goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)},goog.math.Rect.prototype.ceil=function(){return this.left=Math.ceil(this.left),this.top=Math.ceil(this.top),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},goog.math.Rect.prototype.floor=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},goog.math.Rect.prototype.round=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.width=Math.round(this.width),this.height=Math.round(this.height),this},goog.math.Rect.prototype.translate=function(e,t){return e instanceof goog.math.Coordinate?(this.left+=e.x,this.top+=e.y):(this.left+=goog.asserts.assertNumber(e),goog.isNumber(t)&&(this.top+=t)),this},goog.math.Rect.prototype.scale=function(e,t){var o=goog.isNumber(t)?t:e;return this.left*=e,this.width*=e,this.top*=o,this.height*=o,this},goog.style={},goog.style.setStyle=function(e,t,o){if(goog.isString(t))goog.style.setStyle_(e,o,t);else for(var i in t)goog.style.setStyle_(e,t[i],i)},goog.style.setStyle_=function(e,t,o){(o=goog.style.getVendorJsStyleName_(e,o))&&(e.style[o]=t)},goog.style.styleNameCache_={},goog.style.getVendorJsStyleName_=function(e,t){var o=goog.style.styleNameCache_[t];if(!o){var i=goog.string.toCamelCase(t);o=i,void 0===e.style[i]&&(i=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(i),void 0!==e.style[i]&&(o=i)),goog.style.styleNameCache_[t]=o}return o},goog.style.getVendorStyleName_=function(e,t){var o=goog.string.toCamelCase(t);return void 0===e.style[o]&&(o=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(o),void 0!==e.style[o])?goog.dom.vendor.getVendorPrefix()+"-"+t:t},goog.style.getStyle=function(e,t){var o=e.style[goog.string.toCamelCase(t)];return void 0!==o?o:e.style[goog.style.getVendorJsStyleName_(e,t)]||""},goog.style.getComputedStyle=function(e,t){var o=goog.dom.getOwnerDocument(e);return o.defaultView&&o.defaultView.getComputedStyle&&(o=o.defaultView.getComputedStyle(e,null))&&(o[t]||o.getPropertyValue(t))||""},goog.style.getCascadedStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:null},goog.style.getStyle_=function(e,t){return goog.style.getComputedStyle(e,t)||goog.style.getCascadedStyle(e,t)||e.style&&e.style[t]},goog.style.getComputedBoxSizing=function(e){return goog.style.getStyle_(e,"boxSizing")||goog.style.getStyle_(e,"MozBoxSizing")||goog.style.getStyle_(e,"WebkitBoxSizing")||null},goog.style.getComputedPosition=function(e){return goog.style.getStyle_(e,"position")},goog.style.getBackgroundColor=function(e){return goog.style.getStyle_(e,"backgroundColor")},goog.style.getComputedOverflowX=function(e){return goog.style.getStyle_(e,"overflowX")},goog.style.getComputedOverflowY=function(e){return goog.style.getStyle_(e,"overflowY")},goog.style.getComputedZIndex=function(e){return goog.style.getStyle_(e,"zIndex")},goog.style.getComputedTextAlign=function(e){return goog.style.getStyle_(e,"textAlign")},goog.style.getComputedCursor=function(e){return goog.style.getStyle_(e,"cursor")},goog.style.getComputedTransform=function(e){var t=goog.style.getVendorStyleName_(e,"transform");return goog.style.getStyle_(e,t)||goog.style.getStyle_(e,"transform")},goog.style.setPosition=function(e,t,o){if(t instanceof goog.math.Coordinate){var i=t.x;t=t.y}else i=t,t=o;e.style.left=goog.style.getPixelStyleValue_(i,!1),e.style.top=goog.style.getPixelStyleValue_(t,!1)},goog.style.getPosition=function(e){return new goog.math.Coordinate(e.offsetLeft,e.offsetTop)},goog.style.getClientViewportElement=function(e){return e=e?goog.dom.getOwnerDocument(e):goog.dom.getDocument(),!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||goog.dom.getDomHelper(e).isCss1CompatMode()?e.documentElement:e.body},goog.style.getViewportPageOffset=function(e){var t=e.body;return e=e.documentElement,new goog.math.Coordinate(t.scrollLeft||e.scrollLeft,t.scrollTop||e.scrollTop)},goog.style.getBoundingClientRect_=function(e){try{var t=e.getBoundingClientRect()}catch(e){return{left:0,top:0,right:0,bottom:0}}return goog.userAgent.IE&&e.ownerDocument.body&&(e=e.ownerDocument,t.left-=e.documentElement.clientLeft+e.body.clientLeft,t.top-=e.documentElement.clientTop+e.body.clientTop),t},goog.style.getOffsetParent=function(e){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8))return goog.asserts.assert(e&&"offsetParent"in e),e.offsetParent;var t=goog.dom.getOwnerDocument(e),o=goog.style.getStyle_(e,"position"),i="fixed"==o||"absolute"==o;for(e=e.parentNode;e&&e!=t;e=e.parentNode)if(e.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&e.host&&(e=e.host),o=goog.style.getStyle_(e,"position"),!(i=i&&"static"==o&&e!=t.documentElement&&e!=t.body)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight||"fixed"==o||"absolute"==o||"relative"==o))return e;return null},goog.style.getVisibleRectForElement=function(e){for(var t=new goog.math.Box(0,1/0,1/0,0),o=goog.dom.getDomHelper(e),i=o.getDocument().body,n=o.getDocument().documentElement,r=o.getDocumentScrollElement();e=goog.style.getOffsetParent(e);)if(!(goog.userAgent.IE&&0==e.clientWidth||goog.userAgent.WEBKIT&&0==e.clientHeight&&e==i)&&e!=i&&e!=n&&"visible"!=goog.style.getStyle_(e,"overflow")){var s=goog.style.getPageOffset(e),a=goog.style.getClientLeftTop(e);s.x+=a.x,s.y+=a.y,t.top=Math.max(t.top,s.y),t.right=Math.min(t.right,s.x+e.clientWidth),t.bottom=Math.min(t.bottom,s.y+e.clientHeight),t.left=Math.max(t.left,s.x)}return i=r.scrollLeft,r=r.scrollTop,t.left=Math.max(t.left,i),t.top=Math.max(t.top,r),o=o.getViewportSize(),t.right=Math.min(t.right,i+o.width),t.bottom=Math.min(t.bottom,r+o.height),0<=t.top&&0<=t.left&&t.bottom>t.top&&t.right>t.left?t:null},goog.style.getContainerOffsetToScrollInto=function(e,t,o){var i=t||goog.dom.getDocumentScrollElement(),n=goog.style.getPageOffset(e),r=goog.style.getPageOffset(i),s=goog.style.getBorderBox(i);return i==goog.dom.getDocumentScrollElement()?(t=n.x-i.scrollLeft,n=n.y-i.scrollTop,goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)&&(t+=s.left,n+=s.top)):(t=n.x-r.x-s.left,n=n.y-r.y-s.top),s=goog.style.getSizeWithDisplay_(e),e=i.clientWidth-s.width,s=i.clientHeight-s.height,r=i.scrollLeft,i=i.scrollTop,o?(r+=t-e/2,i+=n-s/2):(r+=Math.min(t,Math.max(t-e,0)),i+=Math.min(n,Math.max(n-s,0))),new goog.math.Coordinate(r,i)},goog.style.scrollIntoContainerView=function(e,t,o){t=t||goog.dom.getDocumentScrollElement(),e=goog.style.getContainerOffsetToScrollInto(e,t,o),t.scrollLeft=e.x,t.scrollTop=e.y},goog.style.getClientLeftTop=function(e){return new goog.math.Coordinate(e.clientLeft,e.clientTop)},goog.style.getPageOffset=function(e){var t=goog.dom.getOwnerDocument(e);goog.asserts.assertObject(e,"Parameter is required");var o=new goog.math.Coordinate(0,0);return e==goog.style.getClientViewportElement(t)?o:(e=goog.style.getBoundingClientRect_(e),t=goog.dom.getDomHelper(t).getDocumentScroll(),o.x=e.left+t.x,o.y=e.top+t.y,o)},goog.style.getPageOffsetLeft=function(e){return goog.style.getPageOffset(e).x},goog.style.getPageOffsetTop=function(e){return goog.style.getPageOffset(e).y},goog.style.getFramedPageOffset=function(e,t){var o=new goog.math.Coordinate(0,0),i=goog.dom.getWindow(goog.dom.getOwnerDocument(e));if(!goog.reflect.canAccessProperty(i,"parent"))return o;var n=e;do{var r=i==t?goog.style.getPageOffset(n):goog.style.getClientPositionForElement_(goog.asserts.assert(n));o.x+=r.x,o.y+=r.y}while(i&&i!=t&&i!=i.parent&&(n=i.frameElement)&&(i=i.parent));return o},goog.style.translateRectForAnotherFrame=function(e,t,o){if(t.getDocument()!=o.getDocument()){var i=t.getDocument().body;o=goog.style.getFramedPageOffset(i,o.getWindow()),o=goog.math.Coordinate.difference(o,goog.style.getPageOffset(i)),!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||t.isCss1CompatMode()||(o=goog.math.Coordinate.difference(o,t.getDocumentScroll())),e.left+=o.x,e.top+=o.y}},goog.style.getRelativePosition=function(e,t){var o=goog.style.getClientPosition(e),i=goog.style.getClientPosition(t);return new goog.math.Coordinate(o.x-i.x,o.y-i.y)},goog.style.getClientPositionForElement_=function(e){return e=goog.style.getBoundingClientRect_(e),new goog.math.Coordinate(e.left,e.top)},goog.style.getClientPosition=function(e){return goog.asserts.assert(e),e.nodeType==goog.dom.NodeType.ELEMENT?goog.style.getClientPositionForElement_(e):(e=e.changedTouches?e.changedTouches[0]:e,new goog.math.Coordinate(e.clientX,e.clientY))},goog.style.setPageOffset=function(e,t,o){var i=goog.style.getPageOffset(e);t instanceof goog.math.Coordinate&&(o=t.y,t=t.x),t=goog.asserts.assertNumber(t)-i.x,goog.style.setPosition(e,e.offsetLeft+t,e.offsetTop+(Number(o)-i.y))},goog.style.setSize=function(e,t,o){if(t instanceof goog.math.Size)o=t.height,t=t.width;else if(void 0==o)throw Error("missing height argument");goog.style.setWidth(e,t),goog.style.setHeight(e,o)},goog.style.getPixelStyleValue_=function(e,t){return"number"==typeof e&&(e=(t?Math.round(e):e)+"px"),e},goog.style.setHeight=function(e,t){e.style.height=goog.style.getPixelStyleValue_(t,!0)},goog.style.setWidth=function(e,t){e.style.width=goog.style.getPixelStyleValue_(t,!0)},goog.style.getSize=function(e){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,e)},goog.style.evaluateWithTemporaryDisplay_=function(e,t){if("none"!=goog.style.getStyle_(t,"display"))return e(t);var o=t.style,i=o.display,n=o.visibility,r=o.position;o.visibility="hidden",o.position="absolute",o.display="inline";var s=e(t);return o.display=i,o.position=r,o.visibility=n,s},goog.style.getSizeWithDisplay_=function(e){var t=e.offsetWidth,o=e.offsetHeight,i=goog.userAgent.WEBKIT&&!t&&!o;return goog.isDef(t)&&!i||!e.getBoundingClientRect?new goog.math.Size(t,o):(e=goog.style.getBoundingClientRect_(e),new goog.math.Size(e.right-e.left,e.bottom-e.top))},goog.style.getTransformedSize=function(e){return e.getBoundingClientRect?(e=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,e),new goog.math.Size(e.right-e.left,e.bottom-e.top)):null},goog.style.getBounds=function(e){var t=goog.style.getPageOffset(e);return e=goog.style.getSize(e),new goog.math.Rect(t.x,t.y,e.width,e.height)},goog.style.toCamelCase=function(e){return goog.string.toCamelCase(String(e))},goog.style.toSelectorCase=function(e){return goog.string.toSelectorCase(e)},goog.style.getOpacity=function(e){goog.asserts.assert(e);var t=e.style;return e="","opacity"in t?e=t.opacity:"MozOpacity"in t?e=t.MozOpacity:"filter"in t&&(t=t.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(e=String(t[1]/100)),""==e?e:Number(e)},goog.style.setOpacity=function(e,t){goog.asserts.assert(e);var o=e.style;"opacity"in o?o.opacity=t:"MozOpacity"in o?o.MozOpacity=t:"filter"in o&&(o.filter=""===t?"":"alpha(opacity="+100*Number(t)+")")},goog.style.setTransparentBackgroundImage=function(e,t){var o=e.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?o.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+t+'", sizingMethod="crop")':(o.backgroundImage="url("+t+")",o.backgroundPosition="top left",o.backgroundRepeat="no-repeat")},goog.style.clearTransparentBackgroundImage=function(e){"filter"in(e=e.style)?e.filter="":e.backgroundImage="none"},goog.style.showElement=function(e,t){goog.style.setElementShown(e,t)},goog.style.setElementShown=function(e,t){e.style.display=t?"":"none"},goog.style.isElementShown=function(e){return"none"!=e.style.display},goog.style.installSafeStyleSheet=function(e,t){var o=goog.dom.getDomHelper(t),i=o.getDocument();if(goog.userAgent.IE&&i.createStyleSheet)return o=i.createStyleSheet(),goog.style.setSafeStyleSheet(o,e),o;if(!(i=o.getElementsByTagNameAndClass("HEAD")[0])){var n=o.getElementsByTagNameAndClass("BODY")[0];i=o.createDom("HEAD"),n.parentNode.insertBefore(i,n)}return n=o.createDom("STYLE"),goog.style.setSafeStyleSheet(n,e),o.appendChild(i,n),n},goog.style.uninstallStyles=function(e){goog.dom.removeNode(e.ownerNode||e.owningElement||e)},goog.style.setSafeStyleSheet=function(e,t){var o=goog.html.SafeStyleSheet.unwrap(t);goog.userAgent.IE&&goog.isDef(e.cssText)?e.cssText=o:e.innerHTML=o},goog.style.setPreWrap=function(e){e=e.style,goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(e.whiteSpace="pre",e.wordWrap="break-word"):e.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"},goog.style.setInlineBlock=function(e){(e=e.style).position="relative",goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(e.zoom="1",e.display="inline"):e.display="inline-block"},goog.style.isRightToLeft=function(e){return"rtl"==goog.style.getStyle_(e,"direction")},goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null,goog.style.isUnselectable=function(e){return goog.style.unselectableStyle_?"none"==e.style[goog.style.unselectableStyle_].toLowerCase():!(!goog.userAgent.IE&&!goog.userAgent.OPERA)&&"on"==e.getAttribute("unselectable")},goog.style.setUnselectable=function(e,t,o){o=o?null:e.getElementsByTagName("*");var i=goog.style.unselectableStyle_;if(i){if(t=t?"none":"",e.style&&(e.style[i]=t),o){e=0;for(var n;n=o[e];e++)n.style&&(n.style[i]=t)}}else if((goog.userAgent.IE||goog.userAgent.OPERA)&&(t=t?"on":"",e.setAttribute("unselectable",t),o))for(e=0;n=o[e];e++)n.setAttribute("unselectable",t)},goog.style.getBorderBoxSize=function(e){return new goog.math.Size(e.offsetWidth,e.offsetHeight)},goog.style.setBorderBoxSize=function(e,t){var o=goog.dom.getOwnerDocument(e),i=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||i&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(e,t,"border-box");else if(o=e.style,i){i=goog.style.getPaddingBox(e);var n=goog.style.getBorderBox(e);o.pixelWidth=t.width-n.left-i.left-i.right-n.right,o.pixelHeight=t.height-n.top-i.top-i.bottom-n.bottom}else o.pixelWidth=t.width,o.pixelHeight=t.height},goog.style.getContentBoxSize=function(e){var t=goog.dom.getOwnerDocument(e),o=goog.userAgent.IE&&e.currentStyle;return o&&goog.dom.getDomHelper(t).isCss1CompatMode()&&"auto"!=o.width&&"auto"!=o.height&&!o.boxSizing?(t=goog.style.getIePixelValue_(e,o.width,"width","pixelWidth"),e=goog.style.getIePixelValue_(e,o.height,"height","pixelHeight"),new goog.math.Size(t,e)):(o=goog.style.getBorderBoxSize(e),t=goog.style.getPaddingBox(e),e=goog.style.getBorderBox(e),new goog.math.Size(o.width-e.left-t.left-t.right-e.right,o.height-e.top-t.top-t.bottom-e.bottom))},goog.style.setContentBoxSize=function(e,t){var o=goog.dom.getOwnerDocument(e),i=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||i&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(e,t,"content-box");else if(o=e.style,i)o.pixelWidth=t.width,o.pixelHeight=t.height;else{i=goog.style.getPaddingBox(e);var n=goog.style.getBorderBox(e);o.pixelWidth=t.width+n.left+i.left+i.right+n.right,o.pixelHeight=t.height+n.top+i.top+i.bottom+n.bottom}},goog.style.setBoxSizingSize_=function(e,t,o){e=e.style,goog.userAgent.GECKO?e.MozBoxSizing=o:goog.userAgent.WEBKIT?e.WebkitBoxSizing=o:e.boxSizing=o,e.width=Math.max(t.width,0)+"px",e.height=Math.max(t.height,0)+"px"},goog.style.getIePixelValue_=function(e,t,o,i){if(/^\d+px?$/.test(t))return parseInt(t,10);var n=e.style[o],r=e.runtimeStyle[o];return e.runtimeStyle[o]=e.currentStyle[o],e.style[o]=t,t=e.style[i],e.style[o]=n,e.runtimeStyle[o]=r,+t},goog.style.getIePixelDistance_=function(e,t){var o=goog.style.getCascadedStyle(e,t);return o?goog.style.getIePixelValue_(e,o,"left","pixelLeft"):0},goog.style.getBox_=function(e,t){if(goog.userAgent.IE){var o=goog.style.getIePixelDistance_(e,t+"Left"),i=goog.style.getIePixelDistance_(e,t+"Right"),n=goog.style.getIePixelDistance_(e,t+"Top"),r=goog.style.getIePixelDistance_(e,t+"Bottom");return new goog.math.Box(n,i,r,o)}return o=goog.style.getComputedStyle(e,t+"Left"),i=goog.style.getComputedStyle(e,t+"Right"),n=goog.style.getComputedStyle(e,t+"Top"),r=goog.style.getComputedStyle(e,t+"Bottom"),new goog.math.Box(parseFloat(n),parseFloat(i),parseFloat(r),parseFloat(o))},goog.style.getPaddingBox=function(e){return goog.style.getBox_(e,"padding")},goog.style.getMarginBox=function(e){return goog.style.getBox_(e,"margin")},goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6},goog.style.getIePixelBorder_=function(e,t){if("none"==goog.style.getCascadedStyle(e,t+"Style"))return 0;var o=goog.style.getCascadedStyle(e,t+"Width");return o in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[o]:goog.style.getIePixelValue_(e,o,"left","pixelLeft")},goog.style.getBorderBox=function(e){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var t=goog.style.getIePixelBorder_(e,"borderLeft"),o=goog.style.getIePixelBorder_(e,"borderRight"),i=goog.style.getIePixelBorder_(e,"borderTop");return e=goog.style.getIePixelBorder_(e,"borderBottom"),new goog.math.Box(i,o,e,t)}return t=goog.style.getComputedStyle(e,"borderLeftWidth"),o=goog.style.getComputedStyle(e,"borderRightWidth"),i=goog.style.getComputedStyle(e,"borderTopWidth"),e=goog.style.getComputedStyle(e,"borderBottomWidth"),new goog.math.Box(parseFloat(i),parseFloat(o),parseFloat(e),parseFloat(t))},goog.style.getFontFamily=function(e){var t=goog.dom.getOwnerDocument(e),o="";if(t.body.createTextRange&&goog.dom.contains(t,e)){(t=t.body.createTextRange()).moveToElementText(e);try{o=t.queryCommandValue("FontName")}catch(e){o=""}}return o||(o=goog.style.getStyle_(e,"fontFamily")),1<(e=o.split(",")).length&&(o=e[0]),goog.string.stripQuotes(o,"\"'")},goog.style.lengthUnitRegex_=/[^\d]+$/,goog.style.getLengthUnits=function(e){return(e=e.match(goog.style.lengthUnitRegex_))&&e[0]||null},goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,in:1,mm:1,pc:1,pt:1},goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1},goog.style.getFontSize=function(e){var t=goog.style.getStyle_(e,"fontSize"),o=goog.style.getLengthUnits(t);if(t&&"px"==o)return parseInt(t,10);if(goog.userAgent.IE){if(String(o)in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(e,t,"left","pixelLeft");if(e.parentNode&&e.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(o)in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_)return e=e.parentNode,o=goog.style.getStyle_(e,"fontSize"),goog.style.getIePixelValue_(e,t==o?"1em":t,"left","pixelLeft")}return o=goog.dom.createDom("SPAN",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"}),goog.dom.appendChild(e,o),t=o.offsetHeight,goog.dom.removeNode(o),t},goog.style.parseStyleAttribute=function(e){var t={};return goog.array.forEach(e.split(/\s*;\s*/),function(e){var o=e.match(/\s*([\w-]+)\s*:(.+)/);o&&(e=o[1],o=goog.string.trim(o[2]),t[goog.string.toCamelCase(e.toLowerCase())]=o)}),t},goog.style.toStyleAttribute=function(e){var t=[];return goog.object.forEach(e,function(e,o){t.push(goog.string.toSelectorCase(o),":",e,";")}),t.join("")},goog.style.setFloat=function(e,t){e.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=t},goog.style.getFloat=function(e){return e.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""},goog.style.getScrollbarWidth=function(e){var t=goog.dom.createElement("DIV");return e&&(t.className=e),t.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",e=goog.dom.createElement("DIV"),goog.style.setSize(e,"200px","200px"),t.appendChild(e),goog.dom.appendChild(goog.dom.getDocument().body,t),e=t.offsetWidth-t.clientWidth,goog.dom.removeNode(t),e},goog.style.MATRIX_TRANSLATION_REGEX_=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/,goog.style.getCssTranslation=function(e){return(e=goog.style.getComputedTransform(e))&&(e=e.match(goog.style.MATRIX_TRANSLATION_REGEX_))?new goog.math.Coordinate(parseFloat(e[1]),parseFloat(e[2])):new goog.math.Coordinate(0,0)},goog.events.EventHandler=function(e){goog.Disposable.call(this),this.handler_=e,this.keys_={}},goog.inherits(goog.events.EventHandler,goog.Disposable),goog.events.EventHandler.typeArray_=[],goog.events.EventHandler.prototype.listen=function(e,t,o,i){return this.listen_(e,t,o,i)},goog.events.EventHandler.prototype.listenWithScope=function(e,t,o,i,n){return this.listen_(e,t,o,i,n)},goog.events.EventHandler.prototype.listen_=function(e,t,o,i,n){goog.isArray(t)||(t&&(goog.events.EventHandler.typeArray_[0]=t.toString()),t=goog.events.EventHandler.typeArray_);for(var r=0;r<t.length;r++){var s=goog.events.listen(e,t[r],o||this.handleEvent,i||!1,n||this.handler_||this);if(!s)break;this.keys_[s.key]=s}return this},goog.events.EventHandler.prototype.listenOnce=function(e,t,o,i){return this.listenOnce_(e,t,o,i)},goog.events.EventHandler.prototype.listenOnceWithScope=function(e,t,o,i,n){return this.listenOnce_(e,t,o,i,n)},goog.events.EventHandler.prototype.listenOnce_=function(e,t,o,i,n){if(goog.isArray(t))for(var r=0;r<t.length;r++)this.listenOnce_(e,t[r],o,i,n);else{if(!(e=goog.events.listenOnce(e,t,o||this.handleEvent,i,n||this.handler_||this)))return this;this.keys_[e.key]=e}return this},goog.events.EventHandler.prototype.listenWithWrapper=function(e,t,o,i){return this.listenWithWrapper_(e,t,o,i)},goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(e,t,o,i,n){return this.listenWithWrapper_(e,t,o,i,n)},goog.events.EventHandler.prototype.listenWithWrapper_=function(e,t,o,i,n){return t.listen(e,o,i,n||this.handler_||this,this),this},goog.events.EventHandler.prototype.getListenerCount=function(){var e,t=0;for(e in this.keys_)Object.prototype.hasOwnProperty.call(this.keys_,e)&&t++;return t},goog.events.EventHandler.prototype.unlisten=function(e,t,o,i,n){if(goog.isArray(t))for(var r=0;r<t.length;r++)this.unlisten(e,t[r],o,i,n);else i=goog.isObject(i)?!!i.capture:!!i,(e=goog.events.getListener(e,t,o||this.handleEvent,i,n||this.handler_||this))&&(goog.events.unlistenByKey(e),delete this.keys_[e.key]);return this},goog.events.EventHandler.prototype.unlistenWithWrapper=function(e,t,o,i,n){return t.unlisten(e,o,i,n||this.handler_||this,this),this},goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,function(e,t){this.keys_.hasOwnProperty(t)&&goog.events.unlistenByKey(e)},this),this.keys_={}},goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this),this.removeAll()},goog.events.EventHandler.prototype.handleEvent=function(e){throw Error("EventHandler.handleEvent not implemented")},goog.ui={},goog.ui.IdGenerator=function(){},goog.addSingletonGetter(goog.ui.IdGenerator),goog.ui.IdGenerator.prototype.nextId_=0,goog.ui.IdGenerator.prototype.getNextUniqueId=function(){return":"+(this.nextId_++).toString(36)},goog.ui.Component=function(e){goog.events.EventTarget.call(this),this.dom_=e||goog.dom.getDomHelper(),this.rightToLeft_=goog.ui.Component.defaultRightToLeft_,this.id_=null,this.inDocument_=!1,this.element_=null,this.googUiComponentHandler_=void 0,this.childIndex_=this.children_=this.parent_=this.model_=null,this.wasDecorated_=!1},goog.inherits(goog.ui.Component,goog.events.EventTarget),goog.ui.Component.ALLOW_DETACHED_DECORATION=!1,goog.ui.Component.prototype.idGenerator_=goog.ui.IdGenerator.getInstance(),goog.ui.Component.DEFAULT_BIDI_DIR=0,goog.ui.Component.defaultRightToLeft_=1!=goog.ui.Component.DEFAULT_BIDI_DIR&&(-1==goog.ui.Component.DEFAULT_BIDI_DIR||null),goog.ui.Component.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",HIDE:"hide",DISABLE:"disable",ENABLE:"enable",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight",ACTIVATE:"activate",DEACTIVATE:"deactivate",SELECT:"select",UNSELECT:"unselect",CHECK:"check",UNCHECK:"uncheck",FOCUS:"focus",BLUR:"blur",OPEN:"open",CLOSE:"close",ENTER:"enter",LEAVE:"leave",ACTION:"action",CHANGE:"change"},goog.ui.Component.Error={NOT_SUPPORTED:"Method not supported",DECORATE_INVALID:"Invalid element to decorate",ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",NOT_OUR_CHILD:"Child is not in parent component",NOT_IN_DOCUMENT:"Operation not supported while component is not in document",STATE_INVALID:"Invalid component state"},goog.ui.Component.State={ALL:255,DISABLED:1,HOVER:2,ACTIVE:4,SELECTED:8,CHECKED:16,FOCUSED:32,OPENED:64},goog.ui.Component.getStateTransitionEvent=function(e,t){switch(e){case goog.ui.Component.State.DISABLED:return t?goog.ui.Component.EventType.DISABLE:goog.ui.Component.EventType.ENABLE;case goog.ui.Component.State.HOVER:return t?goog.ui.Component.EventType.HIGHLIGHT:goog.ui.Component.EventType.UNHIGHLIGHT;case goog.ui.Component.State.ACTIVE:return t?goog.ui.Component.EventType.ACTIVATE:goog.ui.Component.EventType.DEACTIVATE;case goog.ui.Component.State.SELECTED:return t?goog.ui.Component.EventType.SELECT:goog.ui.Component.EventType.UNSELECT;case goog.ui.Component.State.CHECKED:return t?goog.ui.Component.EventType.CHECK:goog.ui.Component.EventType.UNCHECK;case goog.ui.Component.State.FOCUSED:return t?goog.ui.Component.EventType.FOCUS:goog.ui.Component.EventType.BLUR;case goog.ui.Component.State.OPENED:return t?goog.ui.Component.EventType.OPEN:goog.ui.Component.EventType.CLOSE}throw Error(goog.ui.Component.Error.STATE_INVALID)},goog.ui.Component.setDefaultRightToLeft=function(e){goog.ui.Component.defaultRightToLeft_=e},goog.ui.Component.prototype.getId=function(){return this.id_||(this.id_=this.idGenerator_.getNextUniqueId())},goog.ui.Component.prototype.setId=function(e){this.parent_&&this.parent_.childIndex_&&(goog.object.remove(this.parent_.childIndex_,this.id_),goog.object.add(this.parent_.childIndex_,e,this)),this.id_=e},goog.ui.Component.prototype.getElement=function(){return this.element_},goog.ui.Component.prototype.getElementStrict=function(){var e=this.element_;return goog.asserts.assert(e,"Can not call getElementStrict before rendering/decorating."),e},goog.ui.Component.prototype.setElementInternal=function(e){this.element_=e},goog.ui.Component.prototype.getElementsByClass=function(e){return this.element_?this.dom_.getElementsByClass(e,this.element_):[]},goog.ui.Component.prototype.getElementByClass=function(e){return this.element_?this.dom_.getElementByClass(e,this.element_):null},goog.ui.Component.prototype.getRequiredElementByClass=function(e){var t=this.getElementByClass(e);return goog.asserts.assert(t,"Expected element in component with class: %s",e),t},goog.ui.Component.prototype.getHandler=function(){return this.googUiComponentHandler_||(this.googUiComponentHandler_=new goog.events.EventHandler(this)),goog.asserts.assert(this.googUiComponentHandler_)},goog.ui.Component.prototype.setParent=function(e){if(this==e)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);if(e&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=e)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=e,goog.ui.Component.superClass_.setParentEventTarget.call(this,e)},goog.ui.Component.prototype.getParent=function(){return this.parent_},goog.ui.Component.prototype.setParentEventTarget=function(e){if(this.parent_&&this.parent_!=e)throw Error(goog.ui.Component.Error.NOT_SUPPORTED);goog.ui.Component.superClass_.setParentEventTarget.call(this,e)},goog.ui.Component.prototype.getDomHelper=function(){return this.dom_},goog.ui.Component.prototype.isInDocument=function(){return this.inDocument_},goog.ui.Component.prototype.createDom=function(){this.element_=this.dom_.createElement("DIV")},goog.ui.Component.prototype.render=function(e){this.render_(e)},goog.ui.Component.prototype.renderBefore=function(e){this.render_(e.parentNode,e)},goog.ui.Component.prototype.render_=function(e,t){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.element_||this.createDom(),e?e.insertBefore(this.element_,t||null):this.dom_.getDocument().body.appendChild(this.element_),this.parent_&&!this.parent_.isInDocument()||this.enterDocument()},goog.ui.Component.prototype.decorate=function(e){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(!e||!this.canDecorate(e))throw Error(goog.ui.Component.Error.DECORATE_INVALID);this.wasDecorated_=!0;var t=goog.dom.getOwnerDocument(e);this.dom_&&this.dom_.getDocument()==t||(this.dom_=goog.dom.getDomHelper(e)),this.decorateInternal(e),goog.ui.Component.ALLOW_DETACHED_DECORATION&&!goog.dom.contains(t,e)||this.enterDocument()},goog.ui.Component.prototype.canDecorate=function(e){return!0},goog.ui.Component.prototype.wasDecorated=function(){return this.wasDecorated_},goog.ui.Component.prototype.decorateInternal=function(e){this.element_=e},goog.ui.Component.prototype.enterDocument=function(){this.inDocument_=!0,this.forEachChild(function(e){!e.isInDocument()&&e.getElement()&&e.enterDocument()})},goog.ui.Component.prototype.exitDocument=function(){this.forEachChild(function(e){e.isInDocument()&&e.exitDocument()}),this.googUiComponentHandler_&&this.googUiComponentHandler_.removeAll(),this.inDocument_=!1};goog.ui.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument(),this.googUiComponentHandler_&&(this.googUiComponentHandler_.dispose(),delete this.googUiComponentHandler_),this.forEachChild(function(e){e.dispose()}),!this.wasDecorated_&&this.element_&&goog.dom.removeNode(this.element_),this.parent_=this.model_=this.element_=this.childIndex_=this.children_=null,goog.ui.Component.superClass_.disposeInternal.call(this)},goog.ui.Component.prototype.makeId=function(e){return this.getId()+"."+e},goog.ui.Component.prototype.makeIds=function(e){var t,o={};for(t in e)o[t]=this.makeId(e[t]);return o},goog.ui.Component.prototype.getModel=function(){return this.model_},goog.ui.Component.prototype.setModel=function(e){this.model_=e},goog.ui.Component.prototype.getFragmentFromId=function(e){return e.substring(this.getId().length+1)},goog.ui.Component.prototype.getElementByFragment=function(e){if(!this.inDocument_)throw Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);return this.dom_.getElement(this.makeId(e))},goog.ui.Component.prototype.addChild=function(e,t){this.addChildAt(e,this.getChildCount(),t)},goog.ui.Component.prototype.addChildAt=function(e,t,o){if(goog.asserts.assert(!!e,"Provided element must not be null."),e.inDocument_&&(o||!this.inDocument_))throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(0>t||t>this.getChildCount())throw Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);this.childIndex_&&this.children_||(this.childIndex_={},this.children_=[]),e.getParent()==this?(goog.object.set(this.childIndex_,e.getId(),e),goog.array.remove(this.children_,e)):goog.object.add(this.childIndex_,e.getId(),e),e.setParent(this),goog.array.insertAt(this.children_,e,t),e.inDocument_&&this.inDocument_&&e.getParent()==this?(t=(o=this.getContentElement()).childNodes[t]||null)!=e.getElement()&&o.insertBefore(e.getElement(),t):o?(this.element_||this.createDom(),t=this.getChildAt(t+1),e.render_(this.getContentElement(),t?t.element_:null)):this.inDocument_&&!e.inDocument_&&e.element_&&e.element_.parentNode&&e.element_.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&e.enterDocument()},goog.ui.Component.prototype.getContentElement=function(){return this.element_},goog.ui.Component.prototype.isRightToLeft=function(){return null==this.rightToLeft_&&(this.rightToLeft_=goog.style.isRightToLeft(this.inDocument_?this.element_:this.dom_.getDocument().body)),this.rightToLeft_},goog.ui.Component.prototype.setRightToLeft=function(e){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.rightToLeft_=e},goog.ui.Component.prototype.hasChildren=function(){return!!this.children_&&0!=this.children_.length},goog.ui.Component.prototype.getChildCount=function(){return this.children_?this.children_.length:0},goog.ui.Component.prototype.getChildIds=function(){var e=[];return this.forEachChild(function(t){e.push(t.getId())}),e},goog.ui.Component.prototype.getChild=function(e){return this.childIndex_&&e&&goog.object.get(this.childIndex_,e)||null},goog.ui.Component.prototype.getChildAt=function(e){return this.children_&&this.children_[e]||null},goog.ui.Component.prototype.forEachChild=function(e,t){this.children_&&goog.array.forEach(this.children_,e,t)},goog.ui.Component.prototype.indexOfChild=function(e){return this.children_&&e?goog.array.indexOf(this.children_,e):-1},goog.ui.Component.prototype.removeChild=function(e,t){if(e){var o=goog.isString(e)?e:e.getId();e=this.getChild(o),o&&e&&(goog.object.remove(this.childIndex_,o),goog.array.remove(this.children_,e),t&&(e.exitDocument(),e.element_&&goog.dom.removeNode(e.element_)),e.setParent(null))}if(!e)throw Error(goog.ui.Component.Error.NOT_OUR_CHILD);return e},goog.ui.Component.prototype.removeChildAt=function(e,t){return this.removeChild(this.getChildAt(e),t)},goog.ui.Component.prototype.removeChildren=function(e){for(var t=[];this.hasChildren();)t.push(this.removeChildAt(0,e));return t},goog.a11y={},goog.a11y.aria={},goog.a11y.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENU_ITEM:"menuitem",MENU_ITEM_CHECKBOX:"menuitemcheckbox",MENU_ITEM_RADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",TAB_LIST:"tablist",TAB_PANEL:"tabpanel",TEXTBOX:"textbox",TEXTINFO:"textinfo",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"},goog.a11y.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",COLINDEX:"colindex",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",ROWINDEX:"rowindex",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"},goog.a11y.aria.AutoCompleteValues={INLINE:"inline",LIST:"list",BOTH:"both",NONE:"none"},goog.a11y.aria.DropEffectValues={COPY:"copy",MOVE:"move",LINK:"link",EXECUTE:"execute",POPUP:"popup",NONE:"none"},goog.a11y.aria.LivePriority={OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"},goog.a11y.aria.OrientationValues={VERTICAL:"vertical",HORIZONTAL:"horizontal"},goog.a11y.aria.RelevantValues={ADDITIONS:"additions",REMOVALS:"removals",TEXT:"text",ALL:"all"},goog.a11y.aria.SortValues={ASCENDING:"ascending",DESCENDING:"descending",NONE:"none",OTHER:"other"},goog.a11y.aria.CheckedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"},goog.a11y.aria.ExpandedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"},goog.a11y.aria.GrabbedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"},goog.a11y.aria.InvalidValues={FALSE:"false",TRUE:"true",GRAMMAR:"grammar",SPELLING:"spelling"},goog.a11y.aria.PressedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"},goog.a11y.aria.SelectedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"},goog.a11y.aria.datatables={},goog.a11y.aria.datatables.getDefaultValuesMap=function(){return goog.a11y.aria.DefaultStateValueMap_||(goog.a11y.aria.DefaultStateValueMap_=goog.object.create(goog.a11y.aria.State.ATOMIC,!1,goog.a11y.aria.State.AUTOCOMPLETE,"none",goog.a11y.aria.State.DROPEFFECT,"none",goog.a11y.aria.State.HASPOPUP,!1,goog.a11y.aria.State.LIVE,"off",goog.a11y.aria.State.MULTILINE,!1,goog.a11y.aria.State.MULTISELECTABLE,!1,goog.a11y.aria.State.ORIENTATION,"vertical",goog.a11y.aria.State.READONLY,!1,goog.a11y.aria.State.RELEVANT,"additions text",goog.a11y.aria.State.REQUIRED,!1,goog.a11y.aria.State.SORT,"none",goog.a11y.aria.State.BUSY,!1,goog.a11y.aria.State.DISABLED,!1,goog.a11y.aria.State.HIDDEN,!1,goog.a11y.aria.State.INVALID,"false")),goog.a11y.aria.DefaultStateValueMap_},goog.a11y.aria.ARIA_PREFIX_="aria-",goog.a11y.aria.ROLE_ATTRIBUTE_="role",goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_=goog.object.createSet("A AREA BUTTON HEAD INPUT LINK MENU META OPTGROUP OPTION PROGRESS STYLE SELECT SOURCE TEXTAREA TITLE TRACK".split(" ")),goog.a11y.aria.CONTAINER_ROLES_=[goog.a11y.aria.Role.COMBOBOX,goog.a11y.aria.Role.GRID,goog.a11y.aria.Role.GROUP,goog.a11y.aria.Role.LISTBOX,goog.a11y.aria.Role.MENU,goog.a11y.aria.Role.MENUBAR,goog.a11y.aria.Role.RADIOGROUP,goog.a11y.aria.Role.ROW,goog.a11y.aria.Role.ROWGROUP,goog.a11y.aria.Role.TAB_LIST,goog.a11y.aria.Role.TEXTBOX,goog.a11y.aria.Role.TOOLBAR,goog.a11y.aria.Role.TREE,goog.a11y.aria.Role.TREEGRID],goog.a11y.aria.setRole=function(e,t){t?(goog.asserts.ENABLE_ASSERTS&&goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.Role,t),"No such ARIA role "+t),e.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_,t)):goog.a11y.aria.removeRole(e)},goog.a11y.aria.getRole=function(e){return e.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)||null},goog.a11y.aria.removeRole=function(e){e.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)},goog.a11y.aria.setState=function(e,t,o){goog.isArray(o)&&(o=o.join(" "));var i=goog.a11y.aria.getAriaAttributeName_(t);""===o||void 0==o?t in(o=goog.a11y.aria.datatables.getDefaultValuesMap())?e.setAttribute(i,o[t]):e.removeAttribute(i):e.setAttribute(i,o)},goog.a11y.aria.toggleState=function(e,t){var o=goog.a11y.aria.getState(e,t);goog.string.isEmptyOrWhitespace(goog.string.makeSafe(o))||"true"==o||"false"==o?goog.a11y.aria.setState(e,t,"true"==o?"false":"true"):goog.a11y.aria.removeState(e,t)},goog.a11y.aria.removeState=function(e,t){e.removeAttribute(goog.a11y.aria.getAriaAttributeName_(t))},goog.a11y.aria.getState=function(e,t){var o=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(t));return null==o||void 0==o?"":String(o)},goog.a11y.aria.getActiveDescendant=function(e){var t=goog.a11y.aria.getState(e,goog.a11y.aria.State.ACTIVEDESCENDANT);return goog.dom.getOwnerDocument(e).getElementById(t)},goog.a11y.aria.setActiveDescendant=function(e,t){var o="";t&&(o=t.id,goog.asserts.assert(o,"The active element should have an id.")),goog.a11y.aria.setState(e,goog.a11y.aria.State.ACTIVEDESCENDANT,o)},goog.a11y.aria.getLabel=function(e){return goog.a11y.aria.getState(e,goog.a11y.aria.State.LABEL)},goog.a11y.aria.setLabel=function(e,t){goog.a11y.aria.setState(e,goog.a11y.aria.State.LABEL,t)},goog.a11y.aria.assertRoleIsSetInternalUtil=function(e,t){if(!goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_[e.tagName]){var o=goog.a11y.aria.getRole(e);goog.asserts.assert(null!=o,"The element ARIA role cannot be null."),goog.asserts.assert(goog.array.contains(t,o),'Non existing or incorrect role set for element.The role set is "'+o+'". The role should be any of "'+t+'". Check the ARIA specification for more details http://www.w3.org/TR/wai-aria/roles.')}},goog.a11y.aria.getStateBoolean=function(e,t){var o=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(t));return goog.asserts.assert(goog.isBoolean(o)||null==o||"true"==o||"false"==o),null==o?o:goog.isBoolean(o)?o:"true"==o},goog.a11y.aria.getStateNumber=function(e,t){var o=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(t));return goog.asserts.assert(!(null!=o&&isNaN(Number(o))||goog.isBoolean(o))),null==o?null:Number(o)},goog.a11y.aria.getStateString=function(e,t){var o=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(t));return goog.asserts.assert((null==o||goog.isString(o))&&(""==o||isNaN(Number(o)))&&"true"!=o&&"false"!=o),null==o||""==o?null:o},goog.a11y.aria.getStringArrayStateInternalUtil=function(e,t){var o=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(t));return goog.a11y.aria.splitStringOnWhitespace_(o)},goog.a11y.aria.hasState=function(e,t){return e.hasAttribute(goog.a11y.aria.getAriaAttributeName_(t))},goog.a11y.aria.isContainerRole=function(e){return e=goog.a11y.aria.getRole(e),goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_,e)},goog.a11y.aria.splitStringOnWhitespace_=function(e){return e?e.split(/\s+/):[]},goog.a11y.aria.getAriaAttributeName_=function(e){return goog.asserts.ENABLE_ASSERTS&&(goog.asserts.assert(e,"ARIA attribute cannot be empty."),goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.State,e),"No such ARIA attribute "+e)),goog.a11y.aria.ARIA_PREFIX_+e},goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},goog.events.KeyCodes.isTextModifyingKeyEvent=function(e){if(e.altKey&&!e.ctrlKey||e.metaKey||e.keyCode>=goog.events.KeyCodes.F1&&e.keyCode<=goog.events.KeyCodes.F12)return!1;switch(e.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return!1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;default:return e.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||e.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}},goog.events.KeyCodes.firesKeyPressEvent=function(e,t,o,i,n,r){if(!(goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525")))return!0;if(goog.userAgent.MAC&&n)return goog.events.KeyCodes.isCharacterKey(e);if(n&&!i)return!1;if(goog.isNumber(t)&&(t=goog.events.KeyCodes.normalizeKeyCode(t)),n=t==goog.events.KeyCodes.CTRL||t==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&t==goog.events.KeyCodes.META,r=t==goog.events.KeyCodes.SHIFT&&(i||r),(!o||goog.userAgent.MAC)&&n||goog.userAgent.MAC&&r)return!1;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&i&&o)switch(e){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return!1}if(goog.userAgent.IE&&i&&t==e)return!1;switch(e){case goog.events.KeyCodes.ENTER:return!0;case goog.events.KeyCodes.ESC:return!(goog.userAgent.WEBKIT||goog.userAgent.EDGE)}return goog.events.KeyCodes.isCharacterKey(e)},goog.events.KeyCodes.isCharacterKey=function(e){if(e>=goog.events.KeyCodes.ZERO&&e<=goog.events.KeyCodes.NINE||e>=goog.events.KeyCodes.NUM_ZERO&&e<=goog.events.KeyCodes.NUM_MULTIPLY||e>=goog.events.KeyCodes.A&&e<=goog.events.KeyCodes.Z||(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&0==e)return!0;switch(e){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return!0;default:return!1}},goog.events.KeyCodes.normalizeKeyCode=function(e){return goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(e):goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.KeyCodes.normalizeMacWebKitKeyCode(e):e},goog.events.KeyCodes.normalizeGeckoKeyCode=function(e){switch(e){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return e}},goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(e){switch(e){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return e}},goog.events.KeyHandler=function(e,t){goog.events.EventTarget.call(this),e&&this.attach(e,t)},goog.inherits(goog.events.KeyHandler,goog.events.EventTarget),goog.events.KeyHandler.prototype.element_=null,goog.events.KeyHandler.prototype.keyPressKey_=null,goog.events.KeyHandler.prototype.keyDownKey_=null,goog.events.KeyHandler.prototype.keyUpKey_=null,goog.events.KeyHandler.prototype.lastKey_=-1,goog.events.KeyHandler.prototype.keyCode_=-1,goog.events.KeyHandler.prototype.altKey_=!1,goog.events.KeyHandler.EventType={KEY:"key"},goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT},goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT},goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525"),goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO,goog.events.KeyHandler.prototype.handleKeyDown_=function(e){(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&(this.lastKey_==goog.events.KeyCodes.CTRL&&!e.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!e.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!e.metaKey)&&this.resetState(),-1==this.lastKey_&&(e.ctrlKey&&e.keyCode!=goog.events.KeyCodes.CTRL?this.lastKey_=goog.events.KeyCodes.CTRL:e.altKey&&e.keyCode!=goog.events.KeyCodes.ALT?this.lastKey_=goog.events.KeyCodes.ALT:e.metaKey&&e.keyCode!=goog.events.KeyCodes.META&&(this.lastKey_=goog.events.KeyCodes.META)),goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(e.keyCode,this.lastKey_,e.shiftKey,e.ctrlKey,e.altKey,e.metaKey)?this.handleEvent(e):(this.keyCode_=goog.events.KeyCodes.normalizeKeyCode(e.keyCode),goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(this.altKey_=e.altKey))},goog.events.KeyHandler.prototype.resetState=function(){this.keyCode_=this.lastKey_=-1},goog.events.KeyHandler.prototype.handleKeyup_=function(e){this.resetState(),this.altKey_=e.altKey},goog.events.KeyHandler.prototype.handleEvent=function(e){var t=e.getBrowserEvent(),o=t.altKey;if(goog.userAgent.IE&&e.type==goog.events.EventType.KEYPRESS)var i=this.keyCode_,n=i!=goog.events.KeyCodes.ENTER&&i!=goog.events.KeyCodes.ESC?t.keyCode:0;else(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&e.type==goog.events.EventType.KEYPRESS?(i=this.keyCode_,n=0<=t.charCode&&63232>t.charCode&&goog.events.KeyCodes.isCharacterKey(i)?t.charCode:0):goog.userAgent.OPERA&&!goog.userAgent.WEBKIT?(i=this.keyCode_,n=goog.events.KeyCodes.isCharacterKey(i)?t.keyCode:0):(i=t.keyCode||this.keyCode_,n=t.charCode||0,goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(o=this.altKey_),goog.userAgent.MAC&&n==goog.events.KeyCodes.QUESTION_MARK&&i==goog.events.KeyCodes.WIN_KEY&&(i=goog.events.KeyCodes.SLASH));var r=i=goog.events.KeyCodes.normalizeKeyCode(i);i?63232<=i&&i in goog.events.KeyHandler.safariKey_?r=goog.events.KeyHandler.safariKey_[i]:25==i&&e.shiftKey&&(r=9):t.keyIdentifier&&t.keyIdentifier in goog.events.KeyHandler.keyIdentifier_&&(r=goog.events.KeyHandler.keyIdentifier_[t.keyIdentifier]),e=r==this.lastKey_,this.lastKey_=r,(t=new goog.events.KeyEvent(r,n,e,t)).altKey=o,this.dispatchEvent(t)},goog.events.KeyHandler.prototype.getElement=function(){return this.element_},goog.events.KeyHandler.prototype.attach=function(e,t){this.keyUpKey_&&this.detach(),this.element_=e,this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,t),this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,t,this),this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,t,this)},goog.events.KeyHandler.prototype.detach=function(){this.keyPressKey_&&(goog.events.unlistenByKey(this.keyPressKey_),goog.events.unlistenByKey(this.keyDownKey_),goog.events.unlistenByKey(this.keyUpKey_),this.keyUpKey_=this.keyDownKey_=this.keyPressKey_=null),this.element_=null,this.keyCode_=this.lastKey_=-1},goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this),this.detach()},goog.events.KeyEvent=function(e,t,o,i){goog.events.BrowserEvent.call(this,i),this.type=goog.events.KeyHandler.EventType.KEY,this.keyCode=e,this.charCode=t,this.repeat=o},goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent),goog.dom.classlist={},goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST=!1,goog.dom.classlist.get=function(e){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList?e.classList:(e=e.className,goog.isString(e)&&e.match(/\S+/g)||[])},goog.dom.classlist.set=function(e,t){e.className=t},goog.dom.classlist.contains=function(e,t){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList?e.classList.contains(t):goog.array.contains(goog.dom.classlist.get(e),t)},goog.dom.classlist.add=function(e,t){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList?e.classList.add(t):goog.dom.classlist.contains(e,t)||(e.className+=0<e.className.length?" "+t:t)},goog.dom.classlist.addAll=function(e,t){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList)goog.array.forEach(t,function(t){goog.dom.classlist.add(e,t)});else{var o={};for(var i in goog.array.forEach(goog.dom.classlist.get(e),function(e){o[e]=!0}),goog.array.forEach(t,function(e){o[e]=!0}),e.className="",o)e.className+=0<e.className.length?" "+i:i}},goog.dom.classlist.remove=function(e,t){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList?e.classList.remove(t):goog.dom.classlist.contains(e,t)&&(e.className=goog.array.filter(goog.dom.classlist.get(e),function(e){return e!=t}).join(" "))},goog.dom.classlist.removeAll=function(e,t){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList?goog.array.forEach(t,function(t){goog.dom.classlist.remove(e,t)}):e.className=goog.array.filter(goog.dom.classlist.get(e),function(e){return!goog.array.contains(t,e)}).join(" ")},goog.dom.classlist.enable=function(e,t,o){o?goog.dom.classlist.add(e,t):goog.dom.classlist.remove(e,t)},goog.dom.classlist.enableAll=function(e,t,o){(o?goog.dom.classlist.addAll:goog.dom.classlist.removeAll)(e,t)},goog.dom.classlist.swap=function(e,t,o){return!!goog.dom.classlist.contains(e,t)&&(goog.dom.classlist.remove(e,t),goog.dom.classlist.add(e,o),!0)},goog.dom.classlist.toggle=function(e,t){var o=!goog.dom.classlist.contains(e,t);return goog.dom.classlist.enable(e,t,o),o},goog.dom.classlist.addRemove=function(e,t,o){goog.dom.classlist.remove(e,t),goog.dom.classlist.add(e,o)},goog.ui.registry={},goog.ui.registry.getDefaultRenderer=function(e){for(var t;e&&(t=goog.getUid(e),!(t=goog.ui.registry.defaultRenderers_[t]));)e=e.superClass_?e.superClass_.constructor:null;return t?goog.isFunction(t.getInstance)?t.getInstance():new t:null},goog.ui.registry.setDefaultRenderer=function(e,t){if(!goog.isFunction(e))throw Error("Invalid component class "+e);if(!goog.isFunction(t))throw Error("Invalid renderer class "+t);var o=goog.getUid(e);goog.ui.registry.defaultRenderers_[o]=t},goog.ui.registry.getDecoratorByClassName=function(e){return e in goog.ui.registry.decoratorFunctions_?goog.ui.registry.decoratorFunctions_[e]():null},goog.ui.registry.setDecoratorByClassName=function(e,t){if(!e)throw Error("Invalid class name "+e);if(!goog.isFunction(t))throw Error("Invalid decorator function "+t);goog.ui.registry.decoratorFunctions_[e]=t},goog.ui.registry.getDecorator=function(e){goog.asserts.assert(e);for(var t=goog.dom.classlist.get(e),o=0,i=t.length;o<i;o++)if(e=goog.ui.registry.getDecoratorByClassName(t[o]))return e;return null},goog.ui.registry.reset=function(){goog.ui.registry.defaultRenderers_={},goog.ui.registry.decoratorFunctions_={}},goog.ui.registry.defaultRenderers_={},goog.ui.registry.decoratorFunctions_={},goog.ui.ContainerRenderer=function(e){this.ariaRole_=e},goog.addSingletonGetter(goog.ui.ContainerRenderer),goog.ui.ContainerRenderer.getCustomRenderer=function(e,t){var o=new e;return o.getCssClass=function(){return t},o},goog.ui.ContainerRenderer.CSS_CLASS="goog-container",goog.ui.ContainerRenderer.prototype.getAriaRole=function(){return this.ariaRole_},goog.ui.ContainerRenderer.prototype.enableTabIndex=function(e,t){e&&(e.tabIndex=t?0:-1)},goog.ui.ContainerRenderer.prototype.createDom=function(e){return e.getDomHelper().createDom("DIV",this.getClassNames(e).join(" "))},goog.ui.ContainerRenderer.prototype.getContentElement=function(e){return e},goog.ui.ContainerRenderer.prototype.canDecorate=function(e){return"DIV"==e.tagName},goog.ui.ContainerRenderer.prototype.decorate=function(e,t){t.id&&e.setId(t.id);var o=this.getCssClass(),i=!1,n=goog.dom.classlist.get(t);return n&&goog.array.forEach(n,function(t){t==o?i=!0:t&&this.setStateFromClassName(e,t,o)},this),i||goog.dom.classlist.add(t,o),this.decorateChildren(e,this.getContentElement(t)),t},goog.ui.ContainerRenderer.prototype.setStateFromClassName=function(e,t,o){t==o+"-disabled"?e.setEnabled(!1):t==o+"-horizontal"?e.setOrientation(goog.ui.Container.Orientation.HORIZONTAL):t==o+"-vertical"&&e.setOrientation(goog.ui.Container.Orientation.VERTICAL)},goog.ui.ContainerRenderer.prototype.decorateChildren=function(e,t,o){if(t){o=o||t.firstChild;for(var i;o&&o.parentNode==t;){if(i=o.nextSibling,o.nodeType==goog.dom.NodeType.ELEMENT){var n=this.getDecoratorForChild(o);n&&(n.setElementInternal(o),e.isEnabled()||n.setEnabled(!1),e.addChild(n),n.decorate(o))}else o.nodeValue&&""!=goog.string.trim(o.nodeValue)||t.removeChild(o);o=i}}},goog.ui.ContainerRenderer.prototype.getDecoratorForChild=function(e){return goog.ui.registry.getDecorator(e)},goog.ui.ContainerRenderer.prototype.initializeDom=function(e){e=e.getElement(),goog.asserts.assert(e,"The container DOM element cannot be null."),goog.style.setUnselectable(e,!0,goog.userAgent.GECKO),goog.userAgent.IE&&(e.hideFocus=!0);var t=this.getAriaRole();t&&goog.a11y.aria.setRole(e,t)},goog.ui.ContainerRenderer.prototype.getKeyEventTarget=function(e){return e.getElement()},goog.ui.ContainerRenderer.prototype.getCssClass=function(){return goog.ui.ContainerRenderer.CSS_CLASS},goog.ui.ContainerRenderer.prototype.getClassNames=function(e){var t=this.getCssClass(),o=e.getOrientation()==goog.ui.Container.Orientation.HORIZONTAL;return o=[t,o?t+"-horizontal":t+"-vertical"],e.isEnabled()||o.push(t+"-disabled"),o},goog.ui.ContainerRenderer.prototype.getDefaultOrientation=function(){return goog.ui.Container.Orientation.VERTICAL},goog.ui.ControlRenderer=function(){},goog.addSingletonGetter(goog.ui.ControlRenderer),goog.tagUnsealableClass(goog.ui.ControlRenderer),goog.ui.ControlRenderer.getCustomRenderer=function(e,t){var o=new e;return o.getCssClass=function(){return t},o},goog.ui.ControlRenderer.CSS_CLASS="goog-control",goog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS=[],goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_=goog.object.create(goog.a11y.aria.Role.BUTTON,goog.a11y.aria.State.PRESSED,goog.a11y.aria.Role.CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.MENU_ITEM_CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM_RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.TAB,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.TREEITEM,goog.a11y.aria.State.SELECTED),goog.ui.ControlRenderer.prototype.getAriaRole=function(){},goog.ui.ControlRenderer.prototype.createDom=function(e){return e.getDomHelper().createDom("DIV",this.getClassNames(e).join(" "),e.getContent())},goog.ui.ControlRenderer.prototype.getContentElement=function(e){return e},goog.ui.ControlRenderer.prototype.enableClassName=function(e,t,o){if(e=e.getElement?e.getElement():e){var i=[t];goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&(i=this.getAppliedCombinedClassNames_(goog.dom.classlist.get(e),t)).push(t),goog.dom.classlist.enableAll(e,i,o)}},goog.ui.ControlRenderer.prototype.enableExtraClassName=function(e,t,o){this.enableClassName(e,t,o)},goog.ui.ControlRenderer.prototype.canDecorate=function(e){return!0},goog.ui.ControlRenderer.prototype.decorate=function(e,t){t.id&&e.setId(t.id);var o=this.getContentElement(t);o&&o.firstChild?e.setContentInternal(o.firstChild.nextSibling?goog.array.clone(o.childNodes):o.firstChild):e.setContentInternal(null);var i=0,n=this.getCssClass(),r=this.getStructuralCssClass(),s=!1,a=!1,l=!1,c=goog.array.toArray(goog.dom.classlist.get(t));goog.array.forEach(c,function(e){s||e!=n?a||e!=r?i|=this.getStateFromClass(e):a=!0:(s=!0,r==n&&(a=!0)),this.getStateFromClass(e)==goog.ui.Component.State.DISABLED&&(goog.asserts.assertElement(o),goog.dom.isFocusableTabIndex(o)&&goog.dom.setFocusableTabIndex(o,!1))},this),e.setStateInternal(i),s||(c.push(n),r==n&&(a=!0)),a||c.push(r);var u=e.getExtraClassNames();if(u&&c.push.apply(c,u),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){var h=this.getAppliedCombinedClassNames_(c);0<h.length&&(c.push.apply(c,h),l=!0)}return s&&a&&!u&&!l||goog.dom.classlist.set(t,c.join(" ")),t},goog.ui.ControlRenderer.prototype.initializeDom=function(e){e.isRightToLeft()&&this.setRightToLeft(e.getElement(),!0),e.isEnabled()&&this.setFocusable(e,e.isVisible())},goog.ui.ControlRenderer.prototype.setAriaRole=function(e,t){var o=t||this.getAriaRole();o&&(goog.asserts.assert(e,"The element passed as a first parameter cannot be null."),o!=goog.a11y.aria.getRole(e)&&goog.a11y.aria.setRole(e,o))},goog.ui.ControlRenderer.prototype.setAriaStates=function(e,t){goog.asserts.assert(e),goog.asserts.assert(t);var o=e.getAriaLabel();goog.isDefAndNotNull(o)&&this.setAriaLabel(t,o),e.isVisible()||goog.a11y.aria.setState(t,goog.a11y.aria.State.HIDDEN,!e.isVisible()),e.isEnabled()||this.updateAriaState(t,goog.ui.Component.State.DISABLED,!e.isEnabled()),e.isSupportedState(goog.ui.Component.State.SELECTED)&&this.updateAriaState(t,goog.ui.Component.State.SELECTED,e.isSelected()),e.isSupportedState(goog.ui.Component.State.CHECKED)&&this.updateAriaState(t,goog.ui.Component.State.CHECKED,e.isChecked()),e.isSupportedState(goog.ui.Component.State.OPENED)&&this.updateAriaState(t,goog.ui.Component.State.OPENED,e.isOpen())},goog.ui.ControlRenderer.prototype.setAriaLabel=function(e,t){goog.a11y.aria.setLabel(e,t)},goog.ui.ControlRenderer.prototype.setAllowTextSelection=function(e,t){goog.style.setUnselectable(e,!t,!goog.userAgent.IE&&!goog.userAgent.OPERA)},goog.ui.ControlRenderer.prototype.setRightToLeft=function(e,t){this.enableClassName(e,this.getStructuralCssClass()+"-rtl",t)},goog.ui.ControlRenderer.prototype.isFocusable=function(e){var t;return!(!e.isSupportedState(goog.ui.Component.State.FOCUSED)||!(t=e.getKeyEventTarget()))&&goog.dom.isFocusableTabIndex(t)},goog.ui.ControlRenderer.prototype.setFocusable=function(e,t){var o;if(e.isSupportedState(goog.ui.Component.State.FOCUSED)&&(o=e.getKeyEventTarget())){if(!t&&e.isFocused()){try{o.blur()}catch(e){}e.isFocused()&&e.handleBlur(null)}goog.dom.isFocusableTabIndex(o)!=t&&goog.dom.setFocusableTabIndex(o,t)}},goog.ui.ControlRenderer.prototype.setVisible=function(e,t){goog.style.setElementShown(e,t),e&&goog.a11y.aria.setState(e,goog.a11y.aria.State.HIDDEN,!t)},goog.ui.ControlRenderer.prototype.setState=function(e,t,o){var i=e.getElement();if(i){var n=this.getClassForState(t);n&&this.enableClassName(e,n,o),this.updateAriaState(i,t,o)}},goog.ui.ControlRenderer.prototype.updateAriaState=function(e,t,o){goog.ui.ControlRenderer.ariaAttributeMap_||(goog.ui.ControlRenderer.ariaAttributeMap_=goog.object.create(goog.ui.Component.State.DISABLED,goog.a11y.aria.State.DISABLED,goog.ui.Component.State.SELECTED,goog.a11y.aria.State.SELECTED,goog.ui.Component.State.CHECKED,goog.a11y.aria.State.CHECKED,goog.ui.Component.State.OPENED,goog.a11y.aria.State.EXPANDED)),goog.asserts.assert(e,"The element passed as a first parameter cannot be null."),(t=goog.ui.ControlRenderer.getAriaStateForAriaRole_(e,goog.ui.ControlRenderer.ariaAttributeMap_[t]))&&goog.a11y.aria.setState(e,t,o)},goog.ui.ControlRenderer.getAriaStateForAriaRole_=function(e,t){var o=goog.a11y.aria.getRole(e);return o?(o=goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[o]||t,goog.ui.ControlRenderer.isAriaState_(t)?o:t):t},goog.ui.ControlRenderer.isAriaState_=function(e){return e==goog.a11y.aria.State.CHECKED||e==goog.a11y.aria.State.SELECTED},goog.ui.ControlRenderer.prototype.setContent=function(e,t){var o=this.getContentElement(e);if(o&&(goog.dom.removeChildren(o),t))if(goog.isString(t))goog.dom.setTextContent(o,t);else{var i=function(e){if(e){var t=goog.dom.getOwnerDocument(o);o.appendChild(goog.isString(e)?t.createTextNode(e):e)}};goog.isArray(t)?goog.array.forEach(t,i):!goog.isArrayLike(t)||"nodeType"in t?i(t):goog.array.forEach(goog.array.clone(t),i)}},goog.ui.ControlRenderer.prototype.getKeyEventTarget=function(e){return e.getElement()},goog.ui.ControlRenderer.prototype.getCssClass=function(){return goog.ui.ControlRenderer.CSS_CLASS},goog.ui.ControlRenderer.prototype.getIe6ClassCombinations=function(){return[]},goog.ui.ControlRenderer.prototype.getStructuralCssClass=function(){return this.getCssClass()},goog.ui.ControlRenderer.prototype.getClassNames=function(e){var t=this.getCssClass(),o=[t],i=this.getStructuralCssClass();return i!=t&&o.push(i),t=this.getClassNamesForState(e.getState()),o.push.apply(o,t),(e=e.getExtraClassNames())&&o.push.apply(o,e),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&o.push.apply(o,this.getAppliedCombinedClassNames_(o)),o},goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_=function(e,t){var o=[];return t&&(e=goog.array.concat(e,[t])),goog.array.forEach(this.getIe6ClassCombinations(),function(i){!goog.array.every(i,goog.partial(goog.array.contains,e))||t&&!goog.array.contains(i,t)||o.push(i.join("_"))}),o},goog.ui.ControlRenderer.prototype.getClassNamesForState=function(e){for(var t=[];e;){var o=e&-e;t.push(this.getClassForState(o)),e&=~o}return t},goog.ui.ControlRenderer.prototype.getClassForState=function(e){return this.classByState_||this.createClassByStateMap_(),this.classByState_[e]},goog.ui.ControlRenderer.prototype.getStateFromClass=function(e){return this.stateByClass_||this.createStateByClassMap_(),e=parseInt(this.stateByClass_[e],10),isNaN(e)?0:e},goog.ui.ControlRenderer.prototype.createClassByStateMap_=function(){var e=this.getStructuralCssClass(),t=!goog.string.contains(goog.string.normalizeWhitespace(e)," ");goog.asserts.assert(t,"ControlRenderer has an invalid css class: '"+e+"'"),this.classByState_=goog.object.create(goog.ui.Component.State.DISABLED,e+"-disabled",goog.ui.Component.State.HOVER,e+"-hover",goog.ui.Component.State.ACTIVE,e+"-active",goog.ui.Component.State.SELECTED,e+"-selected",goog.ui.Component.State.CHECKED,e+"-checked",goog.ui.Component.State.FOCUSED,e+"-focused",goog.ui.Component.State.OPENED,e+"-open")},goog.ui.ControlRenderer.prototype.createStateByClassMap_=function(){this.classByState_||this.createClassByStateMap_(),this.stateByClass_=goog.object.transpose(this.classByState_)},goog.ui.Control=function(e,t,o){goog.ui.Component.call(this,o),this.renderer_=t||goog.ui.registry.getDefaultRenderer(this.constructor),this.setContentInternal(goog.isDef(e)?e:null),this.ariaLabel_=null},goog.inherits(goog.ui.Control,goog.ui.Component),goog.tagUnsealableClass(goog.ui.Control),goog.ui.Control.registerDecorator=goog.ui.registry.setDecoratorByClassName,goog.ui.Control.getDecorator=goog.ui.registry.getDecorator,goog.ui.Control.prototype.content_=null,goog.ui.Control.prototype.state_=0,goog.ui.Control.prototype.supportedStates_=goog.ui.Component.State.DISABLED|goog.ui.Component.State.HOVER|goog.ui.Component.State.ACTIVE|goog.ui.Component.State.FOCUSED,goog.ui.Control.prototype.autoStates_=goog.ui.Component.State.ALL,goog.ui.Control.prototype.statesWithTransitionEvents_=0,goog.ui.Control.prototype.visible_=!0,goog.ui.Control.prototype.extraClassNames_=null,goog.ui.Control.prototype.handleMouseEvents_=!0,goog.ui.Control.prototype.allowTextSelection_=!1,goog.ui.Control.prototype.preferredAriaRole_=null,goog.ui.Control.prototype.isHandleMouseEvents=function(){return this.handleMouseEvents_},goog.ui.Control.prototype.setHandleMouseEvents=function(e){this.isInDocument()&&e!=this.handleMouseEvents_&&this.enableMouseEventHandling_(e),this.handleMouseEvents_=e},goog.ui.Control.prototype.getKeyEventTarget=function(){return this.renderer_.getKeyEventTarget(this)},goog.ui.Control.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler)},goog.ui.Control.prototype.getRenderer=function(){return this.renderer_},goog.ui.Control.prototype.setRenderer=function(e){if(this.isInDocument())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.getElement()&&this.setElementInternal(null),this.renderer_=e},goog.ui.Control.prototype.getExtraClassNames=function(){return this.extraClassNames_},goog.ui.Control.prototype.addClassName=function(e){e&&(this.extraClassNames_?goog.array.contains(this.extraClassNames_,e)||this.extraClassNames_.push(e):this.extraClassNames_=[e],this.renderer_.enableExtraClassName(this,e,!0))},goog.ui.Control.prototype.removeClassName=function(e){e&&this.extraClassNames_&&goog.array.remove(this.extraClassNames_,e)&&(0==this.extraClassNames_.length&&(this.extraClassNames_=null),this.renderer_.enableExtraClassName(this,e,!1))},goog.ui.Control.prototype.enableClassName=function(e,t){t?this.addClassName(e):this.removeClassName(e)},goog.ui.Control.prototype.createDom=function(){var e=this.renderer_.createDom(this);this.setElementInternal(e),this.renderer_.setAriaRole(e,this.getPreferredAriaRole()),this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(e,!1),this.isVisible()||this.renderer_.setVisible(e,!1)},goog.ui.Control.prototype.getPreferredAriaRole=function(){return this.preferredAriaRole_},goog.ui.Control.prototype.setPreferredAriaRole=function(e){this.preferredAriaRole_=e},goog.ui.Control.prototype.getAriaLabel=function(){return this.ariaLabel_},goog.ui.Control.prototype.setAriaLabel=function(e){this.ariaLabel_=e;var t=this.getElement();t&&this.renderer_.setAriaLabel(t,e)},goog.ui.Control.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())},goog.ui.Control.prototype.canDecorate=function(e){return this.renderer_.canDecorate(e)},goog.ui.Control.prototype.decorateInternal=function(e){e=this.renderer_.decorate(this,e),this.setElementInternal(e),this.renderer_.setAriaRole(e,this.getPreferredAriaRole()),this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(e,!1),this.visible_="none"!=e.style.display},goog.ui.Control.prototype.enterDocument=function(){if(goog.ui.Control.superClass_.enterDocument.call(this),this.renderer_.setAriaStates(this,this.getElementStrict()),this.renderer_.initializeDom(this),this.supportedStates_&~goog.ui.Component.State.DISABLED&&(this.isHandleMouseEvents()&&this.enableMouseEventHandling_(!0),this.isSupportedState(goog.ui.Component.State.FOCUSED))){var e=this.getKeyEventTarget();if(e){var t=this.getKeyHandler();t.attach(e),this.getHandler().listen(t,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(e,goog.events.EventType.FOCUS,this.handleFocus).listen(e,goog.events.EventType.BLUR,this.handleBlur)}}},goog.ui.Control.prototype.enableMouseEventHandling_=function(e){var t=this.getHandler(),o=this.getElement();e?(t.listen(o,goog.events.EventType.MOUSEOVER,this.handleMouseOver).listen(o,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(o,goog.events.EventType.MOUSEUP,this.handleMouseUp).listen(o,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&t.listen(o,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||t.listen(o,goog.events.EventType.DBLCLICK,this.handleDblClick),this.ieMouseEventSequenceSimulator_||(this.ieMouseEventSequenceSimulator_=new goog.ui.Control.IeMouseEventSequenceSimulator_(this),this.registerDisposable(this.ieMouseEventSequenceSimulator_)))):(t.unlisten(o,goog.events.EventType.MOUSEOVER,this.handleMouseOver).unlisten(o,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).unlisten(o,goog.events.EventType.MOUSEUP,this.handleMouseUp).unlisten(o,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&t.unlisten(o,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||t.unlisten(o,goog.events.EventType.DBLCLICK,this.handleDblClick),goog.dispose(this.ieMouseEventSequenceSimulator_),this.ieMouseEventSequenceSimulator_=null))},goog.ui.Control.prototype.exitDocument=function(){goog.ui.Control.superClass_.exitDocument.call(this),this.keyHandler_&&this.keyHandler_.detach(),this.isVisible()&&this.isEnabled()&&this.renderer_.setFocusable(this,!1)},goog.ui.Control.prototype.disposeInternal=function(){goog.ui.Control.superClass_.disposeInternal.call(this),this.keyHandler_&&(this.keyHandler_.dispose(),delete this.keyHandler_),delete this.renderer_,this.ieMouseEventSequenceSimulator_=this.extraClassNames_=this.content_=null},goog.ui.Control.prototype.getContent=function(){return this.content_},goog.ui.Control.prototype.setContent=function(e){this.renderer_.setContent(this.getElement(),e),this.setContentInternal(e)},goog.ui.Control.prototype.setContentInternal=function(e){this.content_=e},goog.ui.Control.prototype.getCaption=function(){var e=this.getContent();return e?(e=goog.isString(e)?e:goog.isArray(e)?goog.array.map(e,goog.dom.getRawTextContent).join(""):goog.dom.getTextContent(e),goog.string.collapseBreakingSpaces(e)):""},goog.ui.Control.prototype.setCaption=function(e){this.setContent(e)},goog.ui.Control.prototype.setRightToLeft=function(e){goog.ui.Control.superClass_.setRightToLeft.call(this,e);var t=this.getElement();t&&this.renderer_.setRightToLeft(t,e)},goog.ui.Control.prototype.isAllowTextSelection=function(){return this.allowTextSelection_},goog.ui.Control.prototype.setAllowTextSelection=function(e){this.allowTextSelection_=e;var t=this.getElement();t&&this.renderer_.setAllowTextSelection(t,e)},goog.ui.Control.prototype.isVisible=function(){return this.visible_},goog.ui.Control.prototype.setVisible=function(e,t){if(t||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){var o=this.getElement();return o&&this.renderer_.setVisible(o,e),this.isEnabled()&&this.renderer_.setFocusable(this,e),this.visible_=e,!0}return!1},goog.ui.Control.prototype.isEnabled=function(){return!this.hasState(goog.ui.Component.State.DISABLED)},goog.ui.Control.prototype.isParentDisabled_=function(){var e=this.getParent();return!!e&&"function"==typeof e.isEnabled&&!e.isEnabled()},goog.ui.Control.prototype.setEnabled=function(e){!this.isParentDisabled_()&&this.isTransitionAllowed(goog.ui.Component.State.DISABLED,!e)&&(e||(this.setActive(!1),this.setHighlighted(!1)),this.isVisible()&&this.renderer_.setFocusable(this,e),this.setState(goog.ui.Component.State.DISABLED,!e,!0))},goog.ui.Control.prototype.isHighlighted=function(){return this.hasState(goog.ui.Component.State.HOVER)},goog.ui.Control.prototype.setHighlighted=function(e){this.isTransitionAllowed(goog.ui.Component.State.HOVER,e)&&this.setState(goog.ui.Component.State.HOVER,e)},goog.ui.Control.prototype.isActive=function(){return this.hasState(goog.ui.Component.State.ACTIVE)},goog.ui.Control.prototype.setActive=function(e){this.isTransitionAllowed(goog.ui.Component.State.ACTIVE,e)&&this.setState(goog.ui.Component.State.ACTIVE,e)},goog.ui.Control.prototype.isSelected=function(){return this.hasState(goog.ui.Component.State.SELECTED)},goog.ui.Control.prototype.setSelected=function(e){this.isTransitionAllowed(goog.ui.Component.State.SELECTED,e)&&this.setState(goog.ui.Component.State.SELECTED,e)},goog.ui.Control.prototype.isChecked=function(){return this.hasState(goog.ui.Component.State.CHECKED)},goog.ui.Control.prototype.setChecked=function(e){this.isTransitionAllowed(goog.ui.Component.State.CHECKED,e)&&this.setState(goog.ui.Component.State.CHECKED,e)},goog.ui.Control.prototype.isFocused=function(){return this.hasState(goog.ui.Component.State.FOCUSED)},goog.ui.Control.prototype.setFocused=function(e){this.isTransitionAllowed(goog.ui.Component.State.FOCUSED,e)&&this.setState(goog.ui.Component.State.FOCUSED,e)},goog.ui.Control.prototype.isOpen=function(){return this.hasState(goog.ui.Component.State.OPENED)},goog.ui.Control.prototype.setOpen=function(e){this.isTransitionAllowed(goog.ui.Component.State.OPENED,e)&&this.setState(goog.ui.Component.State.OPENED,e)},goog.ui.Control.prototype.getState=function(){return this.state_},goog.ui.Control.prototype.hasState=function(e){return!!(this.state_&e)},goog.ui.Control.prototype.setState=function(e,t,o){o||e!=goog.ui.Component.State.DISABLED?this.isSupportedState(e)&&t!=this.hasState(e)&&(this.renderer_.setState(this,e,t),this.state_=t?this.state_|e:this.state_&~e):this.setEnabled(!t)},goog.ui.Control.prototype.setStateInternal=function(e){this.state_=e},goog.ui.Control.prototype.isSupportedState=function(e){return!!(this.supportedStates_&e)},goog.ui.Control.prototype.setSupportedState=function(e,t){if(this.isInDocument()&&this.hasState(e)&&!t)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);!t&&this.hasState(e)&&this.setState(e,!1),this.supportedStates_=t?this.supportedStates_|e:this.supportedStates_&~e},goog.ui.Control.prototype.isAutoState=function(e){return!!(this.autoStates_&e)&&this.isSupportedState(e)},goog.ui.Control.prototype.setAutoStates=function(e,t){this.autoStates_=t?this.autoStates_|e:this.autoStates_&~e},goog.ui.Control.prototype.isDispatchTransitionEvents=function(e){return!!(this.statesWithTransitionEvents_&e)&&this.isSupportedState(e)},goog.ui.Control.prototype.setDispatchTransitionEvents=function(e,t){this.statesWithTransitionEvents_=t?this.statesWithTransitionEvents_|e:this.statesWithTransitionEvents_&~e},goog.ui.Control.prototype.isTransitionAllowed=function(e,t){return this.isSupportedState(e)&&this.hasState(e)!=t&&(!(this.statesWithTransitionEvents_&e)||this.dispatchEvent(goog.ui.Component.getStateTransitionEvent(e,t)))&&!this.isDisposed()},goog.ui.Control.prototype.handleMouseOver=function(e){!goog.ui.Control.isMouseEventWithinElement_(e,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.ENTER)&&this.isEnabled()&&this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0)},goog.ui.Control.prototype.handleMouseOut=function(e){!goog.ui.Control.isMouseEventWithinElement_(e,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.LEAVE)&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1),this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!1))},goog.ui.Control.prototype.handleContextMenu=goog.nullFunction,goog.ui.Control.isMouseEventWithinElement_=function(e,t){return!!e.relatedTarget&&goog.dom.contains(t,e.relatedTarget)},goog.ui.Control.prototype.handleMouseDown=function(e){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),e.isMouseActionButton()&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!0),this.renderer_&&this.renderer_.isFocusable(this)&&this.getKeyEventTarget().focus())),!this.isAllowTextSelection()&&e.isMouseActionButton()&&e.preventDefault()},goog.ui.Control.prototype.handleMouseUp=function(e){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),this.isActive()&&this.performActionInternal(e)&&this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1))},goog.ui.Control.prototype.handleDblClick=function(e){this.isEnabled()&&this.performActionInternal(e)},goog.ui.Control.prototype.performActionInternal=function(e){this.isAutoState(goog.ui.Component.State.CHECKED)&&this.setChecked(!this.isChecked()),this.isAutoState(goog.ui.Component.State.SELECTED)&&this.setSelected(!0),this.isAutoState(goog.ui.Component.State.OPENED)&&this.setOpen(!this.isOpen());var t=new goog.events.Event(goog.ui.Component.EventType.ACTION,this);return e&&(t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.platformModifierKey=e.platformModifierKey),this.dispatchEvent(t)},goog.ui.Control.prototype.handleFocus=function(e){this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!0)},goog.ui.Control.prototype.handleBlur=function(e){this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1),this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!1)},goog.ui.Control.prototype.handleKeyEvent=function(e){return!!(this.isVisible()&&this.isEnabled()&&this.handleKeyEventInternal(e))&&(e.preventDefault(),e.stopPropagation(),!0)},goog.ui.Control.prototype.handleKeyEventInternal=function(e){return e.keyCode==goog.events.KeyCodes.ENTER&&this.performActionInternal(e)},goog.ui.registry.setDefaultRenderer(goog.ui.Control,goog.ui.ControlRenderer),goog.ui.registry.setDecoratorByClassName(goog.ui.ControlRenderer.CSS_CLASS,function(){return new goog.ui.Control(null)}),goog.ui.Control.IeMouseEventSequenceSimulator_=function(e){goog.Disposable.call(this),this.control_=e,this.clickExpected_=!1,this.handler_=new goog.events.EventHandler(this),this.registerDisposable(this.handler_),e=this.control_.getElementStrict(),this.handler_.listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseDown_).listen(e,goog.events.EventType.MOUSEUP,this.handleMouseUp_).listen(e,goog.events.EventType.CLICK,this.handleClick_)},goog.inherits(goog.ui.Control.IeMouseEventSequenceSimulator_,goog.Disposable),goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_=!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_=function(){this.clickExpected_=!1},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_=function(){this.clickExpected_=!0},goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_=function(e,t){if(!goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_)return e.button=goog.events.BrowserEvent.MouseButton.LEFT,e.type=t,e;var o=document.createEvent("MouseEvents");return o.initMouseEvent(t,e.bubbles,e.cancelable,e.view||null,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,goog.events.BrowserEvent.MouseButton.LEFT,e.relatedTarget||null),o},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_=function(e){if(this.clickExpected_)this.clickExpected_=!1;else{var t=e.getBrowserEvent(),o=t.button,i=t.type,n=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(t,goog.events.EventType.MOUSEDOWN);this.control_.handleMouseDown(new goog.events.BrowserEvent(n,e.currentTarget)),n=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(t,goog.events.EventType.MOUSEUP),this.control_.handleMouseUp(new goog.events.BrowserEvent(n,e.currentTarget)),goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_||(t.button=o,t.type=i)}},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal=function(){this.control_=null,goog.ui.Control.IeMouseEventSequenceSimulator_.superClass_.disposeInternal.call(this)},goog.ui.Container=function(e,t,o){goog.ui.Component.call(this,o),this.renderer_=t||goog.ui.ContainerRenderer.getInstance(),this.orientation_=e||this.renderer_.getDefaultOrientation()},goog.inherits(goog.ui.Container,goog.ui.Component),goog.tagUnsealableClass(goog.ui.Container),goog.ui.Container.EventType={AFTER_SHOW:"aftershow",AFTER_HIDE:"afterhide"},goog.ui.Container.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"},goog.ui.Container.prototype.keyEventTarget_=null,goog.ui.Container.prototype.keyHandler_=null,goog.ui.Container.prototype.renderer_=null,goog.ui.Container.prototype.orientation_=null,goog.ui.Container.prototype.visible_=!0,goog.ui.Container.prototype.enabled_=!0,goog.ui.Container.prototype.focusable_=!0,goog.ui.Container.prototype.highlightedIndex_=-1,goog.ui.Container.prototype.openItem_=null,goog.ui.Container.prototype.mouseButtonPressed_=!1,goog.ui.Container.prototype.allowFocusableChildren_=!1,goog.ui.Container.prototype.openFollowsHighlight_=!0,goog.ui.Container.prototype.childElementIdMap_=null,goog.ui.Container.prototype.getKeyEventTarget=function(){return this.keyEventTarget_||this.renderer_.getKeyEventTarget(this)},goog.ui.Container.prototype.setKeyEventTarget=function(e){if(!this.focusable_)throw Error("Can't set key event target for container that doesn't support keyboard focus!");var t=this.getKeyEventTarget(),o=this.isInDocument();this.keyEventTarget_=e;var i=this.getKeyEventTarget();o&&(this.keyEventTarget_=t,this.enableFocusHandling_(!1),this.keyEventTarget_=e,this.getKeyHandler().attach(i),this.enableFocusHandling_(!0))},goog.ui.Container.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler(this.getKeyEventTarget()))},goog.ui.Container.prototype.getRenderer=function(){return this.renderer_},goog.ui.Container.prototype.setRenderer=function(e){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.renderer_=e},goog.ui.Container.prototype.createDom=function(){this.setElementInternal(this.renderer_.createDom(this))},goog.ui.Container.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())},goog.ui.Container.prototype.canDecorate=function(e){return this.renderer_.canDecorate(e)},goog.ui.Container.prototype.decorateInternal=function(e){this.setElementInternal(this.renderer_.decorate(this,e)),"none"==e.style.display&&(this.visible_=!1)},goog.ui.Container.prototype.enterDocument=function(){goog.ui.Container.superClass_.enterDocument.call(this),this.forEachChild(function(e){e.isInDocument()&&this.registerChildId_(e)},this);var e=this.getElement();this.renderer_.initializeDom(this),this.setVisible(this.visible_,!0),this.getHandler().listen(this,goog.ui.Component.EventType.ENTER,this.handleEnterItem).listen(this,goog.ui.Component.EventType.HIGHLIGHT,this.handleHighlightItem).listen(this,goog.ui.Component.EventType.UNHIGHLIGHT,this.handleUnHighlightItem).listen(this,goog.ui.Component.EventType.OPEN,this.handleOpenItem).listen(this,goog.ui.Component.EventType.CLOSE,this.handleCloseItem).listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(goog.dom.getOwnerDocument(e),goog.events.EventType.MOUSEUP,this.handleDocumentMouseUp).listen(e,[goog.events.EventType.MOUSEDOWN,goog.events.EventType.MOUSEUP,goog.events.EventType.MOUSEOVER,goog.events.EventType.MOUSEOUT,goog.events.EventType.CONTEXTMENU],this.handleChildMouseEvents),this.isFocusable()&&this.enableFocusHandling_(!0)},goog.ui.Container.prototype.enableFocusHandling_=function(e){var t=this.getHandler(),o=this.getKeyEventTarget();e?t.listen(o,goog.events.EventType.FOCUS,this.handleFocus).listen(o,goog.events.EventType.BLUR,this.handleBlur).listen(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent):t.unlisten(o,goog.events.EventType.FOCUS,this.handleFocus).unlisten(o,goog.events.EventType.BLUR,this.handleBlur).unlisten(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent)},goog.ui.Container.prototype.exitDocument=function(){this.setHighlightedIndex(-1),this.openItem_&&this.openItem_.setOpen(!1),this.mouseButtonPressed_=!1,goog.ui.Container.superClass_.exitDocument.call(this)},goog.ui.Container.prototype.disposeInternal=function(){goog.ui.Container.superClass_.disposeInternal.call(this),this.keyHandler_&&(this.keyHandler_.dispose(),this.keyHandler_=null),this.renderer_=this.openItem_=this.childElementIdMap_=this.keyEventTarget_=null},goog.ui.Container.prototype.handleEnterItem=function(e){return!0},goog.ui.Container.prototype.handleHighlightItem=function(e){var t=this.indexOfChild(e.target);if(-1<t&&t!=this.highlightedIndex_){var o=this.getHighlighted();o&&o.setHighlighted(!1),this.highlightedIndex_=t,o=this.getHighlighted(),this.isMouseButtonPressed()&&o.setActive(!0),this.openFollowsHighlight_&&this.openItem_&&o!=this.openItem_&&(o.isSupportedState(goog.ui.Component.State.OPENED)?o.setOpen(!0):this.openItem_.setOpen(!1))}t=this.getElement(),goog.asserts.assert(t,"The DOM element for the container cannot be null."),null!=e.target.getElement()&&goog.a11y.aria.setState(t,goog.a11y.aria.State.ACTIVEDESCENDANT,e.target.getElement().id)},goog.ui.Container.prototype.handleUnHighlightItem=function(e){e.target==this.getHighlighted()&&(this.highlightedIndex_=-1),e=this.getElement(),goog.asserts.assert(e,"The DOM element for the container cannot be null."),goog.a11y.aria.removeState(e,goog.a11y.aria.State.ACTIVEDESCENDANT)},goog.ui.Container.prototype.handleOpenItem=function(e){(e=e.target)&&e!=this.openItem_&&e.getParent()==this&&(this.openItem_&&this.openItem_.setOpen(!1),this.openItem_=e)},goog.ui.Container.prototype.handleCloseItem=function(e){e.target==this.openItem_&&(this.openItem_=null);var t=this.getElement(),o=e.target.getElement();t&&e.target.isHighlighted()&&o&&goog.a11y.aria.setActiveDescendant(t,o)},goog.ui.Container.prototype.handleMouseDown=function(e){this.enabled_&&this.setMouseButtonPressed(!0);var t=this.getKeyEventTarget();t&&goog.dom.isFocusableTabIndex(t)?t.focus():e.preventDefault()},goog.ui.Container.prototype.handleDocumentMouseUp=function(e){this.setMouseButtonPressed(!1)},goog.ui.Container.prototype.handleChildMouseEvents=function(e){var t=this.getOwnerControl(e.target);if(t)switch(e.type){case goog.events.EventType.MOUSEDOWN:t.handleMouseDown(e);break;case goog.events.EventType.MOUSEUP:t.handleMouseUp(e);break;case goog.events.EventType.MOUSEOVER:t.handleMouseOver(e);break;case goog.events.EventType.MOUSEOUT:t.handleMouseOut(e);break;case goog.events.EventType.CONTEXTMENU:t.handleContextMenu(e)}},goog.ui.Container.prototype.getOwnerControl=function(e){if(this.childElementIdMap_)for(var t=this.getElement();e&&e!==t;){var o=e.id;if(o in this.childElementIdMap_)return this.childElementIdMap_[o];e=e.parentNode}return null},goog.ui.Container.prototype.handleFocus=function(e){},goog.ui.Container.prototype.handleBlur=function(e){this.setHighlightedIndex(-1),this.setMouseButtonPressed(!1),this.openItem_&&this.openItem_.setOpen(!1)},goog.ui.Container.prototype.handleKeyEvent=function(e){return!(!this.isEnabled()||!this.isVisible()||0==this.getChildCount()&&!this.keyEventTarget_||!this.handleKeyEventInternal(e))&&(e.preventDefault(),e.stopPropagation(),!0)},goog.ui.Container.prototype.handleKeyEventInternal=function(e){var t=this.getHighlighted();if(t&&"function"==typeof t.handleKeyEvent&&t.handleKeyEvent(e)||this.openItem_&&this.openItem_!=t&&"function"==typeof this.openItem_.handleKeyEvent&&this.openItem_.handleKeyEvent(e))return!0;if(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)return!1;switch(e.keyCode){case goog.events.KeyCodes.ESC:if(!this.isFocusable())return!1;this.getKeyEventTarget().blur();break;case goog.events.KeyCodes.HOME:this.highlightFirst();break;case goog.events.KeyCodes.END:this.highlightLast();break;case goog.events.KeyCodes.UP:if(this.orientation_!=goog.ui.Container.Orientation.VERTICAL)return!1;this.highlightPrevious();break;case goog.events.KeyCodes.LEFT:if(this.orientation_!=goog.ui.Container.Orientation.HORIZONTAL)return!1;this.isRightToLeft()?this.highlightNext():this.highlightPrevious();break;case goog.events.KeyCodes.DOWN:if(this.orientation_!=goog.ui.Container.Orientation.VERTICAL)return!1;this.highlightNext();break;case goog.events.KeyCodes.RIGHT:if(this.orientation_!=goog.ui.Container.Orientation.HORIZONTAL)return!1;this.isRightToLeft()?this.highlightPrevious():this.highlightNext();break;default:return!1}return!0},goog.ui.Container.prototype.registerChildId_=function(e){var t=e.getElement();t=t.id||(t.id=e.getId()),this.childElementIdMap_||(this.childElementIdMap_={}),this.childElementIdMap_[t]=e},goog.ui.Container.prototype.addChild=function(e,t){goog.asserts.assertInstanceof(e,goog.ui.Control,"The child of a container must be a control"),goog.ui.Container.superClass_.addChild.call(this,e,t)},goog.ui.Container.prototype.addChildAt=function(e,t,o){goog.asserts.assertInstanceof(e,goog.ui.Control),e.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0),e.setDispatchTransitionEvents(goog.ui.Component.State.OPENED,!0),!this.isFocusable()&&this.isFocusableChildrenAllowed()||e.setSupportedState(goog.ui.Component.State.FOCUSED,!1),e.setHandleMouseEvents(!1);var i=e.getParent()==this?this.indexOfChild(e):-1;goog.ui.Container.superClass_.addChildAt.call(this,e,t,o),e.isInDocument()&&this.isInDocument()&&this.registerChildId_(e),this.updateHighlightedIndex_(i,t)},goog.ui.Container.prototype.updateHighlightedIndex_=function(e,t){-1==e&&(e=this.getChildCount()),e==this.highlightedIndex_?this.highlightedIndex_=Math.min(this.getChildCount()-1,t):e>this.highlightedIndex_&&t<=this.highlightedIndex_?this.highlightedIndex_++:e<this.highlightedIndex_&&t>this.highlightedIndex_&&this.highlightedIndex_--},goog.ui.Container.prototype.removeChild=function(e,t){if(e=goog.isString(e)?this.getChild(e):e,goog.asserts.assertInstanceof(e,goog.ui.Control),e){var o=this.indexOfChild(e);-1!=o&&(o==this.highlightedIndex_?(e.setHighlighted(!1),this.highlightedIndex_=-1):o<this.highlightedIndex_&&this.highlightedIndex_--),(o=e.getElement())&&o.id&&this.childElementIdMap_&&goog.object.remove(this.childElementIdMap_,o.id)}return(e=goog.ui.Container.superClass_.removeChild.call(this,e,t)).setHandleMouseEvents(!0),e},goog.ui.Container.prototype.getOrientation=function(){return this.orientation_},goog.ui.Container.prototype.setOrientation=function(e){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.orientation_=e},goog.ui.Container.prototype.isVisible=function(){return this.visible_},goog.ui.Container.prototype.setVisible=function(e,t){if(t||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){this.visible_=e;var o=this.getElement();return o&&(goog.style.setElementShown(o,e),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),this.enabled_&&this.visible_),t||this.dispatchEvent(this.visible_?goog.ui.Container.EventType.AFTER_SHOW:goog.ui.Container.EventType.AFTER_HIDE)),!0}return!1},goog.ui.Container.prototype.isEnabled=function(){return this.enabled_},goog.ui.Container.prototype.setEnabled=function(e){this.enabled_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.ENABLE:goog.ui.Component.EventType.DISABLE)&&(e?(this.enabled_=!0,this.forEachChild(function(e){e.wasDisabled?delete e.wasDisabled:e.setEnabled(!0)})):(this.forEachChild(function(e){e.isEnabled()?e.setEnabled(!1):e.wasDisabled=!0}),this.enabled_=!1,this.setMouseButtonPressed(!1)),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),e&&this.visible_))},goog.ui.Container.prototype.isFocusable=function(){return this.focusable_},goog.ui.Container.prototype.setFocusable=function(e){e!=this.focusable_&&this.isInDocument()&&this.enableFocusHandling_(e),this.focusable_=e,this.enabled_&&this.visible_&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),e)},goog.ui.Container.prototype.isFocusableChildrenAllowed=function(){return this.allowFocusableChildren_},goog.ui.Container.prototype.setFocusableChildrenAllowed=function(e){this.allowFocusableChildren_=e},goog.ui.Container.prototype.isOpenFollowsHighlight=function(){return this.openFollowsHighlight_},goog.ui.Container.prototype.setOpenFollowsHighlight=function(e){this.openFollowsHighlight_=e},goog.ui.Container.prototype.getHighlightedIndex=function(){return this.highlightedIndex_},goog.ui.Container.prototype.setHighlightedIndex=function(e){(e=this.getChildAt(e))?e.setHighlighted(!0):-1<this.highlightedIndex_&&this.getHighlighted().setHighlighted(!1)},goog.ui.Container.prototype.setHighlighted=function(e){this.setHighlightedIndex(this.indexOfChild(e))},goog.ui.Container.prototype.getHighlighted=function(){return this.getChildAt(this.highlightedIndex_)},goog.ui.Container.prototype.highlightFirst=function(){this.highlightHelper(function(e,t){return(e+1)%t},this.getChildCount()-1)},goog.ui.Container.prototype.highlightLast=function(){this.highlightHelper(function(e,t){return 0>--e?t-1:e},0)},goog.ui.Container.prototype.highlightNext=function(){this.highlightHelper(function(e,t){return(e+1)%t},this.highlightedIndex_)},goog.ui.Container.prototype.highlightPrevious=function(){this.highlightHelper(function(e,t){return 0>--e?t-1:e},this.highlightedIndex_)},goog.ui.Container.prototype.highlightHelper=function(e,t){var o=0>t?this.indexOfChild(this.openItem_):t,i=this.getChildCount();o=e.call(this,o,i);for(var n=0;n<=i;){var r=this.getChildAt(o);if(r&&this.canHighlightItem(r))return this.setHighlightedIndexFromKeyEvent(o),!0;n++,o=e.call(this,o,i)}return!1},goog.ui.Container.prototype.canHighlightItem=function(e){return e.isVisible()&&e.isEnabled()&&e.isSupportedState(goog.ui.Component.State.HOVER)},goog.ui.Container.prototype.setHighlightedIndexFromKeyEvent=function(e){this.setHighlightedIndex(e)},goog.ui.Container.prototype.getOpenItem=function(){return this.openItem_},goog.ui.Container.prototype.isMouseButtonPressed=function(){return this.mouseButtonPressed_},goog.ui.Container.prototype.setMouseButtonPressed=function(e){this.mouseButtonPressed_=e},goog.ui.MenuHeaderRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.MenuHeaderRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuHeaderRenderer),goog.ui.MenuHeaderRenderer.CSS_CLASS="goog-menuheader",goog.ui.MenuHeaderRenderer.prototype.getCssClass=function(){return goog.ui.MenuHeaderRenderer.CSS_CLASS},goog.ui.MenuHeader=function(e,t,o){goog.ui.Control.call(this,e,o||goog.ui.MenuHeaderRenderer.getInstance(),t),this.setSupportedState(goog.ui.Component.State.DISABLED,!1),this.setSupportedState(goog.ui.Component.State.HOVER,!1),this.setSupportedState(goog.ui.Component.State.ACTIVE,!1),this.setSupportedState(goog.ui.Component.State.FOCUSED,!1),this.setStateInternal(goog.ui.Component.State.DISABLED)},goog.inherits(goog.ui.MenuHeader,goog.ui.Control),goog.ui.registry.setDecoratorByClassName(goog.ui.MenuHeaderRenderer.CSS_CLASS,function(){return new goog.ui.MenuHeader(null)}),goog.ui.MenuItemRenderer=function(){goog.ui.ControlRenderer.call(this),this.classNameCache_=[]},goog.inherits(goog.ui.MenuItemRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuItemRenderer),goog.ui.MenuItemRenderer.CSS_CLASS="goog-menuitem",goog.ui.MenuItemRenderer.CompositeCssClassIndex_={HOVER:0,CHECKBOX:1,CONTENT:2},goog.ui.MenuItemRenderer.prototype.getCompositeCssClass_=function(e){var t=this.classNameCache_[e];if(!t){switch(e){case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER:t=this.getStructuralCssClass()+"-highlight";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX:t=this.getStructuralCssClass()+"-checkbox";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT:t=this.getStructuralCssClass()+"-content"}this.classNameCache_[e]=t}return t},goog.ui.MenuItemRenderer.prototype.getAriaRole=function(){return goog.a11y.aria.Role.MENU_ITEM},goog.ui.MenuItemRenderer.prototype.createDom=function(e){var t=e.getDomHelper().createDom("DIV",this.getClassNames(e).join(" "),this.createContent(e.getContent(),e.getDomHelper()));return this.setEnableCheckBoxStructure(e,t,e.isSupportedState(goog.ui.Component.State.SELECTED)||e.isSupportedState(goog.ui.Component.State.CHECKED)),t},goog.ui.MenuItemRenderer.prototype.getContentElement=function(e){return e&&e.firstChild},goog.ui.MenuItemRenderer.prototype.decorate=function(e,t){return goog.asserts.assert(t),this.hasContentStructure(t)||t.appendChild(this.createContent(t.childNodes,e.getDomHelper())),goog.dom.classlist.contains(t,"goog-option")&&(e.setCheckable(!0),this.setCheckable(e,t,!0)),goog.ui.MenuItemRenderer.superClass_.decorate.call(this,e,t)},goog.ui.MenuItemRenderer.prototype.setContent=function(e,t){var o=this.getContentElement(e),i=this.hasCheckBoxStructure(e)?o.firstChild:null;goog.ui.MenuItemRenderer.superClass_.setContent.call(this,e,t),i&&!this.hasCheckBoxStructure(e)&&o.insertBefore(i,o.firstChild||null)},goog.ui.MenuItemRenderer.prototype.hasContentStructure=function(e){e=goog.dom.getFirstElementChild(e);var t=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return!!e&&goog.dom.classlist.contains(e,t)},goog.ui.MenuItemRenderer.prototype.createContent=function(e,t){var o=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return t.createDom("DIV",o,e)},goog.ui.MenuItemRenderer.prototype.setSelectable=function(e,t,o){e&&t&&this.setEnableCheckBoxStructure(e,t,o)},goog.ui.MenuItemRenderer.prototype.setCheckable=function(e,t,o){e&&t&&this.setEnableCheckBoxStructure(e,t,o)},goog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure=function(e){if(e=this.getContentElement(e)){e=e.firstChild;var t=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);return!!e&&goog.dom.isElement(e)&&goog.dom.classlist.contains(e,t)}return!1},goog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure=function(e,t,o){this.setAriaRole(t,e.getPreferredAriaRole()),this.setAriaStates(e,t),o!=this.hasCheckBoxStructure(t)&&(goog.dom.classlist.enable(t,"goog-option",o),t=this.getContentElement(t),o?(o=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX),t.insertBefore(e.getDomHelper().createDom("DIV",o),t.firstChild||null)):t.removeChild(t.firstChild))},goog.ui.MenuItemRenderer.prototype.getClassForState=function(e){switch(e){case goog.ui.Component.State.HOVER:return this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);case goog.ui.Component.State.CHECKED:case goog.ui.Component.State.SELECTED:return"goog-option-selected";default:return goog.ui.MenuItemRenderer.superClass_.getClassForState.call(this,e)}},goog.ui.MenuItemRenderer.prototype.getStateFromClass=function(e){var t=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);switch(e){case"goog-option-selected":return goog.ui.Component.State.CHECKED;case t:return goog.ui.Component.State.HOVER;default:return goog.ui.MenuItemRenderer.superClass_.getStateFromClass.call(this,e)}},goog.ui.MenuItemRenderer.prototype.getCssClass=function(){return goog.ui.MenuItemRenderer.CSS_CLASS},goog.ui.MenuItem=function(e,t,o,i){goog.ui.Control.call(this,e,i||goog.ui.MenuItemRenderer.getInstance(),o),this.setValue(t)},goog.inherits(goog.ui.MenuItem,goog.ui.Control),goog.tagUnsealableClass(goog.ui.MenuItem),goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_="goog-menuitem-mnemonic-separator",goog.ui.MenuItem.ACCELERATOR_CLASS="goog-menuitem-accel",goog.ui.MenuItem.prototype.getValue=function(){var e=this.getModel();return null!=e?e:this.getCaption()},goog.ui.MenuItem.prototype.setValue=function(e){this.setModel(e)},goog.ui.MenuItem.prototype.setSupportedState=function(e,t){switch(goog.ui.MenuItem.superClass_.setSupportedState.call(this,e,t),e){case goog.ui.Component.State.SELECTED:this.setSelectableInternal_(t);break;case goog.ui.Component.State.CHECKED:this.setCheckableInternal_(t)}},goog.ui.MenuItem.prototype.setSelectable=function(e){this.setSupportedState(goog.ui.Component.State.SELECTED,e)},goog.ui.MenuItem.prototype.setSelectableInternal_=function(e){this.isChecked()&&!e&&this.setChecked(!1);var t=this.getElement();t&&this.getRenderer().setSelectable(this,t,e)},goog.ui.MenuItem.prototype.setCheckable=function(e){this.setSupportedState(goog.ui.Component.State.CHECKED,e)},goog.ui.MenuItem.prototype.setCheckableInternal_=function(e){var t=this.getElement();t&&this.getRenderer().setCheckable(this,t,e)},goog.ui.MenuItem.prototype.getCaption=function(){var e=this.getContent();if(goog.isArray(e)){var t=goog.ui.MenuItem.ACCELERATOR_CLASS,o=goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_;return e=goog.array.map(e,function(e){return goog.dom.isElement(e)&&(goog.dom.classlist.contains(e,t)||goog.dom.classlist.contains(e,o))?"":goog.dom.getRawTextContent(e)}).join(""),goog.string.collapseBreakingSpaces(e)}return goog.ui.MenuItem.superClass_.getCaption.call(this)},goog.ui.MenuItem.prototype.getAccelerator=function(){var e=this.getDomHelper(),t=this.getContent();return goog.isArray(t)&&(t=goog.array.find(t,function(e){return goog.dom.classlist.contains(e,goog.ui.MenuItem.ACCELERATOR_CLASS)}))?e.getTextContent(t):null},goog.ui.MenuItem.prototype.handleMouseUp=function(e){var t=this.getParent();if(t){var o=t.openingCoords;if(t.openingCoords=null,o&&goog.isNumber(e.clientX)&&(t=new goog.math.Coordinate(e.clientX,e.clientY),goog.math.Coordinate.equals(o,t)))return}goog.ui.MenuItem.superClass_.handleMouseUp.call(this,e)},goog.ui.MenuItem.prototype.handleKeyEventInternal=function(e){return!(e.keyCode!=this.getMnemonic()||!this.performActionInternal(e))||goog.ui.MenuItem.superClass_.handleKeyEventInternal.call(this,e)},goog.ui.MenuItem.prototype.setMnemonic=function(e){this.mnemonicKey_=e},goog.ui.MenuItem.prototype.getMnemonic=function(){return this.mnemonicKey_},goog.ui.registry.setDecoratorByClassName(goog.ui.MenuItemRenderer.CSS_CLASS,function(){return new goog.ui.MenuItem(null)}),goog.ui.MenuItem.prototype.getPreferredAriaRole=function(){return this.isSupportedState(goog.ui.Component.State.CHECKED)?goog.a11y.aria.Role.MENU_ITEM_CHECKBOX:this.isSupportedState(goog.ui.Component.State.SELECTED)?goog.a11y.aria.Role.MENU_ITEM_RADIO:goog.ui.MenuItem.superClass_.getPreferredAriaRole.call(this)},goog.ui.MenuItem.prototype.getParent=function(){return goog.ui.Control.prototype.getParent.call(this)},goog.ui.MenuItem.prototype.getParentEventTarget=function(){return goog.ui.Control.prototype.getParentEventTarget.call(this)},goog.ui.MenuSeparatorRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.MenuSeparatorRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuSeparatorRenderer),goog.ui.MenuSeparatorRenderer.CSS_CLASS="goog-menuseparator",goog.ui.MenuSeparatorRenderer.prototype.createDom=function(e){return e.getDomHelper().createDom("DIV",this.getCssClass())},goog.ui.MenuSeparatorRenderer.prototype.decorate=function(e,t){if(t.id&&e.setId(t.id),"HR"==t.tagName){var o=t;t=this.createDom(e),goog.dom.insertSiblingBefore(t,o),goog.dom.removeNode(o)}else goog.dom.classlist.add(t,this.getCssClass());return t},goog.ui.MenuSeparatorRenderer.prototype.setContent=function(e,t){},goog.ui.MenuSeparatorRenderer.prototype.getCssClass=function(){return goog.ui.MenuSeparatorRenderer.CSS_CLASS},goog.ui.Separator=function(e,t){goog.ui.Control.call(this,null,e||goog.ui.MenuSeparatorRenderer.getInstance(),t),this.setSupportedState(goog.ui.Component.State.DISABLED,!1),this.setSupportedState(goog.ui.Component.State.HOVER,!1),this.setSupportedState(goog.ui.Component.State.ACTIVE,!1),this.setSupportedState(goog.ui.Component.State.FOCUSED,!1),this.setStateInternal(goog.ui.Component.State.DISABLED)},goog.inherits(goog.ui.Separator,goog.ui.Control),goog.ui.Separator.prototype.enterDocument=function(){goog.ui.Separator.superClass_.enterDocument.call(this);var e=this.getElement();goog.asserts.assert(e,"The DOM element for the separator cannot be null."),goog.a11y.aria.setRole(e,"separator")},goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator}),goog.ui.MenuRenderer=function(e){goog.ui.ContainerRenderer.call(this,e||goog.a11y.aria.Role.MENU)},goog.inherits(goog.ui.MenuRenderer,goog.ui.ContainerRenderer),goog.addSingletonGetter(goog.ui.MenuRenderer),goog.ui.MenuRenderer.CSS_CLASS="goog-menu",goog.ui.MenuRenderer.prototype.canDecorate=function(e){return"UL"==e.tagName||goog.ui.MenuRenderer.superClass_.canDecorate.call(this,e)},goog.ui.MenuRenderer.prototype.getDecoratorForChild=function(e){return"HR"==e.tagName?new goog.ui.Separator:goog.ui.MenuRenderer.superClass_.getDecoratorForChild.call(this,e)},goog.ui.MenuRenderer.prototype.containsElement=function(e,t){return goog.dom.contains(e.getElement(),t)},goog.ui.MenuRenderer.prototype.getCssClass=function(){return goog.ui.MenuRenderer.CSS_CLASS},goog.ui.MenuRenderer.prototype.initializeDom=function(e){goog.ui.MenuRenderer.superClass_.initializeDom.call(this,e),e=e.getElement(),goog.asserts.assert(e,"The menu DOM element cannot be null."),goog.a11y.aria.setState(e,goog.a11y.aria.State.HASPOPUP,"true")},goog.ui.MenuSeparator=function(e){goog.ui.Separator.call(this,goog.ui.MenuSeparatorRenderer.getInstance(),e)},goog.inherits(goog.ui.MenuSeparator,goog.ui.Separator),goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator}),goog.ui.Menu=function(e,t){goog.ui.Container.call(this,goog.ui.Container.Orientation.VERTICAL,t||goog.ui.MenuRenderer.getInstance(),e),this.setFocusable(!1)},goog.inherits(goog.ui.Menu,goog.ui.Container),goog.tagUnsealableClass(goog.ui.Menu),goog.ui.Menu.EventType={BEFORE_SHOW:goog.ui.Component.EventType.BEFORE_SHOW,SHOW:goog.ui.Component.EventType.SHOW,BEFORE_HIDE:goog.ui.Component.EventType.HIDE,HIDE:goog.ui.Component.EventType.HIDE},goog.ui.Menu.CSS_CLASS=goog.ui.MenuRenderer.CSS_CLASS,goog.ui.Menu.prototype.allowAutoFocus_=!0,goog.ui.Menu.prototype.allowHighlightDisabled_=!1,goog.ui.Menu.prototype.getCssClass=function(){return this.getRenderer().getCssClass()},goog.ui.Menu.prototype.containsElement=function(e){if(this.getRenderer().containsElement(this,e))return!0;for(var t=0,o=this.getChildCount();t<o;t++){var i=this.getChildAt(t);if("function"==typeof i.containsElement&&i.containsElement(e))return!0}return!1},goog.ui.Menu.prototype.addItem=function(e){this.addChild(e,!0)},goog.ui.Menu.prototype.addItemAt=function(e,t){this.addChildAt(e,t,!0)},goog.ui.Menu.prototype.removeItem=function(e){(e=this.removeChild(e,!0))&&e.dispose()},goog.ui.Menu.prototype.removeItemAt=function(e){(e=this.removeChildAt(e,!0))&&e.dispose()},goog.ui.Menu.prototype.getItemAt=function(e){return this.getChildAt(e)},goog.ui.Menu.prototype.getItemCount=function(){return this.getChildCount()},goog.ui.Menu.prototype.getItems=function(){var e=[];return this.forEachChild(function(t){e.push(t)}),e},goog.ui.Menu.prototype.setPosition=function(e,t){var o=this.isVisible();o||goog.style.setElementShown(this.getElement(),!0),goog.style.setPageOffset(this.getElement(),e,t),o||goog.style.setElementShown(this.getElement(),!1)},goog.ui.Menu.prototype.getPosition=function(){return this.isVisible()?goog.style.getPageOffset(this.getElement()):null},goog.ui.Menu.prototype.setAllowAutoFocus=function(e){(this.allowAutoFocus_=e)&&this.setFocusable(!0)},goog.ui.Menu.prototype.getAllowAutoFocus=function(){return this.allowAutoFocus_},goog.ui.Menu.prototype.setAllowHighlightDisabled=function(e){this.allowHighlightDisabled_=e},goog.ui.Menu.prototype.getAllowHighlightDisabled=function(){return this.allowHighlightDisabled_},goog.ui.Menu.prototype.setVisible=function(e,t,o){return(t=goog.ui.Menu.superClass_.setVisible.call(this,e,t))&&e&&this.isInDocument()&&this.allowAutoFocus_&&this.getKeyEventTarget().focus(),e&&o&&goog.isNumber(o.clientX)?this.openingCoords=new goog.math.Coordinate(o.clientX,o.clientY):this.openingCoords=null,t},goog.ui.Menu.prototype.handleEnterItem=function(e){return this.allowAutoFocus_&&this.getKeyEventTarget().focus(),goog.ui.Menu.superClass_.handleEnterItem.call(this,e)},goog.ui.Menu.prototype.highlightNextPrefix=function(e){var t=new RegExp("^"+goog.string.regExpEscape(e),"i");return this.highlightHelper(function(e,o){var i=0>e?0:e,n=!1;do{++e==o&&(e=0,n=!0);var r=this.getChildAt(e).getCaption();if(r&&r.match(t))return e}while(!n||e!=i);return this.getHighlightedIndex()},this.getHighlightedIndex())},goog.ui.Menu.prototype.canHighlightItem=function(e){return(this.allowHighlightDisabled_||e.isEnabled())&&e.isVisible()&&e.isSupportedState(goog.ui.Component.State.HOVER)},goog.ui.Menu.prototype.decorateInternal=function(e){this.decorateContent(e),goog.ui.Menu.superClass_.decorateInternal.call(this,e)},goog.ui.Menu.prototype.handleKeyEventInternal=function(e){var t=goog.ui.Menu.superClass_.handleKeyEventInternal.call(this,e);return t||this.forEachChild(function(o){!t&&o.getMnemonic&&o.getMnemonic()==e.keyCode&&(this.isEnabled()&&this.setHighlighted(o),t=o.handleKeyEvent(e))},this),t},goog.ui.Menu.prototype.setHighlightedIndex=function(e){goog.ui.Menu.superClass_.setHighlightedIndex.call(this,e),(e=this.getChildAt(e))&&goog.style.scrollIntoContainerView(e.getElement(),this.getElement())},goog.ui.Menu.prototype.decorateContent=function(e){for(var t=this.getRenderer(),o=(e=this.getDomHelper().getElementsByTagNameAndClass("DIV",t.getCssClass()+"-content",e)).length,i=0;i<o;i++)t.decorateChildren(this,e[i])},goog.iter={},goog.iter.StopIteration="StopIteration"in goog.global?goog.global.StopIteration:{message:"StopIteration",stack:""},goog.iter.Iterator=function(){},goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration},goog.iter.Iterator.prototype.__iterator__=function(e){return this},goog.iter.toIterator=function(e){if(e instanceof goog.iter.Iterator)return e;if("function"==typeof e.__iterator__)return e.__iterator__(!1);if(goog.isArrayLike(e)){var t=0,o=new goog.iter.Iterator;return o.next=function(){for(;;){if(t>=e.length)throw goog.iter.StopIteration;if(t in e)return e[t++];t++}},o}throw Error("Not implemented")},goog.iter.forEach=function(e,t,o){if(goog.isArrayLike(e))try{goog.array.forEach(e,t,o)}catch(e){if(e!==goog.iter.StopIteration)throw e}else{e=goog.iter.toIterator(e);try{for(;;)t.call(o,e.next(),void 0,e)}catch(e){if(e!==goog.iter.StopIteration)throw e}}},goog.iter.filter=function(e,t,o){var i=goog.iter.toIterator(e);return(e=new goog.iter.Iterator).next=function(){for(;;){var e=i.next();if(t.call(o,e,void 0,i))return e}},e},goog.iter.filterFalse=function(e,t,o){return goog.iter.filter(e,goog.functions.not(t),o)},goog.iter.range=function(e,t,o){var i=0,n=e,r=o||1;if(1<arguments.length&&(i=e,n=t),0==r)throw Error("Range step argument must not be zero");var s=new goog.iter.Iterator;return s.next=function(){if(0<r&&i>=n||0>r&&i<=n)throw goog.iter.StopIteration;var e=i;return i+=r,e},s},goog.iter.join=function(e,t){return goog.iter.toArray(e).join(t)},goog.iter.map=function(e,t,o){var i=goog.iter.toIterator(e);return(e=new goog.iter.Iterator).next=function(){var e=i.next();return t.call(o,e,void 0,i)},e},goog.iter.reduce=function(e,t,o,i){var n=o;return goog.iter.forEach(e,function(e){n=t.call(i,n,e)}),n},goog.iter.some=function(e,t,o){e=goog.iter.toIterator(e);try{for(;;)if(t.call(o,e.next(),void 0,e))return!0}catch(e){if(e!==goog.iter.StopIteration)throw e}return!1},goog.iter.every=function(e,t,o){e=goog.iter.toIterator(e);try{for(;;)if(!t.call(o,e.next(),void 0,e))return!1}catch(e){if(e!==goog.iter.StopIteration)throw e}return!0},goog.iter.chain=function(e){return goog.iter.chainFromIterable(arguments)},goog.iter.chainFromIterable=function(e){var t=goog.iter.toIterator(e),o=null;return(e=new goog.iter.Iterator).next=function(){for(;;){if(null==o){var e=t.next();o=goog.iter.toIterator(e)}try{return o.next()}catch(e){if(e!==goog.iter.StopIteration)throw e;o=null}}},e},goog.iter.dropWhile=function(e,t,o){var i=goog.iter.toIterator(e),n=!0;return(e=new goog.iter.Iterator).next=function(){for(;;){var e=i.next();if(!n||!t.call(o,e,void 0,i))return n=!1,e}},e},goog.iter.takeWhile=function(e,t,o){var i=goog.iter.toIterator(e);return(e=new goog.iter.Iterator).next=function(){var e=i.next();if(t.call(o,e,void 0,i))return e;throw goog.iter.StopIteration},e},goog.iter.toArray=function(e){if(goog.isArrayLike(e))return goog.array.toArray(e);e=goog.iter.toIterator(e);var t=[];return goog.iter.forEach(e,function(e){t.push(e)}),t},goog.iter.equals=function(e,t,o){e=goog.iter.zipLongest({},e,t);var i=o||goog.array.defaultCompareEquality;return goog.iter.every(e,function(e){return i(e[0],e[1])})},goog.iter.nextOrValue=function(e,t){try{return goog.iter.toIterator(e).next()}catch(e){if(e!=goog.iter.StopIteration)throw e;return t}},goog.iter.product=function(e){if(goog.array.some(arguments,function(e){return!e.length})||!arguments.length)return new goog.iter.Iterator;var t=new goog.iter.Iterator,o=arguments,i=goog.array.repeat(0,o.length);return t.next=function(){if(i){for(var e=goog.array.map(i,function(e,t){return o[t][e]}),t=i.length-1;0<=t;t--){if(goog.asserts.assert(i),i[t]<o[t].length-1){i[t]++;break}if(0==t){i=null;break}i[t]=0}return e}throw goog.iter.StopIteration},t},goog.iter.cycle=function(e){var t=goog.iter.toIterator(e),o=[],i=0,n=!1;return(e=new goog.iter.Iterator).next=function(){var e=null;if(!n)try{return e=t.next(),o.push(e),e}catch(e){if(e!=goog.iter.StopIteration||goog.array.isEmpty(o))throw e;n=!0}return e=o[i],i=(i+1)%o.length,e},e},goog.iter.count=function(e,t){var o=e||0,i=goog.isDef(t)?t:1,n=new goog.iter.Iterator;return n.next=function(){var e=o;return o+=i,e},n},goog.iter.repeat=function(e){var t=new goog.iter.Iterator;return t.next=goog.functions.constant(e),t},goog.iter.accumulate=function(e){var t=goog.iter.toIterator(e),o=0;return(e=new goog.iter.Iterator).next=function(){return o+=t.next()},e},goog.iter.zip=function(e){var t=arguments,o=new goog.iter.Iterator;if(0<t.length){var i=goog.array.map(t,goog.iter.toIterator);o.next=function(){return goog.array.map(i,function(e){return e.next()})}}return o},goog.iter.zipLongest=function(e,t){var o=goog.array.slice(arguments,1),i=new goog.iter.Iterator;if(0<o.length){var n=goog.array.map(o,goog.iter.toIterator);i.next=function(){var t=!1,o=goog.array.map(n,function(o){try{var i=o.next();t=!0}catch(t){if(t!==goog.iter.StopIteration)throw t;i=e}return i});if(!t)throw goog.iter.StopIteration;return o}}return i},goog.iter.compress=function(e,t){var o=goog.iter.toIterator(t);return goog.iter.filter(e,function(){return!!o.next()})},goog.iter.GroupByIterator_=function(e,t){this.iterator=goog.iter.toIterator(e),this.keyFunc=t||goog.functions.identity},goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator),goog.iter.GroupByIterator_.prototype.next=function(){for(;this.currentKey==this.targetKey;)this.currentValue=this.iterator.next(),this.currentKey=this.keyFunc(this.currentValue);return this.targetKey=this.currentKey,[this.currentKey,this.groupItems_(this.targetKey)]},goog.iter.GroupByIterator_.prototype.groupItems_=function(e){for(var t=[];this.currentKey==e;){t.push(this.currentValue);try{this.currentValue=this.iterator.next()}catch(e){if(e!==goog.iter.StopIteration)throw e;break}this.currentKey=this.keyFunc(this.currentValue)}return t},goog.iter.groupBy=function(e,t){return new goog.iter.GroupByIterator_(e,t)},goog.iter.starMap=function(e,t,o){var i=goog.iter.toIterator(e);return(e=new goog.iter.Iterator).next=function(){var e=goog.iter.toArray(i.next());return t.apply(o,goog.array.concat(e,void 0,i))},e},goog.iter.tee=function(e,t){var o=goog.iter.toIterator(e),i=goog.isNumber(t)?t:2,n=goog.array.map(goog.array.range(i),function(){return[]});return goog.array.map(n,function(e){var t=new goog.iter.Iterator;return t.next=function(){return goog.array.isEmpty(e)&&function(){var e=o.next();goog.array.forEach(n,function(t){t.push(e)})}(),goog.asserts.assert(!goog.array.isEmpty(e)),e.shift()},t})},goog.iter.enumerate=function(e,t){return goog.iter.zip(goog.iter.count(t),e)},goog.iter.limit=function(e,t){goog.asserts.assert(goog.math.isInt(t)&&0<=t);var o=goog.iter.toIterator(e),i=new goog.iter.Iterator,n=t;return i.next=function(){if(0<n--)return o.next();throw goog.iter.StopIteration},i},goog.iter.consume=function(e,t){goog.asserts.assert(goog.math.isInt(t)&&0<=t);for(var o=goog.iter.toIterator(e);0<t--;)goog.iter.nextOrValue(o,null);return o},goog.iter.slice=function(e,t,o){return goog.asserts.assert(goog.math.isInt(t)&&0<=t),e=goog.iter.consume(e,t),goog.isNumber(o)&&(goog.asserts.assert(goog.math.isInt(o)&&o>=t),e=goog.iter.limit(e,o-t)),e},goog.iter.hasDuplicates_=function(e){var t=[];return goog.array.removeDuplicates(e,t),e.length!=t.length},goog.iter.permutations=function(e,t){var o=goog.iter.toArray(e),i=goog.isNumber(t)?t:o.length;return o=goog.array.repeat(o,i),o=goog.iter.product.apply(void 0,o),goog.iter.filter(o,function(e){return!goog.iter.hasDuplicates_(e)})},goog.iter.combinations=function(e,t){function o(e){return i[e]}var i=goog.iter.toArray(e),n=goog.iter.range(i.length);n=goog.iter.permutations(n,t);var r=goog.iter.filter(n,function(e){return goog.array.isSorted(e)});return(n=new goog.iter.Iterator).next=function(){return goog.array.map(r.next(),o)},n},goog.iter.combinationsWithReplacement=function(e,t){function o(e){return i[e]}var i=goog.iter.toArray(e),n=goog.array.range(i.length);n=goog.array.repeat(n,t),n=goog.iter.product.apply(void 0,n);var r=goog.iter.filter(n,function(e){return goog.array.isSorted(e)});return(n=new goog.iter.Iterator).next=function(){return goog.array.map(r.next(),o)},n},goog.dom.TagWalkType={START_TAG:1,OTHER:0,END_TAG:-1},goog.dom.TagIterator=function(e,t,o,i,n){this.reversed=!!t,this.node=null,this.tagType=goog.dom.TagWalkType.OTHER,this.started_=!1,this.constrained=!o,e&&this.setPosition(e,i),this.depth=void 0!=n?n:this.tagType||0,this.reversed&&(this.depth*=-1)},goog.inherits(goog.dom.TagIterator,goog.iter.Iterator),goog.dom.TagIterator.prototype.setPosition=function(e,t,o){(this.node=e)&&(goog.isNumber(t)?this.tagType=t:this.tagType=this.node.nodeType!=goog.dom.NodeType.ELEMENT?goog.dom.TagWalkType.OTHER:this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG),goog.isNumber(o)&&(this.depth=o)},goog.dom.TagIterator.prototype.copyFrom=function(e){this.node=e.node,this.tagType=e.tagType,this.depth=e.depth,this.reversed=e.reversed,this.constrained=e.constrained},goog.dom.TagIterator.prototype.clone=function(){return new goog.dom.TagIterator(this.node,this.reversed,!this.constrained,this.tagType,this.depth)},goog.dom.TagIterator.prototype.skipTag=function(){var e=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;this.tagType==e&&(this.tagType=-1*e,this.depth+=this.tagType*(this.reversed?-1:1))},goog.dom.TagIterator.prototype.restartTag=function(){var e=this.reversed?goog.dom.TagWalkType.START_TAG:goog.dom.TagWalkType.END_TAG;this.tagType==e&&(this.tagType=-1*e,this.depth+=this.tagType*(this.reversed?-1:1))},goog.dom.TagIterator.prototype.next=function(){if(this.started_){if(!this.node||this.constrained&&0==this.depth)throw goog.iter.StopIteration;var e=this.node,t=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==t){var o=this.reversed?e.lastChild:e.firstChild;o?this.setPosition(o):this.setPosition(e,-1*t)}else(o=this.reversed?e.previousSibling:e.nextSibling)?this.setPosition(o):this.setPosition(e.parentNode,-1*t);this.depth+=this.tagType*(this.reversed?-1:1)}else this.started_=!0;if(e=this.node,!this.node)throw goog.iter.StopIteration;return e},goog.dom.TagIterator.prototype.isStarted=function(){return this.started_},goog.dom.TagIterator.prototype.isStartTag=function(){return this.tagType==goog.dom.TagWalkType.START_TAG},goog.dom.TagIterator.prototype.isEndTag=function(){return this.tagType==goog.dom.TagWalkType.END_TAG},goog.dom.TagIterator.prototype.isNonElement=function(){return this.tagType==goog.dom.TagWalkType.OTHER},goog.dom.TagIterator.prototype.equals=function(e){return e.node==this.node&&(!this.node||e.tagType==this.tagType)},goog.dom.TagIterator.prototype.splice=function(e){var t=this.node;this.restartTag(),this.reversed=!this.reversed,goog.dom.TagIterator.prototype.next.call(this),this.reversed=!this.reversed;for(var o=goog.isArrayLike(arguments[0])?arguments[0]:arguments,i=o.length-1;0<=i;i--)goog.dom.insertSiblingAfter(o[i],t);goog.dom.removeNode(t)},goog.dom.NodeIterator=function(e,t,o,i){goog.dom.TagIterator.call(this,e,t,o,null,i)},goog.inherits(goog.dom.NodeIterator,goog.dom.TagIterator),goog.dom.NodeIterator.prototype.next=function(){do{goog.dom.NodeIterator.superClass_.next.call(this)}while(this.isEndTag());return this.node},goog.ui.PaletteRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.PaletteRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.PaletteRenderer),goog.ui.PaletteRenderer.cellId_=0,goog.ui.PaletteRenderer.CSS_CLASS="goog-palette",goog.ui.PaletteRenderer.prototype.createDom=function(e){var t=this.getClassNames(e);return e=e.getDomHelper().createDom("DIV",t,this.createGrid(e.getContent(),e.getSize(),e.getDomHelper())),goog.a11y.aria.setRole(e,goog.a11y.aria.Role.GRID),e},goog.ui.PaletteRenderer.prototype.createGrid=function(e,t,o){for(var i=[],n=0,r=0;n<t.height;n++){for(var s=[],a=0;a<t.width;a++){var l=e&&e[r++];s.push(this.createCell(l,o))}i.push(this.createRow(s,o))}return this.createTable(i,o)},goog.ui.PaletteRenderer.prototype.createTable=function(e,t){var o=t.createDom("TABLE",this.getCssClass()+"-table",t.createDom("TBODY",this.getCssClass()+"-body",e));return o.cellSpacing="0",o.cellPadding="0",o},goog.ui.PaletteRenderer.prototype.createRow=function(e,t){var o=t.createDom("TR",this.getCssClass()+"-row",e);return goog.a11y.aria.setRole(o,goog.a11y.aria.Role.ROW),o},goog.ui.PaletteRenderer.prototype.createCell=function(e,t){var o=t.createDom("TD",{class:this.getCssClass()+"-cell",id:this.getCssClass()+"-cell-"+goog.ui.PaletteRenderer.cellId_++},e);if(goog.a11y.aria.setRole(o,goog.a11y.aria.Role.GRIDCELL),goog.a11y.aria.setState(o,goog.a11y.aria.State.SELECTED,!1),!goog.dom.getTextContent(o)&&!goog.a11y.aria.getLabel(o)){var i=this.findAriaLabelForCell_(o);i&&goog.a11y.aria.setLabel(o,i)}return o},goog.ui.PaletteRenderer.prototype.findAriaLabelForCell_=function(e){e=new goog.dom.NodeIterator(e);for(var t,o="";!o&&(t=goog.iter.nextOrValue(e,null));)t.nodeType==goog.dom.NodeType.ELEMENT&&(o=goog.a11y.aria.getLabel(t)||t.title);return o},goog.ui.PaletteRenderer.prototype.canDecorate=function(e){return!1},goog.ui.PaletteRenderer.prototype.decorate=function(e,t){return null},goog.ui.PaletteRenderer.prototype.setContent=function(e,t){if(e){var o=goog.dom.getElementsByTagNameAndClass("TBODY",this.getCssClass()+"-body",e)[0];if(o){var i=0;if(goog.array.forEach(o.rows,function(e){goog.array.forEach(e.cells,function(e){if(goog.dom.removeChildren(e),t){var o=t[i++];o&&goog.dom.appendChild(e,o)}})}),i<t.length){for(var n=[],r=goog.dom.getDomHelper(e),s=o.rows[0].cells.length;i<t.length;){var a=t[i++];n.push(this.createCell(a,r)),n.length==s&&(a=this.createRow(n,r),goog.dom.appendChild(o,a),n.length=0)}if(0<n.length){for(;n.length<s;)n.push(this.createCell("",r));a=this.createRow(n,r),goog.dom.appendChild(o,a)}}}goog.style.setUnselectable(e,!0,goog.userAgent.GECKO)}},goog.ui.PaletteRenderer.prototype.getContainingItem=function(e,t){for(var o=e.getElement();t&&t.nodeType==goog.dom.NodeType.ELEMENT&&t!=o;){if("TD"==t.tagName&&goog.dom.classlist.contains(t,this.getCssClass()+"-cell"))return t.firstChild;t=t.parentNode}return null},goog.ui.PaletteRenderer.prototype.highlightCell=function(e,t,o){t&&(t=this.getCellForItem(t),goog.asserts.assert(t),goog.dom.classlist.enable(t,this.getCssClass()+"-cell-hover",o),o?goog.a11y.aria.setState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT,t.id):t.id==goog.a11y.aria.getState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT)&&goog.a11y.aria.removeState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT))},goog.ui.PaletteRenderer.prototype.getCellForItem=function(e){return e?e.parentNode:null},goog.ui.PaletteRenderer.prototype.selectCell=function(e,t,o){t&&(e=t.parentNode,goog.dom.classlist.enable(e,this.getCssClass()+"-cell-selected",o),goog.a11y.aria.setState(e,goog.a11y.aria.State.SELECTED,o))},goog.ui.PaletteRenderer.prototype.getCssClass=function(){return goog.ui.PaletteRenderer.CSS_CLASS},goog.ui.SelectionModel=function(e){goog.events.EventTarget.call(this),this.items_=[],this.addItems(e)},goog.inherits(goog.ui.SelectionModel,goog.events.EventTarget),goog.tagUnsealableClass(goog.ui.SelectionModel),goog.ui.SelectionModel.prototype.selectedItem_=null,goog.ui.SelectionModel.prototype.selectionHandler_=null,goog.ui.SelectionModel.prototype.getSelectionHandler=function(){return this.selectionHandler_},goog.ui.SelectionModel.prototype.setSelectionHandler=function(e){this.selectionHandler_=e},goog.ui.SelectionModel.prototype.getItemCount=function(){return this.items_.length},goog.ui.SelectionModel.prototype.indexOfItem=function(e){return e?goog.array.indexOf(this.items_,e):-1},goog.ui.SelectionModel.prototype.getFirst=function(){return this.items_[0]},goog.ui.SelectionModel.prototype.getLast=function(){return this.items_[this.items_.length-1]},goog.ui.SelectionModel.prototype.getItemAt=function(e){return this.items_[e]||null},goog.ui.SelectionModel.prototype.addItems=function(e){e&&(goog.array.forEach(e,function(e){this.selectItem_(e,!1)},this),goog.array.extend(this.items_,e))},goog.ui.SelectionModel.prototype.addItem=function(e){this.addItemAt(e,this.getItemCount())},goog.ui.SelectionModel.prototype.addItemAt=function(e,t){e&&(this.selectItem_(e,!1),goog.array.insertAt(this.items_,e,t))},goog.ui.SelectionModel.prototype.removeItem=function(e){e&&goog.array.remove(this.items_,e)&&e==this.selectedItem_&&(this.selectedItem_=null,this.dispatchEvent(goog.events.EventType.SELECT))},goog.ui.SelectionModel.prototype.removeItemAt=function(e){this.removeItem(this.getItemAt(e))},goog.ui.SelectionModel.prototype.getSelectedItem=function(){return this.selectedItem_},goog.ui.SelectionModel.prototype.getItems=function(){return goog.array.clone(this.items_)},goog.ui.SelectionModel.prototype.setSelectedItem=function(e){e!=this.selectedItem_&&(this.selectItem_(this.selectedItem_,!1),this.selectedItem_=e,this.selectItem_(e,!0)),this.dispatchEvent(goog.events.EventType.SELECT)},goog.ui.SelectionModel.prototype.getSelectedIndex=function(){return this.indexOfItem(this.selectedItem_)},goog.ui.SelectionModel.prototype.setSelectedIndex=function(e){this.setSelectedItem(this.getItemAt(e))},goog.ui.SelectionModel.prototype.clear=function(){goog.array.clear(this.items_),this.selectedItem_=null},goog.ui.SelectionModel.prototype.disposeInternal=function(){goog.ui.SelectionModel.superClass_.disposeInternal.call(this),delete this.items_,this.selectedItem_=null},goog.ui.SelectionModel.prototype.selectItem_=function(e,t){e&&("function"==typeof this.selectionHandler_?this.selectionHandler_(e,t):"function"==typeof e.setSelected&&e.setSelected(t))},goog.ui.Palette=function(e,t,o){goog.ui.Control.call(this,e,t||goog.ui.PaletteRenderer.getInstance(),o),this.setAutoStates(goog.ui.Component.State.CHECKED|goog.ui.Component.State.SELECTED|goog.ui.Component.State.OPENED,!1),this.currentCellControl_=new goog.ui.Palette.CurrentCell_,this.currentCellControl_.setParentEventTarget(this),this.lastHighlightedIndex_=-1},goog.inherits(goog.ui.Palette,goog.ui.Control),goog.tagUnsealableClass(goog.ui.Palette),goog.ui.Palette.EventType={AFTER_HIGHLIGHT:goog.events.getUniqueId("afterhighlight")},goog.ui.Palette.prototype.size_=null,goog.ui.Palette.prototype.highlightedIndex_=-1,goog.ui.Palette.prototype.selectionModel_=null,goog.ui.Palette.prototype.disposeInternal=function(){goog.ui.Palette.superClass_.disposeInternal.call(this),this.selectionModel_&&(this.selectionModel_.dispose(),this.selectionModel_=null),this.size_=null,this.currentCellControl_.dispose()},goog.ui.Palette.prototype.setContentInternal=function(e){goog.ui.Palette.superClass_.setContentInternal.call(this,e),this.adjustSize_(),this.selectionModel_?(this.selectionModel_.clear(),this.selectionModel_.addItems(e)):(this.selectionModel_=new goog.ui.SelectionModel(e),this.selectionModel_.setSelectionHandler(goog.bind(this.selectItem_,this)),this.getHandler().listen(this.selectionModel_,goog.events.EventType.SELECT,this.handleSelectionChange)),this.highlightedIndex_=-1},goog.ui.Palette.prototype.getCaption=function(){return""},goog.ui.Palette.prototype.setCaption=function(e){},goog.ui.Palette.prototype.handleMouseOver=function(e){goog.ui.Palette.superClass_.handleMouseOver.call(this,e);var t=this.getRenderer().getContainingItem(this,e.target);t&&e.relatedTarget&&goog.dom.contains(t,e.relatedTarget)||t!=this.getHighlightedItem()&&this.setHighlightedItem(t)},goog.ui.Palette.prototype.handleMouseDown=function(e){goog.ui.Palette.superClass_.handleMouseDown.call(this,e),this.isActive()&&((e=this.getRenderer().getContainingItem(this,e.target))!=this.getHighlightedItem()&&this.setHighlightedItem(e))},goog.ui.Palette.prototype.performActionInternal=function(e){var t=this.getHighlightedItem();return!!t&&(e&&this.shouldSelectHighlightedItem_(e)&&this.setSelectedItem(t),goog.ui.Palette.superClass_.performActionInternal.call(this,e))},goog.ui.Palette.prototype.shouldSelectHighlightedItem_=function(e){return!this.getSelectedItem()||("mouseup"!=e.type||!!this.getRenderer().getContainingItem(this,e.target))},goog.ui.Palette.prototype.handleKeyEvent=function(e){var t=this.getContent();t=t?t.length:0;var o=this.size_.width;if(0==t||!this.isEnabled())return!1;if(e.keyCode==goog.events.KeyCodes.ENTER||e.keyCode==goog.events.KeyCodes.SPACE)return this.performActionInternal(e);if(e.keyCode==goog.events.KeyCodes.HOME)return this.setHighlightedIndex(0),!0;if(e.keyCode==goog.events.KeyCodes.END)return this.setHighlightedIndex(t-1),!0;var i=0>this.highlightedIndex_?this.getSelectedIndex():this.highlightedIndex_;switch(e.keyCode){case goog.events.KeyCodes.LEFT:return-1!=i&&0!=i||(i=t),this.setHighlightedIndex(i-1),e.preventDefault(),!0;case goog.events.KeyCodes.RIGHT:return i==t-1&&(i=-1),this.setHighlightedIndex(i+1),e.preventDefault(),!0;case goog.events.KeyCodes.UP:if(-1==i&&(i=t+o-1),i>=o)return this.setHighlightedIndex(i-o),e.preventDefault(),!0;break;case goog.events.KeyCodes.DOWN:if(-1==i&&(i=-o),i<t-o)return this.setHighlightedIndex(i+o),e.preventDefault(),!0}return!1},goog.ui.Palette.prototype.handleSelectionChange=function(e){},goog.ui.Palette.prototype.getSize=function(){return this.size_},goog.ui.Palette.prototype.setSize=function(e,t){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.size_=goog.isNumber(e)?new goog.math.Size(e,t):e,this.adjustSize_()},goog.ui.Palette.prototype.getHighlightedIndex=function(){return this.highlightedIndex_},goog.ui.Palette.prototype.getHighlightedItem=function(){var e=this.getContent();return e&&e[this.highlightedIndex_]},goog.ui.Palette.prototype.getHighlightedCellElement_=function(){return this.getRenderer().getCellForItem(this.getHighlightedItem())},goog.ui.Palette.prototype.setHighlightedIndex=function(e){e!=this.highlightedIndex_&&(this.highlightIndex_(this.highlightedIndex_,!1),this.lastHighlightedIndex_=this.highlightedIndex_,this.highlightedIndex_=e,this.highlightIndex_(e,!0),this.dispatchEvent(goog.ui.Palette.EventType.AFTER_HIGHLIGHT))},goog.ui.Palette.prototype.setHighlightedItem=function(e){var t=this.getContent();this.setHighlightedIndex(t&&e?goog.array.indexOf(t,e):-1)},goog.ui.Palette.prototype.getSelectedIndex=function(){return this.selectionModel_?this.selectionModel_.getSelectedIndex():-1},goog.ui.Palette.prototype.getSelectedItem=function(){return this.selectionModel_?this.selectionModel_.getSelectedItem():null},goog.ui.Palette.prototype.setSelectedIndex=function(e){this.selectionModel_&&this.selectionModel_.setSelectedIndex(e)},goog.ui.Palette.prototype.setSelectedItem=function(e){this.selectionModel_&&this.selectionModel_.setSelectedItem(e)},goog.ui.Palette.prototype.highlightIndex_=function(e,t){if(this.getElement()){var o=this.getContent();if(o&&0<=e&&e<o.length){var i=this.getHighlightedCellElement_();this.currentCellControl_.getElement()!=i&&this.currentCellControl_.setElementInternal(i),this.currentCellControl_.tryHighlight(t)&&this.getRenderer().highlightCell(this,o[e],t)}}},goog.ui.Palette.prototype.setHighlighted=function(e){e&&-1==this.highlightedIndex_?this.setHighlightedIndex(-1<this.lastHighlightedIndex_?this.lastHighlightedIndex_:0):e||this.setHighlightedIndex(-1),goog.ui.Palette.superClass_.setHighlighted.call(this,e)},goog.ui.Palette.prototype.selectItem_=function(e,t){this.getElement()&&this.getRenderer().selectCell(this,e,t)},goog.ui.Palette.prototype.adjustSize_=function(){var e=this.getContent();e?this.size_&&this.size_.width?(e=Math.ceil(e.length/this.size_.width),(!goog.isNumber(this.size_.height)||this.size_.height<e)&&(this.size_.height=e)):(e=Math.ceil(Math.sqrt(e.length)),this.size_=new goog.math.Size(e,e)):this.size_=new goog.math.Size(0,0)},goog.ui.Palette.CurrentCell_=function(){goog.ui.Control.call(this,null),this.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0)},goog.inherits(goog.ui.Palette.CurrentCell_,goog.ui.Control),goog.ui.Palette.CurrentCell_.prototype.tryHighlight=function(e){return this.setHighlighted(e),this.isHighlighted()==e},goog.ui.ColorPalette=function(e,t,o){this.colors_=e||[],goog.ui.Palette.call(this,null,t||goog.ui.PaletteRenderer.getInstance(),o),this.setColors(this.colors_)},goog.inherits(goog.ui.ColorPalette,goog.ui.Palette),goog.tagUnsealableClass(goog.ui.ColorPalette),goog.ui.ColorPalette.prototype.normalizedColors_=null,goog.ui.ColorPalette.prototype.labels_=null,goog.ui.ColorPalette.prototype.getColors=function(){return this.colors_},goog.ui.ColorPalette.prototype.setColors=function(e,t){this.colors_=e,this.labels_=t||null,this.normalizedColors_=null,this.setContent(this.createColorNodes())},goog.ui.ColorPalette.prototype.getSelectedColor=function(){var e=this.getSelectedItem();return e?(e=goog.style.getStyle(e,"background-color"),goog.ui.ColorPalette.parseColor_(e)):null},goog.ui.ColorPalette.prototype.setSelectedColor=function(e){e=goog.ui.ColorPalette.parseColor_(e),this.normalizedColors_||(this.normalizedColors_=goog.array.map(this.colors_,function(e){return goog.ui.ColorPalette.parseColor_(e)})),this.setSelectedIndex(e?goog.array.indexOf(this.normalizedColors_,e):-1)},goog.ui.ColorPalette.prototype.createColorNodes=function(){return goog.array.map(this.colors_,function(e,t){var o=this.getDomHelper().createDom("DIV",{class:this.getRenderer().getCssClass()+"-colorswatch",style:"background-color:"+e});return o.title=this.labels_&&this.labels_[t]?this.labels_[t]:"#"==e.charAt(0)?"RGB ("+goog.color.hexToRgb(e).join(", ")+")":e,o},this)},goog.ui.ColorPalette.parseColor_=function(e){if(e)try{return goog.color.parse(e).hex}catch(e){}return null},goog.ui.ColorPicker=function(e,t){goog.ui.Component.call(this,e),this.colorPalette_=t||null,this.getHandler().listen(this,goog.ui.Component.EventType.ACTION,this.onColorPaletteAction_)},goog.inherits(goog.ui.ColorPicker,goog.ui.Component),goog.ui.ColorPicker.DEFAULT_NUM_COLS=5,goog.ui.ColorPicker.EventType={CHANGE:"change"},goog.ui.ColorPicker.prototype.focusable_=!0,goog.ui.ColorPicker.prototype.getColors=function(){return this.colorPalette_?this.colorPalette_.getColors():null},goog.ui.ColorPicker.prototype.setColors=function(e){this.colorPalette_?this.colorPalette_.setColors(e):this.createColorPalette_(e)},goog.ui.ColorPicker.prototype.addColors=function(e){this.setColors(e)},goog.ui.ColorPicker.prototype.setSize=function(e){this.colorPalette_||this.createColorPalette_([]),this.colorPalette_.setSize(e)},goog.ui.ColorPicker.prototype.getSize=function(){return this.colorPalette_?this.colorPalette_.getSize():null},goog.ui.ColorPicker.prototype.setColumnCount=function(e){this.setSize(e)},goog.ui.ColorPicker.prototype.getSelectedIndex=function(){return this.colorPalette_?this.colorPalette_.getSelectedIndex():-1},goog.ui.ColorPicker.prototype.setSelectedIndex=function(e){this.colorPalette_&&this.colorPalette_.setSelectedIndex(e)},goog.ui.ColorPicker.prototype.getSelectedColor=function(){return this.colorPalette_?this.colorPalette_.getSelectedColor():null},goog.ui.ColorPicker.prototype.setSelectedColor=function(e){this.colorPalette_&&this.colorPalette_.setSelectedColor(e)},goog.ui.ColorPicker.prototype.isFocusable=function(){return this.focusable_},goog.ui.ColorPicker.prototype.setFocusable=function(e){this.focusable_=e,this.colorPalette_&&this.colorPalette_.setSupportedState(goog.ui.Component.State.FOCUSED,e)},goog.ui.ColorPicker.prototype.canDecorate=function(e){return!1},goog.ui.ColorPicker.prototype.enterDocument=function(){goog.ui.ColorPicker.superClass_.enterDocument.call(this),this.colorPalette_&&this.colorPalette_.render(this.getElement()),this.getElement().unselectable="on"},goog.ui.ColorPicker.prototype.disposeInternal=function(){goog.ui.ColorPicker.superClass_.disposeInternal.call(this),this.colorPalette_&&(this.colorPalette_.dispose(),this.colorPalette_=null)},goog.ui.ColorPicker.prototype.focus=function(){this.colorPalette_&&this.colorPalette_.getElement().focus()},goog.ui.ColorPicker.prototype.onColorPaletteAction_=function(e){e.stopPropagation(),this.dispatchEvent(goog.ui.ColorPicker.EventType.CHANGE)},goog.ui.ColorPicker.prototype.createColorPalette_=function(e){(e=new goog.ui.ColorPalette(e,null,this.getDomHelper())).setSize(goog.ui.ColorPicker.DEFAULT_NUM_COLS),e.setSupportedState(goog.ui.Component.State.FOCUSED,this.focusable_),this.addChild(e),this.colorPalette_=e,this.isInDocument()&&this.colorPalette_.render(this.getElement())},goog.ui.ColorPicker.createSimpleColorGrid=function(e){return(e=new goog.ui.ColorPicker(e)).setSize(7),e.setColors(goog.ui.ColorPicker.SIMPLE_GRID_COLORS),e},goog.ui.ColorPicker.SIMPLE_GRID_COLORS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),goog.events.FocusHandler=function(e){goog.events.EventTarget.call(this),this.element_=e,e=goog.userAgent.IE?"focusout":"blur",this.listenKeyIn_=goog.events.listen(this.element_,goog.userAgent.IE?"focusin":"focus",this,!goog.userAgent.IE),this.listenKeyOut_=goog.events.listen(this.element_,e,this,!goog.userAgent.IE)},goog.inherits(goog.events.FocusHandler,goog.events.EventTarget),goog.events.FocusHandler.EventType={FOCUSIN:"focusin",FOCUSOUT:"focusout"},goog.events.FocusHandler.prototype.handleEvent=function(e){var t=e.getBrowserEvent();(t=new goog.events.BrowserEvent(t)).type="focusin"==e.type||"focus"==e.type?goog.events.FocusHandler.EventType.FOCUSIN:goog.events.FocusHandler.EventType.FOCUSOUT,this.dispatchEvent(t)},goog.events.FocusHandler.prototype.disposeInternal=function(){goog.events.FocusHandler.superClass_.disposeInternal.call(this),goog.events.unlistenByKey(this.listenKeyIn_),goog.events.unlistenByKey(this.listenKeyOut_),delete this.element_},goog.debug.LogRecord=function(e,t,o,i,n){this.reset(e,t,o,i,n)},goog.debug.LogRecord.prototype.sequenceNumber_=0,goog.debug.LogRecord.prototype.exception_=null,goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS=!0,goog.debug.LogRecord.nextSequenceNumber_=0,goog.debug.LogRecord.prototype.reset=function(e,t,o,i,n){goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS&&(this.sequenceNumber_="number"==typeof n?n:goog.debug.LogRecord.nextSequenceNumber_++),this.time_=i||goog.now(),this.level_=e,this.msg_=t,this.loggerName_=o,delete this.exception_},goog.debug.LogRecord.prototype.getLoggerName=function(){return this.loggerName_},goog.debug.LogRecord.prototype.getException=function(){return this.exception_},goog.debug.LogRecord.prototype.setException=function(e){this.exception_=e},goog.debug.LogRecord.prototype.setLoggerName=function(e){this.loggerName_=e},goog.debug.LogRecord.prototype.getLevel=function(){return this.level_},goog.debug.LogRecord.prototype.setLevel=function(e){this.level_=e},goog.debug.LogRecord.prototype.getMessage=function(){return this.msg_},goog.debug.LogRecord.prototype.setMessage=function(e){this.msg_=e},goog.debug.LogRecord.prototype.getMillis=function(){return this.time_},goog.debug.LogRecord.prototype.setMillis=function(e){this.time_=e},goog.debug.LogRecord.prototype.getSequenceNumber=function(){return this.sequenceNumber_},goog.debug.LogBuffer=function(){goog.asserts.assert(goog.debug.LogBuffer.isBufferingEnabled(),"Cannot use goog.debug.LogBuffer without defining goog.debug.LogBuffer.CAPACITY."),this.clear()},goog.debug.LogBuffer.getInstance=function(){return goog.debug.LogBuffer.instance_||(goog.debug.LogBuffer.instance_=new goog.debug.LogBuffer),goog.debug.LogBuffer.instance_},goog.debug.LogBuffer.CAPACITY=0,goog.debug.LogBuffer.prototype.addRecord=function(e,t,o){var i=(this.curIndex_+1)%goog.debug.LogBuffer.CAPACITY;return this.curIndex_=i,this.isFull_?((i=this.buffer_[i]).reset(e,t,o),i):(this.isFull_=i==goog.debug.LogBuffer.CAPACITY-1,this.buffer_[i]=new goog.debug.LogRecord(e,t,o))},goog.debug.LogBuffer.isBufferingEnabled=function(){return 0<goog.debug.LogBuffer.CAPACITY},goog.debug.LogBuffer.prototype.clear=function(){this.buffer_=Array(goog.debug.LogBuffer.CAPACITY),this.curIndex_=-1,this.isFull_=!1},goog.debug.LogBuffer.prototype.forEachRecord=function(e){var t=this.buffer_;if(t[0]){var o=this.curIndex_,i=this.isFull_?o:-1;do{e(t[i=(i+1)%goog.debug.LogBuffer.CAPACITY])}while(i!=o)}},goog.debug.Logger=function(e){this.name_=e,this.handlers_=this.children_=this.level_=this.parent_=null},goog.debug.Logger.ROOT_LOGGER_NAME="",goog.debug.Logger.ENABLE_HIERARCHY=!0,goog.debug.Logger.ENABLE_PROFILER_LOGGING=!1,goog.debug.Logger.ENABLE_HIERARCHY||(goog.debug.Logger.rootHandlers_=[]),goog.debug.Logger.Level=function(e,t){this.name=e,this.value=t},goog.debug.Logger.Level.prototype.toString=function(){return this.name},goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",1/0),goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200),goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1e3),goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900),goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800),goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700),goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500),goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400),goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300),goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0),goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL],goog.debug.Logger.Level.predefinedLevelsCache_=null,goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var e,t=0;e=goog.debug.Logger.Level.PREDEFINED_LEVELS[t];t++)goog.debug.Logger.Level.predefinedLevelsCache_[e.value]=e,goog.debug.Logger.Level.predefinedLevelsCache_[e.name]=e},goog.debug.Logger.Level.getPredefinedLevel=function(e){return goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_(),goog.debug.Logger.Level.predefinedLevelsCache_[e]||null},goog.debug.Logger.Level.getPredefinedLevelByValue=function(e){if(goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_(),e in goog.debug.Logger.Level.predefinedLevelsCache_)return goog.debug.Logger.Level.predefinedLevelsCache_[e];for(var t=0;t<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++t){var o=goog.debug.Logger.Level.PREDEFINED_LEVELS[t];if(o.value<=e)return o}return null},goog.debug.Logger.getLogger=function(e){return goog.debug.LogManager.getLogger(e)},goog.debug.Logger.logToProfilers=function(e){if(goog.debug.Logger.ENABLE_PROFILER_LOGGING){var t=goog.global.msWriteProfilerMark;t?t(e):(t=goog.global.console)&&t.timeStamp&&t.timeStamp(e)}},goog.debug.Logger.prototype.getName=function(){return this.name_},goog.debug.Logger.prototype.addHandler=function(e){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?(this.handlers_||(this.handlers_=[]),this.handlers_.push(e)):(goog.asserts.assert(!this.name_,"Cannot call addHandler on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootHandlers_.push(e)))},goog.debug.Logger.prototype.removeHandler=function(e){if(goog.debug.LOGGING_ENABLED){var t=goog.debug.Logger.ENABLE_HIERARCHY?this.handlers_:goog.debug.Logger.rootHandlers_;return!!t&&goog.array.remove(t,e)}return!1},goog.debug.Logger.prototype.getParent=function(){return this.parent_},goog.debug.Logger.prototype.getChildren=function(){return this.children_||(this.children_={}),this.children_},goog.debug.Logger.prototype.setLevel=function(e){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?this.level_=e:(goog.asserts.assert(!this.name_,"Cannot call setLevel() on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootLevel_=e))},goog.debug.Logger.prototype.getLevel=function(){return goog.debug.LOGGING_ENABLED?this.level_:goog.debug.Logger.Level.OFF},goog.debug.Logger.prototype.getEffectiveLevel=function(){return goog.debug.LOGGING_ENABLED?goog.debug.Logger.ENABLE_HIERARCHY?this.level_?this.level_:this.parent_?this.parent_.getEffectiveLevel():(goog.asserts.fail("Root logger has no level set."),null):goog.debug.Logger.rootLevel_:goog.debug.Logger.Level.OFF},goog.debug.Logger.prototype.isLoggable=function(e){return goog.debug.LOGGING_ENABLED&&e.value>=this.getEffectiveLevel().value},goog.debug.Logger.prototype.log=function(e,t,o){goog.debug.LOGGING_ENABLED&&this.isLoggable(e)&&(goog.isFunction(t)&&(t=t()),this.doLogRecord_(this.getLogRecord(e,t,o)))},goog.debug.Logger.prototype.getLogRecord=function(e,t,o){return e=goog.debug.LogBuffer.isBufferingEnabled()?goog.debug.LogBuffer.getInstance().addRecord(e,t,this.name_):new goog.debug.LogRecord(e,String(t),this.name_),o&&e.setException(o),e},goog.debug.Logger.prototype.shout=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SHOUT,e,t)},goog.debug.Logger.prototype.severe=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SEVERE,e,t)},goog.debug.Logger.prototype.warning=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.WARNING,e,t)},goog.debug.Logger.prototype.info=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.INFO,e,t)},goog.debug.Logger.prototype.config=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.CONFIG,e,t)},goog.debug.Logger.prototype.fine=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINE,e,t)},goog.debug.Logger.prototype.finer=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINER,e,t)},goog.debug.Logger.prototype.finest=function(e,t){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINEST,e,t)},goog.debug.Logger.prototype.logRecord=function(e){goog.debug.LOGGING_ENABLED&&this.isLoggable(e.getLevel())&&this.doLogRecord_(e)},goog.debug.Logger.prototype.doLogRecord_=function(e){if(goog.debug.Logger.ENABLE_PROFILER_LOGGING&&goog.debug.Logger.logToProfilers("log:"+e.getMessage()),goog.debug.Logger.ENABLE_HIERARCHY)for(var t=this;t;)t.callPublish_(e),t=t.getParent();else{t=0;for(var o;o=goog.debug.Logger.rootHandlers_[t++];)o(e)}},goog.debug.Logger.prototype.callPublish_=function(e){if(this.handlers_)for(var t,o=0;t=this.handlers_[o];o++)t(e)},goog.debug.Logger.prototype.setParent_=function(e){this.parent_=e},goog.debug.Logger.prototype.addChild_=function(e,t){this.getChildren()[e]=t},goog.debug.LogManager={},goog.debug.LogManager.loggers_={},goog.debug.LogManager.rootLogger_=null,goog.debug.LogManager.initialize=function(){goog.debug.LogManager.rootLogger_||(goog.debug.LogManager.rootLogger_=new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME),goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME]=goog.debug.LogManager.rootLogger_,goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG))},goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_},goog.debug.LogManager.getRoot=function(){return goog.debug.LogManager.initialize(),goog.debug.LogManager.rootLogger_},goog.debug.LogManager.getLogger=function(e){return goog.debug.LogManager.initialize(),goog.debug.LogManager.loggers_[e]||goog.debug.LogManager.createLogger_(e)},goog.debug.LogManager.createFunctionForCatchErrors=function(e){return function(t){(e||goog.debug.LogManager.getRoot()).severe("Error: "+t.message+" ("+t.fileName+" @ Line: "+t.line+")")}},goog.debug.LogManager.createLogger_=function(e){var t=new goog.debug.Logger(e);if(goog.debug.Logger.ENABLE_HIERARCHY){var o=e.lastIndexOf("."),i=e.substr(0,o);o=e.substr(o+1),(i=goog.debug.LogManager.getLogger(i)).addChild_(o,t),t.setParent_(i)}return goog.debug.LogManager.loggers_[e]=t},goog.log={},goog.log.ENABLED=goog.debug.LOGGING_ENABLED,goog.log.ROOT_LOGGER_NAME=goog.debug.Logger.ROOT_LOGGER_NAME,goog.log.Logger=goog.debug.Logger,goog.log.Level=goog.debug.Logger.Level,goog.log.LogRecord=goog.debug.LogRecord,goog.log.getLogger=function(e,t){if(goog.log.ENABLED){var o=goog.debug.LogManager.getLogger(e);return t&&o&&o.setLevel(t),o}return null},goog.log.addHandler=function(e,t){goog.log.ENABLED&&e&&e.addHandler(t)},goog.log.removeHandler=function(e,t){return!(!goog.log.ENABLED||!e)&&e.removeHandler(t)},goog.log.log=function(e,t,o,i){goog.log.ENABLED&&e&&e.log(t,o,i)},goog.log.error=function(e,t,o){goog.log.ENABLED&&e&&e.severe(t,o)},goog.log.warning=function(e,t,o){goog.log.ENABLED&&e&&e.warning(t,o)},goog.log.info=function(e,t,o){goog.log.ENABLED&&e&&e.info(t,o)},goog.log.fine=function(e,t,o){goog.log.ENABLED&&e&&e.fine(t,o)},goog.string.StringBuffer=function(e,t){null!=e&&this.append.apply(this,arguments)},goog.string.StringBuffer.prototype.buffer_="",goog.string.StringBuffer.prototype.set=function(e){this.buffer_=""+e},goog.string.StringBuffer.prototype.append=function(e,t,o){if(this.buffer_+=String(e),null!=t)for(var i=1;i<arguments.length;i++)this.buffer_+=arguments[i];return this},goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""},goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length},goog.string.StringBuffer.prototype.toString=function(){return this.buffer_},goog.ui.tree={},goog.ui.tree.BaseNode=function(e,t,o){goog.ui.Component.call(this,o),this.config_=t||goog.ui.tree.BaseNode.defaultConfig,this.html_=goog.html.SafeHtml.htmlEscapePreservingNewlines(e),this.expanded_=this.selected_=!1,this.toolTip_=null,this.afterLabelHtml_=goog.html.SafeHtml.EMPTY,this.isUserCollapsible_=!0,this.depth_=-1},goog.inherits(goog.ui.tree.BaseNode,goog.ui.Component),goog.ui.tree.BaseNode.EventType={BEFORE_EXPAND:"beforeexpand",EXPAND:"expand",BEFORE_COLLAPSE:"beforecollapse",COLLAPSE:"collapse"},goog.ui.tree.BaseNode.allNodes={},goog.ui.tree.BaseNode.prototype.disposeInternal=function(){goog.ui.tree.BaseNode.superClass_.disposeInternal.call(this),this.tree&&(this.tree.removeNode(this),this.tree=null),this.setElementInternal(null)},goog.ui.tree.BaseNode.prototype.initAccessibility=function(){var e=this.getElement();if(e){var t=this.getLabelElement();if(t&&!t.id&&(t.id=this.getId()+".label"),goog.a11y.aria.setRole(e,"treeitem"),goog.a11y.aria.setState(e,"selected",!1),goog.a11y.aria.setState(e,"level",this.getDepth()),t&&goog.a11y.aria.setState(e,"labelledby",t.id),(t=this.getIconElement())&&goog.a11y.aria.setRole(t,"presentation"),(t=this.getExpandIconElement())&&goog.a11y.aria.setRole(t,"presentation"),(t=this.getChildrenElement())&&(goog.a11y.aria.setRole(t,"group"),t.hasChildNodes()))for(goog.a11y.aria.setState(e,goog.a11y.aria.State.EXPANDED,!1),e=this.getChildCount(),t=1;t<=e;t++){var o=this.getChildAt(t-1).getElement();goog.asserts.assert(o,"The child element cannot be null"),goog.a11y.aria.setState(o,"setsize",e),goog.a11y.aria.setState(o,"posinset",t)}}},goog.ui.tree.BaseNode.prototype.createDom=function(){var e=this.getDomHelper().safeHtmlToNode(this.toSafeHtml());this.setElementInternal(e)},goog.ui.tree.BaseNode.prototype.enterDocument=function(){goog.ui.tree.BaseNode.superClass_.enterDocument.call(this),goog.ui.tree.BaseNode.allNodes[this.getId()]=this,this.initAccessibility()},goog.ui.tree.BaseNode.prototype.exitDocument=function(){goog.ui.tree.BaseNode.superClass_.exitDocument.call(this),delete goog.ui.tree.BaseNode.allNodes[this.getId()]},goog.ui.tree.BaseNode.prototype.addChildAt=function(e,t,o){goog.asserts.assert(!e.getParent()),goog.asserts.assertInstanceof(e,goog.ui.tree.BaseNode),o=this.getChildAt(t-1);var i=this.getChildAt(t);if(goog.ui.tree.BaseNode.superClass_.addChildAt.call(this,e,t),e.previousSibling_=o,e.nextSibling_=i,o?o.nextSibling_=e:this.firstChild_=e,i?i.previousSibling_=e:this.lastChild_=e,(t=this.getTree())&&e.setTreeInternal(t),e.setDepth_(this.getDepth()+1),(t=this.getElement())&&(this.updateExpandIcon(),goog.a11y.aria.setState(t,goog.a11y.aria.State.EXPANDED,this.getExpanded()),this.getExpanded())){t=this.getChildrenElement(),e.getElement()||e.createDom();var n=e.getElement(),r=i&&i.getElement();t.insertBefore(n,r),this.isInDocument()&&e.enterDocument(),i||(o?o.updateExpandIcon():(goog.style.setElementShown(t,!0),this.setExpanded(this.getExpanded())))}},goog.ui.tree.BaseNode.prototype.add=function(e,t){return goog.asserts.assert(!t||t.getParent()==this,"Can only add nodes before siblings"),e.getParent()&&e.getParent().removeChild(e),this.addChildAt(e,t?this.indexOfChild(t):this.getChildCount()),e},goog.ui.tree.BaseNode.prototype.removeChild=function(e,t){var o=this.getTree(),i=o?o.getSelectedItem():null;if((i==e||e.contains(i))&&(o.hasFocus()?(this.select(),goog.Timer.callOnce(this.onTimeoutSelect_,10,this)):this.select()),goog.ui.tree.BaseNode.superClass_.removeChild.call(this,e),this.lastChild_==e&&(this.lastChild_=e.previousSibling_),this.firstChild_==e&&(this.firstChild_=e.nextSibling_),e.previousSibling_&&(e.previousSibling_.nextSibling_=e.nextSibling_),e.nextSibling_&&(e.nextSibling_.previousSibling_=e.previousSibling_),i=e.isLastSibling(),e.tree=null,e.depth_=-1,o&&(o.removeNode(e),this.isInDocument())){if(o=this.getChildrenElement(),e.isInDocument()){var n=e.getElement();o.removeChild(n),e.exitDocument()}i&&(i=this.getLastChild())&&i.updateExpandIcon(),this.hasChildren()||(o.style.display="none",this.updateExpandIcon(),this.updateIcon_(),(i=this.getElement())&&goog.a11y.aria.removeState(i,goog.a11y.aria.State.EXPANDED))}return e},goog.ui.tree.BaseNode.prototype.remove=goog.ui.tree.BaseNode.prototype.removeChild,goog.ui.tree.BaseNode.prototype.onTimeoutSelect_=function(){this.select()},goog.ui.tree.BaseNode.prototype.getTree=goog.abstractMethod,goog.ui.tree.BaseNode.prototype.getDepth=function(){var e=this.depth_;return 0>e&&(e=this.computeDepth_(),this.setDepth_(e)),e},goog.ui.tree.BaseNode.prototype.computeDepth_=function(){var e=this.getParent();return e?e.getDepth()+1:0},goog.ui.tree.BaseNode.prototype.setDepth_=function(e){if(e!=this.depth_){this.depth_=e;var t=this.getRowElement();if(t){var o=this.getPixelIndent_()+"px";this.isRightToLeft()?t.style.paddingRight=o:t.style.paddingLeft=o}this.forEachChild(function(t){t.setDepth_(e+1)})}},goog.ui.tree.BaseNode.prototype.contains=function(e){for(;e;){if(e==this)return!0;e=e.getParent()}return!1},goog.ui.tree.BaseNode.EMPTY_CHILDREN_=[],goog.ui.tree.BaseNode.prototype.getChildren=function(){var e=[];return this.forEachChild(function(t){e.push(t)}),e},goog.ui.tree.BaseNode.prototype.getFirstChild=function(){return this.getChildAt(0)},goog.ui.tree.BaseNode.prototype.getLastChild=function(){return this.getChildAt(this.getChildCount()-1)},goog.ui.tree.BaseNode.prototype.getPreviousSibling=function(){return this.previousSibling_},goog.ui.tree.BaseNode.prototype.getNextSibling=function(){return this.nextSibling_},goog.ui.tree.BaseNode.prototype.isLastSibling=function(){return!this.nextSibling_},goog.ui.tree.BaseNode.prototype.isSelected=function(){return this.selected_},goog.ui.tree.BaseNode.prototype.select=function(){var e=this.getTree();e&&e.setSelectedItem(this)},goog.ui.tree.BaseNode.prototype.deselect=goog.nullFunction,goog.ui.tree.BaseNode.prototype.setSelectedInternal=function(e){if(this.selected_!=e){this.selected_=e,this.updateRow();var t=this.getElement();t&&(goog.a11y.aria.setState(t,"selected",e),e&&(e=this.getTree().getElement(),goog.asserts.assert(e,"The DOM element for the tree cannot be null"),goog.a11y.aria.setState(e,"activedescendant",this.getId())))}},goog.ui.tree.BaseNode.prototype.getExpanded=function(){return this.expanded_},goog.ui.tree.BaseNode.prototype.setExpandedInternal=function(e){this.expanded_=e},goog.ui.tree.BaseNode.prototype.setExpanded=function(e){var t=e!=this.expanded_;if(!t||this.dispatchEvent(e?goog.ui.tree.BaseNode.EventType.BEFORE_EXPAND:goog.ui.tree.BaseNode.EventType.BEFORE_COLLAPSE)){this.expanded_=e;var o=this.getTree(),i=this.getElement();if(this.hasChildren()){if(!e&&o&&this.contains(o.getSelectedItem())&&this.select(),i){if((o=this.getChildrenElement())&&(goog.style.setElementShown(o,e),goog.a11y.aria.setState(i,goog.a11y.aria.State.EXPANDED,e),e&&this.isInDocument()&&!o.hasChildNodes())){var n=[];this.forEachChild(function(e){n.push(e.toSafeHtml())}),goog.dom.safe.setInnerHtml(o,goog.html.SafeHtml.concat(n)),this.forEachChild(function(e){e.enterDocument()})}this.updateExpandIcon()}}else(o=this.getChildrenElement())&&goog.style.setElementShown(o,!1);i&&this.updateIcon_(),t&&this.dispatchEvent(e?goog.ui.tree.BaseNode.EventType.EXPAND:goog.ui.tree.BaseNode.EventType.COLLAPSE)}},goog.ui.tree.BaseNode.prototype.toggle=function(){this.setExpanded(!this.getExpanded())},goog.ui.tree.BaseNode.prototype.expand=function(){this.setExpanded(!0)},goog.ui.tree.BaseNode.prototype.collapse=function(){this.setExpanded(!1)},goog.ui.tree.BaseNode.prototype.collapseChildren=function(){this.forEachChild(function(e){e.collapseAll()})},goog.ui.tree.BaseNode.prototype.collapseAll=function(){this.collapseChildren(),this.collapse()},goog.ui.tree.BaseNode.prototype.expandChildren=function(){this.forEachChild(function(e){e.expandAll()})},goog.ui.tree.BaseNode.prototype.expandAll=function(){this.expandChildren(),this.expand()},goog.ui.tree.BaseNode.prototype.reveal=function(){var e=this.getParent();e&&(e.setExpanded(!0),e.reveal())},goog.ui.tree.BaseNode.prototype.setIsUserCollapsible=function(e){(this.isUserCollapsible_=e)||this.expand(),this.getElement()&&this.updateExpandIcon()},goog.ui.tree.BaseNode.prototype.isUserCollapsible=function(){return this.isUserCollapsible_},goog.ui.tree.BaseNode.prototype.toSafeHtml=function(){var e=this.getTree(),t=!e.getShowLines()||e==this.getParent()&&!e.getShowRootLines()?this.config_.cssChildrenNoLines:this.config_.cssChildren;e=this.getExpanded()&&this.hasChildren(),t={class:t,style:this.getLineStyle()};var o=[];return e&&this.forEachChild(function(e){o.push(e.toSafeHtml())}),e=goog.html.SafeHtml.create("div",t,o),goog.html.SafeHtml.create("div",{class:this.config_.cssItem,id:this.getId()},[this.getRowSafeHtml(),e])},goog.ui.tree.BaseNode.prototype.getPixelIndent_=function(){return Math.max(0,(this.getDepth()-1)*this.config_.indentWidth)},goog.ui.tree.BaseNode.prototype.getRowSafeHtml=function(){var e={};e["padding-"+(this.isRightToLeft()?"right":"left")]=this.getPixelIndent_()+"px",e={class:this.getRowClassName(),style:e};var t=[this.getExpandIconSafeHtml(),this.getIconSafeHtml(),this.getLabelSafeHtml()];return goog.html.SafeHtml.create("div",e,t)},goog.ui.tree.BaseNode.prototype.getRowClassName=function(){var e=this.isSelected()?" "+this.config_.cssSelectedRow:"";return this.config_.cssTreeRow+e},goog.ui.tree.BaseNode.prototype.getLabelSafeHtml=function(){var e=goog.html.SafeHtml.create("span",{class:this.config_.cssItemLabel,title:this.getToolTip()||null},this.getSafeHtml());return goog.html.SafeHtml.concat(e,goog.html.SafeHtml.create("span",{},this.getAfterLabelSafeHtml()))},goog.ui.tree.BaseNode.prototype.getAfterLabelHtml=function(){return goog.html.SafeHtml.unwrap(this.getAfterLabelSafeHtml())},goog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml=function(){return this.afterLabelHtml_},goog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml=function(e){this.afterLabelHtml_=e;var t=this.getAfterLabelElement();t&&goog.dom.safe.setInnerHtml(t,e)},goog.ui.tree.BaseNode.prototype.getIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{style:{display:"inline-block"},class:this.getCalculatedIconClass()})},goog.ui.tree.BaseNode.prototype.getCalculatedIconClass=goog.abstractMethod,goog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{type:"expand",style:{display:"inline-block"},class:this.getExpandIconClass()})},goog.ui.tree.BaseNode.prototype.getExpandIconClass=function(){var e=this.getTree(),t=!e.getShowLines()||e==this.getParent()&&!e.getShowRootLines(),o=this.config_,i=new goog.string.StringBuffer;if(i.append(o.cssTreeIcon," ",o.cssExpandTreeIcon," "),this.hasChildren()){var n=0;switch(e.getShowExpandIcons()&&this.isUserCollapsible_&&(n=this.getExpanded()?2:1),t||(n=this.isLastSibling()?n+4:n+8),n){case 1:i.append(o.cssExpandTreeIconPlus);break;case 2:i.append(o.cssExpandTreeIconMinus);break;case 4:i.append(o.cssExpandTreeIconL);break;case 5:i.append(o.cssExpandTreeIconLPlus);break;case 6:i.append(o.cssExpandTreeIconLMinus);break;case 8:i.append(o.cssExpandTreeIconT);break;case 9:i.append(o.cssExpandTreeIconTPlus);break;case 10:i.append(o.cssExpandTreeIconTMinus);break;default:i.append(o.cssExpandTreeIconBlank)}}else t?i.append(o.cssExpandTreeIconBlank):this.isLastSibling()?i.append(o.cssExpandTreeIconL):i.append(o.cssExpandTreeIconT);return i.toString()},goog.ui.tree.BaseNode.prototype.getLineStyle=function(){var e=this.getExpanded()&&this.hasChildren();return goog.html.SafeStyle.create({"background-position":this.getBackgroundPosition(),display:e?null:"none"})},goog.ui.tree.BaseNode.prototype.getBackgroundPosition=function(){return(this.isLastSibling()?"-100":(this.getDepth()-1)*this.config_.indentWidth)+"px 0"},goog.ui.tree.BaseNode.prototype.getElement=function(){var e=goog.ui.tree.BaseNode.superClass_.getElement.call(this);return e||(e=this.getDomHelper().getElement(this.getId()),this.setElementInternal(e)),e},goog.ui.tree.BaseNode.prototype.getRowElement=function(){var e=this.getElement();return e?e.firstChild:null},goog.ui.tree.BaseNode.prototype.getExpandIconElement=function(){var e=this.getRowElement();return e?e.firstChild:null},goog.ui.tree.BaseNode.prototype.getIconElement=function(){var e=this.getRowElement();return e?e.childNodes[1]:null},goog.ui.tree.BaseNode.prototype.getLabelElement=function(){var e=this.getRowElement();return e&&e.lastChild?e.lastChild.previousSibling:null},goog.ui.tree.BaseNode.prototype.getAfterLabelElement=function(){var e=this.getRowElement();return e?e.lastChild:null},goog.ui.tree.BaseNode.prototype.getChildrenElement=function(){var e=this.getElement();return e?e.lastChild:null},goog.ui.tree.BaseNode.prototype.setIconClass=function(e){this.iconClass_=e,this.isInDocument()&&this.updateIcon_()};goog.ui.tree.BaseNode.prototype.getIconClass=function(){return this.iconClass_},goog.ui.tree.BaseNode.prototype.setExpandedIconClass=function(e){this.expandedIconClass_=e,this.isInDocument()&&this.updateIcon_()},goog.ui.tree.BaseNode.prototype.getExpandedIconClass=function(){return this.expandedIconClass_},goog.ui.tree.BaseNode.prototype.setText=function(e){this.setSafeHtml(goog.html.SafeHtml.htmlEscape(e))},goog.ui.tree.BaseNode.prototype.getText=function(){return goog.string.unescapeEntities(goog.html.SafeHtml.unwrap(this.html_))},goog.ui.tree.BaseNode.prototype.setSafeHtml=function(e){this.html_=e;var t=this.getLabelElement();t&&goog.dom.safe.setInnerHtml(t,e),(e=this.getTree())&&e.setNode(this)},goog.ui.tree.BaseNode.prototype.getHtml=function(){return goog.html.SafeHtml.unwrap(this.getSafeHtml())},goog.ui.tree.BaseNode.prototype.getSafeHtml=function(){return this.html_},goog.ui.tree.BaseNode.prototype.setToolTip=function(e){this.toolTip_=e;var t=this.getLabelElement();t&&(t.title=e)},goog.ui.tree.BaseNode.prototype.getToolTip=function(){return this.toolTip_},goog.ui.tree.BaseNode.prototype.updateRow=function(){var e=this.getRowElement();e&&(e.className=this.getRowClassName())},goog.ui.tree.BaseNode.prototype.updateExpandIcon=function(){var e=this.getExpandIconElement();e&&(e.className=this.getExpandIconClass()),(e=this.getChildrenElement())&&(e.style.backgroundPosition=this.getBackgroundPosition())},goog.ui.tree.BaseNode.prototype.updateIcon_=function(){this.getIconElement().className=this.getCalculatedIconClass()},goog.ui.tree.BaseNode.prototype.onMouseDown=function(e){"expand"==e.target.getAttribute("type")&&this.hasChildren()?this.isUserCollapsible_&&this.toggle():(this.select(),this.updateRow())},goog.ui.tree.BaseNode.prototype.onClick_=goog.events.Event.preventDefault,goog.ui.tree.BaseNode.prototype.onDoubleClick_=function(e){"expand"==e.target.getAttribute("type")&&this.hasChildren()||this.isUserCollapsible_&&this.toggle()},goog.ui.tree.BaseNode.prototype.onKeyDown=function(e){var t=!0;switch(e.keyCode){case goog.events.KeyCodes.RIGHT:if(e.altKey)break;this.hasChildren()&&(this.getExpanded()?this.getFirstChild().select():this.setExpanded(!0));break;case goog.events.KeyCodes.LEFT:if(e.altKey)break;if(this.hasChildren()&&this.getExpanded()&&this.isUserCollapsible_)this.setExpanded(!1);else{var o=this.getParent(),i=this.getTree();o&&(i.getShowRootNode()||o!=i)&&o.select()}break;case goog.events.KeyCodes.DOWN:(o=this.getNextShownNode())&&o.select();break;case goog.events.KeyCodes.UP:(o=this.getPreviousShownNode())&&o.select();break;default:t=!1}return t&&(e.preventDefault(),(i=this.getTree())&&i.clearTypeAhead()),t},goog.ui.tree.BaseNode.prototype.getLastShownDescendant=function(){return this.getExpanded()&&this.hasChildren()?this.getLastChild().getLastShownDescendant():this},goog.ui.tree.BaseNode.prototype.getNextShownNode=function(){if(this.hasChildren()&&this.getExpanded())return this.getFirstChild();for(var e,t=this;t!=this.getTree();){if(null!=(e=t.getNextSibling()))return e;t=t.getParent()}return null},goog.ui.tree.BaseNode.prototype.getPreviousShownNode=function(){var e=this.getPreviousSibling();if(null!=e)return e.getLastShownDescendant();e=this.getParent();var t=this.getTree();return!t.getShowRootNode()&&e==t||this==t?null:e},goog.ui.tree.BaseNode.prototype.getClientData=goog.ui.tree.BaseNode.prototype.getModel,goog.ui.tree.BaseNode.prototype.setClientData=goog.ui.tree.BaseNode.prototype.setModel,goog.ui.tree.BaseNode.prototype.getConfig=function(){return this.config_},goog.ui.tree.BaseNode.prototype.setTreeInternal=function(e){this.tree!=e&&(this.tree=e,e.setNode(this),this.forEachChild(function(t){t.setTreeInternal(e)}))},goog.ui.tree.BaseNode.defaultConfig={indentWidth:19,cssRoot:"goog-tree-root goog-tree-item",cssHideRoot:"goog-tree-hide-root",cssItem:"goog-tree-item",cssChildren:"goog-tree-children",cssChildrenNoLines:"goog-tree-children-nolines",cssTreeRow:"goog-tree-row",cssItemLabel:"goog-tree-item-label",cssTreeIcon:"goog-tree-icon",cssExpandTreeIcon:"goog-tree-expand-icon",cssExpandTreeIconPlus:"goog-tree-expand-icon-plus",cssExpandTreeIconMinus:"goog-tree-expand-icon-minus",cssExpandTreeIconTPlus:"goog-tree-expand-icon-tplus",cssExpandTreeIconTMinus:"goog-tree-expand-icon-tminus",cssExpandTreeIconLPlus:"goog-tree-expand-icon-lplus",cssExpandTreeIconLMinus:"goog-tree-expand-icon-lminus",cssExpandTreeIconT:"goog-tree-expand-icon-t",cssExpandTreeIconL:"goog-tree-expand-icon-l",cssExpandTreeIconBlank:"goog-tree-expand-icon-blank",cssExpandedFolderIcon:"goog-tree-expanded-folder-icon",cssCollapsedFolderIcon:"goog-tree-collapsed-folder-icon",cssFileIcon:"goog-tree-file-icon",cssExpandedRootIcon:"goog-tree-expanded-folder-icon",cssCollapsedRootIcon:"goog-tree-collapsed-folder-icon",cssSelectedRow:"selected"},goog.ui.tree.TreeNode=function(e,t,o){goog.ui.tree.BaseNode.call(this,e,t,o)},goog.inherits(goog.ui.tree.TreeNode,goog.ui.tree.BaseNode),goog.ui.tree.TreeNode.prototype.getTree=function(){if(this.tree)return this.tree;var e=this.getParent();return e&&(e=e.getTree())?(this.setTreeInternal(e),e):null},goog.ui.tree.TreeNode.prototype.getCalculatedIconClass=function(){var e=this.getExpanded(),t=this.getExpandedIconClass();if(e&&t)return t;if(t=this.getIconClass(),!e&&t)return t;if(t=this.getConfig(),this.hasChildren()){if(e&&t.cssExpandedFolderIcon)return t.cssTreeIcon+" "+t.cssExpandedFolderIcon;if(!e&&t.cssCollapsedFolderIcon)return t.cssTreeIcon+" "+t.cssCollapsedFolderIcon}else if(t.cssFileIcon)return t.cssTreeIcon+" "+t.cssFileIcon;return""},goog.structs={},goog.structs.getCount=function(e){return e.getCount&&"function"==typeof e.getCount?e.getCount():goog.isArrayLike(e)||goog.isString(e)?e.length:goog.object.getCount(e)},goog.structs.getValues=function(e){if(e.getValues&&"function"==typeof e.getValues)return e.getValues();if(goog.isString(e))return e.split("");if(goog.isArrayLike(e)){for(var t=[],o=e.length,i=0;i<o;i++)t.push(e[i]);return t}return goog.object.getValues(e)},goog.structs.getKeys=function(e){if(e.getKeys&&"function"==typeof e.getKeys)return e.getKeys();if(!e.getValues||"function"!=typeof e.getValues){if(goog.isArrayLike(e)||goog.isString(e)){var t=[];e=e.length;for(var o=0;o<e;o++)t.push(o);return t}return goog.object.getKeys(e)}},goog.structs.contains=function(e,t){return e.contains&&"function"==typeof e.contains?e.contains(t):e.containsValue&&"function"==typeof e.containsValue?e.containsValue(t):goog.isArrayLike(e)||goog.isString(e)?goog.array.contains(e,t):goog.object.containsValue(e,t)},goog.structs.isEmpty=function(e){return e.isEmpty&&"function"==typeof e.isEmpty?e.isEmpty():goog.isArrayLike(e)||goog.isString(e)?goog.array.isEmpty(e):goog.object.isEmpty(e)},goog.structs.clear=function(e){e.clear&&"function"==typeof e.clear?e.clear():goog.isArrayLike(e)?goog.array.clear(e):goog.object.clear(e)},goog.structs.forEach=function(e,t,o){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,o);else if(goog.isArrayLike(e)||goog.isString(e))goog.array.forEach(e,t,o);else for(var i=goog.structs.getKeys(e),n=goog.structs.getValues(e),r=n.length,s=0;s<r;s++)t.call(o,n[s],i&&i[s],e)},goog.structs.filter=function(e,t,o){if("function"==typeof e.filter)return e.filter(t,o);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.filter(e,t,o);var i=goog.structs.getKeys(e),n=goog.structs.getValues(e),r=n.length;if(i)for(var s={},a=0;a<r;a++)t.call(o,n[a],i[a],e)&&(s[i[a]]=n[a]);else for(s=[],a=0;a<r;a++)t.call(o,n[a],void 0,e)&&s.push(n[a]);return s},goog.structs.map=function(e,t,o){if("function"==typeof e.map)return e.map(t,o);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.map(e,t,o);var i=goog.structs.getKeys(e),n=goog.structs.getValues(e),r=n.length;if(i)for(var s={},a=0;a<r;a++)s[i[a]]=t.call(o,n[a],i[a],e);else for(s=[],a=0;a<r;a++)s[a]=t.call(o,n[a],void 0,e);return s},goog.structs.some=function(e,t,o){if("function"==typeof e.some)return e.some(t,o);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.some(e,t,o);for(var i=goog.structs.getKeys(e),n=goog.structs.getValues(e),r=n.length,s=0;s<r;s++)if(t.call(o,n[s],i&&i[s],e))return!0;return!1},goog.structs.every=function(e,t,o){if("function"==typeof e.every)return e.every(t,o);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.every(e,t,o);for(var i=goog.structs.getKeys(e),n=goog.structs.getValues(e),r=n.length,s=0;s<r;s++)if(!t.call(o,n[s],i&&i[s],e))return!1;return!0},goog.structs.Trie=function(e){this.value_=void 0,this.childNodes_={},e&&this.setAll(e)},goog.structs.Trie.prototype.set=function(e,t){this.setOrAdd_(e,t,!1)},goog.structs.Trie.prototype.add=function(e,t){this.setOrAdd_(e,t,!0)},goog.structs.Trie.prototype.setOrAdd_=function(e,t,o){for(var i=this,n=0;n<e.length;n++){var r=e.charAt(n);i.childNodes_[r]||(i.childNodes_[r]=new goog.structs.Trie),i=i.childNodes_[r]}if(o&&void 0!==i.value_)throw Error('The collection already contains the key "'+e+'"');i.value_=t},goog.structs.Trie.prototype.setAll=function(e){var t=goog.structs.getKeys(e);e=goog.structs.getValues(e);for(var o=0;o<t.length;o++)this.set(t[o],e[o])},goog.structs.Trie.prototype.getChildNode_=function(e){for(var t=this,o=0;o<e.length;o++){var i=e.charAt(o);if(!(t=t.childNodes_[i]))return}return t},goog.structs.Trie.prototype.get=function(e){return(e=this.getChildNode_(e))?e.value_:void 0},goog.structs.Trie.prototype.getKeyAndPrefixes=function(e,t){var o=this,i={},n=t||0;for(void 0!==o.value_&&(i[n]=o.value_);n<e.length;n++){var r=e.charAt(n);if(!(r in o.childNodes_))break;void 0!==(o=o.childNodes_[r]).value_&&(i[n]=o.value_)}return i},goog.structs.Trie.prototype.getValues=function(){var e=[];return this.getValuesInternal_(e),e},goog.structs.Trie.prototype.getValuesInternal_=function(e){for(var t in void 0!==this.value_&&e.push(this.value_),this.childNodes_)this.childNodes_[t].getValuesInternal_(e)},goog.structs.Trie.prototype.getKeys=function(e){var t=[];if(e){for(var o=this,i=0;i<e.length;i++){var n=e.charAt(i);if(!o.childNodes_[n])return[];o=o.childNodes_[n]}o.getKeysInternal_(e,t)}else this.getKeysInternal_("",t);return t},goog.structs.Trie.prototype.getKeysInternal_=function(e,t){for(var o in void 0!==this.value_&&t.push(e),this.childNodes_)this.childNodes_[o].getKeysInternal_(e+o,t)},goog.structs.Trie.prototype.containsKey=function(e){return void 0!==this.get(e)},goog.structs.Trie.prototype.containsPrefix=function(e){return 0==e.length?!this.isEmpty():!!this.getChildNode_(e)},goog.structs.Trie.prototype.containsValue=function(e){if(this.value_===e)return!0;for(var t in this.childNodes_)if(this.childNodes_[t].containsValue(e))return!0;return!1},goog.structs.Trie.prototype.clear=function(){this.childNodes_={},this.value_=void 0},goog.structs.Trie.prototype.remove=function(e){for(var t=this,o=[],i=0;i<e.length;i++){var n=e.charAt(i);if(!t.childNodes_[n])throw Error('The collection does not have the key "'+e+'"');o.push([t,n]),t=t.childNodes_[n]}for(e=t.value_,delete t.value_;0<o.length&&(t=(n=o.pop())[0],n=n[1],t.childNodes_[n].isEmpty());)delete t.childNodes_[n];return e},goog.structs.Trie.prototype.clone=function(){return new goog.structs.Trie(this)},goog.structs.Trie.prototype.getCount=function(){return goog.structs.getCount(this.getValues())},goog.structs.Trie.prototype.isEmpty=function(){return void 0===this.value_&&goog.object.isEmpty(this.childNodes_)},goog.ui.tree.TypeAhead=function(){this.nodeMap_=new goog.structs.Trie,this.buffer_="",this.matchingNodes_=this.matchingLabels_=null,this.matchingNodeIndex_=this.matchingLabelIndex_=0},goog.ui.tree.TypeAhead.Offset={DOWN:1,UP:-1},goog.ui.tree.TypeAhead.prototype.handleNavigation=function(e){var t=!1;switch(e.keyCode){case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.UP:e.ctrlKey&&(this.jumpTo_(e.keyCode==goog.events.KeyCodes.DOWN?goog.ui.tree.TypeAhead.Offset.DOWN:goog.ui.tree.TypeAhead.Offset.UP),t=!0);break;case goog.events.KeyCodes.BACKSPACE:t=!0,0<(e=this.buffer_.length-1)?(this.buffer_=this.buffer_.substring(0,e),this.jumpToLabel_(this.buffer_)):0==e?this.buffer_="":t=!1;break;case goog.events.KeyCodes.ESC:this.buffer_="",t=!0}return t},goog.ui.tree.TypeAhead.prototype.handleTypeAheadChar=function(e){var t=!1;return e.ctrlKey||e.altKey||(e=String.fromCharCode(e.charCode||e.keyCode).toLowerCase(),goog.string.isUnicodeChar(e)&&(" "!=e||this.buffer_)&&(this.buffer_+=e,t=this.jumpToLabel_(this.buffer_))),t},goog.ui.tree.TypeAhead.prototype.setNodeInMap=function(e){var t=e.getText();if(t&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(t))){t=t.toLowerCase();var o=this.nodeMap_.get(t);o?o.push(e):this.nodeMap_.set(t,[e])}},goog.ui.tree.TypeAhead.prototype.removeNodeFromMap=function(e){var t=e.getText();if(t&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(t))){t=t.toLowerCase();var o=this.nodeMap_.get(t);if(o){for(var i=e.getChildCount(),n=0;n<i;n++)this.removeNodeFromMap(e.getChildAt(n));goog.array.remove(o,e),o.length||this.nodeMap_.remove(t)}}},goog.ui.tree.TypeAhead.prototype.jumpToLabel_=function(e){var t=!1;return(e=this.nodeMap_.getKeys(e))&&e.length&&(this.matchingLabelIndex_=this.matchingNodeIndex_=0,t=this.nodeMap_.get(e[0]),t=this.selectMatchingNode_(t))&&(this.matchingLabels_=e),t},goog.ui.tree.TypeAhead.prototype.jumpTo_=function(e){var t=!1,o=this.matchingLabels_;if(o){t=null;var i=!1;if(this.matchingNodes_){var n=this.matchingNodeIndex_+e;0<=n&&n<this.matchingNodes_.length?(this.matchingNodeIndex_=n,t=this.matchingNodes_):i=!0}t||(0<=(n=this.matchingLabelIndex_+e)&&n<o.length&&(this.matchingLabelIndex_=n),o.length>this.matchingLabelIndex_&&(t=this.nodeMap_.get(o[this.matchingLabelIndex_])),t&&t.length&&i&&(this.matchingNodeIndex_=e==goog.ui.tree.TypeAhead.Offset.UP?t.length-1:0)),(t=this.selectMatchingNode_(t))&&(this.matchingLabels_=o)}return t},goog.ui.tree.TypeAhead.prototype.selectMatchingNode_=function(e){if(e){if(this.matchingNodeIndex_<e.length){var t=e[this.matchingNodeIndex_];this.matchingNodes_=e}t&&(t.reveal(),t.select())}return!!t},goog.ui.tree.TypeAhead.prototype.clear=function(){this.buffer_=""},goog.ui.tree.TreeControl=function(e,t,o){if(goog.ui.tree.BaseNode.call(this,e,t,o),this.setExpandedInternal(!0),this.setSelectedInternal(!0),this.selectedItem_=this,this.typeAhead_=new goog.ui.tree.TypeAhead,this.focusHandler_=this.keyHandler_=null,this.logger_=goog.log.getLogger("this"),this.focused_=!1,this.focusedNode_=null,this.showRootLines_=this.showRootNode_=this.showExpandIcons_=this.showLines_=!0,goog.userAgent.IE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){goog.log.warning(this.logger_,"Failed to enable background image cache")}},goog.inherits(goog.ui.tree.TreeControl,goog.ui.tree.BaseNode),goog.ui.tree.TreeControl.prototype.getTree=function(){return this},goog.ui.tree.TreeControl.prototype.getDepth=function(){return 0},goog.ui.tree.TreeControl.prototype.reveal=function(){},goog.ui.tree.TreeControl.prototype.handleFocus_=function(e){this.focused_=!0,goog.dom.classlist.add(goog.asserts.assert(this.getElement()),"focused"),this.selectedItem_&&this.selectedItem_.select()},goog.ui.tree.TreeControl.prototype.handleBlur_=function(e){this.focused_=!1,goog.dom.classlist.remove(goog.asserts.assert(this.getElement()),"focused")},goog.ui.tree.TreeControl.prototype.hasFocus=function(){return this.focused_},goog.ui.tree.TreeControl.prototype.getExpanded=function(){return!this.showRootNode_||goog.ui.tree.TreeControl.superClass_.getExpanded.call(this)},goog.ui.tree.TreeControl.prototype.setExpanded=function(e){this.showRootNode_?goog.ui.tree.TreeControl.superClass_.setExpanded.call(this,e):this.setExpandedInternal(e)},goog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.EMPTY},goog.ui.tree.TreeControl.prototype.getIconElement=function(){var e=this.getRowElement();return e?e.firstChild:null},goog.ui.tree.TreeControl.prototype.getExpandIconElement=function(){return null},goog.ui.tree.TreeControl.prototype.updateExpandIcon=function(){},goog.ui.tree.TreeControl.prototype.getRowClassName=function(){return goog.ui.tree.TreeControl.superClass_.getRowClassName.call(this)+(this.showRootNode_?"":" "+this.getConfig().cssHideRoot)},goog.ui.tree.TreeControl.prototype.getCalculatedIconClass=function(){var e=this.getExpanded(),t=this.getExpandedIconClass();return e&&t?t:(t=this.getIconClass(),!e&&t?t:(t=this.getConfig(),e&&t.cssExpandedRootIcon?t.cssTreeIcon+" "+t.cssExpandedRootIcon:!e&&t.cssCollapsedRootIcon?t.cssTreeIcon+" "+t.cssCollapsedRootIcon:""))},goog.ui.tree.TreeControl.prototype.setSelectedItem=function(e){if(this.selectedItem_!=e){var t=!1;this.selectedItem_&&(t=this.selectedItem_==this.focusedNode_,this.selectedItem_.setSelectedInternal(!1)),(this.selectedItem_=e)&&(e.setSelectedInternal(!0),t&&e.select()),this.dispatchEvent(goog.events.EventType.CHANGE)}},goog.ui.tree.TreeControl.prototype.getSelectedItem=function(){return this.selectedItem_},goog.ui.tree.TreeControl.prototype.setShowLines=function(e){this.showLines_!=e&&(this.showLines_=e,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowLines=function(){return this.showLines_},goog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_=function(){var e=this,t=e.getShowLines(),o=e.getShowRootLines();!function i(n){var r=n.getChildrenElement();if(r){var s=!t||e==n.getParent()&&!o?n.getConfig().cssChildrenNoLines:n.getConfig().cssChildren;r.className=s,(r=n.getExpandIconElement())&&(r.className=n.getExpandIconClass())}n.forEachChild(i)}(this)},goog.ui.tree.TreeControl.prototype.setShowRootLines=function(e){this.showRootLines_!=e&&(this.showRootLines_=e,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowRootLines=function(){return this.showRootLines_},goog.ui.tree.TreeControl.prototype.setShowExpandIcons=function(e){this.showExpandIcons_!=e&&(this.showExpandIcons_=e,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowExpandIcons=function(){return this.showExpandIcons_},goog.ui.tree.TreeControl.prototype.setShowRootNode=function(e){if(this.showRootNode_!=e){if(this.showRootNode_=e,this.isInDocument()){var t=this.getRowElement();t&&(t.className=this.getRowClassName())}!e&&this.getSelectedItem()==this&&this.getFirstChild()&&this.setSelectedItem(this.getFirstChild())}},goog.ui.tree.TreeControl.prototype.getShowRootNode=function(){return this.showRootNode_},goog.ui.tree.TreeControl.prototype.initAccessibility=function(){goog.ui.tree.TreeControl.superClass_.initAccessibility.call(this);var e=this.getElement();goog.asserts.assert(e,"The DOM element for the tree cannot be null."),goog.a11y.aria.setRole(e,"tree"),goog.a11y.aria.setState(e,"labelledby",this.getLabelElement().id)},goog.ui.tree.TreeControl.prototype.enterDocument=function(){goog.ui.tree.TreeControl.superClass_.enterDocument.call(this);var e=this.getElement();e.className=this.getConfig().cssRoot,e.setAttribute("hideFocus","true"),this.attachEvents_(),this.initAccessibility()},goog.ui.tree.TreeControl.prototype.exitDocument=function(){goog.ui.tree.TreeControl.superClass_.exitDocument.call(this),this.detachEvents_()},goog.ui.tree.TreeControl.prototype.attachEvents_=function(){var e=this.getElement();e.tabIndex=0;var t=this.keyHandler_=new goog.events.KeyHandler(e),o=this.focusHandler_=new goog.events.FocusHandler(e);this.getHandler().listen(o,goog.events.FocusHandler.EventType.FOCUSOUT,this.handleBlur_).listen(o,goog.events.FocusHandler.EventType.FOCUSIN,this.handleFocus_).listen(t,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseEvent_).listen(e,goog.events.EventType.CLICK,this.handleMouseEvent_).listen(e,goog.events.EventType.DBLCLICK,this.handleMouseEvent_)},goog.ui.tree.TreeControl.prototype.detachEvents_=function(){this.keyHandler_.dispose(),this.keyHandler_=null,this.focusHandler_.dispose(),this.focusHandler_=null},goog.ui.tree.TreeControl.prototype.handleMouseEvent_=function(e){goog.log.fine(this.logger_,"Received event "+e.type);var t=this.getNodeFromEvent_(e);if(t)switch(e.type){case goog.events.EventType.MOUSEDOWN:t.onMouseDown(e);break;case goog.events.EventType.CLICK:t.onClick_(e);break;case goog.events.EventType.DBLCLICK:t.onDoubleClick_(e)}},goog.ui.tree.TreeControl.prototype.handleKeyEvent=function(e){var t;return(t=this.typeAhead_.handleNavigation(e)||this.selectedItem_&&this.selectedItem_.onKeyDown(e)||this.typeAhead_.handleTypeAheadChar(e))&&e.preventDefault(),t},goog.ui.tree.TreeControl.prototype.getNodeFromEvent_=function(e){for(var t=e.target;null!=t;){if(e=goog.ui.tree.BaseNode.allNodes[t.id])return e;if(t==this.getElement())break;t=t.parentNode}return null},goog.ui.tree.TreeControl.prototype.createNode=function(e){return new goog.ui.tree.TreeNode(e||goog.html.SafeHtml.EMPTY,this.getConfig(),this.getDomHelper())},goog.ui.tree.TreeControl.prototype.setNode=function(e){this.typeAhead_.setNodeInMap(e)},goog.ui.tree.TreeControl.prototype.removeNode=function(e){this.typeAhead_.removeNodeFromMap(e)},goog.ui.tree.TreeControl.prototype.clearTypeAhead=function(){this.typeAhead_.clear()},goog.ui.tree.TreeControl.defaultConfig=goog.ui.tree.BaseNode.defaultConfig;var Blockly={};Blockly.Blocks=Object(null),Blockly.Touch={},Blockly.Touch.touchIdentifier_=null,Blockly.Touch.TOUCH_MAP={},goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),Blockly.longPid_=0,Blockly.longStart_=function(e,t){Blockly.longStop_(),e.changedTouches&&1!=e.changedTouches.length||(Blockly.longPid_=setTimeout(function(){e.changedTouches&&(e.button=2,e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),t&&t.handleRightClick(e)},Blockly.LONGPRESS))},Blockly.longStop_=function(){Blockly.longPid_&&(clearTimeout(Blockly.longPid_),Blockly.longPid_=0)},Blockly.Touch.clearTouchIdentifier=function(){Blockly.Touch.touchIdentifier_=null},Blockly.Touch.shouldHandleEvent=function(e){return!Blockly.Touch.isMouseOrTouchEvent(e)||Blockly.Touch.checkTouchIdentifier(e)},Blockly.Touch.getTouchIdentifierFromEvent=function(e){return void 0!=e.pointerId?e.pointerId:e.changedTouches&&e.changedTouches[0]&&void 0!=e.changedTouches[0].identifier&&null!=e.changedTouches[0].identifier?e.changedTouches[0].identifier:"mouse"},Blockly.Touch.checkTouchIdentifier=function(e){var t=Blockly.Touch.getTouchIdentifierFromEvent(e);return void 0!=Blockly.Touch.touchIdentifier_&&null!=Blockly.Touch.touchIdentifier_?Blockly.Touch.touchIdentifier_==t:("mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type)&&(Blockly.Touch.touchIdentifier_=t,!0)},Blockly.Touch.setClientFromTouch=function(e){if(goog.string.startsWith(e.type,"touch")){var t=e.changedTouches[0];e.clientX=t.clientX,e.clientY=t.clientY}},Blockly.Touch.isMouseOrTouchEvent=function(e){return goog.string.startsWith(e.type,"touch")||goog.string.startsWith(e.type,"mouse")||goog.string.startsWith(e.type,"pointer")},Blockly.Touch.isTouchEvent=function(e){return goog.string.startsWith(e.type,"touch")||goog.string.startsWith(e.type,"pointer")},Blockly.Touch.splitEventByTouches=function(e){var t=[];if(e.changedTouches)for(var o=0;o<e.changedTouches.length;o++)t[o]={type:e.type,changedTouches:[e.changedTouches[o]],target:e.target,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()}};else t.push(e);return t},Blockly.VariableMap=function(e){this.variableMap_={},this.workspace=e},Blockly.VariableMap.prototype.clear=function(){this.variableMap_=Object(null)},Blockly.VariableMap.prototype.renameVariable=function(e,t){var o=this.getVariable(t,e.type),i=this.workspace.getAllBlocks();Blockly.Events.setGroup(!0);try{o&&o.getId()!=e.getId()?this.renameVariableWithConflict_(e,t,o,i):this.renameVariableAndUses_(e,t,i)}finally{Blockly.Events.setGroup(!1)}},Blockly.VariableMap.prototype.renameVariableById=function(e,t){var o=this.getVariableById(e);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(o,t)},Blockly.VariableMap.prototype.renameVariableAndUses_=function(e,t,o){for(Blockly.Events.fire(new Blockly.Events.VarRename(e,t)),e.name=t,t=0;t<o.length;t++)o[t].updateVarName(e)},Blockly.VariableMap.prototype.renameVariableWithConflict_=function(e,t,o,i){var n=e.type;for(t!=o.name&&this.renameVariableAndUses_(o,t,i),t=0;t<i.length;t++)i[t].renameVarById(e.getId(),o.getId());Blockly.Events.fire(new Blockly.Events.VarDelete(e)),e=this.getVariablesOfType(n).indexOf(e),this.variableMap_[n].splice(e,1)},Blockly.VariableMap.prototype.createVariable=function(e,t,o){var i=this.getVariable(e,t);if(i){if(o&&i.getId()!=o)throw Error('Variable "'+e+'" is already in use and its id is "'+i.getId()+'" which conflicts with the passed in id, "'+o+'".');return i}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return o=o||Blockly.utils.genUid(),t=t||"",i=new Blockly.VariableModel(this.workspace,e,t,o),this.variableMap_[t]?this.variableMap_[t].push(i):this.variableMap_[t]=[i],i},Blockly.VariableMap.prototype.deleteVariable=function(e){for(var t,o=this.variableMap_[e.type],i=0;t=o[i];i++)if(t.getId()==e.getId()){o.splice(i,1),Blockly.Events.fire(new Blockly.Events.VarDelete(e));break}},Blockly.VariableMap.prototype.deleteVariableById=function(e){var t=this.getVariableById(e);if(t){var o,i=t.name,n=this.getVariableUsesById(e);for(e=0;o=n[e];e++)if("procedures_defnoreturn"==o.type||"procedures_defreturn"==o.type)return e=o.getFieldValue("NAME"),i=Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",i).replace("%2",e),void Blockly.alert(i);var r=this;1<n.length?(i=Blockly.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(n.length)).replace("%2",i),Blockly.confirm(i,function(e){e&&r.deleteVariableInternal_(t,n)})):r.deleteVariableInternal_(t,n)}else console.warn("Can't delete non-existent variable: "+e)},Blockly.VariableMap.prototype.deleteVariableInternal_=function(e,t){var o=Blockly.Events.getGroup();o||Blockly.Events.setGroup(!0);try{for(var i=0;i<t.length;i++)t[i].dispose(!0,!1);this.deleteVariable(e)}finally{o||Blockly.Events.setGroup(!1)}},Blockly.VariableMap.prototype.getVariable=function(e,t){var o=this.variableMap_[t||""];if(o)for(var i,n=0;i=o[n];n++)if(Blockly.Names.equals(i.name,e))return i;return null},Blockly.VariableMap.prototype.getVariableById=function(e){for(var t=Object.keys(this.variableMap_),o=0;o<t.length;o++)for(var i,n=t[o],r=0;i=this.variableMap_[n][r];r++)if(i.getId()==e)return i;return null},Blockly.VariableMap.prototype.getVariablesOfType=function(e){return(e=this.variableMap_[e||""])?e.slice():[]},Blockly.VariableMap.prototype.getVariableTypes=function(){for(var e=Object.keys(this.variableMap_),t=!1,o=0;o<e.length;o++)""==e[o]&&(t=!0);return t||e.push(""),e},Blockly.VariableMap.prototype.getAllVariables=function(){for(var e=[],t=Object.keys(this.variableMap_),o=0;o<t.length;o++)e=e.concat(this.variableMap_[t[o]]);return e},Blockly.VariableMap.prototype.getVariableUsesById=function(e){for(var t=[],o=this.workspace.getAllBlocks(),i=0;i<o.length;i++){var n=o[i].getVarModels();if(n)for(var r=0;r<n.length;r++)n[r].getId()==e&&t.push(o[i])}return t},Blockly.Workspace=function(e){this.id=Blockly.utils.genUid(),Blockly.Workspace.WorkspaceDB_[this.id]=this,this.options=e||{},this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.topBlocks_=[],this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.variableMap_=new Blockly.VariableMap(this),this.potentialVariableMap_=null},Blockly.Workspace.prototype.rendered=!1,Blockly.Workspace.prototype.MAX_UNDO=1024,Blockly.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete Blockly.Workspace.WorkspaceDB_[this.id]},Blockly.Workspace.SCAN_ANGLE=3,Blockly.Workspace.prototype.addTopBlock=function(e){this.topBlocks_.push(e)},Blockly.Workspace.prototype.removeTopBlock=function(e){if(!goog.array.remove(this.topBlocks_,e))throw"Block not present in workspace's list of top-most blocks."},Blockly.Workspace.prototype.getTopBlocks=function(e){var t=[].concat(this.topBlocks_);if(e&&1<t.length){var o=Math.sin(goog.math.toRadians(Blockly.Workspace.SCAN_ANGLE));this.RTL&&(o*=-1),t.sort(function(e,t){var i=e.getRelativeToSurfaceXY(),n=t.getRelativeToSurfaceXY();return i.y+o*i.x-(n.y+o*n.x)})}return t},Blockly.Workspace.prototype.getAllBlocks=function(){for(var e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push.apply(e,e[t].getChildren());return e},Blockly.Workspace.prototype.clear=function(){var e=Blockly.Events.getGroup();for(e||Blockly.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose();e||Blockly.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()},Blockly.Workspace.prototype.renameVariableById=function(e,t){this.variableMap_.renameVariableById(e,t)},Blockly.Workspace.prototype.createVariable=function(e,t,o){return this.variableMap_.createVariable(e,t,o)},Blockly.Workspace.prototype.getVariableUsesById=function(e){return this.variableMap_.getVariableUsesById(e)},Blockly.Workspace.prototype.deleteVariableById=function(e){this.variableMap_.deleteVariableById(e)},Blockly.Workspace.prototype.deleteVariableInternal_=function(e,t){this.variableMap_.deleteVariableInternal_(e,t)},Blockly.Workspace.prototype.variableIndexOf=function(e){return console.warn("Deprecated call to Blockly.Workspace.prototype.variableIndexOf"),-1},Blockly.Workspace.prototype.getVariable=function(e,t){return this.variableMap_.getVariable(e,t)},Blockly.Workspace.prototype.getVariableById=function(e){return this.variableMap_.getVariableById(e)},Blockly.Workspace.prototype.getVariablesOfType=function(e){return this.variableMap_.getVariablesOfType(e)},Blockly.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes()},Blockly.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},Blockly.Workspace.prototype.getWidth=function(){return 0},Blockly.Workspace.prototype.newBlock=function(e,t){return new Blockly.Block(this,e,t)},Blockly.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks().length},Blockly.Workspace.prototype.undo=function(e){var t=e?this.redoStack_:this.undoStack_,o=e?this.undoStack_:this.redoStack_,i=t.pop();if(i){for(var n=[i];t.length&&i.group&&i.group==t[t.length-1].group;)n.push(t.pop());for(t=0;i=n[t];t++)o.push(i);n=Blockly.Events.filter(n,e),Blockly.Events.recordUndo=!1;try{for(t=0;i=n[t];t++)i.run(e)}finally{Blockly.Events.recordUndo=!0}}},Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,Blockly.Events.clearPendingUndo()},Blockly.Workspace.prototype.addChangeListener=function(e){return this.listeners_.push(e),e},Blockly.Workspace.prototype.removeChangeListener=function(e){goog.array.remove(this.listeners_,e)},Blockly.Workspace.prototype.fireChangeListener=function(e){e.recordUndo&&(this.undoStack_.push(e),this.redoStack_.length=0,this.undoStack_.length>this.MAX_UNDO&&this.undoStack_.unshift());for(var t,o=0;t=this.listeners_[o];o++)t(e)},Blockly.Workspace.prototype.getBlockById=function(e){return this.blockDB_[e]||null},Blockly.Workspace.prototype.allInputsFilled=function(e){for(var t,o=this.getTopBlocks(!1),i=0;t=o[i];i++)if(!t.allInputsFilled(e))return!1;return!0},Blockly.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},Blockly.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new Blockly.VariableMap(this)},Blockly.Workspace.prototype.getVariableMap=function(){return this.variableMap_},Blockly.Workspace.WorkspaceDB_=Object.create(null),Blockly.Workspace.getById=function(e){return Blockly.Workspace.WorkspaceDB_[e]||null},Blockly.Workspace.prototype.clear=Blockly.Workspace.prototype.clear,Blockly.Workspace.prototype.clearUndo=Blockly.Workspace.prototype.clearUndo,Blockly.Workspace.prototype.addChangeListener=Blockly.Workspace.prototype.addChangeListener,Blockly.Workspace.prototype.removeChangeListener=Blockly.Workspace.prototype.removeChangeListener,Blockly.Bubble=function(e,t,o,i,n,r){this.workspace_=e,this.content_=t,this.shape_=o,o=Blockly.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=goog.math.toRadians(o),e.getBubbleCanvas().appendChild(this.createDom_(t,!(!n||!r))),this.setAnchorLocation(i),n&&r||(n=(t=this.content_.getBBox()).width+2*Blockly.Bubble.BORDER_WIDTH,r=t.height+2*Blockly.Bubble.BORDER_WIDTH),this.setBubbleSize(n,r),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0,e.options.readOnly||(Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))},Blockly.Bubble.BORDER_WIDTH=6,Blockly.Bubble.ARROW_THICKNESS=5,Blockly.Bubble.ARROW_ANGLE=20,Blockly.Bubble.ARROW_BEND=4,Blockly.Bubble.ANCHOR_RADIUS=8,Blockly.Bubble.onMouseUpWrapper_=null,Blockly.Bubble.onMouseMoveWrapper_=null,Blockly.Bubble.prototype.resizeCallback_=null,Blockly.Bubble.unbindDragEvents_=function(){Blockly.Bubble.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_),Blockly.Bubble.onMouseUpWrapper_=null),Blockly.Bubble.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_),Blockly.Bubble.onMouseMoveWrapper_=null)},Blockly.Bubble.bubbleMouseUp_=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Bubble.unbindDragEvents_()},Blockly.Bubble.prototype.rendered_=!1,Blockly.Bubble.prototype.anchorXY_=null,Blockly.Bubble.prototype.relativeLeft_=0,Blockly.Bubble.prototype.relativeTop_=0,Blockly.Bubble.prototype.width_=0,Blockly.Bubble.prototype.height_=0,Blockly.Bubble.prototype.autoLayout_=!0,Blockly.Bubble.prototype.createDom_=function(e,t){this.bubbleGroup_=Blockly.utils.createSvgElement("g",{},null);var o={filter:"url(#"+this.workspace_.options.embossFilterId+")"};return-1!=goog.userAgent.getUserAgentString().indexOf("JavaFX")&&(o={}),o=Blockly.utils.createSvgElement("g",o,this.bubbleGroup_),this.bubbleArrow_=Blockly.utils.createSvgElement("path",{},o),this.bubbleBack_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable",x:0,y:0,rx:Blockly.Bubble.BORDER_WIDTH,ry:Blockly.Bubble.BORDER_WIDTH},o),t?(this.resizeGroup_=Blockly.utils.createSvgElement("g",{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),o=2*Blockly.Bubble.BORDER_WIDTH,Blockly.utils.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,o.toString())},this.resizeGroup_),Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:o/3,y1:o-1,x2:o-1,y2:o/3},this.resizeGroup_),Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:2*o/3,y1:o-1,x2:o-1,y2:2*o/3},this.resizeGroup_)):this.resizeGroup_=null,this.bubbleGroup_.appendChild(e),this.bubbleGroup_},Blockly.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},Blockly.Bubble.prototype.bubbleMouseDown_=function(e){var t=this.workspace_.getGesture(e);t&&t.handleBubbleStart(e,this)},Blockly.Bubble.prototype.resizeMouseDown_=function(e){this.promote_(),Blockly.Bubble.unbindDragEvents_(),Blockly.utils.isRightButton(e)||(this.workspace_.startDrag(e,new goog.math.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),Blockly.hideChaff()),e.stopPropagation()},Blockly.Bubble.prototype.resizeMouseMove_=function(e){this.autoLayout_=!1,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble_()},Blockly.Bubble.prototype.registerResizeEvent=function(e){this.resizeCallback_=e},Blockly.Bubble.prototype.promote_=function(){this.bubbleGroup_.parentNode.appendChild(this.bubbleGroup_)},Blockly.Bubble.prototype.setAnchorLocation=function(e){this.anchorXY_=e,this.rendered_&&this.positionBubble_()},Blockly.Bubble.prototype.layoutBubble_=function(){var e=-this.width_/4,t=-this.height_-Blockly.BlockSvg.MIN_BLOCK_Y,o=this.workspace_.getMetrics();o.viewWidth/=this.workspace_.scale,o.viewLeft/=this.workspace_.scale;var i=this.anchorXY_.x;this.workspace_.RTL?i-o.viewLeft-e-this.width_<Blockly.Scrollbar.scrollbarThickness?e=i-o.viewLeft-this.width_-Blockly.Scrollbar.scrollbarThickness:i-o.viewLeft-e>o.viewWidth&&(e=i-o.viewLeft-o.viewWidth):i+e<o.viewLeft?e=o.viewLeft-i:o.viewLeft+o.viewWidth<i+e+this.width_+Blockly.BlockSvg.SEP_SPACE_X+Blockly.Scrollbar.scrollbarThickness&&(e=o.viewLeft+o.viewWidth-i-this.width_-Blockly.Scrollbar.scrollbarThickness),this.anchorXY_.y+t<o.viewTop&&(t=this.shape_.getBBox().height),this.relativeLeft_=e,this.relativeTop_=t},Blockly.Bubble.prototype.positionBubble_=function(){var e=this.anchorXY_.x;e=this.workspace_.RTL?e-(this.relativeLeft_+this.width_):e+this.relativeLeft_,this.moveTo(e,this.relativeTop_+this.anchorXY_.y)},Blockly.Bubble.prototype.moveTo=function(e,t){this.bubbleGroup_.setAttribute("transform","translate("+e+","+t+")")},Blockly.Bubble.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}},Blockly.Bubble.prototype.setBubbleSize=function(e,t){var o=2*Blockly.Bubble.BORDER_WIDTH;e=Math.max(e,o+45),t=Math.max(t,o+20),this.width_=e,this.height_=t,this.bubbleBack_.setAttribute("width",e),this.bubbleBack_.setAttribute("height",t),this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*Blockly.Bubble.BORDER_WIDTH+","+(t-o)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(e-o)+","+(t-o)+")")),this.rendered_&&(this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_()),this.resizeCallback_&&this.resizeCallback_()},Blockly.Bubble.prototype.renderArrow_=function(){var e=[],t=this.width_/2,o=this.height_/2,i=-this.relativeLeft_,n=-this.relativeTop_;if(t==i&&o==n)e.push("M "+t+","+o);else{n-=o,i-=t,this.workspace_.RTL&&(i*=-1);var r=Math.sqrt(n*n+i*i),s=Math.acos(i/r);0>n&&(s=2*Math.PI-s);var a=s+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a),c=Math.cos(a),u=this.getBubbleSize();a=(u.width+u.height)/Blockly.Bubble.ARROW_THICKNESS,a=Math.min(a,u.width,u.height)/4,i=t+(u=1-Blockly.Bubble.ANCHOR_RADIUS/r)*i,n=o+u*n,u=t+a*c;var h=o+a*l;t-=a*c,o-=a*l,(l=s+this.arrow_radians_)>2*Math.PI&&(l-=2*Math.PI),s=Math.sin(l)*r/Blockly.Bubble.ARROW_BEND,r=Math.cos(l)*r/Blockly.Bubble.ARROW_BEND,e.push("M"+u+","+h),e.push("C"+(u+r)+","+(h+s)+" "+i+","+n+" "+i+","+n),e.push("C"+i+","+n+" "+(t+r)+","+(o+s)+" "+t+","+o)}e.push("z"),this.bubbleArrow_.setAttribute("d",e.join(" "))},Blockly.Bubble.prototype.setColour=function(e){this.bubbleBack_.setAttribute("fill",e),this.bubbleArrow_.setAttribute("fill",e)},Blockly.Bubble.prototype.dispose=function(){Blockly.Bubble.unbindDragEvents_(),goog.dom.removeNode(this.bubbleGroup_),this.shape_=this.content_=this.workspace_=this.resizeGroup_=this.bubbleBack_=this.bubbleArrow_=this.bubbleGroup_=null},Blockly.Bubble.prototype.moveDuringDrag=function(e,t){e?e.translateSurface(t.x,t.y):this.moveTo(t.x,t.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x-this.anchorXY_.x,this.relativeTop_=t.y-this.anchorXY_.y,this.renderArrow_()},Blockly.Bubble.prototype.getRelativeToSurfaceXY=function(){return new goog.math.Coordinate(this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},Blockly.Bubble.prototype.setAutoLayout=function(e){this.autoLayout_=e},Blockly.Icon=function(e){this.block_=e},Blockly.Icon.prototype.collapseHidden=!0,Blockly.Icon.prototype.SIZE=17,Blockly.Icon.prototype.bubble_=null,Blockly.Icon.prototype.iconXY_=null,Blockly.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),Blockly.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},Blockly.Icon.prototype.dispose=function(){goog.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},Blockly.Icon.prototype.updateEditable=function(){},Blockly.Icon.prototype.isVisible=function(){return!!this.bubble_},Blockly.Icon.prototype.iconClick_=function(e){this.block_.workspace.isDragging()||this.block_.isInFlyout||Blockly.utils.isRightButton(e)||this.setVisible(!this.isVisible())},Blockly.Icon.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())},Blockly.Icon.prototype.renderIcon=function(e){if(this.collapseHidden&&this.block_.isCollapsed())return this.iconGroup_.setAttribute("display","none"),e;this.iconGroup_.setAttribute("display","block");var t=this.SIZE;return this.block_.RTL&&(e-=t),this.iconGroup_.setAttribute("transform","translate("+e+",5)"),this.computeIconLocation(),this.block_.RTL?e-Blockly.BlockSvg.SEP_SPACE_X:e+(t+Blockly.BlockSvg.SEP_SPACE_X)},Blockly.Icon.prototype.setIconLocation=function(e){this.iconXY_=e,this.isVisible()&&this.bubble_.setAnchorLocation(e)},Blockly.Icon.prototype.computeIconLocation=function(){var e=this.block_.getRelativeToSurfaceXY(),t=Blockly.utils.getRelativeXY(this.iconGroup_);e=new goog.math.Coordinate(e.x+t.x+this.SIZE/2,e.y+t.y+this.SIZE/2),goog.math.Coordinate.equals(this.getIconLocation(),e)||this.setIconLocation(e)},Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_},Blockly.Comment=function(e){Blockly.Comment.superClass_.constructor.call(this,e),this.createIcon()},goog.inherits(Blockly.Comment,Blockly.Icon),Blockly.Comment.prototype.text_="",Blockly.Comment.prototype.width_=160,Blockly.Comment.prototype.height_=80,Blockly.Comment.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)},Blockly.Comment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);var e=document.createElementNS(Blockly.HTML_NS,"body");e.setAttribute("xmlns",Blockly.HTML_NS),e.className="blocklyMinimalBody";var t=document.createElementNS(Blockly.HTML_NS,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),e.appendChild(t),this.textarea_=t,this.foreignObject_.appendChild(e),Blockly.bindEventWithChecks_(t,"mouseup",this,this.textareaFocus_),Blockly.bindEventWithChecks_(t,"wheel",this,function(e){e.stopPropagation()}),Blockly.bindEventWithChecks_(t,"change",this,function(e){this.text_!=t.value&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,t.value)),this.text_=t.value)}),setTimeout(function(){t.focus()},0),this.foreignObject_},Blockly.Comment.prototype.updateEditable=function(){this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)),Blockly.Icon.prototype.updateEditable.call(this)},Blockly.Comment.prototype.resizeBubble_=function(){if(this.isVisible()){var e=this.bubble_.getBubbleSize(),t=2*Blockly.Bubble.BORDER_WIDTH;this.foreignObject_.setAttribute("width",e.width-t),this.foreignObject_.setAttribute("height",e.height-t),this.textarea_.style.width=e.width-t-4+"px",this.textarea_.style.height=e.height-t-4+"px"}},Blockly.Comment.prototype.setVisible=function(e){if(e!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"commentOpen",!e,e)),!this.block_.isEditable()&&!this.textarea_||goog.userAgent.IE)Blockly.Warning.prototype.setVisible.call(this,e);else{var t=this.getText(),o=this.getBubbleSize();e?(this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,this.width_,this.height_),this.bubble_.registerResizeEvent(this.resizeBubble_.bind(this)),this.updateColour()):(this.bubble_.dispose(),this.foreignObject_=this.textarea_=this.bubble_=null),this.setText(t),this.setBubbleSize(o.width,o.height)}},Blockly.Comment.prototype.textareaFocus_=function(e){this.bubble_.promote_(),this.textarea_.focus()},Blockly.Comment.prototype.getBubbleSize=function(){return this.isVisible()?this.bubble_.getBubbleSize():{width:this.width_,height:this.height_}},Blockly.Comment.prototype.setBubbleSize=function(e,t){this.textarea_?this.bubble_.setBubbleSize(e,t):(this.width_=e,this.height_=t)},Blockly.Comment.prototype.getText=function(){return this.textarea_?this.textarea_.value:this.text_},Blockly.Comment.prototype.setText=function(e){this.text_!=e&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,e)),this.text_=e),this.textarea_&&(this.textarea_.value=e)},Blockly.Comment.prototype.dispose=function(){Blockly.Events.isEnabled()&&this.setText(""),this.block_.comment=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Connection=function(e,t){this.sourceBlock_=e,this.type=t,e.workspace.connectionDBList&&(this.db_=e.workspace.connectionDBList[t],this.dbOpposite_=e.workspace.connectionDBList[Blockly.OPPOSITE_TYPE[t]],this.hidden_=!this.db_)},Blockly.Connection.CAN_CONNECT=0,Blockly.Connection.REASON_SELF_CONNECTION=1,Blockly.Connection.REASON_WRONG_TYPE=2,Blockly.Connection.REASON_TARGET_NULL=3,Blockly.Connection.REASON_CHECKS_FAILED=4,Blockly.Connection.REASON_DIFFERENT_WORKSPACES=5,Blockly.Connection.REASON_SHADOW_PARENT=6,Blockly.Connection.prototype.targetConnection=null,Blockly.Connection.prototype.check_=null,Blockly.Connection.prototype.shadowDom_=null,Blockly.Connection.prototype.x_=0,Blockly.Connection.prototype.y_=0,Blockly.Connection.prototype.inDB_=!1,Blockly.Connection.prototype.db_=null,Blockly.Connection.prototype.dbOpposite_=null,Blockly.Connection.prototype.hidden_=null,Blockly.Connection.prototype.connect_=function(e){var t,o=this,i=o.getSourceBlock(),n=e.getSourceBlock();if(e.isConnected()&&e.disconnect(),o.isConnected()){var r=o.targetBlock(),s=o.getShadowDom();if(o.setShadowDom(null),r.isShadow())s=Blockly.Xml.blockToDom(r),r.dispose(),r=null;else if(o.type==Blockly.INPUT_VALUE){if(!r.outputConnection)throw"Orphan block does not have an output connection.";var a=Blockly.Connection.lastConnectionInRow_(n,r);a&&(r.outputConnection.connect(a),r=null)}else if(o.type==Blockly.NEXT_STATEMENT){if(!r.previousConnection)throw"Orphan block does not have a previous connection.";for(a=n;a.nextConnection;){var l=a.getNextBlock();if(!l||l.isShadow()){r.previousConnection.checkType_(a.nextConnection)&&(a.nextConnection.connect(r.previousConnection),r=null);break}a=l}}if(r&&(o.disconnect(),Blockly.Events.recordUndo)){var c=Blockly.Events.getGroup();setTimeout(function(){r.workspace&&!r.getParent()&&(Blockly.Events.setGroup(c),r.outputConnection?r.outputConnection.bumpAwayFrom_(o):r.previousConnection&&r.previousConnection.bumpAwayFrom_(o),Blockly.Events.setGroup(!1))},Blockly.BUMP_DELAY)}o.setShadowDom(s)}Blockly.Events.isEnabled()&&(t=new Blockly.Events.BlockMove(n)),Blockly.Connection.connectReciprocally_(o,e),n.setParent(i),t&&(t.recordNew(),Blockly.Events.fire(t))},Blockly.Connection.prototype.dispose=function(){if(this.isConnected())throw"Disconnect connection before disposing of it.";this.inDB_&&this.db_.removeConnection_(this),this.dbOpposite_=this.db_=null},Blockly.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Connection.prototype.isSuperior=function(){return this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT},Blockly.Connection.prototype.isConnected=function(){return!!this.targetConnection},Blockly.Connection.prototype.canConnectWithReason_=function(e){if(!e)return Blockly.Connection.REASON_TARGET_NULL;if(this.isSuperior())var t=this.sourceBlock_,o=e.getSourceBlock();else o=this.sourceBlock_,t=e.getSourceBlock();return t&&t==o?Blockly.Connection.REASON_SELF_CONNECTION:e.type!=Blockly.OPPOSITE_TYPE[this.type]?Blockly.Connection.REASON_WRONG_TYPE:t&&o&&t.workspace!==o.workspace?Blockly.Connection.REASON_DIFFERENT_WORKSPACES:this.checkType_(e)?t.isShadow()&&!o.isShadow()?Blockly.Connection.REASON_SHADOW_PARENT:Blockly.Connection.CAN_CONNECT:Blockly.Connection.REASON_CHECKS_FAILED},Blockly.Connection.prototype.checkConnection_=function(e){switch(this.canConnectWithReason_(e)){case Blockly.Connection.CAN_CONNECT:break;case Blockly.Connection.REASON_SELF_CONNECTION:throw"Attempted to connect a block to itself.";case Blockly.Connection.REASON_DIFFERENT_WORKSPACES:throw"Blocks not on same workspace.";case Blockly.Connection.REASON_WRONG_TYPE:throw"Attempt to connect incompatible types.";case Blockly.Connection.REASON_TARGET_NULL:throw"Target connection is null.";case Blockly.Connection.REASON_CHECKS_FAILED:throw"Connection checks failed. "+this+" expected "+this.check_+", found "+e.check_;case Blockly.Connection.REASON_SHADOW_PARENT:throw"Connecting non-shadow to shadow block.";default:throw"Unknown connection failure: this should never happen!"}},Blockly.Connection.prototype.isConnectionAllowed=function(e){return this.canConnectWithReason_(e)==Blockly.Connection.CAN_CONNECT&&((e.type!=Blockly.OUTPUT_VALUE&&e.type!=Blockly.PREVIOUS_STATEMENT||!e.isConnected()&&!this.isConnected())&&!(e.type==Blockly.INPUT_VALUE&&e.isConnected()&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow()||this.type==Blockly.PREVIOUS_STATEMENT&&e.isConnected()&&!this.sourceBlock_.nextConnection&&!e.targetBlock().isShadow()&&e.targetBlock().nextConnection||-1!=Blockly.draggingConnections_.indexOf(e)))},Blockly.Connection.prototype.connect=function(e){this.targetConnection!=e&&(this.checkConnection_(e),this.isSuperior()?this.connect_(e):e.connect_(this))},Blockly.Connection.connectReciprocally_=function(e,t){goog.asserts.assert(e&&t,"Cannot connect null connections."),e.targetConnection=t,t.targetConnection=e},Blockly.Connection.singleConnection_=function(e,t){for(var o=!1,i=0;i<e.inputList.length;i++){var n=e.inputList[i].connection;if(n&&n.type==Blockly.INPUT_VALUE&&t.outputConnection.checkType_(n)){if(o)return null;o=n}}return o},Blockly.Connection.lastConnectionInRow_=function(e,t){for(var o,i=e;o=Blockly.Connection.singleConnection_(i,t);)if(!(i=o.targetBlock())||i.isShadow())return o;return null},Blockly.Connection.prototype.disconnect=function(){var e=this.targetConnection;if(goog.asserts.assert(e,"Source connection not connected."),goog.asserts.assert(e.targetConnection==this,"Target connection not connected to source connection."),this.isSuperior()){var t=this.sourceBlock_,o=e.getSourceBlock();e=this}else t=e.getSourceBlock(),o=this.sourceBlock_;this.disconnectInternal_(t,o),e.respawnShadow_()},Blockly.Connection.prototype.disconnectInternal_=function(e,t){var o;Blockly.Events.isEnabled()&&(o=new Blockly.Events.BlockMove(t)),this.targetConnection=this.targetConnection.targetConnection=null,t.setParent(null),o&&(o.recordNew(),Blockly.Events.fire(o))},Blockly.Connection.prototype.respawnShadow_=function(){var e=this.getSourceBlock(),t=this.getShadowDom();if(e.workspace&&t&&Blockly.Events.recordUndo)if((e=Blockly.Xml.domToBlock(t,e.workspace)).outputConnection)this.connect(e.outputConnection);else{if(!e.previousConnection)throw"Child block does not have output or previous statement.";this.connect(e.previousConnection)}},Blockly.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},Blockly.Connection.prototype.checkType_=function(e){if(!this.check_||!e.check_)return!0;for(var t=0;t<this.check_.length;t++)if(-1!=e.check_.indexOf(this.check_[t]))return!0;return!1},Blockly.Connection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},Blockly.Connection.prototype.setCheck=function(e){return e?(goog.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this},Blockly.Connection.prototype.setShadowDom=function(e){this.shadowDom_=e},Blockly.Connection.prototype.getShadowDom=function(){return this.shadowDom_},Blockly.Connection.prototype.neighbours_=function(){return[]},Blockly.Connection.prototype.toString=function(){var e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection==this)var t="Output Connection of ";else if(e.previousConnection==this)t="Previous Connection of ";else if(e.nextConnection==this)t="Next Connection of ";else{if(!(t=goog.array.find(e.inputList,function(e){return e.connection==this},this)))return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()},Blockly.ConnectionDB=function(){},Blockly.ConnectionDB.prototype=[],Blockly.ConnectionDB.constructor=Blockly.ConnectionDB,Blockly.ConnectionDB.prototype.addConnection=function(e){if(e.inDB_)throw"Connection already in database.";if(!e.getSourceBlock().isInFlyout){var t=this.findPositionForConnection_(e);this.splice(t,0,e),e.inDB_=!0}},Blockly.ConnectionDB.prototype.findConnection=function(e){if(!this.length)return-1;var t=this.findPositionForConnection_(e);if(t>=this.length)return-1;for(var o=e.y_,i=t;0<=i&&this[i].y_==o;){if(this[i]==e)return i;i--}for(;t<this.length&&this[t].y_==o;){if(this[t]==e)return t;t++}return-1},Blockly.ConnectionDB.prototype.findPositionForConnection_=function(e){if(!this.length)return 0;for(var t=0,o=this.length;t<o;){var i=Math.floor((t+o)/2);if(this[i].y_<e.y_)t=i+1;else{if(!(this[i].y_>e.y_)){t=i;break}o=i}}return t},Blockly.ConnectionDB.prototype.removeConnection_=function(e){if(!e.inDB_)throw"Connection not in database.";var t=this.findConnection(e);if(-1==t)throw"Unable to find connection in connectionDB.";e.inDB_=!1,this.splice(t,1)},Blockly.ConnectionDB.prototype.getNeighbours=function(e,t){function o(e){var o=n-i[e].x_,s=r-i[e].y_;return Math.sqrt(o*o+s*s)<=t&&c.push(i[e]),s<t}for(var i=this,n=e.x_,r=e.y_,s=0,a=i.length-2,l=a;s<l;)i[l].y_<r?s=l:a=l,l=Math.floor((s+a)/2);var c=[];if(a=s=l,i.length){for(;0<=s&&o(s);)s--;do{a++}while(a<i.length&&o(a))}return c},Blockly.ConnectionDB.prototype.isInYRange_=function(e,t,o){return Math.abs(this[e].y_-t)<=o},Blockly.ConnectionDB.prototype.searchForClosest=function(e,t,o){if(!this.length)return{connection:null,radius:t};var i=e.y_,n=e.x_;e.x_=n+o.x,e.y_=i+o.y;var r=this.findPositionForConnection_(e);o=null;for(var s,a=t,l=r-1;0<=l&&this.isInYRange_(l,e.y_,t);)s=this[l],e.isConnectionAllowed(s,a)&&(o=s,a=s.distanceFrom(e)),l--;for(;r<this.length&&this.isInYRange_(r,e.y_,t);)s=this[r],e.isConnectionAllowed(s,a)&&(o=s,a=s.distanceFrom(e)),r++;return e.x_=n,e.y_=i,{connection:o,radius:a}},Blockly.ConnectionDB.init=function(e){var t=[];t[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB,t[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB,t[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB,t[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB,e.connectionDBList=t},Blockly.constants={},Blockly.DRAG_RADIUS=5,Blockly.FLYOUT_DRAG_RADIUS=10,Blockly.SNAP_RADIUS=20,Blockly.BUMP_DELAY=250,Blockly.COLLAPSE_CHARS=30,Blockly.LONGPRESS=750,Blockly.SOUND_LIMIT=100,Blockly.DRAG_STACK=!0,Blockly.HSV_SATURATION=.45,Blockly.HSV_VALUE=.65,Blockly.SPRITE={width:96,height:124,url:"sprites.png"},Blockly.SVG_NS="http://www.w3.org/2000/svg",Blockly.HTML_NS="http://www.w3.org/1999/xhtml",Blockly.INPUT_VALUE=1,Blockly.OUTPUT_VALUE=2,Blockly.NEXT_STATEMENT=3,Blockly.PREVIOUS_STATEMENT=4,Blockly.DUMMY_INPUT=5,Blockly.ALIGN_LEFT=-1,Blockly.ALIGN_CENTRE=0,Blockly.ALIGN_RIGHT=1,Blockly.DRAG_NONE=0,Blockly.DRAG_STICKY=1,Blockly.DRAG_BEGIN=1,Blockly.DRAG_FREE=2,Blockly.OPPOSITE_TYPE=[],Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT,Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT,Blockly.TOOLBOX_AT_TOP=0,Blockly.TOOLBOX_AT_BOTTOM=1,Blockly.TOOLBOX_AT_LEFT=2,Blockly.TOOLBOX_AT_RIGHT=3,Blockly.DELETE_AREA_NONE=null,Blockly.DELETE_AREA_TRASH=1,Blockly.DELETE_AREA_TOOLBOX=2,Blockly.VARIABLE_CATEGORY_NAME="VARIABLE",Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",Blockly.PROCEDURE_CATEGORY_NAME="PROCEDURE",Blockly.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",Blockly.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",Blockly.RenderedConnection=function(e,t){Blockly.RenderedConnection.superClass_.constructor.call(this,e,t),this.offsetInBlock_=new goog.math.Coordinate(0,0)},goog.inherits(Blockly.RenderedConnection,Blockly.Connection),Blockly.RenderedConnection.prototype.distanceFrom=function(e){var t=this.x_-e.x_;return e=this.y_-e.y_,Math.sqrt(t*t+e*e)},Blockly.RenderedConnection.prototype.bumpAwayFrom_=function(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var o=!1;if(!t.isMovable()){if(!(t=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,o=!0}var i=Blockly.selected==t;i||t.addSelect();var n=e.x_+Blockly.SNAP_RADIUS-this.x_;e=e.y_+Blockly.SNAP_RADIUS-this.y_,o&&(e=-e),t.RTL&&(n=-n),t.moveBy(n,e),i||t.removeSelect()}}},Blockly.RenderedConnection.prototype.moveTo=function(e,t){this.inDB_&&this.db_.removeConnection_(this),this.x_=e,this.y_=t,this.hidden_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.moveBy=function(e,t){this.moveTo(this.x_+e,this.y_+t)},Blockly.RenderedConnection.prototype.moveToOffset=function(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)},Blockly.RenderedConnection.prototype.setOffsetInBlock=function(e,t){this.offsetInBlock_.x=e,this.offsetInBlock_.y=t},Blockly.RenderedConnection.prototype.tighten_=function(){var e=this.targetConnection.x_-this.x_,t=this.targetConnection.y_-this.y_;if(0!=e||0!=t){var o=this.targetBlock(),i=o.getSvgRoot();if(!i)throw"block is not rendered.";i=Blockly.utils.getRelativeXY(i),o.getSvgRoot().setAttribute("transform","translate("+(i.x-e)+","+(i.y-t)+")"),o.moveConnections_(-e,-t)}},Blockly.RenderedConnection.prototype.closest=function(e,t,o){return this.dbOpposite_.searchForClosest(this,e,t,o)},Blockly.RenderedConnection.prototype.highlight=function(){var e=this.type==Blockly.INPUT_VALUE||this.type==Blockly.OUTPUT_VALUE?"m 0,0 "+Blockly.BlockSvg.TAB_PATH_DOWN+" v 5":"m -20,0 h 5 "+Blockly.BlockSvg.NOTCH_PATH_LEFT+" h 5",t=this.sourceBlock_.getRelativeToSurfaceXY();Blockly.Connection.highlightedPath_=Blockly.utils.createSvgElement("path",{class:"blocklyHighlightedConnectionPath",d:e,transform:"translate("+(this.x_-t.x)+","+(this.y_-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},Blockly.RenderedConnection.prototype.unhideAll=function(){this.setHidden(!1);var e=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT)return e;var t=this.targetBlock();if(t){if(t.isCollapsed()){var o=[];t.outputConnection&&o.push(t.outputConnection),t.nextConnection&&o.push(t.nextConnection),t.previousConnection&&o.push(t.previousConnection)}else o=t.getConnections_(!0);for(var i=0;i<o.length;i++)e.push.apply(e,o[i].unhideAll());e.length||(e[0]=t)}return e},Blockly.RenderedConnection.prototype.unhighlight=function(){goog.dom.removeNode(Blockly.Connection.highlightedPath_),delete Blockly.Connection.highlightedPath_},Blockly.RenderedConnection.prototype.setHidden=function(e){(this.hidden_=e)&&this.inDB_?this.db_.removeConnection_(this):e||this.inDB_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.hideAll=function(){if(this.setHidden(!0),this.targetConnection)for(var e=this.targetBlock().getDescendants(),t=0;t<e.length;t++){for(var o=e[t],i=o.getConnections_(!0),n=0;n<i.length;n++)i[n].setHidden(!0);for(o=o.getIcons(),n=0;n<o.length;n++)o[n].setVisible(!1)}},Blockly.RenderedConnection.prototype.isConnectionAllowed=function(e,t){return!(this.distanceFrom(e)>t)&&Blockly.RenderedConnection.superClass_.isConnectionAllowed.call(this,e)},Blockly.RenderedConnection.prototype.disconnectInternal_=function(e,t){Blockly.RenderedConnection.superClass_.disconnectInternal_.call(this,e,t),e.rendered&&e.render(),t.rendered&&(t.updateDisabled(),t.render())},Blockly.RenderedConnection.prototype.respawnShadow_=function(){var e=this.getSourceBlock(),t=this.getShadowDom();if(e.workspace&&t&&Blockly.Events.recordUndo){if(Blockly.RenderedConnection.superClass_.respawnShadow_.call(this),!(t=this.targetBlock()))throw"Couldn't respawn the shadow block that should exist here.";t.initSvg(),t.render(!1),e.rendered&&e.render()}},Blockly.RenderedConnection.prototype.neighbours_=function(e){return this.dbOpposite_.getNeighbours(this,e)},Blockly.RenderedConnection.prototype.connect_=function(e){Blockly.RenderedConnection.superClass_.connect_.call(this,e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.rendered&&t.updateDisabled(),e.rendered&&e.updateDisabled(),t.rendered&&e.rendered&&(this.type==Blockly.NEXT_STATEMENT||this.type==Blockly.PREVIOUS_STATEMENT?e.render():t.render())},Blockly.RenderedConnection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours_())},Blockly.DraggedConnectionManager=function(e){this.topBlock_=Blockly.selected=e,this.workspace_=e.workspace,this.availableConnections_=this.initAvailableConnections_(),this.localConnection_=this.closestConnection_=null,this.radiusConnection_=0,this.wouldDeleteBlock_=!1},Blockly.DraggedConnectionManager.prototype.dispose=function(){this.workspace_=this.topBlock_=null,this.availableConnections_.length=0,this.localConnection_=this.closestConnection_=null},Blockly.DraggedConnectionManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},Blockly.DraggedConnectionManager.prototype.applyConnections=function(){this.closestConnection_&&(this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered&&((this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_).getSourceBlock().connectionUiEffect(),this.topBlock_.getRootBlock().bringToFront()),this.removeHighlighting_())},Blockly.DraggedConnectionManager.prototype.update=function(e,t){var o=this.closestConnection_,i=this.updateClosest_(e);i&&o&&o.unhighlight(),o=!!this.closestConnection_&&t!=Blockly.DELETE_AREA_TOOLBOX;var n=!!t&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable();this.wouldDeleteBlock_=n&&!o,n&&this.closestConnection_&&(this.closestConnection_.unhighlight(),this.closestConnection_=null),!this.wouldDeleteBlock_&&i&&this.closestConnection_&&this.addHighlighting_()},Blockly.DraggedConnectionManager.prototype.removeHighlighting_=function(){this.closestConnection_&&this.closestConnection_.unhighlight()},Blockly.DraggedConnectionManager.prototype.addHighlighting_=function(){this.closestConnection_&&this.closestConnection_.highlight()},Blockly.DraggedConnectionManager.prototype.initAvailableConnections_=function(){var e=this.topBlock_.getConnections_(!1),t=this.topBlock_.lastConnectionInStack_();return t&&t!=this.topBlock_.nextConnection&&e.push(t),e},Blockly.DraggedConnectionManager.prototype.updateClosest_=function(e){var t=this.closestConnection_;this.localConnection_=this.closestConnection_=null,this.radiusConnection_=Blockly.SNAP_RADIUS;for(var o=0;o<this.availableConnections_.length;o++){var i=this.availableConnections_[o],n=i.closest(this.radiusConnection_,e);n.connection&&(this.closestConnection_=n.connection,this.localConnection_=i,this.radiusConnection_=n.radius)}return t!=this.closestConnection_},Blockly.BlockDragger=function(e,t){this.draggingBlock_=e,this.workspace_=t,this.draggedConnectionManager_=new Blockly.DraggedConnectionManager(this.draggingBlock_),this.deleteArea_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=Blockly.BlockDragger.initIconData_(e)},Blockly.BlockDragger.prototype.dispose=function(){this.startWorkspace_=this.workspace_=this.draggingBlock_=null,this.dragIconData_.length=0,this.draggedConnectionManager_&&(this.draggedConnectionManager_.dispose(),this.draggedConnectionManager_=null)},Blockly.BlockDragger.initIconData_=function(e){var t=[];e=e.getDescendants();for(var o,i=0;o=e[i];i++){o=o.getIcons();for(var n=0;n<o.length;n++){var r={location:o[n].getIconLocation(),icon:o[n]};t.push(r)}}return t},Blockly.BlockDragger.prototype.startBlockDrag=function(e){Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),Blockly.BlockSvg.disconnectUiStop_(),this.draggingBlock_.getParent()&&(this.draggingBlock_.unplug(),e=this.pixelsToWorkspaceUnits_(e),e=goog.math.Coordinate.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),this.draggingBlock_.disconnectUiEffect()),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface_(),this.workspace_.toolbox_&&(e=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",this.workspace_.toolbox_.addStyle(e))},Blockly.BlockDragger.prototype.dragBlock=function(e,t){var o=this.pixelsToWorkspaceUnits_(t),i=goog.math.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveDuringDrag(i),this.dragIcons_(o),this.deleteArea_=this.workspace_.isDeleteArea(e),this.draggedConnectionManager_.update(o,this.deleteArea_),this.updateCursorDuringBlockDrag_()},Blockly.BlockDragger.prototype.endBlockDrag=function(e,t){this.dragBlock(e,t),this.dragIconData_=[],Blockly.BlockSvg.disconnectUiStop_();var o=this.pixelsToWorkspaceUnits_(t),i=goog.math.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveOffDragSurface_(i),this.maybeDeleteBlock_()||(this.draggingBlock_.moveConnections_(o.x,o.y),this.draggingBlock_.setDragging(!1),this.draggedConnectionManager_.applyConnections(),this.draggingBlock_.render(),this.fireMoveEvent_(),this.draggingBlock_.scheduleSnapAndBump()),this.workspace_.setResizesEnabled(!0),this.workspace_.toolbox_&&(o=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",this.workspace_.toolbox_.removeStyle(o)),Blockly.Events.setGroup(!1)},Blockly.BlockDragger.prototype.fireMoveEvent_=function(){var e=new Blockly.Events.BlockMove(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),Blockly.Events.fire(e)},Blockly.BlockDragger.prototype.maybeDeleteBlock_=function(){var e=this.workspace_.trashcan;return this.wouldDeleteBlock_?(e&&goog.Timer.callOnce(e.close,100,e),this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0)):e&&e.close(),this.wouldDeleteBlock_},Blockly.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var e=this.workspace_.trashcan;this.wouldDeleteBlock_?(this.draggingBlock_.setDeleteStyle(!0),this.deleteArea_==Blockly.DELETE_AREA_TRASH&&e&&e.setOpen_(!0)):(this.draggingBlock_.setDeleteStyle(!1),e&&e.setOpen_(!1))},Blockly.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new goog.math.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&(e=e.scale(1/this.workspace_.options.parentWorkspace.scale)),e},Blockly.BlockDragger.prototype.dragIcons_=function(e){for(var t=0;t<this.dragIconData_.length;t++){var o=this.dragIconData_[t];o.icon.setIconLocation(goog.math.Coordinate.sum(o.location,e))}},Blockly.BubbleDragger=function(e,t){this.draggingBubble_=e,this.workspace_=t,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=Blockly.utils.is3dSupported()&&t.getBlockDragSurface()?t.getBlockDragSurface():null},Blockly.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},Blockly.BubbleDragger.prototype.startBubbleDrag=function(){Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_()},Blockly.BubbleDragger.prototype.dragBubble=function(e,t){var o=this.pixelsToWorkspaceUnits_(t);o=goog.math.Coordinate.sum(this.startXY_,o),this.draggingBubble_.moveDuringDrag(this.dragSurface_,o)},Blockly.BubbleDragger.prototype.endBubbleDrag=function(e,t){this.dragBubble(e,t);var o=this.pixelsToWorkspaceUnits_(t);o=goog.math.Coordinate.sum(this.startXY_,o),this.draggingBubble_.moveTo(o.x,o.y),this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.fireMoveEvent_(),this.workspace_.setResizesEnabled(!0),Blockly.Events.setGroup(!1)},Blockly.BubbleDragger.prototype.fireMoveEvent_=function(){},Blockly.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new goog.math.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&(e=e.scale(1/this.workspace_.options.parentWorkspace.scale)),e},Blockly.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},Blockly.WorkspaceDragger=function(e){this.workspace_=e,this.startDragMetrics_=e.getMetrics(),this.startScrollXY_=new goog.math.Coordinate(e.scrollX,e.scrollY)},Blockly.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},Blockly.WorkspaceDragger.prototype.startDrag=function(){Blockly.selected&&Blockly.selected.unselect(),this.workspace_.setupDragSurface()},Blockly.WorkspaceDragger.prototype.endDrag=function(e){this.drag(e),this.workspace_.resetDragSurface()},Blockly.WorkspaceDragger.prototype.drag=function(e){var t=this.startDragMetrics_,o=goog.math.Coordinate.sum(this.startScrollXY_,e);e=Math.min(o.x,-t.contentLeft),o=Math.min(o.y,-t.contentTop),e=Math.max(e,t.viewWidth-t.contentLeft-t.contentWidth),o=Math.max(o,t.viewHeight-t.contentTop-t.contentHeight),e=-e-t.contentLeft,o=-o-t.contentTop,this.updateScroll_(e,o)},Blockly.WorkspaceDragger.prototype.updateScroll_=function(e,t){this.workspace_.scrollbar.set(e,t)},Blockly.FlyoutDragger=function(e){Blockly.FlyoutDragger.superClass_.constructor.call(this,e.getWorkspace()),this.scrollbar_=e.scrollbar_,this.horizontalLayout_=e.horizontalLayout_},goog.inherits(Blockly.FlyoutDragger,Blockly.WorkspaceDragger),Blockly.FlyoutDragger.prototype.updateScroll_=function(e,t){this.horizontalLayout_?this.scrollbar_.set(e):this.scrollbar_.set(t)},Blockly.Tooltip={},Blockly.Tooltip.visible=!1,Blockly.Tooltip.blocked_=!1,Blockly.Tooltip.LIMIT=50,Blockly.Tooltip.mouseOutPid_=0,Blockly.Tooltip.showPid_=0,Blockly.Tooltip.lastX_=0,Blockly.Tooltip.lastY_=0,Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.OFFSET_X=0,Blockly.Tooltip.OFFSET_Y=10,Blockly.Tooltip.RADIUS_OK=10,Blockly.Tooltip.HOVER_MS=750,Blockly.Tooltip.MARGINS=5,Blockly.Tooltip.DIV=null,Blockly.Tooltip.createDom=function(){Blockly.Tooltip.DIV||(Blockly.Tooltip.DIV=goog.dom.createDom("DIV","blocklyTooltipDiv"),document.body.appendChild(Blockly.Tooltip.DIV))},Blockly.Tooltip.bindMouseEvents=function(e){Blockly.bindEvent_(e,"mouseover",null,Blockly.Tooltip.onMouseOver_),Blockly.bindEvent_(e,"mouseout",null,Blockly.Tooltip.onMouseOut_),e.addEventListener("mousemove",Blockly.Tooltip.onMouseMove_,!1)},Blockly.Tooltip.onMouseOver_=function(e){if(!Blockly.Tooltip.blocked_){for(e=e.target;!goog.isString(e.tooltip)&&!goog.isFunction(e.tooltip);)e=e.tooltip;Blockly.Tooltip.element_!=e&&(Blockly.Tooltip.hide(),Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.element_=e),clearTimeout(Blockly.Tooltip.mouseOutPid_)}},Blockly.Tooltip.onMouseOut_=function(e){Blockly.Tooltip.blocked_||(Blockly.Tooltip.mouseOutPid_=setTimeout(function(){Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.hide()},1),clearTimeout(Blockly.Tooltip.showPid_))},Blockly.Tooltip.onMouseMove_=function(e){if(Blockly.Tooltip.element_&&Blockly.Tooltip.element_.tooltip&&!Blockly.WidgetDiv.isVisible()&&!Blockly.Tooltip.blocked_)if(Blockly.Tooltip.visible){var t=Blockly.Tooltip.lastX_-e.pageX;e=Blockly.Tooltip.lastY_-e.pageY,Math.sqrt(t*t+e*e)>Blockly.Tooltip.RADIUS_OK&&Blockly.Tooltip.hide()}else Blockly.Tooltip.poisonedElement_!=Blockly.Tooltip.element_&&(clearTimeout(Blockly.Tooltip.showPid_),Blockly.Tooltip.lastX_=e.pageX,Blockly.Tooltip.lastY_=e.pageY,Blockly.Tooltip.showPid_=setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS))},Blockly.Tooltip.hide=function(){Blockly.Tooltip.visible&&(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.display="none")),Blockly.Tooltip.showPid_&&clearTimeout(Blockly.Tooltip.showPid_)},Blockly.Tooltip.block=function(){Blockly.Tooltip.hide(),Blockly.Tooltip.blocked_=!0},Blockly.Tooltip.unblock=function(){Blockly.Tooltip.blocked_=!1},Blockly.Tooltip.show_=function(){if(!Blockly.Tooltip.blocked_&&(Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_,Blockly.Tooltip.DIV)){goog.dom.removeChildren(Blockly.Tooltip.DIV);for(var e=Blockly.Tooltip.element_.tooltip;goog.isFunction(e);)e=e();e=(e=Blockly.utils.wrap(e,Blockly.Tooltip.LIMIT)).split("\n");for(var t=0;t<e.length;t++){var o=document.createElement("div");o.appendChild(document.createTextNode(e[t])),Blockly.Tooltip.DIV.appendChild(o)}e=Blockly.Tooltip.element_.RTL,t=goog.dom.getViewportSize(),Blockly.Tooltip.DIV.style.direction=e?"rtl":"ltr",Blockly.Tooltip.DIV.style.display="block",Blockly.Tooltip.visible=!0,o=Blockly.Tooltip.lastX_,o=e?o-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):o+Blockly.Tooltip.OFFSET_X;var i=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;i+Blockly.Tooltip.DIV.offsetHeight>t.height+window.scrollY&&(i-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y),e?o=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,o):o+Blockly.Tooltip.DIV.offsetWidth>t.width+window.scrollX-2*Blockly.Tooltip.MARGINS&&(o=t.width-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS),Blockly.Tooltip.DIV.style.top=i+"px",Blockly.Tooltip.DIV.style.left=o+"px"}},Blockly.Gesture=function(e,t){this.mouseDownXY_=null,this.currentDragDeltaXY_=0,this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=t,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=e,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1},Blockly.Gesture.prototype.dispose=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&Blockly.unbindEvent_(this.onMoveWrapper_),this.onUpWrapper_&&Blockly.unbindEvent_(this.onUpWrapper_),this.flyout_=this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=null,this.blockDragger_&&(this.blockDragger_.dispose(),this.blockDragger_=null),this.workspaceDragger_&&(this.workspaceDragger_.dispose(),this.workspaceDragger_=null),this.bubbleDragger_&&(this.bubbleDragger_.dispose(),this.bubbleDragger_=null)},Blockly.Gesture.prototype.updateFromEvent_=function(e){var t=new goog.math.Coordinate(e.clientX,e.clientY);this.updateDragDelta_(t)&&(this.updateIsDragging_(),Blockly.longStop_()),this.mostRecentEvent_=e},Blockly.Gesture.prototype.updateDragDelta_=function(e){return this.currentDragDeltaXY_=goog.math.Coordinate.difference(e,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=goog.math.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?Blockly.FLYOUT_DRAG_RADIUS:Blockly.DRAG_RADIUS))},Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!this.targetBlock_.disabled&&(!(this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_))&&(this.startWorkspace_=this.flyout_.targetWorkspace_,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),!0))},Blockly.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},Blockly.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},Blockly.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=this.flyout_?new Blockly.FlyoutDragger(this.flyout_):new Blockly.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},Blockly.Gesture.prototype.updateIsDragging_=function(){goog.asserts.assert(!this.calledUpdateIsDragging_,"updateIsDragging_ should only be called once per gesture."),this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},Blockly.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new Blockly.BlockDragger(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_),this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)},Blockly.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new Blockly.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},Blockly.Gesture.prototype.doStart=function(e){Blockly.utils.isTargetInput(e)?this.cancel():(this.hasStarted_=!0,Blockly.BlockSvg.disconnectUiStop_(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,Blockly.hideChaff(!!this.flyout_),Blockly.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),Blockly.utils.isRightButton(e)?this.handleRightClick(e):((goog.string.caseInsensitiveEquals(e.type,"touchstart")||goog.string.caseInsensitiveEquals(e.type,"pointerdown"))&&Blockly.longStart_(e,this),this.mouseDownXY_=new goog.math.Coordinate(e.clientX,e.clientY),this.bindMouseEvents(e)))},Blockly.Gesture.prototype.bindMouseEvents=function(e){this.onMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this)),e.preventDefault(),e.stopPropagation()},Blockly.Gesture.prototype.handleMove=function(e){this.updateFromEvent_(e),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()},Blockly.Gesture.prototype.handleUp=function(e){this.updateFromEvent_(e),Blockly.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(e,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(),e.preventDefault(),e.stopPropagation(),this.dispose())},Blockly.Gesture.prototype.cancel=function(){this.isEnding_||(Blockly.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},Blockly.Gesture.prototype.handleRightClick=function(e){this.targetBlock_?(this.bringBlockToFront_(),Blockly.hideChaff(this.flyout_),this.targetBlock_.showContextMenu_(e)):this.startWorkspace_&&!this.flyout_&&(Blockly.hideChaff(),this.startWorkspace_.showContextMenu_(e)),e.preventDefault(),e.stopPropagation(),this.dispose()},Blockly.Gesture.prototype.handleWsStart=function(e,t){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleWsStart, but the gesture had already been started."),this.setStartWorkspace_(t),this.mostRecentEvent_=e,this.doStart(e)},Blockly.Gesture.prototype.handleFlyoutStart=function(e,t){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleFlyoutStart, but the gesture had already been started."),this.setStartFlyout_(t),this.handleWsStart(e,t.getWorkspace())},Blockly.Gesture.prototype.handleBlockStart=function(e,t){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleBlockStart, but the gesture had already been started."),this.setStartBlock(t),this.mostRecentEvent_=e},Blockly.Gesture.prototype.handleBubbleStart=function(e,t){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleBubbleStart, but the gesture had already been started."),this.setStartBubble(t),this.mostRecentEvent_=e},Blockly.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.promote_()},Blockly.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor_(),this.bringBlockToFront_()},Blockly.Gesture.prototype.doBlockClick_=function(){this.flyout_&&this.flyout_.autoClose?this.targetBlock_.disabled||(Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump()):Blockly.Events.fire(new Blockly.Events.Ui(this.startBlock_,"click",void 0,void 0)),this.bringBlockToFront_(),Blockly.Events.setGroup(!1)},Blockly.Gesture.prototype.doWorkspaceClick_=function(){Blockly.selected&&Blockly.selected.unselect()},Blockly.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},Blockly.Gesture.prototype.setStartField=function(e){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.setStartField, but the gesture had already been started."),this.startField_||(this.startField_=e)},Blockly.Gesture.prototype.setStartBubble=function(e){this.startBubble_||(this.startBubble_=e)},Blockly.Gesture.prototype.setStartBlock=function(e){this.startBlock_||(this.startBlock_=e,e.isInFlyout&&e!=e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))},Blockly.Gesture.prototype.setTargetBlock_=function(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e},Blockly.Gesture.prototype.setStartWorkspace_=function(e){this.startWorkspace_||(this.startWorkspace_=e)},Blockly.Gesture.prototype.setStartFlyout_=function(e){this.flyout_||(this.flyout_=e)},Blockly.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},Blockly.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},Blockly.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isCurrentlyEditable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},Blockly.Gesture.prototype.isWorkspaceClick_=function(){return!this.startBlock_&&!this.startField_&&!this.hasExceededDragRadius_},Blockly.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},Blockly.Gesture.prototype.hasStarted=function(){return this.hasStarted_},Blockly.utils={},Blockly.utils.getMessageArray_=function(){return goog.global.Blockly.Msg},Blockly.utils.removeAttribute=function(e,t){goog.userAgent.IE&&goog.userAgent.isVersion("10.0")?e.setAttribute(t,null):e.removeAttribute(t)},Blockly.utils.addClass=function(e,t){var o=e.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+t+" ")&&(o&&(o+=" "),e.setAttribute("class",o+t),!0)},Blockly.utils.removeClass=function(e,t){var o=e.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+t+" "))return!1;o=o.split(/\s+/);for(var i=0;i<o.length;i++)o[i]&&o[i]!=t||(o.splice(i,1),i--);return o.length?e.setAttribute("class",o.join(" ")):Blockly.utils.removeAttribute(e,"class"),!0},Blockly.utils.hasClass=function(e,t){return-1!=(" "+e.getAttribute("class")+" ").indexOf(" "+t+" ")},Blockly.utils.noEvent=function(e){e.preventDefault(),e.stopPropagation()},Blockly.utils.isTargetInput=function(e){return"textarea"==e.target.type||"text"==e.target.type||"number"==e.target.type||"email"==e.target.type||"password"==e.target.type||"search"==e.target.type||"tel"==e.target.type||"url"==e.target.type||e.target.isContentEditable},Blockly.utils.getRelativeXY=function(e){var t=new goog.math.Coordinate(0,0),o=e.getAttribute("x");return o&&(t.x=parseInt(o,10)),(o=e.getAttribute("y"))&&(t.y=parseInt(o,10)),(o=(o=e.getAttribute("transform"))&&o.match(Blockly.utils.getRelativeXY.XY_REGEX_))&&(t.x+=parseFloat(o[1]),o[3]&&(t.y+=parseFloat(o[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&((o=e.match(Blockly.utils.getRelativeXY.XY_2D_REGEX_))||(o=e.match(Blockly.utils.getRelativeXY.XY_3D_REGEX_)),o&&(t.x+=parseFloat(o[1]),o[3]&&(t.y+=parseFloat(o[3])))),t},Blockly.utils.getInjectionDivXY_=function(e){for(var t=0,o=0;e;){var i=Blockly.utils.getRelativeXY(e),n=Blockly.utils.getScale_(e);if(t=t*n+i.x,o=o*n+i.y,-1!=(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new goog.math.Coordinate(t,o)},Blockly.utils.getScale_=function(e){var t=1;return(e=e.getAttribute("transform"))&&(e=e.match(Blockly.utils.getScale_.REGEXP_))&&e[0]&&(t=parseFloat(e[0])),t},Blockly.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*\))?/,Blockly.utils.getScale_REGEXP_=/scale\(\s*([-+\d.e]+)\s*\)/,Blockly.utils.getRelativeXY.XY_3D_REGEX_=/transform:\s*translate3d\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px([ ,]\s*([-+\d.e]+)\s*)px\)?/,Blockly.utils.getRelativeXY.XY_2D_REGEX_=/transform:\s*translate\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px\)?/,Blockly.utils.createSvgElement=function(e,t,o){for(var i in e=document.createElementNS(Blockly.SVG_NS,e),t)e.setAttribute(i,t[i]);return document.body.runtimeStyle&&(e.runtimeStyle=e.currentStyle=e.style),o&&o.appendChild(e),e},Blockly.utils.isRightButton=function(e){return!(!e.ctrlKey||!goog.userAgent.MAC)||2==e.button},Blockly.utils.mouseToSvg=function(e,t,o){var i=t.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,o||(o=t.getScreenCTM().inverse()),i.matrixTransform(o)},Blockly.utils.shortestStringLength=function(e){return e.length?e.reduce(function(e,t){return e.length<t.length?e:t}).length:0},Blockly.utils.commonWordPrefix=function(e,t){if(!e.length)return 0;if(1==e.length)return e[0].length;for(var o=0,i=t||Blockly.utils.shortestStringLength(e),n=0;n<i;n++){for(var r=e[0][n],s=1;s<e.length;s++)if(r!=e[s][n])return o;" "==r&&(o=n+1)}for(s=1;s<e.length;s++)if((r=e[s][n])&&" "!=r)return o;return i},Blockly.utils.commonWordSuffix=function(e,t){if(!e.length)return 0;if(1==e.length)return e[0].length;for(var o=0,i=t||Blockly.utils.shortestStringLength(e),n=0;n<i;n++){for(var r=e[0].substr(-n-1,1),s=1;s<e.length;s++)if(r!=e[s].substr(-n-1,1))return o;" "==r&&(o=n+1)}for(s=1;s<e.length;s++)if((r=e[s].charAt(e[s].length-n-1))&&" "!=r)return o;return i},Blockly.utils.tokenizeInterpolation=function(e){return Blockly.utils.tokenizeInterpolation_(e,!0)},Blockly.utils.replaceMessageReferences=function(e){return goog.isString(e)?(e=Blockly.utils.tokenizeInterpolation_(e,!1)).length?e[0]:"":e},Blockly.utils.checkMessageReferences=function(e){for(var t=!0,o=Blockly.utils.getMessageArray_(),i=/%{(BKY_[A-Z][A-Z0-9_]*)}/gi,n=i.exec(e);n;){var r=n[1];"BKY_"!=(r=r.toUpperCase()).substr(0,4)?(console.log("WARNING: Unsupported message table prefix in %{"+n[1]+"}."),t=!1):void 0==o[r.substr(4)]&&(console.log("WARNING: No message string for %{"+n[1]+"}."),t=!1),e=e.substring(n.index+r.length+1),n=i.exec(e)}return t},Blockly.utils.tokenizeInterpolation_=function(e,t){var o=[],i=e.split("");i.push("");for(var n=0,r=[],s=null,a=0;a<i.length;a++){var l=i[a];0==n?"%"==l?((l=r.join(""))&&o.push(l),r.length=0,n=1):r.push(l):1==n?"%"==l?(r.push(l),n=0):t&&"0"<=l&&"9">=l?(n=2,s=l,(l=r.join(""))&&o.push(l),r.length=0):"{"==l?n=3:(r.push("%",l),n=0):2==n?"0"<=l&&"9">=l?s+=l:(o.push(parseInt(s,10)),a--,n=0):3==n&&(""==l?(r.splice(0,0,"%{"),a--,n=0):"}"!=l?r.push(l):(n=r.join(""),/[a-zA-Z][a-zA-Z0-9_]*/.test(n)?(l=n.toUpperCase(),(l=goog.string.startsWith(l,"BKY_")?l.substring(4):null)&&l in Blockly.utils.getMessageArray_()?(n=Blockly.utils.getMessageArray_()[l],goog.isString(n)?Array.prototype.push.apply(o,Blockly.utils.tokenizeInterpolation_(n,t)):t?o.push(String(n)):o.push(n)):o.push("%{"+n+"}")):o.push("%{"+n+"}"),n=r.length=0))}for((l=r.join(""))&&o.push(l),i=[],a=r.length=0;a<o.length;++a)"string"==typeof o[a]?r.push(o[a]):((l=r.join(""))&&i.push(l),r.length=0,i.push(o[a]));return(l=r.join(""))&&i.push(l),r.length=0,i},Blockly.utils.genUid=function(){for(var e=Blockly.utils.genUid.soup_.length,t=[],o=0;20>o;o++)t[o]=Blockly.utils.genUid.soup_.charAt(Math.random()*e);return t.join("")},Blockly.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Blockly.utils.wrap=function(e,t){for(var o=e.split("\n"),i=0;i<o.length;i++)o[i]=Blockly.utils.wrapLine_(o[i],t);return o.join("\n")},Blockly.utils.wrapLine_=function(e,t){if(e.length<=t)return e;for(var o=e.trim().split(/\s+/),i=0;i<o.length;i++)o[i].length>t&&(t=o[i].length);i=-1/0;var n=1;do{var r=i,s=e,a=[],l=o.length/n,c=1;for(i=0;i<o.length-1;i++)c<(i+1.5)/l?(c++,a[i]=!0):a[i]=!1;a=Blockly.utils.wrapMutate_(o,a,t),i=Blockly.utils.wrapScore_(o,a,t),e=Blockly.utils.wrapToText_(o,a),n++}while(i>r);return s},Blockly.utils.wrapScore_=function(e,t,o){for(var i=[0],n=[],r=0;r<e.length;r++)i[i.length-1]+=e[r].length,!0===t[r]?(i.push(0),n.push(e[r].charAt(e[r].length-1))):!1===t[r]&&i[i.length-1]++;for(e=Math.max.apply(Math,i),r=t=0;r<i.length;r++)t-=2*Math.pow(Math.abs(o-i[r]),1.5),t-=Math.pow(e-i[r],1.5),-1!=".?!".indexOf(n[r])?t+=o/3:-1!=",;)]}".indexOf(n[r])&&(t+=o/4);return 1<i.length&&i[i.length-1]<=i[i.length-2]&&(t+=.5),t},Blockly.utils.wrapMutate_=function(e,t,o){for(var i,n=Blockly.utils.wrapScore_(e,t,o),r=0;r<t.length-1;r++)if(t[r]!=t[r+1]){var s=[].concat(t);s[r]=!s[r],s[r+1]=!s[r+1];var a=Blockly.utils.wrapScore_(e,s,o);a>n&&(n=a,i=s)}return i?Blockly.utils.wrapMutate_(e,i,o):t},Blockly.utils.wrapToText_=function(e,t){for(var o=[],i=0;i<e.length;i++)o.push(e[i]),void 0!==t[i]&&o.push(t[i]?"\n":" ");return o.join("")},Blockly.utils.is3dSupported=function(){if(void 0!==Blockly.utils.is3dSupported.cached_)return Blockly.utils.is3dSupported.cached_;if(!goog.global.getComputedStyle)return!1;var e=document.createElement("p"),t="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var i in document.body.insertBefore(e,null),o)if(void 0!==e.style[i]){if(e.style[i]="translate3d(1px,1px,1px)",!(t=goog.global.getComputedStyle(e)))return document.body.removeChild(e),!1;t=t.getPropertyValue(o[i])}return document.body.removeChild(e),Blockly.utils.is3dSupported.cached_="none"!==t,Blockly.utils.is3dSupported.cached_},Blockly.utils.insertAfter_=function(e,t){var o=t.nextSibling,i=t.parentNode;if(!i)throw"Reference node has no parent.";o?i.insertBefore(e,o):i.appendChild(e)},Blockly.utils.runAfterPageLoad=function(e){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else var t=setInterval(function(){"complete"===document.readyState&&(clearInterval(t),e())},10)},Blockly.utils.setCssTransform=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},Blockly.utils.getViewportBBox=function(){var e=goog.dom.getViewportSize(),t=goog.style.getViewportPageOffset(document);return{right:e.width+t.x,bottom:e.height+t.y,top:t.y,left:t.x}},Blockly.Grid=function(e,t){this.gridPattern_=e,this.spacing_=t.spacing,this.length_=t.length,this.line2_=(this.line1_=e.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=t.snap},Blockly.Grid.prototype.scale_=1,Blockly.Grid.prototype.dispose=function(){this.gridPattern_=null},Blockly.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},Blockly.Grid.prototype.getSpacing=function(){return this.spacing_},Blockly.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},Blockly.Grid.prototype.update=function(e){this.scale_=e;var t=this.spacing_*e||100;this.gridPattern_.setAttribute("width",t),this.gridPattern_.setAttribute("height",t);var o=(t=Math.floor(this.spacing_/2)+.5)-this.length_/2,i=t+this.length_/2;t*=e,o*=e,i*=e,this.setLineAttributes_(this.line1_,e,o,i,t,t),this.setLineAttributes_(this.line2_,e,t,t,o,i)},Blockly.Grid.prototype.setLineAttributes_=function(e,t,o,i,n,r){e&&(e.setAttribute("stroke-width",t),e.setAttribute("x1",o),e.setAttribute("y1",n),e.setAttribute("x2",i),e.setAttribute("y2",r))},Blockly.Grid.prototype.moveTo=function(e,t){this.gridPattern_.setAttribute("x",e),this.gridPattern_.setAttribute("y",t),(goog.userAgent.IE||goog.userAgent.EDGE)&&this.update(this.scale_)},Blockly.Grid.createDom=function(e,t,o){return e=Blockly.utils.createSvgElement("pattern",{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},o),0<t.length&&0<t.spacing&&(Blockly.utils.createSvgElement("line",{stroke:t.colour},e),1<t.length&&Blockly.utils.createSvgElement("line",{stroke:t.colour},e)),e},Blockly.Options=function(e){var t=!!e.readOnly;if(t)var o=null,i=!1,n=!1,r=!1,s=!1,a=!1,l=!1;else i=!(!(o=Blockly.Options.parseToolboxTree(e.toolbox))||!o.getElementsByTagName("category").length),void 0===(n=e.trashcan)&&(n=i),void 0===(r=e.collapse)&&(r=i),void 0===(s=e.comments)&&(s=i),void 0===(a=e.disable)&&(a=i),void 0===(l=e.sounds)&&(l=!0);var c=!!e.rtl,u=e.horizontalLayout;void 0===u&&(u=!1);var h=e.toolboxPosition;h="end"!==h,h=u?h?Blockly.TOOLBOX_AT_TOP:Blockly.TOOLBOX_AT_BOTTOM:h==c?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT;var g=e.scrollbars;void 0===g&&(g=i);var d=e.css;void 0===d&&(d=!0);var p="https://blockly-demo.appspot.com/static/media/";e.media?p=e.media:e.path&&(p=e.path+"media/");var f=void 0===e.oneBasedIndex||!!e.oneBasedIndex;this.RTL=c,this.oneBasedIndex=f,this.collapse=r,this.comments=s,this.disable=a,this.readOnly=t,this.maxBlocks=e.maxBlocks||1/0,this.pathToMedia=p,this.hasCategories=i,this.hasScrollbars=g,this.hasTrashcan=n,this.hasSounds=l,this.hasCss=d,this.horizontalLayout=u,this.languageTree=o,this.gridOptions=Blockly.Options.parseGridOptions_(e),this.zoomOptions=Blockly.Options.parseZoomOptions_(e),this.toolboxPosition=h},Blockly.Options.prototype.parentWorkspace=null,Blockly.Options.prototype.setMetrics=null,Blockly.Options.prototype.getMetrics=null,Blockly.Options.parseZoomOptions_=function(e){e=e.zoom||{};var t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:parseFloat(e.startScale),t.maxScale=void 0===e.maxScale?3:parseFloat(e.maxScale),t.minScale=void 0===e.minScale?.3:parseFloat(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:parseFloat(e.scaleSpeed),t},Blockly.Options.parseGridOptions_=function(e){e=e.grid||{};var t={};return t.spacing=parseFloat(e.spacing)||0,t.colour=e.colour||"#888",t.length=parseFloat(e.length)||1,t.snap=0<t.spacing&&!!e.snap,t},Blockly.Options.parseToolboxTree=function(e){return e?("string"!=typeof e&&("undefined"==typeof XSLTProcessor&&e.outerHTML?e=e.outerHTML:e instanceof Element||(e=null)),"string"==typeof e&&(e=Blockly.Xml.textToDom(e))):e=null,e},Blockly.ScrollbarPair=function(e){this.workspace_=e,this.hScroll=new Blockly.Scrollbar(e,!0,!0,"blocklyMainWorkspaceScrollbar"),this.vScroll=new Blockly.Scrollbar(e,!1,!0,"blocklyMainWorkspaceScrollbar"),this.corner_=Blockly.utils.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),Blockly.utils.insertAfter_(this.corner_,e.getBubbleCanvas())},Blockly.ScrollbarPair.prototype.oldHostMetrics_=null,Blockly.ScrollbarPair.prototype.dispose=function(){goog.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll.dispose(),this.hScroll=null,this.vScroll.dispose(),this.vScroll=null},Blockly.ScrollbarPair.prototype.resize=function(){var e=this.workspace_.getMetrics();if(e){var t=!1,o=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==e.contentWidth&&this.oldHostMetrics_.viewLeft==e.viewLeft&&this.oldHostMetrics_.contentLeft==e.contentLeft||(t=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==e.contentHeight&&this.oldHostMetrics_.viewTop==e.viewTop&&this.oldHostMetrics_.contentTop==e.contentTop||(o=!0)):o=t=!0,t&&this.hScroll.resize(e),o&&this.vScroll.resize(e),this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position_.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position_.y),this.oldHostMetrics_=e}},Blockly.ScrollbarPair.prototype.set=function(e,t){var o={},i=e*this.hScroll.ratio_,n=t*this.vScroll.ratio_,r=this.vScroll.scrollViewSize_;o.x=this.getRatio_(i,this.hScroll.scrollViewSize_),o.y=this.getRatio_(n,r),this.workspace_.setMetrics(o),this.hScroll.setHandlePosition(i),this.vScroll.setHandlePosition(n)},Blockly.ScrollbarPair.prototype.getRatio_=function(e,t){var o=e/t;return isNaN(o)?0:o},Blockly.Scrollbar=function(e,t,o,i){this.workspace_=e,this.pair_=o||!1,this.horizontal_=t,this.oldHostMetrics_=null,this.createDom_(i),this.position_=new goog.math.Coordinate(0,0),e=Blockly.Scrollbar.scrollbarThickness,t?(this.svgBackground_.setAttribute("height",e),this.outerSvg_.setAttribute("height",e),this.svgHandle_.setAttribute("height",e-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",e),this.outerSvg_.setAttribute("width",e),this.svgHandle_.setAttribute("width",e-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=Blockly.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},Blockly.Scrollbar.prototype.origin_=new goog.math.Coordinate(0,0),Blockly.Scrollbar.prototype.startDragMouse_=0,Blockly.Scrollbar.prototype.scrollViewSize_=0,Blockly.Scrollbar.prototype.handleLength_=0,Blockly.Scrollbar.prototype.handlePosition_=0,Blockly.Scrollbar.prototype.isVisible_=!0,Blockly.Scrollbar.prototype.containerVisible_=!0,Blockly.Scrollbar.scrollbarThickness=15,goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Scrollbar.scrollbarThickness=25),Blockly.Scrollbar.metricsAreEquivalent_=function(e,t){return!(!e||!t||e.viewWidth!=t.viewWidth||e.viewHeight!=t.viewHeight||e.viewLeft!=t.viewLeft||e.viewTop!=t.viewTop||e.absoluteTop!=t.absoluteTop||e.absoluteLeft!=t.absoluteLeft||e.contentWidth!=t.contentWidth||e.contentHeight!=t.contentHeight||e.contentLeft!=t.contentLeft||e.contentTop!=t.contentTop)},Blockly.Scrollbar.prototype.dispose=function(){this.cleanUp_(),Blockly.unbindEvent_(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,Blockly.unbindEvent_(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,goog.dom.removeNode(this.outerSvg_),this.workspace_=this.svgHandle_=this.svgBackground_=this.svgGroup_=this.outerSvg_=null},Blockly.Scrollbar.prototype.setHandleLength_=function(e){this.handleLength_=e,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},Blockly.Scrollbar.prototype.setHandlePosition=function(e){this.handlePosition_=e,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},Blockly.Scrollbar.prototype.setScrollViewSize_=function(e){this.scrollViewSize_=e,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)},Blockly.ScrollbarPair.prototype.setContainerVisible=function(e){this.hScroll.setContainerVisible(e),this.vScroll.setContainerVisible(e)},Blockly.Scrollbar.prototype.setPosition_=function(e,t){this.position_.x=e,this.position_.y=t,Blockly.utils.setCssTransform(this.outerSvg_,"translate("+(this.position_.x+this.origin_.x)+"px,"+(this.position_.y+this.origin_.y)+"px)")},Blockly.Scrollbar.prototype.resize=function(e){(e||(e=this.workspace_.getMetrics()))&&(Blockly.Scrollbar.metricsAreEquivalent_(e,this.oldHostMetrics_)||(this.oldHostMetrics_=e,this.horizontal_?this.resizeHorizontal_(e):this.resizeVertical_(e),this.onScroll_()))},Blockly.Scrollbar.prototype.resizeHorizontal_=function(e){this.resizeViewHorizontal(e)},Blockly.Scrollbar.prototype.resizeViewHorizontal=function(e){var t=e.viewWidth-1;this.pair_&&(t-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,t)),t=e.absoluteLeft+.5,this.pair_&&this.workspace_.RTL&&(t+=Blockly.Scrollbar.scrollbarThickness),this.setPosition_(t,e.absoluteTop+e.viewHeight-Blockly.Scrollbar.scrollbarThickness-.5),this.resizeContentHorizontal(e)},Blockly.Scrollbar.prototype.resizeContentHorizontal=function(e){this.pair_||this.setVisible(this.scrollViewSize_<e.contentWidth),this.ratio_=this.scrollViewSize_/e.contentWidth,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,e.viewWidth*this.ratio_)),this.setHandlePosition(this.constrainHandle_((e.viewLeft-e.contentLeft)*this.ratio_))},Blockly.Scrollbar.prototype.resizeVertical_=function(e){this.resizeViewVertical(e)},Blockly.Scrollbar.prototype.resizeViewVertical=function(e){var t=e.viewHeight-1;this.pair_&&(t-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,t)),t=e.absoluteLeft+.5,this.workspace_.RTL||(t+=e.viewWidth-Blockly.Scrollbar.scrollbarThickness-1),this.setPosition_(t,e.absoluteTop+.5),this.resizeContentVertical(e)},Blockly.Scrollbar.prototype.resizeContentVertical=function(e){this.pair_||this.setVisible(this.scrollViewSize_<e.contentHeight),this.ratio_=this.scrollViewSize_/e.contentHeight,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,e.viewHeight*this.ratio_)),this.setHandlePosition(this.constrainHandle_((e.viewTop-e.contentTop)*this.ratio_))},Blockly.Scrollbar.prototype.createDom_=function(e){var t="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");e&&(t+=" "+e),this.outerSvg_=Blockly.utils.createSvgElement("svg",{class:t},null),this.svgGroup_=Blockly.utils.createSvgElement("g",{},this.outerSvg_),this.svgBackground_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarBackground"},this.svgGroup_),e=Math.floor((Blockly.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarHandle",rx:e,ry:e},this.svgGroup_),Blockly.utils.insertAfter_(this.outerSvg_,this.workspace_.getParentSvg())},Blockly.Scrollbar.prototype.isVisible=function(){return this.isVisible_},Blockly.Scrollbar.prototype.setContainerVisible=function(e){var t=e!=this.containerVisible_;this.containerVisible_=e,t&&this.updateDisplay_()},Blockly.Scrollbar.prototype.setVisible=function(e){var t=e!=this.isVisible();if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";this.isVisible_=e,t&&this.updateDisplay_()},Blockly.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},Blockly.Scrollbar.prototype.onMouseDownBar_=function(e){if(this.workspace_.markFocused(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_(),Blockly.utils.isRightButton(e))e.stopPropagation();else{var t=Blockly.utils.mouseToSvg(e,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());t=this.horizontal_?t.x:t.y;var o=Blockly.utils.getInjectionDivXY_(this.svgHandle_);o=this.horizontal_?o.x:o.y;var i=this.handlePosition_,n=.95*this.handleLength_;t<=o?i-=n:t>=o+this.handleLength_&&(i+=n),this.setHandlePosition(this.constrainHandle_(i)),this.onScroll_(),e.stopPropagation(),e.preventDefault()}},Blockly.Scrollbar.prototype.onMouseDownHandle_=function(e){this.workspace_.markFocused(),this.cleanUp_(),Blockly.utils.isRightButton(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?e.clientX:e.clientY,Blockly.Scrollbar.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),Blockly.Scrollbar.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),e.stopPropagation(),e.preventDefault())},Blockly.Scrollbar.prototype.onMouseMoveHandle_=function(e){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?e.clientX:e.clientY)-this.startDragMouse_))),this.onScroll_()},Blockly.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_()},Blockly.Scrollbar.prototype.cleanUp_=function(){Blockly.hideChaff(!0),Blockly.Scrollbar.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseUpWrapper_),Blockly.Scrollbar.onMouseUpWrapper_=null),Blockly.Scrollbar.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseMoveWrapper_),Blockly.Scrollbar.onMouseMoveWrapper_=null)},Blockly.Scrollbar.prototype.constrainHandle_=function(e){return 0>=e||isNaN(e)||this.scrollViewSize_<this.handleLength_?0:Math.min(e,this.scrollViewSize_-this.handleLength_)},Blockly.Scrollbar.prototype.onScroll_=function(){var e=this.handlePosition_/this.scrollViewSize_;isNaN(e)&&(e=0);var t={};this.horizontal_?t.x=e:t.y=e,this.workspace_.setMetrics(t)},Blockly.Scrollbar.prototype.set=function(e){this.setHandlePosition(this.constrainHandle_(e*this.ratio_)),this.onScroll_()},Blockly.Scrollbar.prototype.setOrigin=function(e,t){this.origin_=new goog.math.Coordinate(e,t)},Blockly.Trashcan=function(e){this.workspace_=e},Blockly.Trashcan.prototype.WIDTH_=47,Blockly.Trashcan.prototype.BODY_HEIGHT_=44,Blockly.Trashcan.prototype.LID_HEIGHT_=16,Blockly.Trashcan.prototype.MARGIN_BOTTOM_=20,Blockly.Trashcan.prototype.MARGIN_SIDE_=20,Blockly.Trashcan.prototype.MARGIN_HOTSPOT_=10,Blockly.Trashcan.prototype.SPRITE_LEFT_=0,Blockly.Trashcan.prototype.SPRITE_TOP_=32,Blockly.Trashcan.prototype.isOpen=!1,Blockly.Trashcan.prototype.svgGroup_=null,Blockly.Trashcan.prototype.svgLid_=null,Blockly.Trashcan.prototype.lidTask_=0,Blockly.Trashcan.prototype.lidOpen_=0,Blockly.Trashcan.prototype.left_=0,Blockly.Trashcan.prototype.top_=0,Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyTrash"},null);var e=String(Math.random()).substring(2),t=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashBodyClipPath"+e},this.svgGroup_);return Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},t),Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup_).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),t=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashLidClipPath"+e},this.svgGroup_),Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.LID_HEIGHT_},t),this.svgLid_=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup_),this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click),this.animateLid_(),this.svgGroup_},Blockly.Trashcan.prototype.init=function(e){return this.bottom_=this.MARGIN_BOTTOM_+e,this.setOpen_(!1),this.bottom_+this.BODY_HEIGHT_+this.LID_HEIGHT_},Blockly.Trashcan.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,goog.Timer.clear(this.lidTask_)},Blockly.Trashcan.prototype.position=function(){var e=this.workspace_.getMetrics();e&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,e.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=e.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=e.absoluteLeft))):(this.left_=e.viewWidth+e.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,e.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=e.flyoutWidth)),this.top_=e.viewHeight+e.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.bottom_,e.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=e.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))},Blockly.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();return new goog.math.Rect(e.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,e.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_,this.WIDTH_+2*this.MARGIN_HOTSPOT_,this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_)},Blockly.Trashcan.prototype.setOpen_=function(e){this.isOpen!=e&&(goog.Timer.clear(this.lidTask_),this.isOpen=e,this.animateLid_())},Blockly.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isOpen?.2:-.2,this.lidOpen_=goog.math.clamp(this.lidOpen_,0,1);var e=45*this.lidOpen_;this.svgLid_.setAttribute("transform","rotate("+(this.workspace_.RTL?-e:e)+","+(this.workspace_.RTL?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")"),e=goog.math.lerp(.4,.8,this.lidOpen_),this.svgGroup_.style.opacity=e,0<this.lidOpen_&&1>this.lidOpen_&&(this.lidTask_=goog.Timer.callOnce(this.animateLid_,20,this))},Blockly.Trashcan.prototype.close=function(){this.setOpen_(!1)},Blockly.Trashcan.prototype.click=function(){var e=this.workspace_.startScrollX-this.workspace_.scrollX,t=this.workspace_.startScrollY-this.workspace_.scrollY;Math.sqrt(e*e+t*t)>Blockly.DRAG_RADIUS||console.log("TODO: Inspect trash.")},Blockly.VariableModel=function(e,t,o,i){this.workspace=e,this.name=t,this.type=o||"",this.id_=i||Blockly.utils.genUid(),Blockly.Events.fire(new Blockly.Events.VarCreate(this))},Blockly.VariableModel.prototype.getId=function(){return this.id_},Blockly.VariableModel.compareByName=function(e,t){return goog.string.caseInsensitiveCompare(e.name,t.name)},Blockly.Variables={},Blockly.Variables.NAME_TYPE=Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.allUsedVarModels=function(e){var t=e.getAllBlocks();e=Object.create(null);for(var o=0;o<t.length;o++){var i=t[o].getVarModels();if(i)for(var n=0;n<i.length;n++){var r=i[n];r.getId()&&(e[r.getId()]=r)}}for(var s in t=[],e)t.push(e[s]);return t},Blockly.Variables.allUsedVariables=function(){console.warn("Deprecated call to Blockly.Variables.allUsedVariables. Use Blockly.Variables.allUsedVarModels instead.\nIf this is a major issue please file a bug on GitHub.")},Blockly.Variables.allDeveloperVariables=function(e){var t=e.getAllBlocks();e={};for(var o=0;o<t.length;o++){var i=t[o];if(i.getDeveloperVars){i=i.getDeveloperVars();for(var n=0;n<i.length;n++)e[i[n]]=i[n]}}for(var r in t=[],e)t.push(e[r]);return t},Blockly.Variables.flyoutCategory=function(e){var t=[],o=goog.dom.createDom("button");return o.setAttribute("text",Blockly.Msg.NEW_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(e){Blockly.Variables.createVariableButtonHandler(e.getTargetWorkspace())}),t.push(o),e=Blockly.Variables.flyoutCategoryBlocks(e),t.concat(e)},Blockly.Variables.flyoutCategoryBlocks=function(e){(e=e.getVariablesOfType("")).sort(Blockly.VariableModel.compareByName);var t=[];if(0<e.length){var o=e[0];if(Blockly.Blocks.variables_set){var i=Blockly.Blocks.math_change?8:24;i='<xml><block type="variables_set" gap="'+i+'">'+Blockly.Variables.generateVariableFieldXml_(o)+"</block></xml>",i=Blockly.Xml.textToDom(i).firstChild,t.push(i)}for(Blockly.Blocks.math_change&&(i='<xml><block type="math_change" gap="'+(i=Blockly.Blocks.variables_get?20:8)+'">'+Blockly.Variables.generateVariableFieldXml_(o)+'<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value></block></xml>',i=Blockly.Xml.textToDom(i).firstChild,t.push(i)),o=0;i=e[o];o++)Blockly.Blocks.variables_get&&(i='<xml><block type="variables_get" gap="8">'+Blockly.Variables.generateVariableFieldXml_(i)+"</block></xml>",i=Blockly.Xml.textToDom(i).firstChild,t.push(i))}return t},Blockly.Variables.generateUniqueName=function(e){var t="";if((e=e.getAllVariables()).length)for(var o=1,i=0,n="ijkmnopqrstuvwxyzabcdefgh".charAt(i);!t;){for(var r=!1,s=0;s<e.length;s++)if(e[s].name.toLowerCase()==n){r=!0;break}r?(25==++i&&(i=0,o++),n="ijkmnopqrstuvwxyzabcdefgh".charAt(i),1<o&&(n+=o)):t=n}else t="i";return t},Blockly.Variables.createVariableButtonHandler=function(e,t,o){var i=o||"",n=function(o){Blockly.Variables.promptName(Blockly.Msg.NEW_VARIABLE_TITLE,o,function(o){if(o){var r=Blockly.Variables.nameUsedWithAnyType_(o,e);if(r){var s=o.toLowerCase();if(r.type==i)var a=Blockly.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",s);else a=(a=Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s).replace("%2",r.type);Blockly.alert(a,function(){n(o)})}else e.createVariable(o,i),t&&t(o)}else t&&t(null)})};n("")},goog.exportSymbol("Blockly.Variables.createVariableButtonHandler",Blockly.Variables.createVariableButtonHandler),Blockly.Variables.createVariable=Blockly.Variables.createVariableButtonHandler,goog.exportSymbol("Blockly.Variables.createVariable",Blockly.Variables.createVariable),Blockly.Variables.renameVariable=function(e,t,o){var i=function(n){var r=Blockly.Msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);Blockly.Variables.promptName(r,n,function(n){if(n){var r=Blockly.Variables.nameUsedWithOtherType_(n,t.type,e);r?(r=Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",n.toLowerCase()).replace("%2",r.type),Blockly.alert(r,function(){i(n)})):(e.renameVariableById(t.getId(),n),o&&o(n))}else o&&o(null)})};i("")},Blockly.Variables.promptName=function(e,t,o){Blockly.prompt(e,t,function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==Blockly.Msg.RENAME_VARIABLE||e==Blockly.Msg.NEW_VARIABLE)&&(e=null),o(e)})},Blockly.Variables.nameUsedWithOtherType_=function(e,t,o){o=o.getVariableMap().getAllVariables(),e=e.toLowerCase();for(var i,n=0;i=o[n];n++)if(i.name.toLowerCase()==e&&i.type!=t)return i;return null},Blockly.Variables.nameUsedWithAnyType_=function(e,t){var o=t.getVariableMap().getAllVariables();e=e.toLowerCase();for(var i,n=0;i=o[n];n++)if(i.name.toLowerCase()==e)return i;return null},Blockly.Variables.generateVariableFieldXml_=function(e){var t=e.type;return""==t&&(t="''"),'<field name="VAR" id="'+e.getId()+'" variabletype="'+goog.string.htmlEscape(t)+'">'+goog.string.htmlEscape(e.name)+"</field>"},Blockly.Variables.getOrCreateVariablePackage=function(e,t,o,i){var n=Blockly.Variables.getVariable(e,t,o,i);return n||(n=Blockly.Variables.createVariable_(e,t,o,i)),n},Blockly.Variables.getVariable=function(e,t,o,i){var n=e.getPotentialVariableMap();if(t){var r=e.getVariableById(t);!r&&n&&(r=n.getVariableById(t))}else if(o){if(void 0==i)throw Error("Tried to look up a variable by name without a type");!(r=e.getVariable(o,i))&&n&&(r=n.getVariable(o,i))}return r},Blockly.Variables.createVariable_=function(e,t,o,i){var n=e.getPotentialVariableMap();return o||(o=Blockly.Variables.generateUniqueName(e.isFlyout?e.targetWorkspace:e)),n?n.createVariable(o,i,t):e.createVariable(o,i,t)},Blockly.Variables.getAddedVariables=function(e,t){var o=e.getAllVariables(),i=[];if(t.length!=o.length)for(var n=0;n<o.length;n++){var r=o[n];t.includes(r)||i.push(r)}return i},Blockly.VariablesDynamic={},Blockly.VariablesDynamic.onCreateVariableButtonClick_String=function(e){Blockly.Variables.createVariableButtonHandler(e.getTargetWorkspace(),null,"String")},Blockly.VariablesDynamic.onCreateVariableButtonClick_Number=function(e){Blockly.Variables.createVariableButtonHandler(e.getTargetWorkspace(),null,"Number")},Blockly.VariablesDynamic.onCreateVariableButtonClick_Colour=function(e){Blockly.Variables.createVariableButtonHandler(e.getTargetWorkspace(),null,"Colour")},Blockly.VariablesDynamic.flyoutCategory=function(e){var t=[],o=goog.dom.createDom("button");return o.setAttribute("text",Blockly.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(o),(o=goog.dom.createDom("button")).setAttribute("text",Blockly.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(o),(o=goog.dom.createDom("button")).setAttribute("text",Blockly.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(o),e.registerButtonCallback("CREATE_VARIABLE_STRING",Blockly.VariablesDynamic.onCreateVariableButtonClick_String),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Blockly.VariablesDynamic.onCreateVariableButtonClick_Number),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Blockly.VariablesDynamic.onCreateVariableButtonClick_Colour),e=Blockly.VariablesDynamic.flyoutCategoryBlocks(e),t.concat(e)},Blockly.VariablesDynamic.flyoutCategoryBlocks=function(e){(e=e.getAllVariables()).sort(Blockly.VariableModel.compareByName);var t=[];if(0<e.length){if(Blockly.Blocks.variables_set_dynamic){var o='<xml><block type="variables_set_dynamic" gap="24">'+Blockly.Variables.generateVariableFieldXml_(e[0])+"</block></xml>";o=Blockly.Xml.textToDom(o).firstChild,t.push(o)}if(Blockly.Blocks.variables_get_dynamic)for(var i=0;o=e[i];i++)o='<xml><block type="variables_get_dynamic" gap="8">'+Blockly.Variables.generateVariableFieldXml_(o)+"</block></xml>",o=Blockly.Xml.textToDom(o).firstChild,t.push(o)}return t},Blockly.WorkspaceAudio=function(e){this.parentWorkspace_=e,this.SOUNDS_=Object.create(null)},Blockly.WorkspaceAudio.prototype.lastSound_=null,Blockly.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},Blockly.WorkspaceAudio.prototype.load=function(e,t){if(e.length){try{var o=new window.Audio}catch(e){return}for(var i,n=0;n<e.length;n++){var r=e[n],s=r.match(/\.(\w+)$/);if(s&&o.canPlayType("audio/"+s[1])){i=new window.Audio(r);break}}i&&i.play&&(this.SOUNDS_[t]=i)}},Blockly.WorkspaceAudio.prototype.preload=function(){for(var e in this.SOUNDS_){var t=this.SOUNDS_[e];if(t.volume=.01,t.play(),t.pause(),goog.userAgent.IPAD||goog.userAgent.IPHONE)break}},Blockly.WorkspaceAudio.prototype.play=function(e,t){var o=this.SOUNDS_[e];if(o){var i=new Date;null!=this.lastSound_&&i-this.lastSound_<Blockly.SOUND_LIMIT||(this.lastSound_=i,(o=goog.userAgent.DOCUMENT_MODE&&9===goog.userAgent.DOCUMENT_MODE||goog.userAgent.IPAD||goog.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===t?1:t,o.play())}else this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(e,t)},Blockly.WorkspaceDragSurfaceSvg=function(e){this.container_=e,this.createDom()},Blockly.WorkspaceDragSurfaceSvg.prototype.SVG_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.dragGroup_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.container_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},Blockly.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(e,t){e=e.toFixed(0),t=t.toFixed(0),this.SVG_.style.display="block",Blockly.utils.setCssTransform(this.SVG_,"translate3d("+e+"px, "+t+"px, 0px)")},Blockly.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return Blockly.utils.getRelativeXY(this.SVG_)},Blockly.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(e){var t=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(t&&o&&Blockly.utils.hasClass(t,"blocklyBlockCanvas")&&Blockly.utils.hasClass(o,"blocklyBubbleCanvas")))throw"Couldn't clear and hide the drag surface.  A node was missing.";null!=this.previousSibling_?Blockly.utils.insertAfter_(t,this.previousSibling_):e.insertBefore(t,e.firstChild),Blockly.utils.insertAfter_(o,t),this.SVG_.style.display="none",goog.asserts.assert(0==this.SVG_.childNodes.length,"Drag surface was not cleared."),Blockly.utils.setCssTransform(this.SVG_,""),this.previousSibling_=null},Blockly.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(e,t,o,i,n,r){goog.asserts.assert(0==this.SVG_.childNodes.length,"Already dragging a block."),this.previousSibling_=o,e.setAttribute("transform","translate(0, 0) scale("+r+")"),t.setAttribute("transform","translate(0, 0) scale("+r+")"),this.SVG_.setAttribute("width",i),this.SVG_.setAttribute("height",n),this.SVG_.appendChild(e),this.SVG_.appendChild(t),this.SVG_.style.display="block"},Blockly.Xml={},Blockly.Xml.workspaceToDom=function(e,t){var o=goog.dom.createDom("xml");o.appendChild(Blockly.Xml.variablesToDom(Blockly.Variables.allUsedVarModels(e)));for(var i,n=e.getTopBlocks(!0),r=0;i=n[r];r++)o.appendChild(Blockly.Xml.blockToDomWithXY(i,t));return o},Blockly.Xml.variablesToDom=function(e){for(var t,o=goog.dom.createDom("variables"),i=0;t=e[i];i++){var n=goog.dom.createDom("variable",null,t.name);n.setAttribute("type",t.type),n.setAttribute("id",t.getId()),o.appendChild(n)}return o},Blockly.Xml.blockToDomWithXY=function(e,t){var o;e.workspace.RTL&&(o=e.workspace.getWidth());var i=Blockly.Xml.blockToDom(e,t),n=e.getRelativeToSurfaceXY();return i.setAttribute("x",Math.round(e.workspace.RTL?o-n.x:n.x)),i.setAttribute("y",Math.round(n.y)),i},Blockly.Xml.fieldToDomVariable_=function(e){null==e.getValue()&&(e.initModel(),e.getValue());var t=e.getVariable();if(!t)throw Error("Tried to serialize a variable field with no variable.");var o=goog.dom.createDom("field",null,t.name);return o.setAttribute("name",e.name),o.setAttribute("id",t.getId()),o.setAttribute("variabletype",t.type),o},Blockly.Xml.fieldToDom_=function(e){if(e.name&&e.EDITABLE){if(e instanceof Blockly.FieldVariable)return Blockly.Xml.fieldToDomVariable_(e);var t=goog.dom.createDom("field",null,e.getValue());return t.setAttribute("name",e.name),t}return null},Blockly.Xml.allFieldsToDom_=function(e,t){for(var o,i=0;o=e.inputList[i];i++)for(var n,r=0;n=o.fieldRow[r];r++)(n=Blockly.Xml.fieldToDom_(n))&&t.appendChild(n)},Blockly.Xml.blockToDom=function(e,t){var o,i=goog.dom.createDom(e.isShadow()?"shadow":"block");if(i.setAttribute("type",e.type),t||i.setAttribute("id",e.id),e.mutationToDom){var n=e.mutationToDom();n&&(n.hasChildNodes()||n.hasAttributes())&&i.appendChild(n)}if(Blockly.Xml.allFieldsToDom_(e,i),n=e.getCommentText()){if(n=goog.dom.createDom("comment",null,n),"object"==typeof e.comment){n.setAttribute("pinned",e.comment.isVisible());var r=e.comment.getBubbleSize();n.setAttribute("h",r.height),n.setAttribute("w",r.width)}i.appendChild(n)}for(e.data&&(n=goog.dom.createDom("data",null,e.data),i.appendChild(n)),r=0;o=e.inputList[r];r++){var s,a=!0;if(o.type!=Blockly.DUMMY_INPUT){var l=o.connection.targetBlock();o.type==Blockly.INPUT_VALUE?s=goog.dom.createDom("value"):o.type==Blockly.NEXT_STATEMENT&&(s=goog.dom.createDom("statement")),!(n=o.connection.getShadowDom())||l&&l.isShadow()||s.appendChild(Blockly.Xml.cloneShadow_(n)),l&&(s.appendChild(Blockly.Xml.blockToDom(l,t)),a=!1),s.setAttribute("name",o.name),a||i.appendChild(s)}}return e.inputsInlineDefault!=e.inputsInline&&i.setAttribute("inline",e.inputsInline),e.isCollapsed()&&i.setAttribute("collapsed",!0),e.disabled&&i.setAttribute("disabled",!0),e.isDeletable()||e.isShadow()||i.setAttribute("deletable",!1),e.isMovable()||e.isShadow()||i.setAttribute("movable",!1),e.isEditable()||i.setAttribute("editable",!1),(r=e.getNextBlock())&&(s=goog.dom.createDom("next",null,Blockly.Xml.blockToDom(r,t)),i.appendChild(s)),!(n=e.nextConnection&&e.nextConnection.getShadowDom())||r&&r.isShadow()||s.appendChild(Blockly.Xml.cloneShadow_(n)),i},Blockly.Xml.cloneShadow_=function(e){for(var t,o=e=e.cloneNode(!0);o;)if(o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)t=o,o=o.parentNode,3==t.nodeType&&""==t.data.trim()&&o.firstChild!=t&&goog.dom.removeNode(t);o&&(t=o,o=o.nextSibling,3==t.nodeType&&""==t.data.trim()&&goog.dom.removeNode(t))}return e},Blockly.Xml.domToText=function(e){return(new XMLSerializer).serializeToString(e)},Blockly.Xml.domToPrettyText=function(e){e=Blockly.Xml.domToText(e).split("<");for(var t="",o=1;o<e.length;o++){var i=e[o];"/"==i[0]&&(t=t.substring(2)),e[o]=t+"<"+i,"/"!=i[0]&&"/>"!=i.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Blockly.Xml.textToDom=function(e){return(e=(new DOMParser).parseFromString(e,"text/xml"))&&e.firstChild&&"xml"==e.firstChild.nodeName.toLowerCase()&&e.firstChild===e.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree."),e.firstChild},Blockly.Xml.domToWorkspace=function(e,t){if(e instanceof Blockly.Workspace){var o=e;e=t,t=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var i;t.RTL&&(i=t.getWidth()),o=[],Blockly.Field.startCache();var n=e.childNodes.length,r=Blockly.Events.getGroup();r||Blockly.Events.setGroup(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);var s=!0;try{for(var a=0;a<n;a++){var l=e.childNodes[a],c=l.nodeName.toLowerCase();if("block"==c||"shadow"==c&&!Blockly.Events.recordUndo){var u=Blockly.Xml.domToBlock(l,t);o.push(u.id);var h=parseInt(l.getAttribute("x"),10),g=parseInt(l.getAttribute("y"),10);isNaN(h)||isNaN(g)||u.moveBy(t.RTL?i-h:h,g),s=!1}else if("shadow"==c)goog.asserts.fail("Shadow block cannot be a top-level block."),s=!1;else if("variables"==c){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Blockly.Xml.domToVariables(l,t),s=!1}}}finally{r||Blockly.Events.setGroup(!1),Blockly.Field.stopCache()}return t.setResizesEnabled&&t.setResizesEnabled(!0),o},Blockly.Xml.appendDomToWorkspace=function(e,t){if(t.hasOwnProperty("scale")){var o=Blockly.BlockSvg.TAB_WIDTH;try{Blockly.BlockSvg.TAB_WIDTH=0;var i=t.getBlocksBoundingBox()}finally{Blockly.BlockSvg.TAB_WIDTH=o}}if(o=Blockly.Xml.domToWorkspace(e,t),i&&i.height){var n,r=i.y+i.height,s=i.x,a=1/0,l=1/0;for(i=0;i<o.length;i++){var c=t.getBlockById(o[i]).getRelativeToSurfaceXY();c.y<l&&(l=c.y),c.x<a&&(a=c.x)}for(r=r-l+Blockly.BlockSvg.SEP_SPACE_Y,s-=a,t.RTL&&(n=t.getWidth()),i=0;i<o.length;i++)t.getBlockById(o[i]).moveBy(t.RTL?n-s:s,r)}return o},Blockly.Xml.domToBlock=function(e,t){if(e instanceof Blockly.Workspace){var o=e;e=t,t=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}Blockly.Events.disable(),o=t.getAllVariables();try{var i=Blockly.Xml.domToBlockHeadless_(e,t),n=i.getDescendants();if(t.rendered){i.setConnectionsHidden(!0);for(var r=n.length-1;0<=r;r--)n[r].initSvg();for(r=n.length-1;0<=r;r--)n[r].render(!1);setTimeout(function(){i.workspace&&i.setConnectionsHidden(!1)},1),i.updateDisabled(),t.resizeContents()}else for(r=n.length-1;0<=r;r--)n[r].initModel()}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled()){for(n=Blockly.Variables.getAddedVariables(t,o),r=0;r<n.length;r++)Blockly.Events.fire(new Blockly.Events.VarCreate(n[r]));Blockly.Events.fire(new Blockly.Events.BlockCreate(i))}return i},Blockly.Xml.domToVariables=function(e,t){for(var o,i=0;o=e.children[i];i++){var n=o.getAttribute("type"),r=o.getAttribute("id");if(o=o.textContent,null==n)throw Error("Variable with id, "+r+" is without a type");t.createVariable(o,n,r)}},Blockly.Xml.domToBlockHeadless_=function(e,t){var o=null,i=e.getAttribute("type");goog.asserts.assert(i,"Block type unspecified: %s",e.outerHTML);var n=e.getAttribute("id");o=t.newBlock(i,n);var r,s=null;for(n=0;r=e.childNodes[n];n++)if(3!=r.nodeType){for(var a,l=s=null,c=0;a=r.childNodes[c];c++)1==a.nodeType&&("block"==a.nodeName.toLowerCase()?s=a:"shadow"==a.nodeName.toLowerCase()&&(l=a));switch(!s&&l&&(s=l),c=r.getAttribute("name"),r.nodeName.toLowerCase()){case"mutation":o.domToMutation&&(o.domToMutation(r),o.initSvg&&o.initSvg());break;case"comment":o.setCommentText(r.textContent);var u=r.getAttribute("pinned");u&&!o.isInFlyout&&setTimeout(function(){o.comment&&o.comment.setVisible&&o.comment.setVisible("true"==u)},1),s=parseInt(r.getAttribute("w"),10),r=parseInt(r.getAttribute("h"),10),!isNaN(s)&&!isNaN(r)&&o.comment&&o.comment.setVisible&&o.comment.setBubbleSize(s,r);break;case"data":o.data=r.textContent;break;case"title":case"field":Blockly.Xml.domToField_(o,c,r);break;case"value":case"statement":if(!(r=o.getInput(c))){console.warn("Ignoring non-existent input "+c+" in block "+i);break}l&&r.connection.setShadowDom(l),s&&((s=Blockly.Xml.domToBlockHeadless_(s,t)).outputConnection?r.connection.connect(s.outputConnection):s.previousConnection?r.connection.connect(s.previousConnection):goog.asserts.fail("Child block does not have output or previous statement."));break;case"next":l&&o.nextConnection&&o.nextConnection.setShadowDom(l),s&&(goog.asserts.assert(o.nextConnection,"Next statement does not exist."),goog.asserts.assert(!o.nextConnection.isConnected(),"Next statement is already connected."),s=Blockly.Xml.domToBlockHeadless_(s,t),goog.asserts.assert(s.previousConnection,"Next block does not have previous statement."),o.nextConnection.connect(s.previousConnection));break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}}if((n=e.getAttribute("inline"))&&o.setInputsInline("true"==n),(n=e.getAttribute("disabled"))&&o.setDisabled("true"==n),(n=e.getAttribute("deletable"))&&o.setDeletable("true"==n),(n=e.getAttribute("movable"))&&o.setMovable("true"==n),(n=e.getAttribute("editable"))&&o.setEditable("true"==n),(n=e.getAttribute("collapsed"))&&o.setCollapsed("true"==n),"shadow"==e.nodeName.toLowerCase()){for(i=o.getChildren(),n=0;r=i[n];n++)goog.asserts.assert(r.isShadow(),"Shadow block not allowed non-shadow child.");goog.asserts.assert(0==o.getVarModels().length,"Shadow blocks cannot have variable references."),o.setShadow(!0)}return o},Blockly.Xml.domToFieldVariable_=function(e,t,o,i){var n=t.getAttribute("variabletype")||"";if("''"==n&&(n=""),e=Blockly.Variables.getOrCreateVariablePackage(e,t.id,o,n),null!=n&&n!==e.type)throw Error("Serialized variable type with id '"+e.getId()+"' had type "+e.type+", and does not match variable field that references it: "+Blockly.Xml.domToText(t)+".");i.setValue(e.getId())},Blockly.Xml.domToField_=function(e,t,o){var i=e.getField(t);i?(e=e.workspace,t=o.textContent,i instanceof Blockly.FieldVariable?Blockly.Xml.domToFieldVariable_(e,o,t,i):i.setValue(t)):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},Blockly.Xml.deleteNext=function(e){for(var t,o=0;t=e.childNodes[o];o++)if("next"==t.nodeName.toLowerCase()){e.removeChild(t);break}},goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.Xml||(goog.global.Blockly.Xml={}),goog.global.Blockly.Xml.domToText=Blockly.Xml.domToText,goog.global.Blockly.Xml.domToWorkspace=Blockly.Xml.domToWorkspace,goog.global.Blockly.Xml.textToDom=Blockly.Xml.textToDom,goog.global.Blockly.Xml.workspaceToDom=Blockly.Xml.workspaceToDom,Blockly.ZoomControls=function(e){this.workspace_=e},Blockly.ZoomControls.prototype.WIDTH_=32,Blockly.ZoomControls.prototype.HEIGHT_=110,Blockly.ZoomControls.prototype.MARGIN_BOTTOM_=20,Blockly.ZoomControls.prototype.MARGIN_SIDE_=20,Blockly.ZoomControls.prototype.svgGroup_=null,Blockly.ZoomControls.prototype.left_=0,Blockly.ZoomControls.prototype.top_=0,Blockly.ZoomControls.prototype.createDom=function(){var e=this.workspace_;this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyZoom"},null);var t=String(Math.random()).substring(2),o=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoomoutClipPath"+t},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:32,height:32,y:77},o);var i=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-64,y:-15,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.svgGroup_);i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),o=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoominClipPath"+t},this.svgGroup_),Blockly.utils.createSvgElement("rect",{width:32,height:32,y:43},o);var n=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-32,y:-49,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.svgGroup_);return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),o=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoomresetClipPath"+t},this.svgGroup_),Blockly.utils.createSvgElement("rect",{width:32,height:32},o),(o=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.svgGroup_)).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(o,"mousedown",null,function(t){e.markFocused(),e.setScale(e.options.zoomOptions.startScale),e.scrollCenter(),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}),Blockly.bindEventWithChecks_(n,"mousedown",null,function(t){e.markFocused(),e.zoomCenter(1),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}),Blockly.bindEventWithChecks_(i,"mousedown",null,function(t){e.markFocused(),e.zoomCenter(-1),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}),this.svgGroup_},Blockly.ZoomControls.prototype.init=function(e){return this.bottom_=this.MARGIN_BOTTOM_+e,this.bottom_+this.HEIGHT_},Blockly.ZoomControls.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=null},Blockly.ZoomControls.prototype.position=function(){var e=this.workspace_.getMetrics();e&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,e.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=e.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=e.absoluteLeft))):(this.left_=e.viewWidth+e.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,e.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=e.flyoutWidth)),this.top_=e.viewHeight+e.absoluteTop-this.HEIGHT_-this.bottom_,e.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=e.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))},Blockly.WorkspaceSvg=function(e,t,o){Blockly.WorkspaceSvg.superClass_.constructor.call(this,e),this.getMetrics=e.getMetrics||Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_,this.setMetrics=e.setMetrics||Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_,Blockly.ConnectionDB.init(this),t&&(this.blockDragSurface_=t),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=this.workspaceDragSurface_&&Blockly.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new Blockly.WorkspaceAudio(e.parentWorkspace),this.grid_=this.options.gridPattern?new Blockly.Grid(e.gridPattern,e.gridOptions):null,Blockly.Variables&&Blockly.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.flyoutCategory),Blockly.VariablesDynamic&&Blockly.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME,Blockly.VariablesDynamic.flyoutCategory),Blockly.Procedures&&Blockly.Procedures.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.flyoutCategory)},goog.inherits(Blockly.WorkspaceSvg,Blockly.Workspace),Blockly.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,Blockly.WorkspaceSvg.prototype.rendered=!0,Blockly.WorkspaceSvg.prototype.isFlyout=!1,Blockly.WorkspaceSvg.prototype.isMutator=!1,Blockly.WorkspaceSvg.prototype.resizesEnabled_=!0,Blockly.WorkspaceSvg.prototype.scrollX=0,Blockly.WorkspaceSvg.prototype.scrollY=0,Blockly.WorkspaceSvg.prototype.startScrollX=0,Blockly.WorkspaceSvg.prototype.startScrollY=0,Blockly.WorkspaceSvg.prototype.dragDeltaXY_=null,Blockly.WorkspaceSvg.prototype.scale=1,Blockly.WorkspaceSvg.prototype.trashcan=null,Blockly.WorkspaceSvg.prototype.scrollbar=null,Blockly.WorkspaceSvg.prototype.currentGesture_=null,Blockly.WorkspaceSvg.prototype.blockDragSurface_=null,Blockly.WorkspaceSvg.prototype.workspaceDragSurface_=null,Blockly.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,Blockly.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,Blockly.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,Blockly.WorkspaceSvg.prototype.flyoutButtonCallbacks_={},Blockly.WorkspaceSvg.prototype.toolboxCategoryCallbacks_={},Blockly.WorkspaceSvg.prototype.targetWorkspace=null,Blockly.WorkspaceSvg.prototype.inverseScreenCTM_=null,Blockly.WorkspaceSvg.prototype.getInverseScreenCTM=function(){return this.inverseScreenCTM_},Blockly.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){var e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM_=e.inverse())},Blockly.WorkspaceSvg.prototype.getSvgXY=function(e){var t=0,o=0,i=1;(goog.dom.contains(this.getCanvas(),e)||goog.dom.contains(this.getBubbleCanvas(),e))&&(i=this.scale);do{var n=Blockly.utils.getRelativeXY(e);e!=this.getCanvas()&&e!=this.getBubbleCanvas()||(i=1),t+=n.x*i,o+=n.y*i,e=e.parentNode}while(e&&e!=this.getParentSvg());return new goog.math.Coordinate(t,o)},Blockly.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return Blockly.utils.getInjectionDivXY_(this.svgBlockCanvas_)},Blockly.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(e){this.resizeHandlerWrapper_=e},Blockly.WorkspaceSvg.prototype.createDom=function(e){return this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyWorkspace"},null),e&&(this.svgBackground_=Blockly.utils.createSvgElement("rect",{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"==e&&this.grid_&&(this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")")),this.svgBlockCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBubbleCanvas"},this.svgGroup_),e=Blockly.Scrollbar.scrollbarThickness,this.options.hasTrashcan&&(e=this.addTrashcan_(e)),this.options.zoomOptions&&this.options.zoomOptions.controls&&this.addZoomControls_(e),this.isFlyout||(Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_),this.options.zoomOptions&&this.options.zoomOptions.wheel&&Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new Blockly.Toolbox(this)),this.grid_&&this.grid_.update(this.scale),this.recordDeleteAreas(),this.svgGroup_},Blockly.WorkspaceSvg.prototype.dispose=function(){this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),Blockly.WorkspaceSvg.superClass_.dispose.call(this),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.toolboxCategoryCallbacks_&&(this.toolboxCategoryCallbacks_=null),this.flyoutButtonCallbacks_&&(this.flyoutButtonCallbacks_=null),this.options.parentWorkspace||goog.dom.removeNode(this.getParentSvg().parentNode),this.resizeHandlerWrapper_&&(Blockly.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},Blockly.WorkspaceSvg.prototype.newBlock=function(e,t){return new Blockly.BlockSvg(this,e,t)},Blockly.WorkspaceSvg.prototype.addTrashcan_=function(e){this.trashcan=new Blockly.Trashcan(this);var t=this.trashcan.createDom();return this.svgGroup_.insertBefore(t,this.svgBlockCanvas_),this.trashcan.init(e)},Blockly.WorkspaceSvg.prototype.addZoomControls_=function(e){this.zoomControls_=new Blockly.ZoomControls(this);var t=this.zoomControls_.createDom();return this.svgGroup_.appendChild(t),this.zoomControls_.init(e)},Blockly.WorkspaceSvg.prototype.addFlyout_=function(e){var t={disabledPatternId:this.options.disabledPatternId,parentWorkspace:this,RTL:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,toolboxPosition:this.options.toolboxPosition};return this.flyout_=null,this.flyout_=this.horizontalLayout?new Blockly.HorizontalFlyout(t):new Blockly.VerticalFlyout(t),this.flyout_.autoClose=!1,this.flyout_.createDom(e)},Blockly.WorkspaceSvg.prototype.getFlyout_=function(){return this.flyout_?this.flyout_:this.toolbox_?this.toolbox_.flyout_:null},Blockly.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDeleteAreas()},Blockly.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},Blockly.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position(),this.trashcan&&this.trashcan.position(),this.zoomControls_&&this.zoomControls_.position(),this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},Blockly.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var e=goog.dom.getDocumentScroll();goog.math.Coordinate.equals(this.lastRecordedPageScroll_,e)||(this.lastRecordedPageScroll_=e,this.updateScreenCalculations_())},Blockly.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},Blockly.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},Blockly.WorkspaceSvg.prototype.getParentSvg=function(){if(this.cachedParentSvg_)return this.cachedParentSvg_;for(var e=this.svgGroup_;e;){if("svg"==e.tagName)return this.cachedParentSvg_=e;e=e.parentNode}return null},Blockly.WorkspaceSvg.prototype.translate=function(e,t){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(e,t);else{var o="translate("+e+","+t+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(e,t,this.scale)},Blockly.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var e=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),e="translate("+e.x+","+e.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",e),this.svgBubbleCanvas_.setAttribute("transform",e)}},Blockly.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var e=this.svgBlockCanvas_.previousSibling,t=this.getParentSvg().getAttribute("width"),o=this.getParentSvg().getAttribute("height"),i=Blockly.utils.getRelativeXY(this.svgBlockCanvas_);this.workspaceDragSurface_.setContentsAndShow(this.svgBlockCanvas_,this.svgBubbleCanvas_,e,t,o,this.scale),this.workspaceDragSurface_.translateSurface(i.x,i.y)}},Blockly.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},Blockly.WorkspaceSvg.prototype.getWidth=function(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0},Blockly.WorkspaceSvg.prototype.setVisible=function(e){this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout_()&&this.getFlyout_().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&(this.toolbox_.HtmlDiv.style.display=e?"block":"none"),e?(this.render(),this.toolbox_&&this.toolbox_.position()):Blockly.hideChaff(!0)},Blockly.WorkspaceSvg.prototype.render=function(){for(var e=this.getAllBlocks(),t=e.length-1;0<=t;t--)e[t].render(!1)},Blockly.WorkspaceSvg.prototype.traceOn=function(){console.warn("Deprecated call to traceOn, delete this.")},Blockly.WorkspaceSvg.prototype.highlightBlock=function(e,t){if(void 0===t){for(var o,i=0;o=this.highlightedBlocks_[i];i++)o.setHighlighted(!1);this.highlightedBlocks_.length=0}(o=e?this.getBlockById(e):null)&&((i=void 0===t||t)?-1==this.highlightedBlocks_.indexOf(o)&&this.highlightedBlocks_.push(o):goog.array.remove(this.highlightedBlocks_,o),o.setHighlighted(i))},Blockly.WorkspaceSvg.prototype.paste=function(e){if(this.rendered&&!(e.getElementsByTagName("block").length>=this.remainingCapacity())){this.currentGesture_&&this.currentGesture_.cancel(),Blockly.Events.disable();try{var t=Blockly.Xml.domToBlock(e,this),o=parseInt(e.getAttribute("x"),10),i=parseInt(e.getAttribute("y"),10);if(!isNaN(o)&&!isNaN(i)){this.RTL&&(o=-o);do{e=!1;for(var n,r=this.getAllBlocks(),s=0;n=r[s];s++){var a=n.getRelativeToSurfaceXY();if(1>=Math.abs(o-a.x)&&1>=Math.abs(i-a.y)){e=!0;break}}if(!e){var l,c=t.getConnections_(!1);for(s=0;l=c[s];s++)if(l.closest(Blockly.SNAP_RADIUS,new goog.math.Coordinate(o,i)).connection){e=!0;break}}e&&(o=this.RTL?o-Blockly.SNAP_RADIUS:o+Blockly.SNAP_RADIUS,i+=2*Blockly.SNAP_RADIUS)}while(e);t.moveBy(o,i)}}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!t.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(t)),t.select()}},Blockly.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.flyout_&&e.toolbox_.refreshSelection()},Blockly.WorkspaceSvg.prototype.renameVariableById=function(e,t){Blockly.WorkspaceSvg.superClass_.renameVariableById.call(this,e,t),this.refreshToolboxSelection()},Blockly.WorkspaceSvg.prototype.deleteVariableById=function(e){Blockly.WorkspaceSvg.superClass_.deleteVariableById.call(this,e),this.refreshToolboxSelection()},Blockly.WorkspaceSvg.prototype.createVariable=function(e,t,o){return e=Blockly.WorkspaceSvg.superClass_.createVariable.call(this,e,t,o),this.refreshToolboxSelection(),e},Blockly.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan?this.trashcan.getClientRect():null,this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_?this.toolbox_.getClientRect():null},Blockly.WorkspaceSvg.prototype.isDeleteArea=function(e){return e=new goog.math.Coordinate(e.clientX,e.clientY),this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(e)?Blockly.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(e)?Blockly.DELETE_AREA_TOOLBOX:Blockly.DELETE_AREA_NONE},Blockly.WorkspaceSvg.prototype.onMouseDown_=function(e){var t=this.getGesture(e);t&&t.handleWsStart(e,this)},Blockly.WorkspaceSvg.prototype.startDrag=function(e,t){var o=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());o.x/=this.scale,o.y/=this.scale,this.dragDeltaXY_=goog.math.Coordinate.difference(t,o)},Blockly.WorkspaceSvg.prototype.moveDrag=function(e){return(e=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,goog.math.Coordinate.sum(this.dragDeltaXY_,e)},Blockly.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},Blockly.WorkspaceSvg.prototype.isDraggable=function(){return!!this.scrollbar},Blockly.WorkspaceSvg.prototype.onMouseWheel_=function(e){this.currentGesture_&&this.currentGesture_.cancel();var t=-e.deltaY/50,o=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());this.zoom(o.x,o.y,t),e.preventDefault()},Blockly.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var e=this.getTopBlocks(!1);if(!e.length)return{x:0,y:0,width:0,height:0};for(var t=e[0].getBoundingRectangle(),o=1;o<e.length;o++){var i=e[o].getBoundingRectangle();i.topLeft.x<t.topLeft.x&&(t.topLeft.x=i.topLeft.x),i.bottomRight.x>t.bottomRight.x&&(t.bottomRight.x=i.bottomRight.x),i.topLeft.y<t.topLeft.y&&(t.topLeft.y=i.topLeft.y),i.bottomRight.y>t.bottomRight.y&&(t.bottomRight.y=i.bottomRight.y)}return{x:t.topLeft.x,y:t.topLeft.y,width:t.bottomRight.x-t.topLeft.x,height:t.bottomRight.y-t.topLeft.y}},Blockly.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),Blockly.Events.setGroup(!0);for(var e,t=this.getTopBlocks(!0),o=0,i=0;e=t[i];i++){var n=e.getRelativeToSurfaceXY();e.moveBy(-n.x,o-n.y),e.snapToGrid(),o=e.getRelativeToSurfaceXY().y+e.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}Blockly.Events.setGroup(!1),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.prototype.showContextMenu_=function(e){function t(e){if(e.isDeletable())g=g.concat(e.getDescendants());else{e=e.getChildren();for(var o=0;o<e.length;o++)t(e[o])}}function o(){Blockly.Events.setGroup(r);var e=g.shift();e&&(e.workspace?(e.dispose(!1,!0),setTimeout(o,10)):o()),Blockly.Events.setGroup(!1)}if(!this.options.readOnly&&!this.isFlyout){var i=[],n=this.getTopBlocks(!0),r=Blockly.utils.genUid(),s=this,a={};if(a.text=Blockly.Msg.UNDO,a.enabled=0<this.undoStack_.length,a.callback=this.undo.bind(this,!1),i.push(a),(a={}).text=Blockly.Msg.REDO,a.enabled=0<this.redoStack_.length,a.callback=this.undo.bind(this,!0),i.push(a),this.scrollbar&&((a={}).text=Blockly.Msg.CLEAN_UP,a.enabled=1<n.length,a.callback=this.cleanUp.bind(this),i.push(a)),this.options.collapse){for(var l=a=!1,c=0;c<n.length;c++)for(var u=n[c];u;)u.isCollapsed()?a=!0:l=!0,u=u.getNextBlock();var h=function(e){for(var t=0,o=0;o<n.length;o++)for(var i=n[o];i;)setTimeout(i.setCollapsed.bind(i,e),t),i=i.getNextBlock(),t+=10};(l={enabled:l}).text=Blockly.Msg.COLLAPSE_ALL,l.callback=function(){h(!0)},i.push(l),(a={enabled:a}).text=Blockly.Msg.EXPAND_ALL,a.callback=function(){h(!1)},i.push(a)}var g=[];for(c=0;c<n.length;c++)t(n[c]);a={text:1==g.length?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(g.length)),enabled:0<g.length,callback:function(){s.currentGesture_&&s.currentGesture_.cancel(),2>g.length?o():Blockly.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",g.length),function(e){e&&o()})}},i.push(a),Blockly.ContextMenu.show(e,i,this.RTL)}},Blockly.WorkspaceSvg.prototype.updateToolbox=function(e){if(e=Blockly.Options.parseToolboxTree(e)){if(!this.options.languageTree)throw"Existing toolbox is null.  Can't create new toolbox.";if(e.getElementsByTagName("category").length){if(!this.toolbox_)throw"Existing toolbox has no categories.  Can't change mode.";this.options.languageTree=e,this.toolbox_.populate_(e),this.toolbox_.addColour_()}else{if(!this.flyout_)throw"Existing toolbox has categories.  Can't change mode.";this.options.languageTree=e,this.flyout_.show(e.childNodes)}}else if(this.options.languageTree)throw"Can't nullify an existing toolbox."},Blockly.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Blockly.mainWorkspace=this,this.setBrowserFocus())},Blockly.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur();try{this.getParentSvg().focus()}catch(e){try{this.getParentSvg().parentNode.setActive()}catch(e){this.getParentSvg().parentNode.focus()}}},Blockly.WorkspaceSvg.prototype.zoom=function(e,t,o){var i=this.options.zoomOptions.scaleSpeed,n=this.getMetrics(),r=this.getParentSvg().createSVGPoint();r.x=e,r.y=t,e=(r=r.matrixTransform(this.getCanvas().getCTM().inverse())).x,t=r.y,r=this.getCanvas(),i=Math.pow(i,o),(o=this.scale*i)>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:o<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale),this.scale!=o&&(this.scrollbar&&(e=r.getCTM().translate(e*(1-i),t*(1-i)).scale(i),this.scrollX=e.e-n.absoluteLeft,this.scrollY=e.f-n.absoluteTop),this.setScale(o))},Blockly.WorkspaceSvg.prototype.zoomCenter=function(e){var t=this.getMetrics();this.zoom(t.viewWidth/2,t.viewHeight/2,e)},Blockly.WorkspaceSvg.prototype.zoomToFit=function(){var e=this.getMetrics(),t=this.getBlocksBoundingBox(),o=t.width;if(t=t.height,o){var i=e.viewWidth,n=e.viewHeight;this.flyout_&&(i-=this.flyout_.width_),this.scrollbar||(o+=e.contentLeft,t+=e.contentTop),this.setScale(Math.min(i/o,n/t)),this.scrollCenter()}},Blockly.WorkspaceSvg.prototype.scrollCenter=function(){if(this.scrollbar){var e=this.getMetrics(),t=(e.contentWidth-e.viewWidth)/2;this.flyout_&&(t-=this.flyout_.width_/2),this.scrollbar.set(t,(e.contentHeight-e.viewHeight)/2)}},Blockly.WorkspaceSvg.prototype.setScale=function(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.grid_&&this.grid_.update(this.scale),this.scrollbar?this.scrollbar.resize():this.translate(this.scrollX,this.scrollY),Blockly.hideChaff(!1),this.flyout_&&this.flyout_.reflow()},Blockly.WorkspaceSvg.getDimensionsPx_=function(e){var t=0,o=0;return e&&(t=e.getWidth(),o=e.getHeight()),{width:t,height:o}},Blockly.WorkspaceSvg.getContentDimensions_=function(e,t){return e.scrollbar?Blockly.WorkspaceSvg.getContentDimensionsBounded_(e,t):Blockly.WorkspaceSvg.getContentDimensionsExact_(e)},Blockly.WorkspaceSvg.getContentDimensionsExact_=function(e){var t=e.getBlocksBoundingBox(),o=e.scale;e=t.width*o;var i=t.height*o,n=t.x*o;return{left:n,top:t=t.y*o,right:n+e,bottom:t+i,width:e,height:i}},Blockly.WorkspaceSvg.getContentDimensionsBounded_=function(e,t){var o=Blockly.WorkspaceSvg.getContentDimensionsExact_(e),i=t.width,n=t.height,r=i/2,s=n/2,a=Math.min(o.left-r,o.right-i),l=Math.min(o.top-s,o.bottom-n);return{left:a,top:l,height:Math.max(o.bottom+s,o.top+n)-l,width:Math.max(o.right+r,o.left+i)-a}},Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var e=Blockly.WorkspaceSvg.getDimensionsPx_(this.toolbox_),t=Blockly.WorkspaceSvg.getDimensionsPx_(this.flyout_),o=Blockly.svgSize(this.getParentSvg());this.toolbox_&&(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?o.height-=e.height:this.toolboxPosition!=Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!=Blockly.TOOLBOX_AT_RIGHT||(o.width-=e.width));var i=Blockly.WorkspaceSvg.getContentDimensions_(this,o),n=0;this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(n=e.width);var r=0;return this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP&&(r=e.height),{contentHeight:i.height,contentWidth:i.width,contentTop:i.top,contentLeft:i.left,viewHeight:o.height,viewWidth:o.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:r,absoluteLeft:n,toolboxWidth:e.width,toolboxHeight:e.height,flyoutWidth:t.width,flyoutHeight:t.height,toolboxPosition:this.toolboxPosition}},Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(e){if(!this.scrollbar)throw"Attempt to set top level workspace scroll without scrollbars.";var t=this.getMetrics();goog.isNumber(e.x)&&(this.scrollX=-t.contentWidth*e.x-t.contentLeft),goog.isNumber(e.y)&&(this.scrollY=-t.contentHeight*e.y-t.contentTop),e=this.scrollX+t.absoluteLeft,t=this.scrollY+t.absoluteTop,this.translate(e,t),this.grid_&&this.grid_.moveTo(e,t)},Blockly.WorkspaceSvg.prototype.setResizesEnabled=function(e){var t=!this.resizesEnabled_&&e;this.resizesEnabled_=e,t&&this.resizeContents()},Blockly.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),Blockly.WorkspaceSvg.superClass_.clear.call(this),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.prototype.registerButtonCallback=function(e,t){goog.asserts.assert(goog.isFunction(t),"Button callbacks must be functions."),this.flyoutButtonCallbacks_[e]=t},Blockly.WorkspaceSvg.prototype.getButtonCallback=function(e){return(e=this.flyoutButtonCallbacks_[e])?e:null},Blockly.WorkspaceSvg.prototype.removeButtonCallback=function(e){this.flyoutButtonCallbacks_[e]=null},Blockly.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(e,t){goog.asserts.assert(goog.isFunction(t),"Toolbox category callbacks must be functions."),this.toolboxCategoryCallbacks_[e]=t},Blockly.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(e){return(e=this.toolboxCategoryCallbacks_[e])?e:null},Blockly.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(e){this.toolboxCategoryCallbacks_[e]=null},Blockly.WorkspaceSvg.prototype.getGesture=function(e){var t="mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type,o=this.currentGesture_;return o?t&&o.hasStarted()?(console.warn("tried to start the same gesture twice"),o.cancel(),null):o:t?this.currentGesture_=new Blockly.Gesture(e,this):null},Blockly.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},Blockly.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},Blockly.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},Blockly.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},Blockly.WorkspaceSvg.prototype.setVisible=Blockly.WorkspaceSvg.prototype.setVisible,Blockly.Mutator=function(e){Blockly.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=e},goog.inherits(Blockly.Mutator,Blockly.Icon),Blockly.Mutator.prototype.workspaceWidth_=0,Blockly.Mutator.prototype.workspaceHeight_=0,Blockly.Mutator.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("rect",{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)},Blockly.Mutator.prototype.iconClick_=function(e){this.block_.isEditable()&&Blockly.Icon.prototype.iconClick_.call(this,e)},Blockly.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=Blockly.utils.createSvgElement("svg",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var e,t=goog.dom.createDom("xml"),o=0;e=this.quarkNames_[o];o++)t.appendChild(goog.dom.createDom("block",{type:e}));else t=null;return t={languageTree:t,parentWorkspace:this.block_.workspace,pathToMedia:this.block_.workspace.options.pathToMedia,RTL:this.block_.RTL,toolboxPosition:this.block_.RTL?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,horizontalLayout:!1,getMetrics:this.getFlyoutMetrics_.bind(this),setMetrics:null},this.workspace_=new Blockly.WorkspaceSvg(t),this.workspace_.isMutator=!0,t=this.workspace_.addFlyout_("g"),(o=this.workspace_.createDom("blocklyMutatorBackground")).insertBefore(t,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(o),this.svgDialog_},Blockly.Mutator.prototype.updateEditable=function(){this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&Blockly.utils.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly"))),Blockly.Icon.prototype.updateEditable.call(this)},Blockly.Mutator.prototype.resizeBubble_=function(){var e=2*Blockly.Bubble.BORDER_WIDTH,t=this.workspace_.getCanvas().getBBox(),o=this.block_.RTL?-t.x:t.width+t.x;if(t=t.height+3*e,this.workspace_.flyout_){var i=this.workspace_.flyout_.getMetrics_();t=Math.max(t,i.contentHeight+20)}o+=3*e,(Math.abs(this.workspaceWidth_-o)>e||Math.abs(this.workspaceHeight_-t)>e)&&(this.workspaceWidth_=o,this.workspaceHeight_=t,this.bubble_.setBubbleSize(o+e,t+e),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)),this.block_.RTL&&(e="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",e)),this.workspace_.resize()},Blockly.Mutator.prototype.setVisible=function(e){if(e!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"mutatorOpen",!e,e)),e){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,null,null),(e=this.workspace_.options.languageTree)&&(this.workspace_.flyout_.init(this.workspace_),this.workspace_.flyout_.show(e.childNodes)),this.rootBlock_=this.block_.decompose(this.workspace_),e=this.rootBlock_.getDescendants();for(var t,o=0;t=e[o];o++)t.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),this.workspace_.flyout_?(e=2*this.workspace_.flyout_.CORNER_RADIUS,o=this.workspace_.flyout_.width_+e):o=e=16,this.block_.RTL&&(o=-o),this.rootBlock_.moveBy(o,e),this.block_.saveConnections){var i=this;this.block_.saveConnections(this.rootBlock_),this.sourceListener_=function(){i.block_.saveConnections(i.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.updateColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},Blockly.Mutator.prototype.workspaceChanged_=function(){if(!this.workspace_.isDragging())for(var e,t=this.workspace_.getTopBlocks(!1),o=0;e=t[o];o++){var i=e.getRelativeToSurfaceXY(),n=e.getHeightWidth();20>i.y+n.height&&e.moveBy(0,20-n.height-i.y)}if(this.rootBlock_.workspace==this.workspace_){if(Blockly.Events.setGroup(!0),t=(t=(e=this.block_).mutationToDom())&&Blockly.Xml.domToText(t),o=e.rendered,e.rendered=!1,e.compose(this.rootBlock_),e.rendered=o,e.initSvg(),t!=(o=(o=e.mutationToDom())&&Blockly.Xml.domToText(o))){Blockly.Events.fire(new Blockly.Events.BlockChange(e,"mutation",null,t,o));var r=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(r),e.bumpNeighbours_(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)}e.rendered&&e.render(),this.workspace_.isDragging()||this.resizeBubble_(),Blockly.Events.setGroup(!1)}},Blockly.Mutator.prototype.getFlyoutMetrics_=function(){return{viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_,absoluteTop:0,absoluteLeft:0}},Blockly.Mutator.prototype.dispose=function(){this.block_.mutator=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Mutator.reconnect=function(e,t,o){if(!e||!e.getSourceBlock().workspace)return!1;o=t.getInput(o).connection;var i=e.targetBlock();return!(i&&i!=t||o.targetConnection==e)&&(o.isConnected()&&o.disconnect(),o.connect(e),!0)},Blockly.Mutator.findParentWs=function(e){var t=null;if(e&&e.options){var o=e.options.parentWorkspace;e.isFlyout?o&&o.options&&(t=o.options.parentWorkspace):o&&(t=o)}return t},goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.Mutator||(goog.global.Blockly.Mutator={}),goog.global.Blockly.Mutator.reconnect=Blockly.Mutator.reconnect,Blockly.Extensions={},Blockly.Extensions.ALL_={},Blockly.Extensions.register=function(e,t){if(!goog.isString(e)||goog.string.isEmptyOrWhitespace(e))throw Error('Error: Invalid extension name "'+e+'"');if(Blockly.Extensions.ALL_[e])throw Error('Error: Extension "'+e+'" is already registered.');if(!goog.isFunction(t))throw Error('Error: Extension "'+e+'" must be a function');Blockly.Extensions.ALL_[e]=t},Blockly.Extensions.registerMixin=function(e,t){if(!goog.isObject(t))throw Error('Error: Mixin "'+e+'" must be a object');Blockly.Extensions.register(e,function(){this.mixin(t)})},Blockly.Extensions.registerMutator=function(e,t,o,i){var n='Error when registering mutator "'+e+'": ';Blockly.Extensions.checkHasFunction_(n,t.domToMutation,"domToMutation"),Blockly.Extensions.checkHasFunction_(n,t.mutationToDom,"mutationToDom");var r=Blockly.Extensions.checkMutatorDialog_(t,n);if(o&&!goog.isFunction(o))throw Error('Extension "'+e+'" is not a function');Blockly.Extensions.register(e,function(){r&&this.setMutator(new Blockly.Mutator(i)),this.mixin(t),o&&o.apply(this)})},Blockly.Extensions.apply=function(e,t,o){var i=Blockly.Extensions.ALL_[e];if(!goog.isFunction(i))throw Error('Error: Extension "'+e+'" not found.');if(o)Blockly.Extensions.checkNoMutatorProperties_(e,t);else var n=Blockly.Extensions.getMutatorProperties_(t);if(i.apply(t),o)Blockly.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+e+'": ',t);else if(!Blockly.Extensions.mutatorPropertiesMatch_(n,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},Blockly.Extensions.checkHasFunction_=function(e,t,o){if(!t)throw Error(e+'missing required property "'+o+'"');if("function"!=typeof t)throw Error(e+'" required property "'+o+'" must be a function')},Blockly.Extensions.checkNoMutatorProperties_=function(e,t){if(Blockly.Extensions.getMutatorProperties_(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},Blockly.Extensions.checkMutatorDialog_=function(e,t){var o=void 0!==e.compose,i=void 0!==e.decompose;if(o&&i){if("function"!=typeof e.compose)throw Error(t+"compose must be a function.");if("function"!=typeof e.decompose)throw Error(t+"decompose must be a function.");return!0}if(o||i)throw Error(t+'Must have both or neither of "compose" and "decompose"');return!1},Blockly.Extensions.checkBlockHasMutatorProperties_=function(e,t){if("function"!=typeof t.domToMutation)throw Error(e+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof t.mutationToDom)throw Error(e+'Applying a mutator didn\'t add "mutationToDom"');Blockly.Extensions.checkMutatorDialog_(t,e)},Blockly.Extensions.getMutatorProperties_=function(e){var t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},Blockly.Extensions.mutatorPropertiesMatch_=function(e,t){var o=Blockly.Extensions.getMutatorProperties_(t);if(o.length!=e.length)return!1;for(var i=0;i<o.length;i++)if(e[i]!=o[i])return!1;return!0},Blockly.Extensions.buildTooltipForDropdown=function(e,t){var o=[];return"object"==typeof document&&Blockly.utils.runAfterPageLoad(function(){for(var e in t)Blockly.utils.checkMessageReferences(t[e])}),function(){this.type&&-1===o.indexOf(this.type)&&(Blockly.Extensions.checkDropdownOptionsInTable_(this,e,t),o.push(this.type)),this.setTooltip(function(){var i=this.getFieldValue(e),n=t[i];return null==n?-1===o.indexOf(this.type)&&(i="No tooltip mapping for value "+i+" of field "+e,null!=this.type&&(i+=" of block type "+this.type),console.warn(i+".")):n=Blockly.utils.replaceMessageReferences(n),n}.bind(this))}},Blockly.Extensions.checkDropdownOptionsInTable_=function(e,t,o){var i=e.getField(t);if(!i.isOptionListDynamic()){i=i.getOptions();for(var n=0;n<i.length;++n){var r=i[n][1];null==o[r]&&console.warn("No tooltip mapping for value "+r+" of field "+t+" of block type "+e.type)}}},Blockly.Extensions.buildTooltipWithFieldValue=function(e,t){return"object"==typeof document&&Blockly.utils.runAfterPageLoad(function(){Blockly.utils.checkMessageReferences(e)}),function(){this.setTooltip(function(){return Blockly.utils.replaceMessageReferences(e).replace("%1",this.getFieldValue(t))}.bind(this))}},Blockly.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||this.tooltipWhenNotConnected_}.bind(this))},Blockly.Extensions.register("parent_tooltip_when_inline",Blockly.Extensions.extensionParentTooltip_),Blockly.Field=function(e,t){this.size_=new goog.math.Size(0,Blockly.BlockSvg.MIN_BLOCK_Y),this.setValue(e),this.setValidator(t)},Blockly.Field.cacheWidths_=null,Blockly.Field.cacheReference_=0,Blockly.Field.prototype.name=void 0,Blockly.Field.prototype.maxDisplayLength=50,Blockly.Field.prototype.text_="",Blockly.Field.prototype.sourceBlock_=null,Blockly.Field.prototype.visible_=!0,Blockly.Field.prototype.validator_=null,Blockly.Field.NBSP="",Blockly.Field.prototype.EDITABLE=!0,Blockly.Field.prototype.setSourceBlock=function(e){goog.asserts.assert(!this.sourceBlock_,"Field already bound to a block."),this.sourceBlock_=e},Blockly.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.borderRect_=Blockly.utils.createSvgElement("rect",{rx:4,ry:4,x:-Blockly.BlockSvg.SEP_SPACE_X/2,y:0,height:16},this.fieldGroup_),this.textElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText",y:this.size_.height-12.5},this.fieldGroup_),this.updateEditable(),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.fieldGroup_,"mousedown",this,this.onMouseDown_),this.render_())},Blockly.Field.prototype.initModel=function(){},Blockly.Field.prototype.dispose=function(){this.mouseDownWrapper_&&(Blockly.unbindEvent_(this.mouseDownWrapper_),this.mouseDownWrapper_=null),this.sourceBlock_=null,goog.dom.removeNode(this.fieldGroup_),this.validator_=this.borderRect_=this.textElement_=this.fieldGroup_=null},Blockly.Field.prototype.updateEditable=function(){var e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?(Blockly.utils.addClass(e,"blocklyEditableText"),Blockly.utils.removeClass(e,"blocklyNonEditableText"),this.fieldGroup_.style.cursor=this.CURSOR):(Blockly.utils.addClass(e,"blocklyNonEditableText"),Blockly.utils.removeClass(e,"blocklyEditableText"),this.fieldGroup_.style.cursor=""))},Blockly.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},Blockly.Field.prototype.isVisible=function(){return this.visible_},Blockly.Field.prototype.setVisible=function(e){if(this.visible_!=e){this.visible_=e;var t=this.getSvgRoot();t&&(t.style.display=e?"block":"none",this.render_())}},Blockly.Field.prototype.setValidator=function(e){this.validator_=e},Blockly.Field.prototype.getValidator=function(){return this.validator_},Blockly.Field.prototype.classValidator=function(e){return e},Blockly.Field.prototype.callValidator=function(e){var t=this.classValidator(e);if(null===t)return null;if(void 0!==t&&(e=t),t=this.getValidator()){if(null===(t=t.call(this,e)))return null;void 0!==t&&(e=t)}return e},Blockly.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},Blockly.Field.prototype.render_=function(){if(this.visible_){goog.dom.removeChildren(this.textElement_);var e=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(e),this.updateWidth()}else this.size_.width=0},Blockly.Field.prototype.updateWidth=function(){var e=Blockly.Field.getCachedWidth(this.textElement_);this.borderRect_&&this.borderRect_.setAttribute("width",e+Blockly.BlockSvg.SEP_SPACE_X),this.size_.width=e},Blockly.Field.getCachedWidth=function(e){var t,o=e.textContent+"\n"+e.className.baseVal;if(Blockly.Field.cacheWidths_&&(t=Blockly.Field.cacheWidths_[o]))return t;try{t=goog.userAgent.IE||goog.userAgent.EDGE?e.getBBox().width:e.getComputedTextLength()}catch(t){return 8*e.textContent.length}return Blockly.Field.cacheWidths_&&(Blockly.Field.cacheWidths_[o]=t),t},Blockly.Field.startCache=function(){Blockly.Field.cacheReference_++,Blockly.Field.cacheWidths_||(Blockly.Field.cacheWidths_={})},Blockly.Field.stopCache=function(){Blockly.Field.cacheReference_--,Blockly.Field.cacheReference_||(Blockly.Field.cacheWidths_=null)},Blockly.Field.prototype.getSize=function(){return this.size_.width||this.render_(),this.size_},Blockly.Field.prototype.getScaledBBox_=function(){var e=this.borderRect_.getBBox(),t=e.height*this.sourceBlock_.workspace.scale;e=e.width*this.sourceBlock_.workspace.scale;var o=this.getAbsoluteXY_();return{top:o.y,bottom:o.y+t,left:o.x,right:o.x+e}},Blockly.Field.prototype.getDisplayText_=function(){var e=this.text_;return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+""),e=e.replace(/\s/g,Blockly.Field.NBSP),this.sourceBlock_.RTL&&(e+=""),e):Blockly.Field.NBSP},Blockly.Field.prototype.getText=function(){return this.text_},Blockly.Field.prototype.setText=function(e){null!==e&&((e=String(e))!==this.text_&&(this.text_=e,this.forceRerender()))},Blockly.Field.prototype.forceRerender=function(){this.size_.width=0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_())},Blockly.Field.prototype.getValue=function(){return this.getText()},Blockly.Field.prototype.setValue=function(e){if(null!==e){var t=this.getValue();t!=e&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,t,e)),this.setText(e))}},Blockly.Field.prototype.onMouseDown_=function(e){this.sourceBlock_&&this.sourceBlock_.workspace&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)},Blockly.Field.prototype.setTooltip=function(e){},Blockly.Field.prototype.getAbsoluteXY_=function(){return goog.style.getPageOffset(this.borderRect_)},Blockly.FieldLabel=function(e,t){this.size_=new goog.math.Size(0,17.5),this.class_=t,this.setValue(e)},goog.inherits(Blockly.FieldLabel,Blockly.Field),Blockly.FieldLabel.fromJson=function(e){var t=Blockly.utils.replaceMessageReferences(e.text);return new Blockly.FieldLabel(t,e.class)},Blockly.FieldLabel.prototype.EDITABLE=!1,Blockly.FieldLabel.prototype.init=function(){this.textElement_||(this.textElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText",y:this.size_.height-5},null),this.class_&&Blockly.utils.addClass(this.textElement_,this.class_),this.visible_||(this.textElement_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.textElement_),this.textElement_.tooltip=this.sourceBlock_,Blockly.Tooltip.bindMouseEvents(this.textElement_),this.render_())},Blockly.FieldLabel.prototype.dispose=function(){goog.dom.removeNode(this.textElement_),this.textElement_=null},Blockly.FieldLabel.prototype.getSvgRoot=function(){return this.textElement_},Blockly.FieldLabel.prototype.setTooltip=function(e){this.textElement_.tooltip=e},Blockly.Input=function(e,t,o,i){if(e!=Blockly.DUMMY_INPUT&&!t)throw"Value inputs and statement inputs must have non-empty name.";this.type=e,this.name=t,this.sourceBlock_=o,this.connection=i,this.fieldRow=[]},Blockly.Input.prototype.align=Blockly.ALIGN_LEFT,Blockly.Input.prototype.visible_=!0,Blockly.Input.prototype.appendField=function(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this},Blockly.Input.prototype.insertFieldAt=function(e,t,o){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return t||o?(goog.isString(t)&&(t=new Blockly.FieldLabel(t)),t.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&t.init(),t.name=o,t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),++e,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()),e):e},Blockly.Input.prototype.removeField=function(e){for(var t,o=0;t=this.fieldRow[o];o++)if(t.name===e)return t.dispose(),this.fieldRow.splice(o,1),void(this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()));goog.asserts.fail('Field "%s" not found.',e)},Blockly.Input.prototype.isVisible=function(){return this.visible_},Blockly.Input.prototype.setVisible=function(e){var t=[];if(this.visible_==e)return t;for(var o,i=(this.visible_=e)?"block":"none",n=0;o=this.fieldRow[n];n++)o.setVisible(e);return this.connection&&(e?t=this.connection.unhideAll():this.connection.hideAll(),n=this.connection.targetBlock())&&(n.getSvgRoot().style.display=i,e||(n.rendered=!1)),t},Blockly.Input.prototype.setCheck=function(e){if(!this.connection)throw"This input does not have a connection.";return this.connection.setCheck(e),this},Blockly.Input.prototype.setAlign=function(e){return this.align=e,this.sourceBlock_.rendered&&this.sourceBlock_.render(),this},Blockly.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()},Blockly.Input.prototype.dispose=function(){for(var e,t=0;e=this.fieldRow[t];t++)e.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},Blockly.Warning=function(e){Blockly.Warning.superClass_.constructor.call(this,e),this.createIcon(),this.text_={}},goog.inherits(Blockly.Warning,Blockly.Icon),Blockly.Warning.prototype.collapseHidden=!1,Blockly.Warning.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("path",{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)},Blockly.Warning.textToDom_=function(e){var t=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyBubbleText",y:Blockly.Bubble.BORDER_WIDTH},null);e=e.split("\n");for(var o=0;o<e.length;o++){var i=Blockly.utils.createSvgElement("tspan",{dy:"1em",x:Blockly.Bubble.BORDER_WIDTH},t),n=document.createTextNode(e[o]);i.appendChild(n)}return t},Blockly.Warning.prototype.setVisible=function(e){if(e!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"warningOpen",!e,e)),e){if(e=Blockly.Warning.textToDom_(this.getText()),this.bubble_=new Blockly.Bubble(this.block_.workspace,e,this.block_.svgPath_,this.iconXY_,null,null),this.block_.RTL)for(var t,o=e.getBBox().width,i=0;t=e.childNodes[i];i++)t.setAttribute("text-anchor","end"),t.setAttribute("x",o+Blockly.Bubble.BORDER_WIDTH);this.updateColour(),e=this.bubble_.getBubbleSize(),this.bubble_.setBubbleSize(e.width,e.height)}else this.bubble_.dispose(),this.body_=this.bubble_=null},Blockly.Warning.prototype.bodyFocus_=function(e){this.bubble_.promote_()},Blockly.Warning.prototype.setText=function(e,t){this.text_[t]!=e&&(e?this.text_[t]=e:delete this.text_[t],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},Blockly.Warning.prototype.getText=function(){var e,t=[];for(e in this.text_)t.push(this.text_[e]);return t.join("\n")},Blockly.Warning.prototype.dispose=function(){this.block_.warning=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Block=function(e,t,o){if(void 0!==Blockly.Generator.prototype[t]&&console.warn('FUTURE ERROR: Block prototypeName "'+t+'" conflicts with Blockly.Generator members. Registering Generators for this block type will incur errors.\nThis name will be DISALLOWED (throwing an error) in future versions of Blockly.'),this.id=o&&!e.getBlockById(o)?o:Blockly.utils.genUid(),e.blockDB_[this.id]=this,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=null,this.xy_=new goog.math.Coordinate(0,0),this.workspace=e,this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t&&(this.type=t,o=Blockly.Blocks[t],goog.asserts.assertObject(o,'Error: Unknown block type "%s".',t),goog.mixin(this,o)),e.addTopBlock(this),goog.isFunction(this.init)&&this.init(),this.inputsInlineDefault=this.inputsInline,Blockly.Events.isEnabled()){(e=Blockly.Events.getGroup())||Blockly.Events.setGroup(!0);try{Blockly.Events.fire(new Blockly.Events.BlockCreate(this))}finally{e||Blockly.Events.setGroup(!1)}}goog.isFunction(this.onchange)&&this.setOnChange(this.onchange)},Blockly.Block.obtain=function(e,t){return console.warn("Deprecated call to Blockly.Block.obtain, use workspace.newBlock instead."),e.newBlock(t)},Blockly.Block.prototype.data=null,Blockly.Block.prototype.colour_="#000000",Blockly.Block.prototype.hue_=null,Blockly.Block.prototype.dispose=function(e){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockDelete(this)),Blockly.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),delete this.workspace.blockDB_[this.id],this.workspace=null);for(var t=this.childBlocks_.length-1;0<=t;t--)this.childBlocks_[t].dispose(!1);t=0;for(var o;o=this.inputList[t];t++)o.dispose();this.inputList.length=0;var i=this.getConnections_(!0);for(t=0;t<i.length;t++){var n=i[t];n.isConnected()&&n.disconnect(),i[t].dispose()}}finally{Blockly.Events.enable()}}},Blockly.Block.prototype.initModel=function(){for(var e,t=0;e=this.inputList[t];t++)for(var o,i=0;o=e.fieldRow[i];i++)o.initModel&&o.initModel()},Blockly.Block.prototype.unplug=function(e){if(this.outputConnection)this.outputConnection.isConnected()&&this.outputConnection.disconnect();else if(this.previousConnection){var t=null;this.previousConnection.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();e&&o&&((e=this.nextConnection.targetConnection).disconnect(),t&&t.checkType_(e)&&t.connect(e))}},Blockly.Block.prototype.getConnections_=function(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(var t,o=0;t=this.inputList[o];o++)t.connection&&e.push(t.connection);return e},Blockly.Block.prototype.lastConnectionInStack_=function(){for(var e=this.nextConnection;e;){var t=e.targetBlock();if(!t)return e;e=t.nextConnection}return null},Blockly.Block.prototype.bumpNeighbours_=function(){console.warn("Not expected to reach this bumpNeighbours_ function. The BlockSvg function for bumpNeighbours_ was expected to be called instead.")},Blockly.Block.prototype.getParent=function(){return this.parentBlock_},Blockly.Block.prototype.getInputWithBlock=function(e){for(var t,o=0;t=this.inputList[o];o++)if(t.connection&&t.connection.targetBlock()==e)return t;return null},Blockly.Block.prototype.getSurroundParent=function(){var e=this;do{var t=e;if(!(e=e.getParent()))return null}while(e.getNextBlock()==t);return e},Blockly.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},Blockly.Block.prototype.getRootBlock=function(){var e=this;do{var t=e;e=t.parentBlock_}while(e);return t},Blockly.Block.prototype.getChildren=function(){return this.childBlocks_},Blockly.Block.prototype.setParent=function(e){if(e!=this.parentBlock_){if(this.parentBlock_){if(goog.array.remove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw"Still connected to previous block.";if(this.outputConnection&&this.outputConnection.isConnected())throw"Still connected to parent block.";this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}},Blockly.Block.prototype.getDescendants=function(){for(var e,t=[this],o=0;e=this.childBlocks_[o];o++)t.push.apply(t,e.getDescendants());return t},Blockly.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setDeletable=function(e){this.deletable_=e},Blockly.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setMovable=function(e){this.movable_=e},Blockly.Block.prototype.isShadow=function(){return this.isShadow_},Blockly.Block.prototype.setShadow=function(e){this.isShadow_=e},Blockly.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setEditable=function(e){this.editable_=e,e=0;for(var t;t=this.inputList[e];e++)for(var o,i=0;o=t.fieldRow[i];i++)o.updateEditable()},Blockly.Block.prototype.setConnectionsHidden=function(e){if(!e&&this.isCollapsed()){if(this.outputConnection&&this.outputConnection.setHidden(e),this.previousConnection&&this.previousConnection.setHidden(e),this.nextConnection){this.nextConnection.setHidden(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionsHidden(e)}}else for(var o=this.getConnections_(!0),i=0;t=o[i];i++)t.setHidden(e),t.isSuperior()&&(t=t.targetBlock())&&t.setConnectionsHidden(e)},Blockly.Block.prototype.setHelpUrl=function(e){this.helpUrl=e},Blockly.Block.prototype.setTooltip=function(e){this.tooltip=e},Blockly.Block.prototype.getColour=function(){return this.colour_},Blockly.Block.prototype.getHue=function(){return this.hue_},Blockly.Block.prototype.setColour=function(e){var t=Number(e);if(!isNaN(t)&&0<=t&&360>=t)this.hue_=t,this.colour_=Blockly.hueToRgb(t);else{if(!goog.isString(e)||!/^#[0-9a-fA-F]{6}$/.test(e))throw"Invalid colour: "+e;this.colour_=e,this.hue_=null}},Blockly.Block.prototype.setOnChange=function(e){if(e&&!goog.isFunction(e))throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=e)&&(this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},Blockly.Block.prototype.getField=function(e){for(var t,o=0;t=this.inputList[o];o++)for(var i,n=0;i=t.fieldRow[n];n++)if(i.name===e)return i;return null},Blockly.Block.prototype.getVars=function(){for(var e,t=[],o=0;e=this.inputList[o];o++)for(var i,n=0;i=e.fieldRow[n];n++)i instanceof Blockly.FieldVariable&&t.push(i.getValue());return t},Blockly.Block.prototype.getVarModels=function(){for(var e,t=[],o=0;e=this.inputList[o];o++)for(var i,n=0;i=e.fieldRow[n];n++)i instanceof Blockly.FieldVariable&&(i=this.workspace.getVariableById(i.getValue()))&&t.push(i);return t};Blockly.Block.prototype.updateVarName=function(e){for(var t,o=0;t=this.inputList[o];o++)for(var i,n=0;i=t.fieldRow[n];n++)i instanceof Blockly.FieldVariable&&e.getId()==i.getValue()&&i.setText(e.name)},Blockly.Block.prototype.renameVarById=function(e,t){for(var o,i=0;o=this.inputList[i];i++)for(var n,r=0;n=o.fieldRow[r];r++)n instanceof Blockly.FieldVariable&&e==n.getValue()&&n.setValue(t)},Blockly.Block.prototype.getFieldValue=function(e){return(e=this.getField(e))?e.getValue():null},Blockly.Block.prototype.setFieldValue=function(e,t){var o=this.getField(t);goog.asserts.assertObject(o,'Field "%s" not found.',t),o.setValue(e)},Blockly.Block.prototype.setPreviousStatement=function(e,t){e?(void 0===t&&(t=null),this.previousConnection||(goog.asserts.assert(!this.outputConnection,"Remove output connection prior to adding previous connection."),this.previousConnection=this.makeConnection_(Blockly.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t)):this.previousConnection&&(goog.asserts.assert(!this.previousConnection.isConnected(),"Must disconnect previous statement before removing connection."),this.previousConnection.dispose(),this.previousConnection=null)},Blockly.Block.prototype.setNextStatement=function(e,t){e?(void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Blockly.NEXT_STATEMENT)),this.nextConnection.setCheck(t)):this.nextConnection&&(goog.asserts.assert(!this.nextConnection.isConnected(),"Must disconnect next statement before removing connection."),this.nextConnection.dispose(),this.nextConnection=null)},Blockly.Block.prototype.setOutput=function(e,t){e?(void 0===t&&(t=null),this.outputConnection||(goog.asserts.assert(!this.previousConnection,"Remove previous connection prior to adding output connection."),this.outputConnection=this.makeConnection_(Blockly.OUTPUT_VALUE)),this.outputConnection.setCheck(t)):this.outputConnection&&(goog.asserts.assert(!this.outputConnection.isConnected(),"Must disconnect output value before removing connection."),this.outputConnection.dispose(),this.outputConnection=null)},Blockly.Block.prototype.setInputsInline=function(e){this.inputsInline!=e&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)},Blockly.Block.prototype.getInputsInline=function(){if(void 0!=this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==Blockly.DUMMY_INPUT&&this.inputList[e].type==Blockly.DUMMY_INPUT)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==Blockly.INPUT_VALUE&&this.inputList[e].type==Blockly.DUMMY_INPUT)return!0;return!1},Blockly.Block.prototype.setDisabled=function(e){this.disabled!=e&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"disabled",null,this.disabled,e)),this.disabled=e)},Blockly.Block.prototype.getInheritedDisabled=function(){for(var e=this.getSurroundParent();e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1},Blockly.Block.prototype.isCollapsed=function(){return this.collapsed_},Blockly.Block.prototype.setCollapsed=function(e){this.collapsed_!=e&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)},Blockly.Block.prototype.toString=function(e,t){var o=[],i=t||"?";if(this.collapsed_)o.push(this.getInput("_TEMP_COLLAPSED_INPUT").fieldRow[0].text_);else for(var n,r=0;n=this.inputList[r];r++){for(var s,a=0;s=n.fieldRow[a];a++)s instanceof Blockly.FieldDropdown&&!s.getValue()?o.push(i):o.push(s.getText());n.connection&&((n=n.connection.targetBlock())?o.push(n.toString(void 0,t)):o.push(i))}return o=goog.string.trim(o.join(" "))||"???",e&&(o=goog.string.truncate(o,e)),o},Blockly.Block.prototype.appendValueInput=function(e){return this.appendInput_(Blockly.INPUT_VALUE,e)},Blockly.Block.prototype.appendStatementInput=function(e){return this.appendInput_(Blockly.NEXT_STATEMENT,e)},Blockly.Block.prototype.appendDummyInput=function(e){return this.appendInput_(Blockly.DUMMY_INPUT,e||"")},Blockly.Block.prototype.jsonInit=function(e){if(goog.asserts.assert(void 0==e.output||void 0==e.previousStatement,"Must not have both an output and a previousStatement."),void 0!==e.colour){var t=e.colour;t=goog.isString(t)?Blockly.utils.replaceMessageReferences(t):t,this.setColour(t)}for(t=0;void 0!==e["message"+t];)this.interpolate_(e["message"+t],e["args"+t]||[],e["lastDummyAlign"+t]),t++;if(void 0!==e.inputsInline&&this.setInputsInline(e.inputsInline),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(t=e.tooltip,t=Blockly.utils.replaceMessageReferences(t),this.setTooltip(t)),void 0!==e.enableContextMenu&&(t=e.enableContextMenu,this.contextMenu=!!t),void 0!==e.helpUrl&&(t=e.helpUrl,t=Blockly.utils.replaceMessageReferences(t),this.setHelpUrl(t)),goog.isString(e.extensions)&&(console.warn("JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Blockly.Extensions.apply(e.mutator,this,!0),Array.isArray(e.extensions))for(e=e.extensions,t=0;t<e.length;++t)Blockly.Extensions.apply(e[t],this,!1)},Blockly.Block.prototype.mixin=function(e,t){if(goog.isDef(t)&&!goog.isBoolean(t))throw Error("opt_disableCheck must be a boolean if provided");if(!t){var o,i=[];for(o in e)void 0!==this[o]&&i.push(o);if(i.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(i))}goog.mixin(this,e)},Blockly.Block.prototype.interpolate_=function(e,t,o){var i=Blockly.utils.tokenizeInterpolation(e),n=[],r=0;e=[];for(var s=0;s<i.length;s++){var a=i[s];if("number"==typeof a){if(0>=a||a>t.length)throw Error('Block "'+this.type+'": Message index %'+a+" out of range.");if(n[a])throw Error('Block "'+this.type+'": Message index %'+a+" duplicated.");n[a]=!0,r++,e.push(t[a-1])}else(a=a.trim())&&e.push(a)}if(r!=t.length)throw Error('Block "'+this.type+'": Message does not reference all '+t.length+" arg(s).");for(e.length&&("string"==typeof e[e.length-1]||goog.string.startsWith(e[e.length-1].type,"field_"))&&(s={type:"input_dummy"},o&&(s.align=o),e.push(s)),o={LEFT:Blockly.ALIGN_LEFT,RIGHT:Blockly.ALIGN_RIGHT,CENTRE:Blockly.ALIGN_CENTRE},t=[],s=0;s<e.length;s++)if("string"==typeof(n=e[s]))t.push([n,void 0]);else{i=r=null;do{if(a=!1,"string"==typeof n)r=new Blockly.FieldLabel(n);else switch(n.type){case"input_value":i=this.appendValueInput(n.name);break;case"input_statement":i=this.appendStatementInput(n.name);break;case"input_dummy":i=this.appendDummyInput(n.name);break;case"field_label":r=Blockly.FieldLabel.fromJson(n);break;case"field_input":r=Blockly.FieldTextInput.fromJson(n);break;case"field_angle":r=Blockly.FieldAngle.fromJson(n);break;case"field_checkbox":r=Blockly.FieldCheckbox.fromJson(n);break;case"field_colour":r=Blockly.FieldColour.fromJson(n);break;case"field_variable":r=Blockly.FieldVariable.fromJson(n);break;case"field_dropdown":r=Blockly.FieldDropdown.fromJson(n);break;case"field_image":r=Blockly.FieldImage.fromJson(n);break;case"field_number":r=Blockly.FieldNumber.fromJson(n);break;case"field_date":if(Blockly.FieldDate){r=Blockly.FieldDate.fromJson(n);break}default:n.alt&&(n=n.alt,a=!0)}}while(a);if(r)t.push([r,n.name]);else if(i){for(n.check&&i.setCheck(n.check),n.align&&i.setAlign(o[n.align]),n=0;n<t.length;n++)i.appendField(t[n][0],t[n][1]);t.length=0}}},Blockly.Block.prototype.appendInput_=function(e,t){var o=null;return e!=Blockly.INPUT_VALUE&&e!=Blockly.NEXT_STATEMENT||(o=this.makeConnection_(e)),o=new Blockly.Input(e,t,this,o),this.inputList.push(o),o},Blockly.Block.prototype.moveInputBefore=function(e,t){if(e!=t){for(var o,i=-1,n=t?-1:this.inputList.length,r=0;o=this.inputList[r];r++)if(o.name==e){if(i=r,-1!=n)break}else if(t&&o.name==t&&(n=r,-1!=i))break;goog.asserts.assert(-1!=i,'Named input "%s" not found.',e),goog.asserts.assert(-1!=n,'Reference input "%s" not found.',t),this.moveNumberedInputBefore(i,n)}},Blockly.Block.prototype.moveNumberedInputBefore=function(e,t){goog.asserts.assert(e!=t,"Can't move input to itself."),goog.asserts.assert(e<this.inputList.length,"Input index "+e+" out of bounds."),goog.asserts.assert(t<=this.inputList.length,"Reference input "+t+" out of bounds.");var o=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,o)},Blockly.Block.prototype.removeInput=function(e,t){for(var o,i=0;o=this.inputList[i];i++)if(o.name==e){if(o.connection&&o.connection.isConnected()){o.connection.setShadowDom(null);var n=o.connection.targetBlock();n.isShadow()?n.dispose():n.unplug()}return o.dispose(),void this.inputList.splice(i,1)}t||goog.asserts.fail('Input "%s" not found.',e)},Blockly.Block.prototype.getInput=function(e){for(var t,o=0;t=this.inputList[o];o++)if(t.name==e)return t;return null},Blockly.Block.prototype.getInputTargetBlock=function(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()},Blockly.Block.prototype.getCommentText=function(){return this.comment||""},Blockly.Block.prototype.setCommentText=function(e){this.comment!=e&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"comment",null,this.comment,e||"")),this.comment=e)},Blockly.Block.prototype.setWarningText=function(e,t){},Blockly.Block.prototype.setMutator=function(e){},Blockly.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},Blockly.Block.prototype.moveBy=function(e,t){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var o=new Blockly.Events.BlockMove(this);this.xy_.translate(e,t),o.recordNew(),Blockly.Events.fire(o)},Blockly.Block.prototype.makeConnection_=function(e){return new Blockly.Connection(this,e)},Blockly.Block.prototype.allInputsFilled=function(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(var t,o=0;t=this.inputList[o];o++)if(t.connection&&(!(t=t.connection.targetBlock())||!t.allInputsFilled(e)))return!1;return!(o=this.getNextBlock())||o.allInputsFilled(e)},Blockly.Block.prototype.toDevString=function(){var e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e},Blockly.BlockDragSurfaceSvg=function(e){this.container_=e,this.createDom()},Blockly.BlockDragSurfaceSvg.prototype.SVG_=null,Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null,Blockly.BlockDragSurfaceSvg.prototype.container_=null,Blockly.BlockDragSurfaceSvg.prototype.scale_=1,Blockly.BlockDragSurfaceSvg.prototype.surfaceXY_=null,Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=Blockly.utils.createSvgElement("g",{},this.SVG_))},Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(e){goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Already dragging a block."),this.dragGroup_.appendChild(e),this.SVG_.style.display="block",this.surfaceXY_=new goog.math.Coordinate(0,0)},Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(e,t,o){this.scale_=o,e=e.toFixed(0),t=t.toFixed(0),this.dragGroup_.setAttribute("transform","translate("+e+","+t+") scale("+o+")")},Blockly.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var e=this.surfaceXY_.x,t=this.surfaceXY_.y;e=e.toFixed(0),t=t.toFixed(0),this.SVG_.style.display="block",Blockly.utils.setCssTransform(this.SVG_,"translate3d("+e+"px, "+t+"px, 0px)")},Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(e,t){this.surfaceXY_=new goog.math.Coordinate(e*this.scale_,t*this.scale_),this.translateSurfaceInternal_()},Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var e=Blockly.utils.getRelativeXY(this.SVG_);return new goog.math.Coordinate(e.x/this.scale_,e.y/this.scale_)},Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(e){e?e.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Drag group was not cleared."),this.surfaceXY_=null},Blockly.utils.uiMenu={},Blockly.utils.uiMenu.getSize=function(e){e=e.getElement();var t=goog.style.getSize(e);return t.height=e.scrollHeight,t},Blockly.utils.uiMenu.adjustBBoxesForRTL=function(e,t,o){t.left+=o.width,t.right+=o.width,e.left+=o.width,e.right+=o.width},Blockly.ContextMenu={},Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_=null,Blockly.ContextMenu.show=function(e,t,o){if(Blockly.WidgetDiv.show(Blockly.ContextMenu,o,null),t.length){var i=Blockly.ContextMenu.populate_(t,o);goog.events.listen(i,goog.ui.Component.EventType.ACTION,Blockly.ContextMenu.hide),Blockly.ContextMenu.position_(i,e,o),setTimeout(function(){i.getElement().focus()},1),Blockly.ContextMenu.currentBlock=null}else Blockly.ContextMenu.hide()},Blockly.ContextMenu.populate_=function(e,t){var o=new goog.ui.Menu;o.setRightToLeft(t);for(var i,n=0;i=e[n];n++){var r=new goog.ui.MenuItem(i.text);r.setRightToLeft(t),o.addChild(r,!0),r.setEnabled(i.enabled),i.enabled&&(goog.events.listen(r,goog.ui.Component.EventType.ACTION,i.callback),r.handleContextMenu=function(){goog.events.dispatchEvent(this,goog.ui.Component.EventType.ACTION)})}return o},Blockly.ContextMenu.position_=function(e,t,o){var i=Blockly.utils.getViewportBBox();t={top:t.clientY+i.top,bottom:t.clientY+i.top,left:t.clientX+i.left,right:t.clientX+i.left},Blockly.ContextMenu.createWidget_(e);var n=Blockly.utils.uiMenu.getSize(e);o&&Blockly.utils.uiMenu.adjustBBoxesForRTL(i,t,n),Blockly.WidgetDiv.positionWithAnchor(i,t,n,o),e.getElement().focus()},Blockly.ContextMenu.createWidget_=function(e){e.render(Blockly.WidgetDiv.DIV);var t=e.getElement();Blockly.utils.addClass(t,"blocklyContextMenu"),Blockly.bindEventWithChecks_(t,"contextmenu",null,Blockly.utils.noEvent),e.setAllowAutoFocus(!0)},Blockly.ContextMenu.hide=function(){Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu),Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_&&Blockly.unbindEvent_(Blockly.ContextMenu.eventWrapper_)},Blockly.ContextMenu.callbackFactory=function(e,t){return function(){Blockly.Events.disable();try{var o=Blockly.Xml.domToBlock(t,e.workspace),i=e.getRelativeToSurfaceXY();i.x=e.RTL?i.x-Blockly.SNAP_RADIUS:i.x+Blockly.SNAP_RADIUS,i.y+=2*Blockly.SNAP_RADIUS,o.moveBy(i.x,i.y)}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!o.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(o)),o.select()}},Blockly.ContextMenu.blockDeleteOption=function(e){var t=e.getDescendants(!0).length,o=e.getNextBlock();return o&&(t-=o.getDescendants(!0).length),{text:1==t?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(t)),enabled:!0,callback:function(){Blockly.Events.setGroup(!0),e.dispose(!0,!0),Blockly.Events.setGroup(!1)}}},Blockly.ContextMenu.blockHelpOption=function(e){return{enabled:!(goog.isFunction(e.helpUrl)?!e.helpUrl():!e.helpUrl),text:Blockly.Msg.HELP,callback:function(){e.showHelp_()}}},Blockly.ContextMenu.blockDuplicateOption=function(e){var t=!0;return e.getDescendants().length>e.workspace.remainingCapacity()&&(t=!1),{text:Blockly.Msg.DUPLICATE_BLOCK,enabled:t,callback:function(){Blockly.duplicate_(e)}}},Blockly.ContextMenu.blockCommentOption=function(e){var t={enabled:!goog.userAgent.IE};return e.comment?(t.text=Blockly.Msg.REMOVE_COMMENT,t.callback=function(){e.setCommentText(null)}):(t.text=Blockly.Msg.ADD_COMMENT,t.callback=function(){e.setCommentText("")}),t},Blockly.BlockSvg=function(e,t,o){this.svgGroup_=Blockly.utils.createSvgElement("g",{},null),this.svgGroup_.translate_="",this.svgPathDark_=Blockly.utils.createSvgElement("path",{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgGroup_),this.svgPath_=Blockly.utils.createSvgElement("path",{class:"blocklyPath"},this.svgGroup_),this.svgPathLight_=Blockly.utils.createSvgElement("path",{class:"blocklyPathLight"},this.svgGroup_),this.svgPath_.tooltip=this,this.rendered=!1,this.useDragSurface_=Blockly.utils.is3dSupported()&&!!e.blockDragSurface_,Blockly.Tooltip.bindMouseEvents(this.svgPath_),Blockly.BlockSvg.superClass_.constructor.call(this,e,t,o)},goog.inherits(Blockly.BlockSvg,Blockly.Block),Blockly.BlockSvg.prototype.height=0,Blockly.BlockSvg.prototype.width=0,Blockly.BlockSvg.prototype.dragStartXY_=null,Blockly.BlockSvg.prototype.warningTextDb_=null,Blockly.BlockSvg.INLINE=-1,Blockly.BlockSvg.prototype.initSvg=function(){goog.asserts.assert(this.workspace.rendered,"Workspace is headless.");for(var e,t=0;e=this.inputList[t];t++)e.init();for(e=this.getIcons(),t=0;t<e.length;t++)e[t].createIcon();this.updateColour(),this.updateMovable(),this.workspace.options.readOnly||this.eventsInit_||Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,this.getSvgRoot().parentNode||this.workspace.getCanvas().appendChild(this.getSvgRoot())},Blockly.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(Blockly.selected!=this){var e=null;if(Blockly.selected){e=Blockly.selected.id,Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}(e=new Blockly.Events.Ui(null,"selected",e,this.id)).workspaceId=this.workspace.id,Blockly.Events.fire(e),Blockly.selected=this,this.addSelect()}},Blockly.BlockSvg.prototype.unselect=function(){if(Blockly.selected==this){var e=new Blockly.Events.Ui(null,"selected",this.id,null);e.workspaceId=this.workspace.id,Blockly.Events.fire(e),Blockly.selected=null,this.removeSelect()}},Blockly.BlockSvg.prototype.mutator=null,Blockly.BlockSvg.prototype.comment=null,Blockly.BlockSvg.prototype.warning=null,Blockly.BlockSvg.prototype.getIcons=function(){var e=[];return this.mutator&&e.push(this.mutator),this.comment&&e.push(this.comment),this.warning&&e.push(this.warning),e},Blockly.BlockSvg.prototype.setParent=function(e){if(e!=this.parentBlock_){var t=this.getSvgRoot();if(this.parentBlock_&&t){var o=this.getRelativeToSurfaceXY();this.workspace.getCanvas().appendChild(t),t.setAttribute("transform","translate("+o.x+","+o.y+")")}Blockly.Field.startCache(),Blockly.BlockSvg.superClass_.setParent.call(this,e),Blockly.Field.stopCache(),e&&(o=this.getRelativeToSurfaceXY(),e.getSvgRoot().appendChild(t),e=this.getRelativeToSurfaceXY(),this.moveConnections_(e.x-o.x,e.y-o.y))}},Blockly.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var e=0,t=0,o=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null,i=this.getSvgRoot();if(i)do{var n=Blockly.utils.getRelativeXY(i);e+=n.x,t+=n.y,this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==i&&(e+=(n=this.workspace.blockDragSurface_.getSurfaceTranslation()).x,t+=n.y),i=i.parentNode}while(i&&i!=this.workspace.getCanvas()&&i!=o);return new goog.math.Coordinate(e,t)},Blockly.BlockSvg.prototype.moveBy=function(e,t){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var o=new Blockly.Events.BlockMove(this),i=this.getRelativeToSurfaceXY();this.translate(i.x+e,i.y+t),this.moveConnections_(e,t),o.recordNew(),this.workspace.resizeContents(),Blockly.Events.fire(o)},Blockly.BlockSvg.prototype.translate=function(e,t){this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")},Blockly.BlockSvg.prototype.moveToDragSurface_=function(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.blockDragSurface_.translateSurface(e.x,e.y),this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())}},Blockly.BlockSvg.prototype.moveOffDragSurface_=function(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas()))},Blockly.BlockSvg.prototype.moveDuringDrag=function(e){this.useDragSurface_?this.workspace.blockDragSurface_.translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},Blockly.BlockSvg.prototype.clearTransformAttributes_=function(){Blockly.utils.removeAttribute(this.getSvgRoot(),"transform")},Blockly.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),o=t/2,i=this.getRelativeToSurfaceXY();e=Math.round((i.x-o)/t)*t+o-i.x,t=Math.round((i.y-o)/t)*t+o-i.y,e=Math.round(e),t=Math.round(t),0==e&&0==t||this.moveBy(e,t)}}},Blockly.BlockSvg.prototype.getBoundingRectangle=function(){var e=this.getRelativeToSurfaceXY(this),t=this.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,o=this.getHeightWidth();if(this.RTL){var i=new goog.math.Coordinate(e.x-(o.width-t),e.y);e=new goog.math.Coordinate(e.x+t,e.y+o.height)}else i=new goog.math.Coordinate(e.x-t,e.y),e=new goog.math.Coordinate(e.x+o.width-t,e.y+o.height);return{topLeft:i,bottomRight:e}},Blockly.BlockSvg.prototype.setCollapsed=function(e){if(this.collapsed_!=e){for(var t,o=[],i=0;t=this.inputList[i];i++)o.push.apply(o,t.setVisible(!e));if(e){for(t=this.getIcons(),i=0;i<t.length;i++)t[i].setVisible(!1);i=this.toString(Blockly.COLLAPSE_CHARS),this.appendDummyInput("_TEMP_COLLAPSED_INPUT").appendField(i).init()}else this.removeInput("_TEMP_COLLAPSED_INPUT"),this.setWarningText(null);if(Blockly.BlockSvg.superClass_.setCollapsed.call(this,e),o.length||(o[0]=this),this.rendered)for(i=0;e=o[i];i++)e.render()}},Blockly.BlockSvg.prototype.tab=function(e,t){var o=this.createTabList_(),i=o.indexOf(e);-1==i&&(i=t?-1:o.length),(o=o[t?i+1:i-1])?o instanceof Blockly.Field?o.showEditor_():o.tab(null,t):(o=this.getParent())&&o.tab(this,t)},Blockly.BlockSvg.prototype.createTabList_=function(){for(var e,t=[],o=0;e=this.inputList[o];o++){for(var i,n=0;i=e.fieldRow[n];n++)i instanceof Blockly.FieldTextInput&&t.push(i);e.connection&&(e=e.connection.targetBlock())&&t.push(e)}return t},Blockly.BlockSvg.prototype.onMouseDown_=function(e){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)},Blockly.BlockSvg.prototype.showHelp_=function(){var e=goog.isFunction(this.helpUrl)?this.helpUrl():this.helpUrl;e&&window.open(e)},Blockly.BlockSvg.prototype.showContextMenu_=function(e){if(!this.workspace.options.readOnly&&this.contextMenu){var t=this,o=[];if(this.isDeletable()&&this.isMovable()&&!t.isInFlyout){if(o.push(Blockly.ContextMenu.blockDuplicateOption(t)),this.isEditable()&&!this.collapsed_&&this.workspace.options.comments&&o.push(Blockly.ContextMenu.blockCommentOption(t)),!this.collapsed_)for(var i=1;i<this.inputList.length;i++)if(this.inputList[i-1].type!=Blockly.NEXT_STATEMENT&&this.inputList[i].type!=Blockly.NEXT_STATEMENT){i={enabled:!0};var n=this.getInputsInline();i.text=n?Blockly.Msg.EXTERNAL_INPUTS:Blockly.Msg.INLINE_INPUTS,i.callback=function(){t.setInputsInline(!n)},o.push(i);break}this.workspace.options.collapse&&(this.collapsed_?((i={enabled:!0}).text=Blockly.Msg.EXPAND_BLOCK,i.callback=function(){t.setCollapsed(!1)},o.push(i)):((i={enabled:!0}).text=Blockly.Msg.COLLAPSE_BLOCK,i.callback=function(){t.setCollapsed(!0)},o.push(i))),this.workspace.options.disable&&(i={text:this.disabled?Blockly.Msg.ENABLE_BLOCK:Blockly.Msg.DISABLE_BLOCK,enabled:!this.getInheritedDisabled(),callback:function(){t.setDisabled(!t.disabled)}},o.push(i)),o.push(Blockly.ContextMenu.blockDeleteOption(t))}o.push(Blockly.ContextMenu.blockHelpOption(t)),this.customContextMenu&&this.customContextMenu(o),Blockly.ContextMenu.show(e,o,this.RTL),Blockly.ContextMenu.currentBlock=this}},Blockly.BlockSvg.prototype.moveConnections_=function(e,t){if(this.rendered){for(var o=this.getConnections_(!1),i=0;i<o.length;i++)o[i].moveBy(e,t);for(o=this.getIcons(),i=0;i<o.length;i++)o[i].computeIconLocation();for(i=0;i<this.childBlocks_.length;i++)this.childBlocks_[i].moveConnections_(e,t)}},Blockly.BlockSvg.prototype.setDragging=function(e){if(e){var t=this.getSvgRoot();t.translate_="",t.skew_="",Blockly.draggingConnections_=Blockly.draggingConnections_.concat(this.getConnections_(!0)),Blockly.utils.addClass(this.svgGroup_,"blocklyDragging")}else Blockly.draggingConnections_=[],Blockly.utils.removeClass(this.svgGroup_,"blocklyDragging");for(t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)},Blockly.BlockSvg.prototype.updateMovable=function(){this.isMovable()?Blockly.utils.addClass(this.svgGroup_,"blocklyDraggable"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggable")},Blockly.BlockSvg.prototype.setMovable=function(e){Blockly.BlockSvg.superClass_.setMovable.call(this,e),this.updateMovable()},Blockly.BlockSvg.prototype.setEditable=function(e){Blockly.BlockSvg.superClass_.setEditable.call(this,e),e=this.getIcons();for(var t=0;t<e.length;t++)e[t].updateEditable()},Blockly.BlockSvg.prototype.setShadow=function(e){Blockly.BlockSvg.superClass_.setShadow.call(this,e),this.updateColour()},Blockly.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},Blockly.BlockSvg.prototype.dispose=function(e,t){if(this.workspace){Blockly.Tooltip.hide(),Blockly.Field.startCache();var o=this.workspace;if(Blockly.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Blockly.ContextMenu.currentBlock==this&&Blockly.ContextMenu.hide(),t&&this.rendered&&(this.unplug(e),this.disposeUiEffect()),this.rendered=!1,this.warningTextDb_){for(var i in this.warningTextDb_)clearTimeout(this.warningTextDb_[i]);this.warningTextDb_=null}Blockly.Events.disable();try{var n=this.getIcons();for(i=0;i<n.length;i++)n[i].dispose()}finally{Blockly.Events.enable()}Blockly.BlockSvg.superClass_.dispose.call(this,e),goog.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgPathDark_=this.svgPathLight_=this.svgPath_=this.svgGroup_=null,Blockly.Field.stopCache()}},Blockly.BlockSvg.prototype.disposeUiEffect=function(){this.workspace.getAudioManager().play("delete");var e=this.workspace.getSvgXY(this.svgGroup_),t=this.svgGroup_.cloneNode(!0);t.translateX_=e.x,t.translateY_=e.y,t.setAttribute("transform","translate("+t.translateX_+","+t.translateY_+")"),this.workspace.getParentSvg().appendChild(t),t.bBox_=t.getBBox(),Blockly.BlockSvg.disposeUiStep_(t,this.RTL,new Date,this.workspace.scale)},Blockly.BlockSvg.disposeUiStep_=function(e,t,o,i){var n=(new Date-o)/150;1<n?goog.dom.removeNode(e):(e.setAttribute("transform","translate("+(e.translateX_+(t?-1:1)*e.bBox_.width*i/2*n)+","+(e.translateY_+e.bBox_.height*i*n)+") scale("+(1-n)*i+")"),setTimeout(Blockly.BlockSvg.disposeUiStep_,10,e,t,o,i))},Blockly.BlockSvg.prototype.connectionUiEffect=function(){if(this.workspace.getAudioManager().play("click"),!(1>this.workspace.scale)){var e=this.workspace.getSvgXY(this.svgGroup_);this.outputConnection?(e.x+=(this.RTL?3:-3)*this.workspace.scale,e.y+=13*this.workspace.scale):this.previousConnection&&(e.x+=(this.RTL?-23:23)*this.workspace.scale,e.y+=3*this.workspace.scale),e=Blockly.utils.createSvgElement("circle",{cx:e.x,cy:e.y,r:0,fill:"none",stroke:"#888","stroke-width":10},this.workspace.getParentSvg()),Blockly.BlockSvg.connectionUiStep_(e,new Date,this.workspace.scale)}},Blockly.BlockSvg.connectionUiStep_=function(e,t,o){var i=(new Date-t)/150;1<i?goog.dom.removeNode(e):(e.setAttribute("r",25*i*o),e.style.opacity=1-i,Blockly.BlockSvg.disconnectUiStop_.pid_=setTimeout(Blockly.BlockSvg.connectionUiStep_,10,e,t,o))},Blockly.BlockSvg.prototype.disconnectUiEffect=function(){if(this.workspace.getAudioManager().play("disconnect"),!(1>this.workspace.scale)){var e=this.getHeightWidth().height;e=Math.atan(10/e)/Math.PI*180,this.RTL||(e*=-1),Blockly.BlockSvg.disconnectUiStep_(this.svgGroup_,e,new Date)}},Blockly.BlockSvg.disconnectUiStep_=function(e,t,o){var i=(new Date-o)/200;1<i?e.skew_="":(e.skew_="skewX("+Math.round(Math.sin(i*Math.PI*3)*(1-i)*t)+")",Blockly.BlockSvg.disconnectUiStop_.group=e,Blockly.BlockSvg.disconnectUiStop_.pid=setTimeout(Blockly.BlockSvg.disconnectUiStep_,10,e,t,o)),e.setAttribute("transform",e.translate_+e.skew_)},Blockly.BlockSvg.disconnectUiStop_=function(){if(Blockly.BlockSvg.disconnectUiStop_.group){clearTimeout(Blockly.BlockSvg.disconnectUiStop_.pid);var e=Blockly.BlockSvg.disconnectUiStop_.group;e.skew_="",e.setAttribute("transform",e.translate_),Blockly.BlockSvg.disconnectUiStop_.group=null}},Blockly.BlockSvg.disconnectUiStop_.pid=0,Blockly.BlockSvg.disconnectUiStop_.group=null,Blockly.BlockSvg.prototype.updateColour=function(){if(!this.disabled){var e=this.getColour(),t=goog.color.hexToRgb(e);if(this.isShadow())t=goog.color.lighten(t,.6),e=goog.color.rgbArrayToHex(t),this.svgPathLight_.style.display="none",this.svgPathDark_.setAttribute("fill",e);else{this.svgPathLight_.style.display="";var o=goog.color.rgbArrayToHex(goog.color.lighten(t,.3));t=goog.color.rgbArrayToHex(goog.color.darken(t,.2)),this.svgPathLight_.setAttribute("stroke",o),this.svgPathDark_.setAttribute("fill",t)}for(this.svgPath_.setAttribute("fill",e),e=this.getIcons(),o=0;o<e.length;o++)e[o].updateColour();for(e=0;o=this.inputList[e];e++){t=0;for(var i;i=o.fieldRow[t];t++)i.forceRerender()}}},Blockly.BlockSvg.prototype.updateDisabled=function(){this.disabled||this.getInheritedDisabled()?Blockly.utils.addClass(this.svgGroup_,"blocklyDisabled")&&this.svgPath_.setAttribute("fill","url(#"+this.workspace.options.disabledPatternId+")"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDisabled")&&this.updateColour();for(var e,t=this.getChildren(),o=0;e=t[o];o++)e.updateDisabled()},Blockly.BlockSvg.prototype.getCommentText=function(){return this.comment?this.comment.getText().replace(/\s+$/,"").replace(/ +\n/g,"\n"):""},Blockly.BlockSvg.prototype.setCommentText=function(e){var t=!1;goog.isString(e)?(this.comment||(this.comment=new Blockly.Comment(this),t=!0),this.comment.setText(e)):this.comment&&(this.comment.dispose(),t=!0),t&&this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setWarningText=function(e,t){this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=t||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var i in this.warningTextDb_)clearTimeout(this.warningTextDb_[i]),delete this.warningTextDb_[i];if(this.workspace.isDragging()){var n=this;this.warningTextDb_[o]=setTimeout(function(){n.workspace&&(delete n.warningTextDb_[o],n.setWarningText(e,o))},100)}else{this.isInFlyout&&(e=null),i=this.getSurroundParent();for(var r=null;i;)i.isCollapsed()&&(r=i),i=i.getSurroundParent();r&&r.setWarningText(e,"collapsed "+this.id+" "+o),i=!1,goog.isString(e)?(this.warning||(this.warning=new Blockly.Warning(this),i=!0),this.warning.setText(e,o)):this.warning&&!o?(this.warning.dispose(),i=!0):this.warning&&(i=this.warning.getText(),this.warning.setText("",o),(r=this.warning.getText())||this.warning.dispose(),i=i!=r),i&&this.rendered&&(this.render(),this.bumpNeighbours_())}},Blockly.BlockSvg.prototype.setMutator=function(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.block_=this,this.mutator=e,e.createIcon())},Blockly.BlockSvg.prototype.setDisabled=function(e){this.disabled!=e&&(Blockly.BlockSvg.superClass_.setDisabled.call(this,e),this.rendered&&this.updateDisabled())},Blockly.BlockSvg.prototype.setHighlighted=function(e){this.rendered&&(e?(this.svgPath_.setAttribute("filter","url(#"+this.workspace.options.embossFilterId+")"),this.svgPathLight_.style.display="none"):(Blockly.utils.removeAttribute(this.svgPath_,"filter"),delete this.svgPathLight_.style.display))},Blockly.BlockSvg.prototype.addSelect=function(){Blockly.utils.addClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.setDeleteStyle=function(e){e?Blockly.utils.addClass(this.svgGroup_,"blocklyDraggingDelete"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggingDelete")},Blockly.BlockSvg.prototype.setColour=function(e){Blockly.BlockSvg.superClass_.setColour.call(this,e),this.rendered&&this.updateColour()},Blockly.BlockSvg.prototype.bringToFront=function(){var e=this;do{var t=e.getSvgRoot();t.parentNode.appendChild(t),e=e.getParent()}while(e)},Blockly.BlockSvg.prototype.setPreviousStatement=function(e,t){Blockly.BlockSvg.superClass_.setPreviousStatement.call(this,e,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setNextStatement=function(e,t){Blockly.BlockSvg.superClass_.setNextStatement.call(this,e,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setOutput=function(e,t){Blockly.BlockSvg.superClass_.setOutput.call(this,e,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setInputsInline=function(e){Blockly.BlockSvg.superClass_.setInputsInline.call(this,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.removeInput=function(e,t){Blockly.BlockSvg.superClass_.removeInput.call(this,e,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.moveNumberedInputBefore=function(e,t){Blockly.BlockSvg.superClass_.moveNumberedInputBefore.call(this,e,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.appendInput_=function(e,t){var o=Blockly.BlockSvg.superClass_.appendInput_.call(this,e,t);return this.rendered&&(this.render(),this.bumpNeighbours_()),o},Blockly.BlockSvg.prototype.getConnections_=function(e){var t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)){e=0;for(var o;o=this.inputList[e];e++)o.connection&&t.push(o.connection)}return t},Blockly.BlockSvg.prototype.makeConnection_=function(e){return new Blockly.RenderedConnection(this,e)},Blockly.BlockSvg.prototype.bumpNeighbours_=function(){if(this.workspace&&!this.workspace.isDragging()){var e=this.getRootBlock();if(!e.isInFlyout)for(var t,o=this.getConnections_(!1),i=0;t=o[i];i++){t.isConnected()&&t.isSuperior()&&t.targetBlock().bumpNeighbours_();for(var n,r=t.neighbours_(Blockly.SNAP_RADIUS),s=0;n=r[s];s++)t.isConnected()&&n.isConnected()||n.getSourceBlock().getRootBlock()!=e&&(t.isSuperior()?n.bumpAwayFrom_(t):t.bumpAwayFrom_(n))}}},Blockly.BlockSvg.prototype.scheduleSnapAndBump=function(){var e=this,t=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(t),e.snapToGrid(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY/2),setTimeout(function(){Blockly.Events.setGroup(t),e.bumpNeighbours_(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)},Blockly.BlockSvg.render={},Blockly.BlockSvg.SEP_SPACE_X=10,Blockly.BlockSvg.SEP_SPACE_Y=10,Blockly.BlockSvg.INLINE_PADDING_Y=5,Blockly.BlockSvg.MIN_BLOCK_Y=25,Blockly.BlockSvg.TAB_HEIGHT=20,Blockly.BlockSvg.TAB_WIDTH=8,Blockly.BlockSvg.NOTCH_WIDTH=30,Blockly.BlockSvg.CORNER_RADIUS=8,Blockly.BlockSvg.START_HAT=!1,Blockly.BlockSvg.START_HAT_HEIGHT=15,Blockly.BlockSvg.START_HAT_PATH="c 30,-"+Blockly.BlockSvg.START_HAT_HEIGHT+" 70,-"+Blockly.BlockSvg.START_HAT_HEIGHT+" 100,0",Blockly.BlockSvg.START_HAT_HIGHLIGHT_LTR="c 17.8,-9.2 45.3,-14.9 75,-8.7 M 100.5,0.5",Blockly.BlockSvg.START_HAT_HIGHLIGHT_RTL="m 25,-8.7 c 29.7,-6.2 57.2,-0.5 75,8.7",Blockly.BlockSvg.DISTANCE_45_INSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS-.5)+.5,Blockly.BlockSvg.DISTANCE_45_OUTSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS+.5)-.5,Blockly.BlockSvg.NOTCH_PATH_LEFT="l 6,4 3,0 6,-4",Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT="l 6,4 3,0 6,-4",Blockly.BlockSvg.NOTCH_PATH_RIGHT="l -6,4 -3,0 -6,-4",Blockly.BlockSvg.JAGGED_TEETH="l 8,0 0,4 8,4 -16,8 8,4",Blockly.BlockSvg.JAGGED_TEETH_HEIGHT=20,Blockly.BlockSvg.JAGGED_TEETH_WIDTH=15,Blockly.BlockSvg.TAB_PATH_DOWN="v 5 c 0,10 -"+Blockly.BlockSvg.TAB_WIDTH+",-8 -"+Blockly.BlockSvg.TAB_WIDTH+",7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",-2.5 "+Blockly.BlockSvg.TAB_WIDTH+",7.5",Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL="v 6.5 m -"+.97*Blockly.BlockSvg.TAB_WIDTH+",3 q -"+.05*Blockly.BlockSvg.TAB_WIDTH+",10 "+.3*Blockly.BlockSvg.TAB_WIDTH+",9.5 m "+.67*Blockly.BlockSvg.TAB_WIDTH+",-1.9 v 1.4",Blockly.BlockSvg.TOP_LEFT_CORNER_START="m 0,"+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL="m "+Blockly.BlockSvg.DISTANCE_45_INSIDE+","+Blockly.BlockSvg.DISTANCE_45_INSIDE,Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR="m 0.5,"+(Blockly.BlockSvg.CORNER_RADIUS-.5),Blockly.BlockSvg.TOP_LEFT_CORNER="A "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0",Blockly.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT="A "+(Blockly.BlockSvg.CORNER_RADIUS-.5)+","+(Blockly.BlockSvg.CORNER_RADIUS-.5)+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0.5",Blockly.BlockSvg.INNER_TOP_LEFT_CORNER=Blockly.BlockSvg.NOTCH_PATH_RIGHT+" h -"+(Blockly.BlockSvg.NOTCH_WIDTH-15-Blockly.BlockSvg.CORNER_RADIUS)+" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+(-Blockly.BlockSvg.DISTANCE_45_OUTSIDE-.5)+","+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE),Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL="a "+(Blockly.BlockSvg.CORNER_RADIUS+.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+.5)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS+.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+.5),Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR="a "+(Blockly.BlockSvg.CORNER_RADIUS+.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+.5)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)+","+(Blockly.BlockSvg.DISTANCE_45_OUTSIDE+.5),Blockly.BlockSvg.prototype.getHeightWidth=function(){var e=this.height,t=this.width,o=this.getNextBlock();return o?(e+=(o=o.getHeightWidth()).height-4,t=Math.max(t,o.width)):this.nextConnection||this.outputConnection||(e+=2),{height:e,width:t}},Blockly.BlockSvg.prototype.render=function(e){Blockly.Field.startCache(),this.rendered=!0;var t=Blockly.BlockSvg.SEP_SPACE_X;this.RTL&&(t=-t);for(var o=this.getIcons(),i=0;i<o.length;i++)t=o[i].renderIcon(t);t+=this.RTL?Blockly.BlockSvg.SEP_SPACE_X:-Blockly.BlockSvg.SEP_SPACE_X,o=this.renderCompute_(t),this.renderDraw_(t,o),this.renderMoveConnections_(),!1!==e&&((e=this.getParent())?e.render(!0):this.workspace.resizeContents()),Blockly.Field.stopCache()},Blockly.BlockSvg.prototype.renderFields_=function(e,t,o){o+=Blockly.BlockSvg.INLINE_PADDING_Y,this.RTL&&(t=-t);for(var i,n=0;i=e[n];n++){var r=i.getSvgRoot();r&&(this.RTL?(t-=i.renderSep+i.renderWidth,r.setAttribute("transform","translate("+t+","+o+")"),i.renderWidth&&(t-=Blockly.BlockSvg.SEP_SPACE_X)):(r.setAttribute("transform","translate("+(t+i.renderSep)+","+o+")"),i.renderWidth&&(t+=i.renderSep+i.renderWidth+Blockly.BlockSvg.SEP_SPACE_X)))}return this.RTL?-t:t},Blockly.BlockSvg.prototype.renderCompute_=function(e){var t=this.inputList,o=[];o.rightEdge=e+2*Blockly.BlockSvg.SEP_SPACE_X,(this.previousConnection||this.nextConnection)&&(o.rightEdge=Math.max(o.rightEdge,Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.SEP_SPACE_X));for(var i,n=0,r=0,s=!1,a=!1,l=!1,c=void 0,u=this.getInputsInline()&&!this.isCollapsed(),h=0;i=t[h];h++)if(i.isVisible()){if(u&&c&&c!=Blockly.NEXT_STATEMENT&&i.type!=Blockly.NEXT_STATEMENT)var g=o[o.length-1];else c=i.type,(g=[]).type=u&&i.type!=Blockly.NEXT_STATEMENT?Blockly.BlockSvg.INLINE:i.type,g.height=0,o.push(g);if(g.push(i),i.renderHeight=Blockly.BlockSvg.MIN_BLOCK_Y,i.renderWidth=u&&i.type==Blockly.INPUT_VALUE?Blockly.BlockSvg.TAB_WIDTH+1.25*Blockly.BlockSvg.SEP_SPACE_X:0,i.connection&&i.connection.isConnected()){var d=i.connection.targetBlock().getHeightWidth();i.renderHeight=Math.max(i.renderHeight,d.height),i.renderWidth=Math.max(i.renderWidth,d.width)}u||h!=t.length-1?!u&&i.type==Blockly.INPUT_VALUE&&t[h+1]&&t[h+1].type==Blockly.NEXT_STATEMENT&&i.renderHeight--:i.renderHeight--,g.height=Math.max(g.height,i.renderHeight),i.fieldWidth=0,1==o.length&&(i.fieldWidth+=this.RTL?-e:e),d=!1;for(var p,f=0;p=i.fieldRow[f];f++){0!=f&&(i.fieldWidth+=Blockly.BlockSvg.SEP_SPACE_X);var m=p.getSize();p.renderWidth=m.width,p.renderSep=d&&p.EDITABLE?Blockly.BlockSvg.SEP_SPACE_X:0,i.fieldWidth+=p.renderWidth+p.renderSep,g.height=Math.max(g.height,m.height),d=p.EDITABLE}g.type!=Blockly.BlockSvg.INLINE&&(g.type==Blockly.NEXT_STATEMENT?(a=!0,r=Math.max(r,i.fieldWidth)):(g.type==Blockly.INPUT_VALUE?s=!0:g.type==Blockly.DUMMY_INPUT&&(l=!0),n=Math.max(n,i.fieldWidth)))}for(e=0;g=o[e];e++)if(g.thicker=!1,g.type==Blockly.BlockSvg.INLINE)for(t=0;i=g[t];t++)if(i.type==Blockly.INPUT_VALUE){g.height+=2*Blockly.BlockSvg.INLINE_PADDING_Y,g.thicker=!0;break}return o.statementEdge=2*Blockly.BlockSvg.SEP_SPACE_X+r,a&&(o.rightEdge=Math.max(o.rightEdge,o.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH)),s?o.rightEdge=Math.max(o.rightEdge,n+2*Blockly.BlockSvg.SEP_SPACE_X+Blockly.BlockSvg.TAB_WIDTH):l&&(o.rightEdge=Math.max(o.rightEdge,n+2*Blockly.BlockSvg.SEP_SPACE_X)),o.hasValue=s,o.hasStatement=a,o.hasDummy=l,o},Blockly.BlockSvg.prototype.renderDraw_=function(e,t){if(this.startHat_=!1,this.height=0,this.outputConnection)this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!0;else{if(this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!1,this.previousConnection){var o=this.previousConnection.targetBlock();o&&o.getNextBlock()==this&&(this.squareTopLeftCorner_=!0)}else Blockly.BlockSvg.START_HAT&&(this.startHat_=this.squareTopLeftCorner_=!0,this.height+=Blockly.BlockSvg.START_HAT_HEIGHT,t.rightEdge=Math.max(t.rightEdge,100));this.getNextBlock()&&(this.squareBottomLeftCorner_=!0)}var i=[],n=[];o=[];var r=[];this.renderDrawTop_(i,o,t.rightEdge);var s=this.renderDrawRight_(i,o,n,r,t,e);this.renderDrawBottom_(i,o,s),this.renderDrawLeft_(i,o),i=i.join(" ")+"\n"+n.join(" "),this.svgPath_.setAttribute("d",i),this.svgPathDark_.setAttribute("d",i),i=o.join(" ")+"\n"+r.join(" "),this.svgPathLight_.setAttribute("d",i),this.RTL&&(this.svgPath_.setAttribute("transform","scale(-1 1)"),this.svgPathLight_.setAttribute("transform","scale(-1 1)"),this.svgPathDark_.setAttribute("transform","translate(1,1) scale(-1 1)"))},Blockly.BlockSvg.prototype.renderMoveConnections_=function(){var e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(var t=0;t<this.inputList.length;t++){var o=this.inputList[t].connection;o&&(o.moveToOffset(e),o.isConnected()&&o.tighten_())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten_())},Blockly.BlockSvg.prototype.renderDrawTop_=function(e,t,o){this.squareTopLeftCorner_?(e.push("m 0,0"),t.push("m 0.5,0.5"),this.startHat_&&(e.push(Blockly.BlockSvg.START_HAT_PATH),t.push(this.RTL?Blockly.BlockSvg.START_HAT_HIGHLIGHT_RTL:Blockly.BlockSvg.START_HAT_HIGHLIGHT_LTR))):(e.push(Blockly.BlockSvg.TOP_LEFT_CORNER_START),t.push(this.RTL?Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL:Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR),e.push(Blockly.BlockSvg.TOP_LEFT_CORNER),t.push(Blockly.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT)),this.previousConnection&&(e.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),t.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),e.push(Blockly.BlockSvg.NOTCH_PATH_LEFT),t.push(Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT),this.previousConnection.setOffsetInBlock(this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH,0)),e.push("H",o),t.push("H",o-.5),this.width=o},Blockly.BlockSvg.prototype.renderDrawRight_=function(e,t,o,i,n,r){for(var s,a,l,c,u=0,h=0;c=n[h];h++){if(s=Blockly.BlockSvg.SEP_SPACE_X,0==h&&(s+=this.RTL?-r:r),t.push("M",n.rightEdge-.5+","+(u+.5)),this.isCollapsed()){var g=c[0];a=u,this.renderFields_(g.fieldRow,s,a),e.push(Blockly.BlockSvg.JAGGED_TEETH),t.push("h 8"),g=c.height-Blockly.BlockSvg.JAGGED_TEETH_HEIGHT,e.push("v",g),this.RTL&&(t.push("v 3.9 l 7.2,3.4 m -14.5,8.9 l 7.3,3.5"),t.push("v",g-.7)),this.width+=Blockly.BlockSvg.JAGGED_TEETH_WIDTH}else if(c.type==Blockly.BlockSvg.INLINE){for(var d=0;g=c[d];d++)a=u,c.thicker&&(a+=Blockly.BlockSvg.INLINE_PADDING_Y),s=this.renderFields_(g.fieldRow,s,a),g.type!=Blockly.DUMMY_INPUT&&(s+=g.renderWidth+Blockly.BlockSvg.SEP_SPACE_X),g.type==Blockly.INPUT_VALUE&&(o.push("M",s-Blockly.BlockSvg.SEP_SPACE_X+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y)),o.push("h",Blockly.BlockSvg.TAB_WIDTH-2-g.renderWidth),o.push(Blockly.BlockSvg.TAB_PATH_DOWN),o.push("v",g.renderHeight+1-Blockly.BlockSvg.TAB_HEIGHT),o.push("h",g.renderWidth+2-Blockly.BlockSvg.TAB_WIDTH),o.push("z"),this.RTL?(i.push("M",s-Blockly.BlockSvg.SEP_SPACE_X-2.5+Blockly.BlockSvg.TAB_WIDTH-g.renderWidth+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+.5)),i.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),i.push("v",g.renderHeight-Blockly.BlockSvg.TAB_HEIGHT+2.5),i.push("h",g.renderWidth-Blockly.BlockSvg.TAB_WIDTH+2)):(i.push("M",s-Blockly.BlockSvg.SEP_SPACE_X+.5+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+.5)),i.push("v",g.renderHeight+1),i.push("h",Blockly.BlockSvg.TAB_WIDTH-2-g.renderWidth),i.push("M",s-g.renderWidth-Blockly.BlockSvg.SEP_SPACE_X+.9+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+Blockly.BlockSvg.TAB_HEIGHT-.7)),i.push("l",.46*Blockly.BlockSvg.TAB_WIDTH+",-2.1")),a=this.RTL?-s-Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X+g.renderWidth+1:s+Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-g.renderWidth-1,l=u+Blockly.BlockSvg.INLINE_PADDING_Y+1,g.connection.setOffsetInBlock(a,l));s=Math.max(s,n.rightEdge),this.width=Math.max(this.width,s),e.push("H",s),t.push("H",s-.5),e.push("v",c.height),this.RTL&&t.push("v",c.height-1)}else c.type==Blockly.INPUT_VALUE?(a=u,(g=c[0]).align!=Blockly.ALIGN_LEFT&&(d=n.rightEdge-g.fieldWidth-Blockly.BlockSvg.TAB_WIDTH-2*Blockly.BlockSvg.SEP_SPACE_X,g.align==Blockly.ALIGN_RIGHT?s+=d:g.align==Blockly.ALIGN_CENTRE&&(s+=d/2)),this.renderFields_(g.fieldRow,s,a),e.push(Blockly.BlockSvg.TAB_PATH_DOWN),d=c.height-Blockly.BlockSvg.TAB_HEIGHT,e.push("v",d),this.RTL?(t.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),t.push("v",d+.5)):(t.push("M",n.rightEdge-5+","+(u+Blockly.BlockSvg.TAB_HEIGHT-.7)),t.push("l",.46*Blockly.BlockSvg.TAB_WIDTH+",-2.1")),a=this.RTL?-n.rightEdge-1:n.rightEdge+1,g.connection.setOffsetInBlock(a,u),g.connection.isConnected()&&(this.width=Math.max(this.width,n.rightEdge+g.connection.targetBlock().getHeightWidth().width-Blockly.BlockSvg.TAB_WIDTH+1))):c.type==Blockly.DUMMY_INPUT?(a=u,(g=c[0]).align!=Blockly.ALIGN_LEFT&&(d=n.rightEdge-g.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X,n.hasValue&&(d-=Blockly.BlockSvg.TAB_WIDTH),g.align==Blockly.ALIGN_RIGHT?s+=d:g.align==Blockly.ALIGN_CENTRE&&(s+=d/2)),this.renderFields_(g.fieldRow,s,a),e.push("v",c.height),this.RTL&&t.push("v",c.height-1)):c.type==Blockly.NEXT_STATEMENT&&(g=c[0],0==h&&(e.push("v",Blockly.BlockSvg.SEP_SPACE_Y),this.RTL&&t.push("v",Blockly.BlockSvg.SEP_SPACE_Y-1),u+=Blockly.BlockSvg.SEP_SPACE_Y),a=u,g.align!=Blockly.ALIGN_LEFT&&(d=n.statementEdge-g.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X,g.align==Blockly.ALIGN_RIGHT?s+=d:g.align==Blockly.ALIGN_CENTRE&&(s+=d/2)),this.renderFields_(g.fieldRow,s,a),s=n.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH,e.push("H",s),e.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER),e.push("v",c.height-2*Blockly.BlockSvg.CORNER_RADIUS),e.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER),e.push("H",n.rightEdge),this.RTL?(t.push("M",s-Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(u+Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),t.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL),t.push("v",c.height-2*Blockly.BlockSvg.CORNER_RADIUS),t.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL)):(t.push("M",s-Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(u+c.height-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),t.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR)),t.push("H",n.rightEdge-.5),a=this.RTL?-s:s+1,g.connection.setOffsetInBlock(a,u+1),g.connection.isConnected()&&(this.width=Math.max(this.width,n.statementEdge+g.connection.targetBlock().getHeightWidth().width)),h==n.length-1||n[h+1].type==Blockly.NEXT_STATEMENT)&&(e.push("v",Blockly.BlockSvg.SEP_SPACE_Y),this.RTL&&t.push("v",Blockly.BlockSvg.SEP_SPACE_Y-1),u+=Blockly.BlockSvg.SEP_SPACE_Y);u+=c.height}return n.length||(u=Blockly.BlockSvg.MIN_BLOCK_Y,e.push("V",u),this.RTL&&t.push("V",u-1)),u},Blockly.BlockSvg.prototype.renderDrawBottom_=function(e,t,o){this.height+=o+1,this.nextConnection&&(e.push("H",Blockly.BlockSvg.NOTCH_WIDTH+(this.RTL?.5:-.5)+" "+Blockly.BlockSvg.NOTCH_PATH_RIGHT),this.nextConnection.setOffsetInBlock(this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH,o+1),this.height+=4),this.squareBottomLeftCorner_?(e.push("H 0"),this.RTL||t.push("M","0.5,"+(o-.5))):(e.push("H",Blockly.BlockSvg.CORNER_RADIUS),e.push("a",Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+",-"+Blockly.BlockSvg.CORNER_RADIUS),this.RTL||(t.push("M",Blockly.BlockSvg.DISTANCE_45_INSIDE+","+(o-Blockly.BlockSvg.DISTANCE_45_INSIDE)),t.push("A",Blockly.BlockSvg.CORNER_RADIUS-.5+","+(Blockly.BlockSvg.CORNER_RADIUS-.5)+" 0 0,1 0.5,"+(o-Blockly.BlockSvg.CORNER_RADIUS))))},Blockly.BlockSvg.prototype.renderDrawLeft_=function(e,t){this.outputConnection?(this.outputConnection.setOffsetInBlock(0,0),e.push("V",Blockly.BlockSvg.TAB_HEIGHT),e.push("c 0,-10 -"+Blockly.BlockSvg.TAB_WIDTH+",8 -"+Blockly.BlockSvg.TAB_WIDTH+",-7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",2.5 "+Blockly.BlockSvg.TAB_WIDTH+",-7.5"),this.RTL?(t.push("M",-.25*Blockly.BlockSvg.TAB_WIDTH+",8.4"),t.push("l",-.45*Blockly.BlockSvg.TAB_WIDTH+",-2.1")):(t.push("V",Blockly.BlockSvg.TAB_HEIGHT-1.5),t.push("m",-.92*Blockly.BlockSvg.TAB_WIDTH+",-0.5 q "+-.19*Blockly.BlockSvg.TAB_WIDTH+",-5.5 0,-11"),t.push("m",.92*Blockly.BlockSvg.TAB_WIDTH+",1 V 0.5 H 1")),this.width+=Blockly.BlockSvg.TAB_WIDTH):this.RTL||(this.squareTopLeftCorner_?t.push("V",.5):t.push("V",Blockly.BlockSvg.CORNER_RADIUS)),e.push("z")},Blockly.Events={},Blockly.Events.group_="",Blockly.Events.recordUndo=!0,Blockly.Events.disabled_=0,Blockly.Events.CREATE="create",Blockly.Events.BLOCK_CREATE=Blockly.Events.CREATE,Blockly.Events.DELETE="delete",Blockly.Events.BLOCK_DELETE=Blockly.Events.DELETE,Blockly.Events.CHANGE="change",Blockly.Events.BLOCK_CHANGE=Blockly.Events.CHANGE,Blockly.Events.MOVE="move",Blockly.Events.BLOCK_MOVE=Blockly.Events.MOVE,Blockly.Events.VAR_CREATE="var_create",Blockly.Events.VAR_DELETE="var_delete",Blockly.Events.VAR_RENAME="var_rename",Blockly.Events.UI="ui",Blockly.Events.FIRE_QUEUE_=[],Blockly.Events.fire=function(e){Blockly.Events.isEnabled()&&(Blockly.Events.FIRE_QUEUE_.length||setTimeout(Blockly.Events.fireNow_,0),Blockly.Events.FIRE_QUEUE_.push(e))},Blockly.Events.fireNow_=function(){for(var e,t=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,!0),o=Blockly.Events.FIRE_QUEUE_.length=0;e=t[o];o++){var i=Blockly.Workspace.getById(e.workspaceId);i&&i.fireChangeListener(e)}},Blockly.Events.filter=function(e,t){var o=goog.array.clone(e);t||o.reverse();for(var i,n=[],r=Object.create(null),s=0;i=o[s];s++)if(!i.isNull()){var a=[i.type,i.blockId,i.workspaceId].join(" "),l=r[a];l?i.type==Blockly.Events.MOVE?(l.newParentId=i.newParentId,l.newInputName=i.newInputName,l.newCoordinate=i.newCoordinate):i.type==Blockly.Events.CHANGE&&i.element==l.element&&i.name==l.name?l.newValue=i.newValue:i.type!=Blockly.Events.UI||"click"!=i.element||"commentOpen"!=l.element&&"mutatorOpen"!=l.element&&"warningOpen"!=l.element?(r[a]=i,n.push(i)):l.newValue=i.newValue:(r[a]=i,n.push(i))}for(o=n.filter(function(e){return!e.isNull()}),t||o.reverse(),s=1;i=o[s];s++)i.type==Blockly.Events.CHANGE&&"mutation"==i.element&&o.unshift(o.splice(s,1)[0]);return o},Blockly.Events.clearPendingUndo=function(){for(var e,t=0;e=Blockly.Events.FIRE_QUEUE_[t];t++)e.recordUndo=!1},Blockly.Events.disable=function(){Blockly.Events.disabled_++},Blockly.Events.enable=function(){Blockly.Events.disabled_--},Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_},Blockly.Events.getGroup=function(){return Blockly.Events.group_},Blockly.Events.setGroup=function(e){Blockly.Events.group_="boolean"==typeof e?e?Blockly.utils.genUid():"":e},Blockly.Events.getDescendantIds_=function(e){var t=[];e=e.getDescendants();for(var o,i=0;o=e[i];i++)t[i]=o.id;return t},Blockly.Events.fromJson=function(e,t){switch(e.type){case Blockly.Events.CREATE:var o=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:o=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:o=new Blockly.Events.Change(null,"","","","");break;case Blockly.Events.MOVE:o=new Blockly.Events.Move(null);break;case Blockly.Events.VAR_CREATE:o=new Blockly.Events.VarCreate(null);break;case Blockly.Events.VAR_DELETE:o=new Blockly.Events.VarDelete(null);break;case Blockly.Events.VAR_RENAME:o=new Blockly.Events.VarRename(null,"");break;case Blockly.Events.UI:o=new Blockly.Events.Ui(null);break;default:throw"Unknown event type."}return o.fromJson(e),o.workspaceId=t.id,o},Blockly.Events.Abstract=function(e){this.recordUndo=this.group=this.workspaceId=this.varId=this.blockId=void 0,e instanceof Blockly.Block?(this.blockId=e.id,this.workspaceId=e.workspace.id):e instanceof Blockly.VariableModel&&(this.workspaceId=e.workspace.id,this.varId=e.getId()),this.group=Blockly.Events.group_,this.recordUndo=Blockly.Events.recordUndo},Blockly.Events.Abstract.prototype.toJson=function(){var e={type:this.type};return this.blockId&&(e.blockId=this.blockId),this.varId&&(e.varId=this.varId),this.group&&(e.group=this.group),e},Blockly.Events.Abstract.prototype.fromJson=function(e){this.blockId=e.blockId,this.varId=e.varId,this.group=e.group},Blockly.Events.Abstract.prototype.isNull=function(){return!1},Blockly.Events.Abstract.prototype.run=function(e){},Blockly.Events.Abstract.prototype.getEventWorkspace_=function(){var e=Blockly.Workspace.getById(this.workspaceId);if(!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e},Blockly.Events.Create=function(e){e&&(Blockly.Events.Create.superClass_.constructor.call(this,e),this.xml=e.workspace.rendered?Blockly.Xml.blockToDomWithXY(e):Blockly.Xml.blockToDom(e),this.ids=Blockly.Events.getDescendantIds_(e))},goog.inherits(Blockly.Events.Create,Blockly.Events.Abstract),Blockly.Events.BlockCreate=Blockly.Events.Create,Blockly.Events.Create.prototype.type=Blockly.Events.CREATE,Blockly.Events.Create.prototype.toJson=function(){var e=Blockly.Events.Create.superClass_.toJson.call(this);return e.xml=Blockly.Xml.domToText(this.xml),e.ids=this.ids,e},Blockly.Events.Create.prototype.fromJson=function(e){Blockly.Events.Create.superClass_.fromJson.call(this,e),this.xml=Blockly.Xml.textToDom("<xml>"+e.xml+"</xml>").firstChild,this.ids=e.ids},Blockly.Events.Create.prototype.run=function(e){var t=this.getEventWorkspace_();if(e)(e=goog.dom.createDom("xml")).appendChild(this.xml),Blockly.Xml.domToWorkspace(e,t);else{e=0;for(var o;o=this.ids[e];e++){var i=t.getBlockById(o);i?i.dispose(!1,!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},Blockly.Events.Delete=function(e){if(e){if(e.getParent())throw"Connected blocks cannot be deleted.";Blockly.Events.Delete.superClass_.constructor.call(this,e),this.oldXml=e.workspace.rendered?Blockly.Xml.blockToDomWithXY(e):Blockly.Xml.blockToDom(e),this.ids=Blockly.Events.getDescendantIds_(e)}},goog.inherits(Blockly.Events.Delete,Blockly.Events.Abstract),Blockly.Events.BlockDelete=Blockly.Events.Delete,Blockly.Events.Delete.prototype.type=Blockly.Events.DELETE,Blockly.Events.Delete.prototype.toJson=function(){var e=Blockly.Events.Delete.superClass_.toJson.call(this);return e.ids=this.ids,e},Blockly.Events.Delete.prototype.fromJson=function(e){Blockly.Events.Delete.superClass_.fromJson.call(this,e),this.ids=e.ids},Blockly.Events.Delete.prototype.run=function(e){var t=this.getEventWorkspace_();if(e){e=0;for(var o;o=this.ids[e];e++){var i=t.getBlockById(o);i?i.dispose(!1,!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(e=goog.dom.createDom("xml")).appendChild(this.oldXml),Blockly.Xml.domToWorkspace(e,t)},Blockly.Events.Change=function(e,t,o,i,n){e&&(Blockly.Events.Change.superClass_.constructor.call(this,e),this.element=t,this.name=o,this.oldValue=i,this.newValue=n)},goog.inherits(Blockly.Events.Change,Blockly.Events.Abstract),Blockly.Events.BlockChange=Blockly.Events.Change,Blockly.Events.Change.prototype.type=Blockly.Events.CHANGE,Blockly.Events.Change.prototype.toJson=function(){var e=Blockly.Events.Change.superClass_.toJson.call(this);return e.element=this.element,this.name&&(e.name=this.name),e.newValue=this.newValue,e},Blockly.Events.Change.prototype.fromJson=function(e){Blockly.Events.Change.superClass_.fromJson.call(this,e),this.element=e.element,this.name=e.name,this.newValue=e.newValue},Blockly.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue},Blockly.Events.Change.prototype.run=function(e){var t=this.getEventWorkspace_().getBlockById(this.blockId);if(t)switch(t.mutator&&t.mutator.setVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?(t.callValidator(e),t.setValue(e)):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(e);break;case"disabled":t.setDisabled(e);break;case"inline":t.setInputsInline(e);break;case"mutation":var o="";if(t.mutationToDom&&(o=(o=t.mutationToDom())&&Blockly.Xml.domToText(o)),t.domToMutation){e=e||"<mutation></mutation>";var i=Blockly.Xml.textToDom("<xml>"+e+"</xml>");t.domToMutation(i.firstChild)}Blockly.Events.fire(new Blockly.Events.Change(t,"mutation",null,o,e));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},Blockly.Events.Move=function(e){e&&(Blockly.Events.Move.superClass_.constructor.call(this,e),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)},goog.inherits(Blockly.Events.Move,Blockly.Events.Abstract),Blockly.Events.BlockMove=Blockly.Events.Move,Blockly.Events.Move.prototype.type=Blockly.Events.MOVE,Blockly.Events.Move.prototype.toJson=function(){var e=Blockly.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(e.newParentId=this.newParentId),this.newInputName&&(e.newInputName=this.newInputName),this.newCoordinate&&(e.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),e},Blockly.Events.Move.prototype.fromJson=function(e){Blockly.Events.Move.superClass_.fromJson.call(this,e),this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate&&(e=e.newCoordinate.split(","),this.newCoordinate=new goog.math.Coordinate(parseFloat(e[0]),parseFloat(e[1])))},Blockly.Events.Move.prototype.recordNew=function(){var e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate},Blockly.Events.Move.prototype.currentLocation_=function(){var e=Blockly.Workspace.getById(this.workspaceId).getBlockById(this.blockId),t={},o=e.getParent();return o?(t.parentId=o.id,(e=o.getInputWithBlock(e))&&(t.inputName=e.name)):t.coordinate=e.getRelativeToSurfaceXY(),t},Blockly.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&goog.math.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},Blockly.Events.Move.prototype.run=function(e){var t=this.getEventWorkspace_(),o=t.getBlockById(this.blockId);if(o){var i=e?this.newParentId:this.oldParentId,n=e?this.newInputName:this.oldInputName;e=e?this.newCoordinate:this.oldCoordinate;var r=null;if(i&&!(r=t.getBlockById(i)))return void console.warn("Can't connect to non-existent block: "+i);if(o.getParent()&&o.unplug(),e)n=o.getRelativeToSurfaceXY(),o.moveBy(e.x-n.x,e.y-n.y);else{if(o=o.outputConnection||o.previousConnection,n){if(t=r.getInput(n))var s=t.connection}else o.type==Blockly.PREVIOUS_STATEMENT&&(s=r.nextConnection);s?o.connect(s):console.warn("Can't connect to non-existent input: "+n)}}else console.warn("Can't move non-existent block: "+this.blockId)},Blockly.Events.Ui=function(e,t,o,i){Blockly.Events.Ui.superClass_.constructor.call(this,e),this.element=t,this.oldValue=o,this.newValue=i,this.recordUndo=!1},goog.inherits(Blockly.Events.Ui,Blockly.Events.Abstract),Blockly.Events.Ui.prototype.type=Blockly.Events.UI,Blockly.Events.Ui.prototype.toJson=function(){var e=Blockly.Events.Ui.superClass_.toJson.call(this);return e.element=this.element,void 0!==this.newValue&&(e.newValue=this.newValue),e},Blockly.Events.Ui.prototype.fromJson=function(e){Blockly.Events.Ui.superClass_.fromJson.call(this,e),this.element=e.element,this.newValue=e.newValue},Blockly.Events.VarCreate=function(e){e&&(Blockly.Events.VarCreate.superClass_.constructor.call(this,e),this.varType=e.type,this.varName=e.name)},goog.inherits(Blockly.Events.VarCreate,Blockly.Events.Abstract),Blockly.Events.VarCreate.prototype.type=Blockly.Events.VAR_CREATE,Blockly.Events.VarCreate.prototype.toJson=function(){var e=Blockly.Events.VarCreate.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},Blockly.Events.VarCreate.prototype.fromJson=function(e){Blockly.Events.VarCreate.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},Blockly.Events.VarCreate.prototype.run=function(e){var t=this.getEventWorkspace_();e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)},Blockly.Events.VarDelete=function(e){e&&(Blockly.Events.VarDelete.superClass_.constructor.call(this,e),this.varType=e.type,this.varName=e.name)},goog.inherits(Blockly.Events.VarDelete,Blockly.Events.Abstract),Blockly.Events.VarDelete.prototype.type=Blockly.Events.VAR_DELETE,Blockly.Events.VarDelete.prototype.toJson=function(){var e=Blockly.Events.VarDelete.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},Blockly.Events.VarDelete.prototype.fromJson=function(e){Blockly.Events.VarDelete.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},Blockly.Events.VarDelete.prototype.run=function(e){var t=this.getEventWorkspace_();e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)},Blockly.Events.VarRename=function(e,t){e&&(Blockly.Events.VarRename.superClass_.constructor.call(this,e),this.oldName=e.name,this.newName=t)},goog.inherits(Blockly.Events.VarRename,Blockly.Events.Abstract),Blockly.Events.VarRename.prototype.type=Blockly.Events.VAR_RENAME,Blockly.Events.VarRename.prototype.toJson=function(){var e=Blockly.Events.VarRename.superClass_.toJson.call(this);return e.oldName=this.oldName,e.newName=this.newName,e},Blockly.Events.VarRename.prototype.fromJson=function(e){Blockly.Events.VarRename.superClass_.fromJson.call(this,e),this.oldName=e.oldName,this.newName=e.newName},Blockly.Events.VarRename.prototype.run=function(e){var t=this.getEventWorkspace_();e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)},Blockly.Events.disableOrphans=function(e){if(e.type==Blockly.Events.MOVE||e.type==Blockly.Events.CREATE){var t=Blockly.Workspace.getById(e.workspaceId);if(e=t.getBlockById(e.blockId))if(e.getParent()&&!e.getParent().disabled){t=e.getDescendants(),e=0;for(var o;o=t[e];e++)o.setDisabled(!1)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setDisabled(!0),e=e.getNextBlock()}while(e)}},Blockly.Msg={},goog.getMsgOrig=goog.getMsg,goog.getMsg=function(e,t){var o=goog.getMsg.blocklyMsgMap[e];return o&&(e=Blockly.Msg[o]),goog.getMsgOrig(e,t)},goog.getMsg.blocklyMsgMap={Today:"TODAY"},Blockly.FieldTextInput=function(e,t){Blockly.FieldTextInput.superClass_.constructor.call(this,e,t)},goog.inherits(Blockly.FieldTextInput,Blockly.Field),Blockly.FieldTextInput.fromJson=function(e){var t=Blockly.utils.replaceMessageReferences(e.text);return t=new Blockly.FieldTextInput(t,e.class),"boolean"==typeof e.spellcheck&&t.setSpellcheck(e.spellcheck),t},Blockly.FieldTextInput.FONTSIZE=11,Blockly.FieldTextInput.htmlInput_=null,Blockly.FieldTextInput.prototype.CURSOR="text",Blockly.FieldTextInput.prototype.spellcheck_=!0,Blockly.FieldTextInput.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldTextInput.superClass_.dispose.call(this)},Blockly.FieldTextInput.prototype.setValue=function(e){if(null!==e){if(this.sourceBlock_){var t=this.callValidator(e);null!==t&&(e=t)}Blockly.Field.prototype.setValue.call(this,e)}},Blockly.FieldTextInput.prototype.setText=function(e){null!==e&&((e=String(e))!==this.text_&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.text_,e)),Blockly.Field.prototype.setText.call(this,e)))},Blockly.FieldTextInput.prototype.setSpellcheck=function(e){this.spellcheck_=e},Blockly.FieldTextInput.prototype.showEditor_=function(e){this.workspace_=this.sourceBlock_.workspace,!(e=e||!1)&&(goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(e)},Blockly.FieldTextInput.prototype.showPromptEditor_=function(){var e=this;Blockly.prompt(Blockly.Msg.CHANGE_VALUE_TITLE,this.text_,function(t){e.sourceBlock_&&(t=e.callValidator(t)),e.setValue(t)})},Blockly.FieldTextInput.prototype.showInlineEditor_=function(e){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_());var t=Blockly.WidgetDiv.DIV,o=goog.dom.createDom("INPUT","blocklyHtmlInput");o.setAttribute("spellcheck",this.spellcheck_);var i=Blockly.FieldTextInput.FONTSIZE*this.workspace_.scale+"pt";t.style.fontSize=i,o.style.fontSize=i,Blockly.FieldTextInput.htmlInput_=o,t.appendChild(o),o.value=o.defaultValue=this.text_,o.oldValue_=null,this.validate_(),this.resizeEditor_(),e||(o.focus(),o.select()),this.bindEvents_(o)},Blockly.FieldTextInput.prototype.bindEvents_=function(e){e.onKeyDownWrapper_=Blockly.bindEventWithChecks_(e,"keydown",this,this.onHtmlInputKeyDown_),e.onKeyUpWrapper_=Blockly.bindEventWithChecks_(e,"keyup",this,this.onHtmlInputChange_),e.onKeyPressWrapper_=Blockly.bindEventWithChecks_(e,"keypress",this,this.onHtmlInputChange_),e.onWorkspaceChangeWrapper_=this.resizeEditor_.bind(this),this.workspace_.addChangeListener(e.onWorkspaceChangeWrapper_)},Blockly.FieldTextInput.prototype.unbindEvents_=function(e){Blockly.unbindEvent_(e.onKeyDownWrapper_),Blockly.unbindEvent_(e.onKeyUpWrapper_),Blockly.unbindEvent_(e.onKeyPressWrapper_),this.workspace_.removeChangeListener(e.onWorkspaceChangeWrapper_)},Blockly.FieldTextInput.prototype.onHtmlInputKeyDown_=function(e){var t=Blockly.FieldTextInput.htmlInput_;13==e.keyCode?Blockly.WidgetDiv.hide():27==e.keyCode?(t.value=t.defaultValue,Blockly.WidgetDiv.hide()):9==e.keyCode&&(Blockly.WidgetDiv.hide(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())},Blockly.FieldTextInput.prototype.onHtmlInputChange_=function(e){var t=(e=Blockly.FieldTextInput.htmlInput_).value;t!==e.oldValue_?(e.oldValue_=t,this.setValue(t),this.validate_()):goog.userAgent.WEBKIT&&this.sourceBlock_.render(),this.resizeEditor_(),Blockly.svgResize(this.sourceBlock_.workspace)},Blockly.FieldTextInput.prototype.validate_=function(){var e=!0;goog.asserts.assertObject(Blockly.FieldTextInput.htmlInput_);var t=Blockly.FieldTextInput.htmlInput_;this.sourceBlock_&&(e=this.callValidator(t.value)),null===e?Blockly.utils.addClass(t,"blocklyInvalidInput"):Blockly.utils.removeClass(t,"blocklyInvalidInput")},Blockly.FieldTextInput.prototype.resizeEditor_=function(){var e=Blockly.WidgetDiv.DIV,t=this.getScaledBBox_();e.style.width=t.right-t.left+"px",e.style.height=t.bottom-t.top+"px",(t=new goog.math.Coordinate(this.sourceBlock_.RTL?t.right-e.offsetWidth:t.left,t.top)).y+=1,goog.userAgent.GECKO&&Blockly.WidgetDiv.DIV.style.top&&(--t.x,--t.y),goog.userAgent.WEBKIT&&(t.y-=3),e.style.left=t.x+"px",e.style.top=t.y+"px"},Blockly.FieldTextInput.prototype.widgetDispose_=function(){var e=this;return function(){var t=Blockly.FieldTextInput.htmlInput_;e.maybeSaveEdit_(),e.unbindEvents_(t),Blockly.FieldTextInput.htmlInput_=null,Blockly.Events.setGroup(!1),(t=Blockly.WidgetDiv.DIV.style).width="auto",t.height="auto",t.fontSize=""}},Blockly.FieldTextInput.prototype.maybeSaveEdit_=function(){var e=Blockly.FieldTextInput.htmlInput_,t=e.value;this.sourceBlock_&&(null===(t=this.callValidator(t))?t=e.defaultValue:this.onFinishEditing_&&this.onFinishEditing_(t)),this.setText(t),this.sourceBlock_.rendered&&this.sourceBlock_.render()},Blockly.FieldTextInput.numberValidator=function(e){return console.warn("Blockly.FieldTextInput.numberValidator is deprecated. Use Blockly.FieldNumber instead."),null===e?null:(e=(e=(e=String(e)).replace(/O/gi,"0")).replace(/,/g,""),e=parseFloat(e||0),isNaN(e)?null:String(e))},Blockly.FieldTextInput.nonnegativeIntegerValidator=function(e){return(e=Blockly.FieldTextInput.numberValidator(e))&&(e=String(Math.max(0,Math.floor(e)))),e},Blockly.FieldAngle=function(e,t){this.symbol_=Blockly.utils.createSvgElement("tspan",{},null),this.symbol_.appendChild(document.createTextNode("")),e=e&&!isNaN(e)?String(e):"0",Blockly.FieldAngle.superClass_.constructor.call(this,e,t)},goog.inherits(Blockly.FieldAngle,Blockly.FieldTextInput),Blockly.FieldAngle.fromJson=function(e){return new Blockly.FieldAngle(e.angle)},Blockly.FieldAngle.ROUND=15,Blockly.FieldAngle.HALF=50,Blockly.FieldAngle.CLOCKWISE=!1,Blockly.FieldAngle.OFFSET=0,Blockly.FieldAngle.WRAP=360,Blockly.FieldAngle.RADIUS=Blockly.FieldAngle.HALF-1,Blockly.FieldAngle.prototype.render_=function(){this.visible_?(this.textElement_.textContent=this.getDisplayText_(),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.symbol_,this.textElement_.firstChild):this.textElement_.appendChild(this.symbol_),this.updateWidth()):this.size_.width=0},Blockly.FieldAngle.prototype.dispose_=function(){var e=this;return function(){Blockly.FieldAngle.superClass_.dispose_.call(e)(),e.gauge_=null,e.clickWrapper_&&Blockly.unbindEvent_(e.clickWrapper_),e.moveWrapper1_&&Blockly.unbindEvent_(e.moveWrapper1_),e.moveWrapper2_&&Blockly.unbindEvent_(e.moveWrapper2_)}},Blockly.FieldAngle.prototype.showEditor_=function(){Blockly.FieldAngle.superClass_.showEditor_.call(this,goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD);var e=Blockly.WidgetDiv.DIV;if(e.firstChild){e=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:2*Blockly.FieldAngle.HALF+"px",width:2*Blockly.FieldAngle.HALF+"px"},e);var t=Blockly.utils.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=Blockly.utils.createSvgElement("path",{class:"blocklyAngleGauge"},e),this.line_=Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,class:"blocklyAngleLine"},e);for(var o=0;360>o;o+=15)Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-(0==o%45?10:5),y2:Blockly.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+Blockly.FieldAngle.HALF+","+Blockly.FieldAngle.HALF+")"},e);e.style.marginLeft=15-Blockly.FieldAngle.RADIUS+"px",this.clickWrapper_=Blockly.bindEvent_(e,"click",this,Blockly.WidgetDiv.hide),this.moveWrapper1_=Blockly.bindEvent_(t,"mousemove",this,this.onMouseMove),this.moveWrapper2_=Blockly.bindEvent_(this.gauge_,"mousemove",this,this.onMouseMove),this.updateGraph_()}},Blockly.FieldAngle.prototype.onMouseMove=function(e){var t=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=e.clientX-t.left-Blockly.FieldAngle.HALF;e=e.clientY-t.top-Blockly.FieldAngle.HALF,t=Math.atan(-e/o),isNaN(t)||(t=goog.math.toDegrees(t),0>o?t+=180:0<e&&(t+=360),t=Blockly.FieldAngle.CLOCKWISE?Blockly.FieldAngle.OFFSET+360-t:t-Blockly.FieldAngle.OFFSET,Blockly.FieldAngle.ROUND&&(t=Math.round(t/Blockly.FieldAngle.ROUND)*Blockly.FieldAngle.ROUND),t=this.callValidator(t),Blockly.FieldTextInput.htmlInput_.value=t,this.setValue(t),this.validate_(),this.resizeEditor_())},Blockly.FieldAngle.prototype.setText=function(e){Blockly.FieldAngle.superClass_.setText.call(this,e),this.textElement_&&(this.updateGraph_(),this.size_.width=0)},Blockly.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var e=Number(this.getText())+Blockly.FieldAngle.OFFSET,t=goog.math.toRadians(e);e=["M ",Blockly.FieldAngle.HALF,",",Blockly.FieldAngle.HALF];var o=Blockly.FieldAngle.HALF,i=Blockly.FieldAngle.HALF;if(!isNaN(t)){var n=goog.math.toRadians(Blockly.FieldAngle.OFFSET),r=Math.cos(n)*Blockly.FieldAngle.RADIUS,s=Math.sin(n)*-Blockly.FieldAngle.RADIUS;Blockly.FieldAngle.CLOCKWISE&&(t=2*n-t),o+=Math.cos(t)*Blockly.FieldAngle.RADIUS,i-=Math.sin(t)*Blockly.FieldAngle.RADIUS,t=Math.abs(Math.floor((t-n)/Math.PI)%2),Blockly.FieldAngle.CLOCKWISE&&(t=1-t),e.push(" l ",r,",",s," A ",Blockly.FieldAngle.RADIUS,",",Blockly.FieldAngle.RADIUS," 0 ",t," ",Number(Blockly.FieldAngle.CLOCKWISE)," ",o,",",i," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",i)}},Blockly.FieldAngle.prototype.classValidator=function(e){return null===e?null:(e=parseFloat(e||0),isNaN(e)?null:(0>(e%=360)&&(e+=360),e>Blockly.FieldAngle.WRAP&&(e-=360),String(e)))},Blockly.FieldCheckbox=function(e,t){Blockly.FieldCheckbox.superClass_.constructor.call(this,"",t),this.setValue(e)},goog.inherits(Blockly.FieldCheckbox,Blockly.Field),Blockly.FieldCheckbox.fromJson=function(e){return new Blockly.FieldCheckbox(e.checked?"TRUE":"FALSE")},Blockly.FieldCheckbox.CHECK_CHAR="",Blockly.FieldCheckbox.prototype.CURSOR="default",Blockly.FieldCheckbox.prototype.init=function(){if(!this.fieldGroup_){Blockly.FieldCheckbox.superClass_.init.call(this),this.checkElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyCheckbox",x:-3,y:14},this.fieldGroup_);var e=document.createTextNode(Blockly.FieldCheckbox.CHECK_CHAR);this.checkElement_.appendChild(e),this.checkElement_.style.display=this.state_?"block":"none"}},Blockly.FieldCheckbox.prototype.getValue=function(){return String(this.state_).toUpperCase()},Blockly.FieldCheckbox.prototype.setValue=function(e){e="string"==typeof e?"TRUE"==e.toUpperCase():!!e,this.state_!==e&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,e)),this.state_=e,this.checkElement_&&(this.checkElement_.style.display=e?"block":"none"))},Blockly.FieldCheckbox.prototype.showEditor_=function(){var e=!this.state_;this.sourceBlock_&&(e=this.callValidator(e)),null!==e&&this.setValue(String(e).toUpperCase())},Blockly.FieldColour=function(e,t){Blockly.FieldColour.superClass_.constructor.call(this,e,t),this.setText(Blockly.Field.NBSP+Blockly.Field.NBSP+Blockly.Field.NBSP)},goog.inherits(Blockly.FieldColour,Blockly.Field),Blockly.FieldColour.fromJson=function(e){return new Blockly.FieldColour(e.colour)},Blockly.FieldColour.prototype.colours_=null,Blockly.FieldColour.prototype.columns_=0,Blockly.FieldColour.prototype.init=function(){Blockly.FieldColour.superClass_.init.call(this),this.borderRect_.style.fillOpacity=1,this.setValue(this.getValue())},Blockly.FieldColour.prototype.CURSOR="default",Blockly.FieldColour.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldColour.superClass_.dispose.call(this)},Blockly.FieldColour.prototype.getValue=function(){return this.colour_},Blockly.FieldColour.prototype.setValue=function(e){this.sourceBlock_&&Blockly.Events.isEnabled()&&this.colour_!=e&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.colour_,e)),this.colour_=e,this.borderRect_&&(this.borderRect_.style.fill=e)},Blockly.FieldColour.prototype.getText=function(){var e=this.colour_,t=e.match(/^#(.)\1(.)\2(.)\3$/);return t&&(e="#"+t[1]+t[2]+t[3]),e},Blockly.FieldColour.COLOURS=goog.ui.ColorPicker.SIMPLE_GRID_COLORS,Blockly.FieldColour.COLUMNS=7,Blockly.FieldColour.prototype.setColours=function(e){return this.colours_=e,this},Blockly.FieldColour.prototype.setColumns=function(e){return this.columns_=e,this},Blockly.FieldColour.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,Blockly.FieldColour.widgetDispose_);var e=Blockly.utils.getViewportBBox(),t=this.getScaledBBox_(),o=this.createWidget_(),i=goog.style.getSize(o.getElement());Blockly.WidgetDiv.positionWithAnchor(e,t,i,this.sourceBlock_.RTL);var n=this;Blockly.FieldColour.changeEventKey_=goog.events.listen(o,goog.ui.ColorPicker.EventType.CHANGE,function(e){e=e.target.getSelectedColor()||"#000000",Blockly.WidgetDiv.hide(),n.sourceBlock_&&(e=n.callValidator(e)),null!==e&&n.setValue(e)})},Blockly.FieldColour.prototype.createWidget_=function(){var e=new goog.ui.ColorPicker;return e.setSize(this.columns_||Blockly.FieldColour.COLUMNS),e.setColors(this.colours_||Blockly.FieldColour.COLOURS),e.render(Blockly.WidgetDiv.DIV),e.setSelectedColor(this.getValue()),e},Blockly.FieldColour.widgetDispose_=function(){Blockly.FieldColour.changeEventKey_&&goog.events.unlistenByKey(Blockly.FieldColour.changeEventKey_),Blockly.Events.setGroup(!1)},Blockly.FieldDropdown=function(e,t){this.menuGenerator_=e,this.trimOptions_();var o=this.getOptions()[0];Blockly.FieldDropdown.superClass_.constructor.call(this,o[1],t)},goog.inherits(Blockly.FieldDropdown,Blockly.Field),Blockly.FieldDropdown.fromJson=function(e){return new Blockly.FieldDropdown(e.options)},Blockly.FieldDropdown.CHECKMARK_OVERHANG=25,Blockly.FieldDropdown.MAX_MENU_HEIGHT=300,Blockly.FieldDropdown.ARROW_CHAR=goog.userAgent.ANDROID?"":"",Blockly.FieldDropdown.prototype.CURSOR="default",Blockly.FieldDropdown.prototype.value_="",Blockly.FieldDropdown.prototype.imageElement_=null,Blockly.FieldDropdown.prototype.imageJson_=null,Blockly.FieldDropdown.prototype.init=function(){this.fieldGroup_||(this.arrow_=Blockly.utils.createSvgElement("tspan",{},null),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?Blockly.FieldDropdown.ARROW_CHAR+" ":" "+Blockly.FieldDropdown.ARROW_CHAR)),Blockly.FieldDropdown.superClass_.init.call(this))},Blockly.FieldDropdown.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,null);var e=this.createMenu_();this.addEventListeners_(e),this.positionMenu_(e)},Blockly.FieldDropdown.prototype.addEventListeners_=function(e){this.addActionListener_(e),this.addTouchStartListener_(e),this.addTouchEndListener_(e)},Blockly.FieldDropdown.prototype.addActionListener_=function(e){var t=this;goog.events.listen(e,goog.ui.Component.EventType.ACTION,function(e){(e=e.target)&&t.onItemSelected(this,e),Blockly.WidgetDiv.hideIfOwner(t),Blockly.Events.setGroup(!1)})},Blockly.FieldDropdown.prototype.addTouchStartListener_=function(e){e.getHandler().listen(e.getElement(),goog.events.EventType.TOUCHSTART,function(e){this.getOwnerControl(e.target).handleMouseDown(e)})},Blockly.FieldDropdown.prototype.addTouchEndListener_=function(e){e.getHandler().listen(e.getElement(),goog.events.EventType.TOUCHEND,function(e){this.getOwnerControl(e.target).performActionInternal(e)})},Blockly.FieldDropdown.prototype.createMenu_=function(){var e=new goog.ui.Menu;e.setRightToLeft(this.sourceBlock_.RTL);for(var t=this.getOptions(),o=0;o<t.length;o++){var i=t[o][0],n=t[o][1];if("object"==typeof i){var r=new Image(i.width,i.height);r.src=i.src,r.alt=i.alt||"",i=r}(i=new goog.ui.MenuItem(i)).setRightToLeft(this.sourceBlock_.RTL),i.setValue(n),i.setCheckable(!0),e.addChild(i,!0),i.setChecked(n==this.value_)}return e},Blockly.FieldDropdown.prototype.positionMenu_=function(e){var t=Blockly.utils.getViewportBBox(),o=this.getAnchorDimensions_();this.createWidget_(e);var i=Blockly.utils.uiMenu.getSize(e);i.height>Blockly.FieldDropdown.MAX_MENU_HEIGHT&&(i.height=Blockly.FieldDropdown.MAX_MENU_HEIGHT),this.sourceBlock_.RTL&&Blockly.utils.uiMenu.adjustBBoxesForRTL(t,o,i),Blockly.WidgetDiv.positionWithAnchor(t,o,i,this.sourceBlock_.RTL),e.getElement().focus()},Blockly.FieldDropdown.prototype.createWidget_=function(e){e.render(Blockly.WidgetDiv.DIV),Blockly.utils.addClass(e.getElement(),"blocklyDropdownMenu"),e.setAllowAutoFocus(!0)},Blockly.FieldDropdown.prototype.getAnchorDimensions_=function(){var e=this.getScaledBBox_();return this.sourceBlock_.RTL?e.right+=Blockly.FieldDropdown.CHECKMARK_OVERHANG:e.left-=Blockly.FieldDropdown.CHECKMARK_OVERHANG,e},Blockly.FieldDropdown.prototype.onItemSelected=function(e,t){var o=t.getValue();this.sourceBlock_&&(o=this.callValidator(o)),null!==o&&this.setValue(o)},Blockly.FieldDropdown.prototype.trimOptions_=function(){this.suffixField=this.prefixField=null;var e=this.menuGenerator_;if(goog.isArray(e)){for(var t=!1,o=0;o<e.length;o++){var i=e[o][0];"string"==typeof i?e[o][0]=Blockly.utils.replaceMessageReferences(i):(null!=i.alt&&(e[o][0].alt=Blockly.utils.replaceMessageReferences(i.alt)),t=!0)}if(!(t||2>e.length)){for(t=[],o=0;o<e.length;o++)t.push(e[o][0]);o=Blockly.utils.shortestStringLength(t),i=Blockly.utils.commonWordPrefix(t,o);var n=Blockly.utils.commonWordSuffix(t,o);!i&&!n||o<=i+n||(i&&(this.prefixField=t[0].substring(0,i-1)),n&&(this.suffixField=t[0].substr(1-n)),this.menuGenerator_=Blockly.FieldDropdown.applyTrim_(e,i,n))}}},Blockly.FieldDropdown.applyTrim_=function(e,t,o){for(var i=[],n=0;n<e.length;n++){var r=e[n][0],s=e[n][1];r=r.substring(t,r.length-o),i[n]=[r,s]}return i},Blockly.FieldDropdown.prototype.isOptionListDynamic=function(){return goog.isFunction(this.menuGenerator_)},Blockly.FieldDropdown.prototype.getOptions=function(){return goog.isFunction(this.menuGenerator_)?this.menuGenerator_.call(this):this.menuGenerator_},Blockly.FieldDropdown.prototype.getValue=function(){return this.value_},Blockly.FieldDropdown.prototype.setValue=function(e){if(null!==e&&e!==this.value_){this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e)),this.value_=e;for(var t=this.getOptions(),o=0;o<t.length;o++)if(t[o][1]==e)return"object"==typeof(e=t[o][0])?(this.imageJson_=e,this.text_=e.alt):(this.imageJson_=null,this.text_=e),void this.forceRerender();this.text_=e,this.forceRerender()}},Blockly.FieldDropdown.prototype.render_=function(){this.visible_?(this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.getColour()),goog.dom.removeChildren(this.textElement_),goog.dom.removeNode(this.imageElement_),this.imageElement_=null,this.imageJson_?this.renderSelectedImage_():this.renderSelectedText_(),this.borderRect_.setAttribute("height",this.size_.height-9),this.borderRect_.setAttribute("width",this.size_.width+Blockly.BlockSvg.SEP_SPACE_X)):this.size_.width=0},Blockly.FieldDropdown.prototype.renderSelectedImage_=function(){this.imageElement_=Blockly.utils.createSvgElement("image",{y:5,height:this.imageJson_.height+"px",width:this.imageJson_.width+"px"},this.fieldGroup_),this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.imageJson_.src),this.textElement_.appendChild(this.arrow_);var e=Blockly.Field.getCachedWidth(this.arrow_);this.size_.height=Number(this.imageJson_.height)+19,this.size_.width=Number(this.imageJson_.width)+e,this.sourceBlock_.RTL?(this.imageElement_.setAttribute("x",e),this.textElement_.setAttribute("x",-1)):(this.textElement_.setAttribute("text-anchor","end"),this.textElement_.setAttribute("x",this.size_.width+1))},Blockly.FieldDropdown.prototype.renderSelectedText_=function(){var e=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(e),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textElement_.firstChild):this.textElement_.appendChild(this.arrow_),this.textElement_.setAttribute("text-anchor","start"),this.textElement_.setAttribute("x",0),this.size_.height=Blockly.BlockSvg.MIN_BLOCK_Y,this.size_.width=Blockly.Field.getCachedWidth(this.textElement_)},Blockly.FieldDropdown.prototype.updateWidth=function(){if(this.imageJson_&&(goog.userAgent.IE||goog.userAgent.EDGE)){var e=Blockly.Field.getCachedWidth(this.arrow_);e=Number(this.imageJson_.width)+e+Blockly.BlockSvg.SEP_SPACE_X,this.borderRect_&&this.borderRect_.setAttribute("width",e),this.size_.width=e}else Blockly.Field.prototype.updateWidth.call(this)},Blockly.FieldDropdown.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldDropdown.superClass_.dispose.call(this)},Blockly.FieldImage=function(e,t,o,i,n){this.sourceBlock_=null,this.height_=Number(o),this.width_=Number(t),this.size_=new goog.math.Size(this.width_,this.height_+2*Blockly.BlockSvg.INLINE_PADDING_Y),this.text_=i||"",this.setValue(e),"function"==typeof n&&(this.clickHandler_=n)},goog.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.fromJson=function(e){var t=Blockly.utils.replaceMessageReferences(e.src),o=Number(Blockly.utils.replaceMessageReferences(e.width)),i=Number(Blockly.utils.replaceMessageReferences(e.height));return e=Blockly.utils.replaceMessageReferences(e.alt),new Blockly.FieldImage(t,o,i,e)},Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.imageElement_=Blockly.utils.createSvgElement("image",{height:this.height_+"px",width:this.width_+"px"},this.fieldGroup_),this.setValue(this.src_),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.setTooltip(this.sourceBlock_),Blockly.Tooltip.bindMouseEvents(this.imageElement_),this.maybeAddClickHandler_())},Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_),this.imageElement_=this.fieldGroup_=null},Blockly.FieldImage.prototype.maybeAddClickHandler_=function(){this.clickHandler_&&(this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.fieldGroup_,"mousedown",this,this.onMouseDown_))},Blockly.FieldImage.prototype.setTooltip=function(e){this.imageElement_.tooltip=e},Blockly.FieldImage.prototype.getValue=function(){return this.src_},Blockly.FieldImage.prototype.setValue=function(e){null!==e&&(this.src_=e,this.imageElement_&&this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e||""))},Blockly.FieldImage.prototype.setText=function(e){null!==e&&(this.text_=e)},Blockly.FieldImage.prototype.render_=function(){},Blockly.FieldImage.prototype.forceRerender=function(){},Blockly.FieldImage.prototype.updateWidth=function(){},Blockly.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},Blockly.FieldNumber=function(e,t,o,i,n){e=e&&!isNaN(e)?String(e):"0",Blockly.FieldNumber.superClass_.constructor.call(this,e,n),this.setConstraints(t,o,i)},goog.inherits(Blockly.FieldNumber,Blockly.FieldTextInput),Blockly.FieldNumber.fromJson=function(e){return new Blockly.FieldNumber(e.value,e.min,e.max,e.precision)},Blockly.FieldNumber.prototype.setConstraints=function(e,t,o){o=parseFloat(o),this.precision_=isNaN(o)?0:o,e=parseFloat(e),this.min_=isNaN(e)?-1/0:e,t=parseFloat(t),this.max_=isNaN(t)?1/0:t,this.setValue(this.callValidator(this.getValue()))},Blockly.FieldNumber.prototype.classValidator=function(e){return null===e?null:(e=(e=(e=String(e)).replace(/O/gi,"0")).replace(/,/g,""),e=parseFloat(e||0),isNaN(e)?null:(this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),e=goog.math.clamp(e,this.min_,this.max_),String(e)))},Blockly.FieldVariable=function(e,t,o,i){this.menuGenerator_=Blockly.FieldVariable.dropdownCreate,this.size_=new goog.math.Size(0,Blockly.BlockSvg.MIN_BLOCK_Y),this.setValidator(t),this.defaultVariableName=e||"",this.setTypes_(o,i),this.value_=null},goog.inherits(Blockly.FieldVariable,Blockly.FieldDropdown),Blockly.FieldVariable.fromJson=function(e){var t=Blockly.utils.replaceMessageReferences(e.variable);return new Blockly.FieldVariable(t,null,e.variableTypes,e.defaultType)},Blockly.FieldVariable.prototype.init=function(){this.fieldGroup_||(Blockly.FieldVariable.superClass_.init.call(this),this.initModel())},Blockly.FieldVariable.prototype.initModel=function(){if(!this.variable_){this.workspace_=this.sourceBlock_.workspace;var e=Blockly.Variables.getOrCreateVariablePackage(this.workspace_,null,this.defaultVariableName,this.defaultType_);Blockly.Events.disable();try{this.setValue(e.getId())}finally{Blockly.Events.enable()}}},Blockly.FieldVariable.dispose=function(){Blockly.FieldVariable.superClass_.dispose.call(this),this.variableMap_=this.workspace_=null},Blockly.FieldVariable.prototype.setSourceBlock=function(e){goog.asserts.assert(!e.isShadow(),"Variable fields are not allowed to exist on shadow blocks."),Blockly.FieldVariable.superClass_.setSourceBlock.call(this,e)},Blockly.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},Blockly.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},Blockly.FieldVariable.prototype.getVariable=function(){return this.variable_},Blockly.FieldVariable.prototype.setValue=function(e){var t=Blockly.Variables.getVariable(this.sourceBlock_.workspace,e);if(!t)throw Error("Variable id doesn't point to a real variable!  ID was "+e);var o=t.type;if(!this.typeIsAllowed_(o))throw Error("Variable type doesn't match this field!  Type was "+o);this.sourceBlock_&&Blockly.Events.isEnabled()&&(o=this.variable_?this.variable_.getId():null,Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,o,e))),this.variable_=t,this.value_=e,this.setText(t.name)},Blockly.FieldVariable.prototype.typeIsAllowed_=function(e){var t=this.getVariableTypes_();if(!t)return!0;for(var o=0;o<t.length;o++)if(e==t[o])return!0;return!1},Blockly.FieldVariable.prototype.getVariableTypes_=function(){var e=this.variableTypes;if(null===e&&this.sourceBlock_)return this.sourceBlock_.workspace.getVariableTypes();if(0==(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e},Blockly.FieldVariable.prototype.setTypes_=function(e,t){var o=t||"";if(null==e||void 0==e)var i=null;else{if(!Array.isArray(e))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");i=e;for(var n=!1,r=0;r<i.length;r++)i[r]==o&&(n=!0);if(!n)throw Error("Invalid default type '"+o+"' in the definition of a FieldVariable")}this.defaultType_=o,this.variableTypes=i},Blockly.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var e=[],t=this.getText(),o=null;if(this.sourceBlock_&&(o=this.sourceBlock_.workspace),o){var i=this.getVariableTypes_();e=[];for(var n=0;n<i.length;n++){var r=o.getVariablesOfType(i[n]);e=e.concat(r)}}for(e.sort(Blockly.VariableModel.compareByName),o=[],n=0;n<e.length;n++)o[n]=[e[n].name,e[n].getId()];return o.push([Blockly.Msg.RENAME_VARIABLE,Blockly.RENAME_VARIABLE_ID]),Blockly.Msg.DELETE_VARIABLE&&o.push([Blockly.Msg.DELETE_VARIABLE.replace("%1",t),Blockly.DELETE_VARIABLE_ID]),o},Blockly.FieldVariable.prototype.onItemSelected=function(e,t){var o=t.getValue();if(this.sourceBlock_&&this.sourceBlock_.workspace){var i=this.sourceBlock_.workspace;if(o==Blockly.RENAME_VARIABLE_ID)return void Blockly.Variables.renameVariable(i,this.variable_);if(o==Blockly.DELETE_VARIABLE_ID)return void i.deleteVariableById(this.variable_.getId())}this.setValue(o)},Blockly.Generator=function(e){this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},Blockly.Generator.NAME_TYPE="generated_function",Blockly.Generator.prototype.INFINITE_LOOP_TRAP=null,Blockly.Generator.prototype.STATEMENT_PREFIX=null,Blockly.Generator.prototype.INDENT="  ",Blockly.Generator.prototype.COMMENT_WRAP=60,Blockly.Generator.prototype.ORDER_OVERRIDES=[],Blockly.Generator.prototype.workspaceToCode=function(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=Blockly.getMainWorkspace());var t=[];this.init(e),e=e.getTopBlocks(!0);for(var o,i=0;o=e[i];i++){var n=this.blockToCode(o);goog.isArray(n)&&(n=n[0]),n&&(o.outputConnection&&(n=this.scrubNakedValue(n)),t.push(n))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},Blockly.Generator.prototype.prefixLines=function(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)},Blockly.Generator.prototype.allNestedComments=function(e){var t=[];e=e.getDescendants();for(var o=0;o<e.length;o++){var i=e[o].getCommentText();i&&t.push(i)}return t.length&&t.push(""),t.join("\n")},Blockly.Generator.prototype.blockToCode=function(e){if(!e)return"";if(e.disabled)return this.blockToCode(e.getNextBlock());var t=this[e.type];if(goog.asserts.assertFunction(t,'Language "%s" does not know how to generate code for block type "%s".',this.name_,e.type),t=t.call(e,e),goog.isArray(t))return goog.asserts.assert(e.outputConnection,'Expecting string from statement block "%s".',e.type),[this.scrub_(e,t[0]),t[1]];if(goog.isString(t)){var o=e.id.replace(/\$/g,"$$$$");return this.STATEMENT_PREFIX&&(t=this.STATEMENT_PREFIX.replace(/%1/g,"'"+o+"'")+t),this.scrub_(e,t)}if(null===t)return"";goog.asserts.fail("Invalid code generated: %s",t)},Blockly.Generator.prototype.valueToCode=function(e,t,o){isNaN(o)&&goog.asserts.fail('Expecting valid order from block "%s".',e.type);var i=e.getInputTargetBlock(t);if(!i)return"";if(""===(t=this.blockToCode(i)))return"";if(goog.asserts.assertArray(t,'Expecting tuple from value block "%s".',i.type),e=t[0],t=t[1],isNaN(t)&&goog.asserts.fail('Expecting valid order from value block "%s".',i.type),!e)return"";i=!1;var n=Math.floor(o),r=Math.floor(t);if(n<=r&&(n!=r||0!=n&&99!=n))for(i=!0,n=0;n<this.ORDER_OVERRIDES.length;n++)if(this.ORDER_OVERRIDES[n][0]==o&&this.ORDER_OVERRIDES[n][1]==t){i=!1;break}return i&&(e="("+e+")"),e},Blockly.Generator.prototype.statementToCode=function(e,t){var o=e.getInputTargetBlock(t),i=this.blockToCode(o);return goog.asserts.assertString(i,'Expecting code from statement block "%s".',o&&o.type),i&&(i=this.prefixLines(i,this.INDENT)),i},Blockly.Generator.prototype.addLoopTrap=function(e,t){return t=t.replace(/\$/g,"$$$$"),this.INFINITE_LOOP_TRAP&&(e=this.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+t+"'")+e),this.STATEMENT_PREFIX&&(e+=this.prefixLines(this.STATEMENT_PREFIX.replace(/%1/g,"'"+t+"'"),this.INDENT)),e},Blockly.Generator.prototype.RESERVED_WORDS_="",Blockly.Generator.prototype.addReservedWords=function(e){this.RESERVED_WORDS_+=e+","},Blockly.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Blockly.Generator.prototype.provideFunction_=function(e,t){if(!this.definitions_[e]){var o,i=this.variableDB_.getDistinctName(e,Blockly.Procedures.NAME_TYPE);for(this.functionNames_[e]=i,i=t.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);o!=i;)o=i,i=i.replace(/^(( {2})*) {2}/gm,"$1\0");i=i.replace(/\0/g,this.INDENT),this.definitions_[e]=i}return this.functionNames_[e]},Blockly.Generator.prototype.init=function(e){},Blockly.Generator.prototype.scrub_=function(e,t){return t},Blockly.Generator.prototype.finish=function(e){return e},Blockly.Generator.prototype.scrubNakedValue=function(e){return e},Blockly.Names=function(e,t){if(this.variablePrefix_=t||"",this.reservedDict_=Object.create(null),e)for(var o=e.split(","),i=0;i<o.length;i++)this.reservedDict_[o[i]]=!0;this.reset()},Blockly.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",Blockly.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},Blockly.Names.prototype.setVariableMap=function(e){this.variableMap_=e},Blockly.Names.prototype.getNameForUserVariable_=function(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.log("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the folowing code in your generator's init() function:\nBlockly.YourGeneratorName.variableDB_.setVariableMap(workspace.getVariableMap());"),null)},Blockly.Names.prototype.getName=function(e,t){if(t==Blockly.Variables.NAME_TYPE){var o=this.getNameForUserVariable_(e);o&&(e=o)}o=e.toLowerCase()+"_"+t;var i=t==Blockly.Variables.NAME_TYPE||t==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";if(o in this.db_)return i+this.db_[o];var n=this.getDistinctName(e,t);return this.db_[o]=n.substr(i.length),n},Blockly.Names.prototype.getDistinctName=function(e,t){for(var o=this.safeName_(e),i="";this.dbReverse_[o+i]||o+i in this.reservedDict_;)i=i?i+1:2;return o+=i,this.dbReverse_[o]=!0,(t==Blockly.Variables.NAME_TYPE||t==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+o},Blockly.Names.prototype.safeName_=function(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(e[0])&&(e="my_"+e)):e="unnamed",e},Blockly.Names.equals=function(e,t){return e.toLowerCase()==t.toLowerCase()},Blockly.Procedures={},Blockly.Procedures.NAME_TYPE=Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.allProcedures=function(e){e=e.getAllBlocks();for(var t=[],o=[],i=0;i<e.length;i++)if(e[i].getProcedureDef){var n=e[i].getProcedureDef();n&&(n[2]?t.push(n):o.push(n))}return o.sort(Blockly.Procedures.procTupleComparator_),t.sort(Blockly.Procedures.procTupleComparator_),[o,t]},Blockly.Procedures.procTupleComparator_=function(e,t){return e[0].toLowerCase().localeCompare(t[0].toLowerCase())},Blockly.Procedures.findLegalName=function(e,t){if(t.isInFlyout)return e;for(;!Blockly.Procedures.isLegalName_(e,t.workspace,t);){var o=e.match(/^(.*?)(\d+)$/);e=o?o[1]+(parseInt(o[2],10)+1):e+"2"}return e},Blockly.Procedures.isLegalName_=function(e,t,o){return!Blockly.Procedures.isNameUsed(e,t,o)},Blockly.Procedures.isNameUsed=function(e,t,o){t=t.getAllBlocks();for(var i=0;i<t.length;i++)if(t[i]!=o&&t[i].getProcedureDef){var n=t[i].getProcedureDef();if(Blockly.Names.equals(n[0],e))return!0}return!1},Blockly.Procedures.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var t=Blockly.Procedures.findLegalName(e,this.sourceBlock_),o=this.text_;if(o!=e&&o!=t){e=this.sourceBlock_.workspace.getAllBlocks();for(var i=0;i<e.length;i++)e[i].renameProcedure&&e[i].renameProcedure(o,t)}return t},Blockly.Procedures.flyoutCategory=function(e){function t(e,t){for(var i=0;i<e.length;i++){var n=e[i][0],r=e[i][1],s=goog.dom.createDom("block");s.setAttribute("type",t),s.setAttribute("gap",16);var a=goog.dom.createDom("mutation");for(a.setAttribute("name",n),s.appendChild(a),n=0;n<r.length;n++){var l=goog.dom.createDom("arg");l.setAttribute("name",r[n]),a.appendChild(l)}o.push(s)}}var o=[];if(Blockly.Blocks.procedures_defnoreturn){var i=goog.dom.createDom("block");i.setAttribute("type","procedures_defnoreturn"),i.setAttribute("gap",16);var n=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE);n.setAttribute("name","NAME"),i.appendChild(n),o.push(i)}return Blockly.Blocks.procedures_defreturn&&((i=goog.dom.createDom("block")).setAttribute("type","procedures_defreturn"),i.setAttribute("gap",16),(n=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE)).setAttribute("name","NAME"),i.appendChild(n),o.push(i)),Blockly.Blocks.procedures_ifreturn&&((i=goog.dom.createDom("block")).setAttribute("type","procedures_ifreturn"),i.setAttribute("gap",16),o.push(i)),o.length&&o[o.length-1].setAttribute("gap",24),t((e=Blockly.Procedures.allProcedures(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),o},Blockly.Procedures.getCallers=function(e,t){for(var o=[],i=t.getAllBlocks(),n=0;n<i.length;n++)if(i[n].getProcedureCall){var r=i[n].getProcedureCall();r&&Blockly.Names.equals(r,e)&&o.push(i[n])}return o},Blockly.Procedures.mutateCallers=function(e){var t,o=Blockly.Events.recordUndo,i=e.getProcedureDef()[0],n=e.mutationToDom(!0);for(e=Blockly.Procedures.getCallers(i,e.workspace),i=0;t=e[i];i++){var r=t.mutationToDom();r=r&&Blockly.Xml.domToText(r),t.domToMutation(n);var s=t.mutationToDom();r!=(s=s&&Blockly.Xml.domToText(s))&&(Blockly.Events.recordUndo=!1,Blockly.Events.fire(new Blockly.Events.BlockChange(t,"mutation",null,r,s)),Blockly.Events.recordUndo=o)}},Blockly.Procedures.getDefinition=function(e,t){for(var o=t.getTopBlocks(!1),i=0;i<o.length;i++)if(o[i].getProcedureDef){var n=o[i].getProcedureDef();if(n&&Blockly.Names.equals(n[0],e))return o[i]}return null},Blockly.FlyoutButton=function(e,t,o,i){this.workspace_=e,this.targetWorkspace_=t,this.text_=o.getAttribute("text"),this.position_=new goog.math.Coordinate(0,0),this.isLabel_=i,this.callback_=null,e=o.getAttribute("callbackKey"),this.isLabel_&&e?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||e&&t.getButtonCallback(e)?this.callback_=t.getButtonCallback(e):console.warn("Buttons should have callbacks. Button text: "+this.text_),this.cssClass_=o.getAttribute("web-class")||null},Blockly.FlyoutButton.MARGIN=5,Blockly.FlyoutButton.prototype.width=0,Blockly.FlyoutButton.prototype.height=0,Blockly.FlyoutButton.prototype.onMouseUpWrapper_=null,Blockly.FlyoutButton.prototype.createDom=function(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=Blockly.utils.createSvgElement("g",{class:e},this.workspace_.getCanvas()),!this.isLabel_)var t=Blockly.utils.createSvgElement("rect",{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);e=Blockly.utils.createSvgElement("rect",{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=Blockly.utils.createSvgElement("text",{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);return o.textContent=this.text_,this.width=Blockly.Field.getCachedWidth(o),this.height=20,this.isLabel_||(this.width+=2*Blockly.FlyoutButton.MARGIN,t.setAttribute("width",this.width),t.setAttribute("height",this.height)),e.setAttribute("width",this.width),e.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height-Blockly.FlyoutButton.MARGIN),this.updateTransform_(),this.mouseUpWrapper_=Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},Blockly.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},Blockly.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},Blockly.FlyoutButton.prototype.moveTo=function(e,t){this.position_.x=e,this.position_.y=t,this.updateTransform_()},Blockly.FlyoutButton.prototype.getPosition=function(){return this.position_},Blockly.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},Blockly.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&Blockly.unbindEvent_(this.onMouseUpWrapper_),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace_=this.workspace_=null},Blockly.FlyoutButton.prototype.onMouseUp_=function(e){(e=this.targetWorkspace_.getGesture(e))&&e.cancel(),this.callback_&&this.callback_(this)},Blockly.Flyout=function(e){e.getMetrics=this.getMetrics_.bind(this),e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Blockly.WorkspaceSvg(e),this.workspace_.isFlyout=!0,this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[]},Blockly.Flyout.prototype.autoClose=!0,Blockly.Flyout.prototype.isVisible_=!1,Blockly.Flyout.prototype.containerVisible_=!0,Blockly.Flyout.prototype.CORNER_RADIUS=8,Blockly.Flyout.prototype.MARGIN=Blockly.Flyout.prototype.CORNER_RADIUS,Blockly.Flyout.prototype.GAP_X=3*Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.GAP_Y=3*Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.SCROLLBAR_PADDING=2,Blockly.Flyout.prototype.width_=0,Blockly.Flyout.prototype.height_=0,Blockly.Flyout.prototype.dragAngleRange_=70,Blockly.Flyout.prototype.createDom=function(e){return this.svgGroup_=Blockly.utils.createSvgElement(e,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=Blockly.utils.createSvgElement("path",{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_},Blockly.Flyout.prototype.init=function(e){this.targetWorkspace_=e,this.workspace_.targetWorkspace=e,this.scrollbar_=new Blockly.Scrollbar(this.workspace_,this.horizontalLayout_,!1,"blocklyFlyoutScrollbar"),this.hide(),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace_.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace_.getGesture.bind(this.targetWorkspace_),this.workspace_.variableMap_=this.targetWorkspace_.getVariableMap(),this.workspace_.createPotentialVariableMap()},Blockly.Flyout.prototype.dispose=function(){this.hide(),Blockly.unbindEvent_(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace_.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.scrollbar_&&(this.scrollbar_.dispose(),this.scrollbar_=null),this.workspace_&&(this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace_=this.svgBackground_=null},Blockly.Flyout.prototype.getWidth=function(){return this.width_},Blockly.Flyout.prototype.getHeight=function(){return this.height_},Blockly.Flyout.prototype.getWorkspace=function(){return this.workspace_},Blockly.Flyout.prototype.isVisible=function(){return this.isVisible_},Blockly.Flyout.prototype.setVisible=function(e){var t=e!=this.isVisible();this.isVisible_=e,t&&this.updateDisplay_()},Blockly.Flyout.prototype.setContainerVisible=function(e){var t=e!=this.containerVisible_;this.containerVisible_=e,t&&this.updateDisplay_()},Blockly.Flyout.prototype.updateDisplay_=function(){var e=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=e?"block":"none",this.scrollbar_.setContainerVisible(e)},Blockly.Flyout.prototype.positionAt_=function(e,t,o,i){this.svgGroup_.setAttribute("width",e),this.svgGroup_.setAttribute("height",t),Blockly.utils.setCssTransform(this.svgGroup_,"translate("+o+"px,"+i+"px)"),this.scrollbar_&&(this.scrollbar_.setOrigin(o,i),this.scrollbar_.resize())},Blockly.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var e,t=0;e=this.listeners_[t];t++)Blockly.unbindEvent_(e);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},Blockly.Flyout.prototype.show=function(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof e&&(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),goog.asserts.assert(goog.isFunction(e),"Couldn't find a callback function when opening a toolbox category."),e=e(this.workspace_.targetWorkspace),goog.asserts.assert(goog.isArray(e),"The result of a toolbox category callback must be an array.")),this.setVisible(!0);for(var t,o=[],i=[],n=this.permanentlyDisabled_.length=0;t=e[n];n++)if(t.tagName){var r=t.tagName.toUpperCase(),s=this.horizontalLayout_?this.GAP_X:this.GAP_Y;"BLOCK"==r?((r=Blockly.Xml.domToBlock(t,this.workspace_)).disabled&&this.permanentlyDisabled_.push(r),o.push({type:"block",block:r}),t=parseInt(t.getAttribute("gap"),10),i.push(isNaN(t)?s:t)):"SEP"==t.tagName.toUpperCase()?(t=parseInt(t.getAttribute("gap"),10),!isNaN(t)&&0<i.length?i[i.length-1]=t:i.push(s)):"BUTTON"!=r&&"LABEL"!=r||(t=new Blockly.FlyoutButton(this.workspace_,this.targetWorkspace_,t,"LABEL"==r),o.push({type:"button",button:t}),i.push(s))}this.layout_(o,i),this.listeners_.push(Blockly.bindEventWithChecks_(this.svgBackground_,"mouseover",this,function(){for(var e,t=this.workspace_.getTopBlocks(!1),o=0;e=t[o];o++)e.removeSelect()})),this.horizontalLayout_?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.clearOldBlocks_=function(){for(var e,t=this.workspace_.getTopBlocks(!1),o=0;e=t[o];o++)e.workspace==this.workspace_&&e.dispose(!1,!1);for(o=0;o<this.mats_.length;o++)(t=this.mats_[o])&&goog.dom.removeNode(t);for(o=this.mats_.length=0;t=this.buttons_[o];o++)t.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},Blockly.Flyout.prototype.addBlockListeners_=function(e,t,o){this.listeners_.push(Blockly.bindEventWithChecks_(e,"mousedown",null,this.blockMouseDown_(t))),this.listeners_.push(Blockly.bindEventWithChecks_(o,"mousedown",null,this.blockMouseDown_(t))),this.listeners_.push(Blockly.bindEvent_(e,"mouseover",t,t.addSelect)),this.listeners_.push(Blockly.bindEvent_(e,"mouseout",t,t.removeSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseover",t,t.addSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseout",t,t.removeSelect))},Blockly.Flyout.prototype.blockMouseDown_=function(e){var t=this;return function(o){var i=t.targetWorkspace_.getGesture(o);i&&(i.setStartBlock(e),i.handleFlyoutStart(o,t))}},Blockly.Flyout.prototype.onMouseDown_=function(e){var t=this.targetWorkspace_.getGesture(e);t&&t.handleFlyoutStart(e,this)},Blockly.Flyout.prototype.createBlock=function(e){var t=null;Blockly.Events.disable();var o=this.targetWorkspace_.getAllVariables();this.targetWorkspace_.setResizesEnabled(!1);try{t=this.placeNewBlock_(e),Blockly.hideChaff()}finally{Blockly.Events.enable()}if(e=Blockly.Variables.getAddedVariables(this.targetWorkspace_,o),Blockly.Events.isEnabled())for(Blockly.Events.setGroup(!0),Blockly.Events.fire(new Blockly.Events.Create(t)),o=0;o<e.length;o++)Blockly.Events.fire(new Blockly.Events.VarCreate(e[o]));return this.autoClose?this.hide():this.filterForCapacity_(),t},Blockly.Flyout.prototype.initFlyoutButton_=function(e,t,o){var i=e.createDom();e.moveTo(t,o),e.show(),this.listeners_.push(Blockly.bindEventWithChecks_(i,"mousedown",this,this.onMouseDown_)),this.buttons_.push(e)},Blockly.Flyout.prototype.createRect_=function(e,t,o,i,n){return(t=Blockly.utils.createSvgElement("rect",{"fill-opacity":0,x:t,y:o,height:i.height,width:i.width},null)).tooltip=e,Blockly.Tooltip.bindMouseEvents(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),e.flyoutRect_=t,this.mats_[n]=t},Blockly.Flyout.prototype.moveRectToBlock_=function(e,t){var o=t.getHeightWidth();e.setAttribute("width",o.width),e.setAttribute("height",o.height);var i=t.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0;i&&t.moveBy(0,i),i=t.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0;var n=t.getRelativeToSurfaceXY();e.setAttribute("y",n.y),e.setAttribute("x",this.RTL?n.x-o.width+i:n.x-i)},Blockly.Flyout.prototype.filterForCapacity_=function(){for(var e,t=this.targetWorkspace_.remainingCapacity(),o=this.workspace_.getTopBlocks(!1),i=0;e=o[i];i++)if(-1==this.permanentlyDisabled_.indexOf(e)){var n=e.getDescendants();e.setDisabled(n.length>t)}},Blockly.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.isScrollable=function(){return!!this.scrollbar_&&this.scrollbar_.isVisible()},Blockly.Flyout.prototype.placeNewBlock_=function(e){var t=this.targetWorkspace_;if(!e.getSvgRoot())throw"oldBlock is not rendered.";var o=Blockly.Xml.blockToDom(e);if(t.setResizesEnabled(!1),!(o=Blockly.Xml.domToBlock(o,t)).getSvgRoot())throw"block is not rendered.";var i=t.getOriginOffsetInPixels(),n=this.workspace_.getOriginOffsetInPixels();return e=e.getRelativeToSurfaceXY().scale(this.workspace_.scale),e=goog.math.Coordinate.sum(n,e),t=goog.math.Coordinate.difference(e,i).scale(1/t.scale),o.moveBy(t.x,t.y),o},Blockly.HorizontalFlyout=function(e){e.getMetrics=this.getMetrics_.bind(this),e.setMetrics=this.setMetrics_.bind(this),Blockly.HorizontalFlyout.superClass_.constructor.call(this,e),this.horizontalLayout_=!0},goog.inherits(Blockly.HorizontalFlyout,Blockly.Flyout),Blockly.HorizontalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}var t=this.SCROLLBAR_PADDING,o=this.SCROLLBAR_PADDING;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(t=0);var i=this.height_;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP&&(i-=this.SCROLLBAR_PADDING),{viewHeight:i,viewWidth:this.width_-2*this.SCROLLBAR_PADDING,contentHeight:(e.height+2*this.MARGIN)*this.workspace_.scale,contentWidth:(e.width+2*this.MARGIN)*this.workspace_.scale,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,contentTop:e.y,contentLeft:e.x,absoluteTop:t,absoluteLeft:o}},Blockly.HorizontalFlyout.prototype.setMetrics_=function(e){var t=this.getMetrics_();t&&(goog.isNumber(e.x)&&(this.workspace_.scrollX=-t.contentWidth*e.x),this.workspace_.translate(this.workspace_.scrollX+t.absoluteLeft,this.workspace_.scrollY+t.absoluteTop))},Blockly.HorizontalFlyout.prototype.position=function(){if(this.isVisible()){var e=this.targetWorkspace_.getMetrics();if(e){this.width_=e.viewWidth,this.setBackgroundPath_(e.viewWidth-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS);var t=e.absoluteLeft,o=e.absoluteTop;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(o+=e.viewHeight-this.height_),this.positionAt_(this.width_,this.height_,t,o)}}},Blockly.HorizontalFlyout.prototype.setBackgroundPath_=function(e,t){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP,i=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(i.push("h",e+2*this.CORNER_RADIUS),i.push("v",t),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",-1*e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),i.push("h",e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",t),i.push("h",-e-2*this.CORNER_RADIUS)),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))},Blockly.HorizontalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(this.RTL?1/0:0)},Blockly.HorizontalFlyout.prototype.wheel_=function(e){var t=e.deltaX;if(t){goog.userAgent.GECKO&&1===e.deltaMode&&(t*=10);var o=this.getMetrics_();t=o.viewLeft+t,t=Math.min(t,o.contentWidth-o.viewWidth),t=Math.max(t,0),this.scrollbar_.set(t),Blockly.WidgetDiv.hide()}e.preventDefault(),e.stopPropagation()},Blockly.HorizontalFlyout.prototype.layout_=function(e,t){this.workspace_.scale=this.targetWorkspace_.scale;var o=this.MARGIN,i=this.RTL?o:o+Blockly.BlockSvg.TAB_WIDTH;this.RTL&&(e=e.reverse());for(var n,r=0;n=e[r];r++)if("block"==n.type){for(var s,a=(n=n.block).getDescendants(),l=0;s=a[l];l++)s.isInFlyout=!0;n.render(),a=n.getSvgRoot(),l=n.getHeightWidth(),s=n.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,s=this.RTL?i+l.width:i+s,n.moveBy(s,o),s=this.createRect_(n,s,o,l,r),i+=l.width+t[r],this.addBlockListeners_(a,n,s)}else"button"==n.type&&(this.initFlyoutButton_(n.button,i,o),i+=n.button.width+t[r])},Blockly.HorizontalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;if(this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP){if(e<90+t&&e>90-t)return!0}else if(e>-90-t&&e<-90+t)return!0;return!1},Blockly.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect(),t=e.top;return e=e.height,this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-1e9,t-1e9,2e9,1e9+e):this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM?new goog.math.Rect(-1e9,t,2e9,1e9+e):void 0},Blockly.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace_.scale;for(var e,t=0,o=this.workspace_.getTopBlocks(!1),i=0;e=o[i];i++)t=Math.max(t,e.getHeightWidth().height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=Blockly.Scrollbar.scrollbarThickness,this.height_!=t){for(i=0;e=o[i];i++)e.flyoutRect_&&this.moveRectToBlock_(e.flyoutRect_,e);this.height_=t,this.targetWorkspace_.resize()}},Blockly.VerticalFlyout=function(e){e.getMetrics=this.getMetrics_.bind(this),e.setMetrics=this.setMetrics_.bind(this),Blockly.VerticalFlyout.superClass_.constructor.call(this,e),this.horizontalLayout_=!1},goog.inherits(Blockly.VerticalFlyout,Blockly.Flyout),Blockly.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}var t=this.SCROLLBAR_PADDING,o=this.height_-2*this.SCROLLBAR_PADDING,i=this.width_;return this.RTL||(i-=this.SCROLLBAR_PADDING),{viewHeight:o,viewWidth:i,contentHeight:e.height*this.workspace_.scale+2*this.MARGIN,contentWidth:e.width*this.workspace_.scale+2*this.MARGIN,viewTop:-this.workspace_.scrollY+e.y,viewLeft:-this.workspace_.scrollX,contentTop:e.y,contentLeft:e.x,absoluteTop:t,absoluteLeft:0}},Blockly.VerticalFlyout.prototype.setMetrics_=function(e){var t=this.getMetrics_();t&&(goog.isNumber(e.y)&&(this.workspace_.scrollY=-t.contentHeight*e.y),this.workspace_.translate(this.workspace_.scrollX+t.absoluteLeft,this.workspace_.scrollY+t.absoluteTop))},Blockly.VerticalFlyout.prototype.position=function(){if(this.isVisible()){var e=this.targetWorkspace_.getMetrics();if(e){this.height_=e.viewHeight,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.viewHeight-2*this.CORNER_RADIUS);var t=e.absoluteTop,o=e.absoluteLeft;this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT&&(o+=e.viewWidth-this.width_),this.positionAt_(this.width_,this.height_,o,t)}}},Blockly.VerticalFlyout.prototype.setBackgroundPath_=function(e,t){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT,i=e+this.CORNER_RADIUS;(i=["M "+(o?i:0)+",0"]).push("h",o?-e:e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",Math.max(0,t)),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",o?e:-e),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))},Blockly.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(0)},Blockly.VerticalFlyout.prototype.wheel_=function(e){var t=e.deltaY;if(t){goog.userAgent.GECKO&&(t*=10);var o=this.getMetrics_();t=o.viewTop-o.contentTop+t,t=Math.min(t,o.contentHeight-o.viewHeight),t=Math.max(t,0),this.scrollbar_.set(t),Blockly.WidgetDiv.hide()}e.preventDefault(),e.stopPropagation()},Blockly.VerticalFlyout.prototype.layout_=function(e,t){this.workspace_.scale=this.targetWorkspace_.scale;for(var o,i=this.MARGIN,n=this.RTL?i:i+Blockly.BlockSvg.TAB_WIDTH,r=0;o=e[r];r++)if("block"==o.type){for(var s,a=(o=o.block).getDescendants(),l=0;s=a[l];l++)s.isInFlyout=!0;o.render(),a=o.getSvgRoot(),l=o.getHeightWidth(),o.moveBy(n,i),s=this.createRect_(o,this.RTL?n-l.width:n,i,l,r),this.addBlockListeners_(a,o,s),i+=l.height+t[r]}else"button"==o.type&&(this.initFlyoutButton_(o.button,n,i),i+=o.button.height+t[r])},Blockly.VerticalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;if(this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT){if(e<t&&e>-t)return!0}else if(e<-180+t||e>180-t)return!0;return!1},Blockly.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect(),t=e.left;return e=e.width,this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(t-1e9,-1e9,1e9+e,2e9):new goog.math.Rect(t,-1e9,1e9+e,2e9)},Blockly.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace_.scale;for(var e,t=0,o=this.workspace_.getTopBlocks(!1),i=0;e=o[i];i++){var n=e.getHeightWidth().width;e.outputConnection&&(n-=Blockly.BlockSvg.TAB_WIDTH),t=Math.max(t,n)}for(i=0;e=this.buttons_[i];i++)t=Math.max(t,e.width);if(t+=1.5*this.MARGIN+Blockly.BlockSvg.TAB_WIDTH,t*=this.workspace_.scale,t+=Blockly.Scrollbar.scrollbarThickness,this.width_!=t){for(i=0;e=o[i];i++)this.RTL&&(n=e.getRelativeToSurfaceXY().x,e.moveBy(t/this.workspace_.scale-this.MARGIN-Blockly.BlockSvg.TAB_WIDTH-n,0)),e.flyoutRect_&&this.moveRectToBlock_(e.flyoutRect_,e);if(this.RTL)for(i=0;e=this.buttons_[i];i++)o=e.getPosition().y,e.moveTo(t/this.workspace_.scale-e.width-this.MARGIN-Blockly.BlockSvg.TAB_WIDTH,o);this.width_=t,this.targetWorkspace_.resize()}},Blockly.Toolbox=function(e){this.workspace_=e,this.RTL=e.options.RTL,this.horizontalLayout_=e.options.horizontalLayout,this.toolboxPosition=e.options.toolboxPosition,this.config_={indentWidth:19,cssRoot:"blocklyTreeRoot",cssHideRoot:"blocklyHidden",cssItem:"",cssTreeRow:"blocklyTreeRow",cssItemLabel:"blocklyTreeLabel",cssTreeIcon:"blocklyTreeIcon",cssExpandedFolderIcon:"blocklyTreeIconOpen",cssFileIcon:"blocklyTreeIconNone",cssSelectedRow:"blocklyTreeSelected"},this.treeSeparatorConfig_={cssTreeRow:"blocklyTreeSeparator"},this.horizontalLayout_&&(this.config_.cssTreeRow+=e.RTL?" blocklyHorizontalTreeRtl":" blocklyHorizontalTree",this.treeSeparatorConfig_.cssTreeRow="blocklyTreeSeparatorHorizontal "+(e.RTL?"blocklyHorizontalTreeRtl":"blocklyHorizontalTree"),this.config_.cssTreeIcon="")},Blockly.Toolbox.prototype.width=0,Blockly.Toolbox.prototype.height=0,Blockly.Toolbox.prototype.selectedOption_=null,Blockly.Toolbox.prototype.lastCategory_=null,Blockly.Toolbox.prototype.init=function(){var e=this.workspace_,t=this.workspace_.getParentSvg();this.HtmlDiv=goog.dom.createDom("DIV","blocklyToolboxDiv"),this.HtmlDiv.setAttribute("dir",e.RTL?"RTL":"LTR"),t.parentNode.insertBefore(this.HtmlDiv,t),Blockly.bindEventWithChecks_(this.HtmlDiv,"mousedown",this,function(e){Blockly.utils.isRightButton(e)||e.target==this.HtmlDiv?Blockly.hideChaff(!1):Blockly.hideChaff(!0),Blockly.Touch.clearTouchIdentifier()},!1,!0),t={disabledPatternId:e.options.disabledPatternId,parentWorkspace:e,RTL:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,toolboxPosition:e.options.toolboxPosition},this.flyout_=null,this.flyout_=e.horizontalLayout?new Blockly.HorizontalFlyout(t):new Blockly.VerticalFlyout(t),goog.dom.insertSiblingAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg()),this.flyout_.init(e),this.config_.cleardotPath=e.options.pathToMedia+"1x1.gif",this.config_.cssCollapsedFolderIcon="blocklyTreeIconClosed"+(e.RTL?"Rtl":"Ltr"),this.tree_=t=new Blockly.Toolbox.TreeControl(this,this.config_),t.setShowRootNode(!1),t.setShowLines(!1),t.setShowExpandIcons(!1),t.setSelectedItem(null),e=this.populate_(e.options.languageTree),t.render(this.HtmlDiv),e&&t.setSelectedItem(e),this.addColour_(),this.position()},Blockly.Toolbox.prototype.dispose=function(){this.flyout_.dispose(),this.tree_.dispose(),goog.dom.removeNode(this.HtmlDiv),this.lastCategory_=this.workspace_=null},Blockly.Toolbox.prototype.getWidth=function(){return this.width},Blockly.Toolbox.prototype.getHeight=function(){return this.height},Blockly.Toolbox.prototype.position=function(){var e=this.HtmlDiv;if(e){var t=this.workspace_.getParentSvg();t=Blockly.svgSize(t),this.horizontalLayout_?(e.style.left="0",e.style.height="auto",e.style.width=t.width+"px",this.height=e.offsetHeight,this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?e.style.top="0":e.style.bottom="0"):(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?e.style.right="0":e.style.left="0",e.style.height=t.height+"px",this.width=e.offsetWidth),this.flyout_.position()}},Blockly.Toolbox.prototype.populate_=function(e){if(this.tree_.removeChildren(),this.tree_.blocks=[],this.hasColours_=!1,e=this.syncTrees_(e,this.tree_,this.workspace_.options.pathToMedia),this.tree_.blocks.length)throw"Toolbox cannot have both blocks and categories in the root level.";return this.workspace_.resizeContents(),e},Blockly.Toolbox.prototype.syncTrees_=function(e,t,o){for(var i,n=null,r=null,s=0;i=e.childNodes[s];s++)if(i.tagName)switch(i.tagName.toUpperCase()){case"CATEGORY":r=Blockly.utils.replaceMessageReferences(i.getAttribute("name")),(r=this.tree_.createNode(r)).blocks=[],t.add(r);var a=i.getAttribute("custom");a?r.blocks=a:(a=this.syncTrees_(i,r,o))&&(n=a),a=Blockly.utils.replaceMessageReferences(i.getAttribute("colour")),goog.isString(a)?(/^#[0-9a-fA-F]{6}$/.test(a)?r.hexColour=a:r.hexColour=Blockly.hueToRgb(Number(a)),this.hasColours_=!0):r.hexColour="","true"==i.getAttribute("expanded")?(r.blocks.length&&(n=r),r.setExpanded(!0)):r.setExpanded(!1),r=i;break;case"SEP":r&&("CATEGORY"==r.tagName.toUpperCase()?t.add(new Blockly.Toolbox.TreeSeparator(this.treeSeparatorConfig_)):(i=parseFloat(i.getAttribute("gap")),!isNaN(i)&&r&&r.setAttribute("gap",i)));break;case"BLOCK":case"SHADOW":case"LABEL":case"BUTTON":t.blocks.push(i),r=i}return n},Blockly.Toolbox.prototype.addColour_=function(e){e=(e||this.tree_).getChildren();for(var t,o=0;t=e[o];o++){var i=t.getRowElement();if(i){var n=this.hasColours_?"8px solid "+(t.hexColour||"#ddd"):"none";this.workspace_.RTL?i.style.borderRight=n:i.style.borderLeft=n}this.addColour_(t)}},Blockly.Toolbox.prototype.clearSelection=function(){this.tree_.setSelectedItem(null)},Blockly.Toolbox.prototype.addStyle=function(e){Blockly.utils.addClass(this.HtmlDiv,e)},Blockly.Toolbox.prototype.removeStyle=function(e){Blockly.utils.removeClass(this.HtmlDiv,e)},Blockly.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;var e=this.HtmlDiv.getBoundingClientRect(),t=e.left,o=e.top,i=e.width;return e=e.height,this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(-1e7,-1e7,1e7+t+i,2e7):this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?new goog.math.Rect(t,-1e7,1e7+i,2e7):this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-1e7,-1e7,2e7,1e7+o+e):new goog.math.Rect(0,o,2e7,1e7+i)},Blockly.Toolbox.prototype.refreshSelection=function(){var e=this.tree_.getSelectedItem();e&&e.blocks&&this.flyout_.show(e.blocks)},Blockly.Toolbox.TreeControl=function(e,t){this.toolbox_=e,goog.ui.tree.TreeControl.call(this,goog.html.SafeHtml.EMPTY,t)},goog.inherits(Blockly.Toolbox.TreeControl,goog.ui.tree.TreeControl),Blockly.Toolbox.TreeControl.prototype.enterDocument=function(){if(Blockly.Toolbox.TreeControl.superClass_.enterDocument.call(this),goog.events.BrowserFeature.TOUCH_ENABLED){var e=this.getElement();Blockly.bindEventWithChecks_(e,goog.events.EventType.TOUCHEND,this,this.handleTouchEvent_)}},Blockly.Toolbox.TreeControl.prototype.handleTouchEvent_=function(e){var t=this.getNodeFromEvent_(e);t&&e.type===goog.events.EventType.TOUCHEND&&setTimeout(function(){t.onClick_(e)},1)},Blockly.Toolbox.TreeControl.prototype.createNode=function(e){return e=e?goog.html.SafeHtml.htmlEscape(e):goog.html.SafeHtml.EMPTY,new Blockly.Toolbox.TreeNode(this.toolbox_,e,this.getConfig(),this.getDomHelper())},Blockly.Toolbox.TreeControl.prototype.setSelectedItem=function(e){var t=this.toolbox_;if(e!=this.selectedItem_&&e!=t.tree_){if(t.lastCategory_&&(t.lastCategory_.getRowElement().style.backgroundColor=""),e){var o=e.hexColour||"#57e";e.getRowElement().style.backgroundColor=o,t.addColour_(e)}o=this.getSelectedItem(),goog.ui.tree.TreeControl.prototype.setSelectedItem.call(this,e),e&&e.blocks&&e.blocks.length?(t.flyout_.show(e.blocks),t.lastCategory_!=e&&t.flyout_.scrollToStart()):t.flyout_.hide(),o!=e&&o!=this&&((o=new Blockly.Events.Ui(null,"category",o&&o.getHtml(),e&&e.getHtml())).workspaceId=t.workspace_.id,Blockly.Events.fire(o)),e&&(t.lastCategory_=e)}},Blockly.Toolbox.TreeNode=function(e,t,o,i){goog.ui.tree.TreeNode.call(this,t,o,i),e&&(t=function(){Blockly.svgResize(e.workspace_)},goog.events.listen(e.tree_,goog.ui.tree.BaseNode.EventType.EXPAND,t),goog.events.listen(e.tree_,goog.ui.tree.BaseNode.EventType.COLLAPSE,t))},goog.inherits(Blockly.Toolbox.TreeNode,goog.ui.tree.TreeNode),Blockly.Toolbox.TreeNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span")},Blockly.Toolbox.TreeNode.prototype.onClick_=function(e){this.hasChildren()&&this.isUserCollapsible_?(this.toggle(),this.select()):this.isSelected()?this.getTree().setSelectedItem(null):this.select(),this.updateRow()},Blockly.Toolbox.TreeNode.prototype.onMouseDown=function(e){},Blockly.Toolbox.TreeNode.prototype.onDoubleClick_=function(e){},Blockly.Toolbox.TreeNode.prototype.onKeyDown=function(e){if(this.tree.toolbox_.horizontalLayout_){var t={},o=goog.events.KeyCodes.DOWN,i=goog.events.KeyCodes.UP;t[goog.events.KeyCodes.RIGHT]=this.rightToLeft_?i:o,t[goog.events.KeyCodes.LEFT]=this.rightToLeft_?o:i,t[goog.events.KeyCodes.UP]=goog.events.KeyCodes.LEFT,t[goog.events.KeyCodes.DOWN]=goog.events.KeyCodes.RIGHT,e.keyCode=t[e.keyCode]||e.keyCode}return Blockly.Toolbox.TreeNode.superClass_.onKeyDown.call(this,e)},Blockly.Toolbox.TreeSeparator=function(e){Blockly.Toolbox.TreeNode.call(this,null,goog.html.SafeHtml.EMPTY,e)},goog.inherits(Blockly.Toolbox.TreeSeparator,Blockly.Toolbox.TreeNode),Blockly.Css={},Blockly.Css.Cursor={OPEN:"handopen",CLOSED:"handclosed",DELETE:"handdelete"},Blockly.Css.currentCursor_="",Blockly.Css.styleSheet_=null,Blockly.Css.mediaPath_="",Blockly.Css.inject=function(e,t){if(!Blockly.Css.styleSheet_){var o=".blocklyDraggable {}\n";e&&(o+=Blockly.Css.CONTENT.join("\n"),Blockly.FieldDate&&(o+=Blockly.FieldDate.CSS.join("\n"))),Blockly.Css.mediaPath_=t.replace(/[\\\/]$/,""),o=o.replace(/<<<PATH>>>/g,Blockly.Css.mediaPath_);var i=document.createElement("style");document.head.insertBefore(i,document.head.firstChild),o=document.createTextNode(o),i.appendChild(o),Blockly.Css.styleSheet_=i.sheet}},Blockly.Css.setCursor=function(e){console.warn("Deprecated call to Blockly.Css.setCursor.See https://github.com/google/blockly/issues/981 for context")},Blockly.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font-family: sans-serif;","font-size: 9pt;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyText {","cursor: default;","fill: #fff;","font-family: sans-serif;","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>rect,",".blocklyEditableText>rect {","fill: #fff;","fill-opacity: .6;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","fill: #000;","}",".blocklyEditableText:hover>rect {","stroke: #fff;","stroke-width: 2;","}",".blocklyBubbleText {","fill: #000;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: #888;","cursor: default;","}",".blocklyFlyoutButtonShadow {","fill: #666;","}",".blocklyFlyoutButton:hover {","fill: #aaa;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyFlyoutLabelText {","fill: #000;","}",".blocklySvg text, .blocklyBlockDragSurface text {","user-select: none;","-moz-user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentTextarea {","background-color: #ffc;","border: 0;","margin: 0;","padding: 2px;","resize: none;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","font-family: sans-serif;","height: 100%;","margin: 0;","outline: none;","padding: 0 1px;","width: 100%","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyTransparentBackground {","opacity: 0;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyZoom>image {","opacity: .4;","}",".blocklyZoom>image:hover {","opacity: .6;","}",".blocklyZoom>image:active {","opacity: .8;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {","stroke: #444;","stroke-width: 1;","fill: #ddd;","fill-opacity: .8;","}",".blocklyAngleMarks {","stroke: #444;","stroke-width: 1;","}",".blocklyAngleGauge {","fill: #f88;","fill-opacity: .8;","}",".blocklyAngleLine {","stroke: #f00;","stroke-width: 2;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","}",".blocklyDropdownMenu {","padding: 0 !important;","max-height: 300px !important;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","position: absolute;","user-select: none;","-moz-user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0 -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0 -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;","font-family: sans-serif;","font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyWidgetDiv .goog-palette {","outline: none;","cursor: default;","}",".blocklyWidgetDiv .goog-palette-table {","border: 1px solid #666;","border-collapse: collapse;","}",".blocklyWidgetDiv .goog-palette-cell {","height: 13px;","width: 15px;","margin: 0;","border: 0;","text-align: center;","vertical-align: middle;","border-right: 1px solid #666;","font-size: 1px;","}",".blocklyWidgetDiv .goog-palette-colorswatch {","position: relative;","height: 13px;","width: 15px;","border: 1px solid #666;","}",".blocklyWidgetDiv .goog-palette-cell-hover .goog-palette-colorswatch {","border: 1px solid #FFF;","}",".blocklyWidgetDiv .goog-palette-cell-selected .goog-palette-colorswatch {","border: 1px solid #000;","color: #fff;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;","font: normal 13px Arial, sans-serif;","list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem {","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content {","color: #000;","font: normal 13px Arial, sans-serif;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon {","left: auto;","right: 6px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(//ssl.gstatic.com/editor/editortoolbar.png) no-repeat -512px 0;","}",".blocklyWidgetDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",""],Blockly.WidgetDiv={},Blockly.WidgetDiv.DIV=null,Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.dispose_=null,Blockly.WidgetDiv.createDom=function(){Blockly.WidgetDiv.DIV||(Blockly.WidgetDiv.DIV=goog.dom.createDom("DIV","blocklyWidgetDiv"),document.body.appendChild(Blockly.WidgetDiv.DIV))},Blockly.WidgetDiv.show=function(e,t,o){Blockly.WidgetDiv.hide(),Blockly.WidgetDiv.owner_=e,Blockly.WidgetDiv.dispose_=o,e=goog.style.getViewportPageOffset(document),Blockly.WidgetDiv.DIV.style.top=e.y+"px",Blockly.WidgetDiv.DIV.style.direction=t?"rtl":"ltr",Blockly.WidgetDiv.DIV.style.display="block"},Blockly.WidgetDiv.hide=function(){Blockly.WidgetDiv.owner_&&(Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.DIV.style.display="none",Blockly.WidgetDiv.DIV.style.left="",Blockly.WidgetDiv.DIV.style.top="",Blockly.WidgetDiv.dispose_&&Blockly.WidgetDiv.dispose_(),Blockly.WidgetDiv.dispose_=null,goog.dom.removeChildren(Blockly.WidgetDiv.DIV))},Blockly.WidgetDiv.isVisible=function(){return!!Blockly.WidgetDiv.owner_},Blockly.WidgetDiv.hideIfOwner=function(e){Blockly.WidgetDiv.owner_==e&&Blockly.WidgetDiv.hide()},Blockly.WidgetDiv.position=function(e,t,o,i,n){t<i.y&&(t=i.y),n?e>o.width+i.x&&(e=o.width+i.x):e<i.x&&(e=i.x),Blockly.WidgetDiv.positionInternal_(e,t,o.height)},Blockly.WidgetDiv.positionInternal_=function(e,t,o){Blockly.WidgetDiv.DIV.style.left=e+"px",Blockly.WidgetDiv.DIV.style.top=t+"px",Blockly.WidgetDiv.DIV.style.height=o+"px"},Blockly.WidgetDiv.positionWithAnchor=function(e,t,o,i){var n=Blockly.WidgetDiv.calculateY_(e,t,o);e=Blockly.WidgetDiv.calculateX_(e,t,o,i),Blockly.WidgetDiv.positionInternal_(e,n,o.height)},Blockly.WidgetDiv.calculateX_=function(e,t,o,i){return i?(t=Math.max(t.right-o.width,e.left),Math.min(t,e.right-o.width)):(t=Math.min(t.left,e.right-o.width),Math.max(t,e.left))},Blockly.WidgetDiv.calculateY_=function(e,t,o){return t.bottom+o.height>=e.bottom?t.top-o.height:t.bottom},Blockly.inject=function(e,t){if(goog.isString(e)&&(e=document.getElementById(e)||document.querySelector(e)),!goog.dom.contains(document,e))throw"Error: container is not in current document.";var o=new Blockly.Options(t||{}),i=goog.dom.createDom("DIV","injectionDiv");e.appendChild(i);var n=Blockly.createDom_(i,o),r=new Blockly.BlockDragSurfaceSvg(i);return i=new Blockly.WorkspaceDragSurfaceSvg(i),o=Blockly.createMainWorkspace_(n,o,r,i),Blockly.init_(o),Blockly.mainWorkspace=o,Blockly.svgResize(o),o},Blockly.createDom_=function(e,t){e.setAttribute("dir","LTR"),goog.ui.Component.setDefaultRightToLeft(t.RTL),Blockly.Css.inject(t.hasCss,t.pathToMedia);var o=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklySvg"},e),i=Blockly.utils.createSvgElement("defs",{},o),n=String(Math.random()).substring(2),r=Blockly.utils.createSvgElement("filter",{id:"blocklyEmbossFilter"+n},i);Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:1,result:"blur"},r);var s=Blockly.utils.createSvgElement("feSpecularLighting",{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},r);return Blockly.utils.createSvgElement("fePointLight",{x:-5e3,y:-1e4,z:2e4},s),Blockly.utils.createSvgElement("feComposite",{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},r),Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},r),t.embossFilterId=r.id,r=Blockly.utils.createSvgElement("pattern",{id:"blocklyDisabledPattern"+n,patternUnits:"userSpaceOnUse",width:10,height:10},i),Blockly.utils.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},r),Blockly.utils.createSvgElement("path",{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},r),t.disabledPatternId=r.id,t.gridPattern=Blockly.Grid.createDom(n,t.gridOptions,i),o},Blockly.createMainWorkspace_=function(e,t,o,i){t.parentWorkspace=null;var n=new Blockly.WorkspaceSvg(t,o,i);return n.scale=t.zoomOptions.startScale,e.appendChild(n.createDom("blocklyMainBackground")),!t.hasCategories&&t.languageTree&&(o=n.addFlyout_("svg"),Blockly.utils.insertAfter_(o,e)),n.translate(0,0),Blockly.mainWorkspace=n,t.readOnly||t.hasScrollbars||n.addChangeListener(function(){if(!n.isDragging()){var e=n.getMetrics(),o=e.viewLeft+e.absoluteLeft,i=e.viewTop+e.absoluteTop;if(e.contentTop<i||e.contentTop+e.contentHeight>e.viewHeight+i||e.contentLeft<(t.RTL?e.viewLeft:o)||e.contentLeft+e.contentWidth>(t.RTL?e.viewWidth:e.viewWidth+o))for(var r,s=n.getTopBlocks(!1),a=0;r=s[a];a++){var l=r.getRelativeToSurfaceXY(),c=r.getHeightWidth(),u=i+25-c.height-l.y;0<u&&r.moveBy(0,u),0>(u=i+e.viewHeight-25-l.y)&&r.moveBy(0,u),0<(u=25+o-l.x-(t.RTL?0:c.width))&&r.moveBy(u,0),0>(l=o+e.viewWidth-25-l.x+(t.RTL?c.width:0))&&r.moveBy(l,0)}}}),Blockly.svgResize(n),Blockly.WidgetDiv.createDom(),Blockly.Tooltip.createDom(),n},Blockly.init_=function(e){var t=e.options,o=e.getParentSvg();Blockly.bindEventWithChecks_(o.parentNode,"contextmenu",null,function(e){Blockly.utils.isTargetInput(e)||e.preventDefault()}),o=Blockly.bindEventWithChecks_(window,"resize",null,function(){Blockly.hideChaff(!0),Blockly.svgResize(e)}),e.setResizeHandlerWrapper(o),Blockly.inject.bindDocumentEvents_(),t.languageTree&&(e.toolbox_?e.toolbox_.init(e):e.flyout_&&(e.flyout_.init(e),e.flyout_.show(t.languageTree.childNodes),e.flyout_.scrollToStart(),e.scrollX=e.flyout_.width_,t.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(e.scrollX*=-1),e.translate(e.scrollX,0))),t.hasScrollbars&&(e.scrollbar=new Blockly.ScrollbarPair(e),e.scrollbar.resize()),t.hasSounds&&Blockly.inject.loadSounds_(t.pathToMedia,e)},Blockly.inject.bindDocumentEvents_=function(){Blockly.documentEventsBound_||(Blockly.bindEventWithChecks_(document,"keydown",null,Blockly.onKeyDown_),Blockly.bindEvent_(document,"touchend",null,Blockly.longStop_),Blockly.bindEvent_(document,"touchcancel",null,Blockly.longStop_),goog.userAgent.IPAD&&Blockly.bindEventWithChecks_(window,"orientationchange",document,function(){Blockly.svgResize(Blockly.getMainWorkspace())})),Blockly.documentEventsBound_=!0},Blockly.inject.loadSounds_=function(e,t){var o=t.getAudioManager();o.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),o.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),o.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");var i=[],n=function(){for(;i.length;)Blockly.unbindEvent_(i.pop());o.preload()};i.push(Blockly.bindEventWithChecks_(document,"mousemove",null,n,!0)),i.push(Blockly.bindEventWithChecks_(document,"touchstart",null,n,!0))},Blockly.updateToolbox=function(e){console.warn("Deprecated call to Blockly.updateToolbox, use workspace.updateToolbox instead."),Blockly.getMainWorkspace().updateToolbox(e)};var CLOSURE_DEFINES={"goog.DEBUG":!1};return Blockly.mainWorkspace=null,Blockly.selected=null,Blockly.draggingConnections_=[],Blockly.clipboardXml_=null,Blockly.clipboardSource_=null,Blockly.cache3dSupported_=null,Blockly.hueToRgb=function(e){return goog.color.hsvToHex(e,Blockly.HSV_SATURATION,255*Blockly.HSV_VALUE)},Blockly.svgSize=function(e){return{width:e.cachedWidth_,height:e.cachedHeight_}},Blockly.resizeSvgContents=function(e){e.resizeContents()},Blockly.svgResize=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;var t=e.getParentSvg(),o=t.parentNode;if(o){var i=o.offsetWidth;o=o.offsetHeight,t.cachedWidth_!=i&&(t.setAttribute("width",i+"px"),t.cachedWidth_=i),t.cachedHeight_!=o&&(t.setAttribute("height",o+"px"),t.cachedHeight_=o),e.resize()}},Blockly.onKeyDown_=function(e){if(!Blockly.mainWorkspace.options.readOnly&&!Blockly.utils.isTargetInput(e)){var t=!1;if(27==e.keyCode)Blockly.hideChaff();else if(8==e.keyCode||46==e.keyCode){if(e.preventDefault(),Blockly.mainWorkspace.isDragging())return;Blockly.selected&&Blockly.selected.isDeletable()&&(t=!0)}else if(e.altKey||e.ctrlKey||e.metaKey){if(Blockly.mainWorkspace.isDragging())return;Blockly.selected&&Blockly.selected.isDeletable()&&Blockly.selected.isMovable()&&(67==e.keyCode?(Blockly.hideChaff(),Blockly.copy_(Blockly.selected)):88!=e.keyCode||Blockly.selected.workspace.isFlyout||(Blockly.copy_(Blockly.selected),t=!0)),86==e.keyCode?Blockly.clipboardXml_&&(Blockly.Events.setGroup(!0),(e=Blockly.clipboardSource_).isFlyout&&(e=e.targetWorkspace),e.paste(Blockly.clipboardXml_),Blockly.Events.setGroup(!1)):90==e.keyCode&&(Blockly.hideChaff(),Blockly.mainWorkspace.undo(e.shiftKey))}t&&!Blockly.selected.workspace.isFlyout&&(Blockly.Events.setGroup(!0),Blockly.hideChaff(),Blockly.selected.dispose(!0,!0),Blockly.Events.setGroup(!1))}},Blockly.copy_=function(e){var t=Blockly.Xml.blockToDom(e);Blockly.Xml.deleteNext(t);var o=e.getRelativeToSurfaceXY();t.setAttribute("x",e.RTL?-o.x:o.x),t.setAttribute("y",o.y),Blockly.clipboardXml_=t,Blockly.clipboardSource_=e.workspace},Blockly.duplicate_=function(e){var t=Blockly.clipboardXml_,o=Blockly.clipboardSource_;Blockly.copy_(e),e.workspace.paste(Blockly.clipboardXml_),Blockly.clipboardXml_=t,Blockly.clipboardSource_=o},Blockly.onContextMenu_=function(e){Blockly.utils.isTargetInput(e)||e.preventDefault()},Blockly.hideChaff=function(e){Blockly.Tooltip.hide(),Blockly.WidgetDiv.hide(),e||(e=Blockly.getMainWorkspace()).toolbox_&&e.toolbox_.flyout_&&e.toolbox_.flyout_.autoClose&&e.toolbox_.clearSelection()},Blockly.addChangeListener=function(e){return console.warn("Deprecated call to Blockly.addChangeListener, use workspace.addChangeListener instead."),Blockly.getMainWorkspace().addChangeListener(e)},Blockly.getMainWorkspace=function(){return Blockly.mainWorkspace},Blockly.alert=function(e,t){window.alert(e),t&&t()},Blockly.confirm=function(e,t){t(window.confirm(e))},Blockly.prompt=function(e,t,o){o(window.prompt(e,t))},Blockly.jsonInitFactory_=function(e){return function(){this.jsonInit(e)}},Blockly.defineBlocksWithJsonArray=function(e){for(var t,o=0;t=e[o];o++){var i=t.type;null==i||""===i?console.warn("Block definition #"+o+" in JSON array is missing a type attribute. Skipping."):(Blockly.Blocks[i]&&console.warn("Block definition #"+o+' in JSON array overwrites prior definition of "'+i+'".'),Blockly.Blocks[i]={init:Blockly.jsonInitFactory_(t)})}},Blockly.bindEventWithChecks_=function(e,t,o,i,n,r){var s=!1,a=function(e){var t=!n;e=Blockly.Touch.splitEventByTouches(e);for(var r,a=0;r=e[a];a++)t&&!Blockly.Touch.shouldHandleEvent(r)||(Blockly.Touch.setClientFromTouch(r),o?i.call(o,r):i(r),s=!0)};e.addEventListener(t,a,!1);var l=[[e,t,a]];if(t in Blockly.Touch.TOUCH_MAP)for(var c,u=function(e){a(e),s&&!r&&e.preventDefault()},h=0;c=Blockly.Touch.TOUCH_MAP[t][h];h++)e.addEventListener(c,u,!1),l.push([e,c,u]);return l},Blockly.bindEvent_=function(e,t,o,i){var n=function(e){o?i.call(o,e):i(e)};e.addEventListener(t,n,!1);var r=[[e,t,n]];if(t in Blockly.Touch.TOUCH_MAP)for(var s,a=function(e){if(e.changedTouches&&1==e.changedTouches.length){var t=e.changedTouches[0];e.clientX=t.clientX,e.clientY=t.clientY}n(e),e.preventDefault()},l=0;s=Blockly.Touch.TOUCH_MAP[t][l];l++)e.addEventListener(s,a,!1),r.push([e,s,a]);return r},Blockly.unbindEvent_=function(e){for(;e.length;){var t=e.pop(),o=t[2];t[0].removeEventListener(t[1],o,!1)}return o},Blockly.isNumber=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},goog.global.console||(goog.global.console={log:function(){},warn:function(){}}),goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.getMainWorkspace=Blockly.getMainWorkspace,goog.global.Blockly.addChangeListener=Blockly.addChangeListener,Blockly.goog=goog,Blockly}()},function(e,t,o){const i=o(15),n=Handlebars.compile(o(137));o(136),o(134),o(130),o(127),AFRAME.registerComponent("blockly",{schema:{type:"string"},init:function(){const e=this;if(this.el.id||(this.el.id=Math.random().toString(16).substr(2)),this.id=this.el.id,this.$blocklyDiv=$("#blocklyDiv-"+this.id),this.$blocklyDiv.length<1)return setTimeout(function(){e.init()},10);this.initalised=!0,this.el.bo=this,this.name="Loading...",this.el.components["scene-panel"]&&(this.name=this.el.components["scene-panel"].data.name),this.$blocklyArea=this.$blocklyDiv.parent(),this.blocklyArea=this.$blocklyArea.get(0),this.blocklyDiv=this.$blocklyDiv.get(0),this.workspace=i.inject(this.blocklyDiv,{toolbox:n({name:this.name})}),i.JavaScript.init(this.workspace),this.data&&this.loadFromDom(this.data),this.workspace.addChangeListener(()=>this.compile()),this.el.addEventListener("updateName",function(t){e.name!==t.detail&&(e.name=t.detail,e.workspace.updateToolbox(n({name:t.detail})))})},update:function(){this.initalised&&this.wsDom!==this.data&&this.loadFromDom(this.data)},loadFromDom:function(e){this.wsDom=e,e=i.Xml.textToDom(e),i.Xml.domToWorkspace(e,this.workspace)},saveToDom:function(){let e=i.Xml.workspaceToDom(this.workspace);this.wsDom=i.Xml.domToText(e),this.el.setAttribute("blockly",this.wsDom)},onresize:function(e){if(!this.initalised)return;let t=this.blocklyArea,o=0,n=0;do{o+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent}while(t);this.blocklyDiv.style.left=o+"px",this.blocklyDiv.style.top=n+"px",this.blocklyDiv.style.width=this.blocklyArea.offsetWidth+"px",this.blocklyDiv.style.height=this.blocklyArea.offsetHeight+"px",i.svgResize(this.workspace)},compile:function(){let e=this.workspace.getTopBlocks();this.codes={callbacks:{}};for(let t in e){let o=e[t].type;if(0!==o.indexOf("aframeevent"))continue;this.codes[o]||(this.codes[o]=[]),this.asyncCompile(e[t]);let n=i.JavaScript.blockToCode(e[t]);this.codes[o].push(n)}this.el.setAttribute("code-exec",JSON.stringify(this.codes))},asyncCompile:function(e,t){if(!e)return;i.Blocks[e.type]._isAsync&&(this.codes.callbacks[e.id]=i.JavaScript.statementToCode(e,"CALLBACK")||"");let o=e.getChildren();for(let e in o)this.asyncCompile(o[e],!0);t||this.asyncCompile(e.getNextBlock())},remove:function(){this.workspace.dispose()}}),$(document).ready(function(){$("head").prepend($("#materializeCSS"))})},function(module,exports){const variables={};AFRAME.registerComponent("code-exec",{schema:{type:"string"},init:function(){this.events={},this.vars=variables,this.callbacks={},this.blockstore={waits:{}},this.data&&this.eval(this.data);let e=this;this.el.addEventListener("collide",function(t){e.trigger("aframeevent_collision",[t])})},update:function(){this.data&&this.eval(this.data)},eval:function(codes){this.codes=JSON.parse(codes),this.events={},this.callbacks={};let self=this;for(event in this.codes)if("callbacks"===event)for(let i in this.codes[event])eval("this.callbacks[i] = function(){"+this.codes[event][i]+"};");else{this.events[event]||(this.events[event]=[]);for(let i in this.codes[event])eval("this.events[event].push(function(){"+this.codes[event][i]+"});")}},trigger:function(e,t,o){for(let i in this.events[e])this.events[e][i].apply(o||this,t)},tick(e,t){this._time=e,this._delta=t,this.trigger("aframeevent_tick",[e,t]),this.trigger("aframeevent_interval",[e,t]);for(let t in this.blockstore.waits){if(!this.callbacks[t])continue;let o=[];for(let i in this.blockstore.waits[t])e>=this.blockstore.waits[t][i]&&(o.unshift(i),this.callbacks[t].apply(this));for(let e in o)this.blockstore.waits[t].splice(o[e],1)}}})},function(e,t){e.exports='<div class="col card-wrap">\n    <div class="card" id="scene-panel-card-{{id}}" data-type="{{type}}">\n        <div class="card-image">\n            <canvas class="obj-preview"></canvas>\n            <span class="card-title" contenteditable>{{name}}</span>\n        </div>\n        <div class="card-content">\n            <i class="fa fa-eye toggle-vis" data-position="top" data-delay="50" data-tooltip="Switch Invisible"></i>\n            <i class="fa fa-globe toggle-grav" data-position="top" data-delay="50" data-tooltip="Switch Gravity"></i>\n            <i class="fa fa-tag rename" data-position="top" data-delay="50" data-tooltip="Rename"></i>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports="<h3>WIP, check back later :)</h3>"},function(e,t){e.exports='<div class="row">\n    <form class="col s12" action="#" data-id="{{id}}">\n        <h3>General Settings</h3>\n        <div class="row">\n            <div class="switch col s12">\n                <h5>  <i class="fa fa-globe"></i> Gravity (Fall Down and Bounce)</h5>\n                <label>\n                    Off\n                    <input type="checkbox" class="toggle-grav">\n                    <span class="lever"></span>\n                    On\n                </label>\n            </div>\n            <div class="divider"></div>\n            <div class="switch col s12">\n                <h5>  <i class="fa fa-eye"></i> Invisible (See Through)</h5>\n                <label>\n                    Off\n                    <input type="checkbox" class="toggle-vis">\n                    <span class="lever"></span>\n                    On\n                </label>\n            </div>\n        </div>\n        <div class="shape-settings">\n            <h3>Shape Settings</h3>\n            <div class="row selectShapeWrap">\n                <div class="input-field col s12 m4">\n                    <select class="selectShape">\n                        <option value="" disabled selected>Choose a shape</option>\n                        <option value="box">Box</option>\n                        <option value="sphere">Ball</option>\n                        <option value="cylinder">Can</option>\n                    </select>\n                    <label>Object Shape</label>\n                </div>\n            </div>\n            <div class="row inputDiameterWrap">\n                <div class="input-field col s12 m4">\n                    <input value="1" type="number" class="inputDiameter">\n                    <label for="first_name">Diameter (Circle Size)</label>\n                </div>\n            </div>\n            <div class="row inputHeightWrap">\n                <div class="input-field col s12 m4">\n                    <input value="1" type="number" class="inputHeight">\n                    <label for="last_name">Height ( Up/Down )</label>\n                </div>\n            </div>\n            <div class="row inputWidthWrap">\n                <div class="input-field col s12 m4">\n                    <input value="1" type="number" class="inputWidth">\n                    <label>Width ( Left/Right )</label>\n                </div>\n            </div>\n            <div class="row inputDepthWrap">\n                <div class="input-field col s12 m4">\n                    <input value="1" type="number" class="inputDepth">\n                    <label>Depth ( Forwards/Backwards )</label>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>'},function(e,t){e.exports='<div id="config-wrap-{{id}}">\n<ul class="obj-tabs tabs">\n    <li class="tab disabled"><a class="name" href="#">{{name}}</a></li>\n    <li class="tab"><a class="active" href="#blocklyDiv-{{id}}"><i class="fa fa-puzzle-piece"></i> Code</a></li>\n    <li class="tab"><a href="#settings-{{id}}"><i class="fa fa-sliders"></i> Settings</a></li>\n    <li class="tab"><a href="#material-{{id}}"><i class="fa fa-paint-brush"></i> Skin</a></li>\n</ul>\n<div class="divider"></div>\n<div class="row">\n    <div id="blocklyDiv-{{id}}" style="position: absolute"></div>\n    <div id="settings-{{id}}" class="col s12">{{{settingsForm}}}</div>\n    <div id="material-{{id}}" class="col s12">{{{materialForm}}}</div>\n</div>\n</div>\n\n\n\n\n'},function(e,t,o){const i=Handlebars.compile(o(151)),n=Handlebars.compile(o(150)),r=Handlebars.compile(o(149));AFRAME.registerComponent("obj-config",{schema:{},init:function(){const e=this;this.el.id||(this.el.id=Math.random().toString(16).substr(2)),this.id=this.el.id,this.name="Loading...",this.el.components["scene-panel"]&&(this.name=this.el.components["scene-panel"].data.name),this.settingsForm=n(this),this.materialForm=r(this),this.$mainArea=$("#right-view"),this.$configDiv=$(i(this)),this.$mainArea.append(this.$configDiv),this.$toggleVis=$("#settings-"+this.id+" .toggle-vis"),this.$toggleVis.change(function(){e.el.setAttribute("visible",!e.el.components.visible.data)}),this.el.addEventListener("toggleVisible",function(t){e.$toggleVis.prop("checked",!t.detail)}),this.$toggleGrav=$("#settings-"+this.id+" .toggle-grav"),this.$toggleGrav.change(function(){let t=e.el.hasAttribute("dynamic-body");e.el.removeAttribute(t?"dynamic-body":"static-body"),e.el.setAttribute(t?"static-body":"dynamic-body","")}),this.el.addEventListener("toggleGravity",function(t){e.$toggleGrav.prop("checked",t.detail)}),this.el.addEventListener("updateName",function(t){e.name!==t.detail&&(e.name=t.detail,e.$configDiv.find(".name").text(t.detail))}),this.$configDiv.find(".shape-settings input").keyup(function(){e.setGeom()}),this.$configDiv.find(".shape-settings input").change(function(){e.setGeom()}),this.$configDiv.find(".shape-settings select").change(function(){e.setGeom()}),this.$configDiv.find(".shape-settings select").material_select(),this.$configDiv.find(".obj-tabs").tabs(),this.shapeInputs={shape:this.$configDiv.find(".selectShapeWrap input.select-dropdown"),realShape:this.$configDiv.find(".selectShape"),radius:this.$configDiv.find(".inputDiameter"),height:this.$configDiv.find(".inputHeight"),width:this.$configDiv.find(".inputWidth"),depth:this.$configDiv.find(".inputDepth")},this.shapeWraps={all:this.$configDiv.find(".shape-settings > .row:not(.selectShapeWrap)"),shape:this.$configDiv.find(".selectShapeWrap"),radius:this.$configDiv.find(".inputDiameterWrap"),height:this.$configDiv.find(".inputHeightWrap"),width:this.$configDiv.find(".inputWidthWrap"),depth:this.$configDiv.find(".inputDepthWrap")},this.$configDiv.find(`a[href="#blocklyDiv-${this.id}"]`).click(function(){e.onresize()}),this.el.addEventListener("updateName",function(t){e.updateGeom(t.detail)}),this.el.components.geometry&&e.updateGeom(this.el.components.geometry.data),window.addEventListener("resize",()=>this.onresize(),!1),window.splitEvents.onDrag.push(()=>this.onresize()),this.hide()},onresize:function(){this.el.components.blockly&&requestAnimationFrame(()=>this.el.components.blockly.onresize()),this.$configDiv.find(".obj-tabs").trigger("resize")},setGeom:function(){this.lastGeom=this.lastGeom||{};let e=!1;console.log(this.shapeInputs.shape.val());let t={Box:"box",Can:"cylinder",Ball:"sphere"}[this.shapeInputs.shape.val()],o={primitive:t};this.lastGeom.primitive!==t&&(e=!0),-1!==["sphere","cylinder","circle","dodecahedron","octahedron","tetrahedron"].indexOf(t)&&(o.radius=Number(this.shapeInputs.radius.val())/2,this.lastGeom.radius!==o.radius&&(e=!0)),-1!==["box","cylinder","plane"].indexOf(t)&&(o.height=Number(this.shapeInputs.height.val()),this.lastGeom.height!==o.height&&(e=!0)),-1!==["box","plane"].indexOf(t)&&(o.width=Number(this.shapeInputs.width.val()),this.lastGeom.width!==o.width&&(e=!0)),-1!==["box"].indexOf(t)&&(o.depth=Number(this.shapeInputs.depth.val()),this.lastGeom.depth!==o.depth&&(e=!0)),this.lastGeom=o,this.updateGeom(o),console.log(o),e&&this.el.setAttribute("geometry",o)},updateGeom:function(e){let t=e.primitive;this.shapeInputs.realShape.val(t),this.shapeWraps.all.hide(),e.radius&&(this.shapeWraps.radius.show(),this.shapeInputs.radius.val(2*e.radius)),e.height&&(this.shapeWraps.height.show(),this.shapeInputs.height.val(e.height)),e.width&&(this.shapeWraps.width.show(),this.shapeInputs.width.val(e.width)),e.depth&&(this.shapeWraps.depth.show(),this.shapeInputs.depth.val(e.depth))},show:function(){$("#right-view > div").hide(),this.$configDiv.show(),this.onresize()},hide:function(){this.$configDiv.hide(),$("#blocklyNoSelect").show()},remove:function(){this.$configDiv.remove()},tick:function(e,t){}})},function(e,t){var o,i,n=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(o===setTimeout)return setTimeout(e,0);if((o===r||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:r}catch(e){o=r}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],u=!1,h=-1;function g(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&d())}function d(){if(!u){var e=a(g);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];c.push(new p(e,t)),1!==c.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,o){(function(e,t){!function(e,o){"use strict";if(!e.setImmediate){var i,n,r,s,a,l=1,c={},u=!1,h=e.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,o=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=o,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){r.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(n=h.documentElement,i=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(t){e.postMessage(s+t,"*")}),g.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var n={callback:e,args:t};return c[l]=n,i(l),l++},g.clearImmediate=d}function d(e){delete c[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(o,i)}}(t)}finally{d(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,o(27),o(153))},function(e,t,o){(function(e){var i=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o(154),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,o(27))},function(t,o,i){(function(o,i){var n;t.exports=function e(t,o,i){function r(a,l){if(!o[a]){if(!t[a]){var c="function"==typeof n&&n;if(!l&&c)return n(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){var o=t[a][1][e];return r(o||e)},h,h.exports,e,t,o,i)}return o[a].exports}for(var s="function"==typeof n&&n,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,o){(function(e){var i=function(){this._tweens={},this._tweensAddedDuringUpdate={}};i.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var o=Object.keys(this._tweens);if(0===o.length)return!1;for(e=void 0!==e?e:s.now();o.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<o.length;i++)!1===this._tweens[o[i]].update(e)&&(this._tweens[o[i]]._isPlaying=!1,t||delete this._tweens[o[i]]);o=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var n,r,s=new i;s.Group=i,s._nextId=0,s.nextId=function(){return s._nextId++},"undefined"==typeof window&&void 0!==e?s.now=function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?s.now=window.performance.now.bind(window.performance):void 0!==Date.now?s.now=Date.now:s.now=function(){return(new Date).getTime()},s.Tween=function(e,t){this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=s.Easing.Linear.None,this._interpolationFunction=s.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||s,this._id=s.nextId()},s.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(e,t){return this._valuesEnd=e,void 0!==t&&(this._duration=t),this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==e?e:s.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(this._valuesStart[t]=this._object[t],this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,o,i;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0),o=(o=(e-this._startTime)/this._duration)>1?1:o,i=this._easingFunction(o),this._valuesEnd)if(void 0!==this._valuesStart[t]){var n=this._valuesStart[t]||0,r=this._valuesEnd[t];r instanceof Array?this._object[t]=this._interpolationFunction(r,i):("string"==typeof r&&(r="+"===r.charAt(0)||"-"===r.charAt(0)?n+parseFloat(r):parseFloat(r)),"number"==typeof r&&(this._object[t]=n+(r-n)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,i),1===o){if(this._repeat>0){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo){var s=this._valuesStartRepeat[t];this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=s}this._valuesStart[t]=this._valuesStartRepeat[t]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration);return!1}return!0}},s.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-s.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*s.Easing.Bounce.In(2*e):.5*s.Easing.Bounce.Out(2*e-1)+.5}}},s.Interpolation={Linear:function(e,t){var o=e.length-1,i=o*t,n=Math.floor(i),r=s.Interpolation.Utils.Linear;return t<0?r(e[0],e[1],i):t>1?r(e[o],e[o-1],o-i):r(e[n],e[n+1>o?o:n+1],i-n)},Bezier:function(e,t){for(var o=0,i=e.length-1,n=Math.pow,r=s.Interpolation.Utils.Bernstein,a=0;a<=i;a++)o+=n(1-t,i-a)*n(t,a)*e[a]*r(i,a);return o},CatmullRom:function(e,t){var o=e.length-1,i=o*t,n=Math.floor(i),r=s.Interpolation.Utils.CatmullRom;return e[0]===e[o]?(t<0&&(n=Math.floor(i=o*(1+t))),r(e[(n-1+o)%o],e[n],e[(n+1)%o],e[(n+2)%o],i-n)):t<0?e[0]-(r(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[o]-(r(e[o],e[o],e[o-1],e[o-1],i-o)-e[o]):r(e[n?n-1:0],e[n],e[o<n+1?o:n+1],e[o<n+2?o:n+2],i-n)},Utils:{Linear:function(e,t,o){return(t-e)*o+e},Bernstein:function(e,t){var o=s.Interpolation.Utils.Factorial;return o(e)/o(t)/o(e-t)},Factorial:(n=[1],function(e){var t=1;if(n[e])return n[e];for(var o=e;o>1;o--)t*=o;return n[e]=t,t}),CatmullRom:function(e,t,o,i,n){var r=.5*(o-e),s=.5*(i-t),a=n*n,l=n*a;return(2*t-2*o+r+s)*l+(-3*t+3*o-2*r-s)*a+r*n+t}}},r=this,void 0!==t&&"object"==typeof o?t.exports=s:void 0!==r&&(r.TWEEN=s)}).call(this,e("_process"))},{_process:6}],2:[function(e,t,o){var i=Object.prototype.toString;t.exports=function(e){return e.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===i.call(e.buffer)||Array.isArray(e)}},{}],3:[function(e,t,o){t.exports=function(e,t){return"number"==typeof e?e:"number"==typeof t?t:0}},{}],4:[function(e,t,o){"use strict";o.byteLength=function(e){return 3*e.length/4-c(e)},o.toByteArray=function(e){var t,o,i,s,a,l=e.length;s=c(e),a=new r(3*l/4-s),o=s>0?l-4:l;var u=0;for(t=0;t<o;t+=4)i=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===s?(i=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4,a[u++]=255&i):1===s&&(i=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a},o.fromByteArray=function(e){for(var t,o=e.length,n=o%3,r="",s=[],a=0,l=o-n;a<l;a+=16383)s.push(u(e,a,a+16383>l?l:a+16383));return 1===n?(t=e[o-1],r+=i[t>>2],r+=i[t<<4&63],r+="=="):2===n&&(t=(e[o-2]<<8)+e[o-1],r+=i[t>>10],r+=i[t>>4&63],r+=i[t<<2&63],r+="="),s.push(r),s.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)i[a]=s[a],n[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function u(e,t,o){for(var n,r,s=[],a=t;a<o;a+=3)n=(e[a]<<16)+(e[a+1]<<8)+e[a+2],s.push(i[(r=n)>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],5:[function(e,t,o){"use strict";t.exports={createLink:function(e,t){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("link");for(var n in i.href=e,i.rel="stylesheet",t)if(t.hasOwnProperty(n)){var r=t[n];i.setAttribute("data-"+n,r)}o.appendChild(i)},createStyle:function(e,t){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");for(var n in i.type="text/css",t)if(t.hasOwnProperty(n)){var r=t[n];i.setAttribute("data-"+n,r)}i.sheet?(i.innerHTML=e,i.sheet.cssText=e,o.appendChild(i)):i.styleSheet?(o.appendChild(i),i.styleSheet.cssText=e):(i.appendChild(document.createTextNode(e)),o.appendChild(i))}}},{}],6:[function(e,t,o){var i,n,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],h=!1,g=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):g=-1,u.length&&p())}function p(){if(!h){var e=l(d);h=!0;for(var t=u.length;t;){for(c=u,u=[];++g<t;)c&&c[g].run();g=-1,t=u.length}c=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new f(e,t)),1!==u.length||h||l(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],7:[function(e,t,o){var i=e("buffer").Buffer;t.exports=function(e,t){if(i.isBuffer(e)&&i.isBuffer(t)){if("function"==typeof e.equals)return e.equals(t);if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}}},{buffer:8}],8:[function(e,t,i){(function(t){"use strict";var o=e("base64-js"),n=e("ieee754"),r=e("isarray");function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,o){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,o);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,o)}function c(e,t,o,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,o,i){if(t.byteLength,o<0||t.byteLength<o)throw new RangeError("'offset' is out of bounds");if(t.byteLength<o+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===o&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,o):new Uint8Array(t,o,i),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=g(e,t),e}(e,t,o,i):"string"==typeof t?function(e,t,o){if("string"==typeof o&&""!==o||(o="utf8"),!l.isEncoding(o))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,o),n=(e=a(e,i)).write(t,o);return n!==i&&(e=e.slice(0,n)),e}(e,t,o):function(e,t){if(l.isBuffer(t)){var o=0|d(t.length);return 0===(e=a(e,o)).length?e:(t.copy(e,0,0,o),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):g(e,t);if("Buffer"===t.type&&r(t.data))return g(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=a(e,t<0?0:0|d(t)),!l.TYPED_ARRAY_SUPPORT)for(var o=0;o<t;++o)e[o]=0;return e}function g(e,t){var o=t.length<0?0:0|d(t.length);e=a(e,o);for(var i=0;i<o;i+=1)e[i]=255&t[i];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var o=e.length;if(0===o)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return H(e).length;default:if(i)return F(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,o){var i=e[t];e[t]=e[o],e[o]=i}function m(e,t,o,i,n){if(0===e.length)return-1;if("string"==typeof o?(i=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,isNaN(o)&&(o=n?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(n)return-1;o=e.length-1}else if(o<0){if(!n)return-1;o=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:y(e,t,o,i,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):y(e,[t],o,i,n);throw new TypeError("val must be string, number or Buffer")}function y(e,t,o,i,n){var r,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,o/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var u=-1;for(r=o;r<a;r++)if(c(e,r)===c(t,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===l)return u*s}else-1!==u&&(r-=r-u),u=-1}else for(o+l>a&&(o=a-l),r=o;r>=0;r--){for(var h=!0,g=0;g<l;g++)if(c(e,r+g)!==c(t,g)){h=!1;break}if(h)return r}return-1}function v(e,t,o,i){o=Number(o)||0;var n=e.length-o;i?(i=Number(i))>n&&(i=n):i=n;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");i>r/2&&(i=r/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[o+s]=a}return s}function E(e,t,o,i){return j(F(t,e.length-o),e,o,i)}function _(e,t,o,i){return j(function(e){for(var t=[],o=0;o<e.length;++o)t.push(255&e.charCodeAt(o));return t}(t),e,o,i)}function T(e,t,o,i){return _(e,t,o,i)}function b(e,t,o,i){return j(H(t),e,o,i)}function M(e,t,o,i){return j(function(e,t){for(var o,i,n,r=[],s=0;s<e.length&&!((t-=2)<0);++s)o=e.charCodeAt(s),i=o>>8,n=o%256,r.push(n),r.push(i);return r}(t,e.length-o),e,o,i)}function A(e,t,i){return 0===t&&i===e.length?o.fromByteArray(e):o.fromByteArray(e.slice(t,i))}function S(e,t,o){o=Math.min(e.length,o);for(var i=[],n=t;n<o;){var r,s,a,l,c=e[n],u=null,h=c>239?4:c>223?3:c>191?2:1;if(n+h<=o)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(r=e[n+1]))&&(l=(31&c)<<6|63&r)>127&&(u=l);break;case 3:r=e[n+1],s=e[n+2],128==(192&r)&&128==(192&s)&&(l=(15&c)<<12|(63&r)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:r=e[n+1],s=e[n+2],a=e[n+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&r)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);for(var o="",i=0;i<t;)o+=String.fromCharCode.apply(String,e.slice(i,i+=w));return o}(i)}i.Buffer=l,i.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},i.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),i.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,o){return c(null,e,t,o)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,o){return function(e,t,o,i){return u(t),t<=0?a(e,t):void 0!==o?"string"==typeof i?a(e,t).fill(o,i):a(e,t).fill(o):a(e,t)}(null,e,t,o)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var o=e.length,i=t.length,n=0,r=Math.min(o,i);n<r;++n)if(e[n]!==t[n]){o=e[n],i=t[n];break}return o<i?-1:i<o?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var o;if(void 0===t)for(t=0,o=0;o<e.length;++o)t+=e[o].length;var i=l.allocUnsafe(t),n=0;for(o=0;o<e.length;++o){var s=e[o];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n),n+=s.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):function(e,t,o){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===o||o>this.length)&&(o=this.length),o<=0)return"";if((o>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,o);case"utf8":case"utf-8":return S(this,t,o);case"ascii":return C(this,t,o);case"latin1":case"binary":return N(this,t,o);case"base64":return A(this,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,o);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,o,i,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===o&&(o=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||o>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=o)return 0;if(i>=n)return-1;if(t>=o)return 1;if(t>>>=0,o>>>=0,i>>>=0,n>>>=0,this===e)return 0;for(var r=n-i,s=o-t,a=Math.min(r,s),c=this.slice(i,n),u=e.slice(t,o),h=0;h<a;++h)if(c[h]!==u[h]){r=c[h],s=u[h];break}return r<s?-1:s<r?1:0},l.prototype.includes=function(e,t,o){return-1!==this.indexOf(e,t,o)},l.prototype.indexOf=function(e,t,o){return m(this,e,t,o,!0)},l.prototype.lastIndexOf=function(e,t,o){return m(this,e,t,o,!1)},l.prototype.write=function(e,t,o,i){if(void 0===t)i="utf8",o=this.length,t=0;else if(void 0===o&&"string"==typeof t)i=t,o=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(o)?(o|=0,void 0===i&&(i="utf8")):(i=o,o=void 0)}var n=this.length-t;if((void 0===o||o>n)&&(o=n),e.length>0&&(o<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var r=!1;;)switch(i){case"hex":return v(this,e,t,o);case"utf8":case"utf-8":return E(this,e,t,o);case"ascii":return _(this,e,t,o);case"latin1":case"binary":return T(this,e,t,o);case"base64":return b(this,e,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,o);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function C(e,t,o){var i="";o=Math.min(e.length,o);for(var n=t;n<o;++n)i+=String.fromCharCode(127&e[n]);return i}function N(e,t,o){var i="";o=Math.min(e.length,o);for(var n=t;n<o;++n)i+=String.fromCharCode(e[n]);return i}function L(e,t,o){var i,n=e.length;(!t||t<0)&&(t=0),(!o||o<0||o>n)&&(o=n);for(var r="",s=t;s<o;++s)r+=(i=e[s])<16?"0"+i.toString(16):i.toString(16);return r}function I(e,t,o){for(var i=e.slice(t,o),n="",r=0;r<i.length;r+=2)n+=String.fromCharCode(i[r]+256*i[r+1]);return n}function R(e,t,o){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>o)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,o,i,n,r){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<r)throw new RangeError('"value" argument is out of bounds');if(o+i>e.length)throw new RangeError("Index out of range")}function x(e,t,o,i){t<0&&(t=65535+t+1);for(var n=0,r=Math.min(e.length-o,2);n<r;++n)e[o+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function O(e,t,o,i){t<0&&(t=4294967295+t+1);for(var n=0,r=Math.min(e.length-o,4);n<r;++n)e[o+n]=t>>>8*(i?n:3-n)&255}function k(e,t,o,i,n,r){if(o+i>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function B(e,t,o,i,r){return r||k(e,0,o,4),n.write(e,t,o,i,23,4),o+4}function P(e,t,o,i,r){return r||k(e,0,o,8),n.write(e,t,o,i,52,8),o+8}l.prototype.slice=function(e,t){var o,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;o=new l(n,void 0);for(var r=0;r<n;++r)o[r]=this[r+e]}return o},l.prototype.readUIntLE=function(e,t,o){e|=0,t|=0,o||R(e,t,this.length);for(var i=this[e],n=1,r=0;++r<t&&(n*=256);)i+=this[e+r]*n;return i},l.prototype.readUIntBE=function(e,t,o){e|=0,t|=0,o||R(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,o){e|=0,t|=0,o||R(e,t,this.length);for(var i=this[e],n=1,r=0;++r<t&&(n*=256);)i+=this[e+r]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,o){e|=0,t|=0,o||R(e,t,this.length);for(var i=t,n=1,r=this[e+--i];i>0&&(n*=256);)r+=this[e+--i]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var o=this[e]|this[e+1]<<8;return 32768&o?4294901760|o:o},l.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var o=this[e+1]|this[e]<<8;return 32768&o?4294901760|o:o},l.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,o,i){if(e=+e,t|=0,o|=0,!i){var n=Math.pow(2,8*o)-1;D(this,e,t,o,n,0)}var r=1,s=0;for(this[t]=255&e;++s<o&&(r*=256);)this[t+s]=e/r&255;return t+o},l.prototype.writeUIntBE=function(e,t,o,i){if(e=+e,t|=0,o|=0,!i){var n=Math.pow(2,8*o)-1;D(this,e,t,o,n,0)}var r=o-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+o},l.prototype.writeUInt8=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,o,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*o-1);D(this,e,t,o,n-1,-n)}var r=0,s=1,a=0;for(this[t]=255&e;++r<o&&(s*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+o},l.prototype.writeIntBE=function(e,t,o,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*o-1);D(this,e,t,o,n-1,-n)}var r=o-1,s=1,a=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+o},l.prototype.writeInt8=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,o){return e=+e,t|=0,o||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,o){return B(this,e,t,!0,o)},l.prototype.writeFloatBE=function(e,t,o){return B(this,e,t,!1,o)},l.prototype.writeDoubleLE=function(e,t,o){return P(this,e,t,!0,o)},l.prototype.writeDoubleBE=function(e,t,o){return P(this,e,t,!1,o)},l.prototype.copy=function(e,t,o,i){if(o||(o=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<o&&(i=o),i===o)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-o&&(i=e.length-t+o);var n,r=i-o;if(this===e&&o<t&&t<i)for(n=r-1;n>=0;--n)e[n+t]=this[n+o];else if(r<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<r;++n)e[n+t]=this[n+o];else Uint8Array.prototype.set.call(e,this.subarray(o,o+r),t);return r},l.prototype.fill=function(e,t,o,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,o=this.length):"string"==typeof o&&(i=o,o=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<o)throw new RangeError("Out of range index");if(o<=t)return this;var r;if(t>>>=0,o=void 0===o?this.length:o>>>0,e||(e=0),"number"==typeof e)for(r=t;r<o;++r)this[r]=e;else{var s=l.isBuffer(e)?e:F(new l(e,i).toString()),a=s.length;for(r=0;r<o-t;++r)this[r+t]=s[r%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function F(e,t){var o;t=t||1/0;for(var i=e.length,n=null,r=[],s=0;s<i;++s){if((o=e.charCodeAt(s))>55295&&o<57344){if(!n){if(o>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&r.push(239,191,189);continue}n=o;continue}if(o<56320){(t-=3)>-1&&r.push(239,191,189),n=o;continue}o=65536+(n-55296<<10|o-56320)}else n&&(t-=3)>-1&&r.push(239,191,189);if(n=null,o<128){if((t-=1)<0)break;r.push(o)}else if(o<2048){if((t-=2)<0)break;r.push(o>>6|192,63&o|128)}else if(o<65536){if((t-=3)<0)break;r.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return r}function H(e){return o.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,o,i){for(var n=0;n<i&&!(n+o>=t.length||n>=e.length);++n)t[n+o]=e[n];return n}}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":4,ieee754:18,isarray:9}],9:[function(e,t,o){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],10:[function(e,t,o){function i(){var e;try{e=o.storage.debug}catch(e){}return e}(o=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},o.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" "),!t)return e;var o="color: "+this.color,i=0,n=0;return(e=[e[0],o,"color: inherit"].concat(Array.prototype.slice.call(e,1)))[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&"%c"===e&&(n=++i)}),e.splice(n,0,o),e},o.save=function(e){try{null==e?o.storage.removeItem("debug"):o.storage.debug=e}catch(e){}},o.load=i,o.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},o.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],o.formatters.j=function(e){return JSON.stringify(e)},o.enable(i())},{"./debug":11}],11:[function(e,t,o){(o=t.exports=function(e){function t(){}function n(){var e=n;null==e.useColors&&(e.useColors=o.useColors()),null==e.color&&e.useColors&&(e.color=o.colors[i++%o.colors.length]);var t=Array.prototype.slice.call(arguments);t[0]=o.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var r=0;t[0]=t[0].replace(/%([a-z%])/g,function(i,n){if("%%"===i)return i;r++;var s=o.formatters[n];if("function"==typeof s){var a=t[r];i=s.call(e,a),t.splice(r,1),r--}return i}),"function"==typeof o.formatArgs&&(t=o.formatArgs.apply(e,t));var s=n.log||o.log||console.log.bind(console);s.apply(e,t)}t.enabled=!1,n.enabled=!0;var r=o.enabled(e)?n:t;return r.namespace=e,r}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){o.enable("")},o.enable=function(e){o.save(e);for(var t=(e||"").split(/[\s,]+/),i=t.length,n=0;n<i;n++)t[n]&&("-"===(e=t[n].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")))},o.enabled=function(e){var t,i;for(t=0,i=o.skips.length;t<i;t++)if(o.skips[t].test(e))return!1;for(t=0,i=o.names.length;t<i;t++)if(o.names[t].test(e))return!0;return!1},o.names=[],o.skips=[],o.formatters={};var i=0},{}],12:[function(e,t,o){"use strict";var i=e("is-obj"),n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function s(e,t,o){var r=t[o];if(void 0!==r&&null!==r){if(n.call(e,o)&&(void 0===e[o]||null===e[o]))throw new TypeError("Cannot convert undefined or null to object ("+o+")");n.call(e,o)&&i(r)?e[o]=a(Object(e[o]),t[o]):e[o]=r}}function a(e,t){if(e===t)return e;for(var o in t=Object(t))n.call(t,o)&&s(e,t,o);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),a=0;a<i.length;a++)r.call(t,i[a])&&s(e,t,i[a]);return e}t.exports=function(e){e=function(e){if(null===e||void 0===e)throw new TypeError("Sources cannot be null or undefined");return Object(e)}(e);for(var t=1;t<arguments.length;t++)a(e,arguments[t]);return e}},{"is-obj":22}],13:[function(t,o,i){!function(t,o,i,n){"use strict";function r(e,t){for(var o=0,i=e.length;o<i;o++)f(e[o],t)}function s(e){return function(t){oe(t)&&(f(t,e),r(t.querySelectorAll(F),e))}}function a(e){var t=re.call(e,"is"),o=e.nodeName.toUpperCase(),i=j.call(P,t?O+t.toUpperCase():x+o);return t&&-1<i&&!l(o,t)?-1:i}function l(e,t){return-1<F.indexOf(e+'[is="'+t+'"]')}function c(e){var t=e.currentTarget,o=e.attrChange,i=e.attrName,n=e.target;fe&&(!n||n===t)&&t.attributeChangedCallback&&"style"!==i&&e.prevValue!==e.newValue&&t.attributeChangedCallback(i,o===e[C]?null:e.prevValue,o===e[L]?null:e.newValue)}function u(e){var t=s(e);return function(e){m.push(t,e.target)}}function h(e){pe&&(pe=!1,e.currentTarget.removeEventListener(R,h)),r((e.target||o).querySelectorAll(F),e.detail===S?S:A),te&&function(){for(var e,t=0,o=ie.length;t<o;t++)e=ie[t],H.contains(e)||(o--,ie.splice(t--,1),f(e,S))}()}function g(e,t){var o=this;se.call(o,e,t),y.call(o,{target:o})}function d(e,t){$(e,t),_?_.observe(e,ce):(de&&(e.setAttribute=g,e[M]=E(e),e.addEventListener(D,y)),e.addEventListener(I,c)),e.createdCallback&&fe&&(e.created=!0,e.createdCallback(),e.created=!1)}function p(e){throw new Error("A "+e+" type is already registered")}function f(e,t){var o,i=a(e);-1<i&&(T(e,U[i]),i=0,t!==A||e[A]?t===S&&!e[S]&&(e[A]=!1,e[S]=!0,i=1):(e[S]=!1,e[A]=!0,i=1,te&&j.call(ie,e)<0&&ie.push(e)),i&&(o=e[t+"Callback"])&&o.call(e))}if(!(n in o)){var m,y,v,E,_,T,b,M="__"+n+(1e5*Math.random()>>0),A="attached",S="detached",w="extends",C="ADDITION",N="MODIFICATION",L="REMOVAL",I="DOMAttrModified",R="DOMContentLoaded",D="DOMSubtreeModified",x="<",O="=",k=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,B=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],P=[],U=[],F="",H=o.documentElement,j=P.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},z=i.prototype,V=z.hasOwnProperty,G=z.isPrototypeOf,W=i.defineProperty,Y=i.getOwnPropertyDescriptor,X=i.getOwnPropertyNames,K=i.getPrototypeOf,Q=i.setPrototypeOf,q=!!i.__proto__,J=i.create||function e(t){return t?(e.prototype=t,new e):this},$=Q||(q?function(e,t){return e.__proto__=t,e}:X&&Y?function(){function e(e,t){for(var o,i=X(t),n=0,r=i.length;n<r;n++)o=i[n],V.call(e,o)||W(e,o,Y(t,o))}return function(t,o){do{e(t,o)}while((o=K(o))&&!G.call(o,t));return t}}():function(e,t){for(var o in t)e[o]=t[o];return e}),Z=t.MutationObserver||t.WebKitMutationObserver,ee=(t.HTMLElement||t.Element||t.Node).prototype,te=!G.call(ee,H),oe=te?function(e){return 1===e.nodeType}:function(e){return G.call(ee,e)},ie=te&&[],ne=ee.cloneNode,re=ee.getAttribute,se=ee.setAttribute,ae=ee.removeAttribute,le=o.createElement,ce=Z&&{attributes:!0,characterData:!0,attributeOldValue:!0},ue=Z||function(e){de=!1,H.removeEventListener(I,ue)},he=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,10)},ge=!1,de=!0,pe=!0,fe=!0;Q||q?(T=function(e,t){G.call(t,e)||d(e,t)},b=d):b=T=function(e,t){e[M]||(e[M]=i(!0),d(e,t))},te?(de=!1,function(){var t=Y(ee,"addEventListener"),o=t.value,i=function(e){var t=new CustomEvent(I,{bubbles:!0});t.attrName=e,t.prevValue=re.call(this,e),t.newValue=null,t[L]=t.attrChange=2,ae.call(this,e),this.dispatchEvent(t)},n=function(t,o){var i=this.hasAttribute(t),n=i&&re.call(this,t);e=new CustomEvent(I,{bubbles:!0}),se.call(this,t,o),e.attrName=t,e.prevValue=i?n:null,e.newValue=o,i?e[N]=e.attrChange=1:e[C]=e.attrChange=0,this.dispatchEvent(e)},r=function(e){var t,o=e.currentTarget,i=o[M],n=e.propertyName;i.hasOwnProperty(n)&&(i=i[n],(t=new CustomEvent(I,{bubbles:!0})).attrName=i.name,t.prevValue=i.value||null,t.newValue=i.value=o[n]||null,null==t.prevValue?t[C]=t.attrChange=0:t[N]=t.attrChange=1,o.dispatchEvent(t))};t.value=function(e,t,s){e===I&&this.attributeChangedCallback&&this.setAttribute!==n&&(this[M]={className:{name:"class",value:this.className}},this.setAttribute=n,this.removeAttribute=i,o.call(this,"propertychange",r)),o.call(this,e,t,s)},W(ee,"addEventListener",t)}()):Z||(H.addEventListener(I,ue),H.setAttribute(M,1),H.removeAttribute(M),de&&(y=function(e){var t,o,i,n=this;if(n===e.target){for(i in t=n[M],n[M]=o=E(n),o){if(!(i in t))return v(0,n,i,t[i],o[i],C);if(o[i]!==t[i])return v(1,n,i,t[i],o[i],N)}for(i in t)if(!(i in o))return v(2,n,i,t[i],o[i],L)}},v=function(e,t,o,i,n,r){var s={attrChange:e,currentTarget:t,attrName:o,prevValue:i,newValue:n};s[r]=e,c(s)},E=function(e){for(var t,o,i={},n=e.attributes,r=0,s=n.length;r<s;r++)t=n[r],"setAttribute"!==(o=t.name)&&(i[o]=t.value);return i})),o[n]=function(e,t){if(i=e.toUpperCase(),ge||(ge=!0,Z?(_=function(e,t){function o(e,t){for(var o=0,i=e.length;o<i;t(e[o++]));}return new Z(function(i){for(var n,r,s,a=0,l=i.length;a<l;a++)"childList"===(n=i[a]).type?(o(n.addedNodes,e),o(n.removedNodes,t)):(r=n.target,fe&&r.attributeChangedCallback&&"style"!==n.attributeName&&(s=re.call(r,n.attributeName))!==n.oldValue&&r.attributeChangedCallback(n.attributeName,n.oldValue,s))})}(s(A),s(S))).observe(o,{childList:!0,subtree:!0}):(m=[],he(function e(){for(;m.length;)m.shift().call(null,m.shift());he(e)}),o.addEventListener("DOMNodeInserted",u(A)),o.addEventListener("DOMNodeRemoved",u(S))),o.addEventListener(R,h),o.addEventListener("readystatechange",h),o.createElement=function(e,t){var i=le.apply(o,arguments),n=""+e,r=j.call(P,(t?O:x)+(t||n).toUpperCase()),s=-1<r;return t&&(i.setAttribute("is",t=t.toLowerCase()),s&&(s=l(n.toUpperCase(),t))),fe=!o.createElement.innerHTMLHelper,s&&b(i,U[r]),i},ee.cloneNode=function(e){var t=ne.call(this,!!e),o=a(t);return-1<o&&b(t,U[o]),e&&function(e){for(var t,o=0,i=e.length;o<i;o++)t=e[o],b(t,U[a(t)])}(t.querySelectorAll(F)),t}),-2<j.call(P,O+i)+j.call(P,x+i)&&p(e),!k.test(i)||-1<j.call(B,i))throw new Error("The type "+e+" is invalid");var i,n,c=function(){return d?o.createElement(f,i):o.createElement(f)},g=t||z,d=V.call(g,w),f=d?t[w].toUpperCase():i;return d&&-1<j.call(P,x+f)&&p(f),n=P.push((d?O:x)+i)-1,F=F.concat(F.length?",":"",d?f+'[is="'+e.toLowerCase()+'"]':f),c.prototype=U[n]=V.call(g,"prototype")?g.prototype:J(ee),r(o.querySelectorAll(F),A),c}}}(window,document,Object,"registerElement")},{}],14:[function(e,t,o){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],15:[function(e,t,o){var i=e("dtype");t.exports=function(e,t,o){if(!e)throw new TypeError("must specify data as first parameter");if(o=0|+(o||0),Array.isArray(e)&&Array.isArray(e[0])){var n=e[0].length,r=e.length*n;t&&"string"!=typeof t||(t=new(i(t||"float32"))(r+o));var s=t.length-o;if(r!==s)throw new Error("source length "+r+" ("+n+"x"+e.length+") does not match destination length "+s);for(var a=0,l=o;a<e.length;a++)for(var c=0;c<n;c++)t[l++]=e[a][c]}else if(t&&"string"!=typeof t)t.set(e,o);else{var u=i(t||"float32");0===o?t=new u(e):(t=new u(e.length+o)).set(e,o)}return t}},{dtype:14}],16:[function(e,t,o){var i=e("is-function");t.exports=function(e,t,o){if(!i(t))throw new TypeError("iterator must be a function");arguments.length<3&&(o=this),"[object Array]"===n.call(e)?function(e,t,o){for(var i=0,n=e.length;i<n;i++)r.call(e,i)&&t.call(o,e[i],i,e)}(e,t,o):"string"==typeof e?function(e,t,o){for(var i=0,n=e.length;i<n;i++)t.call(o,e.charAt(i),i,e)}(e,t,o):function(e,t,o){for(var i in e)r.call(e,i)&&t.call(o,e[i],i,e)}(e,t,o)};var n=Object.prototype.toString,r=Object.prototype.hasOwnProperty},{"is-function":21}],17:[function(e,t,i){(function(e){var o;o="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=o}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t,o){o.read=function(e,t,o,i,n){var r,s,a=8*n-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=o?n-1:0,g=o?-1:1,d=e[t+h];for(h+=g,r=d&(1<<-u)-1,d>>=-u,u+=a;u>0;r=256*r+e[t+h],h+=g,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=i;u>0;s=256*s+e[t+h],h+=g,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,i),r-=c}return(d?-1:1)*s*Math.pow(2,r-i)},o.write=function(e,t,o,i,n,r){var s,a,l,c=8*r-n-1,u=(1<<c)-1,h=u>>1,g=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:r-1,p=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?g/l:g*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,n),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;e[o+d]=255&a,d+=p,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;e[o+d]=255&s,d+=p,s/=256,c-=8);e[o+d-p]|=128*f}},{}],19:[function(e,t,o){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}},{}],20:[function(e,t,o){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(i(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],21:[function(e,t,o){t.exports=function(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var i=Object.prototype.toString},{}],22:[function(e,t,o){"use strict";t.exports=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}},{}],23:[function(e,t,o){var i=e("word-wrapper"),n=e("xtend"),r=e("as-number"),s=["x","e","a","o","n","s","r","c","u","m","v","w","z"],a=["m","w"],l=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],c="\t".charCodeAt(0),u=" ".charCodeAt(0),h=0,g=1,d=2;function p(e){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(e)}function f(e,t){if(!e.chars||0===e.chars.length)return null;var o=y(e.chars,t);return o>=0?e.chars[o]:null}function m(e,t,o){if(!e.kernings||0===e.kernings.length)return 0;for(var i=e.kernings,n=0;n<i.length;n++){var r=i[n];if(r.first===t&&r.second===o)return r.amount}return 0}function y(e,t,o){for(var i=o=o||0;i<e.length;i++)if(e[i].id===t)return i;return-1}t.exports=function(e){return new p(e)},p.prototype.update=function(e){if(e=n({measure:this._measure},e),this._opt=e,this._opt.tabSize=r(this._opt.tabSize,4),!e.font)throw new Error("must provide a valid bitmap font");var t=this.glyphs,o=e.text||"",a=e.font;this._setupSpaceGlyphs(a);var c=i.lines(o,e),u=e.width||0;t.length=0;var p=c.reduce(function(e,t){return Math.max(e,t.width,u)},0),f=0,v=0,E=r(e.lineHeight,a.common.lineHeight),_=a.common.base,T=E-_,b=e.letterSpacing||0,M=E*c.length-T,A=function(e){return"center"===e?g:"right"===e?d:h}(this._opt.align);v-=M,this._width=p,this._height=M,this._descender=E-_,this._baseline=_,this._xHeight=function(e){for(var t=0;t<s.length;t++){var o=s[t].charCodeAt(0),i=y(e.chars,o);if(i>=0)return e.chars[i].height}return 0}(a),this._capHeight=function(e){for(var t=0;t<l.length;t++){var o=l[t].charCodeAt(0),i=y(e.chars,o);if(i>=0)return e.chars[i].height}return 0}(a),this._lineHeight=E,this._ascender=E-T-this._xHeight;var S=this;c.forEach(function(e,i){for(var n,r=e.start,s=e.end,l=e.width,c=r;c<s;c++){var u=o.charCodeAt(c),h=S.getGlyph(a,u);if(h){n&&(f+=m(a,n.id,h.id));var y=f;A===g?y+=(p-l)/2:A===d&&(y+=p-l),t.push({position:[y,v],data:h,index:c,line:i}),f+=h.xadvance+b,n=h}}v+=E,f=0}),this._linesTotal=c.length},p.prototype._setupSpaceGlyphs=function(e){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,e.chars&&0!==e.chars.length){var t=f(e,u)||function(e){for(var t=0;t<a.length;t++){var o=a[t].charCodeAt(0),i=y(e.chars,o);if(i>=0)return e.chars[i]}return 0}(e)||e.chars[0],o=this._opt.tabSize*t.xadvance;this._fallbackSpaceGlyph=t,this._fallbackTabGlyph=n(t,{x:0,y:0,xadvance:o,id:c,xoffset:0,yoffset:0,width:0,height:0})}},p.prototype.getGlyph=function(e,t){var o=f(e,t);return o||(t===c?this._fallbackTabGlyph:t===u?this._fallbackSpaceGlyph:null)},p.prototype.computeMetrics=function(e,t,o,i){var n,r=this._opt.letterSpacing||0,s=this._opt.font,a=0,l=0,c=0;if(!s.chars||0===s.chars.length)return{start:t,end:t,width:0};o=Math.min(e.length,o);for(var u=t;u<o;u++){var h=e.charCodeAt(u),g=this.getGlyph(s,h);if(g){g.xoffset;var d=n?m(s,n.id,g.id):0,p=(a+=d)+g.xadvance+r,f=a+g.width;if(f>=i||p>=i)break;a=p,l=f,n=g}c++}return n&&(l+=n.xoffset),{start:t,end:t+c,width:l}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(e){Object.defineProperty(p.prototype,e,{get:function(e){return new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()}(e),configurable:!0})})},{"as-number":3,"word-wrapper":72,xtend:75}],24:[function(e,t,o){(function(o){var i=e("xhr"),n=function(){},r=e("parse-bmfont-ascii"),s=e("parse-bmfont-xml"),a=e("parse-bmfont-binary"),l=e("./lib/is-binary"),c=e("xtend"),u=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;t.exports=function(e,t){t="function"==typeof t?t:n,"string"==typeof e?e={uri:e}:e||(e={});var h=e.binary;h&&(e=function(e){if(u)return c(e,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;return t.overrideMimeType("text/plain; charset=x-user-defined"),c({xhr:t},e)}(e)),i(e,function(i,c,u){if(i)return t(i);if(!/^2/.test(c.statusCode))return t(new Error("http status code: "+c.statusCode));if(!u)return t(new Error("no body result"));var h,g,d=!1;if(h=u,"[object ArrayBuffer]"===Object.prototype.toString.call(h)){var p=new Uint8Array(u);u=new o(p,"binary")}l(u)&&(d=!0,"string"==typeof u&&(u=new o(u,"binary"))),d||(o.isBuffer(u)&&(u=u.toString(e.encoding)),u=u.trim());try{var f=c.headers["content-type"];g=d?a(u):/json/.test(f)||"{"===u.charAt(0)?JSON.parse(u):/xml/.test(f)||"<"===u.charAt(0)?s(u):r(u)}catch(e){t(new Error("error parsing font "+e.message)),t=n}t(null,g)})}}).call(this,e("buffer").Buffer)},{"./lib/is-binary":25,buffer:8,"parse-bmfont-ascii":27,"parse-bmfont-binary":28,"parse-bmfont-xml":29,xhr:73,xtend:75}],25:[function(e,t,o){(function(o){var i=e("buffer-equal"),n=new o([66,77,70,3]);t.exports=function(e){return"string"==typeof e?"BMF"===e.substring(0,3):e.length>4&&i(e.slice(0,4),n)}}).call(this,e("buffer").Buffer)},{buffer:8,"buffer-equal":7}],26:[function(e,t,o){"use strict";var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},o=0;o<10;o++)t["_"+String.fromCharCode(o)]=o;var i=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==i.join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var o,s,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(a[c]=o[c]);if(i){s=i(o);for(var u=0;u<s.length;u++)r.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a}},{}],27:[function(e,t,o){function i(e,t){if(!(e=e.replace(/\t+/g," ").trim()))return null;var o=e.indexOf(" ");if(-1===o)throw new Error("no named row at line "+t);var i=e.substring(0,o);e=(e=(e=(e=e.substring(o+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var r=[],s=0;s<e.length;s++){var a=e[s];0===s?r.push({key:a[0],data:""}):s===e.length-1?r[r.length-1].data=n(a[0]):(r[r.length-1].data=n(a[0]),r.push({key:a[1],data:""}))}var l={key:i,data:{}};return r.forEach(function(e){l.data[e.key]=e.data}),l}function n(e){return e&&0!==e.length?0===e.indexOf('"')||0===e.indexOf("'")?e.substring(1,e.length-1):-1!==e.indexOf(",")?function(e){return e.split(",").map(function(e){return parseInt(e,10)})}(e):parseInt(e,10):""}t.exports=function(e){if(!e)throw new Error("no data provided");var t={pages:[],chars:[],kernings:[]},o=(e=e.toString().trim()).split(/\r\n?|\n/g);if(0===o.length)throw new Error("no data in BMFont file");for(var n=0;n<o.length;n++){var r=i(o[n],n);if(r)if("page"===r.key){if("number"!=typeof r.data.id)throw new Error("malformed file at line "+n+" -- needs page id=N");if("string"!=typeof r.data.file)throw new Error("malformed file at line "+n+' -- needs page file="path"');t.pages[r.data.id]=r.data.file}else"chars"===r.key||"kernings"===r.key||("char"===r.key?t.chars.push(r.data):"kerning"===r.key?t.kernings.push(r.data):t[r.key]=r.data)}return t}},{}],28:[function(e,t,o){var i=[66,77,70];function n(e,t,o){if(o>t.length-1)return 0;var i=t.readUInt8(o++),n=t.readInt32LE(o);switch(o+=4,i){case 1:e.info=function(e,t){var o={};o.size=e.readInt16LE(t);var i=e.readUInt8(t+2);return o.smooth=i>>7&1,o.unicode=i>>6&1,o.italic=i>>5&1,o.bold=i>>4&1,i>>3&1&&(o.fixedHeight=1),o.charset=e.readUInt8(t+3)||"",o.stretchH=e.readUInt16LE(t+4),o.aa=e.readUInt8(t+6),o.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)],o.spacing=[e.readInt8(t+11),e.readInt8(t+12)],o.outline=e.readUInt8(t+13),o.face=function(e,t){return r(e,t).toString("utf8")}(e,t+14),o}(t,o);break;case 2:e.common=function(e,t){var o={};return o.lineHeight=e.readUInt16LE(t),o.base=e.readUInt16LE(t+2),o.scaleW=e.readUInt16LE(t+4),o.scaleH=e.readUInt16LE(t+6),o.pages=e.readUInt16LE(t+8),e.readUInt8(t+10),o.packed=0,o.alphaChnl=e.readUInt8(t+11),o.redChnl=e.readUInt8(t+12),o.greenChnl=e.readUInt8(t+13),o.blueChnl=e.readUInt8(t+14),o}(t,o);break;case 3:e.pages=function(e,t,o){for(var i=[],n=r(e,t),s=n.length+1,a=o/s,l=0;l<a;l++)i[l]=e.slice(t,t+n.length).toString("utf8"),t+=s;return i}(t,o,n);break;case 4:e.chars=function(e,t,o){for(var i=[],n=o/20,r=0;r<n;r++){var s={},a=20*r;s.id=e.readUInt32LE(t+0+a),s.x=e.readUInt16LE(t+4+a),s.y=e.readUInt16LE(t+6+a),s.width=e.readUInt16LE(t+8+a),s.height=e.readUInt16LE(t+10+a),s.xoffset=e.readInt16LE(t+12+a),s.yoffset=e.readInt16LE(t+14+a),s.xadvance=e.readInt16LE(t+16+a),s.page=e.readUInt8(t+18+a),s.chnl=e.readUInt8(t+19+a),i[r]=s}return i}(t,o,n);break;case 5:e.kernings=function(e,t,o){for(var i=[],n=o/10,r=0;r<n;r++){var s={},a=10*r;s.first=e.readUInt32LE(t+0+a),s.second=e.readUInt32LE(t+4+a),s.amount=e.readInt16LE(t+8+a),i[r]=s}return i}(t,o,n)}return 5+n}function r(e,t){for(var o=t;o<e.length&&0!==e[o];o++);return e.slice(t,o)}t.exports=function(e){if(e.length<6)throw new Error("invalid buffer length for BMFont");var t=i.every(function(t,o){return e.readUInt8(o)===t});if(!t)throw new Error("BMFont missing BMF byte header");var o=3,r=e.readUInt8(o++);if(r>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var s={kernings:[],chars:[]},a=0;a<5;a++)o+=n(s,e,o);return s}},{}],29:[function(e,t,o){var i=e("./parse-attribs"),n=e("xml-parse-from-string"),r={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function s(e){var t=function(e){for(var t=[],o=0;o<e.attributes.length;o++)t.push(e.attributes[o]);return t}(e);return t.reduce(function(e,t){var o,i=(o=t.nodeName,r[o.toLowerCase()]||o);return e[i]=t.nodeValue,e},{})}t.exports=function(e){e=e.toString();var t=n(e),o={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(e){var n=t.getElementsByTagName(e)[0];n&&(o[e]=i(s(n)))});var r=t.getElementsByTagName("pages")[0];if(!r)throw new Error("malformed file -- no <pages> element");for(var a=r.getElementsByTagName("page"),l=0;l<a.length;l++){var c=a[l],u=parseInt(c.getAttribute("id"),10),h=c.getAttribute("file");if(isNaN(u))throw new Error('malformed file -- page "id" attribute is NaN');if(!h)throw new Error('malformed file -- needs page "file" attribute');o.pages[parseInt(u,10)]=h}return["chars","kernings"].forEach(function(e){var n=t.getElementsByTagName(e)[0];if(n)for(var r=e.substring(0,e.length-1),a=n.getElementsByTagName(r),l=0;l<a.length;l++){var c=a[l];o[e].push(i(s(c)))}}),o}},{"./parse-attribs":30,"xml-parse-from-string":74}],30:[function(e,t,o){t.exports=function(e){for(var t in"chasrset"in e&&(e.charset=e.chasrset,delete e.chasrset),e)"face"!==t&&"charset"!==t&&(e[t]="padding"===t||"spacing"===t?e[t].split(",").map(function(e){return parseInt(e,10)}):parseInt(e[t],10));return e}},{}],31:[function(e,t,o){var i=e("trim"),n=e("for-each");t.exports=function(e){if(!e)return{};var t={};return n(i(e).split("\n"),function(e){var o,n=e.indexOf(":"),r=i(e.slice(0,n)).toLowerCase(),s=i(e.slice(n+1));void 0===t[r]?t[r]=s:(o=t[r],"[object Array]"===Object.prototype.toString.call(o)?t[r].push(s):t[r]=[t[r],s])}),t}},{"for-each":16,trim:46}],32:[function(e,t,o){(function(e){function t(e,t){for(var o=0,i=e.length-1;i>=0;i--){var n=e[i];"."===n?e.splice(i,1):".."===n?(e.splice(i,1),o++):o&&(e.splice(i,1),o--)}if(t)for(;o--;o)e.unshift("..");return e}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(e){return i.exec(e).slice(1)};function r(e,t){if(e.filter)return e.filter(t);for(var o=[],i=0;i<e.length;i++)t(e[i],i,e)&&o.push(e[i]);return o}o.resolve=function(){for(var o="",i=!1,n=arguments.length-1;n>=-1&&!i;n--){var s=n>=0?arguments[n]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(o=s+"/"+o,i="/"===s.charAt(0))}return o=t(r(o.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+o||"."},o.normalize=function(e){var i=o.isAbsolute(e),n="/"===s(e,-1);return(e=t(r(e.split("/"),function(e){return!!e}),!i).join("/"))||i||(e="."),e&&n&&(e+="/"),(i?"/":"")+e},o.isAbsolute=function(e){return"/"===e.charAt(0)},o.join=function(){var e=Array.prototype.slice.call(arguments,0);return o.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},o.relative=function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var o=e.length-1;o>=0&&""===e[o];o--);return t>o?[]:e.slice(t,o-t+1)}e=o.resolve(e).substr(1),t=o.resolve(t).substr(1);for(var n=i(e.split("/")),r=i(t.split("/")),s=Math.min(n.length,r.length),a=s,l=0;l<s;l++)if(n[l]!==r[l]){a=l;break}for(var c=[],l=a;l<n.length;l++)c.push("..");return(c=c.concat(r.slice(a))).join("/")},o.sep="/",o.delimiter=":",o.dirname=function(e){var t=n(e),o=t[0],i=t[1];return o||i?(i&&(i=i.substr(0,i.length-1)),o+i):"."},o.basename=function(e,t){var o=n(e)[2];return t&&o.substr(-1*t.length)===t&&(o=o.substr(0,o.length-t.length)),o},o.extname=function(e){return n(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,o){return e.substr(t,o)}:function(e,t,o){return t<0&&(t=e.length+t),e.substr(t,o)}}).call(this,e("_process"))},{_process:6}],33:[function(e,t,i){(function(e){var o=e.performance||{},i=function(){for(var e=["now","webkitNow","msNow","mozNow","oNow"];e.length;){var t=e.shift();if(t in o)return o[t].bind(o)}var i=Date.now||function(){return(new Date).getTime()},n=(o.timing||{}).navigationStart||i();return function(){return i()-n}}();i.performanceNow=o.now,i.noConflict=function(){o.now=i.performanceNow},i.conflict=function(){o.now=i},i.conflict(),t.exports=i}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,t,o){!function(e){var o=setTimeout,n="function"==typeof i&&i||function(e){o(e,1)};function r(e,t){return function(){e.apply(t,arguments)}}var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],g(e,r(c,this),r(u,this))}function l(e){var t=this;null!==this._state?n(function(){var o=t._state?e.onFulfilled:e.onRejected;if(null!==o){var i;try{i=o(t._value)}catch(t){return void e.reject(t)}e.resolve(i)}else(t._state?e.resolve:e.reject)(t._value)}):this._deferreds.push(e)}function c(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void g(r(t,e),r(c,this),r(u,this))}this._state=!0,this._value=e,h.call(this)}catch(e){u.call(this,e)}}function u(e){this._state=!1,this._value=e,h.call(this)}function h(){for(var e=0,t=this._deferreds.length;e<t;e++)l.call(this,this._deferreds[e]);this._deferreds=null}function g(e,t,o){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,o(e))})}catch(e){if(i)return;i=!0,o(e)}}a.prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var o=this;return new a(function(i,n){l.call(o,new function(e,t,o,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=o,this.reject=i}(e,t,i,n))})},a.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&s(arguments[0])?arguments[0]:arguments);return new a(function(t,o){if(0===e.length)return t([]);var i=e.length;function n(r,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){n(r,e)},o)}e[r]=s,0==--i&&t(e)}catch(e){o(e)}}for(var r=0;r<e.length;r++)n(r,e[r])})},a.resolve=function(e){return e&&"object"==typeof e&&e.constructor===a?e:new a(function(t){t(e)})},a.reject=function(e){return new a(function(t,o){o(e)})},a.race=function(e){return new a(function(t,o){for(var i=0,n=e.length;i<n;i++)e[i].then(t,o)})},a._setImmediateFn=function(e){n=e},void 0!==t&&t.exports?t.exports=a:e.Promise||(e.Promise=a)}(this)},{}],35:[function(e,t,o){var i=e("dtype"),n=e("an-array"),r=e("is-buffer"),s=[0,2,3],a=[2,1,3];t.exports=function(e,t){e&&(n(e)||r(e))||(t=e||{},e=null);for(var o="string"==typeof(t="number"==typeof t?{count:t}:t||{}).type?t.type:"uint16",l="number"==typeof t.count?t.count:1,c=t.start||0,u=!1!==t.clockwise?s:a,h=u[0],g=u[1],d=u[2],p=6*l,f=e||new(i(o))(p),m=0,y=0;m<p;m+=6,y+=4){var v=m+c;f[v+0]=y+0,f[v+1]=y+1,f[v+2]=y+2,f[v+3]=y+h,f[v+4]=y+g,f[v+5]=y+d}return f}},{"an-array":2,dtype:14,"is-buffer":20}],36:[function(e,t,o){function i(e,t){var o=(t=t||{}).preserveNumbers,i={};return function(e){for(var t,o=[],i=0,n=/url\([^\)]+$/,r="";i<e.length;)-1===(t=e.indexOf(";",i))&&(t=e.length),r+=e.substring(i,t),n.test(r)?(r+=";",i=t+1):(o.push(r),r="",i=t+1);return o}(e).map(function(e){return e.trim()}).filter(Boolean).forEach(function(e){var t,n=e.indexOf(":"),r=e.substr(0,n).trim(),s=e.substr(n+1).trim();o&&(t=s,!isNaN(parseFloat(t))&&isFinite(t))&&(s=Number(s)),i[r]=s}),i}function n(e){return Object.keys(e).map(function(t){return t+":"+e[t]}).join(";")}t.exports.parse=i,t.exports.stringify=n,t.exports.normalize=function(e,t){return n(i(e,t))}},{}],37:[function(e,t,o){var i=e("layout-bmfont-text"),n=e("inherits"),r=e("quad-indices"),s=e("three-buffer-vertex-data"),a=e("object-assign"),l=e("./lib/vertices"),c=e("./lib/utils"),u=THREE.BufferGeometry;function h(e){u.call(this),"string"==typeof e&&(e={text:e}),this._opt=a({},e),e&&this.update(e)}t.exports=function(e){return new h(e)},n(h,u),h.prototype.update=function(e){if("string"==typeof e&&(e={text:e}),!(e=a({},this._opt,e)).font)throw new TypeError("must specify a { font } in options");this.layout=i(e);var t=!1!==e.flipY,o=e.font,n=o.common.scaleW,c=o.common.scaleH,u=this.layout.glyphs.filter(function(e){var t=e.data;return t.width*t.height>0});this.visibleGlyphs=u;var h=l.positions(u),g=l.uvs(u,n,c,t),d=r({clockwise:!0,type:"uint16",count:u.length});if(s.index(this,d,1,"uint16"),s.attr(this,"position",h,2),s.attr(this,"uv",g,2),!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var p=l.pages(u);s.attr(this,"page",p,1)}},h.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array,t=this.attributes.position.itemSize;if(!e||!t||e.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);c.computeSphere(e,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},h.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox,t=this.attributes.position.array,o=this.attributes.position.itemSize;!t||!o||t.length<2?e.makeEmpty():c.computeBox(t,e)}},{"./lib/utils":38,"./lib/vertices":39,inherits:19,"layout-bmfont-text":23,"object-assign":26,"quad-indices":35,"three-buffer-vertex-data":40}],38:[function(e,t,o){var i=2,n={min:[0,0],max:[0,0]};function r(e){var t=e.length/i;n.min[0]=e[0],n.min[1]=e[1],n.max[0]=e[0],n.max[1]=e[1];for(var o=0;o<t;o++){var r=e[o*i+0],s=e[o*i+1];n.min[0]=Math.min(r,n.min[0]),n.min[1]=Math.min(s,n.min[1]),n.max[0]=Math.max(r,n.max[0]),n.max[1]=Math.max(s,n.max[1])}}t.exports.computeBox=function(e,t){r(e),t.min.set(n.min[0],n.min[1],0),t.max.set(n.max[0],n.max[1],0)},t.exports.computeSphere=function(e,t){r(e);var o=n.min[0],i=n.min[1],s=n.max[0],a=n.max[1],l=s-o,c=a-i,u=Math.sqrt(l*l+c*c);t.center.set(o+l/2,i+c/2,0),t.radius=u/2}},{}],39:[function(e,t,o){t.exports.pages=function(e){var t=new Float32Array(4*e.length*1),o=0;return e.forEach(function(e){var i=e.data.page||0;t[o++]=i,t[o++]=i,t[o++]=i,t[o++]=i}),t},t.exports.uvs=function(e,t,o,i){var n=new Float32Array(4*e.length*2),r=0;return e.forEach(function(e){var s=e.data,a=s.x+s.width,l=s.y+s.height,c=s.x/t,u=s.y/o,h=a/t,g=l/o;i&&(u=(o-s.y)/o,g=(o-l)/o),n[r++]=c,n[r++]=u,n[r++]=c,n[r++]=g,n[r++]=h,n[r++]=g,n[r++]=h,n[r++]=u}),n},t.exports.positions=function(e){var t=new Float32Array(4*e.length*2),o=0;return e.forEach(function(e){var i=e.data,n=e.position[0]+i.xoffset,r=e.position[1]+i.yoffset,s=i.width,a=i.height;t[o++]=n,t[o++]=r,t[o++]=n,t[o++]=r+a,t[o++]=n+s,t[o++]=r+a,t[o++]=n+s,t[o++]=r}),t}},{}],40:[function(e,t,o){var i=e("flatten-vertex-data"),n=!1;function r(e,t,o,r){if(t=t||[],!e||function(e,t,o){if(e.itemSize!==o)return!0;if(!e.array)return!0;var i=e.array.length;return Array.isArray(t)&&Array.isArray(t[0])?i!==t.length*o:i!==t.length}(e,t,o)){t=i(t,r);var s=e&&"function"!=typeof e.setArray;return e&&!s||(s&&!n&&(n=!0,console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))),e=new THREE.BufferAttribute(t,o)),e.itemSize=o,e.needsUpdate=!0,"function"==typeof e.setArray&&e.setArray(t),e}return i(t,e.array),e.needsUpdate=!0,null}t.exports.attr=function(e,t,o,i,n){if("number"!=typeof i&&(i=3),"string"!=typeof n&&(n="float32"),Array.isArray(o)&&Array.isArray(o[0])&&o[0].length!==i)throw new Error("Nested vertex array has unexpected size; expected "+i+" but found "+o[0].length);var s=r(e.getAttribute(t),o,i,n);s&&e.addAttribute(t,s)},t.exports.index=function(e,t,o,i){"number"!=typeof o&&(o=1),"string"!=typeof i&&(i="uint16");var n=!e.index&&"function"!=typeof e.setIndex,s=r(n?e.getAttribute("index"):e.index,t,o,i);s&&(n?e.addAttribute("index",s):e.index=s)}},{"flatten-vertex-data":15}],41:[function(e,t,o){var i;i=this,function(e){"use strict";function t(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(void 0!==i&&null!==i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var o=this._listeners;void 0===o[e]&&(o[e]=[]),-1===o[e].indexOf(t)&&o[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var o=this._listeners;return void 0!==o[e]&&-1!==o[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var o=this._listeners,i=o[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,o=t[e.type];if(void 0!==o){e.target=this;for(var i=o.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}});var o,i,n,r,s,a,l="87",c=0,u=1,h=2,g=0,d=1,p=2,f=0,m=1,y=2,v=0,E=1,_=2,T=0,b=1,M=2,A=3,S=4,w=5,C=100,N=101,L=102,I=103,R=104,D=200,x=201,O=202,k=203,B=204,P=205,U=206,F=207,H=208,j=209,z=210,V=0,G=1,W=2,Y=3,X=4,K=5,Q=6,q=7,J=0,$=1,Z=2,ee=0,te=1,oe=2,ie=3,ne=4,re=301,se=302,ae=303,le=304,ce=305,ue=306,he=307,ge=1e3,de=1001,pe=1002,fe=1003,me=1004,ye=1005,ve=1006,Ee=1007,_e=1008,Te=1009,be=1010,Me=1011,Ae=1012,Se=1013,we=1014,Ce=1015,Ne=1016,Le=1017,Ie=1018,Re=1019,De=1020,xe=1021,Oe=1022,ke=1023,Be=1024,Pe=1025,Ue=ke,Fe=1026,He=1027,je=2001,ze=2002,Ve=2003,Ge=2004,We=2100,Ye=2101,Xe=2102,Ke=2103,Qe=2151,qe=2201,Je=2400,$e=0,Ze=1,et=2,tt=3e3,ot=3001,it=3007,nt=3002,rt=3004,st=3005,at=3006,lt=3200,ct=3201,ut={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),r=0,function(){for(var e=0;e<36;e++)8===e||13===e||18===e||23===e?n[e]="-":14===e?n[e]="4":(r<=2&&(r=33554432+16777216*Math.random()|0),o=15&r,r>>=4,n[e]=i[19===e?3&o|8:o]);return n.join("")}),clamp:function(e,t,o){return Math.max(t,Math.min(o,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,o,i,n){return i+(e-t)*(n-i)/(o-t)},lerp:function(e,t,o){return(1-o)*e+o*t},smoothstep:function(e,t,o){return e<=t?0:e>=o?1:(e=(e-t)/(o-t))*e*(3-2*e)},smootherstep:function(e,t,o){return e<=t?0:e>=o?1:(e=(e-t)/(o-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*ut.DEG2RAD},radToDeg:function(e){return e*ut.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}};function ht(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(ht.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(ht.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(s=new ht,a=new ht,function(e,t){return s.set(e,e),a.set(t,t),this.clamp(s,a)}),clampLength:function(e,t){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,o=this.y-e.y;return t*t+o*o},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,o){return this.subVectors(t,e).multiplyScalar(o).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,o){return void 0!==o&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var o=Math.cos(t),i=Math.sin(t),n=this.x-e.x,r=this.y-e.y;return this.x=n*o-r*i+e.x,this.y=n*i+r*o+e.y,this}});var gt,dt,pt,ft,mt,yt,vt=0;function Et(e,t,o,i,n,r,s,a,l,c){Object.defineProperty(this,"id",{value:vt++}),this.uuid=ut.generateUUID(),this.name="",this.image=void 0!==e?e:Et.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Et.DEFAULT_MAPPING,this.wrapS=void 0!==o?o:de,this.wrapT=void 0!==i?i:de,this.magFilter=void 0!==n?n:ve,this.minFilter=void 0!==r?r:_e,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:ke,this.type=void 0!==a?a:Te,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:tt,this.version=0,this.onUpdate=null}function _t(e,t,o,i){this.x=e||0,this.y=t||0,this.z=o||0,this.w=void 0!==i?i:1}function Tt(e,t,o){this.uuid=ut.generateUUID(),this.width=e,this.height=t,this.scissor=new _t(0,0,e,t),this.scissorTest=!1,this.viewport=new _t(0,0,e,t),void 0===(o=o||{}).minFilter&&(o.minFilter=ve),this.texture=new Et(void 0,void 0,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),this.depthBuffer=void 0===o.depthBuffer||o.depthBuffer,this.stencilBuffer=void 0===o.stencilBuffer||o.stencilBuffer,this.depthTexture=void 0!==o.depthTexture?o.depthTexture:null}function bt(e,t,o){Tt.call(this,e,t,o),this.activeCubeFace=0,this.activeMipMapLevel=0}function Mt(e,t,o,i){this._x=e||0,this._y=t||0,this._z=o||0,this._w=void 0!==i?i:1}function At(e,t,o){this.x=e||0,this.y=t||0,this.z=o||0}function St(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function wt(e,t,o,i,n,r,s,a,l,c,u,h){Et.call(this,null,r,s,a,l,c,i,n,u,h),this.image={data:e,width:t,height:o},this.magFilter=void 0!==l?l:fe,this.minFilter=void 0!==c?c:fe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Ct(e,t,o,i,n,r,s,a,l,c){e=void 0!==e?e:[],t=void 0!==t?t:re,Et.call(this,e,t,o,i,n,r,s,a,l,c),this.flipY=!1}Et.DEFAULT_IMAGE=void 0,Et.DEFAULT_MAPPING=300,Object.defineProperty(Et.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Et.prototype,t.prototype,{constructor:Et,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var o=this.image;void 0===o.uuid&&(o.uuid=ut.generateUUID()),void 0===e.images[o.uuid]&&(e.images[o.uuid]={uuid:o.uuid,url:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var o=t.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(o)}),t.image=o.uuid}return e.textures[this.uuid]=t,t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||e.x>1)switch(this.wrapS){case ge:e.x=e.x-Math.floor(e.x);break;case de:e.x=e.x<0?0:1;break;case pe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ge:e.y=e.y-Math.floor(e.y);break;case de:e.y=e.y<0?0:1;break;case pe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(_t.prototype,{isVector4:!0,set:function(e,t,o,i){return this.x=e,this.y=t,this.z=o,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,o=this.y,i=this.z,n=this.w,r=e.elements;return this.x=r[0]*t+r[4]*o+r[8]*i+r[12]*n,this.y=r[1]*t+r[5]*o+r[9]*i+r[13]*n,this.z=r[2]*t+r[6]*o+r[10]*i+r[14]*n,this.w=r[3]*t+r[7]*o+r[11]*i+r[15]*n,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,o,i,n,r=e.elements,s=r[0],a=r[4],l=r[8],c=r[1],u=r[5],h=r[9],g=r[2],d=r[6],p=r[10];if(Math.abs(a-c)<.01&&Math.abs(l-g)<.01&&Math.abs(h-d)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+g)<.1&&Math.abs(h+d)<.1&&Math.abs(s+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var f=(s+1)/2,m=(u+1)/2,y=(p+1)/2,v=(a+c)/4,E=(l+g)/4,_=(h+d)/4;return f>m&&f>y?f<.01?(o=0,i=.707106781,n=.707106781):(o=Math.sqrt(f),i=v/o,n=E/o):m>y?m<.01?(o=.707106781,i=0,n=.707106781):(i=Math.sqrt(m),o=v/i,n=_/i):y<.01?(o=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),o=E/n,i=_/n),this.set(o,i,n,t),this}var T=Math.sqrt((d-h)*(d-h)+(l-g)*(l-g)+(c-a)*(c-a));return Math.abs(T)<.001&&(T=1),this.x=(d-h)/T,this.y=(l-g)/T,this.z=(c-a)/T,this.w=Math.acos((s+u+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(o,i){return void 0===e&&(e=new _t,t=new _t),e.set(o,o,o,o),t.set(i,i,i,i),this.clamp(e,t)}}(),clampLength:function(e,t){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,o){return this.subVectors(t,e).multiplyScalar(o).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,o){return void 0!==o&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(Tt.prototype,t.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),bt.prototype=Object.create(Tt.prototype),bt.prototype.constructor=bt,bt.prototype.isWebGLRenderTargetCube=!0,Object.assign(Mt,{slerp:function(e,t,o,i){return o.copy(e).slerp(t,i)},slerpFlat:function(e,t,o,i,n,r,s){var a=o[i+0],l=o[i+1],c=o[i+2],u=o[i+3],h=n[r+0],g=n[r+1],d=n[r+2],p=n[r+3];if(u!==p||a!==h||l!==g||c!==d){var f=1-s,m=a*h+l*g+c*d+u*p,y=m>=0?1:-1,v=1-m*m;if(v>Number.EPSILON){var E=Math.sqrt(v),_=Math.atan2(E,m*y);f=Math.sin(f*_)/E,s=Math.sin(s*_)/E}var T=s*y;if(a=a*f+h*T,l=l*f+g*T,c=c*f+d*T,u=u*f+p*T,f===1-s){var b=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=b,l*=b,c*=b,u*=b}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}}),Object.defineProperties(Mt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Mt.prototype,{set:function(e,t,o,i){return this._x=e,this._y=t,this._z=o,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=e._x,i=e._y,n=e._z,r=e.order,s=Math.cos,a=Math.sin,l=s(o/2),c=s(i/2),u=s(n/2),h=a(o/2),g=a(i/2),d=a(n/2);return"XYZ"===r?(this._x=h*c*u+l*g*d,this._y=l*g*u-h*c*d,this._z=l*c*d+h*g*u,this._w=l*c*u-h*g*d):"YXZ"===r?(this._x=h*c*u+l*g*d,this._y=l*g*u-h*c*d,this._z=l*c*d-h*g*u,this._w=l*c*u+h*g*d):"ZXY"===r?(this._x=h*c*u-l*g*d,this._y=l*g*u+h*c*d,this._z=l*c*d+h*g*u,this._w=l*c*u-h*g*d):"ZYX"===r?(this._x=h*c*u-l*g*d,this._y=l*g*u+h*c*d,this._z=l*c*d-h*g*u,this._w=l*c*u+h*g*d):"YZX"===r?(this._x=h*c*u+l*g*d,this._y=l*g*u+h*c*d,this._z=l*c*d-h*g*u,this._w=l*c*u-h*g*d):"XZY"===r&&(this._x=h*c*u-l*g*d,this._y=l*g*u-h*c*d,this._z=l*c*d+h*g*u,this._w=l*c*u+h*g*d),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var o=t/2,i=Math.sin(o);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(o),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,o=e.elements,i=o[0],n=o[4],r=o[8],s=o[1],a=o[5],l=o[9],c=o[2],u=o[6],h=o[10],g=i+a+h;return g>0?(t=.5/Math.sqrt(g+1),this._w=.25/t,this._x=(u-l)*t,this._y=(r-c)*t,this._z=(s-n)*t):i>a&&i>h?(t=2*Math.sqrt(1+i-a-h),this._w=(u-l)/t,this._x=.25*t,this._y=(n+s)/t,this._z=(r+c)/t):a>h?(t=2*Math.sqrt(1+a-i-h),this._w=(r-c)/t,this._x=(n+s)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+h-i-a),this._w=(s-n)/t,this._x=(r+c)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new At;return function(o,i){return void 0===t&&(t=new At),(e=o.dot(i)+1)<1e-6?(e=0,Math.abs(o.x)>Math.abs(o.z)?t.set(-o.y,o.x,0):t.set(0,-o.z,o.y)):t.crossVectors(o,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var o=e._x,i=e._y,n=e._z,r=e._w,s=t._x,a=t._y,l=t._z,c=t._w;return this._x=o*c+r*s+i*l-n*a,this._y=i*c+r*a+n*s-o*l,this._z=n*c+r*l+o*a-i*s,this._w=r*c-o*s-i*a-n*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var o=this._x,i=this._y,n=this._z,r=this._w,s=r*e._w+o*e._x+i*e._y+n*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=r,this._x=o,this._y=i,this._z=n,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(r+this._w),this._x=.5*(o+this._x),this._y=.5*(i+this._y),this._z=.5*(n+this._z),this;var l=Math.atan2(a,s),c=Math.sin((1-t)*l)/a,u=Math.sin(t*l)/a;return this._w=r*c+this._w*u,this._x=o*c+this._x*u,this._y=i*c+this._y*u,this._z=n*c+this._z*u,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(At.prototype,{isVector3:!0,set:function(e,t,o){return this.x=e,this.y=t,this.z=o,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(pt=new Mt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(pt.setFromEuler(e))}),applyAxisAngle:function(){var e=new Mt;return function(t,o){return this.applyQuaternion(e.setFromAxisAngle(t,o))}}(),applyMatrix3:function(e){var t=this.x,o=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*o+n[6]*i,this.y=n[1]*t+n[4]*o+n[7]*i,this.z=n[2]*t+n[5]*o+n[8]*i,this},applyMatrix4:function(e){var t=this.x,o=this.y,i=this.z,n=e.elements,r=1/(n[3]*t+n[7]*o+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*o+n[8]*i+n[12])*r,this.y=(n[1]*t+n[5]*o+n[9]*i+n[13])*r,this.z=(n[2]*t+n[6]*o+n[10]*i+n[14])*r,this},applyQuaternion:function(e){var t=this.x,o=this.y,i=this.z,n=e.x,r=e.y,s=e.z,a=e.w,l=a*t+r*i-s*o,c=a*o+s*t-n*i,u=a*i+n*o-r*t,h=-n*t-r*o-s*i;return this.x=l*a+h*-n+c*-s-u*-r,this.y=c*a+h*-r+u*-n-l*-s,this.z=u*a+h*-s+l*-r-c*-n,this},project:(dt=new St,function(e){return dt.multiplyMatrices(e.projectionMatrix,dt.getInverse(e.matrixWorld)),this.applyMatrix4(dt)}),unproject:function(){var e=new St;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,o=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*o+n[8]*i,this.y=n[1]*t+n[5]*o+n[9]*i,this.z=n[2]*t+n[6]*o+n[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new At,t=new At;return function(o,i){return e.set(o,o,o),t.set(i,i,i),this.clamp(e,t)}}(),clampLength:function(e,t){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,o){return this.subVectors(t,e).multiplyScalar(o).add(e)},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var o=this.x,i=this.y,n=this.z;return this.x=i*e.z-n*e.y,this.y=n*e.x-o*e.z,this.z=o*e.y-i*e.x,this},crossVectors:function(e,t){var o=e.x,i=e.y,n=e.z,r=t.x,s=t.y,a=t.z;return this.x=i*a-n*s,this.y=n*r-o*a,this.z=o*s-i*r,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(gt=new At,function(e){return gt.copy(this).projectOnVector(e),this.sub(gt)}),reflect:function(){var e=new At;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(ut.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,o=this.y-e.y,i=this.z-e.z;return t*t+o*o+i*i},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=o,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,o){return void 0!==o&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(St.prototype,{isMatrix4:!0,set:function(e,t,o,i,n,r,s,a,l,c,u,h,g,d,p,f){var m=this.elements;return m[0]=e,m[4]=t,m[8]=o,m[12]=i,m[1]=n,m[5]=r,m[9]=s,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=g,m[7]=d,m[11]=p,m[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new St).fromArray(this.elements)},copy:function(e){var t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],this},copyPosition:function(e){var t=this.elements,o=e.elements;return t[12]=o[12],t[13]=o[13],t[14]=o[14],this},extractBasis:function(e,t,o){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,o){return this.set(e.x,t.x,o.x,0,e.y,t.y,o.y,0,e.z,t.z,o.z,0,0,0,0,1),this},extractRotation:function(){var e=new At;return function(t){var o=this.elements,i=t.elements,n=1/e.setFromMatrixColumn(t,0).length(),r=1/e.setFromMatrixColumn(t,1).length(),s=1/e.setFromMatrixColumn(t,2).length();return o[0]=i[0]*n,o[1]=i[1]*n,o[2]=i[2]*n,o[4]=i[4]*r,o[5]=i[5]*r,o[6]=i[6]*r,o[8]=i[8]*s,o[9]=i[9]*s,o[10]=i[10]*s,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,o=e.x,i=e.y,n=e.z,r=Math.cos(o),s=Math.sin(o),a=Math.cos(i),l=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if("XYZ"===e.order){var h=r*c,g=r*u,d=s*c,p=s*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=g+d*l,t[5]=h-p*l,t[9]=-s*a,t[2]=p-h*l,t[6]=d+g*l,t[10]=r*a}else if("YXZ"===e.order){var f=a*c,m=a*u,y=l*c,v=l*u;t[0]=f+v*s,t[4]=y*s-m,t[8]=r*l,t[1]=r*u,t[5]=r*c,t[9]=-s,t[2]=m*s-y,t[6]=v+f*s,t[10]=r*a}else if("ZXY"===e.order){var f=a*c,m=a*u,y=l*c,v=l*u;t[0]=f-v*s,t[4]=-r*u,t[8]=y+m*s,t[1]=m+y*s,t[5]=r*c,t[9]=v-f*s,t[2]=-r*l,t[6]=s,t[10]=r*a}else if("ZYX"===e.order){var h=r*c,g=r*u,d=s*c,p=s*u;t[0]=a*c,t[4]=d*l-g,t[8]=h*l+p,t[1]=a*u,t[5]=p*l+h,t[9]=g*l-d,t[2]=-l,t[6]=s*a,t[10]=r*a}else if("YZX"===e.order){var E=r*a,_=r*l,T=s*a,b=s*l;t[0]=a*c,t[4]=b-E*u,t[8]=T*u+_,t[1]=u,t[5]=r*c,t[9]=-s*c,t[2]=-l*c,t[6]=_*u+T,t[10]=E-b*u}else if("XZY"===e.order){var E=r*a,_=r*l,T=s*a,b=s*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=E*u+b,t[5]=r*c,t[9]=_*u-T,t[2]=T*u-_,t[6]=s*c,t[10]=b*u+E}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,o=e._x,i=e._y,n=e._z,r=e._w,s=o+o,a=i+i,l=n+n,c=o*s,u=o*a,h=o*l,g=i*a,d=i*l,p=n*l,f=r*s,m=r*a,y=r*l;return t[0]=1-(g+p),t[4]=u-y,t[8]=h+m,t[1]=u+y,t[5]=1-(c+p),t[9]=d-f,t[2]=h-m,t[6]=d+f,t[10]=1-(c+g),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(ft=new At,mt=new At,yt=new At,function(e,t,o){var i=this.elements;return yt.subVectors(e,t),0===yt.lengthSq()&&(yt.z=1),yt.normalize(),ft.crossVectors(o,yt),0===ft.lengthSq()&&(1===Math.abs(o.z)?yt.x+=1e-4:yt.z+=1e-4,yt.normalize(),ft.crossVectors(o,yt)),ft.normalize(),mt.crossVectors(yt,ft),i[0]=ft.x,i[4]=mt.x,i[8]=yt.x,i[1]=ft.y,i[5]=mt.y,i[9]=yt.y,i[2]=ft.z,i[6]=mt.z,i[10]=yt.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var o=e.elements,i=t.elements,n=this.elements,r=o[0],s=o[4],a=o[8],l=o[12],c=o[1],u=o[5],h=o[9],g=o[13],d=o[2],p=o[6],f=o[10],m=o[14],y=o[3],v=o[7],E=o[11],_=o[15],T=i[0],b=i[4],M=i[8],A=i[12],S=i[1],w=i[5],C=i[9],N=i[13],L=i[2],I=i[6],R=i[10],D=i[14],x=i[3],O=i[7],k=i[11],B=i[15];return n[0]=r*T+s*S+a*L+l*x,n[4]=r*b+s*w+a*I+l*O,n[8]=r*M+s*C+a*R+l*k,n[12]=r*A+s*N+a*D+l*B,n[1]=c*T+u*S+h*L+g*x,n[5]=c*b+u*w+h*I+g*O,n[9]=c*M+u*C+h*R+g*k,n[13]=c*A+u*N+h*D+g*B,n[2]=d*T+p*S+f*L+m*x,n[6]=d*b+p*w+f*I+m*O,n[10]=d*M+p*C+f*R+m*k,n[14]=d*A+p*N+f*D+m*B,n[3]=y*T+v*S+E*L+_*x,n[7]=y*b+v*w+E*I+_*O,n[11]=y*M+v*C+E*R+_*k,n[15]=y*A+v*N+E*D+_*B,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new At;return function(t){for(var o=0,i=t.count;o<i;o++)e.x=t.getX(o),e.y=t.getY(o),e.z=t.getZ(o),e.applyMatrix4(this),t.setXYZ(o,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],o=e[4],i=e[8],n=e[12],r=e[1],s=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],g=e[14],d=e[3],p=e[7],f=e[11],m=e[15];return d*(+n*a*u-i*l*u-n*s*h+o*l*h+i*s*g-o*a*g)+p*(+t*a*g-t*l*h+n*r*h-i*r*g+i*l*c-n*a*c)+f*(+t*l*u-t*s*g-n*r*u+o*r*g+n*s*c-o*l*c)+m*(-i*s*c-t*a*u+t*s*h+i*r*u-o*r*h+o*a*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var o=this.elements,i=e.elements,n=i[0],r=i[1],s=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],g=i[8],d=i[9],p=i[10],f=i[11],m=i[12],y=i[13],v=i[14],E=i[15],_=d*v*h-y*p*h+y*u*f-c*v*f-d*u*E+c*p*E,T=m*p*h-g*v*h-m*u*f+l*v*f+g*u*E-l*p*E,b=g*y*h-m*d*h+m*c*f-l*y*f-g*c*E+l*d*E,M=m*d*u-g*y*u-m*c*p+l*y*p+g*c*v-l*d*v,A=n*_+r*T+s*b+a*M;if(0===A){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var w=1/A;return o[0]=_*w,o[1]=(y*p*a-d*v*a-y*s*f+r*v*f+d*s*E-r*p*E)*w,o[2]=(c*v*a-y*u*a+y*s*h-r*v*h-c*s*E+r*u*E)*w,o[3]=(d*u*a-c*p*a-d*s*h+r*p*h+c*s*f-r*u*f)*w,o[4]=T*w,o[5]=(g*v*a-m*p*a+m*s*f-n*v*f-g*s*E+n*p*E)*w,o[6]=(m*u*a-l*v*a-m*s*h+n*v*h+l*s*E-n*u*E)*w,o[7]=(l*p*a-g*u*a+g*s*h-n*p*h-l*s*f+n*u*f)*w,o[8]=b*w,o[9]=(m*d*a-g*y*a-m*r*f+n*y*f+g*r*E-n*d*E)*w,o[10]=(l*y*a-m*c*a+m*r*h-n*y*h-l*r*E+n*c*E)*w,o[11]=(g*c*a-l*d*a-g*r*h+n*d*h+l*r*f-n*c*f)*w,o[12]=M*w,o[13]=(g*y*s-m*d*s+m*r*p-n*y*p-g*r*v+n*d*v)*w,o[14]=(m*c*s-l*y*s-m*r*u+n*y*u+l*r*v-n*c*v)*w,o[15]=(l*d*s-g*c*s+g*r*u-n*d*u-l*r*p+n*c*p)*w,this},scale:function(e){var t=this.elements,o=e.x,i=e.y,n=e.z;return t[0]*=o,t[4]*=i,t[8]*=n,t[1]*=o,t[5]*=i,t[9]*=n,t[2]*=o,t[6]*=i,t[10]*=n,t[3]*=o,t[7]*=i,t[11]*=n,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,o,i))},makeTranslation:function(e,t,o){return this.set(1,0,0,e,0,1,0,t,0,0,1,o,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,t,-o,0,0,o,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),o=Math.sin(e);return this.set(t,0,o,0,0,1,0,0,-o,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),o=Math.sin(e);return this.set(t,-o,0,0,o,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var o=Math.cos(t),i=Math.sin(t),n=1-o,r=e.x,s=e.y,a=e.z,l=n*r,c=n*s;return this.set(l*r+o,l*s-i*a,l*a+i*s,0,l*s+i*a,c*s+o,c*a-i*r,0,l*a-i*s,c*a+i*r,n*a*a+o,0,0,0,0,1),this},makeScale:function(e,t,o){return this.set(e,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1),this},makeShear:function(e,t,o){return this.set(1,t,o,0,e,1,o,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,o){return this.makeRotationFromQuaternion(t),this.scale(o),this.setPosition(e),this},decompose:function(){var e=new At,t=new St;return function(o,i,n){var r=this.elements,s=e.set(r[0],r[1],r[2]).length(),a=e.set(r[4],r[5],r[6]).length(),l=e.set(r[8],r[9],r[10]).length(),c=this.determinant();c<0&&(s=-s),o.x=r[12],o.y=r[13],o.z=r[14],t.copy(this);var u=1/s,h=1/a,g=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=h,t.elements[5]*=h,t.elements[6]*=h,t.elements[8]*=g,t.elements[9]*=g,t.elements[10]*=g,i.setFromRotationMatrix(t),n.x=s,n.y=a,n.z=l,this}}(),makePerspective:function(e,t,o,i,n,r){void 0===r&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*n/(t-e),l=2*n/(o-i),c=(t+e)/(t-e),u=(o+i)/(o-i),h=-(r+n)/(r-n),g=-2*r*n/(r-n);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=g,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(e,t,o,i,n,r){var s=this.elements,a=1/(t-e),l=1/(o-i),c=1/(r-n),u=(t+e)*a,h=(o+i)*l,g=(r+n)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-g,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(e){for(var t=this.elements,o=e.elements,i=0;i<16;i++)if(t[i]!==o[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var o=0;o<16;o++)this.elements[o]=e[o+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e[t+9]=o[9],e[t+10]=o[10],e[t+11]=o[11],e[t+12]=o[12],e[t+13]=o[13],e[t+14]=o[14],e[t+15]=o[15],e}}),wt.prototype=Object.create(Et.prototype),wt.prototype.constructor=wt,wt.prototype.isDataTexture=!0,Ct.prototype=Object.create(Et.prototype),Ct.prototype.constructor=Ct,Ct.prototype.isCubeTexture=!0,Object.defineProperty(Ct.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Nt=new Et,Lt=new Ct;function It(){this.seq=[],this.map={}}var Rt=[],Dt=[],xt=new Float32Array(16),Ot=new Float32Array(9);function kt(e,t,o){var i=e[0];if(i<=0||i>0)return e;var n=t*o,r=Rt[n];if(void 0===r&&(r=new Float32Array(n),Rt[n]=r),0!==t){i.toArray(r,0);for(var s=1,a=0;s!==t;++s)a+=o,e[s].toArray(r,a)}return r}function Bt(e,t){var o=Dt[t];void 0===o&&(o=new Int32Array(t),Dt[t]=o);for(var i=0;i!==t;++i)o[i]=e.allocTextureUnit();return o}function Pt(e,t){e.uniform1f(this.addr,t)}function Ut(e,t){e.uniform1i(this.addr,t)}function Ft(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function Ht(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function jt(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function zt(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Vt(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(Ot.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Ot))}function Gt(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(xt.set(t.elements),e.uniformMatrix4fv(this.addr,!1,xt))}function Wt(e,t,o){var i=o.allocTextureUnit();e.uniform1i(this.addr,i),o.setTexture2D(t||Nt,i)}function Yt(e,t,o){var i=o.allocTextureUnit();e.uniform1i(this.addr,i),o.setTextureCube(t||Lt,i)}function Xt(e,t){e.uniform2iv(this.addr,t)}function Kt(e,t){e.uniform3iv(this.addr,t)}function Qt(e,t){e.uniform4iv(this.addr,t)}function qt(e,t){e.uniform1fv(this.addr,t)}function Jt(e,t){e.uniform1iv(this.addr,t)}function $t(e,t){e.uniform2fv(this.addr,kt(t,this.size,2))}function Zt(e,t){e.uniform3fv(this.addr,kt(t,this.size,3))}function eo(e,t){e.uniform4fv(this.addr,kt(t,this.size,4))}function to(e,t){e.uniformMatrix2fv(this.addr,!1,kt(t,this.size,4))}function oo(e,t){e.uniformMatrix3fv(this.addr,!1,kt(t,this.size,9))}function io(e,t){e.uniformMatrix4fv(this.addr,!1,kt(t,this.size,16))}function no(e,t,o){var i=t.length,n=Bt(o,i);e.uniform1iv(this.addr,n);for(var r=0;r!==i;++r)o.setTexture2D(t[r]||Nt,n[r])}function ro(e,t,o){var i=t.length,n=Bt(o,i);e.uniform1iv(this.addr,n);for(var r=0;r!==i;++r)o.setTextureCube(t[r]||Lt,n[r])}function so(e,t,o){this.id=e,this.addr=o,this.setValue=function(e){switch(e){case 5126:return Pt;case 35664:return Ft;case 35665:return Ht;case 35666:return jt;case 35674:return zt;case 35675:return Vt;case 35676:return Gt;case 35678:case 36198:return Wt;case 35680:return Yt;case 5124:case 35670:return Ut;case 35667:case 35671:return Xt;case 35668:case 35672:return Kt;case 35669:case 35673:return Qt}}(t.type)}function ao(e,t,o){this.id=e,this.addr=o,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return qt;case 35664:return $t;case 35665:return Zt;case 35666:return eo;case 35674:return to;case 35675:return oo;case 35676:return io;case 35678:return no;case 35680:return ro;case 5124:case 35670:return Jt;case 35667:case 35671:return Xt;case 35668:case 35672:return Kt;case 35669:case 35673:return Qt}}(t.type)}function lo(e){this.id=e,It.call(this)}lo.prototype.setValue=function(e,t){for(var o=this.seq,i=0,n=o.length;i!==n;++i){var r=o[i];r.setValue(e,t[r.id])}};var co=/([\w\d_]+)(\])?(\[|\.)?/g;function uo(e,t){e.seq.push(t),e.map[t.id]=t}function ho(e,t,o){var i=e.name,n=i.length;for(co.lastIndex=0;;){var r=co.exec(i),s=co.lastIndex,a=r[1],l="]"===r[2],c=r[3];if(l&&(a|=0),void 0===c||"["===c&&s+2===n){uo(o,void 0===c?new so(a,e,t):new ao(a,e,t));break}var u=o.map,h=u[a];void 0===h&&(h=new lo(a),uo(o,h)),o=h}}function go(e,t,o){It.call(this),this.renderer=o;for(var i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;++n){var r=e.getActiveUniform(t,n),s=r.name,a=e.getUniformLocation(t,s);ho(r,a,this)}}go.prototype.setValue=function(e,t,o){var i=this.map[t];void 0!==i&&i.setValue(e,o,this.renderer)},go.prototype.setOptional=function(e,t,o){var i=t[o];void 0!==i&&this.setValue(e,o,i)},go.upload=function(e,t,o,i){for(var n=0,r=t.length;n!==r;++n){var s=t[n],a=o[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}},go.seqWithValue=function(e,t){for(var o=[],i=0,n=e.length;i!==n;++i){var r=e[i];r.id in t&&o.push(r)}return o};var po={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function fo(e,t,o){return void 0===t&&void 0===o?this.set(e):this.setRGB(e,t,o)}Object.assign(fo.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,o){return this.r=e,this.g=t,this.b=o,this},setHSL:function(){function e(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+6*(t-e)*(2/3-o):e}return function(t,o,i){if(t=ut.euclideanModulo(t,1),o=ut.clamp(o,0,1),i=ut.clamp(i,0,1),0===o)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+o):i+o-i*o,r=2*i-n;this.r=e(r,n,t+1/3),this.g=e(r,n,t),this.b=e(r,n,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,n=o[1],r=o[2];switch(n){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var s=parseFloat(i[1])/360,a=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(s,a,l)}}}else if(o=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=o[1],u=c.length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(e&&e.length>0){var c=po[e];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var o=t>0?1/t:1;return this.r=Math.pow(e.r,o),this.g=Math.pow(e.g,o),this.b=Math.pow(e.b,o),this},convertGammaToLinear:function(){var e=this.r,t=this.g,o=this.b;return this.r=e*e,this.g=t*t,this.b=o*o,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,o,i=e||{h:0,s:0,l:0},n=this.r,r=this.g,s=this.b,a=Math.max(n,r,s),l=Math.min(n,r,s),c=(l+a)/2;if(l===a)t=0,o=0;else{var u=a-l;switch(o=c<=.5?u/(a+l):u/(2-a-l),a){case n:t=(r-s)/u+(r<s?6:0);break;case r:t=(s-n)/u+2;break;case s:t=(n-r)/u+4}t/=6}return i.h=t,i.s=o,i.l=c,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,o){var i=this.getHSL();return i.h+=e,i.s+=t,i.l+=o,this.setHSL(i.h,i.s,i.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var mo={common:{diffuse:{value:new fo(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new _t(0,0,1,1)},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fo(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new fo(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new _t(0,0,1,1)}}},yo={merge:function(e){for(var t={},o=0;o<e.length;o++){var i=this.clone(e[o]);for(var n in i)t[n]=i[n]}return t},clone:function(e){var t={};for(var o in e)for(var i in t[o]={},e[o]){var n=e[o][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[o][i]=n.clone():Array.isArray(n)?t[o][i]=n.slice():t[o][i]=n}return t}},vo={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},Eo={basic:{uniforms:yo.merge([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.fog]),vertexShader:vo.meshbasic_vert,fragmentShader:vo.meshbasic_frag},lambert:{uniforms:yo.merge([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.fog,mo.lights,{emissive:{value:new fo(0)}}]),vertexShader:vo.meshlambert_vert,fragmentShader:vo.meshlambert_frag},phong:{uniforms:yo.merge([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.gradientmap,mo.fog,mo.lights,{emissive:{value:new fo(0)},specular:{value:new fo(1118481)},shininess:{value:30}}]),vertexShader:vo.meshphong_vert,fragmentShader:vo.meshphong_frag},standard:{uniforms:yo.merge([mo.common,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.roughnessmap,mo.metalnessmap,mo.fog,mo.lights,{emissive:{value:new fo(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:vo.meshphysical_vert,fragmentShader:vo.meshphysical_frag},points:{uniforms:yo.merge([mo.points,mo.fog]),vertexShader:vo.points_vert,fragmentShader:vo.points_frag},dashed:{uniforms:yo.merge([mo.common,mo.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vo.linedashed_vert,fragmentShader:vo.linedashed_frag},depth:{uniforms:yo.merge([mo.common,mo.displacementmap]),vertexShader:vo.depth_vert,fragmentShader:vo.depth_frag},normal:{uniforms:yo.merge([mo.common,mo.bumpmap,mo.normalmap,mo.displacementmap,{opacity:{value:1}}]),vertexShader:vo.normal_vert,fragmentShader:vo.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:vo.cube_vert,fragmentShader:vo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vo.equirect_vert,fragmentShader:vo.equirect_frag},distanceRGBA:{uniforms:yo.merge([mo.common,mo.displacementmap,{referencePosition:{value:new At},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vo.distanceRGBA_vert,fragmentShader:vo.distanceRGBA_frag},shadow:{uniforms:yo.merge([mo.lights,{color:{value:new fo(0)},opacity:{value:1}}]),vertexShader:vo.shadow_vert,fragmentShader:vo.shadow_frag}};function _o(e,t){this.min=void 0!==e?e:new ht(1/0,1/0),this.max=void 0!==t?t:new ht(-1/0,-1/0)}function To(e,t,o,i,n){var r,s,a,l,c,u,h,g;function d(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),i=new Uint16Array([0,1,2,0,2,3]);r=t.createBuffer(),s=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW),h=t.createTexture(),g=t.createTexture(),o.bindTexture(t.TEXTURE_2D,h),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),o.bindTexture(t.TEXTURE_2D,g),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),a={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},l=function(e){var o=t.createProgram(),i=t.createShader(t.FRAGMENT_SHADER),r=t.createShader(t.VERTEX_SHADER),s="precision "+n.precision+" float;\n";return t.shaderSource(i,s+e.fragmentShader),t.shaderSource(r,s+e.vertexShader),t.compileShader(i),t.compileShader(r),t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),o}(a),c={vertex:t.getAttribLocation(l,"position"),uv:t.getAttribLocation(l,"uv")},u={renderType:t.getUniformLocation(l,"renderType"),map:t.getUniformLocation(l,"map"),occlusionMap:t.getUniformLocation(l,"occlusionMap"),opacity:t.getUniformLocation(l,"opacity"),color:t.getUniformLocation(l,"color"),scale:t.getUniformLocation(l,"scale"),rotation:t.getUniformLocation(l,"rotation"),screenPosition:t.getUniformLocation(l,"screenPosition")}}this.render=function(e,n,a,p){if(0!==e.length){var f=new At,m=p.w/p.z,y=.5*p.z,v=.5*p.w,E=16/p.w,_=new ht(E*m,E),T=new At(1,1,0),b=new ht(1,1),M=new _o;M.min.set(p.x,p.y),M.max.set(p.x+(p.z-16),p.y+(p.w-16)),void 0===l&&d(),o.useProgram(l),o.initAttributes(),o.enableAttribute(c.vertex),o.enableAttribute(c.uv),o.disableUnusedAttributes(),t.uniform1i(u.occlusionMap,0),t.uniform1i(u.map,1),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(c.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(c.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),o.disable(t.CULL_FACE),o.buffers.depth.setMask(!1);for(var A=0,S=e.length;A<S;A++){E=16/p.w,_.set(E*m,E);var w=e[A];if(f.set(w.matrixWorld.elements[12],w.matrixWorld.elements[13],w.matrixWorld.elements[14]),f.applyMatrix4(a.matrixWorldInverse),f.applyMatrix4(a.projectionMatrix),T.copy(f),b.x=p.x+T.x*y+y-8,b.y=p.y+T.y*v+v-8,!0===M.containsPoint(b)){o.activeTexture(t.TEXTURE0),o.bindTexture(t.TEXTURE_2D,null),o.activeTexture(t.TEXTURE1),o.bindTexture(t.TEXTURE_2D,h),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,b.x,b.y,16,16,0),t.uniform1i(u.renderType,0),t.uniform2f(u.scale,_.x,_.y),t.uniform3f(u.screenPosition,T.x,T.y,T.z),o.disable(t.BLEND),o.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),o.activeTexture(t.TEXTURE0),o.bindTexture(t.TEXTURE_2D,g),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,b.x,b.y,16,16,0),t.uniform1i(u.renderType,1),o.disable(t.DEPTH_TEST),o.activeTexture(t.TEXTURE1),o.bindTexture(t.TEXTURE_2D,h),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),w.positionScreen.copy(T),w.customUpdateCallback?w.customUpdateCallback(w):w.updateLensFlares(),t.uniform1i(u.renderType,2),o.enable(t.BLEND);for(var C=0,N=w.lensFlares.length;C<N;C++){var L=w.lensFlares[C];L.opacity>.001&&L.scale>.001&&(T.x=L.x,T.y=L.y,T.z=L.z,E=L.size*L.scale/p.w,_.x=E*m,_.y=E,t.uniform3f(u.screenPosition,T.x,T.y,T.z),t.uniform2f(u.scale,_.x,_.y),t.uniform1f(u.rotation,L.rotation),t.uniform1f(u.opacity,L.opacity),t.uniform3f(u.color,L.color.r,L.color.g,L.color.b),o.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst),i.setTexture2D(L.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}}}o.enable(t.CULL_FACE),o.enable(t.DEPTH_TEST),o.buffers.depth.setMask(!0),o.reset()}}}function bo(e,t,o,i,n,r,s,a,l){Et.call(this,e,t,o,i,n,r,s,a,l),this.needsUpdate=!0}function Mo(e,t,o,i,n){var r,s,a,l,c,u,h=new At,g=new Mt,d=new At;function p(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),o=new Uint16Array([0,1,2,0,2,3]);r=t.createBuffer(),s=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o,t.STATIC_DRAW),a=function(){var e=t.createProgram(),o=t.createShader(t.VERTEX_SHADER),i=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(o,["precision "+n.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),t.shaderSource(i,["precision "+n.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),t.compileShader(o),t.compileShader(i),t.attachShader(e,o),t.attachShader(e,i),t.linkProgram(e),e}(),l={position:t.getAttribLocation(a,"position"),uv:t.getAttribLocation(a,"uv")},c={uvOffset:t.getUniformLocation(a,"uvOffset"),uvScale:t.getUniformLocation(a,"uvScale"),rotation:t.getUniformLocation(a,"rotation"),scale:t.getUniformLocation(a,"scale"),color:t.getUniformLocation(a,"color"),map:t.getUniformLocation(a,"map"),opacity:t.getUniformLocation(a,"opacity"),modelViewMatrix:t.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:t.getUniformLocation(a,"projectionMatrix"),fogType:t.getUniformLocation(a,"fogType"),fogDensity:t.getUniformLocation(a,"fogDensity"),fogNear:t.getUniformLocation(a,"fogNear"),fogFar:t.getUniformLocation(a,"fogFar"),fogColor:t.getUniformLocation(a,"fogColor"),alphaTest:t.getUniformLocation(a,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8,i.height=8;var h=i.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),u=new bo(i)}function f(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(n,m,y){if(0!==n.length){void 0===a&&p(),o.useProgram(a),o.initAttributes(),o.enableAttribute(l.position),o.enableAttribute(l.uv),o.disableUnusedAttributes(),o.disable(t.CULL_FACE),o.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(l.position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(l.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.uniformMatrix4fv(c.projectionMatrix,!1,y.projectionMatrix.elements),o.activeTexture(t.TEXTURE0),t.uniform1i(c.map,0);var v=0,E=0,_=m.fog;_?(t.uniform3f(c.fogColor,_.color.r,_.color.g,_.color.b),_.isFog?(t.uniform1f(c.fogNear,_.near),t.uniform1f(c.fogFar,_.far),t.uniform1i(c.fogType,1),v=1,E=1):_.isFogExp2&&(t.uniform1f(c.fogDensity,_.density),t.uniform1i(c.fogType,2),v=2,E=2)):(t.uniform1i(c.fogType,0),v=0,E=0);for(var T=0,b=n.length;T<b;T++){var M=n[T];M.modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,M.matrixWorld),M.z=-M.modelViewMatrix.elements[14]}n.sort(f);for(var A=[],T=0,b=n.length;T<b;T++){var M=n[T],S=M.material;if(!1!==S.visible){M.onBeforeRender(e,m,y,void 0,S,void 0),t.uniform1f(c.alphaTest,S.alphaTest),t.uniformMatrix4fv(c.modelViewMatrix,!1,M.modelViewMatrix.elements),M.matrixWorld.decompose(h,g,d),A[0]=d.x,A[1]=d.y;var w=0;m.fog&&S.fog&&(w=E),v!==w&&(t.uniform1i(c.fogType,w),v=w),null!==S.map?(t.uniform2f(c.uvOffset,S.map.offset.x,S.map.offset.y),t.uniform2f(c.uvScale,S.map.repeat.x,S.map.repeat.y)):(t.uniform2f(c.uvOffset,0,0),t.uniform2f(c.uvScale,1,1)),t.uniform1f(c.opacity,S.opacity),t.uniform3f(c.color,S.color.r,S.color.g,S.color.b),t.uniform1f(c.rotation,S.rotation),t.uniform2fv(c.scale,A),o.setBlending(S.blending,S.blendEquation,S.blendSrc,S.blendDst,S.blendEquationAlpha,S.blendSrcAlpha,S.blendDstAlpha,S.premultipliedAlpha),o.buffers.depth.setTest(S.depthTest),o.buffers.depth.setMask(S.depthWrite),i.setTexture2D(S.map||u,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),M.onAfterRender(e,m,y,void 0,S,void 0)}}o.enable(t.CULL_FACE),o.reset()}}}Eo.physical={uniforms:yo.merge([Eo.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:vo.meshphysical_vert,fragmentShader:vo.meshphysical_frag},Object.assign(_o.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,o=e.length;t<o;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new ht;return function(t,o){var i=e.copy(o).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new ht;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new ht;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){var o=t||new ht;return o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){var o=t||new ht;return o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new ht;return function(t){var o=e.copy(t).clamp(this.min,this.max);return o.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),bo.prototype=Object.create(Et.prototype),bo.prototype.constructor=bo;var Ao,So,wo,Co,No,Lo,Io,Ro=0;function Do(){Object.defineProperty(this,"id",{value:Ro++}),this.uuid=ut.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=b,this.side=f,this.flatShading=!1,this.vertexColors=v,this.opacity=1,this.transparent=!1,this.blendSrc=B,this.blendDst=P,this.blendEquation=C,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function xo(e){Do.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Oo(e){Do.call(this),this.type="MeshDepthMaterial",this.depthPacking=lt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function ko(e){Do.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new At,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Bo(e,t){this.min=void 0!==e?e:new At(1/0,1/0,1/0),this.max=void 0!==t?t:new At(-1/0,-1/0,-1/0)}function Po(e,t){this.center=void 0!==e?e:new At,this.radius=void 0!==t?t:0}function Uo(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Fo(e,t){this.normal=void 0!==e?e:new At(1,0,0),this.constant=void 0!==t?t:0}function Ho(e,t,o,i,n,r){this.planes=[void 0!==e?e:new Fo,void 0!==t?t:new Fo,void 0!==o?o:new Fo,void 0!==i?i:new Fo,void 0!==n?n:new Fo,void 0!==r?r:new Fo]}function jo(e,t,o){for(var i=new Ho,n=new St,r=new ht,s=new ht(o,o),a=new At,l=new At,c=1,u=2,h=1+(c|u),g=new Array(h),p=new Array(h),v={},E=[new At(1,0,0),new At(-1,0,0),new At(0,0,1),new At(0,0,-1),new At(0,1,0),new At(0,-1,0)],_=[new At(0,1,0),new At(0,1,0),new At(0,1,0),new At(0,1,0),new At(0,0,1),new At(0,0,-1)],T=[new _t,new _t,new _t,new _t,new _t,new _t],b=0;b!==h;++b){var M=0!=(b&c),A=0!=(b&u),S=new Oo({depthPacking:ct,morphTargets:M,skinning:A});g[b]=S;var w=new ko({morphTargets:M,skinning:A});p[b]=w}var C=this;function N(t,o,i,n,r,s){var a=t.geometry,l=null,h=g,d=t.customDepthMaterial;if(i&&(h=p,d=t.customDistanceMaterial),d)l=d;else{var E=!1;o.morphTargets&&(a&&a.isBufferGeometry?E=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(E=a.morphTargets&&a.morphTargets.length>0)),t.isSkinnedMesh&&!1===o.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var _=t.isSkinnedMesh&&o.skinning,T=0;E&&(T|=c),_&&(T|=u),l=h[T]}if(e.localClippingEnabled&&!0===o.clipShadows&&0!==o.clippingPlanes.length){var b=l.uuid,M=o.uuid,A=v[b];void 0===A&&(A={},v[b]=A);var S=A[M];void 0===S&&(S=l.clone(),A[M]=S),l=S}l.visible=o.visible,l.wireframe=o.wireframe;var w=o.side;return C.renderSingleSided&&w==y&&(w=f),C.renderReverseSided&&(w===f?w=m:w===m&&(w=f)),l.side=w,l.clipShadows=o.clipShadows,l.clippingPlanes=o.clippingPlanes,l.clipIntersection=o.clipIntersection,l.wireframeLinewidth=o.wireframeLinewidth,l.linewidth=o.linewidth,i&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(n),l.nearDistance=r,l.farDistance=s),l}function L(o,n,r,s){if(!1!==o.visible){var a=o.layers.test(n.layers);if(a&&(o.isMesh||o.isLine||o.isPoints)&&o.castShadow&&(!o.frustumCulled||i.intersectsObject(o))){o.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,o.matrixWorld);var c=t.update(o),u=o.material;if(Array.isArray(u))for(var h=c.groups,g=0,d=h.length;g<d;g++){var p=h[g],f=u[p.materialIndex];if(f&&f.visible){var m=N(o,f,s,l,r.near,r.far);e.renderBufferDirect(r,null,c,m,o,p)}}else if(u.visible){var m=N(o,u,s,l,r.near,r.far);e.renderBufferDirect(r,null,c,m,o,null)}}for(var y=o.children,v=0,E=y.length;v<E;v++)L(y[v],n,r,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=d,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,o,c){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var u,h=e.context,g=e.state;g.disable(h.BLEND),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);for(var d=0,p=t.length;d<p;d++){var f=t[d],m=f.shadow,y=f&&f.isPointLight;if(void 0!==m){var v=m.camera;if(r.copy(m.mapSize),r.min(s),y){var b=r.x,M=r.y;T[0].set(2*b,M,b,M),T[1].set(0,M,b,M),T[2].set(3*b,M,b,M),T[3].set(b,M,b,M),T[4].set(3*b,0,b,M),T[5].set(b,0,b,M),r.x*=4,r.y*=2}if(null===m.map){var A={minFilter:fe,magFilter:fe,format:ke};m.map=new Tt(r.x,r.y,A),m.map.texture.name=f.name+".shadowMap",v.updateProjectionMatrix()}m.isSpotLightShadow&&m.update(f);var S=m.map,w=m.matrix;l.setFromMatrixPosition(f.matrixWorld),v.position.copy(l),y?(u=6,w.makeTranslation(-l.x,-l.y,-l.z)):(u=1,a.setFromMatrixPosition(f.target.matrixWorld),v.lookAt(a),v.updateMatrixWorld(),w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(v.projectionMatrix),w.multiply(v.matrixWorldInverse)),e.setRenderTarget(S),e.clear();for(var N=0;N<u;N++){if(y){a.copy(v.position),a.add(E[N]),v.up.copy(_[N]),v.lookAt(a),v.updateMatrixWorld();var I=T[N];g.viewport(I)}n.multiplyMatrices(v.projectionMatrix,v.matrixWorldInverse),i.setFromMatrix(n),L(o,c,v,y)}}else console.warn("THREE.WebGLShadowMap:",f,"has no shadow.")}C.needsUpdate=!1}}}function zo(e){var t={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t[e.uuid]},remove:function(o){o.isInterleavedBufferAttribute&&(o=o.data);var i=t[o.uuid];i&&(e.deleteBuffer(i.buffer),delete t[o.uuid])},update:function(o,i){o.isInterleavedBufferAttribute&&(o=o.data);var n=t[o.uuid];void 0===n?t[o.uuid]=function(t,o){var i=t.array,n=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,r=e.createBuffer();e.bindBuffer(o,r),e.bufferData(o,i,n),t.onUploadCallback();var s=e.FLOAT;return i instanceof Float32Array?s=e.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?s=e.UNSIGNED_SHORT:i instanceof Int16Array?s=e.SHORT:i instanceof Uint32Array?s=e.UNSIGNED_INT:i instanceof Int32Array?s=e.INT:i instanceof Int8Array?s=e.BYTE:i instanceof Uint8Array&&(s=e.UNSIGNED_BYTE),{buffer:r,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(o,i):n.version<o.version&&(function(t,o,i){var n=o.array,r=o.updateRange;e.bindBuffer(i,t),!1===o.dynamic?e.bufferData(i,n,e.STATIC_DRAW):-1===r.count?e.bufferSubData(i,0,n):0===r.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(i,r.offset*n.BYTES_PER_ELEMENT,n.subarray(r.offset,r.offset+r.count)),r.count=-1)}(n.buffer,o,i),n.version=o.version)}}}function Vo(e,t,o,i){this._x=e||0,this._y=t||0,this._z=o||0,this._order=i||Vo.DefaultOrder}function Go(){this.mask=1}Object.assign(Do.prototype,t.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var o=e[t];if(void 0!==o)if("shading"!==t){var i=this[t];void 0!==i?i&&i.isColor?i.set(o):i&&i.isVector3&&o&&o.isVector3?i.copy(o):this[t]="overdraw"===t?Number(o):o:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===o;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e;t&&(e={textures:{},images:{}});var o={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){var t=[];for(var o in e){var i=e[o];delete i.metadata,t.push(i)}return t}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),void 0!==this.roughness&&(o.roughness=this.roughness),void 0!==this.metalness&&(o.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),void 0!==this.shininess&&(o.shininess=this.shininess),void 0!==this.clearCoat&&(o.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(o.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,o.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(o.size=this.size),void 0!==this.sizeAttenuation&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==b&&(o.blending=this.blending),!0===this.flatShading&&(o.flatShading=this.flatShading),this.side!==f&&(o.side=this.side),this.vertexColors!==v&&(o.vertexColors=this.vertexColors),this.opacity<1&&(o.opacity=this.opacity),!0===this.transparent&&(o.transparent=this.transparent),o.depthFunc=this.depthFunc,o.depthTest=this.depthTest,o.depthWrite=this.depthWrite,!0===this.dithering&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(o.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(o.wireframe=this.wireframe),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(o.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(o.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(o.morphTargets=!0),!0===this.skinning&&(o.skinning=!0),!1===this.visible&&(o.visible=!1),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),t){var n=i(e.textures),r=i(e.images);n.length>0&&(o.textures=n),r.length>0&&(o.images=r)}return o},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,o=null;if(null!==t){var i=t.length;o=new Array(i);for(var n=0;n!==i;++n)o[n]=t[n].clone()}return this.clippingPlanes=o,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),xo.prototype=Object.create(Do.prototype),xo.prototype.constructor=xo,xo.prototype.isShaderMaterial=!0,xo.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yo.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},xo.prototype.toJSON=function(e){var t=Do.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Oo.prototype=Object.create(Do.prototype),Oo.prototype.constructor=Oo,Oo.prototype.isMeshDepthMaterial=!0,Oo.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},ko.prototype=Object.create(Do.prototype),ko.prototype.constructor=ko,ko.prototype.isMeshDistanceMaterial=!0,ko.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Object.assign(Bo.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,o=1/0,i=1/0,n=-1/0,r=-1/0,s=-1/0,a=0,l=e.length;a<l;a+=3){var c=e[a],u=e[a+1],h=e[a+2];c<t&&(t=c),u<o&&(o=u),h<i&&(i=h),c>n&&(n=c),u>r&&(r=u),h>s&&(s=h)}return this.min.set(t,o,i),this.max.set(n,r,s),this},setFromBufferAttribute:function(e){for(var t=1/0,o=1/0,i=1/0,n=-1/0,r=-1/0,s=-1/0,a=0,l=e.count;a<l;a++){var c=e.getX(a),u=e.getY(a),h=e.getZ(a);c<t&&(t=c),u<o&&(o=u),h<i&&(i=h),c>n&&(n=c),u>r&&(r=u),h>s&&(s=h)}return this.min.set(t,o,i),this.max.set(n,r,s),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,o=e.length;t<o;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new At;return function(t,o){var i=e.copy(o).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new At;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new At;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e=new At;return function(t){var o=this;return t.updateMatrixWorld(!0),t.traverse(function(t){var i,n,r=t.geometry;if(void 0!==r)if(r.isGeometry){var s=r.vertices;for(i=0,n=s.length;i<n;i++)e.copy(s[i]),e.applyMatrix4(t.matrixWorld),o.expandByPoint(e)}else if(r.isBufferGeometry){var a=r.attributes.position;if(void 0!==a)for(i=0,n=a.count;i<n;i++)e.fromBufferAttribute(a,i).applyMatrix4(t.matrixWorld),o.expandByPoint(e)}}),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){var o=t||new At;return o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(So=new At,function(e){return this.clampPoint(e.center,So),So.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,o;return e.normal.x>0?(t=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),t<=e.constant&&o>=e.constant},clampPoint:function(e,t){var o=t||new At;return o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new At;return function(t){var o=e.copy(t).clamp(this.min,this.max);return o.sub(t).length()}}(),getBoundingSphere:function(){var e=new At;return function(t){var o=t||new Po;return this.getCenter(o.center),o.radius=.5*this.getSize(e).length(),o}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Ao=[new At,new At,new At,new At,new At,new At,new At,new At],function(e){return this.isEmpty()?this:(Ao[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ao[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ao[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ao[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ao[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ao[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ao[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ao[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ao),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Po.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(wo=new Bo,function(e,t){var o=this.center;void 0!==t?o.copy(t):wo.setFromPoints(e).getCenter(o);for(var i=0,n=0,r=e.length;n<r;n++)i=Math.max(i,o.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var o=this.center.distanceToSquared(e),i=t||new At;return i.copy(e),o>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(e){var t=e||new Bo;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Uo.prototype,{isMatrix3:!0,set:function(e,t,o,i,n,r,s,a,l){var c=this.elements;return c[0]=e,c[1]=i,c[2]=s,c[3]=t,c[4]=n,c[5]=a,c[6]=o,c[7]=r,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new At;return function(t){for(var o=0,i=t.count;o<i;o++)e.x=t.getX(o),e.y=t.getY(o),e.z=t.getZ(o),e.applyMatrix3(this),t.setXYZ(o,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var o=e.elements,i=t.elements,n=this.elements,r=o[0],s=o[3],a=o[6],l=o[1],c=o[4],u=o[7],h=o[2],g=o[5],d=o[8],p=i[0],f=i[3],m=i[6],y=i[1],v=i[4],E=i[7],_=i[2],T=i[5],b=i[8];return n[0]=r*p+s*y+a*_,n[3]=r*f+s*v+a*T,n[6]=r*m+s*E+a*b,n[1]=l*p+c*y+u*_,n[4]=l*f+c*v+u*T,n[7]=l*m+c*E+u*b,n[2]=h*p+g*y+d*_,n[5]=h*f+g*v+d*T,n[8]=h*m+g*E+d*b,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],o=e[1],i=e[2],n=e[3],r=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*r*c-t*s*l-o*n*c+o*s*a+i*n*l-i*r*a},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var o=e.elements,i=this.elements,n=o[0],r=o[1],s=o[2],a=o[3],l=o[4],c=o[5],u=o[6],h=o[7],g=o[8],d=g*l-c*h,p=c*u-g*a,f=h*a-l*u,m=n*d+r*p+s*f;if(0===m){var y="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(y);return console.warn(y),this.identity()}var v=1/m;return i[0]=d*v,i[1]=(s*h-g*r)*v,i[2]=(c*r-s*l)*v,i[3]=p*v,i[4]=(g*n-s*u)*v,i[5]=(s*a-c*n)*v,i[6]=f*v,i[7]=(r*u-h*n)*v,i[8]=(l*n-r*a)*v,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},equals:function(e){for(var t=this.elements,o=e.elements,i=0;i<9;i++)if(t[i]!==o[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var o=0;o<9;o++)this.elements[o]=e[o+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e}}),Object.assign(Fo.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,o,i){return this.normal.set(e,t,o),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new At,t=new At;return function(o,i,n){var r=e.subVectors(n,i).cross(t.subVectors(o,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,o),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){var o=t||new At;return o.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new At;return function(t,o){var i=o||new At,n=t.delta(e),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?i.copy(t.start):void 0;var s=-(t.start.dot(this.normal)+this.constant)/r;return s<0||s>1?void 0:i.copy(n).multiplyScalar(s).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return t<0&&o>0||o<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){var t=e||new At;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new At,t=new Uo;return function(o,i){var n=i||t.getNormalMatrix(o),r=this.coplanarPoint(e).applyMatrix4(o),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Ho.prototype,{set:function(e,t,o,i,n,r){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(o),s[3].copy(i),s[4].copy(n),s[5].copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,o=0;o<6;o++)t[o].copy(e.planes[o]);return this},setFromMatrix:function(e){var t=this.planes,o=e.elements,i=o[0],n=o[1],r=o[2],s=o[3],a=o[4],l=o[5],c=o[6],u=o[7],h=o[8],g=o[9],d=o[10],p=o[11],f=o[12],m=o[13],y=o[14],v=o[15];return t[0].setComponents(s-i,u-a,p-h,v-f).normalize(),t[1].setComponents(s+i,u+a,p+h,v+f).normalize(),t[2].setComponents(s+n,u+l,p+g,v+m).normalize(),t[3].setComponents(s-n,u-l,p-g,v-m).normalize(),t[4].setComponents(s-r,u-c,p-d,v-y).normalize(),t[5].setComponents(s+r,u+c,p+d,v+y).normalize(),this},intersectsObject:(Lo=new Po,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Lo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Lo)}),intersectsSprite:function(){var e=new Po;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,o=e.center,i=-e.radius,n=0;n<6;n++){var r=t[n].distanceToPoint(o);if(r<i)return!1}return!0},intersectsBox:(Co=new At,No=new At,function(e){for(var t=this.planes,o=0;o<6;o++){var i=t[o];Co.x=i.normal.x>0?e.min.x:e.max.x,No.x=i.normal.x>0?e.max.x:e.min.x,Co.y=i.normal.y>0?e.min.y:e.max.y,No.y=i.normal.y>0?e.max.y:e.min.y,Co.z=i.normal.z>0?e.min.z:e.max.z,No.z=i.normal.z>0?e.max.z:e.min.z;var n=i.distanceToPoint(Co),r=i.distanceToPoint(No);if(n<0&&r<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,o=0;o<6;o++)if(t[o].distanceToPoint(e)<0)return!1;return!0}}),Vo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Vo.DefaultOrder="XYZ",Object.defineProperties(Vo.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Vo.prototype,{isEuler:!0,set:function(e,t,o,i){return this._x=e,this._y=t,this._z=o,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,o){var i=ut.clamp,n=e.elements,r=n[0],s=n[4],a=n[8],l=n[1],c=n[5],u=n[9],h=n[2],g=n[6],d=n[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(g,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(a,d),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,r),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(g,-1,1)),Math.abs(g)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(l,r))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(g,d),this._z=Math.atan2(l,r)):(this._x=0,this._z=Math.atan2(-s,c))):"YZX"===t?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,d))):"XZY"===t?(this._z=Math.asin(-i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(g,c),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==o&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new St;return function(t,o,i){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,o,i)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Io=new Mt,function(e){return Io.setFromEuler(this),this.setFromQuaternion(Io,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new At(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Go.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Wo,Yo,Xo,Ko,Qo=0;function qo(){Object.defineProperty(this,"id",{value:Qo++}),this.uuid=ut.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qo.DefaultUp.clone();var e=new At,t=new Vo,o=new Mt,i=new At(1,1,1);t.onChange(function(){o.setFromEuler(t,!1)}),o.onChange(function(){t.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:o},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new St},normalMatrix:{value:new Uo}}),this.matrix=new St,this.matrixWorld=new St,this.matrixAutoUpdate=qo.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Go,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!1,this.renderOrder=0,this.userData={}}function Jo(){qo.call(this),this.type="Camera",this.matrixWorldInverse=new St,this.projectionMatrix=new St}function $o(e,t,o,i,n,r){Jo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=o,this.bottom=i,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()}function Zo(e,t,o,i){Jo.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==o?o:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ei(e,t,o,i,n,r){this.a=e,this.b=t,this.c=o,this.normal=i&&i.isVector3?i:new At,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new fo,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==r?r:0}qo.DefaultUp=new At(0,1,0),qo.DefaultMatrixAutoUpdate=!0,Object.assign(qo.prototype,t.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(Ko=new Mt,function(e,t){return Ko.setFromAxisAngle(e,t),this.quaternion.multiply(Ko),this}),rotateX:function(){var e=new At(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new At(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new At(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new At;return function(t,o){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(o)),this}}(),translateX:function(){var e=new At(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new At(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new At(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Xo=new St,function(e){return e.applyMatrix4(Xo.getInverse(this.matrixWorld))}),lookAt:function(){var e=new St;return function(t){this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var o=this.children.indexOf(e);return-1!==o&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(o,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var o=0,i=this.children.length;o<i;o++){var n=this.children[o],r=n.getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){var t=e||new At;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Wo=new At,Yo=new At,function(e){var t=e||new Mt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Wo,t,Yo),t}),getWorldRotation:function(){var e=new Mt;return function(t){var o=t||new Vo;return this.getWorldQuaternion(e),o.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new At,t=new Mt;return function(o){var i=o||new At;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,i),i}}(),getWorldDirection:function(){var e=new Mt;return function(t){var o=t||new At;return this.getWorldQuaternion(e),o.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,o=0,i=t.length;o<i;o++)t[o].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,o=0,i=t.length;o<i;o++)t[o].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,o=0,i=t.length;o<i;o++)t[o].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||""===e,o={};t&&(e={geometries:{},materials:{},textures:{},images:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function n(t,o){return void 0===t[o.uuid]&&(t[o.uuid]=o.toJSON(e)),o.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.matrix=this.matrix.toArray(),void 0!==this.geometry&&(i.geometry=n(e.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var r=[],s=0,a=this.material.length;s<a;s++)r.push(n(e.materials,this.material[s]));i.material=r}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(var s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(t){var l=g(e.geometries),c=g(e.materials),u=g(e.textures),h=g(e.images);l.length>0&&(o.geometries=l),c.length>0&&(o.materials=c),u.length>0&&(o.textures=u),h.length>0&&(o.images=h)}return o.object=i,o;function g(e){var t=[];for(var o in e){var i=e[o];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var o=0;o<e.children.length;o++){var i=e.children[o];this.add(i.clone())}return this}}),Jo.prototype=Object.assign(Object.create(qo.prototype),{constructor:Jo,isCamera:!0,copy:function(e,t){return qo.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new Mt;return function(t){var o=t||new At;return this.getWorldQuaternion(e),o.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){qo.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),$o.prototype=Object.assign(Object.create(Jo.prototype),{constructor:$o,isOrthographicCamera:!0,copy:function(e,t){return Jo.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,o,i,n,r){this.view={fullWidth:e,fullHeight:t,offsetX:o,offsetY:i,width:n,height:r},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=o-e,r=o+e,s=i+t,a=i-t;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;n+=u*(this.view.offsetX/l),r=n+u*(this.view.width/l),s-=h*(this.view.offsetY/c),a=s-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(n,r,s,a,this.near,this.far)},toJSON:function(e){var t=qo.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Zo.prototype=Object.assign(Object.create(Jo.prototype),{constructor:Zo,isPerspectiveCamera:!0,copy:function(e,t){return Jo.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*ut.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*ut.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ut.RAD2DEG*Math.atan(Math.tan(.5*ut.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,o,i,n,r){this.aspect=e/t,this.view={fullWidth:e,fullHeight:t,offsetX:o,offsetY:i,width:n,height:r},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*ut.DEG2RAD*this.fov)/this.zoom,o=2*t,i=this.aspect*o,n=-.5*i,r=this.view;if(null!==r){var s=r.fullWidth,a=r.fullHeight;n+=r.offsetX*i/s,t-=r.offsetY*o/a,i*=r.width/s,o*=r.height/a}var l=this.filmOffset;0!==l&&(n+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-o,e,this.far)},toJSON:function(e){var t=qo.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Object.assign(ei.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,o=e.vertexNormals.length;t<o;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,o=e.vertexColors.length;t<o;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var ti,oi,ii,ni,ri,si,ai,li,ci,ui=0;function hi(){return ui++}function gi(){Object.defineProperty(this,"id",{value:hi()}),this.uuid=ut.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function di(e,t,o){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=ut.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===o,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function pi(e,t){di.call(this,new Int8Array(e),t)}function fi(e,t){di.call(this,new Uint8Array(e),t)}function mi(e,t){di.call(this,new Uint8ClampedArray(e),t)}function yi(e,t){di.call(this,new Int16Array(e),t)}function vi(e,t){di.call(this,new Uint16Array(e),t)}function Ei(e,t){di.call(this,new Int32Array(e),t)}function _i(e,t){di.call(this,new Uint32Array(e),t)}function Ti(e,t){di.call(this,new Float32Array(e),t)}function bi(e,t){di.call(this,new Float64Array(e),t)}function Mi(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ai(e){if(0===e.length)return-1/0;for(var t=e[0],o=1,i=e.length;o<i;++o)e[o]>t&&(t=e[o]);return t}function Si(){Object.defineProperty(this,"id",{value:hi()}),this.uuid=ut.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function wi(e,t,o,i,n,r){gi.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:o,widthSegments:i,heightSegments:n,depthSegments:r},this.fromBufferGeometry(new Ci(e,t,o,i,n,r)),this.mergeVertices()}function Ci(e,t,o,i,n,r){Si.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:o,widthSegments:i,heightSegments:n,depthSegments:r};var s=this;i=Math.floor(i)||1,n=Math.floor(n)||1,r=Math.floor(r)||1;var a=[],l=[],c=[],u=[],h=0,g=0;function d(e,t,o,i,n,r,d,p,f,m,y){var v,E,_=r/f,T=d/m,b=r/2,M=d/2,A=p/2,S=f+1,w=m+1,C=0,N=0,L=new At;for(E=0;E<w;E++){var I=E*T-M;for(v=0;v<S;v++){var R=v*_-b;L[e]=R*i,L[t]=I*n,L[o]=A,l.push(L.x,L.y,L.z),L[e]=0,L[t]=0,L[o]=p>0?1:-1,c.push(L.x,L.y,L.z),u.push(v/f),u.push(1-E/m),C+=1}}for(E=0;E<m;E++)for(v=0;v<f;v++){var D=h+v+S*E,x=h+v+S*(E+1),O=h+(v+1)+S*(E+1),k=h+(v+1)+S*E;a.push(D,x,k),a.push(x,O,k),N+=6}s.addGroup(g,N,y),g+=N,h+=C}d("z","y","x",-1,-1,o,t,e,r,n,0),d("z","y","x",1,-1,o,t,-e,r,n,1),d("x","z","y",1,1,e,o,t,i,r,2),d("x","z","y",1,-1,e,o,-t,i,r,3),d("x","y","z",1,-1,e,t,o,i,n,4),d("x","y","z",-1,-1,e,t,-o,i,n,5),this.setIndex(a),this.addAttribute("position",new Ti(l,3)),this.addAttribute("normal",new Ti(c,3)),this.addAttribute("uv",new Ti(u,2))}function Ni(e,t,o,i){gi.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:o,heightSegments:i},this.fromBufferGeometry(new Li(e,t,o,i)),this.mergeVertices()}function Li(e,t,o,i){Si.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:o,heightSegments:i};var n,r,s=e/2,a=t/2,l=Math.floor(o)||1,c=Math.floor(i)||1,u=l+1,h=c+1,g=e/l,d=t/c,p=[],f=[],m=[],y=[];for(r=0;r<h;r++){var v=r*d-a;for(n=0;n<u;n++){var E=n*g-s;f.push(E,-v,0),m.push(0,0,1),y.push(n/l),y.push(1-r/c)}}for(r=0;r<c;r++)for(n=0;n<l;n++){var _=n+u*r,T=n+u*(r+1),b=n+1+u*(r+1),M=n+1+u*r;p.push(_,T,M),p.push(T,b,M)}this.setIndex(p),this.addAttribute("position",new Ti(f,3)),this.addAttribute("normal",new Ti(m,3)),this.addAttribute("uv",new Ti(y,2))}function Ii(e){Do.call(this),this.type="MeshBasicMaterial",this.color=new fo(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ri(e,t){this.origin=void 0!==e?e:new At,this.direction=void 0!==t?t:new At}function Di(e,t){this.start=void 0!==e?e:new At,this.end=void 0!==t?t:new At}function xi(e,t,o){this.a=void 0!==e?e:new At,this.b=void 0!==t?t:new At,this.c=void 0!==o?o:new At}function Oi(e,t){qo.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Si,this.material=void 0!==t?t:new Ii({color:16777215*Math.random()}),this.drawMode=$e,this.updateMorphTargets()}function ki(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Bi(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Pi(){var e={};return{get:function(t,o){var i=t.id+","+o.id,n=e[i];return void 0===n&&(n=new function(){var e=[],t=0,o=[],i=[];return{opaque:o,transparent:i,init:function(){t=0,o.length=0,i.length=0},push:function(n,r,s,a,l){var c=e[t];void 0===c?(c={id:n.id,object:n,geometry:r,material:s,program:s.program,renderOrder:n.renderOrder,z:a,group:l},e[t]=c):(c.id=n.id,c.object=n,c.geometry=r,c.material=s,c.program=s.program,c.renderOrder=n.renderOrder,c.z=a,c.group=l),(!0===s.transparent?i:o).push(c),t++},sort:function(){o.length>1&&o.sort(ki),i.length>1&&i.sort(Bi)}}},e[i]=n),n},dispose:function(){e={}}}}function Ui(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Fi(){var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var o;switch(t.type){case"DirectionalLight":o={direction:new At,color:new fo,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":o={position:new At,direction:new At,color:new fo,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":o={position:new At,color:new fo,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":o={direction:new At,skyColor:new fo,groundColor:new fo};break;case"RectAreaLight":o={color:new fo,position:new At,halfWidth:new At,halfHeight:new At}}return e[t.id]=o,o}}},t={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=new At,i=new St,n=new St;return{setup:function(r,s,a){for(var l=0,c=0,u=0,h=0,g=0,d=0,p=0,f=0,m=a.matrixWorldInverse,y=0,v=r.length;y<v;y++){var E=r[y],_=E.color,T=E.intensity,b=E.distance,M=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)l+=_.r*T,c+=_.g*T,u+=_.b*T;else if(E.isDirectionalLight){var A=e.get(E);if(A.color.copy(E.color).multiplyScalar(E.intensity),A.direction.setFromMatrixPosition(E.matrixWorld),o.setFromMatrixPosition(E.target.matrixWorld),A.direction.sub(o),A.direction.transformDirection(m),A.shadow=E.castShadow,E.castShadow){var S=E.shadow;A.shadowBias=S.bias,A.shadowRadius=S.radius,A.shadowMapSize=S.mapSize}t.directionalShadowMap[h]=M,t.directionalShadowMatrix[h]=E.shadow.matrix,t.directional[h]=A,h++}else if(E.isSpotLight){var A=e.get(E);if(A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(m),A.color.copy(_).multiplyScalar(T),A.distance=b,A.direction.setFromMatrixPosition(E.matrixWorld),o.setFromMatrixPosition(E.target.matrixWorld),A.direction.sub(o),A.direction.transformDirection(m),A.coneCos=Math.cos(E.angle),A.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),A.decay=0===E.distance?0:E.decay,A.shadow=E.castShadow,E.castShadow){var S=E.shadow;A.shadowBias=S.bias,A.shadowRadius=S.radius,A.shadowMapSize=S.mapSize}t.spotShadowMap[d]=M,t.spotShadowMatrix[d]=E.shadow.matrix,t.spot[d]=A,d++}else if(E.isRectAreaLight){var A=e.get(E);A.color.copy(_).multiplyScalar(T/(E.width*E.height)),A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(m),n.identity(),i.copy(E.matrixWorld),i.premultiply(m),n.extractRotation(i),A.halfWidth.set(.5*E.width,0,0),A.halfHeight.set(0,.5*E.height,0),A.halfWidth.applyMatrix4(n),A.halfHeight.applyMatrix4(n),t.rectArea[p]=A,p++}else if(E.isPointLight){var A=e.get(E);if(A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(m),A.color.copy(E.color).multiplyScalar(E.intensity),A.distance=E.distance,A.decay=0===E.distance?0:E.decay,A.shadow=E.castShadow,E.castShadow){var S=E.shadow;A.shadowBias=S.bias,A.shadowRadius=S.radius,A.shadowMapSize=S.mapSize,A.shadowCameraNear=S.camera.near,A.shadowCameraFar=S.camera.far}t.pointShadowMap[g]=M,t.pointShadowMatrix[g]=E.shadow.matrix,t.point[g]=A,g++}else if(E.isHemisphereLight){var A=e.get(E);A.direction.setFromMatrixPosition(E.matrixWorld),A.direction.transformDirection(m),A.direction.normalize(),A.skyColor.copy(E.color).multiplyScalar(T),A.groundColor.copy(E.groundColor).multiplyScalar(T),t.hemi[f]=A,f++}}t.ambient[0]=l,t.ambient[1]=c,t.ambient[2]=u,t.directional.length=h,t.spot.length=d,t.rectArea.length=p,t.point.length=g,t.hemi.length=f,t.hash=h+","+g+","+d+","+p+","+f+","+s.length},state:t}}function Hi(e,t,o){var i=e.createShader(t);return e.shaderSource(i,o),e.compileShader(i),!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(i),function(e){for(var t=e.split("\n"),o=0;o<t.length;o++)t[o]=o+1+": "+t[o];return t.join("\n")}(o)),i}Object.assign(gi.prototype,t.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=(new Uo).getNormalMatrix(e),o=0,i=this.vertices.length;o<i;o++){var n=this.vertices[o];n.applyMatrix4(e)}for(var o=0,i=this.faces.length;o<i;o++){var r=this.faces[o];r.normal.applyMatrix3(t).normalize();for(var s=0,a=r.vertexNormals.length;s<a;s++)r.vertexNormals[s].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new St;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new St;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new St;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new St;return function(t,o,i){return e.makeTranslation(t,o,i),this.applyMatrix(e),this}}(),scale:function(){var e=new St;return function(t,o,i){return e.makeScale(t,o,i),this.applyMatrix(e),this}}(),lookAt:(ti=new qo,function(e){ti.lookAt(e),ti.updateMatrix(),this.applyMatrix(ti.matrix)}),fromBufferGeometry:function(e){var t=this,o=null!==e.index?e.index.array:void 0,i=e.attributes,n=i.position.array,r=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,a=void 0!==i.uv?i.uv.array:void 0,l=void 0!==i.uv2?i.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=[],u=[],h=[],g=0,d=0;g<n.length;g+=3,d+=2)t.vertices.push(new At(n[g],n[g+1],n[g+2])),void 0!==r&&c.push(new At(r[g],r[g+1],r[g+2])),void 0!==s&&t.colors.push(new fo(s[g],s[g+1],s[g+2])),void 0!==a&&u.push(new ht(a[d],a[d+1])),void 0!==l&&h.push(new ht(l[d],l[d+1]));function p(e,o,i,n){var g=void 0!==r?[c[e].clone(),c[o].clone(),c[i].clone()]:[],d=void 0!==s?[t.colors[e].clone(),t.colors[o].clone(),t.colors[i].clone()]:[],p=new ei(e,o,i,g,d,n);t.faces.push(p),void 0!==a&&t.faceVertexUvs[0].push([u[e].clone(),u[o].clone(),u[i].clone()]),void 0!==l&&t.faceVertexUvs[1].push([h[e].clone(),h[o].clone(),h[i].clone()])}var f=e.groups;if(f.length>0)for(var g=0;g<f.length;g++)for(var m=f[g],y=m.start,v=m.count,d=y,E=y+v;d<E;d+=3)void 0!==o?p(o[d],o[d+1],o[d+2],m.materialIndex):p(d,d+1,d+2,m.materialIndex);else if(void 0!==o)for(var g=0;g<o.length;g+=3)p(o[g],o[g+1],o[g+2]);else for(var g=0;g<n.length/3;g+=3)p(g,g+1,g+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,o=0===t?1:1/t,i=new St;return i.set(o,0,0,-o*e.x,0,o,0,-o*e.y,0,0,o,-o*e.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var e=new At,t=new At,o=0,i=this.faces.length;o<i;o++){var n=this.faces[o],r=this.vertices[n.a],s=this.vertices[n.b],a=this.vertices[n.c];e.subVectors(a,s),t.subVectors(r,s),e.cross(t),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){var t,o,i,n,r,s;for(void 0===e&&(e=!0),s=new Array(this.vertices.length),t=0,o=this.vertices.length;t<o;t++)s[t]=new At;if(e){var a,l,c,u=new At,h=new At;for(i=0,n=this.faces.length;i<n;i++)r=this.faces[i],a=this.vertices[r.a],l=this.vertices[r.b],c=this.vertices[r.c],u.subVectors(c,l),h.subVectors(a,l),u.cross(h),s[r.a].add(u),s[r.b].add(u),s[r.c].add(u)}else for(this.computeFaceNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],s[r.a].add(r.normal),s[r.b].add(r.normal),s[r.c].add(r.normal);for(t=0,o=this.vertices.length;t<o;t++)s[t].normalize();for(i=0,n=this.faces.length;i<n;i++){var g=(r=this.faces[i]).vertexNormals;3===g.length?(g[0].copy(s[r.a]),g[1].copy(s[r.b]),g[2].copy(s[r.c])):(g[0]=s[r.a].clone(),g[1]=s[r.b].clone(),g[2]=s[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,o;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var i=(o=this.faces[e]).vertexNormals;3===i.length?(i[0].copy(o.normal),i[1].copy(o.normal),i[2].copy(o.normal)):(i[0]=o.normal.clone(),i[1]=o.normal.clone(),i[2]=o.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,o,i,n;for(o=0,i=this.faces.length;o<i;o++)for((n=this.faces[o]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var r=new gi;for(r.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals,a=this.morphNormals[e].vertexNormals;for(o=0,i=this.faces.length;o<i;o++)l=new At,c={a:new At,b:new At,c:new At},s.push(l),a.push(c)}var l,c,u=this.morphNormals[e];for(r.vertices=this.morphTargets[e].vertices,r.computeFaceNormals(),r.computeVertexNormals(),o=0,i=this.faces.length;o<i;o++)n=this.faces[o],l=u.faceNormals[o],c=u.vertexNormals[o],l.copy(n.normal),c.a.copy(n.vertexNormals[0]),c.b.copy(n.vertexNormals[1]),c.c.copy(n.vertexNormals[2])}for(o=0,i=this.faces.length;o<i;o++)(n=this.faces[o]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,o=0,i=t.length;o<i;o++)o>0&&(e+=t[o].distanceTo(t[o-1])),this.lineDistances[o]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Bo),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Po),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,o){if(e&&e.isGeometry){var i,n=this.vertices.length,r=this.vertices,s=e.vertices,a=this.faces,l=e.faces,c=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,g=e.colors;void 0===o&&(o=0),void 0!==t&&(i=(new Uo).getNormalMatrix(t));for(var d=0,p=s.length;d<p;d++){var f=s[d],m=f.clone();void 0!==t&&m.applyMatrix4(t),r.push(m)}for(var d=0,p=g.length;d<p;d++)h.push(g[d].clone());for(d=0,p=l.length;d<p;d++){var y,v,E,_=l[d],T=_.vertexNormals,b=_.vertexColors;(y=new ei(_.a+n,_.b+n,_.c+n)).normal.copy(_.normal),void 0!==i&&y.normal.applyMatrix3(i).normalize();for(var M=0,A=T.length;M<A;M++)v=T[M].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),y.vertexNormals.push(v);y.color.copy(_.color);for(var M=0,A=b.length;M<A;M++)E=b[M],y.vertexColors.push(E.clone());y.materialIndex=_.materialIndex+o,a.push(y)}for(d=0,p=u.length;d<p;d++){var S=u[d],w=[];if(void 0!==S){for(var M=0,A=S.length;M<A;M++)w.push(S[M].clone());c.push(w)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,o,i,n,r,s,a,l={},c=[],u=[],h=Math.pow(10,4);for(o=0,i=this.vertices.length;o<i;o++)e=this.vertices[o],t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h),void 0===l[t]?(l[t]=o,c.push(this.vertices[o]),u[o]=c.length-1):u[o]=u[l[t]];var g=[];for(o=0,i=this.faces.length;o<i;o++){(n=this.faces[o]).a=u[n.a],n.b=u[n.b],n.c=u[n.c],r=[n.a,n.b,n.c];for(var d=0;d<3;d++)if(r[d]===r[(d+1)%3]){g.push(o);break}}for(o=g.length-1;o>=0;o--){var p=g[o];for(this.faces.splice(p,1),s=0,a=this.faceVertexUvs.length;s<a;s++)this.faceVertexUvs[s].splice(p,1)}var f=this.vertices.length-c.length;return this.vertices=c,f},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,o=0;o<t;o++)e[o]._id=o;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var i,n,r=this.faceVertexUvs[0],s=this.faceVertexUvs[1];r&&r.length===t&&(i=[]),s&&s.length===t&&(n=[]);for(var o=0;o<t;o++){var a=e[o]._id;i&&i.push(r[a]),n&&n.push(s[a])}i&&(this.faceVertexUvs[0]=i),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var o in t)void 0!==t[o]&&(e[o]=t[o]);return e}for(var i=[],n=0;n<this.vertices.length;n++){var r=this.vertices[n];i.push(r.x,r.y,r.z)}for(var s=[],a=[],l={},c=[],u={},h=[],g={},n=0;n<this.faces.length;n++){var d=this.faces[n],p=void 0!==this.faceVertexUvs[0][n],f=d.normal.length()>0,m=d.vertexNormals.length>0,y=1!==d.color.r||1!==d.color.g||1!==d.color.b,v=d.vertexColors.length>0,E=0;if(E=M(E=M(E=M(E=M(E=M(E=M(E=M(E=M(E,0,0),1,!0),2,!1),3,p),4,f),5,m),6,y),7,v),s.push(E),s.push(d.a,d.b,d.c),s.push(d.materialIndex),p){var _=this.faceVertexUvs[0][n];s.push(w(_[0]),w(_[1]),w(_[2]))}if(f&&s.push(A(d.normal)),m){var T=d.vertexNormals;s.push(A(T[0]),A(T[1]),A(T[2]))}if(y&&s.push(S(d.color)),v){var b=d.vertexColors;s.push(S(b[0]),S(b[1]),S(b[2]))}}function M(e,t,o){return o?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]?l[t]:(l[t]=a.length/3,a.push(e.x,e.y,e.z),l[t])}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]?u[t]:(u[t]=c.length,c.push(e.getHex()),u[t])}function w(e){var t=e.x.toString()+e.y.toString();return void 0!==g[t]?g[t]:(g[t]=h.length/2,h.push(e.x,e.y),g[t])}return e.data={},e.data.vertices=i,e.data.normals=a,c.length>0&&(e.data.colors=c),h.length>0&&(e.data.uvs=[h]),e.data.faces=s,e},clone:function(){return(new gi).copy(this)},copy:function(e){var t,o,i,n,r,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var a=e.vertices;for(t=0,o=a.length;t<o;t++)this.vertices.push(a[t].clone());var l=e.colors;for(t=0,o=l.length;t<o;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,o=c.length;t<o;t++)this.faces.push(c[t].clone());for(t=0,o=e.faceVertexUvs.length;t<o;t++){var u=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),i=0,n=u.length;i<n;i++){var h=u[i],g=[];for(r=0,s=h.length;r<s;r++){var d=h[r];g.push(d.clone())}this.faceVertexUvs[t].push(g)}}var p=e.morphTargets;for(t=0,o=p.length;t<o;t++){var f={};if(f.name=p[t].name,void 0!==p[t].vertices)for(f.vertices=[],i=0,n=p[t].vertices.length;i<n;i++)f.vertices.push(p[t].vertices[i].clone());if(void 0!==p[t].normals)for(f.normals=[],i=0,n=p[t].normals.length;i<n;i++)f.normals.push(p[t].normals[i].clone());this.morphTargets.push(f)}var m=e.morphNormals;for(t=0,o=m.length;t<o;t++){var y={};if(void 0!==m[t].vertexNormals)for(y.vertexNormals=[],i=0,n=m[t].vertexNormals.length;i<n;i++){var v=m[t].vertexNormals[i],E={};E.a=v.a.clone(),E.b=v.b.clone(),E.c=v.c.clone(),y.vertexNormals.push(E)}if(void 0!==m[t].faceNormals)for(y.faceNormals=[],i=0,n=m[t].faceNormals.length;i<n;i++)y.faceNormals.push(m[t].faceNormals[i].clone());this.morphNormals.push(y)}var _=e.skinWeights;for(t=0,o=_.length;t<o;t++)this.skinWeights.push(_[t].clone());var T=e.skinIndices;for(t=0,o=T.length;t<o;t++)this.skinIndices.push(T[t].clone());var b=e.lineDistances;for(t=0,o=b.length;t<o;t++)this.lineDistances.push(b[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var A=e.boundingSphere;return null!==A&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(di.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(di.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,o){e*=this.itemSize,o*=t.itemSize;for(var i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[o+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,o=0,i=0,n=e.length;i<n;i++){var r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new fo),t[o++]=r.r,t[o++]=r.g,t[o++]=r.b}return this},copyIndicesArray:function(e){for(var t=this.array,o=0,i=0,n=e.length;i<n;i++){var r=e[i];t[o++]=r.a,t[o++]=r.b,t[o++]=r.c}return this},copyVector2sArray:function(e){for(var t=this.array,o=0,i=0,n=e.length;i<n;i++){var r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new ht),t[o++]=r.x,t[o++]=r.y}return this},copyVector3sArray:function(e){for(var t=this.array,o=0,i=0,n=e.length;i<n;i++){var r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new At),t[o++]=r.x,t[o++]=r.y,t[o++]=r.z}return this},copyVector4sArray:function(e){for(var t=this.array,o=0,i=0,n=e.length;i<n;i++){var r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new _t),t[o++]=r.x,t[o++]=r.y,t[o++]=r.z,t[o++]=r.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=o,this},setXYZ:function(e,t,o,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=o,this.array[e+2]=i,this},setXYZW:function(e,t,o,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=o,this.array[e+2]=i,this.array[e+3]=n,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),pi.prototype=Object.create(di.prototype),pi.prototype.constructor=pi,fi.prototype=Object.create(di.prototype),fi.prototype.constructor=fi,mi.prototype=Object.create(di.prototype),mi.prototype.constructor=mi,yi.prototype=Object.create(di.prototype),yi.prototype.constructor=yi,vi.prototype=Object.create(di.prototype),vi.prototype.constructor=vi,Ei.prototype=Object.create(di.prototype),Ei.prototype.constructor=Ei,_i.prototype=Object.create(di.prototype),_i.prototype.constructor=_i,Ti.prototype=Object.create(di.prototype),Ti.prototype.constructor=Ti,bi.prototype=Object.create(di.prototype),bi.prototype.constructor=bi,Object.assign(Mi.prototype,{computeGroups:function(e){for(var t,o=[],i=void 0,n=e.faces,r=0;r<n.length;r++){var s=n[r];s.materialIndex!==i&&(i=s.materialIndex,void 0!==t&&(t.count=3*r-t.start,o.push(t)),t={start:3*r,materialIndex:i})}void 0!==t&&(t.count=3*r-t.start,o.push(t)),this.groups=o},fromGeometry:function(e){var t,o=e.faces,i=e.vertices,n=e.faceVertexUvs,r=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,a=e.morphTargets,l=a.length;if(l>0){t=[];for(var c=0;c<l;c++)t[c]=[];this.morphTargets.position=t}var u,h=e.morphNormals,g=h.length;if(g>0){u=[];for(var c=0;c<g;c++)u[c]=[];this.morphTargets.normal=u}for(var d=e.skinIndices,p=e.skinWeights,f=d.length===i.length,m=p.length===i.length,c=0;c<o.length;c++){var y=o[c];this.vertices.push(i[y.a],i[y.b],i[y.c]);var v=y.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{var E=y.normal;this.normals.push(E,E,E)}var _=y.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var T=y.color;this.colors.push(T,T,T)}if(!0===r){var b=n[0][c];void 0!==b?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new ht,new ht,new ht))}if(!0===s){var b=n[1][c];void 0!==b?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new ht,new ht,new ht))}for(var M=0;M<l;M++){var A=a[M].vertices;t[M].push(A[y.a],A[y.b],A[y.c])}for(var M=0;M<g;M++){var S=h[M].vertexNormals[c];u[M].push(S.a,S.b,S.c)}f&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),m&&this.skinWeights.push(p[y.a],p[y.b],p[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}}),Si.MaxIndex=65535,Object.assign(Si.prototype,t.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Ai(e)>65535?_i:vi)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new di(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,o){this.groups.push({start:e,count:t,materialIndex:void 0!==o?o:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var o=this.attributes.normal;if(void 0!==o){var i=(new Uo).getNormalMatrix(e);i.applyToBufferAttribute(o),o.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new St;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new St;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new St;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new St;return function(t,o,i){return e.makeTranslation(t,o,i),this.applyMatrix(e),this}}(),scale:function(){var e=new St;return function(t,o,i){return e.makeScale(t,o,i),this.applyMatrix(e),this}}(),lookAt:function(){var e=new qo;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var o=new Ti(3*t.vertices.length,3),i=new Ti(3*t.colors.length,3);if(this.addAttribute("position",o.copyVector3sArray(t.vertices)),this.addAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var n=new Ti(t.lineDistances.length,1);this.addAttribute("lineDistance",n.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t,o=e.geometry;if(e.isMesh){var i=o.__directGeometry;if(!0===o.elementsNeedUpdate&&(i=void 0,o.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(o);i.verticesNeedUpdate=o.verticesNeedUpdate,i.normalsNeedUpdate=o.normalsNeedUpdate,i.colorsNeedUpdate=o.colorsNeedUpdate,i.uvsNeedUpdate=o.uvsNeedUpdate,i.groupsNeedUpdate=o.groupsNeedUpdate,o.verticesNeedUpdate=!1,o.normalsNeedUpdate=!1,o.colorsNeedUpdate=!1,o.uvsNeedUpdate=!1,o.groupsNeedUpdate=!1,o=i}return!0===o.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(o.vertices),t.needsUpdate=!0),o.verticesNeedUpdate=!1),!0===o.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(o.normals),t.needsUpdate=!0),o.normalsNeedUpdate=!1),!0===o.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(o.colors),t.needsUpdate=!0),o.colorsNeedUpdate=!1),o.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(o.uvs),t.needsUpdate=!0),o.uvsNeedUpdate=!1),o.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(o.lineDistances),t.needsUpdate=!0),o.lineDistancesNeedUpdate=!1),o.groupsNeedUpdate&&(o.computeGroups(e.geometry),this.groups=o.groups,o.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Mi).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new di(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var o=new Float32Array(3*e.normals.length);this.addAttribute("normal",new di(o,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new di(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var n=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new di(n,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var r=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new di(r,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var s=Ai(e.indices)>65535?Uint32Array:Uint16Array,a=new s(3*e.indices.length);this.setIndex(new di(a,1).copyIndicesArray(e.indices))}for(var l in this.groups=e.groups,e.morphTargets){for(var c=[],u=e.morphTargets[l],h=0,g=u.length;h<g;h++){var d=u[h],p=new Ti(3*d.length,3);c.push(p.copyVector3sArray(d))}this.morphAttributes[l]=c}if(e.skinIndices.length>0){var f=new Ti(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new Ti(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Bo);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Bo,t=new At;return function(){null===this.boundingSphere&&(this.boundingSphere=new Po);var o=this.attributes.position;if(o){var i=this.boundingSphere.center;e.setFromBufferAttribute(o),e.getCenter(i);for(var n=0,r=0,s=o.count;r<s;r++)t.x=o.getX(r),t.y=o.getY(r),t.z=o.getZ(r),n=Math.max(n,i.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,o=this.groups;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new di(new Float32Array(i.length),3));else for(var n=t.normal.array,r=0,s=n.length;r<s;r++)n[r]=0;var a,l,c,u=t.normal.array,h=new At,g=new At,d=new At,p=new At,f=new At;if(e){var m=e.array;0===o.length&&this.addGroup(0,m.length);for(var y=0,v=o.length;y<v;++y)for(var E=o[y],_=E.start,T=E.count,r=_,s=_+T;r<s;r+=3)a=3*m[r+0],l=3*m[r+1],c=3*m[r+2],h.fromArray(i,a),g.fromArray(i,l),d.fromArray(i,c),p.subVectors(d,g),f.subVectors(h,g),p.cross(f),u[a]+=p.x,u[a+1]+=p.y,u[a+2]+=p.z,u[l]+=p.x,u[l+1]+=p.y,u[l+2]+=p.z,u[c]+=p.x,u[c+1]+=p.y,u[c+2]+=p.z}else for(var r=0,s=i.length;r<s;r+=9)h.fromArray(i,r),g.fromArray(i,r+3),d.fromArray(i,r+6),p.subVectors(d,g),f.subVectors(h,g),p.cross(f),u[r]=p.x,u[r+1]=p.y,u[r+2]=p.z,u[r+3]=p.x,u[r+4]=p.y,u[r+5]=p.z,u[r+6]=p.x,u[r+7]=p.y,u[r+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0);var o=this.attributes;for(var i in o)if(void 0!==e.attributes[i])for(var n=o[i],r=n.array,s=e.attributes[i],a=s.array,l=s.itemSize,c=0,u=l*t;c<a.length;c++,u++)r[u]=a[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:(oi=new At,function(){for(var e=this.attributes.normal,t=0,o=e.count;t<o;t++)oi.x=e.getX(t),oi.y=e.getY(t),oi.z=e.getZ(t),oi.normalize(),e.setXYZ(t,oi.x,oi.y,oi.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Si,t=this.index.array,o=this.attributes;for(var i in o){for(var n=o[i],r=n.array,s=n.itemSize,a=new r.constructor(t.length*s),l=0,c=0,u=0,h=t.length;u<h;u++){l=t[u]*s;for(var g=0;g<s;g++)a[c++]=r[l++]}e.addAttribute(i,new di(a,s))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var o in t)void 0!==t[o]&&(e[o]=t[o]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var n=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:n}}var r=this.attributes;for(var o in r){var s=r[o],n=Array.prototype.slice.call(s.array);e.data.attributes[o]={itemSize:s.itemSize,type:s.array.constructor.name,array:n,normalized:s.normalized}}var a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new Si).copy(this)},copy:function(e){var t,o,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone());var r=e.attributes;for(t in r){var s=r[t];this.addAttribute(t,s.clone())}var a=e.morphAttributes;for(t in a){var l=[],c=a[t];for(o=0,i=c.length;o<i;o++)l.push(c[o].clone());this.morphAttributes[t]=l}var u=e.groups;for(o=0,i=u.length;o<i;o++){var h=u[o];this.addGroup(h.start,h.count,h.materialIndex)}var g=e.boundingBox;null!==g&&(this.boundingBox=g.clone());var d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),wi.prototype=Object.create(gi.prototype),wi.prototype.constructor=wi,Ci.prototype=Object.create(Si.prototype),Ci.prototype.constructor=Ci,Ni.prototype=Object.create(gi.prototype),Ni.prototype.constructor=Ni,Li.prototype=Object.create(Si.prototype),Li.prototype.constructor=Li,Ii.prototype=Object.create(Do.prototype),Ii.prototype.constructor=Ii,Ii.prototype.isMeshBasicMaterial=!0,Ii.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.assign(Ri.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var o=t||new At;return o.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new At;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var o=t||new At;o.subVectors(e,this.origin);var i=o.dot(this.direction);return i<0?o.copy(this.origin):o.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new At;return function(t){var o=e.subVectors(t,this.origin).dot(this.direction);return o<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(o).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(ni=new At,ri=new At,si=new At,function(e,t,o,i){ni.copy(e).add(t).multiplyScalar(.5),ri.copy(t).sub(e).normalize(),si.copy(this.origin).sub(ni);var n,r,s,a,l=.5*e.distanceTo(t),c=-this.direction.dot(ri),u=si.dot(this.direction),h=-si.dot(ri),g=si.lengthSq(),d=Math.abs(1-c*c);if(d>0)if(r=c*u-h,a=l*d,(n=c*h-u)>=0)if(r>=-a)if(r<=a){var p=1/d;s=(n*=p)*(n+c*(r*=p)+2*u)+r*(c*n+r+2*h)+g}else r=l,n=Math.max(0,-(c*r+u)),s=-n*n+r*(r+2*h)+g;else r=-l,n=Math.max(0,-(c*r+u)),s=-n*n+r*(r+2*h)+g;else r<=-a?(n=Math.max(0,-(-c*l+u)),r=n>0?-l:Math.min(Math.max(-l,-h),l),s=-n*n+r*(r+2*h)+g):r<=a?(n=0,r=Math.min(Math.max(-l,-h),l),s=r*(r+2*h)+g):(n=Math.max(0,-(c*l+u)),r=n>0?l:Math.min(Math.max(-l,-h),l),s=-n*n+r*(r+2*h)+g);else r=c>0?-l:l,n=Math.max(0,-(c*r+u)),s=-n*n+r*(r+2*h)+g;return o&&o.copy(this.direction).multiplyScalar(n).add(this.origin),i&&i.copy(ri).multiplyScalar(r).add(ni),s}),intersectSphere:function(){var e=new At;return function(t,o){e.subVectors(t.center,this.origin);var i=e.dot(this.direction),n=e.dot(e)-i*i,r=t.radius*t.radius;if(n>r)return null;var s=Math.sqrt(r-n),a=i-s,l=i+s;return a<0&&l<0?null:a<0?this.at(l,o):this.at(a,o)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var o=-(this.origin.dot(e.normal)+e.constant)/t;return o>=0?o:null},intersectPlane:function(e,t){var o=this.distanceToPlane(e);return null===o?null:this.at(o,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var o=e.normal.dot(this.direction);return o*t<0},intersectBox:function(e,t){var o,i,n,r,s,a,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(o=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(o=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(n=(e.min.y-h.y)*c,r=(e.max.y-h.y)*c):(n=(e.max.y-h.y)*c,r=(e.min.y-h.y)*c),o>r||n>i?null:((n>o||o!=o)&&(o=n),(r<i||i!=i)&&(i=r),u>=0?(s=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),o>a||s>i?null:((s>o||o!=o)&&(o=s),(a<i||i!=i)&&(i=a),i<0?null:this.at(o>=0?o:i,t)))},intersectsBox:(ii=new At,function(e){return null!==this.intersectBox(e,ii)}),intersectTriangle:function(){var e=new At,t=new At,o=new At,i=new At;return function(n,r,s,a,l){t.subVectors(r,n),o.subVectors(s,n),i.crossVectors(t,o);var c,u=this.direction.dot(i);if(u>0){if(a)return null;c=1}else{if(!(u<0))return null;c=-1,u=-u}e.subVectors(this.origin,n);var h=c*this.direction.dot(o.crossVectors(e,o));if(h<0)return null;var g=c*this.direction.dot(t.cross(e));if(g<0)return null;if(h+g>u)return null;var d=-c*e.dot(i);return d<0?null:this.at(d/u,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Di.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){var t=e||new At;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new At;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var o=t||new At;return this.delta(o).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(ai=new At,li=new At,function(e,t){ai.subVectors(e,this.start),li.subVectors(this.end,this.start);var o=li.dot(li),i=li.dot(ai),n=i/o;return t&&(n=ut.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,o){var i=this.closestPointToPointParameter(e,t),n=o||new At;return this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(xi,{normal:(ci=new At,function(e,t,o,i){var n=i||new At;n.subVectors(o,t),ci.subVectors(e,t),n.cross(ci);var r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}),barycoordFromPoint:function(){var e=new At,t=new At,o=new At;return function(i,n,r,s,a){e.subVectors(s,n),t.subVectors(r,n),o.subVectors(i,n);var l=e.dot(e),c=e.dot(t),u=e.dot(o),h=t.dot(t),g=t.dot(o),d=l*h-c*c,p=a||new At;if(0===d)return p.set(-2,-1,-1);var f=1/d,m=(h*u-c*g)*f,y=(l*g-c*u)*f;return p.set(1-m-y,y,m)}}(),containsPoint:function(){var e=new At;return function(t,o,i,n){var r=xi.barycoordFromPoint(t,o,i,n,e);return r.x>=0&&r.y>=0&&r.x+r.y<=1}}()}),Object.assign(xi.prototype,{set:function(e,t,o){return this.a.copy(e),this.b.copy(t),this.c.copy(o),this},setFromPointsAndIndices:function(e,t,o,i){return this.a.copy(e[t]),this.b.copy(e[o]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new At,t=new At;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new At;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return xi.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new Fo;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return xi.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return xi.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e=new Fo,t=[new Di,new Di,new Di],o=new At,i=new At;return function(n,r){var s=r||new At,a=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(n,o),!0===this.containsPoint(o))s.copy(o);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var l=0;l<t.length;l++){t[l].closestPointToPoint(o,!0,i);var c=o.distanceToSquared(i);c<a&&(a=c,s.copy(i))}}return s}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Oi.prototype=Object.assign(Object.create(qo.prototype),{constructor:Oi,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return qo.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){var e,t,o,i=this.geometry;if(i.isBufferGeometry){var n=i.morphAttributes,r=Object.keys(n);if(r.length>0){var s=n[r[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)o=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=e}}else{var a=i.morphTargets;if(void 0!==a&&a.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)o=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=e}},raycast:function(){var e=new St,t=new Ri,o=new Po,i=new At,n=new At,r=new At,s=new At,a=new At,l=new At,c=new ht,u=new ht,h=new ht,g=new At,d=new At,p=new At;function f(e,t,o,i,n,r,s){return xi.barycoordFromPoint(e,t,o,i,g),n.multiplyScalar(g.x),r.multiplyScalar(g.y),s.multiplyScalar(g.z),n.add(r).add(s),n.clone()}function v(e,t,o,i,n,r,s,a){if(null===(t.side===m?i.intersectTriangle(s,r,n,!0,a):i.intersectTriangle(n,r,s,t.side!==y,a)))return null;p.copy(a),p.applyMatrix4(e.matrixWorld);var l=o.ray.origin.distanceTo(p);return l<o.near||l>o.far?null:{distance:l,point:p.clone(),object:e}}function E(e,t,o,s,a,l,g,p){i.fromBufferAttribute(s,l),n.fromBufferAttribute(s,g),r.fromBufferAttribute(s,p);var m=v(e,e.material,t,o,i,n,r,d);return m&&(a&&(c.fromBufferAttribute(a,l),u.fromBufferAttribute(a,g),h.fromBufferAttribute(a,p),m.uv=f(d,i,n,r,c,u,h)),m.face=new ei(l,g,p,xi.normal(i,n,r)),m.faceIndex=l),m}return function(g,p){var m,y=this.geometry,_=this.material,T=this.matrixWorld;if(void 0!==_&&(null===y.boundingSphere&&y.computeBoundingSphere(),o.copy(y.boundingSphere),o.applyMatrix4(T),!1!==g.ray.intersectsSphere(o)&&(e.getInverse(T),t.copy(g.ray).applyMatrix4(e),null===y.boundingBox||!1!==t.intersectsBox(y.boundingBox))))if(y.isBufferGeometry){var b,M,A,S,w,C=y.index,N=y.attributes.position,L=y.attributes.uv;if(null!==C)for(S=0,w=C.count;S<w;S+=3)b=C.getX(S),M=C.getX(S+1),A=C.getX(S+2),(m=E(this,g,t,N,L,b,M,A))&&(m.faceIndex=Math.floor(S/3),p.push(m));else for(S=0,w=N.count;S<w;S+=3)(m=E(this,g,t,N,L,b=S,M=S+1,A=S+2))&&(m.index=b,p.push(m))}else if(y.isGeometry){var I,R,D,x,O=Array.isArray(_),k=y.vertices,B=y.faces,P=y.faceVertexUvs[0];P.length>0&&(x=P);for(var U=0,F=B.length;U<F;U++){var H=B[U],j=O?_[H.materialIndex]:_;if(void 0!==j){if(I=k[H.a],R=k[H.b],D=k[H.c],!0===j.morphTargets){var z=y.morphTargets,V=this.morphTargetInfluences;i.set(0,0,0),n.set(0,0,0),r.set(0,0,0);for(var G=0,W=z.length;G<W;G++){var Y=V[G];if(0!==Y){var X=z[G].vertices;i.addScaledVector(s.subVectors(X[H.a],I),Y),n.addScaledVector(a.subVectors(X[H.b],R),Y),r.addScaledVector(l.subVectors(X[H.c],D),Y)}}i.add(I),n.add(R),r.add(D),I=i,R=n,D=r}if(m=v(this,j,g,t,I,R,D,d)){if(x&&x[U]){var K=x[U];c.copy(K[0]),u.copy(K[1]),h.copy(K[2]),m.uv=f(d,I,R,D,c,u,h)}m.face=H,m.faceIndex=U,p.push(m)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ji,zi,Vi,Gi,Wi,Yi,Xi=0;function Ki(e){switch(e){case tt:return["Linear","( value )"];case ot:return["sRGB","( value )"];case nt:return["RGBE","( value )"];case rt:return["RGBM","( value, 7.0 )"];case st:return["RGBM","( value, 16.0 )"];case at:return["RGBD","( value, 256.0 )"];case it:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Qi(e,t){var o=Ki(t);return"vec4 "+e+"( vec4 value ) { return "+o[0]+"ToLinear"+o[1]+"; }"}function qi(e){return""!==e}function Ji(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function $i(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var o=vo[t];if(void 0===o)throw new Error("Can not resolve #include <"+t+">");return $i(o)})}function Zi(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,o,i){for(var n="",r=parseInt(t);r<parseInt(o);r++)n+=i.replace(/\[ i \]/g,"[ "+r+" ]");return n})}function en(e,t,o,i,n,r){var s=e.context,a=i.defines,l=n.vertexShader,c=n.fragmentShader,u="SHADOWMAP_TYPE_BASIC";r.shadowMapType===d?u="SHADOWMAP_TYPE_PCF":r.shadowMapType===p&&(u="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",g="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(i.envMap.mapping){case re:case se:h="ENVMAP_TYPE_CUBE";break;case ue:case he:h="ENVMAP_TYPE_CUBE_UV";break;case ae:case le:h="ENVMAP_TYPE_EQUIREC";break;case ce:h="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case se:case le:g="ENVMAP_MODE_REFRACTION"}switch(i.combine){case J:f="ENVMAP_BLENDING_MULTIPLY";break;case $:f="ENVMAP_BLENDING_MIX";break;case Z:f="ENVMAP_BLENDING_ADD"}}var m,y,v,E,_,T=e.gammaFactor>0?e.gammaFactor:1,b=function(e,t,o){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&o.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&o.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&o.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(qi).join("\n")}(i.extensions,r,t),M=function(e){var t=[];for(var o in e){var i=e[o];!1!==i&&t.push("#define "+o+" "+i)}return t.join("\n")}(a),A=s.createProgram();i.isRawShaderMaterial?(m=[M,"\n"].filter(qi).join("\n"),y=[b,M,"\n"].filter(qi).join("\n")):(m=["precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,M,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+T,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+g:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(qi).join("\n"),y=[b,"precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,M,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"","#define GAMMA_FACTOR "+T,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.envMap?"#define "+g:"",r.envMap?"#define "+f:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(r.numClippingPlanes-r.numClipIntersection),r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",r.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",r.toneMapping!==ee?"#define TONE_MAPPING":"",r.toneMapping!==ee?vo.tonemapping_pars_fragment:"",r.toneMapping!==ee?function(e,t){var o;switch(t){case te:o="Linear";break;case oe:o="Reinhard";break;case ie:o="Uncharted2";break;case ne:o="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+o+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.outputEncoding||r.mapEncoding||r.envMapEncoding||r.emissiveMapEncoding?vo.encodings_pars_fragment:"",r.mapEncoding?Qi("mapTexelToLinear",r.mapEncoding):"",r.envMapEncoding?Qi("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?Qi("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.outputEncoding?(v="linearToOutputTexel",E=r.outputEncoding,_=Ki(E),"vec4 "+v+"( vec4 value ) { return LinearTo"+_[0]+_[1]+"; }"):"",r.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(qi).join("\n")),l=Ji(l=$i(l),r),c=Ji(c=$i(c),r),i.isShaderMaterial||(l=Zi(l),c=Zi(c));var S=m+l,w=y+c,C=Hi(s,s.VERTEX_SHADER,S),N=Hi(s,s.FRAGMENT_SHADER,w);s.attachShader(A,C),s.attachShader(A,N),void 0!==i.index0AttributeName?s.bindAttribLocation(A,0,i.index0AttributeName):!0===r.morphTargets&&s.bindAttribLocation(A,0,"position"),s.linkProgram(A);var L,I,R=s.getProgramInfoLog(A),D=s.getShaderInfoLog(C),x=s.getShaderInfoLog(N),O=!0,k=!0;return!1===s.getProgramParameter(A,s.LINK_STATUS)?(O=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(A,s.VALIDATE_STATUS),"gl.getProgramInfoLog",R,D,x)):""!==R?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R):""!==D&&""!==x||(k=!1),k&&(this.diagnostics={runnable:O,material:i,programLog:R,vertexShader:{log:D,prefix:m},fragmentShader:{log:x,prefix:y}}),s.deleteShader(C),s.deleteShader(N),this.getUniforms=function(){return void 0===L&&(L=new go(s,A,e)),L},this.getAttributes=function(){return void 0===I&&(I=function(e,t,o){for(var i={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<n;r++){var s=e.getActiveAttrib(t,r),a=s.name;i[a]=e.getAttribLocation(t,a)}return i}(s,A)),I},this.destroy=function(){s.deleteProgram(A),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Xi++,this.code=o,this.usedTimes=1,this.program=A,this.vertexShader=C,this.fragmentShader=N,this}function tn(e,t,o){var i=[],n={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},r=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(e,t){var o;return e?e.isTexture?o=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),o=e.texture.encoding):o=tt,o===tt&&t&&(o=it),o}this.getParameters=function(t,i,r,a,l,c,u){var h=n[t.type],g=u.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(o.floatVertexTextures)return 1024;var i=o.maxVertexUniforms,n=Math.floor((i-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(u):0,d=o.precision;null!==t.precision&&(d=o.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",d,"instead.");var p=e.getRenderTarget(),f={shaderID:h,precision:d,supportsVertexTextures:o.vertexTextures,outputEncoding:s(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:s(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:s(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===ue||t.envMap.mapping===he),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:s(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!a,useFog:t.fog,fogExp:a&&a.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:o.logarithmicDepthBuffer,skinning:t.skinning&&g>0,maxBones:g,useVertexTexture:o.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:l,numClipIntersection:c,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.receiveShadow&&r.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===y,flipSided:t.side===m,depthPacking:void 0!==t.depthPacking&&t.depthPacking};return f},this.getProgramCode=function(t,o){var i=[];if(o.shaderID?i.push(o.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var s=0;s<r.length;s++)i.push(o[r[s]]);return i.push(t.onBeforeCompile.toString()),i.push(e.gammaOutput),i.join()},this.acquireProgram=function(o,n,r,s){for(var a,l=0,c=i.length;l<c;l++){var u=i[l];if(u.code===s){++(a=u).usedTimes;break}}return void 0===a&&(a=new en(e,t,s,o,n,r),i.push(a)),a},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function on(e,t,o,i,n,r,s){var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;function l(e,t){if(e.width>t||e.height>t){var o=t/Math.max(e.width,e.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=Math.floor(e.width*o),i.height=Math.floor(e.height*o);var n=i.getContext("2d");return n.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function c(e){return ut.isPowerOfTwo(e.width)&&ut.isPowerOfTwo(e.height)}function u(e,t){return e.generateMipmaps&&t&&e.minFilter!==fe&&e.minFilter!==ve}function h(t){return t===fe||t===me||t===ye?e.NEAREST:e.LINEAR}function g(t){var o=t.target;o.removeEventListener("dispose",g),function(t){var o=i.get(t);if(t.image&&o.__image__webglTextureCube)e.deleteTexture(o.__image__webglTextureCube);else{if(void 0===o.__webglInit)return;e.deleteTexture(o.__webglTexture)}i.remove(t)}(o),s.textures--}function d(t){var o=t.target;o.removeEventListener("dispose",d),function(t){var o=i.get(t),n=i.get(t.texture);if(t){if(void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(var r=0;r<6;r++)e.deleteFramebuffer(o.__webglFramebuffer[r]),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer[r]);else e.deleteFramebuffer(o.__webglFramebuffer),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer);i.remove(t.texture),i.remove(t)}}(o),s.textures--}function p(t,h){var d=i.get(t);if(t.version>0&&d.__version!==t.version){var p=t.image;if(void 0===p)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==p.complete)return void function(t,i,h){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",g),t.__webglTexture=e.createTexture(),s.textures++),o.activeTexture(e.TEXTURE0+h),o.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment);var d=l(i.image,n.maxTextureSize);(function(e){return e.wrapS!==de||e.wrapT!==de||e.minFilter!==fe&&e.minFilter!==ve})(i)&&!1===c(d)&&(d=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");t.width=ut.nearestPowerOfTwo(e.width),t.height=ut.nearestPowerOfTwo(e.height);var o=t.getContext("2d");return o.drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}(d));var p=c(d),m=r.convert(i.format),y=r.convert(i.type);f(e.TEXTURE_2D,i,p);var v,E=i.mipmaps;if(i.isDepthTexture){var _=e.DEPTH_COMPONENT;if(i.type===Ce){if(!a)throw new Error("Float Depth Texture only supported in WebGL2.0");_=e.DEPTH_COMPONENT32F}else a&&(_=e.DEPTH_COMPONENT16);i.format===Fe&&_===e.DEPTH_COMPONENT&&i.type!==Ae&&i.type!==we&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Ae,y=r.convert(i.type)),i.format===He&&(_=e.DEPTH_STENCIL,i.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=De,y=r.convert(i.type))),o.texImage2D(e.TEXTURE_2D,0,_,d.width,d.height,0,m,y,null)}else if(i.isDataTexture)if(E.length>0&&p){for(var T=0,b=E.length;T<b;T++)v=E[T],o.texImage2D(e.TEXTURE_2D,T,m,v.width,v.height,0,m,y,v.data);i.generateMipmaps=!1}else o.texImage2D(e.TEXTURE_2D,0,m,d.width,d.height,0,m,y,d.data);else if(i.isCompressedTexture)for(var T=0,b=E.length;T<b;T++)v=E[T],i.format!==ke&&i.format!==Oe?o.getCompressedTextureFormats().indexOf(m)>-1?o.compressedTexImage2D(e.TEXTURE_2D,T,m,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):o.texImage2D(e.TEXTURE_2D,T,m,v.width,v.height,0,m,y,v.data);else if(E.length>0&&p){for(var T=0,b=E.length;T<b;T++)v=E[T],o.texImage2D(e.TEXTURE_2D,T,m,m,y,v);i.generateMipmaps=!1}else o.texImage2D(e.TEXTURE_2D,0,m,m,y,d);u(i,p)&&e.generateMipmap(e.TEXTURE_2D),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}(d,t,h);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}o.activeTexture(e.TEXTURE0+h),o.bindTexture(e.TEXTURE_2D,d.__webglTexture)}function f(o,s,a){var l;if(a?(e.texParameteri(o,e.TEXTURE_WRAP_S,r.convert(s.wrapS)),e.texParameteri(o,e.TEXTURE_WRAP_T,r.convert(s.wrapT)),e.texParameteri(o,e.TEXTURE_MAG_FILTER,r.convert(s.magFilter)),e.texParameteri(o,e.TEXTURE_MIN_FILTER,r.convert(s.minFilter))):(e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),s.wrapS===de&&s.wrapT===de||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",s),e.texParameteri(o,e.TEXTURE_MAG_FILTER,h(s.magFilter)),e.texParameteri(o,e.TEXTURE_MIN_FILTER,h(s.minFilter)),s.minFilter!==fe&&s.minFilter!==ve&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",s)),l=t.get("EXT_texture_filter_anisotropic")){if(s.type===Ce&&null===t.get("OES_texture_float_linear"))return;if(s.type===Ne&&null===t.get("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(o,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,n.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function m(t,n,s,a){var l=r.convert(n.texture.format),c=r.convert(n.texture.type);o.texImage2D(a,0,l,n.width,n.height,0,l,c,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,s,a,i.get(n.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function y(t,o){e.bindRenderbuffer(e.RENDERBUFFER,t),o.depthBuffer&&!o.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,o.width,o.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):o.depthBuffer&&o.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,o.width,o.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,o.width,o.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function v(t){var o=i.get(t),n=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,o){if(o&&o.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!o.depthTexture||!o.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(o.depthTexture).__webglTexture&&o.depthTexture.image.width===o.width&&o.depthTexture.image.height===o.height||(o.depthTexture.image.width=o.width,o.depthTexture.image.height=o.height,o.depthTexture.needsUpdate=!0),p(o.depthTexture,0);var n=i.get(o.depthTexture).__webglTexture;if(o.depthTexture.format===Fe)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,n,0);else{if(o.depthTexture.format!==He)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,n,0)}}(o.__webglFramebuffer,t)}else if(n){o.__webglDepthbuffer=[];for(var r=0;r<6;r++)e.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer[r]),o.__webglDepthbuffer[r]=e.createRenderbuffer(),y(o.__webglDepthbuffer[r],t)}else e.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer),o.__webglDepthbuffer=e.createRenderbuffer(),y(o.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=p,this.setTextureCube=function(t,a){var h=i.get(t);if(6===t.image.length)if(t.version>0&&h.__version!==t.version){h.__image__webglTextureCube||(t.addEventListener("dispose",g),h.__image__webglTextureCube=e.createTexture(),s.textures++),o.activeTexture(e.TEXTURE0+a),o.bindTexture(e.TEXTURE_CUBE_MAP,h.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var d=t&&t.isCompressedTexture,p=t.image[0]&&t.image[0].isDataTexture,m=[],y=0;y<6;y++)m[y]=d||p?p?t.image[y].image:t.image[y]:l(t.image[y],n.maxCubemapSize);var v=m[0],E=c(v),_=r.convert(t.format),T=r.convert(t.type);f(e.TEXTURE_CUBE_MAP,t,E);for(var y=0;y<6;y++)if(d)for(var b,M=m[y].mipmaps,A=0,S=M.length;A<S;A++)b=M[A],t.format!==ke&&t.format!==Oe?o.getCompressedTextureFormats().indexOf(_)>-1?o.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,A,_,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):o.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,A,_,b.width,b.height,0,_,T,b.data);else p?o.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,_,m[y].width,m[y].height,0,_,T,m[y].data):o.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,_,_,T,m[y]);u(t,E)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),h.__version=t.version,t.onUpdate&&t.onUpdate(t)}else o.activeTexture(e.TEXTURE0+a),o.bindTexture(e.TEXTURE_CUBE_MAP,h.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,n){o.activeTexture(e.TEXTURE0+n),o.bindTexture(e.TEXTURE_CUBE_MAP,i.get(t).__webglTexture)},this.setupRenderTarget=function(t){var n=i.get(t),r=i.get(t.texture);t.addEventListener("dispose",d),r.__webglTexture=e.createTexture(),s.textures++;var a=!0===t.isWebGLRenderTargetCube,l=c(t);if(a){n.__webglFramebuffer=[];for(var h=0;h<6;h++)n.__webglFramebuffer[h]=e.createFramebuffer()}else n.__webglFramebuffer=e.createFramebuffer();if(a){o.bindTexture(e.TEXTURE_CUBE_MAP,r.__webglTexture),f(e.TEXTURE_CUBE_MAP,t.texture,l);for(var h=0;h<6;h++)m(n.__webglFramebuffer[h],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+h);u(t.texture,l)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),o.bindTexture(e.TEXTURE_CUBE_MAP,null)}else o.bindTexture(e.TEXTURE_2D,r.__webglTexture),f(e.TEXTURE_2D,t.texture,l),m(n.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),u(t.texture,l)&&e.generateMipmap(e.TEXTURE_2D),o.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&v(t)},this.updateRenderTargetMipmap=function(t){var n=t.texture,r=c(t);if(u(n,r)){var s=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=i.get(n).__webglTexture;o.bindTexture(s,a),e.generateMipmap(s),o.bindTexture(s,null)}}}function nn(e){Zo.call(this),this.cameras=e||[]}function rn(e,t){return{convert:function(o){var i;if(o===ge)return e.REPEAT;if(o===de)return e.CLAMP_TO_EDGE;if(o===pe)return e.MIRRORED_REPEAT;if(o===fe)return e.NEAREST;if(o===me)return e.NEAREST_MIPMAP_NEAREST;if(o===ye)return e.NEAREST_MIPMAP_LINEAR;if(o===ve)return e.LINEAR;if(o===Ee)return e.LINEAR_MIPMAP_NEAREST;if(o===_e)return e.LINEAR_MIPMAP_LINEAR;if(o===Te)return e.UNSIGNED_BYTE;if(o===Le)return e.UNSIGNED_SHORT_4_4_4_4;if(o===Ie)return e.UNSIGNED_SHORT_5_5_5_1;if(o===Re)return e.UNSIGNED_SHORT_5_6_5;if(o===be)return e.BYTE;if(o===Me)return e.SHORT;if(o===Ae)return e.UNSIGNED_SHORT;if(o===Se)return e.INT;if(o===we)return e.UNSIGNED_INT;if(o===Ce)return e.FLOAT;if(o===Ne&&null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES;if(o===xe)return e.ALPHA;if(o===Oe)return e.RGB;if(o===ke)return e.RGBA;if(o===Be)return e.LUMINANCE;if(o===Pe)return e.LUMINANCE_ALPHA;if(o===Fe)return e.DEPTH_COMPONENT;if(o===He)return e.DEPTH_STENCIL;if(o===C)return e.FUNC_ADD;if(o===N)return e.FUNC_SUBTRACT;if(o===L)return e.FUNC_REVERSE_SUBTRACT;if(o===D)return e.ZERO;if(o===x)return e.ONE;if(o===O)return e.SRC_COLOR;if(o===k)return e.ONE_MINUS_SRC_COLOR;if(o===B)return e.SRC_ALPHA;if(o===P)return e.ONE_MINUS_SRC_ALPHA;if(o===U)return e.DST_ALPHA;if(o===F)return e.ONE_MINUS_DST_ALPHA;if(o===H)return e.DST_COLOR;if(o===j)return e.ONE_MINUS_DST_COLOR;if(o===z)return e.SRC_ALPHA_SATURATE;if((o===je||o===ze||o===Ve||o===Ge)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(o===je)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===ze)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===Ve)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===Ge)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((o===We||o===Ye||o===Xe||o===Ke)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(o===We)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Ye)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Xe)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===Ke)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(o===Qe&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((o===I||o===R)&&null!==(i=t.get("EXT_blend_minmax"))){if(o===I)return i.MIN_EXT;if(o===R)return i.MAX_EXT}return o===De&&null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:0}}}function sn(e){console.log("THREE.WebGLRenderer",l);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),o=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,n=void 0===e.depth||e.depth,r=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,d=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,p=[],f=[],E=null,_=[],C=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=te,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var N,L,I,R,D,x,O,k,B,P,U,F,H,j,z,J,$,Z,ee,oe=this,ie=!1,ne=null,re=null,se=-1,ae="",le=null,ce=null,ue=new _t,he=new _t,ge=null,de=0,pe=t.width,fe=t.height,me=1,ye=new _t(0,0,pe,fe),ve=new _t(0,0,pe,fe),Ee=!1,_e=new Ho,be=new function(){var e=this,t=null,o=0,i=!1,n=!1,r=new Fo,s=new Uo,a={value:null,needsUpdate:!1};function l(){a.value!==t&&(a.value=t,a.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function c(t,o,i,n){var l=null!==t?t.length:0,c=null;if(0!==l){if(c=a.value,!0!==n||null===c){var u=i+4*l,h=o.matrixWorldInverse;s.getNormalMatrix(h),(null===c||c.length<u)&&(c=new Float32Array(u));for(var g=0,d=i;g!==l;++g,d+=4)r.copy(t[g]).applyMatrix4(h,s),r.normal.toArray(c,d),c[d+3]=r.constant}a.value=c,a.needsUpdate=!0}return e.numPlanes=l,c}this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(e,n,r){var s=0!==e.length||n||0!==o||i;return i=n,t=c(e,r,0),o=e.length,s},this.beginShadows=function(){n=!0,c(null)},this.endShadows=function(){n=!1,l()},this.setState=function(e,r,s,u,h,g){if(!i||null===e||0===e.length||n&&!s)n?c(null):l();else{var d=n?0:o,p=4*d,f=h.clippingState||null;a.value=f,f=c(e,u,p,g);for(var m=0;m!==p;++m)f[m]=t[m];h.clippingState=f,this.numIntersection=r?this.numPlanes:0,this.numPlanes+=d}}},Me=!1,Ae=!1,Se=new St,we=new At,Le={geometries:0,textures:0},Ie={frame:0,calls:0,vertices:0,faces:0,points:0};function Re(){return null===ne?me:1}this.info={render:Ie,memory:Le,programs:null};try{var De={alpha:i,depth:n,stencil:r,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:d};if(null===(N=o||t.getContext("webgl",De)||t.getContext("experimental-webgl",De)))throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===N.getShaderPrecisionFormat&&(N.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),t.addEventListener("webglcontextlost",Pe,!1),t.addEventListener("webglcontextrestored",Ue,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}function xe(){(L=new function(e){var t={};return{get:function(o){if(void 0!==t[o])return t[o];var i;switch(o){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=e.getExtension("WEBGL_compressed_texture_etc1");break;default:i=e.getExtension(o)}return null===i&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),t[o]=i,i}}}(N)).get("WEBGL_depth_texture"),L.get("OES_texture_float"),L.get("OES_texture_float_linear"),L.get("OES_texture_half_float"),L.get("OES_texture_half_float_linear"),L.get("OES_standard_derivatives"),L.get("ANGLE_instanced_arrays"),L.get("OES_element_index_uint")&&(Si.MaxIndex=4294967296),ee=new rn(N,L),I=new function(e,t,o){var i;function n(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var r=void 0!==o.precision?o.precision:"highp",s=n(r);s!==r&&(console.warn("THREE.WebGLRenderer:",r,"not supported, using",s,"instead."),r=s);var a=!0===o.logarithmicDepthBuffer&&!!t.get("EXT_frag_depth"),l=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_TEXTURE_SIZE),h=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),g=e.getParameter(e.MAX_VERTEX_ATTRIBS),d=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),p=e.getParameter(e.MAX_VARYING_VECTORS),f=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),m=c>0,y=!!t.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var o=t.get("EXT_texture_filter_anisotropic");return i=null!==o?e.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:r,logarithmicDepthBuffer:a,maxTextures:l,maxVertexTextures:c,maxTextureSize:u,maxCubemapSize:h,maxAttributes:g,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:y,floatVertexTextures:m&&y}}(N,L,e),(R=new function(e,t,o){var i=new function(){var t=!1,o=new _t,i=null,n=new _t(0,0,0,0);return{setMask:function(o){i===o||t||(e.colorMask(o,o,o,o),i=o)},setLocked:function(e){t=e},setClear:function(t,i,r,s,a){!0===a&&(t*=s,i*=s,r*=s),o.set(t,i,r,s),!1===n.equals(o)&&(e.clearColor(t,i,r,s),n.copy(o))},reset:function(){t=!1,i=null,n.set(-1,0,0,0)}}},n=new function(){var t=!1,o=null,i=null,n=null;return{setTest:function(t){t?ee(e.DEPTH_TEST):te(e.DEPTH_TEST)},setMask:function(i){o===i||t||(e.depthMask(i),o=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case V:e.depthFunc(e.NEVER);break;case G:e.depthFunc(e.ALWAYS);break;case W:e.depthFunc(e.LESS);break;case Y:e.depthFunc(e.LEQUAL);break;case X:e.depthFunc(e.EQUAL);break;case K:e.depthFunc(e.GEQUAL);break;case Q:e.depthFunc(e.GREATER);break;case q:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);i=t}},setLocked:function(e){t=e},setClear:function(t){n!==t&&(e.clearDepth(t),n=t)},reset:function(){t=!1,o=null,i=null,n=null}}},r=new function(){var t=!1,o=null,i=null,n=null,r=null,s=null,a=null,l=null,c=null;return{setTest:function(t){t?ee(e.STENCIL_TEST):te(e.STENCIL_TEST)},setMask:function(i){o===i||t||(e.stencilMask(i),o=i)},setFunc:function(t,o,s){i===t&&n===o&&r===s||(e.stencilFunc(t,o,s),i=t,n=o,r=s)},setOp:function(t,o,i){s===t&&a===o&&l===i||(e.stencilOp(t,o,i),s=t,a=o,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,o=null,i=null,n=null,r=null,s=null,a=null,l=null,c=null}}},s=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=new Uint8Array(s),l=new Uint8Array(s),g=new Uint8Array(s),d={},p=null,f=null,v=null,E=null,_=null,C=null,N=null,L=null,I=null,R=!1,D=null,x=null,O=null,k=null,B=null,P=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),U=parseFloat(/^WebGL\ ([0-9])/.exec(e.getParameter(e.VERSION))[1]),F=parseFloat(U)>=1,H=null,j={},z=new _t,J=new _t;function $(t,o,i){var n=new Uint8Array(4),r=e.createTexture();e.bindTexture(t,r),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var s=0;s<i;s++)e.texImage2D(o+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,n);return r}var Z={};function ee(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function te(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}function oe(t,i,n,r,s,a,l,c){if(t!==T?ee(e.BLEND):te(e.BLEND),t!==w){if(t!==v||c!==R)switch(t){case M:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case A:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case S:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}E=null,_=null,C=null,N=null,L=null,I=null}else s=s||i,a=a||n,l=l||r,i===E&&s===N||(e.blendEquationSeparate(o.convert(i),o.convert(s)),E=i,N=s),n===_&&r===C&&a===L&&l===I||(e.blendFuncSeparate(o.convert(n),o.convert(r),o.convert(a),o.convert(l)),_=n,C=r,L=a,I=l);v=t,R=c}function ie(t){D!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),D=t)}function ne(t){t!==c?(ee(e.CULL_FACE),t!==x&&(t===u?e.cullFace(e.BACK):t===h?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):te(e.CULL_FACE),x=t}function re(t,o,i){t?(ee(e.POLYGON_OFFSET_FILL),k===o&&B===i||(e.polygonOffset(o,i),k=o,B=i)):te(e.POLYGON_OFFSET_FILL)}function se(t){void 0===t&&(t=e.TEXTURE0+P-1),H!==t&&(e.activeTexture(t),H=t)}return Z[e.TEXTURE_2D]=$(e.TEXTURE_2D,e.TEXTURE_2D,1),Z[e.TEXTURE_CUBE_MAP]=$(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),n.setClear(1),r.setClear(0),ee(e.DEPTH_TEST),n.setFunc(Y),ie(!1),ne(u),ee(e.CULL_FACE),ee(e.BLEND),oe(b),{buffers:{color:i,depth:n,stencil:r},initAttributes:function(){for(var e=0,t=a.length;e<t;e++)a[e]=0},enableAttribute:function(o){if(a[o]=1,0===l[o]&&(e.enableVertexAttribArray(o),l[o]=1),0!==g[o]){var i=t.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(o,0),g[o]=0}},enableAttributeAndDivisor:function(o,i){if(a[o]=1,0===l[o]&&(e.enableVertexAttribArray(o),l[o]=1),g[o]!==i){var n=t.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(o,i),g[o]=i}},disableUnusedAttributes:function(){for(var t=0,o=l.length;t!==o;++t)l[t]!==a[t]&&(e.disableVertexAttribArray(t),l[t]=0)},enable:ee,disable:te,getCompressedTextureFormats:function(){if(null===p&&(p=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var o=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),i=0;i<o.length;i++)p.push(o[i]);return p},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:oe,setMaterial:function(t){t.side===y?te(e.CULL_FACE):ee(e.CULL_FACE),ie(t.side===m),!0===t.transparent?oe(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):oe(T),n.setFunc(t.depthFunc),n.setTest(t.depthTest),n.setMask(t.depthWrite),i.setMask(t.colorWrite),re(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ie,setCullFace:ne,setLineWidth:function(t){t!==O&&(F&&e.lineWidth(t),O=t)},setPolygonOffset:re,setScissorTest:function(t){t?ee(e.SCISSOR_TEST):te(e.SCISSOR_TEST)},activeTexture:se,bindTexture:function(t,o){null===H&&se();var i=j[H];void 0===i&&(i={type:void 0,texture:void 0},j[H]=i),i.type===t&&i.texture===o||(e.bindTexture(t,o||Z[t]),i.type=t,i.texture=o)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===z.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),z.copy(t))},viewport:function(t){!1===J.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),J.copy(t))},reset:function(){for(var t=0;t<l.length;t++)1===l[t]&&(e.disableVertexAttribArray(t),l[t]=0);d={},p=null,H=null,j={},f=null,v=null,D=null,x=null,i.reset(),n.reset(),r.reset()}}}(N,L,ee)).scissor(he.copy(ve).multiplyScalar(me)),R.viewport(ue.copy(ye).multiplyScalar(me)),D=new function(){var e={};return{get:function(t){var o=t.uuid,i=e[o];return void 0===i&&(i={},e[o]=i),i},remove:function(t){delete e[t.uuid]},clear:function(){e={}}}},x=new on(N,L,R,D,I,ee,Le),O=new zo(N),k=new function(e,t,o){var i={},n={};function r(e){var s=e.target,a=i[s.id];for(var l in null!==a.index&&t.remove(a.index),a.attributes)t.remove(a.attributes[l]);s.removeEventListener("dispose",r),delete i[s.id];var c=n[s.id];c&&(t.remove(c),delete n[s.id]),(c=n[a.id])&&(t.remove(c),delete n[a.id]),o.geometries--}return{get:function(e,t){var n=i[t.id];return n||(t.addEventListener("dispose",r),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Si).setFromObject(e)),n=t._bufferGeometry),i[t.id]=n,o.geometries++,n)},update:function(o){var i=o.index,n=o.attributes;for(var r in null!==i&&t.update(i,e.ELEMENT_ARRAY_BUFFER),n)t.update(n[r],e.ARRAY_BUFFER);var s=o.morphAttributes;for(var r in s)for(var a=s[r],l=0,c=a.length;l<c;l++)t.update(a[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(o){var i=n[o.id];if(i)return i;var r=[],s=o.index,a=o.attributes;if(null!==s)for(var l=s.array,c=0,u=l.length;c<u;c+=3){var h=l[c+0],g=l[c+1],d=l[c+2];r.push(h,g,g,d,d,h)}else for(var l=a.position.array,c=0,u=l.length/3-1;c<u;c+=3){var h=c+0,g=c+1,d=c+2;r.push(h,g,g,d,d,h)}return i=new(Ai(r)>65535?_i:vi)(r,1),t.update(i,e.ELEMENT_ARRAY_BUFFER),n[o.id]=i,i}}}(N,O,Le),B=new function(e,t){var o={};return{update:function(i){var n=t.frame,r=i.geometry,s=e.get(i,r);return o[s.id]!==n&&(r.isGeometry&&s.updateFromObject(i),e.update(s),o[s.id]=n),s},clear:function(){o={}}}}(k,Ie),j=new function(e){var t={},o=new Float32Array(8);return{update:function(i,n,r,s){var a=i.morphTargetInfluences,l=a.length,c=t[n.id];if(void 0===c){c=[];for(var u=0;u<l;u++)c[u]=[u,0];t[n.id]=c}for(var h=r.morphTargets&&n.morphAttributes.position,g=r.morphNormals&&n.morphAttributes.normal,u=0;u<l;u++){var d=c[u];0!==d[1]&&(h&&n.removeAttribute("morphTarget"+u),g&&n.removeAttribute("morphNormal"+u))}for(var u=0;u<l;u++){var d=c[u];d[0]=u,d[1]=a[u]}c.sort(Ui);for(var u=0;u<8;u++){var d=c[u];if(d){var p=d[0],f=d[1];if(f){h&&n.addAttribute("morphTarget"+u,h[p]),g&&n.addAttribute("morphNormal"+u,g[p]),o[u]=f;continue}}o[u]=0}s.getUniforms().setValue(e,"morphTargetInfluences",o)}}}(N),U=new tn(oe,L,I),P=new Fi,F=new Pi,H=new function(e,t,o,i){var n,r,s,a=new fo(0),l=0;function c(e,o){t.buffers.color.setClear(e.r,e.g,e.b,o,i)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),c(a,l=void 0!==t?t:1)},getClearAlpha:function(){return l},setClearAlpha:function(e){c(a,l=e)},render:function(t,i,u,h){var g=i.background;null===g?c(a,l):g&&g.isColor&&(c(g,1),h=!0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&g.isCubeTexture?(void 0===s&&((s=new Oi(new Ci(1,1,1),new xo({uniforms:Eo.cube.uniforms,vertexShader:Eo.cube.vertexShader,fragmentShader:Eo.cube.fragmentShader,side:m,depthTest:!0,depthWrite:!1,polygonOffset:!0,fog:!1}))).geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(e,t,o){var i=o.far;this.matrixWorld.makeScale(i,i,i),this.matrixWorld.copyPosition(o.matrixWorld),this.material.polygonOffsetUnits=10*i},o.update(s.geometry)),s.material.uniforms.tCube.value=g,t.push(s,s.geometry,s.material,0,null)):g&&g.isTexture&&(void 0===n&&(n=new $o(-1,1,1,-1,0,1),r=new Oi(new Li(2,2),new Ii({depthTest:!1,depthWrite:!1,fog:!1})),o.update(r.geometry)),r.material.map=g,e.renderBufferDirect(n,null,r.geometry,r.material,r,null))}}}(oe,R,k,a),z=new function(e,t,o){var i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),o.calls++,o.vertices+=n,i===e.TRIANGLES?o.faces+=n/3:i===e.POINTS&&(o.points+=n)},this.renderInstances=function(n,r,s){var a=t.get("ANGLE_instanced_arrays");if(null!==a){var l=n.attributes.position;l.isInterleavedBufferAttribute?(s=l.data.count,a.drawArraysInstancedANGLE(i,0,s,n.maxInstancedCount)):a.drawArraysInstancedANGLE(i,r,s,n.maxInstancedCount),o.calls++,o.vertices+=s*n.maxInstancedCount,i===e.TRIANGLES?o.faces+=n.maxInstancedCount*s/3:i===e.POINTS&&(o.points+=n.maxInstancedCount*s)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(N,L,Ie),J=new function(e,t,o){var i,n,r;this.setMode=function(e){i=e},this.setIndex=function(e){n=e.type,r=e.bytesPerElement},this.render=function(t,s){e.drawElements(i,s,n,t*r),o.calls++,o.vertices+=s,i===e.TRIANGLES?o.faces+=s/3:i===e.POINTS&&(o.points+=s)},this.renderInstances=function(s,a,l){var c=t.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(i,l,n,a*r,s.maxInstancedCount),o.calls++,o.vertices+=l*s.maxInstancedCount,i===e.TRIANGLES?o.faces+=s.maxInstancedCount*l/3:i===e.POINTS&&(o.points+=s.maxInstancedCount*l)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(N,L,Ie),$=new To(oe,N,R,x,I),Z=new Mo(oe,N,R,x,I),oe.info.programs=U.programs,oe.context=N,oe.capabilities=I,oe.extensions=L,oe.properties=D,oe.renderLists=F,oe.state=R}xe();var Oe=new function(e){var t=this,o=null,i=null;"VRFrameData"in window&&(i=new window.VRFrameData);var n=new St,r=new St,s=new St,a=new Zo;a.bounds=new _t(0,0,.5,1),a.layers.enable(1);var l=new Zo;l.bounds=new _t(.5,0,.5,1),l.layers.enable(2);var c,u,h=new nn([a,l]);function g(){if(null!==o&&o.isPresenting){var i=o.getEyeParameters("left"),n=i.renderWidth,r=i.renderHeight;u=e.getPixelRatio(),c=e.getSize(),e.setDrawingBufferSize(2*n,r,1)}else t.enabled&&e.setDrawingBufferSize(c.width,c.height,u)}h.layers.enable(1),h.layers.enable(2),window.addEventListener("vrdisplaypresentchange",g,!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return o},this.setDevice=function(e){void 0!==e&&(o=e)},this.getCamera=function(e){if(null===o)return e;o.depthNear=e.near,o.depthFar=e.far,o.getFrameData(i);var t=i.pose;null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),null!==t.orientation&&e.quaternion.fromArray(t.orientation),e.updateMatrixWorld();var c=o.stageParameters;if(this.standing&&c&&(r.fromArray(c.sittingToStandingTransform),s.getInverse(r),e.matrixWorld.multiply(r),e.matrixWorldInverse.multiply(s)),!1===o.isPresenting)return e;a.near=e.near,l.near=e.near,a.far=e.far,l.far=e.far,h.matrixWorld.copy(e.matrixWorld),h.matrixWorldInverse.copy(e.matrixWorldInverse),a.matrixWorldInverse.fromArray(i.leftViewMatrix),l.matrixWorldInverse.fromArray(i.rightViewMatrix),this.standing&&c&&(a.matrixWorldInverse.multiply(s),l.matrixWorldInverse.multiply(s));var u=e.parent;null!==u&&(n.getInverse(u.matrixWorld),a.matrixWorldInverse.multiply(n),l.matrixWorldInverse.multiply(n)),a.matrixWorld.getInverse(a.matrixWorldInverse),l.matrixWorld.getInverse(l.matrixWorldInverse),a.projectionMatrix.fromArray(i.leftProjectionMatrix),l.projectionMatrix.fromArray(i.rightProjectionMatrix),h.projectionMatrix.copy(a.projectionMatrix);var g=o.getLayers();if(g.length){var d=g[0];null!==d.leftBounds&&4===d.leftBounds.length&&a.bounds.fromArray(d.leftBounds),null!==d.rightBounds&&4===d.rightBounds.length&&l.bounds.fromArray(d.rightBounds)}return h},this.getStandingMatrix=function(){return r},this.submitFrame=function(){o&&o.isPresenting&&o.submitFrame()},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",g)}}(oe);this.vr=Oe;var Be=new jo(oe,B,I.maxTextureSize);function Pe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ie=!0}function Ue(e){console.log("THREE.WebGLRenderer: Context Restored."),ie=!1,xe()}function Fe(e){var t=e.target;t.removeEventListener("dispose",Fe),function(e){He(e),D.remove(e)}(t)}function He(e){var t=D.get(e).program;e.program=void 0,void 0!==t&&U.releaseProgram(t)}this.shadowMap=Be,this.getContext=function(){return N},this.getContextAttributes=function(){return N.getContextAttributes()},this.forceContextLoss=function(){var e=L.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=L.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return me},this.setPixelRatio=function(e){void 0!==e&&(me=e,this.setSize(pe,fe,!1))},this.getSize=function(){return{width:pe,height:fe}},this.setSize=function(e,o,i){var n=Oe.getDevice();n&&n.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(pe=e,fe=o,t.width=e*me,t.height=o*me,!1!==i&&(t.style.width=e+"px",t.style.height=o+"px"),this.setViewport(0,0,e,o))},this.getDrawingBufferSize=function(){return{width:pe*me,height:fe*me}},this.setDrawingBufferSize=function(e,o,i){pe=e,fe=o,me=i,t.width=e*i,t.height=o*i,this.setViewport(0,0,e,o)},this.setViewport=function(e,t,o,i){ye.set(e,fe-t-i,o,i),R.viewport(ue.copy(ye).multiplyScalar(me))},this.setScissor=function(e,t,o,i){ve.set(e,fe-t-i,o,i),R.scissor(he.copy(ve).multiplyScalar(me))},this.setScissorTest=function(e){R.setScissorTest(Ee=e)},this.getClearColor=H.getClearColor,this.setClearColor=H.setClearColor,this.getClearAlpha=H.getClearAlpha,this.setClearAlpha=H.setClearAlpha,this.clear=function(e,t,o){var i=0;(void 0===e||e)&&(i|=N.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=N.DEPTH_BUFFER_BIT),(void 0===o||o)&&(i|=N.STENCIL_BUFFER_BIT),N.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,o,i){this.setRenderTarget(e),this.clear(t,o,i)},this.dispose=function(){t.removeEventListener("webglcontextlost",Pe,!1),t.removeEventListener("webglcontextrestored",Ue,!1),F.dispose(),Oe.dispose()},this.renderBufferImmediate=function(e,t,o){R.initAttributes();var i=D.get(e);e.hasPositions&&!i.position&&(i.position=N.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=N.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=N.createBuffer()),e.hasColors&&!i.color&&(i.color=N.createBuffer());var n=t.getAttributes();if(e.hasPositions&&(N.bindBuffer(N.ARRAY_BUFFER,i.position),N.bufferData(N.ARRAY_BUFFER,e.positionArray,N.DYNAMIC_DRAW),R.enableAttribute(n.position),N.vertexAttribPointer(n.position,3,N.FLOAT,!1,0,0)),e.hasNormals){if(N.bindBuffer(N.ARRAY_BUFFER,i.normal),!o.isMeshPhongMaterial&&!o.isMeshStandardMaterial&&!o.isMeshNormalMaterial&&!0===o.flatShading)for(var r=0,s=3*e.count;r<s;r+=9){var a=e.normalArray,l=(a[r+0]+a[r+3]+a[r+6])/3,c=(a[r+1]+a[r+4]+a[r+7])/3,u=(a[r+2]+a[r+5]+a[r+8])/3;a[r+0]=l,a[r+1]=c,a[r+2]=u,a[r+3]=l,a[r+4]=c,a[r+5]=u,a[r+6]=l,a[r+7]=c,a[r+8]=u}N.bufferData(N.ARRAY_BUFFER,e.normalArray,N.DYNAMIC_DRAW),R.enableAttribute(n.normal),N.vertexAttribPointer(n.normal,3,N.FLOAT,!1,0,0)}e.hasUvs&&o.map&&(N.bindBuffer(N.ARRAY_BUFFER,i.uv),N.bufferData(N.ARRAY_BUFFER,e.uvArray,N.DYNAMIC_DRAW),R.enableAttribute(n.uv),N.vertexAttribPointer(n.uv,2,N.FLOAT,!1,0,0)),e.hasColors&&o.vertexColors!==v&&(N.bindBuffer(N.ARRAY_BUFFER,i.color),N.bufferData(N.ARRAY_BUFFER,e.colorArray,N.DYNAMIC_DRAW),R.enableAttribute(n.color),N.vertexAttribPointer(n.color,3,N.FLOAT,!1,0,0)),R.disableUnusedAttributes(),N.drawArrays(N.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,o,i,n,r){R.setMaterial(i);var s=Ke(e,t,i,n),a=o.id+"_"+s.id+"_"+(!0===i.wireframe),l=!1;a!==ae&&(ae=a,l=!0),n.morphTargetInfluences&&(j.update(n,o,i,s),l=!0);var c,u=o.index,h=o.attributes.position,g=1;!0===i.wireframe&&(u=k.getWireframeAttribute(o),g=2);var d=z;null!==u&&(c=O.get(u),(d=J).setIndex(c)),l&&(function(e,t,o,i){if(o&&o.isInstancedBufferGeometry&&null===L.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===i&&(i=0),R.initAttributes();var n=o.attributes,r=t.getAttributes(),s=e.defaultAttributeValues;for(var a in r){var l=r[a];if(l>=0){var c=n[a];if(void 0!==c){var u=c.normalized,h=c.itemSize,g=O.get(c);if(void 0===g)continue;var d=g.buffer,p=g.type,f=g.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,y=m.stride,v=c.offset;m&&m.isInstancedInterleavedBuffer?(R.enableAttributeAndDivisor(l,m.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=m.meshPerAttribute*m.count)):R.enableAttribute(l),N.bindBuffer(N.ARRAY_BUFFER,d),N.vertexAttribPointer(l,h,p,u,y*f,(i*y+v)*f)}else c.isInstancedBufferAttribute?(R.enableAttributeAndDivisor(l,c.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=c.meshPerAttribute*c.count)):R.enableAttribute(l),N.bindBuffer(N.ARRAY_BUFFER,d),N.vertexAttribPointer(l,h,p,u,0,i*h*f)}else if(void 0!==s){var E=s[a];if(void 0!==E)switch(E.length){case 2:N.vertexAttrib2fv(l,E);break;case 3:N.vertexAttrib3fv(l,E);break;case 4:N.vertexAttrib4fv(l,E);break;default:N.vertexAttrib1fv(l,E)}}}}R.disableUnusedAttributes()}}(i,s,o),null!==u&&N.bindBuffer(N.ELEMENT_ARRAY_BUFFER,c.buffer));var p=0;null!==u?p=u.count:void 0!==h&&(p=h.count);var f=o.drawRange.start*g,m=o.drawRange.count*g,y=null!==r?r.start*g:0,v=null!==r?r.count*g:1/0,E=Math.max(f,y),_=Math.min(p,f+m,y+v)-1,T=Math.max(0,_-E+1);if(0!==T){if(n.isMesh)if(!0===i.wireframe)R.setLineWidth(i.wireframeLinewidth*Re()),d.setMode(N.LINES);else switch(n.drawMode){case $e:d.setMode(N.TRIANGLES);break;case Ze:d.setMode(N.TRIANGLE_STRIP);break;case et:d.setMode(N.TRIANGLE_FAN)}else if(n.isLine){var b=i.linewidth;void 0===b&&(b=1),R.setLineWidth(b*Re()),n.isLineSegments?d.setMode(N.LINES):n.isLineLoop?d.setMode(N.LINE_LOOP):d.setMode(N.LINE_STRIP)}else n.isPoints&&d.setMode(N.POINTS);o&&o.isInstancedBufferGeometry?o.maxInstancedCount>0&&d.renderInstances(o,E,T):d.render(E,T)}},this.compile=function(e,t){p.length=0,f.length=0,e.traverse(function(e){e.isLight&&(p.push(e),e.castShadow&&f.push(e))}),P.setup(p,f,t),e.traverse(function(o){if(o.material)if(Array.isArray(o.material))for(var i=0;i<o.material.length;i++)Xe(o.material[i],e.fog,o);else Xe(o.material,e.fog,o),Ke(t,e.fog,o.material,o)})};var je,ze=!1,Ve=null;function Ge(e){null!==Ve&&Ve(e),(Oe.getDevice()||window).requestAnimationFrame(Ge)}function We(e,t,o,i){for(var n=0,r=e.length;n<r;n++){var s=e[n],a=s.object,l=s.geometry,c=void 0===i?s.material:i,u=s.group;if(o.isArrayCamera){ce=o;for(var h=o.cameras,g=0,d=h.length;g<d;g++){var p=h[g];if(a.layers.test(p.layers)){var f=p.bounds,m=f.x*pe,y=f.y*fe,v=f.z*pe,E=f.w*fe;R.viewport(ue.set(m,y,v,E).multiplyScalar(me)),Ye(a,t,p,l,c,u)}}}else ce=null,Ye(a,t,o,l,c,u)}}function Ye(e,t,o,i,n,r){if(e.onBeforeRender(oe,t,o,i,n,r),e.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){R.setMaterial(n);var s=Ke(o,t.fog,n,e);ae="",function(e,t,o){e.render(function(e){oe.renderBufferImmediate(e,t,o)})}(e,s,n)}else oe.renderBufferDirect(o,t.fog,i,n,e,r);e.onAfterRender(oe,t,o,i,n,r)}function Xe(e,t,o){var i=D.get(e),n=U.getParameters(e,P.state,f,t,be.numPlanes,be.numIntersection,o),r=U.getProgramCode(e,n),s=i.program,a=!0;if(void 0===s)e.addEventListener("dispose",Fe);else if(s.code!==r)He(e);else{if(void 0!==n.shaderID)return;a=!1}if(a){if(n.shaderID){var l=Eo[n.shaderID];i.shader={name:e.type,uniforms:yo.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else i.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(i.shader),s=U.acquireProgram(e,i.shader,n,r),i.program=s,e.program=s}var c=s.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var u=0;u<oe.maxMorphTargets;u++)c["morphTarget"+u]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(var u=0;u<oe.maxMorphNormals;u++)c["morphNormal"+u]>=0&&e.numSupportedMorphNormals++}var h=i.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=be.numPlanes,i.numIntersection=be.numIntersection,h.clippingPlanes=be.uniform),i.fog=t,i.lightsHash=P.state.hash,e.lights&&(h.ambientLightColor.value=P.state.ambient,h.directionalLights.value=P.state.directional,h.spotLights.value=P.state.spot,h.rectAreaLights.value=P.state.rectArea,h.pointLights.value=P.state.point,h.hemisphereLights.value=P.state.hemi,h.directionalShadowMap.value=P.state.directionalShadowMap,h.directionalShadowMatrix.value=P.state.directionalShadowMatrix,h.spotShadowMap.value=P.state.spotShadowMap,h.spotShadowMatrix.value=P.state.spotShadowMatrix,h.pointShadowMap.value=P.state.pointShadowMap,h.pointShadowMatrix.value=P.state.pointShadowMatrix);var g=i.program.getUniforms(),d=go.seqWithValue(g.seq,h);i.uniformsList=d}function Ke(e,t,o,i){de=0;var n=D.get(o);if(Me&&(Ae||e!==le)){var r=e===le&&o.id===se;be.setState(o.clippingPlanes,o.clipIntersection,o.clipShadows,e,n,r)}!1===o.needsUpdate&&(void 0===n.program?o.needsUpdate=!0:o.fog&&n.fog!==t?o.needsUpdate=!0:o.lights&&n.lightsHash!==P.state.hash?o.needsUpdate=!0:void 0===n.numClippingPlanes||n.numClippingPlanes===be.numPlanes&&n.numIntersection===be.numIntersection||(o.needsUpdate=!0)),o.needsUpdate&&(Xe(o,t,i),o.needsUpdate=!1);var s,a,l=!1,c=!1,u=!1,h=n.program,g=h.getUniforms(),d=n.shader.uniforms;if(R.useProgram(h.program)&&(l=!0,c=!0,u=!0),o.id!==se&&(se=o.id,c=!0),l||e!==le){if(g.setValue(N,"projectionMatrix",e.projectionMatrix),I.logarithmicDepthBuffer&&g.setValue(N,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),le!==(ce||e)&&(le=ce||e,c=!0,u=!0),o.isShaderMaterial||o.isMeshPhongMaterial||o.isMeshStandardMaterial||o.envMap){var p=g.map.cameraPosition;void 0!==p&&p.setValue(N,we.setFromMatrixPosition(e.matrixWorld))}(o.isMeshPhongMaterial||o.isMeshLambertMaterial||o.isMeshBasicMaterial||o.isMeshStandardMaterial||o.isShaderMaterial||o.skinning)&&g.setValue(N,"viewMatrix",e.matrixWorldInverse)}if(o.skinning){g.setOptional(N,i,"bindMatrix"),g.setOptional(N,i,"bindMatrixInverse");var f=i.skeleton;if(f){var m=f.bones;if(I.floatVertexTextures){if(void 0===f.boneTexture){var y=Math.sqrt(4*m.length);y=ut.nextPowerOfTwo(Math.ceil(y)),y=Math.max(y,4);var v=new Float32Array(y*y*4);v.set(f.boneMatrices);var E=new wt(v,y,y,ke,Ce);f.boneMatrices=v,f.boneTexture=E,f.boneTextureSize=y}g.setValue(N,"boneTexture",f.boneTexture),g.setValue(N,"boneTextureSize",f.boneTextureSize)}else g.setOptional(N,f,"boneMatrices")}}return c&&(g.setValue(N,"toneMappingExposure",oe.toneMappingExposure),g.setValue(N,"toneMappingWhitePoint",oe.toneMappingWhitePoint),o.lights&&(a=u,(s=d).ambientLightColor.needsUpdate=a,s.directionalLights.needsUpdate=a,s.pointLights.needsUpdate=a,s.spotLights.needsUpdate=a,s.rectAreaLights.needsUpdate=a,s.hemisphereLights.needsUpdate=a),t&&o.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(d,t),o.isMeshBasicMaterial?Qe(d,o):o.isMeshLambertMaterial?(Qe(d,o),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(d,o)):o.isMeshPhongMaterial?(Qe(d,o),o.isMeshToonMaterial?function(e,t){qe(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(d,o):qe(d,o)):o.isMeshStandardMaterial?(Qe(d,o),o.isMeshPhysicalMaterial?function(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,Je(e,t)}(d,o):Je(d,o)):o.isMeshDepthMaterial?(Qe(d,o),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(d,o)):o.isMeshDistanceMaterial?(Qe(d,o),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(d,o)):o.isMeshNormalMaterial?(Qe(d,o),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(d,o)):o.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(d,o),o.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(d,o)):o.isPointsMaterial?function(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*me,e.scale.value=.5*fe,e.map.value=t.map,null!==t.map){var o=t.map.offset,i=t.map.repeat;e.offsetRepeat.value.set(o.x,o.y,i.x,i.y)}}(d,o):o.isShadowMaterial&&(d.color.value=o.color,d.opacity.value=o.opacity),void 0!==d.ltcMat&&(d.ltcMat.value=mo.LTC_MAT_TEXTURE),void 0!==d.ltcMag&&(d.ltcMag.value=mo.LTC_MAG_TEXTURE),go.upload(N,n.uniformsList,d,oe)),g.setValue(N,"modelViewMatrix",i.modelViewMatrix),g.setValue(N,"normalMatrix",i.normalMatrix),g.setValue(N,"modelMatrix",i.matrixWorld),h}function Qe(e,t){var o;if(e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?o=t.map:t.specularMap?o=t.specularMap:t.displacementMap?o=t.displacementMap:t.normalMap?o=t.normalMap:t.bumpMap?o=t.bumpMap:t.roughnessMap?o=t.roughnessMap:t.metalnessMap?o=t.metalnessMap:t.alphaMap?o=t.alphaMap:t.emissiveMap&&(o=t.emissiveMap),void 0!==o){o.isWebGLRenderTarget&&(o=o.texture);var i=o.offset,n=o.repeat;e.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}function qe(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Je(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}this.animate=function(e){Ve=e,ze||((Oe.getDevice()||window).requestAnimationFrame(Ge),ze=!0)},this.render=function(e,t,o,i){if(t&&t.isCamera){if(!ie){ae="",se=-1,le=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Oe.enabled&&(t=Oe.getCamera(t)),Se.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),_e.setFromMatrix(Se),p.length=0,f.length=0,_.length=0,C.length=0,Ae=this.localClippingEnabled,Me=be.init(this.clippingPlanes,Ae,t),(E=F.get(e,t)).init(),function e(t,o,i){if(t.visible){var n=t.layers.test(o.layers);if(n)if(t.isLight)p.push(t),t.castShadow&&f.push(t);else if(t.isSprite)t.frustumCulled&&!_e.intersectsSprite(t)||_.push(t);else if(t.isLensFlare)C.push(t);else if(t.isImmediateRenderObject)i&&we.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se),E.push(t,null,t.material,we.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||_e.intersectsObject(t))){i&&we.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se);var r=B.update(t),s=t.material;if(Array.isArray(s))for(var a=r.groups,l=0,c=a.length;l<c;l++){var u=a[l],h=s[u.materialIndex];h&&h.visible&&E.push(t,r,h,we.z,u)}else s.visible&&E.push(t,r,s,we.z,null)}for(var g=t.children,l=0,c=g.length;l<c;l++)e(g[l],o,i)}}(e,t,oe.sortObjects),!0===oe.sortObjects&&E.sort(),Me&&be.beginShadows(),Be.render(f,e,t),P.setup(p,f,t),Me&&be.endShadows(),Ie.frame++,Ie.calls=0,Ie.vertices=0,Ie.faces=0,Ie.points=0,void 0===o&&(o=null),this.setRenderTarget(o),H.render(E,e,t,i);var n=E.opaque,r=E.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;n.length&&We(n,e,t,s),r.length&&We(r,e,t,s)}else n.length&&We(n,e,t),r.length&&We(r,e,t);Z.render(_,e,t),$.render(C,e,t,ue),o&&x.updateRenderTargetMipmap(o),R.buffers.depth.setTest(!0),R.buffers.depth.setMask(!0),R.buffers.color.setMask(!0),R.setPolygonOffset(!1),Oe.enabled&&Oe.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){R.setCullFace(e),R.setFlipSided(t===g)},this.allocTextureUnit=function(){var e=de;return e>=I.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+I.maxTextures),de+=1,e},this.setTexture2D=(je=!1,function(e,t){e&&e.isWebGLRenderTarget&&(je||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),je=!0),e=e.texture),x.setTexture2D(e,t)}),this.setTexture=function(){var e=!1;return function(t,o){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),x.setTexture2D(t,o)}}(),this.setTextureCube=function(){var e=!1;return function(t,o){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?x.setTextureCube(t,o):x.setTextureCubeDynamic(t,o)}}(),this.getRenderTarget=function(){return ne},this.setRenderTarget=function(e){ne=e,e&&void 0===D.get(e).__webglFramebuffer&&x.setupRenderTarget(e);var t=null,o=!1;if(e){var i=D.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=i[e.activeCubeFace],o=!0):t=i,ue.copy(e.viewport),he.copy(e.scissor),ge=e.scissorTest}else ue.copy(ye).multiplyScalar(me),he.copy(ve).multiplyScalar(me),ge=Ee;if(re!==t&&(N.bindFramebuffer(N.FRAMEBUFFER,t),re=t),R.viewport(ue),R.scissor(he),R.setScissorTest(ge),o){var n=D.get(e.texture);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,n.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,o,i,n,r){if(e&&e.isWebGLRenderTarget){var s=D.get(e).__webglFramebuffer;if(s){var a=!1;s!==re&&(N.bindFramebuffer(N.FRAMEBUFFER,s),a=!0);try{var l=e.texture,c=l.format,u=l.type;if(c!==ke&&ee.convert(c)!==N.getParameter(N.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Te||ee.convert(u)===N.getParameter(N.IMPLEMENTATION_COLOR_READ_TYPE)||u===Ce&&(L.get("OES_texture_float")||L.get("WEBGL_color_buffer_float"))||u===Ne&&L.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");N.checkFramebufferStatus(N.FRAMEBUFFER)===N.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-i&&o>=0&&o<=e.height-n&&N.readPixels(t,o,i,n,ee.convert(c),ee.convert(u),r):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&N.bindFramebuffer(N.FRAMEBUFFER,re)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function an(e,t){this.name="",this.color=new fo(e),this.density=void 0!==t?t:25e-5}function ln(e,t,o){this.name="",this.color=new fo(e),this.near=void 0!==t?t:1,this.far=void 0!==o?o:1e3}function cn(){qo.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function un(e,t,o,i,n){qo.call(this),this.lensFlares=[],this.positionScreen=new At,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,o,i,n)}function hn(e){Do.call(this),this.type="SpriteMaterial",this.color=new fo(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function gn(e){qo.call(this),this.type="Sprite",this.material=void 0!==e?e:new hn}function dn(){qo.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function pn(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var o=0,i=this.bones.length;o<i;o++)this.boneInverses.push(new St)}}function fn(){qo.call(this),this.type="Bone"}function mn(e,t){Oi.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new St,this.bindMatrixInverse=new St;var o=this.initBones(),i=new pn(o);this.bind(i,this.matrixWorld),this.normalizeSkinWeights()}function yn(e){Do.call(this),this.type="LineBasicMaterial",this.color=new fo(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function vn(e,t,o){if(1===o)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new En(e,t);qo.call(this),this.type="Line",this.geometry=void 0!==e?e:new Si,this.material=void 0!==t?t:new yn({color:16777215*Math.random()})}function En(e,t){vn.call(this,e,t),this.type="LineSegments"}function _n(e,t){vn.call(this,e,t),this.type="LineLoop"}function Tn(e){Do.call(this),this.type="PointsMaterial",this.color=new fo(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function bn(e,t){qo.call(this),this.type="Points",this.geometry=void 0!==e?e:new Si,this.material=void 0!==t?t:new Tn({color:16777215*Math.random()})}function Mn(){qo.call(this),this.type="Group"}function An(e,t,o,i,n,r,s,a,l){Et.call(this,e,t,o,i,n,r,s,a,l),this.generateMipmaps=!1;var c=this;!function t(){requestAnimationFrame(t),e.readyState>=e.HAVE_CURRENT_DATA&&(c.needsUpdate=!0)}()}function Sn(e,t,o,i,n,r,s,a,l,c,u,h){Et.call(this,null,r,s,a,l,c,i,n,u,h),this.image={width:t,height:o},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function wn(e,t,o,i,n,r,s,a,l,c){if((c=void 0!==c?c:Fe)!==Fe&&c!==He)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===o&&c===Fe&&(o=Ae),void 0===o&&c===He&&(o=De),Et.call(this,null,i,n,r,s,a,c,o,l),this.image={width:e,height:t},this.magFilter=void 0!==s?s:fe,this.minFilter=void 0!==a?a:fe,this.flipY=!1,this.generateMipmaps=!1}function Cn(e){Si.call(this),this.type="WireframeGeometry";var t,o,i,n,r,s,a,l,c,u,h=[],g=[0,0],d={},p=["a","b","c"];if(e&&e.isGeometry){var f=e.faces;for(t=0,i=f.length;t<i;t++){var m=f[t];for(o=0;o<3;o++)a=m[p[o]],l=m[p[(o+1)%3]],g[0]=Math.min(a,l),g[1]=Math.max(a,l),c=g[0]+","+g[1],void 0===d[c]&&(d[c]={index1:g[0],index2:g[1]})}for(c in d)s=d[c],u=e.vertices[s.index1],h.push(u.x,u.y,u.z),u=e.vertices[s.index2],h.push(u.x,u.y,u.z)}else if(e&&e.isBufferGeometry){var y,v,E,_,T,b,M,A;if(u=new At,null!==e.index){for(y=e.attributes.position,v=e.index,0===(E=e.groups).length&&(E=[{start:0,count:v.count,materialIndex:0}]),n=0,r=E.length;n<r;++n)for(_=E[n],T=_.start,b=_.count,t=T,i=T+b;t<i;t+=3)for(o=0;o<3;o++)a=v.getX(t+o),l=v.getX(t+(o+1)%3),g[0]=Math.min(a,l),g[1]=Math.max(a,l),c=g[0]+","+g[1],void 0===d[c]&&(d[c]={index1:g[0],index2:g[1]});for(c in d)s=d[c],u.fromBufferAttribute(y,s.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(y,s.index2),h.push(u.x,u.y,u.z)}else for(y=e.attributes.position,t=0,i=y.count/3;t<i;t++)for(o=0;o<3;o++)M=3*t+o,u.fromBufferAttribute(y,M),h.push(u.x,u.y,u.z),A=3*t+(o+1)%3,u.fromBufferAttribute(y,A),h.push(u.x,u.y,u.z)}this.addAttribute("position",new Ti(h,3))}function Nn(e,t,o){gi.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:o},this.fromBufferGeometry(new Ln(e,t,o)),this.mergeVertices()}function Ln(e,t,o){Si.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:o};var i,n,r=[],s=[],a=[],l=[],c=new At,u=new At,h=new At,g=new At,d=new At,p=t+1;for(i=0;i<=o;i++){var f=i/o;for(n=0;n<=t;n++){var m=n/t;u=e(m,f,u),s.push(u.x,u.y,u.z),m-1e-5>=0?(h=e(m-1e-5,f,h),g.subVectors(u,h)):(h=e(m+1e-5,f,h),g.subVectors(h,u)),f-1e-5>=0?(h=e(m,f-1e-5,h),d.subVectors(u,h)):(h=e(m,f+1e-5,h),d.subVectors(h,u)),c.crossVectors(g,d).normalize(),a.push(c.x,c.y,c.z),l.push(m,f)}}for(i=0;i<o;i++)for(n=0;n<t;n++){var y=i*p+n,v=i*p+n+1,E=(i+1)*p+n+1,_=(i+1)*p+n;r.push(y,v,_),r.push(v,E,_)}this.setIndex(r),this.addAttribute("position",new Ti(s,3)),this.addAttribute("normal",new Ti(a,3)),this.addAttribute("uv",new Ti(l,2))}function In(e,t,o,i){gi.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:o,detail:i},this.fromBufferGeometry(new Rn(e,t,o,i)),this.mergeVertices()}function Rn(e,t,o,i){Si.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:o,detail:i},o=o||1;var n=[],r=[];function s(e,t,o,i){var n,r,s=Math.pow(2,i),l=[];for(n=0;n<=s;n++){l[n]=[];var c=e.clone().lerp(o,n/s),u=t.clone().lerp(o,n/s),h=s-n;for(r=0;r<=h;r++)l[n][r]=0===r&&n===s?c:c.clone().lerp(u,r/h)}for(n=0;n<s;n++)for(r=0;r<2*(s-n)-1;r++){var g=Math.floor(r/2);r%2==0?(a(l[n][g+1]),a(l[n+1][g]),a(l[n][g])):(a(l[n][g+1]),a(l[n+1][g+1]),a(l[n+1][g]))}}function a(e){n.push(e.x,e.y,e.z)}function l(t,o){var i=3*t;o.x=e[i+0],o.y=e[i+1],o.z=e[i+2]}function c(e,t,o,i){i<0&&1===e.x&&(r[t]=e.x-1),0===o.x&&0===o.z&&(r[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){for(var o=new At,i=new At,n=new At,r=0;r<t.length;r+=3)l(t[r+0],o),l(t[r+1],i),l(t[r+2],n),s(o,i,n,e)}(i=i||0),function(e){for(var t=new At,o=0;o<n.length;o+=3)t.x=n[o+0],t.y=n[o+1],t.z=n[o+2],t.normalize().multiplyScalar(e),n[o+0]=t.x,n[o+1]=t.y,n[o+2]=t.z}(o),function(){for(var e=new At,t=0;t<n.length;t+=3){e.x=n[t+0],e.y=n[t+1],e.z=n[t+2];var o=u(e)/2/Math.PI+.5,i=(s=e,Math.atan2(-s.y,Math.sqrt(s.x*s.x+s.z*s.z))/Math.PI+.5);r.push(o,1-i)}var s;(function(){for(var e=new At,t=new At,o=new At,i=new At,s=new ht,a=new ht,l=new ht,h=0,g=0;h<n.length;h+=9,g+=6){e.set(n[h+0],n[h+1],n[h+2]),t.set(n[h+3],n[h+4],n[h+5]),o.set(n[h+6],n[h+7],n[h+8]),s.set(r[g+0],r[g+1]),a.set(r[g+2],r[g+3]),l.set(r[g+4],r[g+5]),i.copy(e).add(t).add(o).divideScalar(3);var d=u(i);c(s,g+0,e,d),c(a,g+2,t,d),c(l,g+4,o,d)}})(),function(){for(var e=0;e<r.length;e+=6){var t=r[e+0],o=r[e+2],i=r[e+4],n=Math.max(t,o,i),s=Math.min(t,o,i);n>.9&&s<.1&&(t<.2&&(r[e+0]+=1),o<.2&&(r[e+2]+=1),i<.2&&(r[e+4]+=1))}}()}(),this.addAttribute("position",new Ti(n,3)),this.addAttribute("normal",new Ti(n.slice(),3)),this.addAttribute("uv",new Ti(r,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function Dn(e,t){gi.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new xn(e,t)),this.mergeVertices()}function xn(e,t){Rn.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function On(e,t){gi.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new kn(e,t)),this.mergeVertices()}function kn(e,t){Rn.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Bn(e,t){gi.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Pn(e,t)),this.mergeVertices()}function Pn(e,t){var o=(1+Math.sqrt(5))/2,i=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1];Rn.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Un(e,t){gi.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Fn(e,t)),this.mergeVertices()}function Fn(e,t){var o=(1+Math.sqrt(5))/2,i=1/o,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-o,0,-i,o,0,i,-o,0,i,o,-i,-o,0,-i,o,0,i,-o,0,i,o,0,-o,0,-i,o,0,-i,-o,0,i,o,0,i];Rn.call(this,n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Hn(e,t,o,i,n,r){gi.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:o,radialSegments:i,closed:n},void 0!==r&&console.warn("THREE.TubeGeometry: taper has been removed.");var s=new jn(e,t,o,i,n);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals,this.fromBufferGeometry(s),this.mergeVertices()}function jn(e,t,o,i,n){Si.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:o,radialSegments:i,closed:n},t=t||64,o=o||1,i=i||8,n=n||!1;var r=e.computeFrenetFrames(t,n);this.tangents=r.tangents,this.normals=r.normals,this.binormals=r.binormals;var s,a,l=new At,c=new At,u=new ht,h=[],g=[],d=[],p=[];function f(n){var s=e.getPointAt(n/t),u=r.normals[n],d=r.binormals[n];for(a=0;a<=i;a++){var p=a/i*Math.PI*2,f=Math.sin(p),m=-Math.cos(p);c.x=m*u.x+f*d.x,c.y=m*u.y+f*d.y,c.z=m*u.z+f*d.z,c.normalize(),g.push(c.x,c.y,c.z),l.x=s.x+o*c.x,l.y=s.y+o*c.y,l.z=s.z+o*c.z,h.push(l.x,l.y,l.z)}}!function(){for(s=0;s<t;s++)f(s);f(!1===n?t:0),function(){for(s=0;s<=t;s++)for(a=0;a<=i;a++)u.x=s/t,u.y=a/i,d.push(u.x,u.y)}(),function(){for(a=1;a<=t;a++)for(s=1;s<=i;s++){var e=(i+1)*(a-1)+(s-1),o=(i+1)*a+(s-1),n=(i+1)*a+s,r=(i+1)*(a-1)+s;p.push(e,o,r),p.push(o,n,r)}}()}(),this.setIndex(p),this.addAttribute("position",new Ti(h,3)),this.addAttribute("normal",new Ti(g,3)),this.addAttribute("uv",new Ti(d,2))}function zn(e,t,o,i,n,r,s){gi.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:o,radialSegments:i,p:n,q:r},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Vn(e,t,o,i,n,r)),this.mergeVertices()}function Vn(e,t,o,i,n,r){Si.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:o,radialSegments:i,p:n,q:r},e=e||100,t=t||40,o=Math.floor(o)||64,i=Math.floor(i)||8,n=n||2,r=r||3;var s,a,l=[],c=[],u=[],h=[],g=new At,d=new At,p=new At,f=new At,m=new At,y=new At,v=new At;for(s=0;s<=o;++s){var E=s/o*n*Math.PI*2;for(C(E,n,r,e,p),C(E+.01,n,r,e,f),y.subVectors(f,p),v.addVectors(f,p),m.crossVectors(y,v),v.crossVectors(m,y),m.normalize(),v.normalize(),a=0;a<=i;++a){var _=a/i*Math.PI*2,T=-t*Math.cos(_),b=t*Math.sin(_);g.x=p.x+(T*v.x+b*m.x),g.y=p.y+(T*v.y+b*m.y),g.z=p.z+(T*v.z+b*m.z),c.push(g.x,g.y,g.z),d.subVectors(g,p).normalize(),u.push(d.x,d.y,d.z),h.push(s/o),h.push(a/i)}}for(a=1;a<=o;a++)for(s=1;s<=i;s++){var M=(i+1)*(a-1)+(s-1),A=(i+1)*a+(s-1),S=(i+1)*a+s,w=(i+1)*(a-1)+s;l.push(M,A,w),l.push(A,S,w)}function C(e,t,o,i,n){var r=Math.cos(e),s=Math.sin(e),a=o/t*e,l=Math.cos(a);n.x=i*(2+l)*.5*r,n.y=i*(2+l)*s*.5,n.z=i*Math.sin(a)*.5}this.setIndex(l),this.addAttribute("position",new Ti(c,3)),this.addAttribute("normal",new Ti(u,3)),this.addAttribute("uv",new Ti(h,2))}function Gn(e,t,o,i,n){gi.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:o,tubularSegments:i,arc:n},this.fromBufferGeometry(new Wn(e,t,o,i,n)),this.mergeVertices()}function Wn(e,t,o,i,n){Si.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:o,tubularSegments:i,arc:n},e=e||100,t=t||40,o=Math.floor(o)||8,i=Math.floor(i)||6,n=n||2*Math.PI;var r,s,a=[],l=[],c=[],u=[],h=new At,g=new At,d=new At;for(r=0;r<=o;r++)for(s=0;s<=i;s++){var p=s/i*n,f=r/o*Math.PI*2;g.x=(e+t*Math.cos(f))*Math.cos(p),g.y=(e+t*Math.cos(f))*Math.sin(p),g.z=t*Math.sin(f),l.push(g.x,g.y,g.z),h.x=e*Math.cos(p),h.y=e*Math.sin(p),d.subVectors(g,h).normalize(),c.push(d.x,d.y,d.z),u.push(s/i),u.push(r/o)}for(r=1;r<=o;r++)for(s=1;s<=i;s++){var m=(i+1)*r+s-1,y=(i+1)*(r-1)+s-1,v=(i+1)*(r-1)+s,E=(i+1)*r+s;a.push(m,y,E),a.push(y,v,E)}this.setIndex(a),this.addAttribute("position",new Ti(l,3)),this.addAttribute("normal",new Ti(c,3)),this.addAttribute("uv",new Ti(u,2))}nn.prototype=Object.assign(Object.create(Zo.prototype),{constructor:nn,isArrayCamera:!0}),an.prototype.isFogExp2=!0,an.prototype.clone=function(){return new an(this.color.getHex(),this.density)},an.prototype.toJSON=function(e){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},ln.prototype.isFog=!0,ln.prototype.clone=function(){return new ln(this.color.getHex(),this.near,this.far)},ln.prototype.toJSON=function(e){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},cn.prototype=Object.assign(Object.create(qo.prototype),{constructor:cn,copy:function(e,t){return qo.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=qo.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),un.prototype=Object.assign(Object.create(qo.prototype),{constructor:un,isLensFlare:!0,copy:function(e){qo.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,o=e.lensFlares.length;t<o;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,o,i,n,r){void 0===t&&(t=-1),void 0===o&&(o=0),void 0===r&&(r=1),void 0===n&&(n=new fo(16777215)),void 0===i&&(i=b),o=Math.min(o,Math.max(0,o)),this.lensFlares.push({texture:e,size:t,distance:o,x:0,y:0,z:0,scale:1,rotation:0,opacity:r,color:n,blending:i})},updateLensFlares:function(){var e,t,o=this.lensFlares.length,i=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(e=0;e<o;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+i*t.distance,t.y=this.positionScreen.y+n*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),hn.prototype=Object.create(Do.prototype),hn.prototype.constructor=hn,hn.prototype.isSpriteMaterial=!0,hn.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},gn.prototype=Object.assign(Object.create(qo.prototype),{constructor:gn,isSprite:!0,raycast:(ji=new At,zi=new At,Vi=new At,function(e,t){zi.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(zi,ji),Vi.setFromMatrixScale(this.matrixWorld);var o=Vi.x*Vi.y/4;if(!(zi.distanceToSquared(ji)>o)){var i=e.ray.origin.distanceTo(ji);i<e.near||i>e.far||t.push({distance:i,point:ji.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)}}),dn.prototype=Object.assign(Object.create(qo.prototype),{constructor:dn,copy:function(e){qo.prototype.copy.call(this,e,!1);for(var t=e.levels,o=0,i=t.length;o<i;o++){var n=t[o];this.addLevel(n.object.clone(),n.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var o=this.levels,i=0;i<o.length&&!(t<o[i].distance);i++);o.splice(i,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,o=1,i=t.length;o<i&&!(e<t[o].distance);o++);return t[o-1].object},raycast:(Gi=new At,function(e,t){Gi.setFromMatrixPosition(this.matrixWorld);var o=e.ray.origin.distanceTo(Gi);this.getObjectForDistance(o).raycast(e,t)}),update:function(){var e=new At,t=new At;return function(o){var i=this.levels;if(i.length>1){e.setFromMatrixPosition(o.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var n=e.distanceTo(t);i[0].object.visible=!0;for(var r=1,s=i.length;r<s&&n>=i[r].distance;r++)i[r-1].object.visible=!1,i[r].object.visible=!0;for(;r<s;r++)i[r].object.visible=!1}}}(),toJSON:function(e){var t=qo.prototype.toJSON.call(this,e);t.object.levels=[];for(var o=this.levels,i=0,n=o.length;i<n;i++){var r=o[i];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),Object.assign(pn.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var o=new St;this.bones[e]&&o.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(o)}},pose:function(){var e,t,o;for(t=0,o=this.bones.length;t<o;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,o=this.bones.length;t<o;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Wi=new St,Yi=new St,function(){for(var e=this.bones,t=this.boneInverses,o=this.boneMatrices,i=this.boneTexture,n=0,r=e.length;n<r;n++){var s=e[n]?e[n].matrixWorld:Yi;Wi.multiplyMatrices(s,t[n]),Wi.toArray(o,16*n)}void 0!==i&&(i.needsUpdate=!0)}),clone:function(){return new pn(this.bones,this.boneInverses)}}),fn.prototype=Object.assign(Object.create(qo.prototype),{constructor:fn,isBone:!0}),mn.prototype=Object.assign(Object.create(Oi.prototype),{constructor:mn,isSkinnedMesh:!0,initBones:function(){var e,t,o,i,n=[];if(this.geometry&&void 0!==this.geometry.bones){for(o=0,i=this.geometry.bones.length;o<i;o++)t=this.geometry.bones[o],e=new fn,n.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(o=0,i=this.geometry.bones.length;o<i;o++)-1!==(t=this.geometry.bones[o]).parent&&null!==t.parent&&void 0!==n[t.parent]?n[t.parent].add(n[o]):this.add(n[o])}return this.updateMatrixWorld(!0),n},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var o=this.geometry.skinWeights[t];(e=1/o.lengthManhattan())!=1/0?o.multiplyScalar(e):o.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new _t,n=this.geometry.attributes.skinWeight;for(t=0;t<n.count;t++)i.x=n.getX(t),i.y=n.getY(t),i.z=n.getZ(t),i.w=n.getW(t),(e=1/i.lengthManhattan())!=1/0?i.multiplyScalar(e):i.set(1,0,0,0),n.setXYZW(t,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function(e){Oi.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),yn.prototype=Object.create(Do.prototype),yn.prototype.constructor=yn,yn.prototype.isLineBasicMaterial=!0,yn.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},vn.prototype=Object.assign(Object.create(qo.prototype),{constructor:vn,isLine:!0,raycast:function(){var e=new St,t=new Ri,o=new Po;return function(i,n){var r=i.linePrecision,s=r*r,a=this.geometry,l=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),o.copy(a.boundingSphere),o.applyMatrix4(l),!1!==i.ray.intersectsSphere(o)){e.getInverse(l),t.copy(i.ray).applyMatrix4(e);var c=new At,u=new At,h=new At,g=new At,d=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var p=a.index,f=a.attributes,m=f.position.array;if(null!==p)for(var y=p.array,v=0,E=y.length-1;v<E;v+=d){var _=y[v],T=y[v+1];c.fromArray(m,3*_),u.fromArray(m,3*T);var b=t.distanceSqToSegment(c,u,g,h);if(!(b>s)){g.applyMatrix4(this.matrixWorld);var M=i.ray.origin.distanceTo(g);M<i.near||M>i.far||n.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var v=0,E=m.length/3-1;v<E;v+=d){c.fromArray(m,3*v),u.fromArray(m,3*v+3);var b=t.distanceSqToSegment(c,u,g,h);if(!(b>s)){g.applyMatrix4(this.matrixWorld);var M=i.ray.origin.distanceTo(g);M<i.near||M>i.far||n.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else if(a.isGeometry)for(var A=a.vertices,S=A.length,v=0;v<S-1;v+=d){var b=t.distanceSqToSegment(A[v],A[v+1],g,h);if(!(b>s)){g.applyMatrix4(this.matrixWorld);var M=i.ray.origin.distanceTo(g);M<i.near||M>i.far||n.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),En.prototype=Object.assign(Object.create(vn.prototype),{constructor:En,isLineSegments:!0}),_n.prototype=Object.assign(Object.create(vn.prototype),{constructor:_n,isLineLoop:!0}),Tn.prototype=Object.create(Do.prototype),Tn.prototype.constructor=Tn,Tn.prototype.isPointsMaterial=!0,Tn.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},bn.prototype=Object.assign(Object.create(qo.prototype),{constructor:bn,isPoints:!0,raycast:function(){var e=new St,t=new Ri,o=new Po;return function(i,n){var r=this,s=this.geometry,a=this.matrixWorld,l=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),o.copy(s.boundingSphere),o.applyMatrix4(a),o.radius+=l,!1!==i.ray.intersectsSphere(o)){e.getInverse(a),t.copy(i.ray).applyMatrix4(e);var c=l/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=new At;if(s.isBufferGeometry){var g=s.index,d=s.attributes,p=d.position.array;if(null!==g)for(var f=g.array,m=0,y=f.length;m<y;m++){var v=f[m];h.fromArray(p,3*v),T(h,v)}else for(var m=0,E=p.length/3;m<E;m++)h.fromArray(p,3*m),T(h,m)}else for(var _=s.vertices,m=0,E=_.length;m<E;m++)T(_[m],m)}function T(e,o){var s=t.distanceSqToPoint(e);if(s<u){var l=t.closestPointToPoint(e);l.applyMatrix4(a);var c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;n.push({distance:c,distanceToRay:Math.sqrt(s),point:l.clone(),index:o,face:null,object:r})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Mn.prototype=Object.assign(Object.create(qo.prototype),{constructor:Mn}),An.prototype=Object.create(Et.prototype),An.prototype.constructor=An,Sn.prototype=Object.create(Et.prototype),Sn.prototype.constructor=Sn,Sn.prototype.isCompressedTexture=!0,wn.prototype=Object.create(Et.prototype),wn.prototype.constructor=wn,wn.prototype.isDepthTexture=!0,Cn.prototype=Object.create(Si.prototype),Cn.prototype.constructor=Cn,Nn.prototype=Object.create(gi.prototype),Nn.prototype.constructor=Nn,Ln.prototype=Object.create(Si.prototype),Ln.prototype.constructor=Ln,In.prototype=Object.create(gi.prototype),In.prototype.constructor=In,Rn.prototype=Object.create(Si.prototype),Rn.prototype.constructor=Rn,Dn.prototype=Object.create(gi.prototype),Dn.prototype.constructor=Dn,xn.prototype=Object.create(Rn.prototype),xn.prototype.constructor=xn,On.prototype=Object.create(gi.prototype),On.prototype.constructor=On,kn.prototype=Object.create(Rn.prototype),kn.prototype.constructor=kn,Bn.prototype=Object.create(gi.prototype),Bn.prototype.constructor=Bn,Pn.prototype=Object.create(Rn.prototype),Pn.prototype.constructor=Pn,Un.prototype=Object.create(gi.prototype),Un.prototype.constructor=Un,Fn.prototype=Object.create(Rn.prototype),Fn.prototype.constructor=Fn,Hn.prototype=Object.create(gi.prototype),Hn.prototype.constructor=Hn,jn.prototype=Object.create(Si.prototype),jn.prototype.constructor=jn,zn.prototype=Object.create(gi.prototype),zn.prototype.constructor=zn,Vn.prototype=Object.create(Si.prototype),Vn.prototype.constructor=Vn,Gn.prototype=Object.create(gi.prototype),Gn.prototype.constructor=Gn,Wn.prototype=Object.create(Si.prototype),Wn.prototype.constructor=Wn;var Yn={area:function(e){for(var t=e.length,o=0,i=t-1,n=0;n<t;i=n++)o+=e[i].x*e[n].y-e[n].x*e[i].y;return.5*o},triangulate:function(){function e(e,t,o,i,n,r){var s,a,l,c,u,h,g,d,p,f,m,y,v,E,_,T,b;if(a=e[r[t]].x,l=e[r[t]].y,c=e[r[o]].x,u=e[r[o]].y,h=e[r[i]].x,g=e[r[i]].y,(c-a)*(g-l)-(u-l)*(h-a)<=0)return!1;for(f=h-c,m=g-u,y=a-h,v=l-g,E=c-a,_=u-l,s=0;s<n;s++)if(d=e[r[s]].x,p=e[r[s]].y,!(d===a&&p===l||d===c&&p===u||d===h&&p===g)&&(T=E*(p-l)-_*(d-a),b=y*(p-g)-v*(d-h),f*(p-u)-m*(d-c)>=-Number.EPSILON&&b>=-Number.EPSILON&&T>=-Number.EPSILON))return!1;return!0}return function(t,o){var i=t.length;if(i<3)return null;var n,r,s,a=[],l=[],c=[];if(Yn.area(t)>0)for(r=0;r<i;r++)l[r]=r;else for(r=0;r<i;r++)l[r]=i-1-r;var u=i,h=2*u;for(r=u-1;u>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),o?c:a;if(u<=(n=r)&&(n=0),u<=(r=n+1)&&(r=0),u<=(s=r+1)&&(s=0),e(t,n,r,s,u,l)){var g,d,p,f,m;for(g=l[n],d=l[r],p=l[s],a.push([t[g],t[d],t[p]]),c.push([l[n],l[r],l[s]]),f=r,m=r+1;m<u;f++,m++)l[f]=l[m];h=2*--u}}return o?c:a}}(),triangulateShape:function(e,t){function o(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function i(e,t,o){return e.x!==t.x?e.x<t.x?e.x<=o.x&&o.x<=t.x:t.x<=o.x&&o.x<=e.x:e.y<t.y?e.y<=o.y&&o.y<=t.y:t.y<=o.y&&o.y<=e.y}function n(e,t,o,n,r){var s=t.x-e.x,a=t.y-e.y,l=n.x-o.x,c=n.y-o.y,u=e.x-o.x,h=e.y-o.y,g=a*l-s*c,d=a*u-s*h;if(Math.abs(g)>Number.EPSILON){var p;if(g>0){if(d<0||d>g)return[];if((p=c*u-l*h)<0||p>g)return[]}else{if(d>0||d<g)return[];if((p=c*u-l*h)>0||p<g)return[]}if(0===p)return!r||0!==d&&d!==g?[e]:[];if(p===g)return!r||0!==d&&d!==g?[t]:[];if(0===d)return[o];if(d===g)return[n];var f=p/g;return[{x:e.x+f*s,y:e.y+f*a}]}if(0!==d||c*u!=l*h)return[];var m,y,v,E,_,T,b,M,A=0===s&&0===a,S=0===l&&0===c;return A&&S?e.x!==o.x||e.y!==o.y?[]:[e]:A?i(o,n,e)?[e]:[]:S?i(e,t,o)?[o]:[]:(0!==s?(e.x<t.x?(m=e,v=e.x,y=t,E=t.x):(m=t,v=t.x,y=e,E=e.x),o.x<n.x?(_=o,b=o.x,T=n,M=n.x):(_=n,b=n.x,T=o,M=o.x)):(e.y<t.y?(m=e,v=e.y,y=t,E=t.y):(m=t,v=t.y,y=e,E=e.y),o.y<n.y?(_=o,b=o.y,T=n,M=n.y):(_=n,b=n.y,T=o,M=o.y)),v<=b?E<b?[]:E===b?r?[]:[_]:E<=M?[_,y]:[_,T]:v>M?[]:v===M?r?[]:[m]:E<=M?[m,y]:[m,T])}function r(e,t,o,i){var n=t.x-e.x,r=t.y-e.y,s=o.x-e.x,a=o.y-e.y,l=i.x-e.x,c=i.y-e.y,u=n*a-r*s,h=n*c-r*l;if(Math.abs(u)>Number.EPSILON){var g=l*a-c*s;return u>0?h>=0&&g>=0:h>=0||g>=0}return h>0}o(e),t.forEach(o);for(var s,a,l,c,u,h,g={},d=e.concat(),p=0,f=t.length;p<f;p++)Array.prototype.push.apply(d,t[p]);for(s=0,a=d.length;s<a;s++)u=d[s].x+":"+d[s].y,void 0!==g[u]&&console.warn("THREE.ShapeUtils: Duplicate point",u,s),g[u]=s;var m=function(e,t){var o,i=e.concat();function s(e,t){var n=i.length-1,s=e-1;s<0&&(s=n);var a=e+1;a>n&&(a=0);var l=r(i[e],i[s],i[a],o[t]);if(!l)return!1;var c=o.length-1,u=t-1;u<0&&(u=c);var h=t+1;return h>c&&(h=0),!!(l=r(o[t],o[u],o[h],i[e]))}function a(e,t){var o,r;for(o=0;o<i.length;o++)if(r=o+1,r%=i.length,n(e,t,i[o],i[r],!0).length>0)return!0;return!1}var l=[];function c(e,o){var i,r,s,a;for(i=0;i<l.length;i++)for(r=t[l[i]],s=0;s<r.length;s++)if(a=s+1,a%=r.length,n(e,o,r[s],r[a],!0).length>0)return!0;return!1}for(var u,h,g,d,p,f,m,y,v,E,_=[],T=0,b=t.length;T<b;T++)l.push(T);for(var M=0,A=2*l.length;l.length>0;){if(--A<0){console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');break}for(h=M;h<i.length;h++){g=i[h],u=-1;for(var T=0;T<l.length;T++)if(p=l[T],f=g.x+":"+g.y+":"+p,void 0===_[f]){o=t[p];for(var S=0;S<o.length;S++)if(d=o[S],s(h,S)&&!a(g,d)&&!c(g,d)){u=S,l.splice(T,1),m=i.slice(0,h+1),y=i.slice(h),v=o.slice(u),E=o.slice(0,u+1),i=m.concat(v).concat(E).concat(y),M=h;break}if(u>=0)break;_[f]=!0}if(u>=0)break}}return i}(e,t),y=Yn.triangulate(m,!1);for(s=0,a=y.length;s<a;s++)for(c=y[s],l=0;l<3;l++)u=c[l].x+":"+c[l].y,void 0!==(h=g[u])&&(c[l]=h);return y.concat()},isClockWise:function(e){return Yn.area(e)<0}};function Xn(e,t){gi.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Kn(e,t)),this.mergeVertices()}function Kn(e,t){void 0!==e&&(Si.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function Qn(e,t){gi.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new qn(e,t)),this.mergeVertices()}function qn(e,t){var o=(t=t||{}).font;if(!o||!o.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new gi;var i=o.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Kn.call(this,i,t),this.type="TextBufferGeometry"}function Jn(e,t,o,i,n,r,s){gi.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:o,phiStart:i,phiLength:n,thetaStart:r,thetaLength:s},this.fromBufferGeometry(new $n(e,t,o,i,n,r,s)),this.mergeVertices()}function $n(e,t,o,i,n,r,s){Si.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:o,phiStart:i,phiLength:n,thetaStart:r,thetaLength:s},e=e||50,t=Math.max(3,Math.floor(t)||8),o=Math.max(2,Math.floor(o)||6),i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI,r=void 0!==r?r:0,s=void 0!==s?s:Math.PI;var a,l,c=r+s,u=0,h=[],g=new At,d=new At,p=[],f=[],m=[],y=[];for(l=0;l<=o;l++){var v=[],E=l/o;for(a=0;a<=t;a++){var _=a/t;g.x=-e*Math.cos(i+_*n)*Math.sin(r+E*s),g.y=e*Math.cos(r+E*s),g.z=e*Math.sin(i+_*n)*Math.sin(r+E*s),f.push(g.x,g.y,g.z),d.set(g.x,g.y,g.z).normalize(),m.push(d.x,d.y,d.z),y.push(_,1-E),v.push(u++)}h.push(v)}for(l=0;l<o;l++)for(a=0;a<t;a++){var T=h[l][a+1],b=h[l][a],M=h[l+1][a],A=h[l+1][a+1];(0!==l||r>0)&&p.push(T,b,A),(l!==o-1||c<Math.PI)&&p.push(b,M,A)}this.setIndex(p),this.addAttribute("position",new Ti(f,3)),this.addAttribute("normal",new Ti(m,3)),this.addAttribute("uv",new Ti(y,2))}function Zn(e,t,o,i,n,r){gi.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:o,phiSegments:i,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new er(e,t,o,i,n,r)),this.mergeVertices()}function er(e,t,o,i,n,r){Si.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:o,phiSegments:i,thetaStart:n,thetaLength:r},e=e||20,t=t||50,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?Math.max(3,o):8,i=void 0!==i?Math.max(1,i):1;var s,a,l,c=[],u=[],h=[],g=[],d=e,p=(t-e)/i,f=new At,m=new ht;for(a=0;a<=i;a++){for(l=0;l<=o;l++)s=n+l/o*r,f.x=d*Math.cos(s),f.y=d*Math.sin(s),u.push(f.x,f.y,f.z),h.push(0,0,1),m.x=(f.x/t+1)/2,m.y=(f.y/t+1)/2,g.push(m.x,m.y);d+=p}for(a=0;a<i;a++){var y=a*(o+1);for(l=0;l<o;l++){var v=s=l+y,E=s+o+1,_=s+o+2,T=s+1;c.push(v,E,T),c.push(E,_,T)}}this.setIndex(c),this.addAttribute("position",new Ti(u,3)),this.addAttribute("normal",new Ti(h,3)),this.addAttribute("uv",new Ti(g,2))}function tr(e,t,o,i){gi.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:o,phiLength:i},this.fromBufferGeometry(new or(e,t,o,i)),this.mergeVertices()}function or(e,t,o,i){Si.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:o,phiLength:i},t=Math.floor(t)||12,o=o||0,i=i||2*Math.PI,i=ut.clamp(i,0,2*Math.PI);var n,r,s,a=[],l=[],c=[],u=1/t,h=new At,g=new ht;for(r=0;r<=t;r++){var d=o+r*u*i,p=Math.sin(d),f=Math.cos(d);for(s=0;s<=e.length-1;s++)h.x=e[s].x*p,h.y=e[s].y,h.z=e[s].x*f,l.push(h.x,h.y,h.z),g.x=r/t,g.y=s/(e.length-1),c.push(g.x,g.y)}for(r=0;r<t;r++)for(s=0;s<e.length-1;s++){var m=n=s+r*e.length,y=n+e.length,v=n+e.length+1,E=n+1;a.push(m,y,E),a.push(y,v,E)}if(this.setIndex(a),this.addAttribute("position",new Ti(l,3)),this.addAttribute("uv",new Ti(c,2)),this.computeVertexNormals(),i===2*Math.PI){var _=this.attributes.normal.array,T=new At,b=new At,M=new At;for(n=t*e.length*3,r=0,s=0;r<e.length;r++,s+=3)T.x=_[s+0],T.y=_[s+1],T.z=_[s+2],b.x=_[n+s+0],b.y=_[n+s+1],b.z=_[n+s+2],M.addVectors(T,b).normalize(),_[s+0]=_[n+s+0]=M.x,_[s+1]=_[n+s+1]=M.y,_[s+2]=_[n+s+2]=M.z}}function ir(e,t){gi.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new nr(e,t)),this.mergeVertices()}function nr(e,t){Si.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var o=[],i=[],n=[],r=[],s=0,a=0;if(!1===Array.isArray(e))c(e);else for(var l=0;l<e.length;l++)c(e[l]),this.addGroup(s,a,l),s+=a,a=0;function c(e){var s,l,c,u=i.length/3,h=e.extractPoints(t),g=h.shape,d=h.holes;if(!1===Yn.isClockWise(g))for(g=g.reverse(),s=0,l=d.length;s<l;s++)c=d[s],!0===Yn.isClockWise(c)&&(d[s]=c.reverse());var p=Yn.triangulateShape(g,d);for(s=0,l=d.length;s<l;s++)c=d[s],g=g.concat(c);for(s=0,l=g.length;s<l;s++){var f=g[s];i.push(f.x,f.y,0),n.push(0,0,1),r.push(f.x,f.y)}for(s=0,l=p.length;s<l;s++){var m=p[s],y=m[0]+u,v=m[1]+u,E=m[2]+u;o.push(y,v,E),a+=3}}this.setIndex(o),this.addAttribute("position",new Ti(i,3)),this.addAttribute("normal",new Ti(n,3)),this.addAttribute("uv",new Ti(r,2))}function rr(e,t){Si.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var o,i,n,r,s=[],a=Math.cos(ut.DEG2RAD*t),l=[0,0],c={},u=["a","b","c"];e.isBufferGeometry?(r=new gi).fromBufferGeometry(e):r=e.clone(),r.mergeVertices(),r.computeFaceNormals();for(var h=r.vertices,g=r.faces,d=0,p=g.length;d<p;d++)for(var f=g[d],m=0;m<3;m++)o=f[u[m]],i=f[u[(m+1)%3]],l[0]=Math.min(o,i),l[1]=Math.max(o,i),n=l[0]+","+l[1],void 0===c[n]?c[n]={index1:l[0],index2:l[1],face1:d,face2:void 0}:c[n].face2=d;for(n in c){var y=c[n];if(void 0===y.face2||g[y.face1].normal.dot(g[y.face2].normal)<=a){var v=h[y.index1];s.push(v.x,v.y,v.z),v=h[y.index2],s.push(v.x,v.y,v.z)}}this.addAttribute("position",new Ti(s,3))}function sr(e,t,o,i,n,r,s,a){gi.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:o,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new ar(e,t,o,i,n,r,s,a)),this.mergeVertices()}function ar(e,t,o,i,n,r,s,a){Si.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:o,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:a};var l=this;e=void 0!==e?e:20,t=void 0!==t?t:20,o=void 0!==o?o:100,i=Math.floor(i)||8,n=Math.floor(n)||1,r=void 0!==r&&r,s=void 0!==s?s:0,a=void 0!==a?a:2*Math.PI;var c=[],u=[],h=[],g=[],d=0,p=[],f=o/2,m=0;function y(o){var n,r,p,y=new ht,v=new At,E=0,_=!0===o?e:t,T=!0===o?1:-1;for(r=d,n=1;n<=i;n++)u.push(0,f*T,0),h.push(0,T,0),g.push(.5,.5),d++;for(p=d,n=0;n<=i;n++){var b=n/i,M=b*a+s,A=Math.cos(M),S=Math.sin(M);v.x=_*S,v.y=f*T,v.z=_*A,u.push(v.x,v.y,v.z),h.push(0,T,0),y.x=.5*A+.5,y.y=.5*S*T+.5,g.push(y.x,y.y),d++}for(n=0;n<i;n++){var w=r+n,C=p+n;!0===o?c.push(C,C+1,w):c.push(C+1,C,w),E+=3}l.addGroup(m,E,!0===o?1:2),m+=E}!function(){var r,y,v=new At,E=new At,_=0,T=(t-e)/o;for(y=0;y<=n;y++){var b=[],M=y/n,A=M*(t-e)+e;for(r=0;r<=i;r++){var S=r/i,w=S*a+s,C=Math.sin(w),N=Math.cos(w);E.x=A*C,E.y=-M*o+f,E.z=A*N,u.push(E.x,E.y,E.z),v.set(C,T,N).normalize(),h.push(v.x,v.y,v.z),g.push(S,1-M),b.push(d++)}p.push(b)}for(r=0;r<i;r++)for(y=0;y<n;y++){var L=p[y][r],I=p[y+1][r],R=p[y+1][r+1],D=p[y][r+1];c.push(L,I,D),c.push(I,R,D),_+=6}l.addGroup(m,_,0),m+=_}(),!1===r&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.addAttribute("position",new Ti(u,3)),this.addAttribute("normal",new Ti(h,3)),this.addAttribute("uv",new Ti(g,2))}function lr(e,t,o,i,n,r,s){sr.call(this,0,e,t,o,i,n,r,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:o,heightSegments:i,openEnded:n,thetaStart:r,thetaLength:s}}function cr(e,t,o,i,n,r,s){ar.call(this,0,e,t,o,i,n,r,s),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:o,heightSegments:i,openEnded:n,thetaStart:r,thetaLength:s}}function ur(e,t,o,i){gi.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:o,thetaLength:i},this.fromBufferGeometry(new hr(e,t,o,i)),this.mergeVertices()}function hr(e,t,o,i){Si.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:o,thetaLength:i},e=e||50,t=void 0!==t?Math.max(3,t):8,o=void 0!==o?o:0,i=void 0!==i?i:2*Math.PI;var n,r,s=[],a=[],l=[],c=[],u=new At,h=new ht;for(a.push(0,0,0),l.push(0,0,1),c.push(.5,.5),r=0,n=3;r<=t;r++,n+=3){var g=o+r/t*i;u.x=e*Math.cos(g),u.y=e*Math.sin(g),a.push(u.x,u.y,u.z),l.push(0,0,1),h.x=(a[n]/e+1)/2,h.y=(a[n+1]/e+1)/2,c.push(h.x,h.y)}for(n=1;n<=t;n++)s.push(n,n+1,0);this.setIndex(s),this.addAttribute("position",new Ti(a,3)),this.addAttribute("normal",new Ti(l,3)),this.addAttribute("uv",new Ti(c,2))}Xn.prototype=Object.create(gi.prototype),Xn.prototype.constructor=Xn,Kn.prototype=Object.create(Si.prototype),Kn.prototype.constructor=Kn,Kn.prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],o=this.getAttribute("uv"),i=o?Array.prototype.slice.call(o.array):[],n=this.index,r=n?Array.prototype.slice.call(n.array):[];return{position:t,uv:i,index:r}},Kn.prototype.addShapeList=function(e,t){var o=e.length;t.arrays=this.getArrays();for(var i=0;i<o;i++){var n=e[i];this.addShape(n,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new Ti(t.arrays.position,3)),this.addAttribute("uv",new Ti(t.arrays.uv,2))},Kn.prototype.addShape=function(e,t){var o,i,n,r,s,a,l,c,u=t.arrays?t.arrays:this.getArrays(),h=u.position,g=u.index,d=u.uv,p=[],f=void 0!==t.amount?t.amount:100,m=void 0!==t.bevelThickness?t.bevelThickness:6,y=void 0!==t.bevelSize?t.bevelSize:m-2,v=void 0!==t.bevelSegments?t.bevelSegments:3,E=void 0===t.bevelEnabled||t.bevelEnabled,_=void 0!==t.curveSegments?t.curveSegments:12,T=void 0!==t.steps?t.steps:1,b=t.extrudePath,M=!1,A=void 0!==t.UVGenerator?t.UVGenerator:Xn.WorldUVGenerator;b&&(o=b.getSpacedPoints(T),M=!0,E=!1,i=void 0!==t.frames?t.frames:b.computeFrenetFrames(T,!1),n=new At,r=new At,s=new At),E||(v=0,m=0,y=0);var S=this,w=e.extractPoints(_),C=w.shape,N=w.holes,L=!Yn.isClockWise(C);if(L)for(C=C.reverse(),l=0,c=N.length;l<c;l++)a=N[l],Yn.isClockWise(a)&&(N[l]=a.reverse());var I=Yn.triangulateShape(C,N),R=C;for(l=0,c=N.length;l<c;l++)a=N[l],C=C.concat(a);function D(e,t,o){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(o).add(e)}var x,O,k,B,P,U,F=C.length,H=I.length;function j(e,t,o){var i,n,r,s=e.x-t.x,a=e.y-t.y,l=o.x-e.x,c=o.y-e.y,u=s*s+a*a,h=s*c-a*l;if(Math.abs(h)>Number.EPSILON){var g=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/g,f=t.y+s/g,m=o.x-c/d,y=o.y+l/d,v=((m-p)*c-(y-f)*l)/(s*c-a*l);i=p+s*v-e.x,n=f+a*v-e.y;var E=i*i+n*n;if(E<=2)return new ht(i,n);r=Math.sqrt(E/2)}else{var _=!1;s>Number.EPSILON?l>Number.EPSILON&&(_=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(_=!0):Math.sign(a)===Math.sign(c)&&(_=!0),_?(i=-a,n=s,r=Math.sqrt(u)):(i=s,n=a,r=Math.sqrt(u/2))}return new ht(i/r,n/r)}for(var z=[],V=0,G=R.length,W=G-1,Y=V+1;V<G;V++,W++,Y++)W===G&&(W=0),Y===G&&(Y=0),z[V]=j(R[V],R[W],R[Y]);var X,K,Q=[],q=z.concat();for(l=0,c=N.length;l<c;l++){for(a=N[l],X=[],V=0,G=a.length,W=G-1,Y=V+1;V<G;V++,W++,Y++)W===G&&(W=0),Y===G&&(Y=0),X[V]=j(a[V],a[W],a[Y]);Q.push(X),q=q.concat(X)}for(x=0;x<v;x++){for(k=x/v,B=m*Math.cos(k*Math.PI/2),O=y*Math.sin(k*Math.PI/2),V=0,G=R.length;V<G;V++)$((P=D(R[V],z[V],O)).x,P.y,-B);for(l=0,c=N.length;l<c;l++)for(a=N[l],X=Q[l],V=0,G=a.length;V<G;V++)$((P=D(a[V],X[V],O)).x,P.y,-B)}for(O=y,V=0;V<F;V++)P=E?D(C[V],q[V],O):C[V],M?(r.copy(i.normals[0]).multiplyScalar(P.x),n.copy(i.binormals[0]).multiplyScalar(P.y),s.copy(o[0]).add(r).add(n),$(s.x,s.y,s.z)):$(P.x,P.y,0);for(K=1;K<=T;K++)for(V=0;V<F;V++)P=E?D(C[V],q[V],O):C[V],M?(r.copy(i.normals[K]).multiplyScalar(P.x),n.copy(i.binormals[K]).multiplyScalar(P.y),s.copy(o[K]).add(r).add(n),$(s.x,s.y,s.z)):$(P.x,P.y,f/T*K);for(x=v-1;x>=0;x--){for(k=x/v,B=m*Math.cos(k*Math.PI/2),O=y*Math.sin(k*Math.PI/2),V=0,G=R.length;V<G;V++)$((P=D(R[V],z[V],O)).x,P.y,f+B);for(l=0,c=N.length;l<c;l++)for(a=N[l],X=Q[l],V=0,G=a.length;V<G;V++)P=D(a[V],X[V],O),M?$(P.x,P.y+o[T-1].y,o[T-1].x+B):$(P.x,P.y,f+B)}function J(e,t){var o,i;for(V=e.length;--V>=0;){o=V,(i=V-1)<0&&(i=e.length-1);var n=0,r=T+2*v;for(n=0;n<r;n++){var s=F*n,a=F*(n+1),l=t+o+s,c=t+i+s,u=t+i+a,h=t+o+a;ee(l,c,u,h)}}}function $(e,t,o){p.push(e),p.push(t),p.push(o)}function Z(e,t,o){te(e),te(t),te(o);var i=h.length/3,n=A.generateTopUV(S,h,i-3,i-2,i-1);oe(n[0]),oe(n[1]),oe(n[2])}function ee(e,t,o,i,n,r,s,a,l){te(e),te(t),te(i),te(t),te(o),te(i);var c=h.length/3,u=A.generateSideWallUV(S,h,c-6,c-3,c-2,c-1);oe(u[0]),oe(u[1]),oe(u[3]),oe(u[1]),oe(u[2]),oe(u[3])}function te(e){g.push(h.length/3),h.push(p[3*e+0]),h.push(p[3*e+1]),h.push(p[3*e+2])}function oe(e){d.push(e.x),d.push(e.y)}!function(){var e=h.length/3;if(E){var o=0,i=F*o;for(V=0;V<H;V++)Z((U=I[V])[2]+i,U[1]+i,U[0]+i);for(i=F*(o=T+2*v),V=0;V<H;V++)Z((U=I[V])[0]+i,U[1]+i,U[2]+i)}else{for(V=0;V<H;V++)Z((U=I[V])[2],U[1],U[0]);for(V=0;V<H;V++)Z((U=I[V])[0]+F*T,U[1]+F*T,U[2]+F*T)}S.addGroup(e,h.length/3-e,void 0!==t.material?t.material:0)}(),function(){var e=h.length/3,o=0;for(J(R,o),o+=R.length,l=0,c=N.length;l<c;l++)J(a=N[l],o),o+=a.length;S.addGroup(e,h.length/3-e,void 0!==t.extrudeMaterial?t.extrudeMaterial:1)}(),t.arrays||(this.setIndex(g),this.addAttribute("position",new Ti(h,3)),this.addAttribute("uv",new Ti(t.arrays.uv,2)))},Xn.WorldUVGenerator={generateTopUV:function(e,t,o,i,n){var r=t[3*o],s=t[3*o+1],a=t[3*i],l=t[3*i+1],c=t[3*n],u=t[3*n+1];return[new ht(r,s),new ht(a,l),new ht(c,u)]},generateSideWallUV:function(e,t,o,i,n,r){var s=t[3*o],a=t[3*o+1],l=t[3*o+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],g=t[3*n],d=t[3*n+1],p=t[3*n+2],f=t[3*r],m=t[3*r+1],y=t[3*r+2];return Math.abs(a-u)<.01?[new ht(s,1-l),new ht(c,1-h),new ht(g,1-p),new ht(f,1-y)]:[new ht(a,1-l),new ht(u,1-h),new ht(d,1-p),new ht(m,1-y)]}},Qn.prototype=Object.create(gi.prototype),Qn.prototype.constructor=Qn,qn.prototype=Object.create(Kn.prototype),qn.prototype.constructor=qn,Jn.prototype=Object.create(gi.prototype),Jn.prototype.constructor=Jn,$n.prototype=Object.create(Si.prototype),$n.prototype.constructor=$n,Zn.prototype=Object.create(gi.prototype),Zn.prototype.constructor=Zn,er.prototype=Object.create(Si.prototype),er.prototype.constructor=er,tr.prototype=Object.create(gi.prototype),tr.prototype.constructor=tr,or.prototype=Object.create(Si.prototype),or.prototype.constructor=or,ir.prototype=Object.create(gi.prototype),ir.prototype.constructor=ir,nr.prototype=Object.create(Si.prototype),nr.prototype.constructor=nr,rr.prototype=Object.create(Si.prototype),rr.prototype.constructor=rr,sr.prototype=Object.create(gi.prototype),sr.prototype.constructor=sr,ar.prototype=Object.create(Si.prototype),ar.prototype.constructor=ar,lr.prototype=Object.create(sr.prototype),lr.prototype.constructor=lr,cr.prototype=Object.create(ar.prototype),cr.prototype.constructor=cr,ur.prototype=Object.create(gi.prototype),ur.prototype.constructor=ur,hr.prototype=Object.create(Si.prototype),hr.prototype.constructor=hr;var gr=Object.freeze({WireframeGeometry:Cn,ParametricGeometry:Nn,ParametricBufferGeometry:Ln,TetrahedronGeometry:Dn,TetrahedronBufferGeometry:xn,OctahedronGeometry:On,OctahedronBufferGeometry:kn,IcosahedronGeometry:Bn,IcosahedronBufferGeometry:Pn,DodecahedronGeometry:Un,DodecahedronBufferGeometry:Fn,PolyhedronGeometry:In,PolyhedronBufferGeometry:Rn,TubeGeometry:Hn,TubeBufferGeometry:jn,TorusKnotGeometry:zn,TorusKnotBufferGeometry:Vn,TorusGeometry:Gn,TorusBufferGeometry:Wn,TextGeometry:Qn,TextBufferGeometry:qn,SphereGeometry:Jn,SphereBufferGeometry:$n,RingGeometry:Zn,RingBufferGeometry:er,PlaneGeometry:Ni,PlaneBufferGeometry:Li,LatheGeometry:tr,LatheBufferGeometry:or,ShapeGeometry:ir,ShapeBufferGeometry:nr,ExtrudeGeometry:Xn,ExtrudeBufferGeometry:Kn,EdgesGeometry:rr,ConeGeometry:lr,ConeBufferGeometry:cr,CylinderGeometry:sr,CylinderBufferGeometry:ar,CircleGeometry:ur,CircleBufferGeometry:hr,BoxGeometry:wi,BoxBufferGeometry:Ci});function dr(e){Do.call(this),this.type="ShadowMaterial",this.color=new fo(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(e)}function pr(e){xo.call(this,e),this.type="RawShaderMaterial"}function fr(e){Do.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fo(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fo(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function mr(e){fr.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function yr(e){Do.call(this),this.type="MeshPhongMaterial",this.color=new fo(16777215),this.specular=new fo(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fo(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vr(e){yr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Er(e){Do.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function _r(e){Do.call(this),this.type="MeshLambertMaterial",this.color=new fo(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fo(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Tr(e){yn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}dr.prototype=Object.create(Do.prototype),dr.prototype.constructor=dr,dr.prototype.isShadowMaterial=!0,pr.prototype=Object.create(xo.prototype),pr.prototype.constructor=pr,pr.prototype.isRawShaderMaterial=!0,fr.prototype=Object.create(Do.prototype),fr.prototype.constructor=fr,fr.prototype.isMeshStandardMaterial=!0,fr.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},mr.prototype=Object.create(fr.prototype),mr.prototype.constructor=mr,mr.prototype.isMeshPhysicalMaterial=!0,mr.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},yr.prototype=Object.create(Do.prototype),yr.prototype.constructor=yr,yr.prototype.isMeshPhongMaterial=!0,yr.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vr.prototype=Object.create(yr.prototype),vr.prototype.constructor=vr,vr.prototype.isMeshToonMaterial=!0,vr.prototype.copy=function(e){return yr.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Er.prototype=Object.create(Do.prototype),Er.prototype.constructor=Er,Er.prototype.isMeshNormalMaterial=!0,Er.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},_r.prototype=Object.create(Do.prototype),_r.prototype.constructor=_r,_r.prototype.isMeshLambertMaterial=!0,_r.prototype.copy=function(e){return Do.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Tr.prototype=Object.create(yn.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isLineDashedMaterial=!0,Tr.prototype.copy=function(e){return yn.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var br=Object.freeze({ShadowMaterial:dr,SpriteMaterial:hn,RawShaderMaterial:pr,ShaderMaterial:xo,PointsMaterial:Tn,MeshPhysicalMaterial:mr,MeshStandardMaterial:fr,MeshPhongMaterial:yr,MeshToonMaterial:vr,MeshNormalMaterial:Er,MeshLambertMaterial:_r,MeshDepthMaterial:Oo,MeshDistanceMaterial:ko,MeshBasicMaterial:Ii,LineDashedMaterial:Tr,LineBasicMaterial:yn,Material:Do}),Mr={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Ar(e,t,o){var i=this,n=!1,r=0,s=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=o,this.itemStart=function(e){s++,!1===n&&void 0!==i.onStart&&i.onStart(e,r,s),n=!0},this.itemEnd=function(e){r++,void 0!==i.onProgress&&i.onProgress(e,r,s),r===s&&(n=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)}}var Sr=new Ar;function wr(e){this.manager=void 0!==e?e:Sr}function Cr(e){this.manager=void 0!==e?e:Sr,this._parser=null}function Nr(e){this.manager=void 0!==e?e:Sr,this._parser=null}function Lr(e){this.manager=void 0!==e?e:Sr}function Ir(e){this.manager=void 0!==e?e:Sr}function Rr(e){this.manager=void 0!==e?e:Sr}function Dr(e,t){qo.call(this),this.type="Light",this.color=new fo(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function xr(e,t,o){Dr.call(this,e,o),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(qo.DefaultUp),this.updateMatrix(),this.groundColor=new fo(t)}function Or(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new ht(512,512),this.map=null,this.matrix=new St}function kr(){Or.call(this,new Zo(50,1,.5,500))}function Br(e,t,o,i,n,r){Dr.call(this,e,t),this.type="SpotLight",this.position.copy(qo.DefaultUp),this.updateMatrix(),this.target=new qo,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==o?o:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new kr}function Pr(e,t,o,i){Dr.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==o?o:0,this.decay=void 0!==i?i:1,this.shadow=new Or(new Zo(90,1,.5,500))}function Ur(){Or.call(this,new $o(-5,5,5,-5,.5,500))}function Fr(e,t){Dr.call(this,e,t),this.type="DirectionalLight",this.position.copy(qo.DefaultUp),this.updateMatrix(),this.target=new qo,this.shadow=new Ur}function Hr(e,t){Dr.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function jr(e,t,o,i){Dr.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==o?o:10,this.height=void 0!==i?i:10}Object.assign(wr.prototype,{load:function(e,t,o,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var n=this,r=Mr.get(e);if(void 0!==r)return n.manager.itemStart(e),setTimeout(function(){t&&t(r),n.manager.itemEnd(e)},0),r;var s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var a=s[1],l=!!s[2],c=s[3];c=window.decodeURIComponent(c),l&&(c=window.atob(c));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":u=new ArrayBuffer(c.length);for(var g=new Uint8Array(u),d=0;d<c.length;d++)g[d]=c.charCodeAt(d);"blob"===h&&(u=new Blob([u],{type:a}));break;case"document":var p=new DOMParser;u=p.parseFromString(c,a);break;case"json":u=JSON.parse(c);break;default:u=c}window.setTimeout(function(){t&&t(u),n.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){i&&i(t),n.manager.itemEnd(e),n.manager.itemError(e)},0)}}else{var f=new XMLHttpRequest;for(var m in f.open("GET",e,!0),f.addEventListener("load",function(o){var r=o.target.response;Mr.add(e,r),200===this.status?(t&&t(r),n.manager.itemEnd(e)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),t&&t(r),n.manager.itemEnd(e)):(i&&i(o),n.manager.itemEnd(e),n.manager.itemError(e))},!1),void 0!==o&&f.addEventListener("progress",function(e){o(e)},!1),f.addEventListener("error",function(t){i&&i(t),n.manager.itemEnd(e),n.manager.itemError(e)},!1),void 0!==this.responseType&&(f.responseType=this.responseType),void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials),f.overrideMimeType&&f.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)f.setRequestHeader(m,this.requestHeader[m]);f.send(null)}return n.manager.itemStart(e),f},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Cr.prototype,{load:function(e,t,o,i){var n=this,r=[],s=new Sn;s.image=r;var a=new wr(this.manager);function l(l){a.load(e[l],function(e){var o=n._parser(e,!0);r[l]={width:o.width,height:o.height,format:o.format,mipmaps:o.mipmaps},6===(c+=1)&&(1===o.mipmapCount&&(s.minFilter=ve),s.format=o.format,s.needsUpdate=!0,t&&t(s))},o,i)}if(a.setPath(this.path),a.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,u=0,h=e.length;u<h;++u)l(u);else a.load(e,function(e){var o=n._parser(e,!0);if(o.isCubemap)for(var i=o.mipmaps.length/o.mipmapCount,a=0;a<i;a++){r[a]={mipmaps:[]};for(var l=0;l<o.mipmapCount;l++)r[a].mipmaps.push(o.mipmaps[a*o.mipmapCount+l]),r[a].format=o.format,r[a].width=o.width,r[a].height=o.height}else s.image.width=o.width,s.image.height=o.height,s.mipmaps=o.mipmaps;1===o.mipmapCount&&(s.minFilter=ve),s.format=o.format,s.needsUpdate=!0,t&&t(s)},o,i);return s},setPath:function(e){return this.path=e,this}}),Object.assign(Nr.prototype,{load:function(e,t,o,i){var n=this,r=new wt,s=new wr(this.manager);return s.setResponseType("arraybuffer"),s.load(e,function(e){var o=n._parser(e);o&&(void 0!==o.image?r.image=o.image:void 0!==o.data&&(r.image.width=o.width,r.image.height=o.height,r.image.data=o.data),r.wrapS=void 0!==o.wrapS?o.wrapS:de,r.wrapT=void 0!==o.wrapT?o.wrapT:de,r.magFilter=void 0!==o.magFilter?o.magFilter:ve,r.minFilter=void 0!==o.minFilter?o.minFilter:_e,r.anisotropy=void 0!==o.anisotropy?o.anisotropy:1,void 0!==o.format&&(r.format=o.format),void 0!==o.type&&(r.type=o.type),void 0!==o.mipmaps&&(r.mipmaps=o.mipmaps),1===o.mipmapCount&&(r.minFilter=ve),r.needsUpdate=!0,t&&t(r,o))},o,i),r}}),Object.assign(Lr.prototype,{crossOrigin:"Anonymous",load:function(e,t,o,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var n=this,r=Mr.get(e);if(void 0!==r)return n.manager.itemStart(e),setTimeout(function(){t&&t(r),n.manager.itemEnd(e)},0),r;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");return s.addEventListener("load",function(){Mr.add(e,this),t&&t(this),n.manager.itemEnd(e)},!1),s.addEventListener("error",function(t){i&&i(t),n.manager.itemEnd(e),n.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),n.manager.itemStart(e),s.src=e,s},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ir.prototype,{crossOrigin:"Anonymous",load:function(e,t,o,i){var n=new Ct,r=new Lr(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);var s=0;function a(o){r.load(e[o],function(e){n.images[o]=e,6==++s&&(n.needsUpdate=!0,t&&t(n))},void 0,i)}for(var l=0;l<e.length;++l)a(l);return n},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Rr.prototype,{crossOrigin:"Anonymous",load:function(e,t,o,i){var n=new Lr(this.manager);n.setCrossOrigin(this.crossOrigin),n.setPath(this.path);var r=new Et;return r.image=n.load(e,function(){var o=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);r.format=o?Oe:ke,r.needsUpdate=!0,void 0!==t&&t(r)},o,i),r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Dr.prototype=Object.assign(Object.create(qo.prototype),{constructor:Dr,isLight:!0,copy:function(e){return qo.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=qo.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),xr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:xr,isHemisphereLight:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Or.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),kr.prototype=Object.assign(Object.create(Or.prototype),{constructor:kr,isSpotLightShadow:!0,update:function(e){var t=this.camera,o=2*ut.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;o===t.fov&&i===t.aspect&&n===t.far||(t.fov=o,t.aspect=i,t.far=n,t.updateProjectionMatrix())}}),Br.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Br,isSpotLight:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Pr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Pr,isPointLight:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Ur.prototype=Object.assign(Object.create(Or.prototype),{constructor:Ur}),Fr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Fr,isDirectionalLight:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Hr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Hr,isAmbientLight:!0}),jr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:jr,isRectAreaLight:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Dr.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var zr,Vr={arraySlice:function(e,t,o){return Vr.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==o?o:e.length)):e.slice(t,o)},convertArray:function(e,t,o){return!e||!o&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,o=new Array(t),i=0;i!==t;++i)o[i]=i;return o.sort(function(t,o){return e[t]-e[o]}),o},sortedArray:function(e,t,o){for(var i=e.length,n=new e.constructor(i),r=0,s=0;s!==i;++r)for(var a=o[r]*t,l=0;l!==t;++l)n[s++]=e[a+l];return n},flattenJSON:function(e,t,o,i){for(var n=1,r=e[0];void 0!==r&&void 0===r[i];)r=e[n++];if(void 0!==r){var s=r[i];if(void 0!==s)if(Array.isArray(s))do{void 0!==(s=r[i])&&(t.push(r.time),o.push.apply(o,s)),r=e[n++]}while(void 0!==r);else if(void 0!==s.toArray)do{void 0!==(s=r[i])&&(t.push(r.time),s.toArray(o,o.length)),r=e[n++]}while(void 0!==r);else do{void 0!==(s=r[i])&&(t.push(r.time),o.push(s)),r=e[n++]}while(void 0!==r)}}};function Gr(e,t,o,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(o),this.sampleValues=t,this.valueSize=o}function Wr(e,t,o,i){Gr.call(this,e,t,o,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Yr(e,t,o,i){Gr.call(this,e,t,o,i)}function Xr(e,t,o,i){Gr.call(this,e,t,o,i)}function Kr(e,t,o,i){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=Vr.convertArray(t,this.TimeBufferType),this.values=Vr.convertArray(o,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()}function Qr(e,t,o,i){Kr.call(this,e,t,o,i)}function qr(e,t,o,i){Gr.call(this,e,t,o,i)}function Jr(e,t,o,i){Kr.call(this,e,t,o,i)}function $r(e,t,o,i){Kr.call(this,e,t,o,i)}function Zr(e,t,o,i){Kr.call(this,e,t,o,i)}function es(e,t,o){Kr.call(this,e,t,o)}function ts(e,t,o,i){Kr.call(this,e,t,o,i)}function os(e,t,o,i){Kr.apply(this,arguments)}function is(e,t,o){this.name=e,this.tracks=o,this.duration=void 0!==t?t:-1,this.uuid=ut.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function ns(e){this.manager=void 0!==e?e:Sr,this.textures={}}function rs(e){this.manager=void 0!==e?e:Sr}Object.assign(Gr.prototype,{evaluate:function(e){var t=this.parameterPositions,o=this._cachedIndex,i=t[o],n=t[o-1];e:{t:{var r;o:{i:if(!(e<i)){for(var s=o+2;;){if(void 0===i){if(e<n)break i;return o=t.length,this._cachedIndex=o,this.afterEnd_(o-1,e,n)}if(o===s)break;if(n=i,i=t[++o],e<i)break t}r=t.length;break o}if(e>=n)break e;var a=t[1];e<a&&(o=2,n=a);for(var s=o-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(o===s)break;if(i=n,n=t[--o-1],e>=n)break t}r=o,o=0}for(;o<r;){var l=o+r>>>1;e<t[l]?r=l:o=l+1}if(i=t[o],void 0===(n=t[o-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return o=t.length,this._cachedIndex=o,this.afterEnd_(o-1,n,e)}this._cachedIndex=o,this.intervalChanged_(o,n,i)}return this.interpolate_(o,n,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,o=this.sampleValues,i=this.valueSize,n=e*i,r=0;r!==i;++r)t[r]=o[n+r];return t},interpolate_:function(e,t,o,i){throw new Error("call to abstract method")},intervalChanged_:function(e,t,o){}}),Object.assign(Gr.prototype,{beforeStart_:Gr.prototype.copySampleValue_,afterEnd_:Gr.prototype.copySampleValue_}),Wr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Wr,DefaultSettings_:{endingStart:Je,endingEnd:Je},intervalChanged_:function(e,t,o){var i=this.parameterPositions,n=e-2,r=e+1,s=i[n],a=i[r];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:n=e,s=2*t-o;break;case 2402:n=i.length-2,s=t+i[n]-i[n+1];break;default:n=e,s=o}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:r=e,a=2*o-t;break;case 2402:r=1,a=o+i[1]-i[0];break;default:r=e-1,a=t}var l=.5*(o-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(a-o),this._offsetPrev=n*c,this._offsetNext=r*c},interpolate_:function(e,t,o,i){for(var n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,g=this._weightNext,d=(o-t)/(i-t),p=d*d,f=p*d,m=-h*f+2*h*p-h*d,y=(1+h)*f+(-1.5-2*h)*p+(-.5+h)*d+1,v=(-1-g)*f+(1.5+g)*p+.5*d,E=g*f-g*p,_=0;_!==s;++_)n[_]=m*r[c+_]+y*r[l+_]+v*r[a+_]+E*r[u+_];return n}}),Yr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Yr,interpolate_:function(e,t,o,i){for(var n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=(o-t)/(i-t),u=1-c,h=0;h!==s;++h)n[h]=r[l+h]*u+r[a+h]*c;return n}}),Xr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Xr,interpolate_:function(e,t,o,i){return this.copySampleValue_(e-1)}}),zr={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Xr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Yr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Wr(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(o);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",o)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,o=0,i=t.length;o!==i;++o)t[o]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,o=0,i=t.length;o!==i;++o)t[o]*=e;return this},trim:function(e,t){for(var o=this.times,i=o.length,n=0,r=i-1;n!==i&&o[n]<e;)++n;for(;-1!==r&&o[r]>t;)--r;if(++r,0!==n||r!==i){n>=r&&(r=Math.max(r,1),n=r-1);var s=this.getValueSize();this.times=Vr.arraySlice(o,n,r),this.values=Vr.arraySlice(this.values,n*s,r*s)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1);var o=this.times,i=this.values,n=o.length;0===n&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1);for(var r=null,s=0;s!==n;s++){var a=o[s];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,s,a),e=!1;break}if(null!==r&&r>a){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,s,a,r),e=!1;break}r=a}if(void 0!==i&&Vr.isTypedArray(i))for(var s=0,l=i.length;s!==l;++s){var c=i[s];if(isNaN(c)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,s,c),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,o=this.getValueSize(),i=2302===this.getInterpolation(),n=1,r=e.length-1,s=1;s<r;++s){var a=!1,l=e[s],c=e[s+1];if(l!==c&&(1!==s||l!==l[0]))if(i)a=!0;else for(var u=s*o,h=u-o,g=u+o,d=0;d!==o;++d){var p=t[u+d];if(p!==t[h+d]||p!==t[g+d]){a=!0;break}}if(a){if(s!==n){e[n]=e[s];for(var f=s*o,m=n*o,d=0;d!==o;++d)t[m+d]=t[f+d]}++n}}if(r>0){e[n]=e[r];for(var f=r*o,m=n*o,d=0;d!==o;++d)t[m+d]=t[f+d];++n}return n!==e.length&&(this.times=Vr.arraySlice(e,0,n),this.values=Vr.arraySlice(t,0,n*o)),this}},Qr.prototype=Object.assign(Object.create(zr),{constructor:Qr,ValueTypeName:"vector"}),qr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:qr,interpolate_:function(e,t,o,i){for(var n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s,l=(o-t)/(i-t),c=a+s;a!==c;a+=4)Mt.slerpFlat(n,0,r,a-s,r,a,l);return n}}),Jr.prototype=Object.assign(Object.create(zr),{constructor:Jr,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new qr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),$r.prototype=Object.assign(Object.create(zr),{constructor:$r,ValueTypeName:"number"}),Zr.prototype=Object.assign(Object.create(zr),{constructor:Zr,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),es.prototype=Object.assign(Object.create(zr),{constructor:es,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ts.prototype=Object.assign(Object.create(zr),{constructor:ts,ValueTypeName:"color"}),os.prototype=zr,zr.constructor=os,Object.assign(os,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t=os._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var o=[],i=[];Vr.flattenJSON(e.keys,o,i,"value"),e.times=o,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,o=e.constructor;if(void 0!==o.toJSON)t=o.toJSON(e);else{t={name:e.name,times:Vr.convertArray(e.times,Array),values:Vr.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $r;case"vector":case"vector2":case"vector3":case"vector4":return Qr;case"color":return ts;case"quaternion":return Jr;case"bool":case"boolean":return es;case"string":return Zr}throw new Error("Unsupported typeName: "+e)}}),Object.assign(is,{parse:function(e){for(var t=[],o=e.tracks,i=1/(e.fps||1),n=0,r=o.length;n!==r;++n)t.push(os.parse(o[n]).scale(i));return new is(e.name,e.duration,t)},toJSON:function(e){for(var t=[],o=e.tracks,i={name:e.name,duration:e.duration,tracks:t},n=0,r=o.length;n!==r;++n)t.push(os.toJSON(o[n]));return i},CreateFromMorphTargetSequence:function(e,t,o,i){for(var n=t.length,r=[],s=0;s<n;s++){var a=[],l=[];a.push((s+n-1)%n,s,(s+1)%n),l.push(0,1,0);var c=Vr.getKeyframeOrder(a);a=Vr.sortedArray(a,1,c),l=Vr.sortedArray(l,1,c),i||0!==a[0]||(a.push(n),l.push(l[0])),r.push(new $r(".morphTargetInfluences["+t[s].name+"]",a,l).scale(1/o))}return new is(e,-1,r)},findByName:function(e,t){var o=e;if(!Array.isArray(e)){var i=e;o=i.geometry&&i.geometry.animations||i.animations}for(var n=0;n<o.length;n++)if(o[n].name===t)return o[n];return null},CreateClipsFromMorphTargetSequences:function(e,t,o){for(var i={},n=/^([\w-]*?)([\d]+)$/,r=0,s=e.length;r<s;r++){var a=e[r],l=a.name.match(n);if(l&&l.length>1){var c=l[1],u=i[c];u||(i[c]=u=[]),u.push(a)}}var h=[];for(var c in i)h.push(is.CreateFromMorphTargetSequence(c,i[c],t,o));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var o=function(e,t,o,i,n){if(0!==o.length){var r=[],s=[];Vr.flattenJSON(o,r,s,i),0!==r.length&&n.push(new e(t,r,s))}},i=[],n=e.name||"default",r=e.length||-1,s=e.fps||30,a=e.hierarchy||[],l=0;l<a.length;l++){var c=a[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var u={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var g=0;g<c[h].morphTargets.length;g++)u[c[h].morphTargets[g]]=-1;for(var d in u){for(var p=[],f=[],g=0;g!==c[h].morphTargets.length;++g){var m=c[h];p.push(m.time),f.push(m.morphTarget===d?1:0)}i.push(new $r(".morphTargetInfluence["+d+"]",p,f))}r=u.length*(s||1)}else{var y=".bones["+t[l].name+"]";o(Qr,y+".position",c,"pos",i),o(Jr,y+".quaternion",c,"rot",i),o(Qr,y+".scale",c,"scl",i)}}if(0===i.length)return null;var v=new is(n,r,i);return v}}),Object.assign(is.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,o=0,i=e.length;o!==i;++o){var n=this.tracks[o];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(ns.prototype,{load:function(e,t,o,i){var n=this,r=new wr(n.manager);r.load(e,function(e){t(n.parse(JSON.parse(e)))},o,i)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function o(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=new br[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(i.uniforms=e.uniforms),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=o(e.map)),void 0!==e.alphaMap&&(i.alphaMap=o(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=o(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=o(e.normalMap)),void 0!==e.normalScale){var n=e.normalScale;!1===Array.isArray(n)&&(n=[n,n]),i.normalScale=(new ht).fromArray(n)}return void 0!==e.displacementMap&&(i.displacementMap=o(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=o(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=o(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=o(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=o(e.specularMap)),void 0!==e.envMap&&(i.envMap=o(e.envMap)),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=o(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=o(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=o(e.gradientMap)),i}}),Object.assign(rs.prototype,{load:function(e,t,o,i){var n=this,r=new wr(n.manager);r.load(e,function(e){t(n.parse(JSON.parse(e)))},o,i)},parse:function(e){var t=new Si,o=e.data.index;if(void 0!==o){var i=new us[o.type](o.array);t.setIndex(new di(i,1))}var n=e.data.attributes;for(var r in n){var s=n[r],i=new us[s.type](s.array);t.addAttribute(r,new di(i,s.itemSize,s.normalized))}var a=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==a)for(var l=0,c=a.length;l!==c;++l){var u=a[l];t.addGroup(u.start,u.count,u.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var g=new At;void 0!==h.center&&g.fromArray(h.center),t.boundingSphere=new Po(g,h.radius)}return t}});var ss,as,ls,cs,us={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function hs(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function gs(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:Sr,this.withCredentials=!1}function ds(e){this.manager=void 0!==e?e:Sr,this.texturePath=""}hs.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,o=0,i=t.length;o<i;o+=2){var n=t[o],r=t[o+1];if(n.test(e))return r}return null}},Object.assign(hs.prototype,{crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,o){for(var i=[],n=0;n<e.length;++n)i[n]=this.createMaterial(e[n],t,o);return i},createMaterial:(ss={NoBlending:T,NormalBlending:b,AdditiveBlending:M,SubtractiveBlending:A,MultiplyBlending:S,CustomBlending:w},as=new fo,ls=new Rr,cs=new ns,function(e,t,o){var i={};function n(e,n,r,s,a){var l,c=t+e,u=hs.Handlers.get(c);null!==u?l=u.load(c):(ls.setCrossOrigin(o),l=ls.load(c)),void 0!==n&&(l.repeat.fromArray(n),1!==n[0]&&(l.wrapS=ge),1!==n[1]&&(l.wrapT=ge)),void 0!==r&&l.offset.fromArray(r),void 0!==s&&("repeat"===s[0]&&(l.wrapS=ge),"mirror"===s[0]&&(l.wrapS=pe),"repeat"===s[1]&&(l.wrapT=ge),"mirror"===s[1]&&(l.wrapT=pe)),void 0!==a&&(l.anisotropy=a);var h=ut.generateUUID();return i[h]=l,h}var r={uuid:ut.generateUUID(),type:"MeshLambertMaterial"};for(var s in e){var a=e[s];switch(s){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":r.name=a;break;case"blending":r.blending=ss[a];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",s,"is no longer supported.");break;case"colorDiffuse":r.color=as.fromArray(a).getHex();break;case"colorSpecular":r.specular=as.fromArray(a).getHex();break;case"colorEmissive":r.emissive=as.fromArray(a).getHex();break;case"specularCoef":r.shininess=a;break;case"shading":"basic"===a.toLowerCase()&&(r.type="MeshBasicMaterial"),"phong"===a.toLowerCase()&&(r.type="MeshPhongMaterial"),"standard"===a.toLowerCase()&&(r.type="MeshStandardMaterial");break;case"mapDiffuse":r.map=n(a,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":r.emissiveMap=n(a,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":r.lightMap=n(a,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":r.aoMap=n(a,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":r.bumpMap=n(a,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":r.bumpScale=a;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":r.normalMap=n(a,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":r.normalScale=[a,a];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":r.specularMap=n(a,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":r.metalnessMap=n(a,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":r.roughnessMap=n(a,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":r.alphaMap=n(a,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":r.side=m;break;case"doubleSided":r.side=y;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),r.opacity=a;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":r[s]=a;break;case"vertexColors":!0===a&&(r.vertexColors=_),"face"===a&&(r.vertexColors=E);break;default:console.error("THREE.Loader.createMaterial: Unsupported",s,a)}}return"MeshBasicMaterial"===r.type&&delete r.emissive,"MeshPhongMaterial"!==r.type&&delete r.specular,r.opacity<1&&(r.transparent=!0),cs.setTextures(i),cs.parse(r)})}),Object.assign(gs.prototype,{load:function(e,t,o,i){var n=this,r=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:hs.prototype.extractUrlBase(e),s=new wr(this.manager);s.setWithCredentials(this.withCredentials),s.load(e,function(o){var i=JSON.parse(o),s=i.metadata;if(void 0!==s){var a=s.type;if(void 0!==a){if("object"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var l=n.parse(i,r);t(l.geometry,l.materials)},o,i)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var o=new gi;if(function(e,t){function o(e,t){return e&1<<t}var i,n,r,s,a,l,c,u,h,g,d,p,f,m,y,v,E,_,T,b,M,A,S,w,C,N,L,I=e.faces,R=e.vertices,D=e.normals,x=e.colors,O=e.scale,k=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&k++;for(i=0;i<k;i++)t.faceVertexUvs[i]=[]}for(s=0,a=R.length;s<a;)(_=new At).x=R[s++]*O,_.y=R[s++]*O,_.z=R[s++]*O,t.vertices.push(_);for(s=0,a=I.length;s<a;)if(g=I[s++],d=o(g,0),p=o(g,1),f=o(g,3),m=o(g,4),y=o(g,5),v=o(g,6),E=o(g,7),d){if((b=new ei).a=I[s],b.b=I[s+1],b.c=I[s+3],(M=new ei).a=I[s+1],M.b=I[s+2],M.c=I[s+3],s+=4,p&&(h=I[s++],b.materialIndex=h,M.materialIndex=h),r=t.faces.length,f)for(i=0;i<k;i++)for(w=e.uvs[i],t.faceVertexUvs[i][r]=[],t.faceVertexUvs[i][r+1]=[],n=0;n<4;n++)u=I[s++],N=w[2*u],L=w[2*u+1],C=new ht(N,L),2!==n&&t.faceVertexUvs[i][r].push(C),0!==n&&t.faceVertexUvs[i][r+1].push(C);if(m&&(c=3*I[s++],b.normal.set(D[c++],D[c++],D[c]),M.normal.copy(b.normal)),y)for(i=0;i<4;i++)c=3*I[s++],S=new At(D[c++],D[c++],D[c]),2!==i&&b.vertexNormals.push(S),0!==i&&M.vertexNormals.push(S);if(v&&(l=I[s++],A=x[l],b.color.setHex(A),M.color.setHex(A)),E)for(i=0;i<4;i++)l=I[s++],A=x[l],2!==i&&b.vertexColors.push(new fo(A)),0!==i&&M.vertexColors.push(new fo(A));t.faces.push(b),t.faces.push(M)}else{if((T=new ei).a=I[s++],T.b=I[s++],T.c=I[s++],p&&(h=I[s++],T.materialIndex=h),r=t.faces.length,f)for(i=0;i<k;i++)for(w=e.uvs[i],t.faceVertexUvs[i][r]=[],n=0;n<3;n++)u=I[s++],N=w[2*u],L=w[2*u+1],C=new ht(N,L),t.faceVertexUvs[i][r].push(C);if(m&&(c=3*I[s++],T.normal.set(D[c++],D[c++],D[c])),y)for(i=0;i<3;i++)c=3*I[s++],S=new At(D[c++],D[c++],D[c]),T.vertexNormals.push(S);if(v&&(l=I[s++],T.color.setHex(x[l])),E)for(i=0;i<3;i++)l=I[s++],T.vertexColors.push(new fo(x[l]));t.faces.push(T)}}(e,o),function(e,t){var o=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,n=e.skinWeights.length;i<n;i+=o){var r=e.skinWeights[i],s=o>1?e.skinWeights[i+1]:0,a=o>2?e.skinWeights[i+2]:0,l=o>3?e.skinWeights[i+3]:0;t.skinWeights.push(new _t(r,s,a,l))}if(e.skinIndices)for(var i=0,n=e.skinIndices.length;i<n;i+=o){var c=e.skinIndices[i],u=o>1?e.skinIndices[i+1]:0,h=o>2?e.skinIndices[i+2]:0,g=o>3?e.skinIndices[i+3]:0;t.skinIndices.push(new _t(c,u,h,g))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,o),function(e,t){var o=e.scale;if(void 0!==e.morphTargets)for(var i=0,n=e.morphTargets.length;i<n;i++){t.morphTargets[i]={},t.morphTargets[i].name=e.morphTargets[i].name,t.morphTargets[i].vertices=[];for(var r=t.morphTargets[i].vertices,s=e.morphTargets[i].vertices,a=0,l=s.length;a<l;a+=3){var c=new At;c.x=s[a]*o,c.y=s[a+1]*o,c.z=s[a+2]*o,r.push(c)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var u=t.faces,h=e.morphColors[0].colors,i=0,n=u.length;i<n;i++)u[i].color.fromArray(h,3*i)}}(e,o),function(e,t){var o=[],i=[];void 0!==e.animation&&i.push(e.animation),void 0!==e.animations&&(e.animations.length?i=i.concat(e.animations):i.push(e.animations));for(var n=0;n<i.length;n++){var r=is.parseAnimation(i[n],t.bones);r&&o.push(r)}if(t.morphTargets){var s=is.CreateClipsFromMorphTargetSequences(t.morphTargets,10);o=o.concat(s)}o.length>0&&(t.animations=o)}(e,o),o.computeFaceNormals(),o.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:o};var i=hs.prototype.initMaterials(e.materials,t,this.crossOrigin);return{geometry:o,materials:i}}}),Object.assign(ds.prototype,{load:function(e,t,o,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var n=this,r=new wr(n.manager);r.load(e,function(o){var r=null;try{r=JSON.parse(o)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var s=r.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?n.parse(r,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},o,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var o=this.parseGeometries(e.geometries),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),n=this.parseTextures(e.textures,i),r=this.parseMaterials(e.materials,n),s=this.parseObject(e.object,o,r);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseGeometries:function(e){var t={};if(void 0!==e)for(var o=new gs,i=new rs,n=0,r=e.length;n<r;n++){var s,a=e[n];switch(a.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new gr[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new gr[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new gr[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new gr[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new gr[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new gr[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":s=new gr[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new gr[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new gr[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new gr[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new gr[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"BufferGeometry":s=i.parse(a);break;case"Geometry":s=o.parse(a,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),t[a.uuid]=s}return t},parseMaterials:function(e,t){var o={};if(void 0!==e){var i=new ns;i.setTextures(t);for(var n=0,r=e.length;n<r;n++){var s=e[n];if("MultiMaterial"===s.type){for(var a=[],l=0;l<s.materials.length;l++)a.push(i.parse(s.materials[l]));o[s.uuid]=a}else o[s.uuid]=i.parse(s)}}return o},parseAnimations:function(e){for(var t=[],o=0;o<e.length;o++){var i=is.parse(e[o]);t.push(i)}return t},parseImages:function(e,t){var o=this,i={};function n(e){return o.manager.itemStart(e),s.load(e,function(){o.manager.itemEnd(e)},void 0,function(){o.manager.itemEnd(e),o.manager.itemError(e)})}if(void 0!==e&&e.length>0){var r=new Ar(t),s=new Lr(r);s.setCrossOrigin(this.crossOrigin);for(var a=0,l=e.length;a<l;a++){var c=e[a],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:o.texturePath+c.url;i[c.uuid]=n(u)}}return i},parseTextures:function(e,t){function o(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var i={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var s=e[n];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var a=new Et(t[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=o(s.mapping,ps)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.wrap&&(a.wrapS=o(s.wrap[0],fs),a.wrapT=o(s.wrap[1],fs)),void 0!==s.minFilter&&(a.minFilter=o(s.minFilter,ms)),void 0!==s.magFilter&&(a.magFilter=o(s.magFilter,ms)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),i[s.uuid]=a}return i},parseObject:function(){var e=new St;return function(t,o,i){var n;function r(e){return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),o[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],o=0,n=e.length;o<n;o++){var r=e[o];void 0===i[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(i[r])}return t}return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),i[e]}}switch(t.type){case"Scene":n=new cn,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new fo(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new ln(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new an(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new Zo(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new $o(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new Hr(t.color,t.intensity);break;case"DirectionalLight":n=new Fr(t.color,t.intensity);break;case"PointLight":n=new Pr(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new jr(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new Br(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new xr(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=r(t.geometry),l=s(t.material);n=a.bones&&a.bones.length>0?new mn(a,l):new Oi(a,l);break;case"LOD":n=new dn;break;case"Line":n=new vn(r(t.geometry),s(t.material),t.mode);break;case"LineLoop":n=new _n(r(t.geometry),s(t.material));break;case"LineSegments":n=new En(r(t.geometry),s(t.material));break;case"PointCloud":case"Points":n=new bn(r(t.geometry),s(t.material));break;case"Sprite":n=new gn(s(t.material));break;case"Group":n=new Mn;break;default:n=new qo}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var c=t.children,u=0;u<c.length;u++)n.add(this.parseObject(c[u],o,i));if("LOD"===t.type)for(var h=t.levels,g=0;g<h.length;g++){var d=h[g],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}}()});var ps={UVMapping:300,CubeReflectionMapping:re,CubeRefractionMapping:se,EquirectangularReflectionMapping:ae,EquirectangularRefractionMapping:le,SphericalReflectionMapping:ce,CubeUVReflectionMapping:ue,CubeUVRefractionMapping:he},fs={RepeatWrapping:ge,ClampToEdgeWrapping:de,MirroredRepeatWrapping:pe},ms={NearestFilter:fe,NearestMipMapNearestFilter:me,NearestMipMapLinearFilter:ye,LinearFilter:ve,LinearMipMapNearestFilter:Ee,LinearMipMapLinearFilter:_e};function ys(e,t,o,i,n){var r=.5*(i-t),s=.5*(n-o),a=e*e,l=e*a;return(2*o-2*i+r+s)*l+(-3*o+3*i-2*r-s)*a+r*e+o}function vs(e,t,o,i){return function(e,t){var o=1-e;return o*o*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,o)+function(e,t){return e*e*t}(e,i)}function Es(e,t,o,i,n){return function(e,t){var o=1-e;return o*o*o*t}(e,t)+function(e,t){var o=1-e;return 3*o*o*e*t}(e,o)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,n)}function _s(){this.arcLengthDivisions=200}function Ts(e,t){_s.call(this),this.v1=e,this.v2=t}function bs(){_s.call(this),this.curves=[],this.autoClose=!1}function Ms(e,t,o,i,n,r,s,a){_s.call(this),this.aX=e,this.aY=t,this.xRadius=o,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=r,this.aClockwise=s,this.aRotation=a||0}function As(e){_s.call(this),this.points=void 0===e?[]:e}function Ss(e,t,o,i){_s.call(this),this.v0=e,this.v1=t,this.v2=o,this.v3=i}function ws(e,t,o){_s.call(this),this.v0=e,this.v1=t,this.v2=o}Object.assign(_s.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],o=0;o<=e;o++)t.push(this.getPoint(o/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],o=0;o<=e;o++)t.push(this.getPointAt(o/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,o,i=[],n=this.getPoint(0),r=0;for(i.push(0),o=1;o<=e;o++)t=this.getPoint(o/e),r+=t.distanceTo(n),i.push(r),n=t;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var o,i=this.getLengths(),n=0,r=i.length;o=t||e*i[r-1];for(var s,a=0,l=r-1;a<=l;)if(n=Math.floor(a+(l-a)/2),(s=i[n]-o)<0)a=n+1;else{if(!(s>0)){l=n;break}l=n-1}if(i[n=l]===o)return n/(r-1);var c=i[n],u=i[n+1],h=u-c,g=(o-c)/h,d=(n+g)/(r-1);return d},getTangent:function(e){var t=e-1e-4,o=e+1e-4;t<0&&(t=0),o>1&&(o=1);var i=this.getPoint(t),n=this.getPoint(o),r=n.clone().sub(i);return r.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var o,i,n,r=new At,s=[],a=[],l=[],c=new At,u=new St;for(o=0;o<=e;o++)i=o/e,s[o]=this.getTangentAt(i),s[o].normalize();a[0]=new At,l[0]=new At;var h=Number.MAX_VALUE,g=Math.abs(s[0].x),d=Math.abs(s[0].y),p=Math.abs(s[0].z);for(g<=h&&(h=g,r.set(1,0,0)),d<=h&&(h=d,r.set(0,1,0)),p<=h&&r.set(0,0,1),c.crossVectors(s[0],r).normalize(),a[0].crossVectors(s[0],c),l[0].crossVectors(s[0],a[0]),o=1;o<=e;o++)a[o]=a[o-1].clone(),l[o]=l[o-1].clone(),c.crossVectors(s[o-1],s[o]),c.length()>Number.EPSILON&&(c.normalize(),n=Math.acos(ut.clamp(s[o-1].dot(s[o]),-1,1)),a[o].applyMatrix4(u.makeRotationAxis(c,n))),l[o].crossVectors(s[o],a[o]);if(!0===t)for(n=Math.acos(ut.clamp(a[0].dot(a[e]),-1,1)),n/=e,s[0].dot(c.crossVectors(a[0],a[e]))>0&&(n=-n),o=1;o<=e;o++)a[o].applyMatrix4(u.makeRotationAxis(s[o],n*o)),l[o].crossVectors(s[o],a[o]);return{tangents:s,normals:a,binormals:l}}}),Ts.prototype=Object.create(_s.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isLineCurve=!0,Ts.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},Ts.prototype.getPointAt=function(e){return this.getPoint(e)},Ts.prototype.getTangent=function(e){var t=this.v2.clone().sub(this.v1);return t.normalize()},bs.prototype=Object.assign(Object.create(_s.prototype),{constructor:bs,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ts(t,e))},getPoint:function(e){for(var t=e*this.getLength(),o=this.getCurveLengths(),i=0;i<o.length;){if(o[i]>=t){var n=o[i]-t,r=this.curves[i],s=r.getLength(),a=0===s?0:1-n/s;return r.getPointAt(a)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,o=0,i=this.curves.length;o<i;o++)t+=this.curves[o].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],o=0;o<=e;o++)t.push(this.getPoint(o/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,o=[],i=0,n=this.curves;i<n.length;i++)for(var r=n[i],s=r&&r.isEllipseCurve?2*e:r&&r.isLineCurve?1:r&&r.isSplineCurve?e*r.points.length:e,a=r.getPoints(s),l=0;l<a.length;l++){var c=a[l];t&&t.equals(c)||(o.push(c),t=c)}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},createPointsGeometry:function(e){var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){for(var t=new gi,o=0,i=e.length;o<i;o++){var n=e[o];t.vertices.push(new At(n.x,n.y,n.z||0))}return t}}),Ms.prototype=Object.create(_s.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isEllipseCurve=!0,Ms.prototype.getPoint=function(e){for(var t=2*Math.PI,o=this.aEndAngle-this.aStartAngle,i=Math.abs(o)<Number.EPSILON;o<0;)o+=t;for(;o>t;)o-=t;o<Number.EPSILON&&(o=i?0:t),!0!==this.aClockwise||i||(o===t?o=-t:o-=t);var n=this.aStartAngle+e*o,r=this.aX+this.xRadius*Math.cos(n),s=this.aY+this.yRadius*Math.sin(n);if(0!==this.aRotation){var a=Math.cos(this.aRotation),l=Math.sin(this.aRotation),c=r-this.aX,u=s-this.aY;r=c*a-u*l+this.aX,s=c*l+u*a+this.aY}return new ht(r,s)},As.prototype=Object.create(_s.prototype),As.prototype.constructor=As,As.prototype.isSplineCurve=!0,As.prototype.getPoint=function(e){var t=this.points,o=(t.length-1)*e,i=Math.floor(o),n=o-i,r=t[0===i?i:i-1],s=t[i],a=t[i>t.length-2?t.length-1:i+1],l=t[i>t.length-3?t.length-1:i+2];return new ht(ys(n,r.x,s.x,a.x,l.x),ys(n,r.y,s.y,a.y,l.y))},Ss.prototype=Object.create(_s.prototype),Ss.prototype.constructor=Ss,Ss.prototype.getPoint=function(e){var t=this.v0,o=this.v1,i=this.v2,n=this.v3;return new ht(Es(e,t.x,o.x,i.x,n.x),Es(e,t.y,o.y,i.y,n.y))},ws.prototype=Object.create(_s.prototype),ws.prototype.constructor=ws,ws.prototype.getPoint=function(e){var t=this.v0,o=this.v1,i=this.v2;return new ht(vs(e,t.x,o.x,i.x),vs(e,t.y,o.y,i.y))};var Cs,Ns=Object.assign(Object.create(bs.prototype),{fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,o=e.length;t<o;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var o=new Ts(this.currentPoint.clone(),new ht(e,t));this.curves.push(o),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,o,i){var n=new ws(this.currentPoint.clone(),new ht(e,t),new ht(o,i));this.curves.push(n),this.currentPoint.set(o,i)},bezierCurveTo:function(e,t,o,i,n,r){var s=new Ss(this.currentPoint.clone(),new ht(e,t),new ht(o,i),new ht(n,r));this.curves.push(s),this.currentPoint.set(n,r)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),o=new As(t);this.curves.push(o),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,o,i,n,r){var s=this.currentPoint.x,a=this.currentPoint.y;this.absarc(e+s,t+a,o,i,n,r)},absarc:function(e,t,o,i,n,r){this.absellipse(e,t,o,o,i,n,r)},ellipse:function(e,t,o,i,n,r,s,a){var l=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(e+l,t+c,o,i,n,r,s,a)},absellipse:function(e,t,o,i,n,r,s,a){var l=new Ms(e,t,o,i,n,r,s,a);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var u=l.getPoint(1);this.currentPoint.copy(u)}});function Ls(e){bs.call(this),this.currentPoint=new ht,e&&this.fromPoints(e)}function Is(){Ls.apply(this,arguments),this.holes=[]}function Rs(){this.subPaths=[],this.currentPath=null}function Ds(e){this.data=e}function xs(e){this.manager=void 0!==e?e:Sr}Ls.prototype=Ns,Ns.constructor=Ls,Is.prototype=Object.assign(Object.create(Ns),{constructor:Is,getPointsHoles:function(e){for(var t=[],o=0,i=this.holes.length;o<i;o++)t[o]=this.holes[o].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),Object.assign(Rs.prototype,{moveTo:function(e,t){this.currentPath=new Ls,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,o,i){this.currentPath.quadraticCurveTo(e,t,o,i)},bezierCurveTo:function(e,t,o,i,n,r){this.currentPath.bezierCurveTo(e,t,o,i,n,r)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function o(e){for(var t=[],o=0,i=e.length;o<i;o++){var n=e[o],r=new Is;r.curves=n.curves,t.push(r)}return t}function i(e,t){for(var o=t.length,i=!1,n=o-1,r=0;r<o;n=r++){var s=t[n],a=t[r],l=a.x-s.x,c=a.y-s.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(s=t[r],l=-l,a=t[n],c=-c),e.y<s.y||e.y>a.y)continue;if(e.y===s.y){if(e.x===s.x)return!0}else{var u=c*(e.x-s.x)-l*(e.y-s.y);if(0===u)return!0;if(u<0)continue;i=!i}}else{if(e.y!==s.y)continue;if(a.x<=e.x&&e.x<=s.x||s.x<=e.x&&e.x<=a.x)return!0}}return i}var n=Yn.isClockWise,r=this.subPaths;if(0===r.length)return[];if(!0===t)return o(r);var s,a,l,c=[];if(1===r.length)return a=r[0],(l=new Is).curves=a.curves,c.push(l),c;var u=!n(r[0].getPoints());u=e?!u:u;var h,g,d=[],p=[],f=[],m=0;p[m]=void 0,f[m]=[];for(var y=0,v=r.length;y<v;y++)a=r[y],h=a.getPoints(),s=n(h),(s=e?!s:s)?(!u&&p[m]&&m++,p[m]={s:new Is,p:h},p[m].s.curves=a.curves,u&&m++,f[m]=[]):f[m].push({h:a,p:h[0]});if(!p[0])return o(r);if(p.length>1){for(var E=!1,_=[],T=0,b=p.length;T<b;T++)d[T]=[];for(var T=0,b=p.length;T<b;T++)for(var M=f[T],A=0;A<M.length;A++){for(var S=M[A],w=!0,C=0;C<p.length;C++)i(S.p,p[C].p)&&(T!==C&&_.push({froms:T,tos:C,hole:A}),w?(w=!1,d[C].push(S)):E=!0);w&&d[T].push(S)}_.length>0&&(E||(f=d))}for(var y=0,N=p.length;y<N;y++){l=p[y].s,c.push(l);for(var L=0,I=(g=f[y]).length;L<I;L++)l.holes.push(g[L].h)}return c}}),Object.assign(Ds.prototype,{isFont:!0,generateShapes:function(e,t,o){function i(e,t,i,r){var s=n.glyphs[e]||n.glyphs["?"];if(s){var a,l,c,u,h,g,d,p,f,m,y,v=new Rs,E=[];if(s.o)for(var _=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),T=0,b=_.length;T<b;){var M=_[T++];switch(M){case"m":a=_[T++]*t+i,l=_[T++]*t+r,v.moveTo(a,l);break;case"l":a=_[T++]*t+i,l=_[T++]*t+r,v.lineTo(a,l);break;case"q":if(c=_[T++]*t+i,u=_[T++]*t+r,d=_[T++]*t+i,p=_[T++]*t+r,v.quadraticCurveTo(d,p,c,u),y=E[E.length-1]){h=y.x,g=y.y;for(var A=1;A<=o;A++){var S=A/o;vs(S,h,d,c),vs(S,g,p,u)}}break;case"b":if(c=_[T++]*t+i,u=_[T++]*t+r,d=_[T++]*t+i,p=_[T++]*t+r,f=_[T++]*t+i,m=_[T++]*t+r,v.bezierCurveTo(d,p,f,m,c,u),y=E[E.length-1]){h=y.x,g=y.y;for(var A=1;A<=o;A++){var S=A/o;Es(S,h,d,f,c),Es(S,g,p,m,u)}}}}return{offsetX:s.ha*t,path:v}}}void 0===t&&(t=100),void 0===o&&(o=4);for(var n=this.data,r=function(e){for(var o=String(e).split(""),r=t/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,a=0,l=0,c=[],u=0;u<o.length;u++){var h=o[u];if("\n"===h)a=0,l-=s;else{var g=i(h,r,a,l);a+=g.offsetX,c.push(g.path)}}return c}(e),s=[],a=0,l=r.length;a<l;a++)Array.prototype.push.apply(s,r[a].toShapes());return s}}),Object.assign(xs.prototype,{load:function(e,t,o,i){var n=this,r=new wr(this.manager);r.load(e,function(e){var o;try{o=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),o=JSON.parse(e.substring(65,e.length-2))}var i=n.parse(o);t&&t(i)},o,i)},parse:function(e){return new Ds(e)}});var Os,ks,Bs,Ps,Us,Fs,Hs,js,zs,Vs,Gs,Ws,Ys,Xs,Ks,Qs,qs={getContext:function(){return void 0===Cs&&(Cs=new(window.AudioContext||window.webkitAudioContext)),Cs},setContext:function(e){Cs=e}};function Js(e){this.manager=void 0!==e?e:Sr}function $s(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Zs(e,t,o){qo.call(this),this.type="CubeCamera";var i=new Zo(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new At(1,0,0)),this.add(i);var n=new Zo(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new At(-1,0,0)),this.add(n);var r=new Zo(90,1,e,t);r.up.set(0,0,1),r.lookAt(new At(0,1,0)),this.add(r);var s=new Zo(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new At(0,-1,0)),this.add(s);var a=new Zo(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new At(0,0,1)),this.add(a);var l=new Zo(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new At(0,0,-1)),this.add(l);var c={format:Oe,magFilter:ve,minFilter:ve};this.renderTarget=new bt(o,o,c),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var o=this.renderTarget,c=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,o.activeCubeFace=0,e.render(t,i,o),o.activeCubeFace=1,e.render(t,n,o),o.activeCubeFace=2,e.render(t,r,o),o.activeCubeFace=3,e.render(t,s,o),o.activeCubeFace=4,e.render(t,a,o),o.texture.generateMipmaps=c,o.activeCubeFace=5,e.render(t,l,o),e.setRenderTarget(null)},this.clear=function(e,t,o,i){for(var n=this.renderTarget,r=0;r<6;r++)n.activeCubeFace=r,e.setRenderTarget(n),e.clear(t,o,i);e.setRenderTarget(null)}}function ea(){qo.call(this),this.type="AudioListener",this.context=qs.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function ta(e){qo.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function oa(e){ta.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ia(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function na(e,t,o){this.binding=e,this.valueSize=o;var i,n=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":n=Array,i=this._select;break;default:i=this._lerp}this.buffer=new n(4*o),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function ra(e,t,o){var i=o||sa.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function sa(e,t,o){this.path=t,this.parsedPath=o||sa.parseTrackName(t),this.node=sa.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function aa(e){this.uuid=ut.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var o=0,i=arguments.length;o!==i;++o)t[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function la(e,t,o){this._mixer=e,this._clip=t,this._localRoot=o||null;for(var i=t.tracks,n=i.length,r=new Array(n),s={endingStart:Je,endingEnd:Je},a=0;a!==n;++a){var l=i[a].createInterpolant(null);r[a]=l,l.settings=s}this._interpolantSettings=s,this._interpolants=r,this._propertyBindings=new Array(n),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function ca(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function ua(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function ha(){Si.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ga(e,t,o,i){this.uuid=ut.generateUUID(),this.data=e,this.itemSize=t,this.offset=o,this.normalized=!0===i}function da(e,t){this.uuid=ut.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function pa(e,t,o){da.call(this,e,t),this.meshPerAttribute=o||1}function fa(e,t,o){di.call(this,e,t),this.meshPerAttribute=o||1}function ma(e,t,o,i){this.ray=new Ri(e,t),this.near=o||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ya(e,t){return e.distance-t.distance}function va(e,t,o,i){if(!1!==e.visible&&(e.raycast(t,o),!0===i))for(var n=e.children,r=0,s=n.length;r<s;r++)va(n[r],t,o,!0)}function Ea(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function _a(e,t,o){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==o?o:0,this}function Ta(e,t,o){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==o?o:0,this}function ba(e){qo.call(this),this.material=e,this.render=function(e){}}function Ma(e,t,o,i){this.object=e,this.size=void 0!==t?t:1;var n=void 0!==o?o:16711680,r=void 0!==i?i:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=3*a.faces.length:a&&a.isBufferGeometry&&(s=a.attributes.normal.count);var l=new Si,c=new Ti(2*s*3,3);l.addAttribute("position",c),En.call(this,l,new yn({color:n,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Aa(e,t){qo.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var o=new Si,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;n<32;n++,r++){var s=n/32*Math.PI*2,a=r/32*Math.PI*2;i.push(Math.cos(s),Math.sin(s),1,Math.cos(a),Math.sin(a),1)}o.addAttribute("position",new Ti(i,3));var l=new yn({fog:!1});this.cone=new En(o,l),this.add(this.cone),this.update()}function Sa(e){for(var t=function e(t){var o=[];t&&t.isBone&&o.push(t);for(var i=0;i<t.children.length;i++)o.push.apply(o,e(t.children[i]));return o}(e),o=new Si,i=[],n=[],r=new fo(0,0,1),s=new fo(0,1,0),a=0;a<t.length;a++){var l=t[a];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),n.push(r.r,r.g,r.b),n.push(s.r,s.g,s.b))}o.addAttribute("position",new Ti(i,3)),o.addAttribute("color",new Ti(n,3));var c=new yn({vertexColors:_,depthTest:!1,depthWrite:!1,transparent:!0});En.call(this,o,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function wa(e,t,o){this.light=e,this.light.updateMatrixWorld(),this.color=o;var i=new $n(t,4,2),n=new Ii({wireframe:!0,fog:!1});Oi.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Ca(e,t){qo.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var o=new yn({fog:!1}),i=new Si;i.addAttribute("position",new di(new Float32Array(15),3)),this.line=new vn(i,o),this.add(this.line),this.update()}function Na(e,t,o){qo.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o;var i=new kn(t);i.rotateY(.5*Math.PI),this.material=new Ii({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=_);var n=i.getAttribute("position"),r=new Float32Array(3*n.count);i.addAttribute("color",new di(r,3)),this.add(new Oi(i,this.material)),this.update()}function La(e,t,o,i){e=e||10,t=t||10,o=new fo(void 0!==o?o:4473924),i=new fo(void 0!==i?i:8947848);for(var n=t/2,r=e/t,s=e/2,a=[],l=[],c=0,u=0,h=-s;c<=t;c++,h+=r){a.push(-s,0,h,s,0,h),a.push(h,0,-s,h,0,s);var g=c===n?o:i;g.toArray(l,u),u+=3,g.toArray(l,u),u+=3,g.toArray(l,u),u+=3,g.toArray(l,u),u+=3}var d=new Si;d.addAttribute("position",new Ti(a,3)),d.addAttribute("color",new Ti(l,3));var p=new yn({vertexColors:_});En.call(this,d,p)}function Ia(e,t,o,i,n,r){e=e||10,t=t||16,o=o||8,i=i||64,n=new fo(void 0!==n?n:4473924),r=new fo(void 0!==r?r:8947848);var s,a,l,c,u,h,g,d=[],p=[];for(c=0;c<=t;c++)l=c/t*(2*Math.PI),s=Math.sin(l)*e,a=Math.cos(l)*e,d.push(0,0,0),d.push(s,0,a),g=1&c?n:r,p.push(g.r,g.g,g.b),p.push(g.r,g.g,g.b);for(c=0;c<=o;c++)for(g=1&c?n:r,h=e-e/o*c,u=0;u<i;u++)l=u/i*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,d.push(s,0,a),p.push(g.r,g.g,g.b),l=(u+1)/i*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,d.push(s,0,a),p.push(g.r,g.g,g.b);var f=new Si;f.addAttribute("position",new Ti(d,3)),f.addAttribute("color",new Ti(p,3));var m=new yn({vertexColors:_});En.call(this,f,m)}function Ra(e,t,o,i){this.object=e,this.size=void 0!==t?t:1;var n=void 0!==o?o:16776960,r=void 0!==i?i:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=a.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Si,c=new Ti(2*s*3,3);l.addAttribute("position",c),En.call(this,l,new yn({color:n,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Da(e,t,o){qo.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,void 0===t&&(t=1);var i=new Si;i.addAttribute("position",new Ti([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new yn({fog:!1});this.lightPlane=new vn(i,n),this.add(this.lightPlane),(i=new Si).addAttribute("position",new Ti([0,0,0,0,0,1],3)),this.targetLine=new vn(i,n),this.add(this.targetLine),this.update()}function xa(e){var t=new Si,o=new yn({color:16777215,vertexColors:E}),i=[],n=[],r={},s=new fo(16755200),a=new fo(16711680),l=new fo(43775),c=new fo(16777215),u=new fo(3355443);function h(e,t,o){g(e,o),g(t,o)}function g(e,t){i.push(0,0,0),n.push(t.r,t.g,t.b),void 0===r[e]&&(r[e]=[]),r[e].push(i.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new Ti(i,3)),t.addAttribute("color",new Ti(n,3)),En.call(this,t,o),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update()}function Oa(e,t){this.object=e,void 0===t&&(t=16776960);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),n=new Si;n.setIndex(new di(o,1)),n.addAttribute("position",new di(i,3)),En.call(this,n,new yn({color:t})),this.matrixAutoUpdate=!1,this.update()}function ka(e,t){this.type="Box3Helper",this.box=e;var o=void 0!==t?t:16776960,i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Si;n.setIndex(new di(i,1)),n.addAttribute("position",new Ti([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),En.call(this,n,new yn({color:o})),this.geometry.computeBoundingSphere(),this.onBeforeRender()}function Ba(e,t,o){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var i=void 0!==o?o:16776960,n=new Si;n.addAttribute("position",new Ti([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),vn.call(this,n,new yn({color:i}));var r=new Si;r.addAttribute("position",new Ti([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),r.computeBoundingSphere(),this.add(new Oi(r,new Ii({color:i,opacity:.2,transparent:!0,depthWrite:!1}))),this.onBeforeRender()}function Pa(e,t,o,i,n,r){qo.call(this),void 0===i&&(i=16776960),void 0===o&&(o=1),void 0===n&&(n=.2*o),void 0===r&&(r=.2*n),void 0===Ys&&((Ys=new Si).addAttribute("position",new Ti([0,0,0,0,1,0],3)),(Xs=new ar(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new vn(Ys,new yn({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Oi(Xs,new Ii({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(o,n,r)}function Ua(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],o=new Si;o.addAttribute("position",new Ti(t,3)),o.addAttribute("color",new Ti([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new yn({vertexColors:_});En.call(this,o,i)}function Fa(){var e=0,t=0,o=0,i=0;function n(n,r,s,a){e=n,t=s,o=-3*n+3*r-2*s-a,i=2*n-2*r+s+a}return{initCatmullRom:function(e,t,o,i,r){n(t,o,r*(o-e),r*(i-t))},initNonuniformCatmullRom:function(e,t,o,i,r,s,a){var l=(t-e)/r-(o-e)/(r+s)+(o-t)/s,c=(o-t)/s-(i-t)/(s+a)+(i-o)/a;n(t,o,l*=s,c*=s)},calc:function(n){var r=n*n,s=r*n;return e+t*n+o*r+i*s}}}Object.assign(Js.prototype,{load:function(e,t,o,i){var n=new wr(this.manager);n.setResponseType("arraybuffer"),n.load(e,function(e){var o=qs.getContext();o.decodeAudioData(e,function(e){t(e)})},o,i)}}),Object.assign($s.prototype,{update:(zs=new St,Vs=new St,function(e){var t=Os!==this||ks!==e.focus||Bs!==e.fov||Ps!==e.aspect*this.aspect||Us!==e.near||Fs!==e.far||Hs!==e.zoom||js!==this.eyeSep;if(t){Os=this,ks=e.focus,Bs=e.fov,Ps=e.aspect*this.aspect,Us=e.near,Fs=e.far,Hs=e.zoom;var o,i,n=e.projectionMatrix.clone(),r=(js=this.eyeSep/2)*Us/ks,s=Us*Math.tan(ut.DEG2RAD*Bs*.5)/Hs;Vs.elements[12]=-js,zs.elements[12]=js,o=-s*Ps+r,i=s*Ps+r,n.elements[0]=2*Us/(i-o),n.elements[8]=(i+o)/(i-o),this.cameraL.projectionMatrix.copy(n),o=-s*Ps-r,i=s*Ps-r,n.elements[0]=2*Us/(i-o),n.elements[8]=(i+o)/(i-o),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Vs),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zs)})}),Zs.prototype=Object.create(qo.prototype),Zs.prototype.constructor=Zs,ea.prototype=Object.assign(Object.create(qo.prototype),{constructor:ea,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new At,t=new Mt,o=new At,i=new At;return function(n){qo.prototype.updateMatrixWorld.call(this,n);var r=this.context.listener,s=this.up;this.matrixWorld.decompose(e,t,o),i.set(0,0,-1).applyQuaternion(t),r.positionX?(r.positionX.setValueAtTime(e.x,this.context.currentTime),r.positionY.setValueAtTime(e.y,this.context.currentTime),r.positionZ.setValueAtTime(e.z,this.context.currentTime),r.forwardX.setValueAtTime(i.x,this.context.currentTime),r.forwardY.setValueAtTime(i.y,this.context.currentTime),r.forwardZ.setValueAtTime(i.z,this.context.currentTime),r.upX.setValueAtTime(s.x,this.context.currentTime),r.upY.setValueAtTime(s.y,this.context.currentTime),r.upZ.setValueAtTime(s.z,this.context.currentTime)):(r.setPosition(e.x,e.y,e.z),r.setOrientation(i.x,i.y,i.z,s.x,s.y,s.z))}}()}),ta.prototype=Object.assign(Object.create(qo.prototype),{constructor:ta,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),e.start(0,this.startTime),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),oa.prototype=Object.assign(Object.create(ta.prototype),{constructor:oa,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new At;return function(t){qo.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(ia.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),o=0;o<t.length;o++)e+=t[o];return e/t.length}}),Object.assign(na.prototype,{accumulate:function(e,t){var o=this.buffer,i=this.valueSize,n=e*i+i,r=this.cumulativeWeight;if(0===r){for(var s=0;s!==i;++s)o[n+s]=o[s];r=t}else{var a=t/(r+=t);this._mixBufferRegion(o,n,0,a,i)}this.cumulativeWeight=r},apply:function(e){var t=this.valueSize,o=this.buffer,i=e*t+t,n=this.cumulativeWeight,r=this.binding;if(this.cumulativeWeight=0,n<1){var s=3*t;this._mixBufferRegion(o,i,s,1-n,t)}for(var a=t,l=t+t;a!==l;++a)if(o[a]!==o[a+t]){r.setValue(o,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,o=this.valueSize,i=3*o;e.getValue(t,i);for(var n=o,r=i;n!==r;++n)t[n]=t[i+n%o];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,o,i,n){if(i>=.5)for(var r=0;r!==n;++r)e[t+r]=e[o+r]},_slerp:function(e,t,o,i){Mt.slerpFlat(e,t,e,t,e,o,i)},_lerp:function(e,t,o,i,n){for(var r=1-i,s=0;s!==n;++s){var a=t+s;e[a]=e[a]*r+e[o+s]*i}}}),Object.assign(ra.prototype,{getValue:function(e,t){this.bind();var o=this._targetGroup.nCachedObjects_,i=this._bindings[o];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){for(var o=this._bindings,i=this._targetGroup.nCachedObjects_,n=o.length;i!==n;++i)o[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,o=e.length;t!==o;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,o=e.length;t!==o;++t)e[t].unbind()}}),Object.assign(sa,{Composite:ra,create:function(e,t,o){return e&&e.isAnimationObjectGroup?new sa.Composite(e,t,o):new sa(e,t,o)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:(Gs=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),Ws=["material","materials","bones"],function(e){var t=Gs.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var o={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var n=o.nodeName.substring(i+1);-1!==Ws.indexOf(n)&&(o.nodeName=o.nodeName.substring(0,i),o.objectName=n)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var o=function(e){for(var o=0;o<e.bones.length;o++){var i=e.bones[o];if(i.name===t)return i}return null}(e.skeleton);if(o)return o}if(e.children){var i=function(e){for(var o=0;o<e.length;o++){var n=e[o];if(n.name===t||n.uuid===t)return n;var r=i(n.children);if(r)return r}return null},n=i(e.children);if(n)return n}return null}}),Object.assign(sa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var o=this.resolvedProperty,i=0,n=o.length;i!==n;++i)e[t++]=o[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var o=this.resolvedProperty,i=0,n=o.length;i!==n;++i)o[i]=e[t++]},function(e,t){for(var o=this.resolvedProperty,i=0,n=o.length;i!==n;++i)o[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var o=this.resolvedProperty,i=0,n=o.length;i!==n;++i)o[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,o=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=sa.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(o){var r=t.objectIndex;switch(o){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var s=0;s<e.length;s++)if(e[s].name===r){r=s;break}break;default:if(void 0===e[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[o]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}var a=e[i];if(void 0!==a){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(var s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(e.geometry.morphAttributes.position[s].name===n){n=s;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(var s=0;s<this.node.geometry.morphTargets.length;s++)if(e.geometry.morphTargets[s].name===n){n=s;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=n}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(sa.prototype,{_getValue_unbound:sa.prototype.getValue,_setValue_unbound:sa.prototype.setValue}),Object.assign(aa.prototype,{isAnimationObjectGroup:!0,add:function(e){for(var t=this._objects,o=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,s=this._parsedPaths,a=this._bindings,l=a.length,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],g=h.uuid,d=n[g],p=void 0;if(void 0===d){d=o++,n[g]=d,t.push(h);for(var f=0,m=l;f!==m;++f)a[f].push(new sa(h,r[f],s[f]))}else if(d<i){p=t[d];var y=--i,v=t[y];n[v.uuid]=d,t[d]=v,n[g]=y,t[y]=h;for(var f=0,m=l;f!==m;++f){var E=a[f],_=E[y],T=E[d];E[d]=_,void 0===T&&(T=new sa(h,r[f],s[f])),E[y]=T}}else t[d]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(e){for(var t=this._objects,o=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,s=0,a=arguments.length;s!==a;++s){var l=arguments[s],c=l.uuid,u=i[c];if(void 0!==u&&u>=o){var h=o++,g=t[h];i[g.uuid]=u,t[u]=g,i[c]=h,t[h]=l;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[h],y=f[u];f[u]=m,f[h]=y}}}this.nCachedObjects_=o},uncache:function(e){for(var t=this._objects,o=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,s=r.length,a=0,l=arguments.length;a!==l;++a){var c=arguments[a],u=c.uuid,h=n[u];if(void 0!==h)if(delete n[u],h<i){var g=--i,d=t[g],p=--o,f=t[p];n[d.uuid]=h,t[h]=d,n[f.uuid]=g,t[g]=f,t.pop();for(var m=0,y=s;m!==y;++m){var v=r[m],E=v[g],_=v[p];v[h]=E,v[g]=_,v.pop()}}else{var p=--o,f=t[p];n[f.uuid]=h,t[h]=f,t.pop();for(var m=0,y=s;m!==y;++m){var v=r[m];v[h]=v[p],v.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var o=this._bindingsIndicesByPath,i=o[e],n=this._bindings;if(void 0!==i)return n[i];var r=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);i=n.length,o[e]=i,r.push(e),s.push(t),n.push(u);for(var h=c,g=a.length;h!==g;++h){var d=a[h];u[h]=new sa(d,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,o=t[e];if(void 0!==o){var i=this._paths,n=this._parsedPaths,r=this._bindings,s=r.length-1,a=r[s],l=e[s];t[l]=o,r[o]=a,r.pop(),n[o]=n[s],n.pop(),i[o]=i[s],i.pop()}}}),Object.assign(la.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,o){if(e.fadeOut(t),this.fadeIn(t),o){var i=this._clip.duration,n=e._clip.duration,r=n/i,s=i/n;e.warp(1,r,t),this.warp(s,1,t)}return this},crossFadeTo:function(e,t,o){return e.crossFadeFrom(this,t,o)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,o){var i=this._mixer,n=i.time,r=this._timeScaleInterpolant,s=this.timeScale;null===r&&(r=i._lendControlInterpolant(),this._timeScaleInterpolant=r);var a=r.parameterPositions,l=r.sampleValues;return a[0]=n,a[1]=n+o,l[0]=e/s,l[1]=t/s,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,o,i){if(this.enabled){var n=this._startTime;if(null!==n){var r=(e-n)*o;if(r<0||0===o)return;this._startTime=null,t=o*r}t*=this._updateTimeScale(e);var s=this._updateTime(t),a=this._updateWeight(e);if(a>0)for(var l=this._interpolants,c=this._propertyBindings,u=0,h=l.length;u!==h;++u)l[u].evaluate(s),c[u].accumulate(i,a)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var o=this._weightInterpolant;if(null!==o){var i=o.evaluate(e)[0];t*=i,e>o.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var o=this._timeScaleInterpolant;if(null!==o){var i=o.evaluate(e)[0];t*=i,e>o.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var o=this._clip.duration,i=this.loop,n=this._loopCount;if(2200===i){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=o)t=o;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var r=2202===i;if(-1===n&&(e>=0?(n=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),t>=o||t<0){var s=Math.floor(t/o);t-=o*s,n+=Math.abs(s);var a=this.repetitions-n;if(a<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?o:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===a){var l=e<0;this._setEndings(l,!l,r)}else this._setEndings(!1,!1,r);this._loopCount=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}if(r&&1==(1&n))return this.time=t,o-t}return this.time=t,t},_setEndings:function(e,t,o){var i=this._interpolantSettings;o?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:Je:2402,i.endingEnd=t?this.zeroSlopeAtEnd?2401:Je:2402)},_scheduleFading:function(e,t,o){var i=this._mixer,n=i.time,r=this._weightInterpolant;null===r&&(r=i._lendControlInterpolant(),this._weightInterpolant=r);var s=r.parameterPositions,a=r.sampleValues;return s[0]=n,a[0]=t,s[1]=n+e,a[1]=o,this}}),Object.assign(ca.prototype,t.prototype,{_bindAction:function(e,t){var o=e._localRoot||this._root,i=e._clip.tracks,n=i.length,r=e._propertyBindings,s=e._interpolants,a=o.uuid,l=this._bindingsByRootAndName,c=l[a];void 0===c&&(c={},l[a]=c);for(var u=0;u!==n;++u){var h=i[u],g=h.name,d=c[g];if(void 0!==d)r[u]=d;else{if(void 0!==(d=r[u])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,a,g));continue}var p=t&&t._propertyBindings[u].binding.parsedPath;++(d=new na(sa.create(o,g,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,a,g),r[u]=d}s[u].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,o=e._clip.uuid,i=this._actionsByClip[o];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,o,t)}for(var n=e._propertyBindings,r=0,s=n.length;r!==s;++r){var a=n[r];0==a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,o=0,i=t.length;o!==i;++o){var n=t[o];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,o){var i=this._actions,n=this._actionsByClip,r=n[t];if(void 0===r)r={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=r;else{var s=r.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=i.length,i.push(e),r.actionByRoot[o]=e},_removeInactiveAction:function(e){var t=this._actions,o=t[t.length-1],i=e._cacheIndex;o._cacheIndex=i,t[i]=o,t.pop(),e._cacheIndex=null;var n=e._clip.uuid,r=this._actionsByClip,s=r[n],a=s.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;var u=s.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],0===a.length&&delete r[n],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,o=0,i=t.length;o!==i;++o){var n=t[o];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(e){var t=this._actions,o=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=o,t[o]=n},_takeBackAction:function(e){var t=this._actions,o=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=o,t[o]=n},_addInactiveBinding:function(e,t,o){var i=this._bindingsByRootAndName,n=i[t],r=this._bindings;void 0===n&&(n={},i[t]=n),n[o]=e,e._cacheIndex=r.length,r.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,o=e.binding,i=o.rootNode.uuid,n=o.path,r=this._bindingsByRootAndName,s=r[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[n];e:{for(var c in s)break e;delete r[i]}},_lendBinding:function(e){var t=this._bindings,o=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=o,t[o]=n},_takeBackBinding:function(e){var t=this._bindings,o=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=o,t[o]=n},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,o=e[t];return void 0===o&&((o=new Yr(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=o),o},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,o=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=o,t[o]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var o=t||this._root,i=o.uuid,n="string"==typeof e?is.findByName(o,e):e,r=null!==n?n.uuid:e,s=this._actionsByClip[r],a=null;if(void 0!==s){var l=s.actionByRoot[i];if(void 0!==l)return l;a=s.knownActions[0],null===n&&(n=a._clip)}if(null===n)return null;var c=new la(this,n,t);return this._bindAction(c,a),this._addInactiveAction(c,r,i),c},existingAction:function(e,t){var o=t||this._root,i=o.uuid,n="string"==typeof e?is.findByName(o,e):e,r=n?n.uuid:e,s=this._actionsByClip[r];return void 0!==s&&s.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,o=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var n=0;n!==t;++n)e[n].reset();for(var n=0;n!==i;++n)o[n].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,o=this._nActiveActions,i=this.time+=e,n=Math.sign(e),r=this._accuIndex^=1,s=0;s!==o;++s){var a=t[s];a._update(i,e,n,r)}for(var l=this._bindings,c=this._nActiveBindings,s=0;s!==c;++s)l[s].apply(r);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,o=e.uuid,i=this._actionsByClip,n=i[o];if(void 0!==n){for(var r=n.knownActions,s=0,a=r.length;s!==a;++s){var l=r[s];this._deactivateAction(l);var c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[o]}},uncacheRoot:function(e){var t=e.uuid,o=this._actionsByClip;for(var i in o){var n=o[i].actionByRoot,r=n[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var s=this._bindingsByRootAndName,a=s[t];if(void 0!==a)for(var l in a){var c=a[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(e,t){var o=this.existingAction(e,t);null!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}}),ua.prototype.clone=function(){return new ua(void 0===this.value.clone?this.value:this.value.clone())},ha.prototype=Object.assign(Object.create(Si.prototype),{constructor:ha,isInstancedBufferGeometry:!0,addGroup:function(e,t,o){this.groups.push({start:e,count:t,materialIndex:o})},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var o=e.attributes;for(var i in o){var n=o[i];this.addAttribute(i,n.clone())}for(var r=e.groups,s=0,a=r.length;s<a;s++){var l=r[s];this.addGroup(l.start,l.count,l.materialIndex)}return this}}),Object.defineProperties(ga.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ga.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=o,this},setXYZ:function(e,t,o,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=o,this.data.array[e+2]=i,this},setXYZW:function(e,t,o,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=o,this.data.array[e+2]=i,this.data.array[e+3]=n,this}}),Object.defineProperty(da.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(da.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,o){e*=this.stride,o*=t.stride;for(var i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[o+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),pa.prototype=Object.assign(Object.create(da.prototype),{constructor:pa,isInstancedInterleavedBuffer:!0,copy:function(e){return da.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),fa.prototype=Object.assign(Object.create(di.prototype),{constructor:fa,isInstancedBufferAttribute:!0,copy:function(e){return di.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(ma.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var o=[];return va(e,this,o,t),o.sort(ya),o},intersectObjects:function(e,t){var o=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var i=0,n=e.length;i<n;i++)va(e[i],this,o,t);return o.sort(ya),o}}),Object.assign(Ea.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(_a.prototype,{set:function(e,t,o){return this.radius=e,this.phi=t,this.theta=o,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(ut.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Ta.prototype,{set:function(e,t,o){return this.radius=e,this.theta=t,this.y=o,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),ba.prototype=Object.create(qo.prototype),ba.prototype.constructor=ba,ba.prototype.isImmediateRenderObject=!0,Ma.prototype=Object.create(En.prototype),Ma.prototype.constructor=Ma,Ma.prototype.update=function(){var e=new At,t=new At,o=new Uo;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),o.getNormalMatrix(this.object.matrixWorld);var n=this.object.matrixWorld,r=this.geometry.attributes.position,s=this.object.geometry;if(s&&s.isGeometry)for(var a=s.vertices,l=s.faces,c=0,u=0,h=l.length;u<h;u++)for(var g=l[u],d=0,p=g.vertexNormals.length;d<p;d++){var f=a[g[i[d]]],m=g.vertexNormals[d];e.copy(f).applyMatrix4(n),t.copy(m).applyMatrix3(o).normalize().multiplyScalar(this.size).add(e),r.setXYZ(c,e.x,e.y,e.z),c+=1,r.setXYZ(c,t.x,t.y,t.z),c+=1}else if(s&&s.isBufferGeometry)for(var y=s.attributes.position,v=s.attributes.normal,c=0,d=0,p=y.count;d<p;d++)e.set(y.getX(d),y.getY(d),y.getZ(d)).applyMatrix4(n),t.set(v.getX(d),v.getY(d),v.getZ(d)),t.applyMatrix3(o).normalize().multiplyScalar(this.size).add(e),r.setXYZ(c,e.x,e.y,e.z),c+=1,r.setXYZ(c,t.x,t.y,t.z),c+=1;r.needsUpdate=!0}}(),Aa.prototype=Object.create(qo.prototype),Aa.prototype.constructor=Aa,Aa.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Aa.prototype.update=function(){var e=new At,t=new At;return function(){this.light.updateMatrixWorld();var o=this.light.distance?this.light.distance:1e3,i=o*Math.tan(this.light.angle);this.cone.scale.set(i,i,o),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Sa.prototype=Object.create(En.prototype),Sa.prototype.constructor=Sa,Sa.prototype.onBeforeRender=function(){var e=new At,t=new St,o=new St;return function(){var i=this.bones,n=this.geometry,r=n.getAttribute("position");o.getInverse(this.root.matrixWorld);for(var s=0,a=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(t.multiplyMatrices(o,l.matrixWorld),e.setFromMatrixPosition(t),r.setXYZ(a,e.x,e.y,e.z),t.multiplyMatrices(o,l.parent.matrixWorld),e.setFromMatrixPosition(t),r.setXYZ(a+1,e.x,e.y,e.z),a+=2)}n.getAttribute("position").needsUpdate=!0}}(),wa.prototype=Object.create(Oi.prototype),wa.prototype.constructor=wa,wa.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},wa.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Ca.prototype=Object.create(qo.prototype),Ca.prototype.constructor=Ca,Ca.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ca.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,o=this.line.geometry.attributes.position,i=o.array;i[0]=e,i[1]=-t,i[2]=0,i[3]=e,i[4]=t,i[5]=0,i[6]=-e,i[7]=t,i[8]=0,i[9]=-e,i[10]=-t,i[11]=0,i[12]=e,i[13]=-t,i[14]=0,o.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Na.prototype=Object.create(qo.prototype),Na.prototype.constructor=Na,Na.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Na.prototype.update=function(){var e=new At,t=new fo,o=new fo;return function(){var i=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var n=i.geometry.getAttribute("color");t.copy(this.light.color),o.copy(this.light.groundColor);for(var r=0,s=n.count;r<s;r++){var a=r<s/2?t:o;n.setXYZ(r,a.r,a.g,a.b)}n.needsUpdate=!0}i.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),La.prototype=Object.create(En.prototype),La.prototype.constructor=La,Ia.prototype=Object.create(En.prototype),Ia.prototype.constructor=Ia,Ra.prototype=Object.create(En.prototype),Ra.prototype.constructor=Ra,Ra.prototype.update=function(){var e=new At,t=new At,o=new Uo;return function(){this.object.updateMatrixWorld(!0),o.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,n=this.geometry.attributes.position,r=this.object.geometry,s=r.vertices,a=r.faces,l=0,c=0,u=a.length;c<u;c++){var h=a[c],g=h.normal;e.copy(s[h.a]).add(s[h.b]).add(s[h.c]).divideScalar(3).applyMatrix4(i),t.copy(g).applyMatrix3(o).normalize().multiplyScalar(this.size).add(e),n.setXYZ(l,e.x,e.y,e.z),l+=1,n.setXYZ(l,t.x,t.y,t.z),l+=1}n.needsUpdate=!0}}(),Da.prototype=Object.create(qo.prototype),Da.prototype.constructor=Da,Da.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Da.prototype.update=function(){var e=new At,t=new At,o=new At;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),o.subVectors(t,e),this.lightPlane.lookAt(o),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(o),this.targetLine.scale.z=o.length()}}(),xa.prototype=Object.create(En.prototype),xa.prototype.constructor=xa,xa.prototype.update=function(){var e,t,o=new At,i=new Jo;function n(n,r,s,a){o.set(r,s,a).unproject(i);var l=t[n];if(void 0!==l)for(var c=e.getAttribute("position"),u=0,h=l.length;u<h;u++)c.setXYZ(l[u],o.x,o.y,o.z)}return function(){e=this.geometry,t=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),n("c",0,0,-1),n("t",0,0,1),n("n1",-1,-1,-1),n("n2",1,-1,-1),n("n3",-1,1,-1),n("n4",1,1,-1),n("f1",-1,-1,1),n("f2",1,-1,1),n("f3",-1,1,1),n("f4",1,1,1),n("u1",.7,1.1,-1),n("u2",-.7,1.1,-1),n("u3",0,2,-1),n("cf1",-1,0,1),n("cf2",1,0,1),n("cf3",0,-1,1),n("cf4",0,1,1),n("cn1",-1,0,-1),n("cn2",1,0,-1),n("cn3",0,-1,-1),n("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Oa.prototype=Object.create(En.prototype),Oa.prototype.constructor=Oa,Oa.prototype.update=function(){var e=new Bo;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var o=e.min,i=e.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=o.x,r[4]=i.y,r[5]=i.z,r[6]=o.x,r[7]=o.y,r[8]=i.z,r[9]=i.x,r[10]=o.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=o.z,r[15]=o.x,r[16]=i.y,r[17]=o.z,r[18]=o.x,r[19]=o.y,r[20]=o.z,r[21]=i.x,r[22]=o.y,r[23]=o.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Oa.prototype.setFromObject=function(e){return this.object=e,this.update(),this},ka.prototype=Object.create(En.prototype),ka.prototype.constructor=ka,ka.prototype.onBeforeRender=function(){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5))},Ba.prototype=Object.create(vn.prototype),Ba.prototype.constructor=Ba,Ba.prototype.onBeforeRender=function(){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),this.updateMatrixWorld()},Pa.prototype=Object.create(qo.prototype),Pa.prototype.constructor=Pa,Pa.prototype.setDirection=(Qs=new At,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Qs.set(e.z,0,-e.x).normalize(),Ks=Math.acos(e.y),this.quaternion.setFromAxisAngle(Qs,Ks))}),Pa.prototype.setLength=function(e,t,o){void 0===t&&(t=.2*e),void 0===o&&(o=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(o,t,o),this.cone.position.y=e,this.cone.updateMatrix()},Pa.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Ua.prototype=Object.create(En.prototype),Ua.prototype.constructor=Ua;var Ha=new At,ja=new Fa,za=new Fa,Va=new Fa;function Ga(e){_s.call(this),e.length<2&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=e||[],this.closed=!1}function Wa(e,t,o,i){_s.call(this),this.v0=e,this.v1=t,this.v2=o,this.v3=i}function Ya(e,t,o){_s.call(this),this.v0=e,this.v1=t,this.v2=o}function Xa(e,t){_s.call(this),this.v1=e,this.v2=t}function Ka(e,t,o,i,n,r){Ms.call(this,e,t,o,o,i,n,r)}Ga.prototype=Object.create(_s.prototype),Ga.prototype.constructor=Ga,Ga.prototype.getPoint=function(e){var t,o,i,n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e,l=Math.floor(a),c=a-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r.length)+1)*r.length:0===c&&l===s-1&&(l=s-2,c=1),this.closed||l>0?t=r[(l-1)%s]:(Ha.subVectors(r[0],r[1]).add(r[0]),t=Ha),o=r[l%s],i=r[(l+1)%s],this.closed||l+2<s?n=r[(l+2)%s]:(Ha.subVectors(r[s-1],r[s-2]).add(r[s-1]),n=Ha),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var u="chordal"===this.type?.5:.25,h=Math.pow(t.distanceToSquared(o),u),g=Math.pow(o.distanceToSquared(i),u),d=Math.pow(i.distanceToSquared(n),u);g<1e-4&&(g=1),h<1e-4&&(h=g),d<1e-4&&(d=g),ja.initNonuniformCatmullRom(t.x,o.x,i.x,n.x,h,g,d),za.initNonuniformCatmullRom(t.y,o.y,i.y,n.y,h,g,d),Va.initNonuniformCatmullRom(t.z,o.z,i.z,n.z,h,g,d)}else if("catmullrom"===this.type){var p=void 0!==this.tension?this.tension:.5;ja.initCatmullRom(t.x,o.x,i.x,n.x,p),za.initCatmullRom(t.y,o.y,i.y,n.y,p),Va.initCatmullRom(t.z,o.z,i.z,n.z,p)}return new At(ja.calc(c),za.calc(c),Va.calc(c))},Wa.prototype=Object.create(_s.prototype),Wa.prototype.constructor=Wa,Wa.prototype.getPoint=function(e){var t=this.v0,o=this.v1,i=this.v2,n=this.v3;return new At(Es(e,t.x,o.x,i.x,n.x),Es(e,t.y,o.y,i.y,n.y),Es(e,t.z,o.z,i.z,n.z))},Ya.prototype=Object.create(_s.prototype),Ya.prototype.constructor=Ya,Ya.prototype.getPoint=function(e){var t=this.v0,o=this.v1,i=this.v2;return new At(vs(e,t.x,o.x,i.x),vs(e,t.y,o.y,i.y),vs(e,t.z,o.z,i.z))},Xa.prototype=Object.create(_s.prototype),Xa.prototype.constructor=Xa,Xa.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=new At;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t},Ka.prototype=Object.create(Ms.prototype),Ka.prototype.constructor=Ka;var Qa={createMultiMaterialObject:function(e,t){for(var o=new Mn,i=0,n=t.length;i<n;i++)o.add(new Oi(e,t[i]));return o},detach:function(e,t,o){e.applyMatrix(t.matrixWorld),t.remove(e),o.add(e)},attach:function(e,t,o){e.applyMatrix((new St).getInverse(o.matrixWorld)),t.remove(e),o.add(e)}};function qa(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ga.call(this,e),this.type="catmullrom",this.closed=!0}function Ja(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ga.call(this,e),this.type="catmullrom"}function $a(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ga.call(this,e),this.type="catmullrom"}_s.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(_s.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},qa.prototype=Object.create(Ga.prototype),Ja.prototype=Object.create(Ga.prototype),$a.prototype=Object.create(Ga.prototype),Object.assign($a.prototype,{initFromArray:function(e){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(e){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(e){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),La.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Sa.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(_o.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Bo.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Di.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ut.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(Uo.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e,t,o){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,o){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(St.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new At),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e,t,o){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,o){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,o,i,n,r){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,o,n,r)}}),Fo.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Mt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Ri.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Is.prototype,{extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Xn(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ir(this,e)}}),Object.assign(ht.prototype,{fromAttribute:function(e,t,o){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,o)}}),Object.assign(At.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,o){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,o)}}),Object.assign(_t.prototype,{fromAttribute:function(e,t,o){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,o)}}),gi.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(qo.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(qo.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(dn.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(pn.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(_s.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Zo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Dr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(di.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Si.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,o){void 0!==o&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Si.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(ua.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Do.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fo}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(yr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(xo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(sn.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(sn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(jo.prototype,{cullFace:{get:function(){return this.renderReverseSided?h:u},set:function(e){var t=e!==u;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(Tt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),ta.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this,o=new Js;return o.load(e,function(e){t.setBuffer(e)}),this},ia.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Zs.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Za={merge:function(e,t,o){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,o)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},el={crossOrigin:void 0,loadTexture:function(e,t,o,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new Rr;n.setCrossOrigin(this.crossOrigin);var r=n.load(e,o,void 0,i);return t&&(r.mapping=t),r},loadTextureCube:function(e,t,o,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new Ir;n.setCrossOrigin(this.crossOrigin);var r=n.load(e,o,void 0,i);return t&&(r.mapping=t),r},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};e.WebGLRenderTargetCube=bt,e.WebGLRenderTarget=Tt,e.WebGLRenderer=sn,e.ShaderLib=Eo,e.UniformsLib=mo,e.UniformsUtils=yo,e.ShaderChunk=vo,e.FogExp2=an,e.Fog=ln,e.Scene=cn,e.LensFlare=un,e.Sprite=gn,e.LOD=dn,e.SkinnedMesh=mn,e.Skeleton=pn,e.Bone=fn,e.Mesh=Oi,e.LineSegments=En,e.LineLoop=_n,e.Line=vn,e.Points=bn,e.Group=Mn,e.VideoTexture=An,e.DataTexture=wt,e.CompressedTexture=Sn,e.CubeTexture=Ct,e.CanvasTexture=bo,e.DepthTexture=wn,e.Texture=Et,e.CompressedTextureLoader=Cr,e.DataTextureLoader=Nr,e.CubeTextureLoader=Ir,e.TextureLoader=Rr,e.ObjectLoader=ds,e.MaterialLoader=ns,e.BufferGeometryLoader=rs,e.DefaultLoadingManager=Sr,e.LoadingManager=Ar,e.JSONLoader=gs,e.ImageLoader=Lr,e.FontLoader=xs,e.FileLoader=wr,e.Loader=hs,e.Cache=Mr,e.AudioLoader=Js,e.SpotLightShadow=kr,e.SpotLight=Br,e.PointLight=Pr,e.RectAreaLight=jr,e.HemisphereLight=xr,e.DirectionalLightShadow=Ur,e.DirectionalLight=Fr,e.AmbientLight=Hr,e.LightShadow=Or,e.Light=Dr,e.StereoCamera=$s,e.PerspectiveCamera=Zo,e.OrthographicCamera=$o,e.CubeCamera=Zs,e.ArrayCamera=nn,e.Camera=Jo,e.AudioListener=ea,e.PositionalAudio=oa,e.AudioContext=qs,e.AudioAnalyser=ia,e.Audio=ta,e.VectorKeyframeTrack=Qr,e.StringKeyframeTrack=Zr,e.QuaternionKeyframeTrack=Jr,e.NumberKeyframeTrack=$r,e.ColorKeyframeTrack=ts,e.BooleanKeyframeTrack=es,e.PropertyMixer=na,e.PropertyBinding=sa,e.KeyframeTrack=os,e.AnimationUtils=Vr,e.AnimationObjectGroup=aa,e.AnimationMixer=ca,e.AnimationClip=is,e.Uniform=ua,e.InstancedBufferGeometry=ha,e.BufferGeometry=Si,e.GeometryIdCount=hi,e.Geometry=gi,e.InterleavedBufferAttribute=ga,e.InstancedInterleavedBuffer=pa,e.InterleavedBuffer=da,e.InstancedBufferAttribute=fa,e.Face3=ei,e.Object3D=qo,e.Raycaster=ma,e.Layers=Go,e.EventDispatcher=t,e.Clock=Ea,e.QuaternionLinearInterpolant=qr,e.LinearInterpolant=Yr,e.DiscreteInterpolant=Xr,e.CubicInterpolant=Wr,e.Interpolant=Gr,e.Triangle=xi,e.Math=ut,e.Spherical=_a,e.Cylindrical=Ta,e.Plane=Fo,e.Frustum=Ho,e.Sphere=Po,e.Ray=Ri,e.Matrix4=St,e.Matrix3=Uo,e.Box3=Bo,e.Box2=_o,e.Line3=Di,e.Euler=Vo,e.Vector4=_t,e.Vector3=At,e.Vector2=ht,e.Quaternion=Mt,e.Color=fo,e.ImmediateRenderObject=ba,e.VertexNormalsHelper=Ma,e.SpotLightHelper=Aa,e.SkeletonHelper=Sa,e.PointLightHelper=wa,e.RectAreaLightHelper=Ca,e.HemisphereLightHelper=Na,e.GridHelper=La,e.PolarGridHelper=Ia,e.FaceNormalsHelper=Ra,e.DirectionalLightHelper=Da,e.CameraHelper=xa,e.BoxHelper=Oa,e.Box3Helper=ka,e.PlaneHelper=Ba,e.ArrowHelper=Pa,e.AxisHelper=Ua,e.CatmullRomCurve3=Ga,e.CubicBezierCurve3=Wa,e.QuadraticBezierCurve3=Ya,e.LineCurve3=Xa,e.ArcCurve=Ka,e.EllipseCurve=Ms,e.SplineCurve=As,e.CubicBezierCurve=Ss,e.QuadraticBezierCurve=ws,e.LineCurve=Ts,e.Shape=Is,e.Path=Ls,e.ShapePath=Rs,e.Font=Ds,e.CurvePath=bs,e.Curve=_s,e.ShapeUtils=Yn,e.SceneUtils=Qa,e.WebGLUtils=rn,e.WireframeGeometry=Cn,e.ParametricGeometry=Nn,e.ParametricBufferGeometry=Ln,e.TetrahedronGeometry=Dn,e.TetrahedronBufferGeometry=xn,e.OctahedronGeometry=On,e.OctahedronBufferGeometry=kn,e.IcosahedronGeometry=Bn,e.IcosahedronBufferGeometry=Pn,e.DodecahedronGeometry=Un,e.DodecahedronBufferGeometry=Fn,e.PolyhedronGeometry=In,e.PolyhedronBufferGeometry=Rn,e.TubeGeometry=Hn,e.TubeBufferGeometry=jn,e.TorusKnotGeometry=zn,e.TorusKnotBufferGeometry=Vn,e.TorusGeometry=Gn,e.TorusBufferGeometry=Wn,e.TextGeometry=Qn,e.TextBufferGeometry=qn,e.SphereGeometry=Jn,e.SphereBufferGeometry=$n,e.RingGeometry=Zn,e.RingBufferGeometry=er,e.PlaneGeometry=Ni,e.PlaneBufferGeometry=Li,e.LatheGeometry=tr,e.LatheBufferGeometry=or,e.ShapeGeometry=ir,e.ShapeBufferGeometry=nr,e.ExtrudeGeometry=Xn,e.ExtrudeBufferGeometry=Kn,e.EdgesGeometry=rr,e.ConeGeometry=lr,e.ConeBufferGeometry=cr,e.CylinderGeometry=sr,e.CylinderBufferGeometry=ar,e.CircleGeometry=ur,e.CircleBufferGeometry=hr,e.BoxGeometry=wi,e.BoxBufferGeometry=Ci,e.ShadowMaterial=dr,e.SpriteMaterial=hn,e.RawShaderMaterial=pr,e.ShaderMaterial=xo,e.PointsMaterial=Tn,e.MeshPhysicalMaterial=mr,e.MeshStandardMaterial=fr,e.MeshPhongMaterial=yr,e.MeshToonMaterial=vr,e.MeshNormalMaterial=Er,e.MeshLambertMaterial=_r,e.MeshDepthMaterial=Oo,e.MeshDistanceMaterial=ko,e.MeshBasicMaterial=Ii,e.LineDashedMaterial=Tr,e.LineBasicMaterial=yn,e.Material=Do,e.Float64BufferAttribute=bi,e.Float32BufferAttribute=Ti,e.Uint32BufferAttribute=_i,e.Int32BufferAttribute=Ei,e.Uint16BufferAttribute=vi,e.Int16BufferAttribute=yi,e.Uint8ClampedBufferAttribute=mi,e.Uint8BufferAttribute=fi,e.Int8BufferAttribute=pi,e.BufferAttribute=di,e.REVISION=l,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=c,e.CullFaceBack=u,e.CullFaceFront=h,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=g,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=d,e.PCFSoftShadowMap=p,e.FrontSide=f,e.BackSide=m,e.DoubleSide=y,e.FlatShading=1,e.SmoothShading=2,e.NoColors=v,e.FaceColors=E,e.VertexColors=_,e.NoBlending=T,e.NormalBlending=b,e.AdditiveBlending=M,e.SubtractiveBlending=A,e.MultiplyBlending=S,e.CustomBlending=w,e.AddEquation=C,e.SubtractEquation=N,e.ReverseSubtractEquation=L,e.MinEquation=I,e.MaxEquation=R,e.ZeroFactor=D,e.OneFactor=x,e.SrcColorFactor=O,e.OneMinusSrcColorFactor=k,e.SrcAlphaFactor=B,e.OneMinusSrcAlphaFactor=P,e.DstAlphaFactor=U,e.OneMinusDstAlphaFactor=F,e.DstColorFactor=H,e.OneMinusDstColorFactor=j,e.SrcAlphaSaturateFactor=z,e.NeverDepth=V,e.AlwaysDepth=G,e.LessDepth=W,e.LessEqualDepth=Y,e.EqualDepth=X,e.GreaterEqualDepth=K,e.GreaterDepth=Q,e.NotEqualDepth=q,e.MultiplyOperation=J,e.MixOperation=$,e.AddOperation=Z,e.NoToneMapping=ee,e.LinearToneMapping=te,e.ReinhardToneMapping=oe,e.Uncharted2ToneMapping=ie,e.CineonToneMapping=ne,e.UVMapping=300,e.CubeReflectionMapping=re,e.CubeRefractionMapping=se,e.EquirectangularReflectionMapping=ae,e.EquirectangularRefractionMapping=le,e.SphericalReflectionMapping=ce,e.CubeUVReflectionMapping=ue,e.CubeUVRefractionMapping=he,e.RepeatWrapping=ge,e.ClampToEdgeWrapping=de,e.MirroredRepeatWrapping=pe,e.NearestFilter=fe,e.NearestMipMapNearestFilter=me,e.NearestMipMapLinearFilter=ye,e.LinearFilter=ve,e.LinearMipMapNearestFilter=Ee,e.LinearMipMapLinearFilter=_e,e.UnsignedByteType=Te,e.ByteType=be,e.ShortType=Me,e.UnsignedShortType=Ae,e.IntType=Se,e.UnsignedIntType=we,e.FloatType=Ce,e.HalfFloatType=Ne,e.UnsignedShort4444Type=Le,e.UnsignedShort5551Type=Ie,e.UnsignedShort565Type=Re,e.UnsignedInt248Type=De,e.AlphaFormat=xe,e.RGBFormat=Oe,e.RGBAFormat=ke,e.LuminanceFormat=Be,e.LuminanceAlphaFormat=Pe,e.RGBEFormat=Ue,e.DepthFormat=Fe,e.DepthStencilFormat=He,e.RGB_S3TC_DXT1_Format=je,e.RGBA_S3TC_DXT1_Format=ze,e.RGBA_S3TC_DXT3_Format=Ve,e.RGBA_S3TC_DXT5_Format=Ge,e.RGB_PVRTC_4BPPV1_Format=We,e.RGB_PVRTC_2BPPV1_Format=Ye,e.RGBA_PVRTC_4BPPV1_Format=Xe,e.RGBA_PVRTC_2BPPV1_Format=Ke,e.RGB_ETC1_Format=Qe,e.LoopOnce=2200,e.LoopRepeat=qe,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=Je,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=$e,e.TriangleStripDrawMode=Ze,e.TriangleFanDrawMode=et,e.LinearEncoding=tt,e.sRGBEncoding=ot,e.GammaEncoding=it,e.RGBEEncoding=nt,e.LogLuvEncoding=3003,e.RGBM7Encoding=rt,e.RGBM16Encoding=st,e.RGBDEncoding=at,e.BasicDepthPacking=lt,e.RGBADepthPacking=ct,e.CubeGeometry=wi,e.Face4=function(e,t,o,i,n,r,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ei(e,t,o,n,r,s)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new bn(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new gn(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new bn(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Tn(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Tn(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Tn(e)},e.Vertex=function(e,t,o){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new At(e,t,o)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new di(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new pi(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new fi(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new mi(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new yi(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new vi(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ei(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new _i(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ti(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new bi(e,t)},e.ClosedSplineCurve3=qa,e.SplineCurve3=Ja,e.Spline=$a,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Oa(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new En(new rr(e.geometry),new yn({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new En(new Cn(e.geometry),new yn({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new wr(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Nr(e)},e.GeometryUtils=Za,e.ImageUtils=el,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof o&&void 0!==t?o:i.THREE=i.THREE||{})},{}],42:[function(e,t,o){THREE.ColladaLoader=function(){var e,t,o,i,n,r,s,a,l,c,u=null,h=null,g=null,d={},p={},f={},m={},y={},v={},E={},_={},T={},b={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},M=1,A="Y",S=null;function w(c,d,w){if(u=(new DOMParser).parseFromString(c,"text/xml"),d=d||g,void 0!==w){var N=w.split("/");N.pop(),s=(N.length<1?".":N.join("/"))+"/"}!function(){var e=u.querySelectorAll("asset")[0];if(e&&e.childNodes)for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"unit":var i=o.getAttribute("meter");i&&(M=parseFloat(i));break;case"up_axis":A=o.textContent.charAt(0)}}}(),function(){if(!0!==b.convertUpAxis||A===b.upAxis)S=null;else switch(A){case"X":S="Y"===b.upAxis?"XtoY":"XtoZ";break;case"Y":S="X"===b.upAxis?"YtoX":"YtoZ";break;case"Z":S="X"===b.upAxis?"ZtoX":"ZtoY"}}(),p=C("library_images image",P,"image"),v=C("library_materials material",ie,"material"),E=C("library_effects effect",le,"effect"),y=C("library_geometries geometry",X,"geometry"),_=C("library_cameras camera",pe,"camera"),T=C("library_lights light",me,"light"),m=C("library_controllers controller",U,"controller"),f=C("library_animations animation",ue,"animation"),n=C("library_visual_scenes visual_scene",j,"visual_scene"),r=C("library_kinematics_models kinematics_model",ve,"kinematics_model"),a=[],l=[],e=function(){var e=u.querySelectorAll("scene instance_visual_scene")[0];if(e){var t=e.getAttribute("url").replace(/^#/,"");return n[t.length>0?t:"visual_scene0"]}return null}(),h=new THREE.Group;for(var L=0;L<e.nodes.length;L++)h.add(D(e.nodes[L]));h.scale.multiplyScalar(M),o=[],function t(i){var n=e.getChildById(i.colladaId,!0),r=null;if(n&&n.keys){r={fps:60,hierarchy:[{node:n,keys:n.keys,sids:n.sids}],node:i,name:"animation_"+i.name,length:0},o.push(r);for(var s=0,a=n.keys.length;s<a;s++)r.length=Math.max(r.length,n.keys[s].time)}else r={hierarchy:[{keys:[],sids:[]}]};for(var s=0,a=i.children.length;s<a;s++)for(var l=t(i.children[s]),c=0,u=l.hierarchy.length;c<u;c++)r.hierarchy.push({keys:[],sids:[]});return r}(h),t=function(){var e=u.querySelectorAll("instance_kinematics_model")[0];if(e){var t=e.getAttribute("url").replace(/^#/,"");return r[t.length>0?t:"kinematics_model0"]}return null}(),function(){if(t&&0===t.joints.length)i=void 0;else{var o={},n=function(i,n){var r=n.getAttribute("id"),s=e.getChildById(r,!0),a=t.joints[i];h.traverse(function(e){e.colladaId==r&&(o[i]={node:e,transforms:s.transforms,joint:a,position:a.zeroPosition})})};i={joints:t&&t.joints,getJointValue:function(e){var t=o[e];if(t)return t.position;console.log("getJointValue: joint "+e+" doesn't exist")},setJointValue:function(e,t){var i=o[e];if(i){var n=i.joint;if(t>n.limits.max||t<n.limits.min)console.log("setJointValue: joint "+e+" value "+t+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+")");else if(n.static)console.log("setJointValue: joint "+e+" is static");else{var r=i.node,a=n.axis,l=i.transforms,c=new THREE.Matrix4,u=new THREE.Matrix4;for(s=0;s<l.length;s++){var h=l[s];if(h.sid&&-1!==h.sid.indexOf("joint"+e))switch(n.type){case"revolute":c.multiply(u.makeRotationAxis(a,THREE.Math.degToRad(t)));break;case"prismatic":c.multiply(u.makeTranslation(a.x*t,a.y*t,a.z*t));break;default:console.warn("setJointValue: unknown joint type: "+n.type)}else switch(h.type){case"matrix":c.multiply(h.obj);break;case"translate":c.multiply(u.makeTranslation(h.obj.x,h.obj.y,h.obj.z));break;case"rotate":c.multiply(u.makeRotationAxis(h.obj,h.angle))}}var g=c.elements,d=Array.prototype.slice.call(g),p=[d[0],d[4],d[8],d[12],d[1],d[5],d[9],d[13],d[2],d[6],d[10],d[14],d[3],d[7],d[11],d[15]];r.matrix.set.apply(r.matrix,p),r.matrix.decompose(r.position,r.quaternion,r.scale),o[e].position=t}}else console.log("setJointValue: joint "+e+" doesn't exist")}};var r=u.querySelector("scene instance_kinematics_scene");if(r)for(var s=0;s<r.childNodes.length;s++){var a=r.childNodes[s];if(1==a.nodeType)switch(a.nodeName){case"bind_joint_axis":var l=a.getAttribute("target").split("/").pop(),c=a.querySelector("axis param").textContent,g=parseInt(c.split("joint").pop().split(".")[0]),d=u.querySelector('[sid="'+l+'"]');if(d){var p=d.parentElement;n(g,p)}}}}}();var I={scene:h,morphs:a,skins:l,animations:o,kinematics:i,dae:{images:p,materials:v,cameras:_,lights:T,effects:E,geometries:y,controllers:m,animations:f,visualScenes:n,visualScene:e,scene:e,kinematicsModels:r,kinematicsModel:t}};return d&&d(I),I}function C(e,t,o){for(var i=u.querySelectorAll(e),n={},r=0,s=i.length,a=0;a<s;a++){var l=i[a],c=(new t).parse(l);c.id&&0!==c.id.length||(c.id=o+r++),n[c.id]=c}return n}function N(e,t){var o=t instanceof G?m[t.url]:t;if(o&&o.morph){for(var i=o.morph,n=0;n<i.targets.length;n++){var r=i.targets[n],s=y[r];if(s.mesh&&s.mesh.primitives&&s.mesh.primitives.length){var a=s.mesh.primitives[0].geometry;a.vertices.length===e.vertices.length&&e.morphTargets.push({name:"target_1",vertices:a.vertices})}}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}else console.log("could not find morph controller!")}function L(e,t,o,i){if(e.world=e.world||new THREE.Matrix4,e.localworld=e.localworld||new THREE.Matrix4,e.world.copy(e.matrix),e.localworld.copy(e.matrix),e.channels&&e.channels.length){var n=e.channels[0],r=n.sampler.output[o];r instanceof THREE.Matrix4&&(e.world.copy(r),e.localworld.copy(r),0===o&&e.matrix.copy(r))}i&&e.world.multiplyMatrices(i,e.world),t.push(e);for(var s=0;s<e.nodes.length;s++)L(e.nodes[s],t,o,e.world)}function I(e,t){for(var o=0;o<e.length;o++){var i=e[o],n=-1;if("JOINT"==i.type){for(var r=0;r<t.joints.length;r++)if(i.sid===t.joints[r]){n=r;break}if(n>=0){var s=t.invBindMatrices[n];i.invBindMatrix=s,i.skinningMatrix=new THREE.Matrix4,i.skinningMatrix.multiplyMatrices(i.world,s),i.animatrix=new THREE.Matrix4,i.animatrix.copy(i.localworld),i.weights=[];for(var r=0;r<t.weights.length;r++)for(var a=0;a<t.weights[r].length;a++){var l=t.weights[r][a];l.joint===n&&i.weights.push(l)}}else console.warn("ColladaLoader: Could not find joint '"+i.sid+"'."),i.skinningMatrix=new THREE.Matrix4,i.weights=[]}}}function R(t,o,i){void 0===i&&(i=40);var n=m[o.url];if(n&&n.skin)if(o.skeleton&&o.skeleton.length){for(var r=function(){var e,t=1e6,o=-t,i=0;for(var n in f){var r=f[n];e=e||r.id;for(var s=0;s<r.sampler.length;s++){var a=r.sampler[s];a.create(),t=Math.min(t,a.startTime),o=Math.max(o,a.endTime),i=Math.max(i,a.input.length)}}return{start:t,end:o,frames:i,ID:e}}(),s=e.getChildById(o.skeleton[0],!0)||e.getChildBySid(o.skeleton[0],!0),a=function(e){var t=[],o=function(e,t,i){var n={};n.name=t.sid,n.parent=e,n.matrix=t.matrix;var r=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];for(var s in n.matrix.decompose(r[0],r[1],r[2]),n.pos=[r[0].x,r[0].y,r[0].z],n.scl=[r[2].x,r[2].y,r[2].z],n.rotq=[r[1].x,r[1].y,r[1].z,r[1].w],i.push(n),t.nodes)o(t.sid,t.nodes[s],i)};return o(-1,e,t),t}(s),l=n.skin.joints,c=[],u=0;u<l.length;u++)for(var h=0;h<a.length;h++)a[h].name===l[u]&&(c[u]=a[h]);for(var u=0;u<c.length;u++)for(var h=0;h<c.length;h++)c[u].parent===c[h].name&&(c[u].parent=h);for(new THREE.Vector3,u=0;u<t.vertices.length;u++)t.vertices[u].applyMatrix4(n.skin.bindShapeMatrix);for(var g=[],d=[],p=n.skin.weights,u=0;u<p.length;u++){var y=new THREE.Vector4(p[u][0]?p[u][0].joint:0,p[u][1]?p[u][1].joint:0,p[u][2]?p[u][2].joint:0,p[u][3]?p[u][3].joint:0),v=new THREE.Vector4(p[u][0]?p[u][0].weight:0,p[u][1]?p[u][1].weight:0,p[u][2]?p[u][2].weight:0,p[u][3]?p[u][3].weight:0);g.push(y),d.push(v)}t.skinIndices=g,t.skinWeights=d,t.bones=c;for(var E={name:r.ID,fps:30,length:r.frames/30,hierarchy:[]},h=0;h<c.length;h++)E.hierarchy.push({parent:c[h].parent,name:c[h].name,keys:[]});for(console.log("ColladaLoader:",r.ID+" has "+c.length+" bones."),function(e,t,o){var i=[];L(t,i,-1),I(i,o.skin);for(var n=new THREE.Vector3,r=[],s=0;s<e.vertices.length;s++)r.push(new THREE.Vector3);for(s=0;s<i.length;s++)if("JOINT"==i[s].type)for(var a=0;a<i[s].weights.length;a++){var l=i[s].weights[a],c=l.index,u=l.weight,h=e.vertices[c],g=r[c];n.x=h.x,n.y=h.y,n.z=h.z,n.applyMatrix4(i[s].skinningMatrix),g.x+=n.x*u,g.y+=n.y*u,g.z+=n.z*u}for(var s=0;s<e.vertices.length;s++)e.vertices[s]=r[s]}(t,s,n),i=0;i<r.frames;i++){var _=[];L(s,_,i),I(_,n.skin);for(var u=0;u<_.length;u++)for(var h=0;h<E.hierarchy.length;h++)if(E.hierarchy[h].name===_[u].sid){var T={};T.time=i/30,T.matrix=_[u].animatrix,0===i&&(_[u].matrix=T.matrix);var b=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];T.matrix.decompose(b[0],b[1],b[2]),T.pos=[b[0].x,b[0].y,b[0].z],T.scl=[b[2].x,b[2].y,b[2].z],T.rot=b[1],E.hierarchy[h].keys.push(T)}t.animation=E}}else console.log("ColladaLoader: Could not find the skeleton for the skin. ");else console.log("ColladaLoader: Could not find skin controller.")}function D(e,t){var o,i,n,r,s=new THREE.Object3D;for(n=0;n<e.controllers.length;n++){var c=m[e.controllers[n].url];switch(c.type){case"skin":if(y[c.skin.source]){var u=new Y;u.url=c.skin.source,u.instance_material=e.controllers[n].instance_material,e.geometries.push(u),o=e.controllers[n]}else if(m[c.skin.source]){var h=m[c.skin.source];if(i=h,h.morph&&y[h.morph.source]){var u=new Y;u.url=h.morph.source,u.instance_material=e.controllers[n].instance_material,e.geometries.push(u)}}break;case"morph":if(y[c.morph.source]){var u=new Y;u.url=c.morph.source,u.instance_material=e.controllers[n].instance_material,e.geometries.push(u),i=e.controllers[n]}console.log("ColladaLoader: Morph-controller partially supported.")}}var g={};for(n=0;n<e.geometries.length;n++){var d,p=e.geometries[n],f=p.instance_material,M=y[p.url],A={},S=[],w=0;if(M){if(!M.mesh||!M.mesh.primitives)continue;if(0===s.name.length&&(s.name=M.id),f)for(r=0;r<f.length;r++){var C=f[r],L=v[C.target],I=L.instance_effect.url,x=E[I].shader,O=x.material;if(M.doubleSided){if(!(C.symbol in g)){var k=O.clone();k.side=THREE.DoubleSide,g[C.symbol]=k}O=g[C.symbol]}O.opacity=O.opacity?O.opacity:1,A[C.symbol]=w,S.push(O),(d=O).name=null===L.name||""===L.name?L.id:L.name,w++}var B,P=d||new THREE.MeshLambertMaterial({color:14540253,side:M.doubleSided?THREE.DoubleSide:THREE.FrontSide}),U=M.mesh.geometry3js;if(w>1)for(P=new THREE.MultiMaterial(S),r=0;r<U.faces.length;r++){var F=U.faces[r];F.materialIndex=A[F.daeMaterial]}void 0!==o?(R(U,o),U.morphTargets.length>0?(P.morphTargets=!0,P.skinning=!1):(P.morphTargets=!1,P.skinning=!0),(B=new THREE.SkinnedMesh(U,P,!1)).name="skin_"+l.length,l.push(B)):void 0!==i?(N(U,i),P.morphTargets=!0,(B=new THREE.Mesh(U,P)).name="morph_"+a.length,a.push(B)):B=!0===U.isLineStrip?new THREE.Line(U):new THREE.Mesh(U,P),s.add(B)}}for(n=0;n<e.cameras.length;n++){var H=e.cameras[n],j=_[H.url],z=new THREE.PerspectiveCamera(j.yfov,parseFloat(j.aspect_ratio),parseFloat(j.znear),parseFloat(j.zfar));s.add(z)}for(n=0;n<e.lights.length;n++){var V=null,G=e.lights[n],W=T[G.url];if(W&&W.technique){var X=W.color.getHex(),K=W.intensity,Q=W.distance,q=W.falloff_angle;switch(W.technique){case"directional":(V=new THREE.DirectionalLight(X,K,Q)).position.set(0,0,1);break;case"point":V=new THREE.PointLight(X,K,Q);break;case"spot":(V=new THREE.SpotLight(X,K,Q,q)).position.set(0,0,1);break;case"ambient":V=new THREE.AmbientLight(X)}}V&&s.add(V)}if(s.name=e.name||e.id||"",s.colladaId=e.id||"",s.layer=e.layer||"",s.matrix=e.matrix,s.matrix.decompose(s.position,s.quaternion,s.scale),b.centerGeometry&&s.geometry){var J=s.geometry.center();J.multiply(s.scale),J.applyQuaternion(s.quaternion),s.position.sub(J)}for(n=0;n<e.nodes.length;n++)s.add(D(e.nodes[n]));return s}function x(e){for(var t=u.querySelectorAll("library_nodes node"),o=0;o<t.length;o++){var i=t[o].attributes.getNamedItem("id");if(i&&i.value===e)return t[o]}}function O(e,t){for(var o=null,i=0,n=e.length;i<n&&null===o;i++){var r=e[i];if(r.time===t)o=r;else if(r.time>t)break}return o}function k(e,t){for(var o=-1,i=0,n=e.length;i<n&&-1===o;i++){var r=e[i];r.time>=t&&(o=i)}return o}function B(e,t,o,i){var n=function(e,t,o){for(o=o>=0?o:o+e.length;o>=0;o--){var i=e[o];if(i.hasTarget(t))return i}return null}(e,i,o?o-1:0),r=function(e,t,o){for(;o<e.length;o++){var i=e[o];if(i.hasTarget(t))return i}return null}(e,i,o+1);if(n&&r){var s,a=(t.time-n.time)/(r.time-n.time),l=n.getTarget(i),c=r.getTarget(i).data,u=l.data;if("matrix"===l.type)s=u;else if(u.length){s=[];for(var h=0;h<u.length;++h)s[h]=u[h]+(c[h]-u[h])*a}else s=u+(c-u)*a;t.addTarget(i,l.transform,l.member,s)}}function P(){this.id="",this.init_from=""}function U(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function F(){this.method=null,this.source=null,this.targets=null,this.weights=null}function H(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function j(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Group}function z(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function V(){this.sid="",this.type="",this.data=[],this.obj=null}function G(){this.url="",this.skeleton=[],this.instance_material=[]}function W(){this.symbol="",this.target=""}function Y(){this.url="",this.instance_material=[]}function X(){this.id="",this.mesh=null}function K(e){this.geometry=e.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function Q(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function q(){Q.call(this),this.vcount=[]}function J(){Q.call(this),this.vcount=1}function $(){Q.call(this),this.vcount=3}function Z(){this.source="",this.count=0,this.stride=0,this.params=[]}function ee(){this.input={}}function te(){this.semantic="",this.offset=0,this.source="",this.set=0}function oe(e){this.id=e,this.type=null}function ie(){this.id="",this.name="",this.instance_effect=null}function ne(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function re(e,t){this.type=e,this.effect=t,this.material=null}function se(e){this.effect=e,this.init_from=null,this.format=null}function ae(e){this.effect=e,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function le(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function ce(){this.url=""}function ue(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function he(e){this.animation=e,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function ge(e){this.id="",this.animation=e,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function de(e){this.targets=[],this.time=e}function pe(){this.id="",this.name="",this.technique=""}function fe(){this.url=""}function me(){this.id="",this.name="",this.technique=""}function ye(){this.url=""}function ve(){this.id="",this.name="",this.joints=[],this.links=[]}function Ee(){this.sid="",this.name="",this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}function _e(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}function Te(){this.joint="",this.transforms=[],this.links=[]}function be(e){var t=e.getAttribute("id");return void 0!=d[t]?d[t]:(d[t]=new oe(t).parse(e),d[t])}function Me(e){for(var t=we(e),o=[],i=0,n=t.length;i<n;i++)o.push("true"===t[i]||"1"===t[i]);return o}function Ae(e){for(var t=we(e),o=[],i=0,n=t.length;i<n;i++)o.push(parseFloat(t[i]));return o}function Se(e){for(var t=we(e),o=[],i=0,n=t.length;i<n;i++)o.push(parseInt(t[i],10));return o}function we(e){return e.length>0?function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}(e).split(/\s+/):[]}function Ce(e,t,o){return e.hasAttribute(t)?parseInt(e.getAttribute(t),10):o}function Ne(e,t){var o=new THREE.ImageLoader;o.load(t,function(t){e.image=t,e.needsUpdate=!0})}function Le(e,t){e.doubleSided=!1;var o=t.querySelectorAll("extra double_sided")[0];o&&o&&1===parseInt(o.textContent,10)&&(e.doubleSided=!0)}function Ie(e,t){if(!0===b.convertUpAxis&&A!==b.upAxis)switch(S){case"XtoY":var o=e[0];e[0]=t*e[1],e[1]=o;break;case"XtoZ":var o=e[2];e[2]=e[1],e[1]=e[0],e[0]=o;break;case"YtoX":var o=e[0];e[0]=e[1],e[1]=t*o;break;case"YtoZ":var o=e[1];e[1]=t*e[2],e[2]=o;break;case"ZtoX":var o=e[0];e[0]=e[1],e[1]=e[2],e[2]=o;break;case"ZtoY":var o=e[1];e[1]=e[2],e[2]=t*o}}function Re(e,t){var o=[e[t],e[t+1],e[t+2]];return Ie(o,-1),new THREE.Vector3(o[0],o[1],o[2])}function De(e){if(b.convertUpAxis){var t=[e[0],e[4],e[8]];Ie(t,-1),e[0]=t[0],e[4]=t[1],e[8]=t[2],Ie(t=[e[1],e[5],e[9]],-1),e[1]=t[0],e[5]=t[1],e[9]=t[2],Ie(t=[e[2],e[6],e[10]],-1),e[2]=t[0],e[6]=t[1],e[10]=t[2],Ie(t=[e[0],e[1],e[2]],-1),e[0]=t[0],e[1]=t[1],e[2]=t[2],Ie(t=[e[4],e[5],e[6]],-1),e[4]=t[0],e[5]=t[1],e[6]=t[2],Ie(t=[e[8],e[9],e[10]],-1),e[8]=t[0],e[9]=t[1],e[10]=t[2],Ie(t=[e[3],e[7],e[11]],-1),e[3]=t[0],e[7]=t[1],e[11]=t[2]}return(new THREE.Matrix4).set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xe(e){return e>-1&&e<3&&(e={X:0,Y:1,Z:2}[e=Oe(["X","Y","Z"][e])]),e}function Oe(e){if(b.convertUpAxis)switch(e){case"X":switch(S){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z"}break;case"Y":switch(S){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z"}break;case"Z":switch(S){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y"}}return e}return P.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];"init_from"===o.nodeName&&(this.init_from=o.textContent)}return this},U.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.type="none";for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"skin":this.skin=(new H).parse(o),this.type=o.nodeName;break;case"morph":this.morph=(new F).parse(o),this.type=o.nodeName}}return this},F.prototype.parse=function(e){var t,o={},i=[];for(this.method=e.getAttribute("method"),this.source=e.getAttribute("source").replace(/^#/,""),t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(1==n.nodeType)switch(n.nodeName){case"source":var r=(new oe).parse(n);o[r.id]=r;break;case"targets":i=this.parseInputs(n);break;default:console.log(n.nodeName)}}for(t=0;t<i.length;t++){var s=i[t],r=o[s.source];switch(s.semantic){case"MORPH_TARGET":this.targets=r.read();break;case"MORPH_WEIGHT":this.weights=r.read()}}return this},F.prototype.parseInputs=function(e){for(var t=[],o=0;o<e.childNodes.length;o++){var i=e.childNodes[o];if(1==i.nodeType)switch(i.nodeName){case"input":t.push((new te).parse(i))}}return t},H.prototype.parse=function(e){var t,o,i={};this.source=e.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1==r.nodeType)switch(r.nodeName){case"bind_shape_matrix":var s=Ae(r.textContent);this.bindShapeMatrix=De(s);break;case"source":var a=(new oe).parse(r);i[a.id]=a;break;case"joints":t=r;break;case"vertex_weights":o=r;break;default:console.log(r.nodeName)}}return this.parseJoints(t,i),this.parseWeights(o,i),this},H.prototype.parseJoints=function(e,t){for(var o=0;o<e.childNodes.length;o++){var i=e.childNodes[o];if(1==i.nodeType)switch(i.nodeName){case"input":var n=(new te).parse(i),r=t[n.source];"JOINT"===n.semantic?this.joints=r.read():"INV_BIND_MATRIX"===n.semantic&&(this.invBindMatrices=r.read())}}},H.prototype.parseWeights=function(e,t){for(var o,i,n=[],r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"input":n.push((new te).parse(s));break;case"v":o=Se(s.textContent);break;case"vcount":i=Se(s.textContent)}}for(var a=0,r=0;r<i.length;r++){for(var l=i[r],c=[],u=0;u<l;u++){for(var h={},g=0;g<n.length;g++){var d=n[g],p=o[a+d.offset];switch(d.semantic){case"JOINT":h.joint=p;break;case"WEIGHT":h.weight=t[d.source].data[p]}}c.push(h),a+=n.length}for(var u=0;u<c.length;u++)c[u].index=r;this.weights.push(c)}},j.prototype.getChildById=function(e,t){for(var o=0;o<this.nodes.length;o++){var i=this.nodes[o].getChildById(e,t);if(i)return i}return null},j.prototype.getChildBySid=function(e,t){for(var o=0;o<this.nodes.length;o++){var i=this.nodes[o].getChildBySid(e,t);if(i)return i}return null},j.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"node":this.nodes.push((new z).parse(o))}}return this},z.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var o,i=this.channels[t],n=i.target.split("/"),r=(n.shift(),n.shift()),s=r.indexOf(".")>=0,a=r.indexOf("(")>=0;if(s)n=r.split("."),r=n.shift();else if(a){o=r.split("("),r=o.shift();for(var l=0;l<o.length;l++)o[l]=parseInt(o[l].replace(/\)/,""))}if(r===e)return i.info={sid:r,dotSyntax:s,arrSyntax:a,arrIndices:o},i}return null},z.prototype.getChildById=function(e,t){if(this.id===e)return this;if(t)for(var o=0;o<this.nodes.length;o++){var i=this.nodes[o].getChildById(e,t);if(i)return i}return null},z.prototype.getChildBySid=function(e,t){if(this.sid===e)return this;if(t)for(var o=0;o<this.nodes.length;o++){var i=this.nodes[o].getChildBySid(e,t);if(i)return i}return null},z.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++)if(this.transforms[t].sid===e)return this.transforms[t];return null},z.prototype.parse=function(e){this.id=e.getAttribute("id"),this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.type=e.getAttribute("type"),this.layer=e.getAttribute("layer"),this.type="JOINT"===this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"node":this.nodes.push((new z).parse(o));break;case"instance_camera":this.cameras.push((new fe).parse(o));break;case"instance_controller":this.controllers.push((new G).parse(o));break;case"instance_geometry":this.geometries.push((new Y).parse(o));break;case"instance_light":this.lights.push((new ye).parse(o));break;case"instance_node":var i=x(o.getAttribute("url").replace(/^#/,""));i&&this.nodes.push((new z).parse(i));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new V).parse(o));break;case"extra":break;default:console.log(o.nodeName)}}return this.channels=function(e){var t=[],o=1e6,i=-1e6;for(var n in f)for(var r=f[n],s=0;s<r.channel.length;s++){var a=r.channel[s],l=r.sampler[s],n=a.target.split("/")[0];n==e.id&&(l.create(),a.sampler=l,o=Math.min(o,l.startTime),i=Math.max(i,l.endTime),t.push(a))}return t.length&&(e.startTime=o,e.endTime=i),t}(this),function(e){if(e.channels&&e.channels.length){for(var t=[],o=[],i=0,n=e.channels.length;i<n;i++){var r,s=e.channels[i],a=s.fullSid,l=s.sampler,c=l.input,u=e.getTransformBySid(s.sid);if(s.arrIndices){r=[];for(var h=0,g=s.arrIndices.length;h<g;h++)r[h]=xe(s.arrIndices[h])}else r=Oe(s.member);if(u){-1===o.indexOf(a)&&o.push(a);for(var h=0,g=c.length;h<g;h++){var d=c[h],p=l.getData(u.type,h,r),f=O(t,d);if(!f){f=new de(d);var m=k(t,d);t.splice(-1===m?t.length:m,0,f)}f.addTarget(a,u,r,p)}}else console.log('Could not find transform "'+s.sid+'" in node '+e.id)}for(var i=0;i<o.length;i++)for(var y=o[i],h=0;h<t.length;h++){var f=t[h];f.hasTarget(y)||B(t,f,h,y)}e.keys=t,e.sids=o}}(this),this.updateMatrix(),this},z.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(this.matrix)},V.prototype.parse=function(e){return this.sid=e.getAttribute("sid"),this.type=e.nodeName,this.data=Ae(e.textContent),this.convert(),this},V.prototype.convert=function(){switch(this.type){case"matrix":this.obj=De(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":Ie(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":Ie(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},V.prototype.apply=(c=new THREE.Matrix4,function(e){switch(this.type){case"matrix":e.multiply(this.obj);break;case"translate":e.multiply(c.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":e.multiply(c.makeRotationAxis(this.obj,this.angle));break;case"scale":e.scale(this.obj)}}),V.prototype.update=function(e,t){var o=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(t)if(1===t.length)switch(t[0]){case 0:this.obj.n11=e[0],this.obj.n21=e[1],this.obj.n31=e[2],this.obj.n41=e[3];break;case 1:this.obj.n12=e[0],this.obj.n22=e[1],this.obj.n32=e[2],this.obj.n42=e[3];break;case 2:this.obj.n13=e[0],this.obj.n23=e[1],this.obj.n33=e[2],this.obj.n43=e[3];break;case 3:this.obj.n14=e[0],this.obj.n24=e[1],this.obj.n34=e[2],this.obj.n44=e[3]}else if(2===t.length){var i="n"+(t[0]+1)+(t[1]+1);this.obj[i]=e}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(e);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=o[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=o[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2],this.angle=THREE.Math.degToRad(e[3])}}},G.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1===o.nodeType)switch(o.nodeName){case"skeleton":this.skeleton.push(o.textContent.replace(/^#/,""));break;case"bind_material":for(var i=o.querySelectorAll("instance_material"),n=0;n<i.length;n++){var r=i[n];this.instance_material.push((new W).parse(r))}}}return this},W.prototype.parse=function(e){return this.symbol=e.getAttribute("symbol"),this.target=e.getAttribute("target").replace(/^#/,""),this},Y.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType&&"bind_material"===o.nodeName){for(var i=o.querySelectorAll("instance_material"),n=0;n<i.length;n++){var r=i[n];this.instance_material.push((new W).parse(r))}break}}return this},X.prototype.parse=function(e){this.id=e.getAttribute("id"),Le(this,e);for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"mesh":this.mesh=new K(this).parse(o)}}return this},K.prototype.parse=function(e){this.primitives=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"source":be(o);break;case"vertices":this.vertices=(new ee).parse(o);break;case"linestrips":this.primitives.push((new J).parse(o));break;case"triangles":this.primitives.push((new $).parse(o));break;case"polygons":this.primitives.push((new Q).parse(o));break;case"polylist":this.primitives.push((new q).parse(o))}}if(this.geometry3js=new THREE.Geometry,null===this.vertices)return this;for(var i=d[this.vertices.input.POSITION.source].data,t=0;t<i.length;t+=3)this.geometry3js.vertices.push(Re(i,t).clone());for(var t=0;t<this.primitives.length;t++){var n=this.primitives[t];n.setVertices(this.vertices),this.handlePrimitive(n,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},K.prototype.handlePrimitive=function(e,t){if(e instanceof J)t.isLineStrip=!0;else{var o,i,n,r,s,a,l,c,u=e.p,h=e.inputs,g=0,p=0,f=[];for(o=0;o<h.length;o++){var m=(n=h[o]).offset+1;switch(p=p<m?m:p,n.semantic){case"TEXCOORD":f.push(n.set)}}for(var y=0;y<u.length;++y)for(var v=u[y],E=0;E<v.length;){var _=[],T=[],M=null,A=[];for(c=e.vcount?e.vcount.length?e.vcount[g++]:e.vcount:v.length/p,o=0;o<c;o++)for(i=0;i<h.length;i++)switch(n=h[i],a=d[n.source],r=v[E+o*p+n.offset],l=a.accessor.params.length,s=r*l,n.semantic){case"VERTEX":_.push(r);break;case"NORMAL":T.push(Re(a.data,s));break;case"TEXCOORD":void 0===(M=M||{})[n.set]&&(M[n.set]=[]),M[n.set].push(new THREE.Vector2(a.data[s],a.data[s+1]));break;case"COLOR":A.push((new THREE.Color).setRGB(a.data[s],a.data[s+1],a.data[s+2]))}if(0===T.length)if(n=this.vertices.input.NORMAL){a=d[n.source],l=a.accessor.params.length;for(var S=0,w=_.length;S<w;S++)T.push(Re(a.data,_[S]*l))}else t.calcNormals=!0;if(!M&&(M={},n=this.vertices.input.TEXCOORD)){f.push(n.set),a=d[n.source],l=a.accessor.params.length;for(var S=0,w=_.length;S<w;S++)s=_[S]*l,void 0===M[n.set]&&(M[n.set]=[]),M[n.set].push(new THREE.Vector2(a.data[s],1-a.data[s+1]))}if(0===A.length&&(n=this.vertices.input.COLOR)){a=d[n.source],l=a.accessor.params.length;for(var S=0,w=_.length;S<w;S++)s=_[S]*l,A.push((new THREE.Color).setRGB(a.data[s],a.data[s+1],a.data[s+2]))}var C,N,L=null,I=[];if(3===c)I.push(new THREE.Face3(_[0],_[1],_[2],T,A.length?A:new THREE.Color));else if(4===c)I.push(new THREE.Face3(_[0],_[1],_[3],T.length?[T[0].clone(),T[1].clone(),T[3].clone()]:[],A.length?[A[0],A[1],A[3]]:new THREE.Color)),I.push(new THREE.Face3(_[1],_[2],_[3],T.length?[T[1].clone(),T[2].clone(),T[3].clone()]:[],A.length?[A[1],A[2],A[3]]:new THREE.Color));else if(c>4&&b.subdivideFaces){var R=A.length?A:new THREE.Color;for(i=1;i<c-1;)I.push(new THREE.Face3(_[0],_[i],_[i+1],T.length?[T[0].clone(),T[i++].clone(),T[i].clone()]:[],R))}if(I.length)for(var S=0,w=I.length;S<w;S++)for((L=I[S]).daeMaterial=e.material,t.faces.push(L),i=0;i<f.length;i++)C=M[f[i]],N=c>4?[C[0],C[S+1],C[S+2]]:4===c?0===S?[C[0],C[1],C[3]]:[C[1].clone(),C[2],C[3].clone()]:[C[0],C[1],C[2]],void 0===t.faceVertexUvs[i]&&(t.faceVertexUvs[i]=[]),t.faceVertexUvs[i].push(N);else console.log("dropped face with vcount "+c+" for geometry with id: "+t.id);E+=p*c}}},Q.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].source===e.id&&(this.inputs[t].source=e.input.POSITION.source)},Q.prototype.parse=function(e){this.material=e.getAttribute("material"),this.count=Ce(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"input":this.inputs.push((new te).parse(e.childNodes[t]));break;case"vcount":this.vcount=Se(o.textContent);break;case"p":this.p.push(Se(o.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},q.prototype=Object.create(Q.prototype),q.prototype.constructor=q,J.prototype=Object.create(Q.prototype),J.prototype.constructor=J,$.prototype=Object.create(Q.prototype),$.prototype.constructor=$,Z.prototype.parse=function(e){this.params=[],this.source=e.getAttribute("source"),this.count=Ce(e,"count",0),this.stride=Ce(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if("param"===o.nodeName){var i={};i.name=o.getAttribute("name"),i.type=o.getAttribute("type"),this.params.push(i)}}return this},ee.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++)if("input"===e.childNodes[t].nodeName){var o=(new te).parse(e.childNodes[t]);this.input[o.semantic]=o}return this},te.prototype.parse=function(e){return this.semantic=e.getAttribute("semantic"),this.source=e.getAttribute("source").replace(/^#/,""),this.set=Ce(e,"set",-1),this.offset=Ce(e,"offset",0),"TEXCOORD"===this.semantic&&this.set<0&&(this.set=0),this},oe.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"bool_array":this.data=Me(o.textContent),this.type=o.nodeName;break;case"float_array":this.data=Ae(o.textContent),this.type=o.nodeName;break;case"int_array":this.data=Se(o.textContent),this.type=o.nodeName;break;case"IDREF_array":case"Name_array":this.data=we(o.textContent),this.type=o.nodeName;break;case"technique_common":for(var i=0;i<o.childNodes.length;i++)if("accessor"===o.childNodes[i].nodeName){this.accessor=(new Z).parse(o.childNodes[i]);break}}}return this},oe.prototype.read=function(){var e=[],t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var o=0;o<this.data.length;o+=16){var i=this.data.slice(o,o+16),n=De(i);e.push(n)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".")}return e},ie.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++)if("instance_effect"===e.childNodes[t].nodeName){this.instance_effect=(new ce).parse(e.childNodes[t]);break}return this},ne.prototype.isColor=function(){return null===this.texture},ne.prototype.isTexture=function(){return null!=this.texture},ne.prototype.parse=function(e){"transparent"===e.nodeName&&(this.opaque=e.getAttribute("opaque"));for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"color":var i=Ae(o.textContent);this.color=new THREE.Color,this.color.setRGB(i[0],i[1],i[2]),this.color.a=i[3];break;case"texture":this.texture=o.getAttribute("texture"),this.texcoord=o.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(o)}}return this},ne.prototype.parseTexture=function(e){if(!e.childNodes)return this;e.childNodes[1]&&"extra"===e.childNodes[1].nodeName&&(e=e.childNodes[1]).childNodes[1]&&"technique"===e.childNodes[1].nodeName&&(e=e.childNodes[1]);for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[o.nodeName]=parseFloat(o.textContent);break;case"wrapU":case"wrapV":"TRUE"===o.textContent.toUpperCase()?this.texOpts[o.nodeName]=1:this.texOpts[o.nodeName]=parseInt(o.textContent);break;default:this.texOpts[o.nodeName]=o.textContent}}return this},re.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[o.nodeName]=(new ne).parse(o);break;case"bump":var i=o.getAttribute("bumptype");i?"heightfield"===i.toLowerCase()?this.bump=(new ne).parse(o):"normalmap"===i.toLowerCase()?this.normal=(new ne).parse(o):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+i+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new ne).parse(o)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=(new ne).parse(o));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var n=o.querySelectorAll("float");n.length>0&&(this[o.nodeName]=parseFloat(n[0].textContent))}}return this.create(),this},re.prototype.create=function(){var e={},t=!1;if(void 0!==this.transparency&&void 0!==this.transparent){this.transparent;var o=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;o>0&&(t=!0,e.transparent=!0,e.opacity=1-o)}var i={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var n in this)switch(n){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var r=this[n];if(r instanceof ne)if(r.isTexture()){var a=r.texture,l=this.effect.sampler[a];if(void 0!==l&&void 0!==l.source){var c=this.effect.surface[l.source];if(void 0!==c){var u=p[c.init_from];if(u){var h,g=s+u.init_from,d=THREE.Loader.Handlers.get(g);null!==d?h=d.load(g):Ne(h=new THREE.Texture,g),"MIRROR"===l.wrap_s?h.wrapS=THREE.MirroredRepeatWrapping:"WRAP"===l.wrap_s||r.texOpts.wrapU?h.wrapS=THREE.RepeatWrapping:h.wrapS=THREE.ClampToEdgeWrapping,"MIRROR"===l.wrap_t?h.wrapT=THREE.MirroredRepeatWrapping:"WRAP"===l.wrap_t||r.texOpts.wrapV?h.wrapT=THREE.RepeatWrapping:h.wrapT=THREE.ClampToEdgeWrapping,h.offset.x=r.texOpts.offsetU,h.offset.y=r.texOpts.offsetV,h.repeat.x=r.texOpts.repeatU,h.repeat.y=r.texOpts.repeatV,e[i[n]]=h,"emission"===n&&(e.emissive=16777215)}}}}else"diffuse"!==n&&t||("emission"===n?e.emissive=r.color.getHex():e[n]=r.color.getHex());break;case"shininess":e[n]=this[n];break;case"reflectivity":e[n]=this[n],e[n]>0&&(e.envMap=b.defaultEnvMap),e.combine=THREE.MixOperation;break;case"index_of_refraction":e.refractionRatio=this[n],1!==this[n]&&(e.envMap=b.defaultEnvMap)}switch(e.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,void 0!==e.diffuse&&(e.color=e.diffuse,delete e.diffuse),this.type){case"constant":void 0!=e.emissive&&(e.color=e.emissive),this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:this.material=new THREE.MeshLambertMaterial(e)}return this.material},se.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"init_from":this.init_from=o.textContent;break;case"format":this.format=o.textContent;break;default:console.log("unhandled Surface prop: "+o.nodeName)}}return this},ae.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"source":this.source=o.textContent;break;case"minfilter":this.minfilter=o.textContent;break;case"magfilter":this.magfilter=o.textContent;break;case"mipfilter":this.mipfilter=o.textContent;break;case"wrap_s":this.wrap_s=o.textContent;break;case"wrap_t":this.wrap_t=o.textContent;break;default:console.log("unhandled Sampler2D prop: "+o.nodeName)}}return this},le.prototype.create=function(){if(null===this.shader)return null},le.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Le(this,e),this.shader=null;for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(o))}}return this},le.prototype.parseNewparam=function(e){for(var t=e.getAttribute("sid"),o=0;o<e.childNodes.length;o++){var i=e.childNodes[o];if(1==i.nodeType)switch(i.nodeName){case"surface":this.surface[t]=new se(this).parse(i);break;case"sampler2D":this.sampler[t]=new ae(this).parse(i);break;case"extra":break;default:console.log(i.nodeName)}}},le.prototype.parseProfileCOMMON=function(e){for(var t,o=0;o<e.childNodes.length;o++){var i=e.childNodes[o];if(1==i.nodeType)switch(i.nodeName){case"profile_COMMON":this.parseProfileCOMMON(i);break;case"technique":t=i;break;case"newparam":this.parseNewparam(i);break;case"image":var n=(new P).parse(i);p[n.id]=n;break;case"extra":break;default:console.log(i.nodeName)}}return t},le.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new re(o.nodeName,this).parse(o);break;case"extra":this.parseExtra(o)}}},le.prototype.parseExtra=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"technique":this.parseExtraTechnique(o)}}},le.prototype.parseExtraTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"bump":this.shader.parse(e)}}},ce.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},ue.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.source={};for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"animation":var i=(new ue).parse(o);for(var n in i.source)this.source[n]=i.source[n];for(var r=0;r<i.channel.length;r++)this.channel.push(i.channel[r]),this.sampler.push(i.sampler[r]);break;case"source":var n=(new oe).parse(o);this.source[n.id]=n;break;case"sampler":this.sampler.push(new ge(this).parse(o));break;case"channel":this.channel.push(new he(this).parse(o))}}return this},he.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,""),this.target=e.getAttribute("target");var t=this.target.split("/"),o=(t.shift(),t.shift()),i=o.indexOf(".")>=0,n=o.indexOf("(")>=0;if(i)t=o.split("."),this.sid=t.shift(),this.member=t.shift();else if(n){var r=o.split("(");this.sid=r.shift();for(var s=0;s<r.length;s++)r[s]=parseInt(r[s].replace(/\)/,""));this.arrIndices=r}else this.sid=o;return this.fullSid=o,this.dotSyntax=i,this.arrSyntax=n,this},ge.prototype.parse=function(e){this.id=e.getAttribute("id"),this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"input":this.inputs.push((new te).parse(o))}}return this},ge.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],o=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=o.read();break;case"OUTPUT":this.output=o.read(),this.strideOut=o.accessor.stride;break;case"INTERPOLATION":this.interpolation=o.read();break;case"IN_TANGENT":case"OUT_TANGENT":break;default:console.log(t.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(var e=0;e<this.input.length;e++)this.startTime=Math.min(this.startTime,this.input[e]),this.endTime=Math.max(this.endTime,this.input[e]);this.duration=this.endTime-this.startTime}},ge.prototype.getData=function(e,t,o){var i;if("matrix"===e&&16===this.strideOut)i=this.output[t];else if(this.strideOut>1){i=[],t*=this.strideOut;for(var n=0;n<this.strideOut;++n)i[n]=this.output[t+n];if(3===this.strideOut)switch(e){case"rotate":case"translate":Ie(i,-1);break;case"scale":Ie(i,1)}else 4===this.strideOut&&"matrix"===e&&Ie(i,-1)}else i=this.output[t],o&&"translate"===e&&(i=function(e,t){if(!0!==b.convertUpAxis||A===b.upAxis)return t;switch(e){case"X":t="XtoY"===S?-1*t:t;break;case"Y":t="YtoZ"===S||"YtoX"===S?-1*t:t;break;case"Z":t="ZtoY"===S?-1*t:t}return t}(o,i));return i},de.prototype.addTarget=function(e,t,o,i){this.targets.push({sid:e,member:o,transform:t,data:i})},de.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var o=this.targets[t];e&&o.sid!==e||o.transform.update(o.data,o.member)}},de.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return this.targets[t];return null},de.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return!0;return!1},de.prototype.interpolate=function(e,t){for(var o=0,i=this.targets.length;o<i;o++){var n,r=this.targets[o],s=e.getTarget(r.sid);if("matrix"!==r.transform.type&&s){var a=(t-this.time)/(e.time-this.time),l=s.data,c=r.data;if(a<0&&(a=0),a>1&&(a=1),c.length){n=[];for(var u=0;u<c.length;++u)n[u]=c[u]+(l[u]-c[u])*a}else n=c+(l-c)*a}else n=r.data;r.transform.update(n,r.member)}},pe.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"optics":this.parseOptics(o)}}return this},pe.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++)if("technique_common"===e.childNodes[t].nodeName)for(var o=e.childNodes[t],i=0;i<o.childNodes.length;i++)if(this.technique=o.childNodes[i].nodeName,"perspective"===this.technique)for(var n=o.childNodes[i],r=0;r<n.childNodes.length;r++){var s=n.childNodes[r];switch(s.nodeName){case"yfov":this.yfov=s.textContent;break;case"xfov":this.xfov=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}else if("orthographic"===this.technique)for(var a=o.childNodes[i],r=0;r<a.childNodes.length;r++){var s=a.childNodes[r];switch(s.nodeName){case"xmag":this.xmag=s.textContent;break;case"ymag":this.ymag=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}return this},fe.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},me.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"technique_common":this.parseCommon(o);break;case"technique":this.parseTechnique(o)}}return this},me.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++)switch(e.childNodes[t].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=e.childNodes[t].nodeName;for(var o=e.childNodes[t],i=0;i<o.childNodes.length;i++){var n=o.childNodes[i];switch(n.nodeName){case"color":var r=Ae(n.textContent);this.color=new THREE.Color(0),this.color.setRGB(r[0],r[1],r[2]),this.color.a=r[3];break;case"falloff_angle":this.falloff_angle=parseFloat(n.textContent);break;case"quadratic_attenuation":var s=parseFloat(n.textContent);this.distance=s?Math.sqrt(1/s):0}}}return this},me.prototype.parseTechnique=function(e){this.profile=e.getAttribute("profile");for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];switch(o.nodeName){case"intensity":this.intensity=parseFloat(o.textContent)}}return this},ye.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},ve.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.joints=[],this.links=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"technique_common":this.parseCommon(o)}}return this},ve.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(e.childNodes[t].nodeName){case"joint":this.joints.push((new Ee).parse(o));break;case"link":this.links.push((new _e).parse(o))}}return this},Ee.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var t=e.querySelector("axis"),o=Ae(t.textContent);this.axis=Re(o,0);var i=e.querySelector("limits min")?parseFloat(e.querySelector("limits min").textContent):-360,n=e.querySelector("limits max")?parseFloat(e.querySelector("limits max").textContent):360;this.limits={min:i,max:n};for(var r=["prismatic","revolute"],s=0;s<r.length;s++){var a=r[s],l=e.querySelector(a);l&&(this.type=a)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this},_e.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.transforms=[],this.attachments=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"attachment_full":this.attachments.push((new Te).parse(o));break;case"rotate":case"translate":case"matrix":this.transforms.push((new V).parse(o))}}return this},Te.prototype.parse=function(e){this.joint=e.getAttribute("joint").split("/").pop(),this.links=[];for(var t=0;t<e.childNodes.length;t++){var o=e.childNodes[t];if(1==o.nodeType)switch(o.nodeName){case"link":this.links.push((new _e).parse(o));break;case"rotate":case"translate":case"matrix":this.transforms.push((new V).parse(o))}}return this},{load:function(e,t,o,i){var n=0;if(document.implementation&&document.implementation.createDocument){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState?0===r.status||200===r.status?r.response?(g=t,w(r.response,void 0,e)):i?i({type:"error",url:e}):console.error("ColladaLoader: Empty or non-existing file ("+e+")"):i?i({type:"error",url:e}):console.error("ColladaLoader: Couldn't load \""+e+'" ('+r.status+")"):3===r.readyState&&o&&(0===n&&(n=r.getResponseHeader("Content-Length")),o({total:n,loaded:r.responseText.length}))},r.open("GET",e,!0),r.send(null)}else alert("Don't know how to parse XML!")},parse:w,applySkin:R,geometries:y,options:b}}},{}],43:[function(e,t,o){THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager}e.prototype={constructor:e,crossOrigin:"Anonymous",load:function(e,t,o,i){var n=this,r=this.path&&"string"==typeof this.path?this.path:THREE.Loader.prototype.extractUrlBase(e),s=new THREE.FileLoader(n.manager);s.setResponseType("arraybuffer"),s.load(e,function(e){try{n.parse(e,r,t,i)}catch(e){i(e.constructor===Error?e:new Error("THREE.GLTFLoader: Unable to parse model."))}},o,i)},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e},parse:function(e,s,a,l){var c,u={},h=v(new Uint8Array(e,0,4));h===i?(u[t.KHR_BINARY_GLTF]=new function(e){this.name=t.KHR_BINARY_GLTF,this.content=null,this.body=null;var o=new DataView(e,0,n);if(this.header={magic:v(new Uint8Array(e.slice(0,4))),version:o.getUint32(4,!0),length:o.getUint32(8,!0)},this.header.magic!==i)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use GLTFLoader instead.");for(var s=new DataView(e,n),a=0;a<s.byteLength;){var l=s.getUint32(a,!0);a+=4;var c=s.getUint32(a,!0);if(a+=4,c===r.JSON){var u=new Uint8Array(e,n+a,l);this.content=v(u)}else if(c===r.BIN){var h=n+a;this.body=e.slice(h,h+l)}a+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(e),c=u[t.KHR_BINARY_GLTF].content):c=v(new Uint8Array(e));var g=JSON.parse(c);if(void 0===g.asset||g.asset.version[0]<2)l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{g.extensionsUsed&&(g.extensionsUsed.indexOf(t.KHR_LIGHTS)>=0&&(u[t.KHR_LIGHTS]=new function(e){this.name=t.KHR_LIGHTS,this.lights={};var o=(e.extensions&&e.extensions[t.KHR_LIGHTS]||{}).lights||{};for(var i in o){var n,r=o[i],s=(new THREE.Color).fromArray(r.color);switch(r.type){case"directional":(n=new THREE.DirectionalLight(s)).position.set(0,0,1);break;case"point":n=new THREE.PointLight(s);break;case"spot":(n=new THREE.SpotLight(s)).position.set(0,0,1);break;case"ambient":n=new THREE.AmbientLight(s)}n&&(void 0!==r.constantAttenuation&&(n.intensity=r.constantAttenuation),void 0!==r.linearAttenuation&&(n.distance=1/r.linearAttenuation),void 0!==r.quadraticAttenuation&&(n.decay=r.quadraticAttenuation),void 0!==r.fallOffAngle&&(n.angle=r.fallOffAngle),void 0!==r.fallOffExponent&&console.warn("THREE.GLTFLoader:: light.fallOffExponent not currently supported."),n.name=r.name||"light_"+i,this.lights[i]=n)}}(g)),g.extensionsUsed.indexOf(t.KHR_MATERIALS_COMMON)>=0&&(u[t.KHR_MATERIALS_COMMON]=new o(g)),g.extensionsUsed.indexOf(t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(u[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new function(){return{name:t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,o){var i=t.extensions[this.name],n=THREE.ShaderLib.standard,r=THREE.UniformsUtils.clone(n.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),u=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=n.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",u);delete r.roughness,delete r.metalness,delete r.roughnessMap,delete r.metalnessMap,r.specular={value:(new THREE.Color).setHex(1118481)},r.glossiness={value:.5},r.specularMap={value:null},r.glossinessMap={value:null},e.vertexShader=n.vertexShader,e.fragmentShader=h,e.uniforms=r,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var g=[];if(Array.isArray(i.diffuseFactor)){var d=i.diffuseFactor;e.color.fromArray(d),e.opacity=d[3]}if(void 0!==i.diffuseTexture&&g.push(o.assignTexture(e,"map",i.diffuseTexture.index)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var p=i.specularGlossinessTexture.index;g.push(o.assignTexture(e,"glossinessMap",p)),g.push(o.assignTexture(e,"specularMap",p))}return Promise.all(g)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalScale=new THREE.Vector2(1,1),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},refreshUniforms:function(e,t,o,i,n,r){var s,a=n.uniforms,l=n.defines;if(a.opacity.value=n.opacity,a.diffuse.value.copy(n.color),a.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),a.map.value=n.map,a.specularMap.value=n.specularMap,a.alphaMap.value=n.alphaMap,a.lightMap.value=n.lightMap,a.lightMapIntensity.value=n.lightMapIntensity,a.aoMap.value=n.aoMap,a.aoMapIntensity.value=n.aoMapIntensity,n.map?s=n.map:n.specularMap?s=n.specularMap:n.displacementMap?s=n.displacementMap:n.normalMap?s=n.normalMap:n.bumpMap?s=n.bumpMap:n.glossinessMap?s=n.glossinessMap:n.alphaMap?s=n.alphaMap:n.emissiveMap&&(s=n.emissiveMap),void 0!==s){s.isWebGLRenderTarget&&(s=s.texture);var c=s.offset,u=s.repeat;a.offsetRepeat.value.set(c.x,c.y,u.x,u.y)}a.envMap.value=n.envMap,a.envMapIntensity.value=n.envMapIntensity,a.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1,a.refractionRatio.value=n.refractionRatio,a.specular.value.copy(n.specular),a.glossiness.value=n.glossiness,a.glossinessMap.value=n.glossinessMap,a.emissiveMap.value=n.emissiveMap,a.bumpMap.value=n.bumpMap,a.normalMap.value=n.normalMap,a.displacementMap.value=n.displacementMap,a.displacementScale.value=n.displacementScale,a.displacementBias.value=n.displacementBias,null!==a.glossinessMap.value&&void 0===l.USE_GLOSSINESSMAP&&(l.USE_GLOSSINESSMAP="",l.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==l.USE_GLOSSINESSMAP&&(delete l.USE_GLOSSINESSMAP,delete l.USE_ROUGHNESSMAP)}}})),console.time("GLTFLoader");var d=new _(g,u,{path:s||this.path,crossOrigin:this.crossOrigin});d.parse(function(e,t,o,i){console.timeEnd("GLTFLoader");var n={scene:e,scenes:t,cameras:o,animations:i};a(n)},l)}}};var t={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness"};function o(e){this.name=t.KHR_MATERIALS_COMMON}o.prototype.getMaterialType=function(e){var t=e.extensions[this.name];switch(t.type){case"commonBlinn":case"commonPhong":return THREE.MeshPhongMaterial;case"commonLambert":return THREE.MeshLambertMaterial;case"commonConstant":default:return THREE.MeshBasicMaterial}},o.prototype.extendParams=function(e,t,o){var i=t.extensions[this.name],n=[],r=[];switch(i.type){case"commonBlinn":case"commonPhong":r.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":r.push("diffuseFactor","diffuseTexture")}var s={};return r.forEach(function(e){void 0!==i[e]&&(s[e]=i[e])}),void 0!==s.diffuseFactor&&(e.color=(new THREE.Color).fromArray(s.diffuseFactor),e.opacity=s.diffuseFactor[3]),void 0!==s.diffuseTexture&&n.push(o.assignTexture(e,"map",s.diffuseTexture.index)),void 0!==s.specularFactor&&(e.specular=(new THREE.Color).fromArray(s.specularFactor)),void 0!==s.specularTexture&&n.push(o.assignTexture(e,"specularMap",s.specularTexture.index)),void 0!==s.shininessFactor&&(e.shininess=s.shininessFactor),Promise.all(n)};var i="glTF",n=12,r={JSON:1313821514,BIN:5130562},s={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},a=(Number,THREE.Matrix3,THREE.Matrix4,THREE.Vector2,THREE.Vector3,THREE.Vector4,THREE.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),l={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter},c={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},u={6406:THREE.AlphaFormat,6407:THREE.RGBFormat,6408:THREE.RGBAFormat,6409:THREE.LuminanceFormat,6410:THREE.LuminanceAlphaFormat},h={5121:THREE.UnsignedByteType,32819:THREE.UnsignedShort4444Type,32820:THREE.UnsignedShort5551Type,33635:THREE.UnsignedShort565Type},g=(THREE.BackSide,THREE.FrontSide,THREE.NeverDepth,THREE.LessDepth,THREE.EqualDepth,THREE.LessEqualDepth,THREE.GreaterEqualDepth,THREE.NotEqualDepth,THREE.GreaterEqualDepth,THREE.AlwaysDepth,THREE.AddEquation,THREE.SubtractEquation,THREE.ReverseSubtractEquation,THREE.ZeroFactor,THREE.OneFactor,THREE.SrcColorFactor,THREE.OneMinusSrcColorFactor,THREE.SrcAlphaFactor,THREE.OneMinusSrcAlphaFactor,THREE.DstAlphaFactor,THREE.OneMinusDstAlphaFactor,THREE.DstColorFactor,THREE.OneMinusDstColorFactor,THREE.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),d={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},p={CATMULLROMSPLINE:THREE.InterpolateSmooth,CUBICSPLINE:THREE.InterpolateSmooth,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},f={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function m(e,t,o){if(!e)return Promise.resolve();var i,n=[];if("[object Array]"===Object.prototype.toString.call(e)){i=[];for(var r=e.length,s=0;s<r;s++){var a=t.call(o||this,e[s],s);a&&(n.push(a),a instanceof Promise?a.then(function(e,t){i[e]=t}.bind(this,s)):i[s]=a)}}else for(var l in i={},e)if(e.hasOwnProperty(l)){var a=t.call(o||this,e[l],l);a&&(n.push(a),a instanceof Promise?a.then(function(e,t){i[e]=t}.bind(this,l)):i[l]=a)}return Promise.all(n).then(function(){return i})}function y(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e}function v(e){if(void 0!==window.TextDecoder)return(new TextDecoder).decode(e);for(var t="",o=0,i=e.length;o<i;o++)t+=String.fromCharCode(e[o]);return t}function E(e,t,o,i){var n=e.geometry,r=e.material,s=o.targets,a=n.morphAttributes;a.position=[],a.normal=[],r.morphTargets=!0;for(var l=0,c=s.length;l<c;l++){var u,h,g=s[l],d="morphTarget"+l;if(void 0!==g.POSITION){u=i.accessors[g.POSITION].clone();for(var p=n.attributes.position,f=0,m=u.count;f<m;f++)u.setXYZ(f,u.getX(f)+p.getX(f),u.getY(f)+p.getY(f),u.getZ(f)+p.getZ(f))}else u=n.attributes.position.clone();if(void 0!==g.NORMAL){r.morphNormals=!0,h=i.accessors[g.NORMAL].clone();for(var y=n.attributes.normal,f=0,m=h.count;f<m;f++)h.setXYZ(f,h.getX(f)+y.getX(f),h.getY(f)+y.getY(f),h.getZ(f)+y.getZ(f))}else h=n.attributes.normal.clone();g.TANGENT,u.name=d,h.name=d,a.position.push(u),a.normal.push(h)}if(e.updateMorphTargets(),void 0!==t.weights)for(var l=0,c=t.weights.length;l<c;l++)e.morphTargetInfluences[l]=t.weights[l]}function _(e,t,o){this.json=e||{},this.extensions=t||{},this.options=o||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,o){e[t]=o},remove:function(t){delete e[t]},removeAll:function(){e={}},update:function(t,o){for(var i in e){var n=e[i];n.update&&n.update(t,o)}}}}}return _.prototype._withDependencies=function(e){for(var t={},o=0;o<e.length;o++){var i=e[o],n="load"+i.charAt(0).toUpperCase()+i.slice(1),r=this.cache.get(i);if(void 0!==r)t[i]=r;else if(this[n]){var s=this[n]();this.cache.add(i,s),t[i]=s}}return m(t,function(e){return e})},_.prototype.parse=function(e,t){var o=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(t){var i=[];for(var n in t.scenes)i.push(t.scenes[n]);var r=void 0!==o.scene?t.scenes[o.scene]:i[0],s=[];for(var n in t.cameras){var a=t.cameras[n];s.push(a)}var l=[];for(var n in t.animations)l.push(t.animations[n]);e(r,i,s,l)}).catch(t)},_.prototype.getDependency=function(e,t){var o=e+":"+t,i=this.cache.get(o);if(!i){var n="load"+e.charAt(0).toUpperCase()+e.slice(1);i=this[n](t),this.cache.add(o,i)}return i},_.prototype.loadBuffer=function(e){var o=this.json.buffers[e];if(o.type&&"arraybuffer"!==o.type)throw new Error("THREE.GLTFLoader: %s buffer type is not supported.",o.type);if(void 0===o.uri&&0===e)return Promise.resolve(this.extensions[t.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e){var t=new THREE.FileLoader;t.setResponseType("arraybuffer"),t.load(y(o.uri,i.path),e)})},_.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var o=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+o)})},_.prototype.loadAccessors=function(){var e=this,t=this.json;return m(t.accessors,function(o){return e.getDependency("bufferView",o.bufferView).then(function(e){var i,n=g[o.type],r=a[o.componentType],s=r.BYTES_PER_ELEMENT,l=s*n,c=t.bufferViews[o.bufferView].byteStride;if(c&&c!==l){i=new r(e);var u=new THREE.InterleavedBuffer(i,c/s);return new THREE.InterleavedBufferAttribute(u,n,o.byteOffset/s)}return i=new r(e,o.byteOffset,o.count*n),new THREE.BufferAttribute(i,n)})})},_.prototype.loadTexture=function(e){var t=this.json,o=this.options,i=window.URL||window.webkitURL,n=t.textures[e],r=t.images[n.source],s=r.uri,a=!1;return void 0!==r.bufferView&&(s=this.getDependency("bufferView",r.bufferView).then(function(e){a=!0;var t=new Blob([e],{type:r.mimeType});return s=i.createObjectURL(t)})),Promise.resolve(s).then(function(e){var t=THREE.Loader.Handlers.get(e)||new THREE.TextureLoader;return t.setCrossOrigin(o.crossOrigin),new Promise(function(i,n){t.load(y(e,o.path),i,void 0,n)})}).then(function(e){void 0!==a&&i.revokeObjectURL(s),e.flipY=!1,void 0!==n.name&&(e.name=n.name),e.format=void 0!==n.format?u[n.format]:THREE.RGBAFormat,void 0!==n.internalFormat&&e.format!==u[n.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),e.type=void 0!==n.type?h[n.type]:THREE.UnsignedByteType;var o=t.samplers||{},r=o[n.sampler]||{};return e.magFilter=l[r.magFilter]||THREE.LinearFilter,e.minFilter=l[r.minFilter]||THREE.LinearMipMapLinearFilter,e.wrapS=c[r.wrapS]||THREE.RepeatWrapping,e.wrapT=c[r.wrapT]||THREE.RepeatWrapping,e})},_.prototype.assignTexture=function(e,t,o){return this.getDependency("texture",o).then(function(o){e[t]=o})},_.prototype.loadMaterials=function(){var e=this,o=this.json,i=this.extensions;return m(o.materials,function(o){var n,r={},s=o.extensions||{},a=[];if(s[t.KHR_MATERIALS_COMMON]){var l=i[t.KHR_MATERIALS_COMMON];n=l.getMaterialType(o),a.push(l.extendParams(r,o,e))}else if(s[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=c.getMaterialType(o),a.push(c.extendParams(r,o,e))}else if(void 0!==o.pbrMetallicRoughness){n=THREE.MeshStandardMaterial;var u=o.pbrMetallicRoughness;if(r.color=new THREE.Color(1,1,1),r.opacity=1,Array.isArray(u.baseColorFactor)){var h=u.baseColorFactor;r.color.fromArray(h),r.opacity=h[3]}if(void 0!==u.baseColorTexture&&a.push(e.assignTexture(r,"map",u.baseColorTexture.index)),r.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,r.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture){var g=u.metallicRoughnessTexture.index;a.push(e.assignTexture(r,"metalnessMap",g)),a.push(e.assignTexture(r,"roughnessMap",g))}}else n=THREE.MeshPhongMaterial;!0===o.doubleSided&&(r.side=THREE.DoubleSide);var d=o.alphaMode||f.OPAQUE;return r.transparent=d!==f.OPAQUE,void 0!==o.normalTexture&&a.push(e.assignTexture(r,"normalMap",o.normalTexture.index)),void 0!==o.occlusionTexture&&a.push(e.assignTexture(r,"aoMap",o.occlusionTexture.index)),void 0!==o.emissiveFactor&&(n===THREE.MeshBasicMaterial?r.color=(new THREE.Color).fromArray(o.emissiveFactor):r.emissive=(new THREE.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&(n===THREE.MeshBasicMaterial?a.push(e.assignTexture(r,"map",o.emissiveTexture.index)):a.push(e.assignTexture(r,"emissiveMap",o.emissiveTexture.index))),Promise.all(a).then(function(){var e;return e=n===THREE.ShaderMaterial?i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(r):new n(r),void 0!==o.name&&(e.name=o.name),e.normalScale.x=-1,e.userData=o.extras,e})})},_.prototype.loadGeometries=function(e){return this._withDependencies(["accessors"]).then(function(t){return m(e,function(e){var o=new THREE.BufferGeometry,i=e.attributes;for(var n in i){var r=i[n];if(void 0===r)return;var s=t.accessors[r];switch(n){case"POSITION":o.addAttribute("position",s);break;case"NORMAL":o.addAttribute("normal",s);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":o.addAttribute("uv",s);break;case"TEXCOORD_1":o.addAttribute("uv2",s);break;case"COLOR_0":case"COLOR0":case"COLOR":o.addAttribute("color",s);break;case"WEIGHTS_0":case"WEIGHT":o.addAttribute("skinWeight",s);break;case"JOINTS_0":case"JOINT":o.addAttribute("skinIndex",s)}}return void 0!==e.indices&&o.setIndex(t.accessors[e.indices]),o})})},_.prototype.loadMeshes=function(){var e=this,t=this.json;return this._withDependencies(["accessors","materials"]).then(function(o){return m(t.meshes,function(t){var i=new THREE.Group;void 0!==t.name&&(i.name=t.name),t.extras&&(i.userData=t.extras);var n=t.primitives||[];return e.loadGeometries(n).then(function(e){for(var r in n){var a,l=n[r],c=e[r],u=void 0===l.material?new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):o.materials[l.material];if(u.aoMap&&void 0===c.attributes.uv2&&void 0!==c.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),c.addAttribute("uv2",new THREE.BufferAttribute(c.attributes.uv.array,2))),void 0!==c.attributes.color&&(u.vertexColors=THREE.VertexColors,u.needsUpdate=!0),void 0===c.attributes.normal&&(void 0!==u.flatShading?u.flatShading=!0:u.shading=THREE.FlatShading),l.mode===s.TRIANGLES||void 0===l.mode)a=new THREE.Mesh(c,u);else if(l.mode===s.TRIANGLE_STRIP)(a=new THREE.Mesh(c,u)).drawMode=THREE.TriangleStripDrawMode;else if(l.mode===s.TRIANGLE_FAN)(a=new THREE.Mesh(c,u)).drawMode=THREE.TriangleFanDrawMode;else if(l.mode===s.LINES)a=new THREE.LineSegments(c,u);else if(l.mode===s.LINE_STRIP)a=new THREE.Line(c,u);else if(l.mode===s.LINE_LOOP)a=new THREE.LineLoop(c,u);else{if(l.mode!==s.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: ",l.mode);a=new THREE.Points(c,u)}a.name=i.name+"_"+r,void 0!==l.targets&&E(a,t,l,o),l.extras&&(a.userData=l.extras),i.add(a)}return i})})})},_.prototype.loadCameras=function(){var e=this.json;return m(e.cameras,function(e){var t,o=e[e.type];if(o){if("perspective"===e.type){var i=o.aspectRatio||1,n=o.yfov*i;t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(n),i,o.znear||1,o.zfar||2e6)}else"orthographic"===e.type&&(t=new THREE.OrthographicCamera(o.xmag/-2,o.xmag/2,o.ymag/2,o.ymag/-2,o.znear,o.zfar));return void 0!==e.name&&(t.name=e.name),e.extras&&(t.userData=e.extras),t}console.warn("THREE.GLTFLoader: Missing camera parameters.")})},_.prototype.loadSkins=function(){var e=this.json;return this._withDependencies(["accessors"]).then(function(t){return m(e.skins,function(e){var o={joints:e.joints,inverseBindMatrices:t.accessors[e.inverseBindMatrices]};return o})})},_.prototype.loadAnimations=function(){var e=this.json;return this._withDependencies(["accessors","nodes"]).then(function(t){return m(e.animations,function(e,o){var i=[];for(var n in e.channels){var r=e.channels[n],s=e.samplers[r.sampler];if(s){var a=r.target,l=void 0!==a.node?a.node:a.id,c=void 0!==e.parameters?e.parameters[s.input]:s.input,u=void 0!==e.parameters?e.parameters[s.output]:s.output,h=t.accessors[c],g=t.accessors[u],f=t.nodes[l];if(f){var m;switch(f.updateMatrix(),f.matrixAutoUpdate=!0,d[a.path]){case d.weights:m=THREE.NumberKeyframeTrack;break;case d.rotation:m=THREE.QuaternionKeyframeTrack;break;case d.position:case d.scale:default:m=THREE.VectorKeyframeTrack}var y=f.name?f.name:f.uuid;"CATMULLROMSPLINE"===s.interpolation&&console.warn("THREE.GLTFLoader: CATMULLROMSPLINE interpolation is not supported. Using CUBICSPLINE instead.");var v=void 0!==s.interpolation?p[s.interpolation]:THREE.InterpolateLinear,E=[];d[a.path]===d.weights?f.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&E.push(e.name?e.name:e.uuid)}):E.push(y);for(var _=0,T=E.length;_<T;_++)i.push(new m(E[_]+"."+d[a.path],THREE.AnimationUtils.arraySlice(h.array,0),THREE.AnimationUtils.arraySlice(g.array,0),v))}}}var l=void 0!==e.name?e.name:"animation_"+o;return new THREE.AnimationClip(l,void 0,i)})})},_.prototype.loadNodes=function(){var e=this.json,o=this.extensions,i=this,n=e.nodes||[],r=e.skins||[];return r.forEach(function(e){e.joints.forEach(function(e){n[e].isBone=!0})}),m(e.nodes,function(e){var t=new THREE.Matrix4,o=!0===e.isBone?new THREE.Bone:new THREE.Object3D;return void 0!==e.name&&(o.name=THREE.PropertyBinding.sanitizeNodeName(e.name)),e.extras&&(o.userData=e.extras),void 0!==e.matrix?(t.fromArray(e.matrix),o.applyMatrix(t)):(void 0!==e.translation&&o.position.fromArray(e.translation),void 0!==e.rotation&&o.quaternion.fromArray(e.rotation),void 0!==e.scale&&o.scale.fromArray(e.scale)),o}).then(function(n){return i._withDependencies(["meshes","skins","cameras"]).then(function(i){return m(n,function(r,s){var a,l=e.nodes[s];if(void 0!==l.mesh?a=[l.mesh]:void 0!==l.meshes&&(console.warn("THREE.GLTFLoader: Legacy glTF file detected. Nodes may have no more than one mesh."),a=l.meshes),void 0!==a)for(var c in a){var u=a[c],h=i.meshes[u];if(void 0!==h){var g=h.clone(!1);for(var d in h.children){var p,f=h.children[d],m=f,y=f.material,v=f.geometry,E=f.morphTargetInfluences,_=f.userData,T=f.name,b=y;switch(f.type){case"LineSegments":f=new THREE.LineSegments(v,b);break;case"LineLoop":f=new THREE.LineLoop(v,b);break;case"Line":f=new THREE.Line(v,b);break;case"Points":f=new THREE.Points(v,b);break;default:(f=new THREE.Mesh(v,b)).drawMode=m.drawMode}if(f.castShadow=!0,f.morphTargetInfluences=E,f.userData=_,f.name=T,void 0!==l.skin&&(p=i.skins[l.skin]),p){var M=v;(b=y).skinning=!0,(f=new THREE.SkinnedMesh(M,b)).castShadow=!0,f.userData=_,f.name=T;for(var A=[],S=[],w=0,C=p.joints.length;w<C;w++){var N=p.joints[w],L=n[N];if(L){A.push(L);var I=p.inverseBindMatrices.array,R=(new THREE.Matrix4).fromArray(I,16*w);S.push(R)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',N)}f.bind(new THREE.Skeleton(A,S),f.matrixWorld)}g.add(f)}r.add(g)}else console.warn('THREE.GLTFLoader: Could not find node "'+u+'".')}if(void 0!==l.camera){var D=i.cameras[l.camera];r.add(D)}if(l.extensions&&l.extensions[t.KHR_LIGHTS]&&void 0!==l.extensions[t.KHR_LIGHTS].light){var x=o[t.KHR_LIGHTS].lights;r.add(x[l.extensions[t.KHR_LIGHTS].light])}return r})})})},_.prototype.loadScenes=function(){var e=this.json,o=this.extensions;function i(t,o,n){var r=n[t];o.add(r);var s=e.nodes[t];if(s.children)for(var a=s.children,l=0,c=a.length;l<c;l++){var u=a[l];i(u,r,n)}}return this._withDependencies(["nodes"]).then(function(n){return m(e.scenes,function(e){var r=new THREE.Scene;void 0!==e.name&&(r.name=e.name),e.extras&&(r.userData=e.extras);for(var s=e.nodes||[],a=0,l=s.length;a<l;a++){var c=s[a];i(c,r,n.nodes)}if(r.traverse(function(e){e.material&&e.material.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=o[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}),e.extensions&&e.extensions[t.KHR_LIGHTS]&&void 0!==e.extensions[t.KHR_LIGHTS].light){var u=o[t.KHR_LIGHTS].lights;r.add(u[e.extensions[t.KHR_LIGHTS].light])}return r})})},e}()},{}],44:[function(e,t,o){THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,o,i){var n=this,r=new THREE.FileLoader(this.manager);r.setPath(this.path),r.load(e,function(e){t(n.parse(e))},o,i)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split("\n"),o={},i=/\s+/,n={},r=0;r<t.length;r++){var s=t[r];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var a=s.indexOf(" "),l=a>=0?s.substring(0,a):s;l=l.toLowerCase();var c=a>=0?s.substring(a+1):"";if(c=c.trim(),"newmtl"===l)o={name:c},n[c]=o;else if(o)if("ka"===l||"kd"===l||"ks"===l){var u=c.split(i,3);o[l]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else o[l]=c}}var h=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return h.setCrossOrigin(this.crossOrigin),h.setManager(this.manager),h.setMaterials(n),h}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var o in e){var i=e[o],n={};for(var r in t[o]=n,i){var s=!0,a=i[r],l=r.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===a[0]&&0===a[1]&&0===a[2]&&(s=!1)}s&&(n[l]=a)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,o=this.materialsInfo[e],i={name:e,side:this.side};function n(e,o){if(!i[e]){var n,r,s=t.getTextureParams(o,i),a=t.loadTexture((n=t.baseUrl,"string"!=typeof(r=s.url)||""===r?"":/^https?:\/\//i.test(r)?r:n+r));a.repeat.copy(s.scale),a.offset.copy(s.offset),a.wrapS=t.wrap,a.wrapT=t.wrap,i[e]=a}}for(var r in o){var s,a=o[r];if(""!==a)switch(r.toLowerCase()){case"kd":i.color=(new THREE.Color).fromArray(a);break;case"ks":i.specular=(new THREE.Color).fromArray(a);break;case"map_kd":n("map",a);break;case"map_ks":n("specularMap",a);break;case"norm":n("normalMap",a);break;case"map_bump":case"bump":n("bumpMap",a);break;case"ns":i.shininess=parseFloat(a);break;case"d":(s=parseFloat(a))<1&&(i.opacity=s,i.transparent=!0);break;case"tr":(s=parseFloat(a))>0&&(i.opacity=1-s,i.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(i),this.materials[e]},getTextureParams:function(e,t){var o,i={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},n=e.split(/\s+/);return(o=n.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(n[o+1]),n.splice(o,2)),(o=n.indexOf("-s"))>=0&&(i.scale.set(parseFloat(n[o+1]),parseFloat(n[o+2])),n.splice(o,4)),(o=n.indexOf("-o"))>=0&&(i.offset.set(parseFloat(n[o+1]),parseFloat(n[o+2])),n.splice(o,4)),i.url=n.join(" ").trim(),i},loadTexture:function(e,t,o,i,n){var r,s=THREE.Loader.Handlers.get(e),a=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===s&&(s=new THREE.TextureLoader(a)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin),r=s.load(e,o,i,n),void 0!==t&&(r.mapping=t),r}}},{}],45:[function(e,t,o){THREE.OBJLoader=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,o=/^usemtl /;function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}return i.prototype={constructor:i,load:function(e,t,o,i){var n=this,r=new THREE.FileLoader(n.manager);r.setPath(this.path),r.load(e,function(e){t(n.parse(e))},o,i)},setPath:function(e){this.path=e},setMaterials:function(e){return this.materials=e,this},parse:function(i){console.time("OBJLoader");var n=new function(){var e={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var o=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);var i={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},o&&o.name&&"function"==typeof o.clone){var i=o.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var o=parseInt(e,10);return 3*(o>=0?o-1:o+t/3)},parseNormalIndex:function(e,t){var o=parseInt(e,10);return 3*(o>=0?o-1:o+t/3)},parseUVIndex:function(e,t){var o=parseInt(e,10);return 2*(o>=0?o-1:o+t/2)},addVertex:function(e,t,o){var i=this.vertices,n=this.object.geometry.vertices;n.push(i[e+0],i[e+1],i[e+2]),n.push(i[t+0],i[t+1],i[t+2]),n.push(i[o+0],i[o+1],i[o+2])},addVertexLine:function(e){var t=this.vertices,o=this.object.geometry.vertices;o.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,o){var i=this.normals,n=this.object.geometry.normals;n.push(i[e+0],i[e+1],i[e+2]),n.push(i[t+0],i[t+1],i[t+2]),n.push(i[o+0],i[o+1],i[o+2])},addUV:function(e,t,o){var i=this.uvs,n=this.object.geometry.uvs;n.push(i[e+0],i[e+1]),n.push(i[t+0],i[t+1]),n.push(i[o+0],i[o+1])},addUVLine:function(e){var t=this.uvs,o=this.object.geometry.uvs;o.push(t[e+0],t[e+1])},addFace:function(e,t,o,i,n,r,s,a,l){var c=this.vertices.length,u=this.parseVertexIndex(e,c),h=this.parseVertexIndex(t,c),g=this.parseVertexIndex(o,c);if(this.addVertex(u,h,g),void 0!==i){var d=this.uvs.length;u=this.parseUVIndex(i,d),h=this.parseUVIndex(n,d),g=this.parseUVIndex(r,d),this.addUV(u,h,g)}if(void 0!==s){var p=this.normals.length;u=this.parseNormalIndex(s,p),h=s===a?u:this.parseNormalIndex(a,p),g=s===l?u:this.parseNormalIndex(l,p),this.addNormal(u,h,g)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var o=this.vertices.length,i=this.uvs.length,n=0,r=e.length;n<r;n++)this.addVertexLine(this.parseVertexIndex(e[n],o));for(var s=0,r=t.length;s<r;s++)this.addUVLine(this.parseUVIndex(t[s],i))}};return e.startObject("",!1),e};-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var r=i.split("\n"),s="",a="",l=[],c="function"==typeof"".trimLeft,u=0,h=r.length;u<h;u++)if(s=r[u],0!==(s=c?s.trimLeft():s.trim()).length&&"#"!==(a=s.charAt(0)))if("v"===a){var g=s.split(/\s+/);switch(g[0]){case"v":n.vertices.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));break;case"vn":n.normals.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));break;case"vt":n.uvs.push(parseFloat(g[1]),parseFloat(g[2]))}}else if("f"===a){for(var d=s.substr(1).trim(),p=d.split(/\s+/),f=[],m=0,y=p.length;m<y;m++){var v=p[m];if(v.length>0){var E=v.split("/");f.push(E)}}for(var _=f[0],m=1,y=f.length-1;m<y;m++){var T=f[m],b=f[m+1];n.addFace(_[0],T[0],b[0],_[1],T[1],b[1],_[2],T[2],b[2])}}else if("l"===a){var M=s.substring(1).trim().split(" "),A=[],S=[];if(-1===s.indexOf("/"))A=M;else for(var w=0,C=M.length;w<C;w++){var N=M[w].split("/");""!==N[0]&&A.push(N[0]),""!==N[1]&&S.push(N[1])}n.addLineGeometry(A,S)}else if(null!==(l=e.exec(s))){var L=(" "+l[0].substr(1).trim()).substr(1);n.startObject(L)}else if(o.test(s))n.object.startMaterial(s.substring(7).trim(),n.materialLibraries);else if(t.test(s))n.materialLibraries.push(s.substring(7).trim());else{if("s"!==a){if("\0"===s)continue;throw new Error("Unexpected line: '"+s+"'")}if((l=s.split(" ")).length>1){var I=l[1].trim().toLowerCase();n.object.smooth="0"!==I&&"off"!==I}else n.object.smooth=!0;var R=n.object.currentMaterial();R&&(R.smooth=n.object.smooth)}n.finalize();var D=new THREE.Group;D.materialLibraries=[].concat(n.materialLibraries);for(var u=0,h=n.objects.length;u<h;u++){var x=n.objects[u],O=x.geometry,k=x.materials,B="Line"===O.type;if(0!==O.vertices.length){var P=new THREE.BufferGeometry;P.addAttribute("position",new THREE.BufferAttribute(new Float32Array(O.vertices),3)),O.normals.length>0?P.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(O.normals),3)):P.computeVertexNormals(),O.uvs.length>0&&P.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(O.uvs),2));for(var U,F=[],H=0,j=k.length;H<j;H++){var z=k[H],R=void 0;if(null!==this.materials&&(R=this.materials.create(z.name),B&&R&&!(R instanceof THREE.LineBasicMaterial))){var V=new THREE.LineBasicMaterial;V.copy(R),R=V}R||((R=B?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial).name=z.name),R.flatShading=!z.smooth,F.push(R)}if(F.length>1){for(var H=0,j=k.length;H<j;H++){var z=k[H];P.addGroup(z.groupStart,z.groupCount,H)}U=B?new THREE.LineSegments(P,F):new THREE.Mesh(P,F)}else U=B?new THREE.LineSegments(P,F[0]):new THREE.Mesh(P,F[0]);U.name=x.name,D.add(U)}}return console.timeEnd("OBJLoader"),D}},i}()},{}],46:[function(e,t,o){(o=t.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},o.right=function(e){return e.replace(/\s*$/,"")}},{}],47:[function(e,t,o){t.exports={_args:[[{raw:"webvr-polyfill@^0.9.36",scope:null,escapedName:"webvr-polyfill",name:"webvr-polyfill",rawSpec:"^0.9.36",spec:">=0.9.36 <0.10.0",type:"range"},"X:\\Development\\aframe"]],_from:"webvr-polyfill@>=0.9.36 <0.10.0",_id:"webvr-polyfill@0.9.38",_inCache:!0,_location:"/webvr-polyfill",_nodeVersion:"8.1.4",_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/webvr-polyfill-0.9.38.tgz_1505328121599_0.8887633208651096"},_npmUser:{name:"jsantell",email:"jsantell@gmail.com"},_npmVersion:"5.4.1",_phantomChildren:{},_requested:{raw:"webvr-polyfill@^0.9.36",scope:null,escapedName:"webvr-polyfill",name:"webvr-polyfill",rawSpec:"^0.9.36",spec:">=0.9.36 <0.10.0",type:"range"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/webvr-polyfill/-/webvr-polyfill-0.9.38.tgz",_shasum:"740099a2f268a56a0bf18181fb57395efad70712",_shrinkwrap:null,_spec:"webvr-polyfill@^0.9.36",_where:"X:\\Development\\aframe",authors:["Boris Smus <boris@smus.com>","Brandon Jones <tojiro@gmail.com>","Jordan Santell <jordan@jsantell.com>"],bugs:{url:"https://github.com/googlevr/webvr-polyfill/issues"},dependencies:{},description:"Use WebVR today, on mobile or desktop, without requiring a special browser build.",devDependencies:{chai:"^3.5.0",jsdom:"^9.12.0",mocha:"^3.2.0",semver:"^5.3.0",webpack:"^2.6.1","webpack-dev-server":"^2.4.5"},directories:{},dist:{integrity:"sha512-HABweqWYE0suk6P5TdHlagJK56HSecB5xKj6ZshocrxSj9UmNOCjCRv4vFYHCaFZKtuKWa8niRHVbJ3Vo7JYDg==",shasum:"740099a2f268a56a0bf18181fb57395efad70712",tarball:"https://registry.npmjs.org/webvr-polyfill/-/webvr-polyfill-0.9.38.tgz"},gitHead:"8063169c6fc52342ebe5524d7f217987f9aa9cab",homepage:"https://github.com/googlevr/webvr-polyfill",keywords:["vr","webvr"],license:"Apache-2.0",main:"src/node-entry",maintainers:[{name:"jsantell",email:"jsantell@gmail.com"},{name:"toji",email:"tojiro@gmail.com"},{name:"smus",email:"boris@smus.com"}],name:"webvr-polyfill",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/googlevr/webvr-polyfill.git"},scripts:{build:"webpack",start:"npm run watch",test:"mocha",watch:"webpack-dev-server"},version:"0.9.38"}},{}],48:[function(e,t,o){var i=e("./util.js"),n=e("./wakelock.js"),r=1e3,s=!1,a=[0,0,.5,1],l=[.5,0,.5,1];function c(){this.isPolyfilled=!0,this.displayId=r++,this.displayName="webvr-polyfill displayName",this.depthNear=.01,this.depthFar=1e4,this.isConnected=!0,this.isPresenting=!1,this.capabilities={hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1},this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,this.wakelock_=new n}function u(){this.isPolyfilled=!0,this.hardwareUnitId="webvr-polyfill hardwareUnitId",this.deviceId="webvr-polyfill deviceId",this.deviceName="webvr-polyfill deviceName"}function h(){}function g(){}c.prototype.getFrameData=function(e){return i.frameDataFromPose(e,this.getPose(),this)},c.prototype.getPose=function(){return this.getImmediatePose()},c.prototype.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)},c.prototype.cancelAnimationFrame=function(e){return window.cancelAnimationFrame(e)},c.prototype.wrapForFullscreen=function(e){if(i.isIOS())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;this.removeFullscreenWrapper(),this.fullscreenElement_=e;var o=this.fullscreenElement_.parentElement;o.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),o.removeChild(this.fullscreenElement_),this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var n=this;return function(){if(n.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];n.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}(),this.fullscreenWrapper_},c.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),t.insertBefore(e,this.fullscreenWrapper_),t.removeChild(this.fullscreenWrapper_),e}},c.prototype.requestPresent=function(e){var t=this.isPresenting,o=this;return e instanceof Array||(s||(console.warn("Using a deprecated form of requestPresent. Should pass in an array of VRLayers."),s=!0),e=[e]),new Promise(function(n,r){if(o.capabilities.canPresent)if(0==e.length||e.length>o.capabilities.maxLayers)r(new Error("Invalid number of layers."));else{var s=e[0];if(s.source){var c=s.leftBounds||a,u=s.rightBounds||l;if(t){var h=o.layer_;h.source!==s.source&&(h.source=s.source);for(var g=0;g<4;g++)h.leftBounds[g]=c[g],h.rightBounds[g]=u[g];n()}else{if(o.layer_={predistorted:s.predistorted,source:s.source,leftBounds:c.slice(0),rightBounds:u.slice(0)},o.waitingForPresent_=!1,o.layer_&&o.layer_.source){var d=o.wrapForFullscreen(o.layer_.source);o.addFullscreenListeners_(d,function(){var e=i.getFullscreenElement();o.isPresenting=d===e,o.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)}),o.waitingForPresent_=!1,o.beginPresent_(),n()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),o.removeFullscreenWrapper(),o.wakelock_.release(),o.endPresent_(),o.removeFullscreenListeners_()),o.fireVRDisplayPresentChange_()},function(){o.waitingForPresent_&&(o.removeFullscreenWrapper(),o.removeFullscreenListeners_(),o.wakelock_.release(),o.waitingForPresent_=!1,o.isPresenting=!1,r(new Error("Unable to present.")))}),i.requestFullscreen(d)?(o.wakelock_.request(),o.waitingForPresent_=!0):(i.isIOS()||i.isWebViewAndroid())&&(o.wakelock_.request(),o.isPresenting=!0,o.beginPresent_(),o.fireVRDisplayPresentChange_(),n())}o.waitingForPresent_||i.isIOS()||(i.exitFullscreen(),r(new Error("Unable to present.")))}}else n()}else r(new Error("VRDisplay is not capable of presenting."))})},c.prototype.exitPresent=function(){var e=this.isPresenting,t=this;return this.isPresenting=!1,this.layer_=null,this.wakelock_.release(),new Promise(function(o,n){e?(!i.exitFullscreen()&&i.isIOS()&&(t.endPresent_(),t.fireVRDisplayPresentChange_()),i.isWebViewAndroid()&&(t.removeFullscreenWrapper(),t.removeFullscreenListeners_(),t.endPresent_(),t.fireVRDisplayPresentChange_()),o()):n(new Error("Was not presenting to VRDisplay."))})},c.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},c.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},c.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},c.prototype.addFullscreenListeners_=function(e,t,o){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=o,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),o&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",o,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",o,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",o,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",o,!1))},c.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var o=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",o,!1),e.removeEventListener("webkitfullscreenerror",o,!1),document.removeEventListener("mozfullscreenerror",o,!1),e.removeEventListener("msfullscreenerror",o,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},c.prototype.beginPresent_=function(){},c.prototype.endPresent_=function(){},c.prototype.submitFrame=function(e){},c.prototype.getEyeParameters=function(e){return null},h.prototype=new u,g.prototype=new u,t.exports.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},t.exports.VRDisplay=c,t.exports.VRDevice=u,t.exports.HMDVRDevice=h,t.exports.PositionSensorVRDevice=g},{"./util.js":68,"./wakelock.js":70}],49:[function(e,t,o){var i=e("./cardboard-ui.js"),n=e("./util.js"),r=e("./deps/wglu-preserve-state.js"),s=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),a=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function l(e){this.gl=e,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferScale=window.WebVRConfig.BUFFER_SCALE,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,n.isIOS()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=n.linkProgram(e,s,a,this.attribs),this.uniforms=n.getProgramUniforms(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize(),window.WebVRConfig.CARDBOARD_UI_DISABLED||(this.cardboardUI=new i(e))}l.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},l.prototype.onResize=function(){var e=this.gl,t=this,o=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];r(e,o,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},l.prototype.patch=function(){if(!this.isPatched){var e=this,t=this.gl.canvas,o=this.gl;n.isIOS()||(t.width=n.getScreenWidth()*this.bufferScale,t.height=n.getScreenHeight()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(o){e.bufferWidth=o,e.realCanvasWidth.set.call(t,o),e.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(o){e.bufferHeight=o,e.realCanvasHeight.set.call(t,o),e.onResize()}})),this.lastBoundFramebuffer=o.getParameter(o.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(t,i){e.lastBoundFramebuffer=i||e.framebuffer,e.realBindFramebuffer.call(o,t,e.lastBoundFramebuffer)},this.cullFace=o.getParameter(o.CULL_FACE),this.depthTest=o.getParameter(o.DEPTH_TEST),this.blend=o.getParameter(o.BLEND),this.scissorTest=o.getParameter(o.SCISSOR_TEST),this.stencilTest=o.getParameter(o.STENCIL_TEST),o.enable=function(t){switch(t){case o.CULL_FACE:e.cullFace=!0;break;case o.DEPTH_TEST:e.depthTest=!0;break;case o.BLEND:e.blend=!0;break;case o.SCISSOR_TEST:e.scissorTest=!0;break;case o.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(o,t)},o.disable=function(t){switch(t){case o.CULL_FACE:e.cullFace=!1;break;case o.DEPTH_TEST:e.depthTest=!1;break;case o.BLEND:e.blend=!1;break;case o.SCISSOR_TEST:e.scissorTest=!1;break;case o.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(o,t)},this.colorMask=o.getParameter(o.COLOR_WRITEMASK),o.colorMask=function(t,i,n,r){e.colorMask[0]=t,e.colorMask[1]=i,e.colorMask[2]=n,e.colorMask[3]=r,e.realColorMask.call(o,t,i,n,r)},this.clearColor=o.getParameter(o.COLOR_CLEAR_VALUE),o.clearColor=function(t,i,n,r){e.clearColor[0]=t,e.clearColor[1]=i,e.clearColor[2]=n,e.clearColor[3]=r,e.realClearColor.call(o,t,i,n,r)},this.viewport=o.getParameter(o.VIEWPORT),o.viewport=function(t,i,n,r){e.viewport[0]=t,e.viewport[1]=i,e.viewport[2]=n,e.viewport[3]=r,e.realViewport.call(o,t,i,n,r)},this.isPatched=!0,n.safariCssSizeWorkaround(t)}},l.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;n.isIOS()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){n.safariCssSizeWorkaround(t)},1)}},l.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]),t||(t=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},l.prototype.submitFrame=function(){var e=this.gl,t=this,o=[];if(window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||o.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),r(e,o,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||n.isIOS())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)}),n.isIOS()){var i=e.canvas;i.width==t.bufferWidth&&i.height==t.bufferHeight||(t.bufferWidth=i.width,t.bufferHeight=i.height,t.onResize())}},l.prototype.updateDeviceInfo=function(e){var t=this.gl,o=this,i=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];r(t,i,function(t){var i=o.computeMeshVertices_(o.meshWidth,o.meshHeight,e);if(t.bindBuffer(t.ARRAY_BUFFER,o.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),!o.indexCount){var n=o.computeMeshIndices_(o.meshWidth,o.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW),o.indexCount=n.length}})},l.prototype.computeMeshVertices_=function(e,t,o){for(var i=new Float32Array(2*e*t*5),r=o.getLeftEyeVisibleTanAngles(),s=o.getLeftEyeNoLensTanAngles(),a=o.getLeftEyeVisibleScreenRect(s),l=0,c=0;c<2;c++){for(var u=0;u<t;u++)for(var h=0;h<e;h++,l++){var g=h/(e-1),d=u/(t-1),p=g,f=d,m=n.lerp(r[0],r[2],g),y=n.lerp(r[3],r[1],d),v=Math.sqrt(m*m+y*y),E=o.distortion.distortInverse(v),_=m*E/v,T=y*E/v;g=(_-s[0])/(s[2]-s[0]),d=(T-s[3])/(s[1]-s[3]),o.device.widthMeters,o.device.heightMeters,g=2*(a.x+g*a.width-.5),d=2*(a.y+d*a.height-.5),i[5*l+0]=g,i[5*l+1]=d,i[5*l+2]=p,i[5*l+3]=f,i[5*l+4]=c}var b=r[2]-r[0];r[0]=-(b+r[0]),r[2]=b-r[2],b=s[2]-s[0],s[0]=-(b+s[0]),s[2]=b-s[2],a.x=1-(a.x+a.width)}return i},l.prototype.computeMeshIndices_=function(e,t){for(var o=new Uint16Array(2*(e-1)*(t-1)*6),i=e/2,n=t/2,r=0,s=0,a=0;a<2;a++)for(var l=0;l<t;l++)for(var c=0;c<e;c++,r++)0!=c&&0!=l&&(c<=i==l<=n?(o[s++]=r,o[s++]=r-e-1,o[s++]=r-e,o[s++]=r-e-1,o[s++]=r,o[s++]=r-1):(o[s++]=r-1,o[s++]=r-e,o[s++]=r,o[s++]=r-e,o[s++]=r-1,o[s++]=r-e-1));return o},l.prototype.getOwnPropertyDescriptor_=function(e,t){var o=Object.getOwnPropertyDescriptor(e,t);return void 0!==o.get&&void 0!==o.set||(o.configurable=!0,o.enumerable=!0,o.get=function(){return this.getAttribute(t)},o.set=function(e){this.setAttribute(t,e)}),o},t.exports=l},{"./cardboard-ui.js":50,"./deps/wglu-preserve-state.js":52,"./util.js":68}],50:[function(e,t,o){var i=e("./util.js"),n=e("./deps/wglu-preserve-state.js"),r=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),s=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),a=Math.PI/180,l=.3125;function c(e){this.gl=e,this.attribs={position:0},this.program=i.linkProgram(e,r,s,this.attribs),this.uniforms=i.getProgramUniforms(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}c.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},c.prototype.listen=function(e,t){var o=this.gl.canvas;this.listener=function(i){var n=o.clientWidth/2;i.clientX>n-42&&i.clientX<n+42&&i.clientY>o.clientHeight-42?e(i):i.clientX<42&&i.clientY<42&&t(i)},o.addEventListener("click",this.listener,!1)},c.prototype.onResize=function(){var e=this.gl,t=this,o=[e.ARRAY_BUFFER_BINDING];n(e,o,function(e){var o=[],i=e.drawingBufferWidth/2,n=Math.max(screen.width,screen.height)*window.devicePixelRatio,r=e.drawingBufferWidth/n,s=r*window.devicePixelRatio,c=4*s/2,u=42*s,h=28*s/2,g=14*s;function d(e,t){var n=(90-e)*a,r=Math.cos(n),s=Math.sin(n);o.push(l*r*h+i,l*s*h+h),o.push(t*r*h+i,t*s*h+h)}o.push(i-c,u),o.push(i-c,e.drawingBufferHeight),o.push(i+c,u),o.push(i+c,e.drawingBufferHeight),t.gearOffset=o.length/2;for(var p=0;p<=6;p++){var f=60*p;d(f,1),d(f+12,1),d(f+20,.75),d(f+40,.75),d(f+48,1)}function m(t,i){o.push(g+t,e.drawingBufferHeight-g-i)}t.gearVertexCount=o.length/2-t.gearOffset,t.arrowOffset=o.length/2;var y=c/Math.sin(45*a);m(0,h),m(h,0),m(h+y,y),m(y,h+y),m(y,h-y),m(0,h),m(h,2*h),m(h+y,2*h-y),m(y,h-y),m(0,h),m(y,h-c),m(28*s,h-c),m(y,h+c),m(28*s,h+c),t.arrowVertexCount=o.length/2-t.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW)})},c.prototype.render=function(){var e=this.gl,t=this,o=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];n(e,o,function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()})},c.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,8,0),e.uniform4f(this.uniforms.color,1,1,1,1),i.orthoMatrix(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024),e.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},t.exports=c},{"./deps/wglu-preserve-state.js":52,"./util.js":68}],51:[function(e,t,o){var i=e("./cardboard-distorter.js"),n=e("./cardboard-ui.js"),r=e("./device-info.js"),s=e("./dpdb/dpdb.js"),a=e("./sensor-fusion/fusion-pose-sensor.js"),l=e("./rotate-instructions.js"),c=e("./viewer-selector.js"),u=e("./base.js").VRDisplay,h=e("./util.js"),g={LEFT:"left",RIGHT:"right"};function d(){this.displayName="Cardboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,this.capabilities.canPresent=!0,this.bufferScale_=window.WebVRConfig.BUFFER_SCALE,this.poseSensor_=new a,this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new s(!0,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new r(this.dpdb_.getDeviceParams()),this.viewerSelector_=new c,this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),window.WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new l),h.isIOS()&&window.addEventListener("resize",this.onResize_.bind(this))}d.prototype=new u,d.prototype.getImmediatePose=function(){return{position:this.poseSensor_.getPosition(),orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},d.prototype.resetPose=function(){this.poseSensor_.resetPose()},d.prototype.getEyeParameters=function(e){var t,o=[.5*this.deviceInfo_.viewer.interLensDistance,0,0];if(e==g.LEFT)o[0]*=-1,t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=g.RIGHT)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return{fieldOfView:t,offset:o,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_}},d.prototype.onDeviceParamsUpdated_=function(e){h.isDebug()&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},d.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},d.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?window.WebVRConfig.CARDBOARD_UI_DISABLED||(e.canvas.width=h.getScreenWidth()*this.bufferScale_,e.canvas.height=h.getScreenHeight()*this.bufferScale_,this.cardboardUI_=new n(e)):(this.distorter_=new i(e),this.distorter_.updateDeviceInfo(this.deviceInfo_),this.cardboardUI_=this.distorter_.cardboardUI),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(h.isLandscapeMode()&&h.isMobile()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},d.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},d.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl").canvas;t.width==this.lastWidth&&t.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=t.width,this.lastHeight=t.height,this.cardboardUI_.render()}},d.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},d.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl"),o=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0 10px 10px 0","box-sizing: content-box"];t.canvas.setAttribute("style",o.join("; ")+";"),h.safariCssSizeWorkaround(t.canvas)}},d.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},d.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},t.exports=d},{"./base.js":48,"./cardboard-distorter.js":49,"./cardboard-ui.js":50,"./device-info.js":53,"./dpdb/dpdb.js":57,"./rotate-instructions.js":62,"./sensor-fusion/fusion-pose-sensor.js":64,"./util.js":68,"./viewer-selector.js":69}],52:[function(e,t,o){t.exports=function(e,t,o){if(t){for(var i=[],n=null,r=0;r<t.length;++r){var s=t[r];switch(s){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:var a=t[++r];if(a<e.TEXTURE0||a>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),i.push(null,null);break}n||(n=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(a),i.push(e.getParameter(s),null);break;case e.ACTIVE_TEXTURE:n=e.getParameter(e.ACTIVE_TEXTURE),i.push(null);break;default:i.push(e.getParameter(s))}}o(e);for(var r=0;r<t.length;++r){var s=t[r],l=i[r];switch(s){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,l);break;case e.COLOR_CLEAR_VALUE:e.clearColor(l[0],l[1],l[2],l[3]);break;case e.COLOR_WRITEMASK:e.colorMask(l[0],l[1],l[2],l[3]);break;case e.CURRENT_PROGRAM:e.useProgram(l);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,l);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,l);break;case e.TEXTURE_BINDING_2D:var a=t[++r];if(a<e.TEXTURE0||a>e.TEXTURE31)break;e.activeTexture(a),e.bindTexture(e.TEXTURE_2D,l);break;case e.TEXTURE_BINDING_CUBE_MAP:var a=t[++r];if(a<e.TEXTURE0||a>e.TEXTURE31)break;e.activeTexture(a),e.bindTexture(e.TEXTURE_CUBE_MAP,l);break;case e.VIEWPORT:e.viewport(l[0],l[1],l[2],l[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:l?e.enable(s):e.disable(s);break;default:console.log("No GL restore behavior for 0x"+s.toString(16))}n&&e.activeTexture(n)}}else o(e)}},{}],53:[function(e,t,o){var i=e("./distortion/distortion.js"),n=e("./math-util.js"),r=e("./util.js");function s(e){this.width=e.width||r.getScreenWidth(),this.height=e.height||r.getScreenHeight(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}var a=new s({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),l=new s({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),c={CardboardV1:new h({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new h({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function u(e){this.viewer=c.CardboardV2,this.updateDeviceParams(e),this.distortion=new i(this.viewer.distortionCoefficients)}function h(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}u.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},u.prototype.getDevice=function(){return this.device},u.prototype.setViewer=function(e){this.viewer=e,this.distortion=new i(this.viewer.distortionCoefficients)},u.prototype.determineDevice_=function(e){if(!e)return r.isIOS()?(console.warn("Using fallback iOS device measurements."),l):(console.warn("Using fallback Android device measurements."),a);var t=.0254/e.xdpi,o=.0254/e.ydpi,i=r.getScreenWidth(),n=r.getScreenHeight();return new s({widthMeters:t*i,heightMeters:o*n,bevelMeters:.001*e.bevelMm})},u.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,o=this.distortion,i=e.screenLensDistance,r=(t.widthMeters-e.interLensDistance)/2,s=e.interLensDistance/2,a=e.baselineLensDistance-t.bevelMeters,l=t.heightMeters-a,c=n.radToDeg*Math.atan(o.distort(r/i)),u=n.radToDeg*Math.atan(o.distort(s/i)),h=n.radToDeg*Math.atan(o.distort(a/i)),g=n.radToDeg*Math.atan(o.distort(l/i));return{leftDegrees:Math.min(c,e.fov),rightDegrees:Math.min(u,e.fov),downDegrees:Math.min(h,e.fov),upDegrees:Math.min(g,e.fov)}},u.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,o=this.distortion,i=Math.tan(-n.degToRad*e.fov),r=Math.tan(n.degToRad*e.fov),s=Math.tan(n.degToRad*e.fov),a=Math.tan(-n.degToRad*e.fov),l=t.widthMeters/4,c=t.heightMeters/2,u=e.baselineLensDistance-t.bevelMeters-c,h=e.interLensDistance/2-l,g=-u,d=e.screenLensDistance,p=o.distort((h-l)/d),f=o.distort((g+c)/d),m=o.distort((h+l)/d),y=o.distort((g-c)/d),v=new Float32Array(4);return v[0]=Math.max(i,p),v[1]=Math.min(r,f),v[2]=Math.min(s,m),v[3]=Math.max(a,y),v},u.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,o=this.distortion,i=new Float32Array(4),r=o.distortInverse(Math.tan(-n.degToRad*e.fov)),s=o.distortInverse(Math.tan(n.degToRad*e.fov)),a=o.distortInverse(Math.tan(n.degToRad*e.fov)),l=o.distortInverse(Math.tan(-n.degToRad*e.fov)),c=t.widthMeters/4,u=t.heightMeters/2,h=e.baselineLensDistance-t.bevelMeters-u,g=e.interLensDistance/2-c,d=-h,p=e.screenLensDistance,f=(g-c)/p,m=(d+u)/p,y=(g+c)/p,v=(d-u)/p;return i[0]=Math.max(r,f),i[1]=Math.min(s,m),i[2]=Math.min(a,y),i[3]=Math.max(l,v),i},u.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,o=this.device,i=t.screenLensDistance,n=(o.widthMeters-t.interLensDistance)/2,r=t.baselineLensDistance-o.bevelMeters,s=(e[0]*i+n)/o.widthMeters,a=(e[1]*i+r)/o.heightMeters,l=(e[2]*i+n)/o.widthMeters,c=(e[3]*i+r)/o.heightMeters;return{x:s,y:c,width:l-s,height:a-c}},u.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},u.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},u.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:n.radToDeg*Math.atan(e.outerDist),rightDegrees:n.radToDeg*Math.atan(e.innerDist),downDegrees:n.radToDeg*Math.atan(e.bottomDist),upDegrees:n.radToDeg*Math.atan(e.topDist)}},u.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,o=this.device,i=t.screenLensDistance,n=o.widthMeters/i,r=o.heightMeters/i,s=o.width/n,a=o.height/r,l=Math.round((e.eyePosX-e.outerDist)*s),c=Math.round((e.eyePosY-e.bottomDist)*a);return{x:l,y:c,width:Math.round((e.eyePosX+e.innerDist)*s)-l,height:Math.round((e.eyePosY+e.topDist)*a)-c}},u.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,o=this.distortion,i=e.screenLensDistance,r=e.interLensDistance/2/i,s=t.widthMeters/i,a=t.heightMeters/i,l=s/2-r,c=(e.baselineLensDistance-t.bevelMeters)/i,u=e.fov,h=o.distortInverse(Math.tan(n.degToRad*u)),g=Math.min(l,h),d=Math.min(r,h),p=Math.min(c,h),f=Math.min(a-c,h);return{outerDist:g,innerDist:d,topDist:f,bottomDist:p,eyePosX:l,eyePosY:c}},u.Viewers=c,t.exports=u},{"./distortion/distortion.js":55,"./math-util.js":59,"./util.js":68}],54:[function(e,t,o){e("./base.js").VRDisplay;var i=e("./base.js").HMDVRDevice,n=e("./base.js").PositionSensorVRDevice;function r(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:HMD:"+e.displayId,this.deviceName=e.displayName+" (HMD)"}function s(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:PositionSensor: "+e.displayId,this.deviceName=e.displayName+" (PositionSensor)"}r.prototype=new i,r.prototype.getEyeParameters=function(e){var t=this.display.getEyeParameters(e);return{currentFieldOfView:t.fieldOfView,maximumFieldOfView:t.fieldOfView,minimumFieldOfView:t.fieldOfView,recommendedFieldOfView:t.fieldOfView,eyeTranslation:{x:t.offset[0],y:t.offset[1],z:t.offset[2]},renderRect:{x:"right"==e?t.renderWidth:0,y:0,width:t.renderWidth,height:t.renderHeight}}},r.prototype.setFieldOfView=function(e,t,o,i){},s.prototype=new n,s.prototype.getState=function(){var e=this.display.getPose();return{position:e.position?{x:e.position[0],y:e.position[1],z:e.position[2]}:null,orientation:e.orientation?{x:e.orientation[0],y:e.orientation[1],z:e.orientation[2],w:e.orientation[3]}:null,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},s.prototype.resetState=function(){return this.positionDevice.resetPose()},t.exports.VRDisplayHMDDevice=r,t.exports.VRDisplayPositionSensorDevice=s},{"./base.js":48}],55:[function(e,t,o){function i(e){this.coefficients=e}i.prototype.distortInverse=function(e){for(var t=0,o=1,i=e-this.distort(t);Math.abs(o-t)>1e-4;){var n=e-this.distort(o),r=o-n*((o-t)/(n-i));t=o,o=r,i=n}return o},i.prototype.distort=function(e){for(var t=e*e,o=0,i=0;i<this.coefficients.length;i++)o=t*(o+this.coefficients[i]);return(o+1)*e},t.exports=i},{}],56:[function(e,t,o){t.exports={format:1,last_updated:"2017-08-27T14:39:31Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}},{}],57:[function(e,t,o){var i=e("./dpdb.json"),n=e("../util.js"),r="https://dpdb.webvr.rocks/dpdb.json";function s(e,t){if(this.dpdb=i,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var o=new XMLHttpRequest,n=this;o.open("GET",r,!0),o.addEventListener("load",function(){n.loading=!1,o.status>=200&&o.status<=299?(n.dpdb=JSON.parse(o.response),n.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),o.send()}}function a(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}s.prototype.getDeviceParams=function(){return this.deviceParams},s.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},s.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,o=n.getScreenWidth(),i=n.getScreenHeight();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var r=0;r<e.devices.length;r++){var s=e.devices[r];if(s.rules)if("ios"==s.type||"android"==s.type){if(n.isIOS()==("ios"==s.type)){for(var l=!1,c=0;c<s.rules.length;c++){var u=s.rules[c];if(this.matchRule_(u,t,o,i)){l=!0;break}}if(l){var h=s.dpi[0]||s.dpi,g=s.dpi[1]||s.dpi;return new a({xdpi:h,ydpi:g,bevelMm:s.bw})}}}else console.warn("Device["+r+"] has invalid type.");else console.warn("Device["+r+"] has no rules section.")}return console.warn("No DPDB device match."),null},s.prototype.matchRule_=function(e,t,o,i){if(!e.ua&&!e.res)return!1;if(e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var n=e.res[0],r=e.res[1];if(Math.min(o,i)!=Math.min(n,r)||Math.max(o,i)!=Math.max(n,r))return!1}return!0},t.exports=s},{"../util.js":68,"./dpdb.json":56}],58:[function(e,t,o){var i=e("./util.js"),n=e("./webvr-polyfill.js").WebVRPolyfill;window.WebVRConfig=i.extend({FORCE_ENABLE_VR:!1,K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!0,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!1,DEFER_INITIALIZATION:!1,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1,ALWAYS_APPEND_POLYFILL_DISPLAY:!1,GET_VR_DISPLAYS_TIMEOUT:1e3},window.WebVRConfig),window.WebVRConfig.DEFER_INITIALIZATION?window.InitializeWebVRPolyfill=function(){new n}:new n,window.WebVRPolyfill=n},{"./util.js":68,"./webvr-polyfill.js":71}],59:[function(e,t,o){var i,n,r=window.MathUtil||{};r.degToRad=Math.PI/180,r.radToDeg=180/Math.PI,r.Vector2=function(e,t){this.x=e||0,this.y=t||0},r.Vector2.prototype={constructor:r.Vector2,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},r.Vector3=function(e,t,o){this.x=e||0,this.y=t||0,this.z=o||0},r.Vector3.prototype={constructor:r.Vector3,set:function(e,t,o){return this.x=e,this.y=t,this.z=o,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,o=this.y,i=this.z,n=e.x,r=e.y,s=e.z,a=e.w,l=a*t+r*i-s*o,c=a*o+s*t-n*i,u=a*i+n*o-r*t,h=-n*t-r*o-s*i;return this.x=l*a+h*-n+c*-s-u*-r,this.y=c*a+h*-r+u*-n-l*-s,this.z=u*a+h*-s+l*-r-c*-n,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var o=e.x,i=e.y,n=e.z,r=t.x,s=t.y,a=t.z;return this.x=i*a-n*s,this.y=n*r-o*a,this.z=o*s-i*r,this}},r.Quaternion=function(e,t,o,i){this.x=e||0,this.y=t||0,this.z=o||0,this.w=void 0!==i?i:1},r.Quaternion.prototype={constructor:r.Quaternion,set:function(e,t,o,i){return this.x=e,this.y=t,this.z=o,this.w=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,o){var i=Math.cos(e/2),n=Math.cos(t/2),r=Math.cos(o/2),s=Math.sin(e/2),a=Math.sin(t/2),l=Math.sin(o/2);return this.x=s*n*r+i*a*l,this.y=i*a*r-s*n*l,this.z=i*n*l+s*a*r,this.w=i*n*r-s*a*l,this},setFromEulerYXZ:function(e,t,o){var i=Math.cos(e/2),n=Math.cos(t/2),r=Math.cos(o/2),s=Math.sin(e/2),a=Math.sin(t/2),l=Math.sin(o/2);return this.x=s*n*r+i*a*l,this.y=i*a*r-s*n*l,this.z=i*n*l-s*a*r,this.w=i*n*r+s*a*l,this},setFromAxisAngle:function(e,t){var o=t/2,i=Math.sin(o);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(o),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var o=e.x,i=e.y,n=e.z,r=e.w,s=t.x,a=t.y,l=t.z,c=t.w;return this.x=o*c+r*s+i*l-n*a,this.y=i*c+r*a+n*s-o*l,this.z=n*c+r*l+o*a-i*s,this.w=r*c-o*s-i*a-n*l,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var o=this.x,i=this.y,n=this.z,r=this.w,s=r*e.w+o*e.x+i*e.y+n*e.z;if(s<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,s=-s):this.copy(e),s>=1)return this.w=r,this.x=o,this.y=i,this.z=n,this;var a=Math.acos(s),l=Math.sqrt(1-s*s);if(Math.abs(l)<.001)return this.w=.5*(r+this.w),this.x=.5*(o+this.x),this.y=.5*(i+this.y),this.z=.5*(n+this.z),this;var c=Math.sin((1-t)*a)/l,u=Math.sin(t*a)/l;return this.w=r*c+this.w*u,this.x=o*c+this.x*u,this.y=i*c+this.y*u,this.z=n*c+this.z*u,this},setFromUnitVectors:function(e,t){return void 0===i&&(i=new r.Vector3),(n=e.dot(t)+1)<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?i.set(-e.y,e.x,0):i.set(0,-e.z,e.y)):i.crossVectors(e,t),this.x=i.x,this.y=i.y,this.z=i.z,this.w=n,this.normalize(),this}},t.exports=r},{}],60:[function(e,t,o){var i=e("./base.js").VRDisplay,n=e("./math-util.js"),r=e("./util.js");function s(){this.displayName="Mouse and Keyboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,window.addEventListener("keydown",this.onKeyDown_.bind(this)),window.addEventListener("mousemove",this.onMouseMove_.bind(this)),window.addEventListener("mousedown",this.onMouseDown_.bind(this)),window.addEventListener("mouseup",this.onMouseUp_.bind(this)),this.phi_=0,this.theta_=0,this.targetAngle_=null,this.angleAnimation_=null,this.orientation_=new n.Quaternion,this.rotateStart_=new n.Vector2,this.rotateEnd_=new n.Vector2,this.rotateDelta_=new n.Vector2,this.isDragging_=!1,this.orientationOut_=new Float32Array(4)}s.prototype=new i,s.prototype.getImmediatePose=function(){return this.orientation_.setFromEulerYXZ(this.phi_,this.theta_,0),this.orientationOut_[0]=this.orientation_.x,this.orientationOut_[1]=this.orientation_.y,this.orientationOut_[2]=this.orientation_.z,this.orientationOut_[3]=this.orientation_.w,{position:null,orientation:this.orientationOut_,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},s.prototype.onKeyDown_=function(e){38==e.keyCode?this.animatePhi_(this.phi_+.15):39==e.keyCode?this.animateTheta_(this.theta_-.15):40==e.keyCode?this.animatePhi_(this.phi_-.15):37==e.keyCode&&this.animateTheta_(this.theta_+.15)},s.prototype.animateTheta_=function(e){this.animateKeyTransitions_("theta_",e)},s.prototype.animatePhi_=function(e){e=r.clamp(e,-Math.PI/2,Math.PI/2),this.animateKeyTransitions_("phi_",e)},s.prototype.animateKeyTransitions_=function(e,t){this.angleAnimation_&&cancelAnimationFrame(this.angleAnimation_);var o=this[e],i=new Date;this.angleAnimation_=requestAnimationFrame(function n(){var r=new Date-i;if(r>=80)return this[e]=t,void cancelAnimationFrame(this.angleAnimation_);this.angleAnimation_=requestAnimationFrame(n.bind(this));var s=r/80;this[e]=o+(t-o)*s}.bind(this))},s.prototype.onMouseDown_=function(e){this.rotateStart_.set(e.clientX,e.clientY),this.isDragging_=!0},s.prototype.onMouseMove_=function(e){if(this.isDragging_||this.isPointerLocked_()){if(this.isPointerLocked_()){var t=e.movementX||e.mozMovementX||0,o=e.movementY||e.mozMovementY||0;this.rotateEnd_.set(this.rotateStart_.x-t,this.rotateStart_.y-o)}else this.rotateEnd_.set(e.clientX,e.clientY);this.rotateDelta_.subVectors(this.rotateEnd_,this.rotateStart_),this.rotateStart_.copy(this.rotateEnd_),this.phi_+=2*Math.PI*this.rotateDelta_.y/screen.height*.3,this.theta_+=2*Math.PI*this.rotateDelta_.x/screen.width*.5,this.phi_=r.clamp(this.phi_,-Math.PI/2,Math.PI/2)}},s.prototype.onMouseUp_=function(e){this.isDragging_=!1},s.prototype.isPointerLocked_=function(){var e=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;return void 0!==e},s.prototype.resetPose=function(){this.phi_=0,this.theta_=0},t.exports=s},{"./base.js":48,"./math-util.js":59,"./util.js":68}],61:[function(e,t,i){(function(t){void 0!==t&&t.window&&(t.document=t.window.document,t.navigator=t.window.navigator),e("./main")}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./main":58}],62:[function(e,t,o){var i=e("./util.js");function n(){this.loadIcon_();var e=document.createElement("div"),t=e.style;t.position="fixed",t.top=0,t.right=0,t.bottom=0,t.left=0,t.backgroundColor="gray",t.fontFamily="sans-serif",t.zIndex=1e6;var o=document.createElement("img");o.src=this.icon;var t=o.style;t.marginLeft="25%",t.marginTop="25%",t.width="50%",e.appendChild(o);var i=document.createElement("div"),t=i.style;t.textAlign="center",t.fontSize="16px",t.lineHeight="24px",t.margin="24px 25%",t.width="50%",i.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(i);var n=document.createElement("div"),t=n.style;t.backgroundColor="#CFD8DC",t.position="fixed",t.bottom=0,t.width="100%",t.height="48px",t.padding="14px 24px",t.boxSizing="border-box",t.color="#656A6B",e.appendChild(n);var r=document.createElement("div");r.style.float="left",r.innerHTML="No Cardboard viewer?";var s=document.createElement("a");s.href="https://www.google.com/get/cardboard/get-cardboard/",s.innerHTML="get one",s.target="_blank";var t=s.style;t.float="right",t.fontWeight=600,t.textTransform="uppercase",t.borderLeft="1px solid gray",t.paddingLeft="24px",t.textDecoration="none",t.color="#656A6B",n.appendChild(r),n.appendChild(s),this.overlay=e,this.text=i,this.hide()}n.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img"),o=t.style;i.isLandscapeMode()?(o.width="20%",o.marginLeft="40%",o.marginTop="3%"):(o.width="50%",o.marginLeft="25%",o.marginTop="25%")},n.prototype.hide=function(){this.overlay.style.display="none"},n.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},n.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},n.prototype.update=function(){this.disableShowTemporarily(),!i.isLandscapeMode()&&i.isMobile()?this.show():this.hide()},n.prototype.loadIcon_=function(){this.icon=i.base64("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE5OHB4IiBoZWlnaHQ9IjI0MHB4IiB2aWV3Qm94PSIwIDAgMTk4IDI0MCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuMy4zICgxMjA4MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+dHJhbnNpdGlvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPgogICAgICAgIDxnIGlkPSJ0cmFuc2l0aW9uIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIj4KICAgICAgICAgICAgPGcgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTQtKy1JbXBvcnRlZC1MYXllcnMtQ29weS0rLUltcG9ydGVkLUxheWVycy1Db3B5LTItQ29weSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwNy4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjYyNSwyLjUyNyBDMTQ5LjYyNSwyLjUyNyAxNTUuODA1LDYuMDk2IDE1Ni4zNjIsNi40MTggTDE1Ni4zNjIsNy4zMDQgQzE1Ni4zNjIsNy40ODEgMTU2LjM3NSw3LjY2NCAxNTYuNCw3Ljg1MyBDMTU2LjQxLDcuOTM0IDE1Ni40Miw4LjAxNSAxNTYuNDI3LDguMDk1IEMxNTYuNTY3LDkuNTEgMTU3LjQwMSwxMS4wOTMgMTU4LjUzMiwxMi4wOTQgTDE2NC4yNTIsMTcuMTU2IEwxNjQuMzMzLDE3LjA2NiBDMTY0LjMzMywxNy4wNjYgMTY4LjcxNSwxNC41MzYgMTY5LjU2OCwxNC4wNDIgQzE3MS4wMjUsMTQuODgzIDE5NS41MzgsMjkuMDM1IDE5NS41MzgsMjkuMDM1IEwxOTUuNTM4LDgzLjAzNiBDMTk1LjUzOCw4My44MDcgMTk1LjE1Miw4NC4yNTMgMTk0LjU5LDg0LjI1MyBDMTk0LjM1Nyw4NC4yNTMgMTk0LjA5NSw4NC4xNzcgMTkzLjgxOCw4NC4wMTcgTDE2OS44NTEsNzAuMTc5IEwxNjkuODM3LDcwLjIwMyBMMTQyLjUxNSw4NS45NzggTDE0MS42NjUsODQuNjU1IEMxMzYuOTM0LDgzLjEyNiAxMzEuOTE3LDgxLjkxNSAxMjYuNzE0LDgxLjA0NSBDMTI2LjcwOSw4MS4wNiAxMjYuNzA3LDgxLjA2OSAxMjYuNzA3LDgxLjA2OSBMMTIxLjY0LDk4LjAzIEwxMTMuNzQ5LDEwMi41ODYgTDExMy43MTIsMTAyLjUyMyBMMTEzLjcxMiwxMzAuMTEzIEMxMTMuNzEyLDEzMC44ODUgMTEzLjMyNiwxMzEuMzMgMTEyLjc2NCwxMzEuMzMgQzExMi41MzIsMTMxLjMzIDExMi4yNjksMTMxLjI1NCAxMTEuOTkyLDEzMS4wOTQgTDY5LjUxOSwxMDYuNTcyIEM2OC41NjksMTA2LjAyMyA2Ny43OTksMTA0LjY5NSA2Ny43OTksMTAzLjYwNSBMNjcuNzk5LDEwMi41NyBMNjcuNzc4LDEwMi42MTcgQzY3LjI3LDEwMi4zOTMgNjYuNjQ4LDEwMi4yNDkgNjUuOTYyLDEwMi4yMTggQzY1Ljg3NSwxMDIuMjE0IDY1Ljc4OCwxMDIuMjEyIDY1LjcwMSwxMDIuMjEyIEM2NS42MDYsMTAyLjIxMiA2NS41MTEsMTAyLjIxNSA2NS40MTYsMTAyLjIxOSBDNjUuMTk1LDEwMi4yMjkgNjQuOTc0LDEwMi4yMzUgNjQuNzU0LDEwMi4yMzUgQzY0LjMzMSwxMDIuMjM1IDYzLjkxMSwxMDIuMjE2IDYzLjQ5OCwxMDIuMTc4IEM2MS44NDMsMTAyLjAyNSA2MC4yOTgsMTAxLjU3OCA1OS4wOTQsMTAwLjg4MiBMMTIuNTE4LDczLjk5MiBMMTIuNTIzLDc0LjAwNCBMMi4yNDUsNTUuMjU0IEMxLjI0NCw1My40MjcgMi4wMDQsNTEuMDM4IDMuOTQzLDQ5LjkxOCBMNTkuOTU0LDE3LjU3MyBDNjAuNjI2LDE3LjE4NSA2MS4zNSwxNy4wMDEgNjIuMDUzLDE3LjAwMSBDNjMuMzc5LDE3LjAwMSA2NC42MjUsMTcuNjYgNjUuMjgsMTguODU0IEw2NS4yODUsMTguODUxIEw2NS41MTIsMTkuMjY0IEw2NS41MDYsMTkuMjY4IEM2NS45MDksMjAuMDAzIDY2LjQwNSwyMC42OCA2Ni45ODMsMjEuMjg2IEw2Ny4yNiwyMS41NTYgQzY5LjE3NCwyMy40MDYgNzEuNzI4LDI0LjM1NyA3NC4zNzMsMjQuMzU3IEM3Ni4zMjIsMjQuMzU3IDc4LjMyMSwyMy44NCA4MC4xNDgsMjIuNzg1IEM4MC4xNjEsMjIuNzg1IDg3LjQ2NywxOC41NjYgODcuNDY3LDE4LjU2NiBDODguMTM5LDE4LjE3OCA4OC44NjMsMTcuOTk0IDg5LjU2NiwxNy45OTQgQzkwLjg5MiwxNy45OTQgOTIuMTM4LDE4LjY1MiA5Mi43OTIsMTkuODQ3IEw5Ni4wNDIsMjUuNzc1IEw5Ni4wNjQsMjUuNzU3IEwxMDIuODQ5LDI5LjY3NCBMMTAyLjc0NCwyOS40OTIgTDE0OS42MjUsMi41MjcgTTE0OS42MjUsMC44OTIgQzE0OS4zNDMsMC44OTIgMTQ5LjA2MiwwLjk2NSAxNDguODEsMS4xMSBMMTAyLjY0MSwyNy42NjYgTDk3LjIzMSwyNC41NDIgTDk0LjIyNiwxOS4wNjEgQzkzLjMxMywxNy4zOTQgOTEuNTI3LDE2LjM1OSA4OS41NjYsMTYuMzU4IEM4OC41NTUsMTYuMzU4IDg3LjU0NiwxNi42MzIgODYuNjQ5LDE3LjE1IEM4My44NzgsMTguNzUgNzkuNjg3LDIxLjE2OSA3OS4zNzQsMjEuMzQ1IEM3OS4zNTksMjEuMzUzIDc5LjM0NSwyMS4zNjEgNzkuMzMsMjEuMzY5IEM3Ny43OTgsMjIuMjU0IDc2LjA4NCwyMi43MjIgNzQuMzczLDIyLjcyMiBDNzIuMDgxLDIyLjcyMiA2OS45NTksMjEuODkgNjguMzk3LDIwLjM4IEw2OC4xNDUsMjAuMTM1IEM2Ny43MDYsMTkuNjcyIDY3LjMyMywxOS4xNTYgNjcuMDA2LDE4LjYwMSBDNjYuOTg4LDE4LjU1OSA2Ni45NjgsMTguNTE5IDY2Ljk0NiwxOC40NzkgTDY2LjcxOSwxOC4wNjUgQzY2LjY5LDE4LjAxMiA2Ni42NTgsMTcuOTYgNjYuNjI0LDE3LjkxMSBDNjUuNjg2LDE2LjMzNyA2My45NTEsMTUuMzY2IDYyLjA1MywxNS4zNjYgQzYxLjA0MiwxNS4zNjYgNjAuMDMzLDE1LjY0IDU5LjEzNiwxNi4xNTggTDMuMTI1LDQ4LjUwMiBDMC40MjYsNTAuMDYxIC0wLjYxMyw1My40NDIgMC44MTEsNTYuMDQgTDExLjA4OSw3NC43OSBDMTEuMjY2LDc1LjExMyAxMS41MzcsNzUuMzUzIDExLjg1LDc1LjQ5NCBMNTguMjc2LDEwMi4yOTggQzU5LjY3OSwxMDMuMTA4IDYxLjQzMywxMDMuNjMgNjMuMzQ4LDEwMy44MDYgQzYzLjgxMiwxMDMuODQ4IDY0LjI4NSwxMDMuODcgNjQuNzU0LDEwMy44NyBDNjUsMTAzLjg3IDY1LjI0OSwxMDMuODY0IDY1LjQ5NCwxMDMuODUyIEM2NS41NjMsMTAzLjg0OSA2NS42MzIsMTAzLjg0NyA2NS43MDEsMTAzLjg0NyBDNjUuNzY0LDEwMy44NDcgNjUuODI4LDEwMy44NDkgNjUuODksMTAzLjg1MiBDNjUuOTg2LDEwMy44NTYgNjYuMDgsMTAzLjg2MyA2Ni4xNzMsMTAzLjg3NCBDNjYuMjgyLDEwNS40NjcgNjcuMzMyLDEwNy4xOTcgNjguNzAyLDEwNy45ODggTDExMS4xNzQsMTMyLjUxIEMxMTEuNjk4LDEzMi44MTIgMTEyLjIzMiwxMzIuOTY1IDExMi43NjQsMTMyLjk2NSBDMTE0LjI2MSwxMzIuOTY1IDExNS4zNDcsMTMxLjc2NSAxMTUuMzQ3LDEzMC4xMTMgTDExNS4zNDcsMTAzLjU1MSBMMTIyLjQ1OCw5OS40NDYgQzEyMi44MTksOTkuMjM3IDEyMy4wODcsOTguODk4IDEyMy4yMDcsOTguNDk4IEwxMjcuODY1LDgyLjkwNSBDMTMyLjI3OSw4My43MDIgMTM2LjU1Nyw4NC43NTMgMTQwLjYwNyw4Ni4wMzMgTDE0MS4xNCw4Ni44NjIgQzE0MS40NTEsODcuMzQ2IDE0MS45NzcsODcuNjEzIDE0Mi41MTYsODcuNjEzIEMxNDIuNzk0LDg3LjYxMyAxNDMuMDc2LDg3LjU0MiAxNDMuMzMzLDg3LjM5MyBMMTY5Ljg2NSw3Mi4wNzYgTDE5Myw4NS40MzMgQzE5My41MjMsODUuNzM1IDE5NC4wNTgsODUuODg4IDE5NC41OSw4NS44ODggQzE5Ni4wODcsODUuODg4IDE5Ny4xNzMsODQuNjg5IDE5Ny4xNzMsODMuMDM2IEwxOTcuMTczLDI5LjAzNSBDMTk3LjE3MywyOC40NTEgMTk2Ljg2MSwyNy45MTEgMTk2LjM1NSwyNy42MTkgQzE5Ni4zNTUsMjcuNjE5IDE3MS44NDMsMTMuNDY3IDE3MC4zODUsMTIuNjI2IEMxNzAuMTMyLDEyLjQ4IDE2OS44NSwxMi40MDcgMTY5LjU2OCwxMi40MDcgQzE2OS4yODUsMTIuNDA3IDE2OS4wMDIsMTIuNDgxIDE2OC43NDksMTIuNjI3IEMxNjguMTQzLDEyLjk3OCAxNjUuNzU2LDE0LjM1NyAxNjQuNDI0LDE1LjEyNSBMMTU5LjYxNSwxMC44NyBDMTU4Ljc5NiwxMC4xNDUgMTU4LjE1NCw4LjkzNyAxNTguMDU0LDcuOTM0IEMxNTguMDQ1LDcuODM3IDE1OC4wMzQsNy43MzkgMTU4LjAyMSw3LjY0IEMxNTguMDA1LDcuNTIzIDE1Ny45OTgsNy40MSAxNTcuOTk4LDcuMzA0IEwxNTcuOTk4LDYuNDE4IEMxNTcuOTk4LDUuODM0IDE1Ny42ODYsNS4yOTUgMTU3LjE4MSw1LjAwMiBDMTU2LjYyNCw0LjY4IDE1MC40NDIsMS4xMTEgMTUwLjQ0MiwxLjExMSBDMTUwLjE4OSwwLjk2NSAxNDkuOTA3LDAuODkyIDE0OS42MjUsMC44OTIiIGlkPSJGaWxsLTEiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTYuMDI3LDI1LjYzNiBMMTQyLjYwMyw1Mi41MjcgQzE0My44MDcsNTMuMjIyIDE0NC41ODIsNTQuMTE0IDE0NC44NDUsNTUuMDY4IEwxNDQuODM1LDU1LjA3NSBMNjMuNDYxLDEwMi4wNTcgTDYzLjQ2LDEwMi4wNTcgQzYxLjgwNiwxMDEuOTA1IDYwLjI2MSwxMDEuNDU3IDU5LjA1NywxMDAuNzYyIEwxMi40ODEsNzMuODcxIEw5Ni4wMjcsMjUuNjM2IiBpZD0iRmlsbC0yIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYzLjQ2MSwxMDIuMTc0IEM2My40NTMsMTAyLjE3NCA2My40NDYsMTAyLjE3NCA2My40MzksMTAyLjE3MiBDNjEuNzQ2LDEwMi4wMTYgNjAuMjExLDEwMS41NjMgNTguOTk4LDEwMC44NjMgTDEyLjQyMiw3My45NzMgQzEyLjM4Niw3My45NTIgMTIuMzY0LDczLjkxNCAxMi4zNjQsNzMuODcxIEMxMi4zNjQsNzMuODMgMTIuMzg2LDczLjc5MSAxMi40MjIsNzMuNzcgTDk1Ljk2OCwyNS41MzUgQzk2LjAwNCwyNS41MTQgOTYuMDQ5LDI1LjUxNCA5Ni4wODUsMjUuNTM1IEwxNDIuNjYxLDUyLjQyNiBDMTQzLjg4OCw1My4xMzQgMTQ0LjY4Miw1NC4wMzggMTQ0Ljk1Nyw1NS4wMzcgQzE0NC45Nyw1NS4wODMgMTQ0Ljk1Myw1NS4xMzMgMTQ0LjkxNSw1NS4xNjEgQzE0NC45MTEsNTUuMTY1IDE0NC44OTgsNTUuMTc0IDE0NC44OTQsNTUuMTc3IEw2My41MTksMTAyLjE1OCBDNjMuNTAxLDEwMi4xNjkgNjMuNDgxLDEwMi4xNzQgNjMuNDYxLDEwMi4xNzQgTDYzLjQ2MSwxMDIuMTc0IFogTTEyLjcxNCw3My44NzEgTDU5LjExNSwxMDAuNjYxIEM2MC4yOTMsMTAxLjM0MSA2MS43ODYsMTAxLjc4MiA2My40MzUsMTAxLjkzNyBMMTQ0LjcwNyw1NS4wMTUgQzE0NC40MjgsNTQuMTA4IDE0My42ODIsNTMuMjg1IDE0Mi41NDQsNTIuNjI4IEw5Ni4wMjcsMjUuNzcxIEwxMi43MTQsNzMuODcxIEwxMi43MTQsNzMuODcxIFoiIGlkPSJGaWxsLTMiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ4LjMyNyw1OC40NzEgQzE0OC4xNDUsNTguNDggMTQ3Ljk2Miw1OC40OCAxNDcuNzgxLDU4LjQ3MiBDMTQ1Ljg4Nyw1OC4zODkgMTQ0LjQ3OSw1Ny40MzQgMTQ0LjYzNiw1Ni4zNCBDMTQ0LjY4OSw1NS45NjcgMTQ0LjY2NCw1NS41OTcgMTQ0LjU2NCw1NS4yMzUgTDYzLjQ2MSwxMDIuMDU3IEM2NC4wODksMTAyLjExNSA2NC43MzMsMTAyLjEzIDY1LjM3OSwxMDIuMDk5IEM2NS41NjEsMTAyLjA5IDY1Ljc0MywxMDIuMDkgNjUuOTI1LDEwMi4wOTggQzY3LjgxOSwxMDIuMTgxIDY5LjIyNywxMDMuMTM2IDY5LjA3LDEwNC4yMyBMMTQ4LjMyNyw1OC40NzEiIGlkPSJGaWxsLTQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNjkuMDcsMTA0LjM0NyBDNjkuMDQ4LDEwNC4zNDcgNjkuMDI1LDEwNC4zNCA2OS4wMDUsMTA0LjMyNyBDNjguOTY4LDEwNC4zMDEgNjguOTQ4LDEwNC4yNTcgNjguOTU1LDEwNC4yMTMgQzY5LDEwMy44OTYgNjguODk4LDEwMy41NzYgNjguNjU4LDEwMy4yODggQzY4LjE1MywxMDIuNjc4IDY3LjEwMywxMDIuMjY2IDY1LjkyLDEwMi4yMTQgQzY1Ljc0MiwxMDIuMjA2IDY1LjU2MywxMDIuMjA3IDY1LjM4NSwxMDIuMjE1IEM2NC43NDIsMTAyLjI0NiA2NC4wODcsMTAyLjIzMiA2My40NSwxMDIuMTc0IEM2My4zOTksMTAyLjE2OSA2My4zNTgsMTAyLjEzMiA2My4zNDcsMTAyLjA4MiBDNjMuMzM2LDEwMi4wMzMgNjMuMzU4LDEwMS45ODEgNjMuNDAyLDEwMS45NTYgTDE0NC41MDYsNTUuMTM0IEMxNDQuNTM3LDU1LjExNiAxNDQuNTc1LDU1LjExMyAxNDQuNjA5LDU1LjEyNyBDMTQ0LjY0Miw1NS4xNDEgMTQ0LjY2OCw1NS4xNyAxNDQuNjc3LDU1LjIwNCBDMTQ0Ljc4MSw1NS41ODUgMTQ0LjgwNiw1NS45NzIgMTQ0Ljc1MSw1Ni4zNTcgQzE0NC43MDYsNTYuNjczIDE0NC44MDgsNTYuOTk0IDE0NS4wNDcsNTcuMjgyIEMxNDUuNTUzLDU3Ljg5MiAxNDYuNjAyLDU4LjMwMyAxNDcuNzg2LDU4LjM1NSBDMTQ3Ljk2NCw1OC4zNjMgMTQ4LjE0Myw1OC4zNjMgMTQ4LjMyMSw1OC4zNTQgQzE0OC4zNzcsNTguMzUyIDE0OC40MjQsNTguMzg3IDE0OC40MzksNTguNDM4IEMxNDguNDU0LDU4LjQ5IDE0OC40MzIsNTguNTQ1IDE0OC4zODUsNTguNTcyIEw2OS4xMjksMTA0LjMzMSBDNjkuMTExLDEwNC4zNDIgNjkuMDksMTA0LjM0NyA2OS4wNywxMDQuMzQ3IEw2OS4wNywxMDQuMzQ3IFogTTY1LjY2NSwxMDEuOTc1IEM2NS43NTQsMTAxLjk3NSA2NS44NDIsMTAxLjk3NyA2NS45MywxMDEuOTgxIEM2Ny4xOTYsMTAyLjAzNyA2OC4yODMsMTAyLjQ2OSA2OC44MzgsMTAzLjEzOSBDNjkuMDY1LDEwMy40MTMgNjkuMTg4LDEwMy43MTQgNjkuMTk4LDEwNC4wMjEgTDE0Ny44ODMsNTguNTkyIEMxNDcuODQ3LDU4LjU5MiAxNDcuODExLDU4LjU5MSAxNDcuNzc2LDU4LjU4OSBDMTQ2LjUwOSw1OC41MzMgMTQ1LjQyMiw1OC4xIDE0NC44NjcsNTcuNDMxIEMxNDQuNTg1LDU3LjA5MSAxNDQuNDY1LDU2LjcwNyAxNDQuNTIsNTYuMzI0IEMxNDQuNTYzLDU2LjAyMSAxNDQuNTUyLDU1LjcxNiAxNDQuNDg4LDU1LjQxNCBMNjMuODQ2LDEwMS45NyBDNjQuMzUzLDEwMi4wMDIgNjQuODY3LDEwMi4wMDYgNjUuMzc0LDEwMS45ODIgQzY1LjQ3MSwxMDEuOTc3IDY1LjU2OCwxMDEuOTc1IDY1LjY2NSwxMDEuOTc1IEw2NS42NjUsMTAxLjk3NSBaIiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuMjA4LDU1LjEzNCBDMS4yMDcsNTMuMzA3IDEuOTY3LDUwLjkxNyAzLjkwNiw0OS43OTcgTDU5LjkxNywxNy40NTMgQzYxLjg1NiwxNi4zMzMgNjQuMjQxLDE2LjkwNyA2NS4yNDMsMTguNzM0IEw2NS40NzUsMTkuMTQ0IEM2NS44NzIsMTkuODgyIDY2LjM2OCwyMC41NiA2Ni45NDUsMjEuMTY1IEw2Ny4yMjMsMjEuNDM1IEM3MC41NDgsMjQuNjQ5IDc1LjgwNiwyNS4xNTEgODAuMTExLDIyLjY2NSBMODcuNDMsMTguNDQ1IEM4OS4zNywxNy4zMjYgOTEuNzU0LDE3Ljg5OSA5Mi43NTUsMTkuNzI3IEw5Ni4wMDUsMjUuNjU1IEwxMi40ODYsNzMuODg0IEwyLjIwOCw1NS4xMzQgWiIgaWQ9IkZpbGwtNiIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40ODYsNzQuMDAxIEMxMi40NzYsNzQuMDAxIDEyLjQ2NSw3My45OTkgMTIuNDU1LDczLjk5NiBDMTIuNDI0LDczLjk4OCAxMi4zOTksNzMuOTY3IDEyLjM4NCw3My45NCBMMi4xMDYsNTUuMTkgQzEuMDc1LDUzLjMxIDEuODU3LDUwLjg0NSAzLjg0OCw0OS42OTYgTDU5Ljg1OCwxNy4zNTIgQzYwLjUyNSwxNi45NjcgNjEuMjcxLDE2Ljc2NCA2Mi4wMTYsMTYuNzY0IEM2My40MzEsMTYuNzY0IDY0LjY2NiwxNy40NjYgNjUuMzI3LDE4LjY0NiBDNjUuMzM3LDE4LjY1NCA2NS4zNDUsMTguNjYzIDY1LjM1MSwxOC42NzQgTDY1LjU3OCwxOS4wODggQzY1LjU4NCwxOS4xIDY1LjU4OSwxOS4xMTIgNjUuNTkxLDE5LjEyNiBDNjUuOTg1LDE5LjgzOCA2Ni40NjksMjAuNDk3IDY3LjAzLDIxLjA4NSBMNjcuMzA1LDIxLjM1MSBDNjkuMTUxLDIzLjEzNyA3MS42NDksMjQuMTIgNzQuMzM2LDI0LjEyIEM3Ni4zMTMsMjQuMTIgNzguMjksMjMuNTgyIDgwLjA1MywyMi41NjMgQzgwLjA2NCwyMi41NTcgODAuMDc2LDIyLjU1MyA4MC4wODgsMjIuNTUgTDg3LjM3MiwxOC4zNDQgQzg4LjAzOCwxNy45NTkgODguNzg0LDE3Ljc1NiA4OS41MjksMTcuNzU2IEM5MC45NTYsMTcuNzU2IDkyLjIwMSwxOC40NzIgOTIuODU4LDE5LjY3IEw5Ni4xMDcsMjUuNTk5IEM5Ni4xMzgsMjUuNjU0IDk2LjExOCwyNS43MjQgOTYuMDYzLDI1Ljc1NiBMMTIuNTQ1LDczLjk4NSBDMTIuNTI2LDczLjk5NiAxMi41MDYsNzQuMDAxIDEyLjQ4Niw3NC4wMDEgTDEyLjQ4Niw3NC4wMDEgWiBNNjIuMDE2LDE2Ljk5NyBDNjEuMzEyLDE2Ljk5NyA2MC42MDYsMTcuMTkgNTkuOTc1LDE3LjU1NCBMMy45NjUsNDkuODk5IEMyLjA4Myw1MC45ODUgMS4zNDEsNTMuMzA4IDIuMzEsNTUuMDc4IEwxMi41MzEsNzMuNzIzIEw5NS44NDgsMjUuNjExIEw5Mi42NTMsMTkuNzgyIEM5Mi4wMzgsMTguNjYgOTAuODcsMTcuOTkgODkuNTI5LDE3Ljk5IEM4OC44MjUsMTcuOTkgODguMTE5LDE4LjE4MiA4Ny40ODksMTguNTQ3IEw4MC4xNzIsMjIuNzcyIEM4MC4xNjEsMjIuNzc4IDgwLjE0OSwyMi43ODIgODAuMTM3LDIyLjc4NSBDNzguMzQ2LDIzLjgxMSA3Ni4zNDEsMjQuMzU0IDc0LjMzNiwyNC4zNTQgQzcxLjU4OCwyNC4zNTQgNjkuMDMzLDIzLjM0NyA2Ny4xNDIsMjEuNTE5IEw2Ni44NjQsMjEuMjQ5IEM2Ni4yNzcsMjAuNjM0IDY1Ljc3NCwxOS45NDcgNjUuMzY3LDE5LjIwMyBDNjUuMzYsMTkuMTkyIDY1LjM1NiwxOS4xNzkgNjUuMzU0LDE5LjE2NiBMNjUuMTYzLDE4LjgxOSBDNjUuMTU0LDE4LjgxMSA2NS4xNDYsMTguODAxIDY1LjE0LDE4Ljc5IEM2NC41MjUsMTcuNjY3IDYzLjM1NywxNi45OTcgNjIuMDE2LDE2Ljk5NyBMNjIuMDE2LDE2Ljk5NyBaIiBpZD0iRmlsbC03IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQyLjQzNCw0OC44MDggTDQyLjQzNCw0OC44MDggQzM5LjkyNCw0OC44MDcgMzcuNzM3LDQ3LjU1IDM2LjU4Miw0NS40NDMgQzM0Ljc3MSw0Mi4xMzkgMzYuMTQ0LDM3LjgwOSAzOS42NDEsMzUuNzg5IEw1MS45MzIsMjguNjkxIEM1My4xMDMsMjguMDE1IDU0LjQxMywyNy42NTggNTUuNzIxLDI3LjY1OCBDNTguMjMxLDI3LjY1OCA2MC40MTgsMjguOTE2IDYxLjU3MywzMS4wMjMgQzYzLjM4NCwzNC4zMjcgNjIuMDEyLDM4LjY1NyA1OC41MTQsNDAuNjc3IEw0Ni4yMjMsNDcuNzc1IEM0NS4wNTMsNDguNDUgNDMuNzQyLDQ4LjgwOCA0Mi40MzQsNDguODA4IEw0Mi40MzQsNDguODA4IFogTTU1LjcyMSwyOC4xMjUgQzU0LjQ5NSwyOC4xMjUgNTMuMjY1LDI4LjQ2MSA1Mi4xNjYsMjkuMDk2IEwzOS44NzUsMzYuMTk0IEMzNi41OTYsMzguMDg3IDM1LjMwMiw0Mi4xMzYgMzYuOTkyLDQ1LjIxOCBDMzguMDYzLDQ3LjE3MyA0MC4wOTgsNDguMzQgNDIuNDM0LDQ4LjM0IEM0My42NjEsNDguMzQgNDQuODksNDguMDA1IDQ1Ljk5LDQ3LjM3IEw1OC4yODEsNDAuMjcyIEM2MS41NiwzOC4zNzkgNjIuODUzLDM0LjMzIDYxLjE2NCwzMS4yNDggQzYwLjA5MiwyOS4yOTMgNTguMDU4LDI4LjEyNSA1NS43MjEsMjguMTI1IEw1NS43MjEsMjguMTI1IFoiIGlkPSJGaWxsLTgiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjU4OCwyLjQwNyBDMTQ5LjU4OCwyLjQwNyAxNTUuNzY4LDUuOTc1IDE1Ni4zMjUsNi4yOTcgTDE1Ni4zMjUsNy4xODQgQzE1Ni4zMjUsNy4zNiAxNTYuMzM4LDcuNTQ0IDE1Ni4zNjIsNy43MzMgQzE1Ni4zNzMsNy44MTQgMTU2LjM4Miw3Ljg5NCAxNTYuMzksNy45NzUgQzE1Ni41Myw5LjM5IDE1Ny4zNjMsMTAuOTczIDE1OC40OTUsMTEuOTc0IEwxNjUuODkxLDE4LjUxOSBDMTY2LjA2OCwxOC42NzUgMTY2LjI0OSwxOC44MTQgMTY2LjQzMiwxOC45MzQgQzE2OC4wMTEsMTkuOTc0IDE2OS4zODIsMTkuNCAxNjkuNDk0LDE3LjY1MiBDMTY5LjU0MywxNi44NjggMTY5LjU1MSwxNi4wNTcgMTY5LjUxNywxNS4yMjMgTDE2OS41MTQsMTUuMDYzIEwxNjkuNTE0LDEzLjkxMiBDMTcwLjc4LDE0LjY0MiAxOTUuNTAxLDI4LjkxNSAxOTUuNTAxLDI4LjkxNSBMMTk1LjUwMSw4Mi45MTUgQzE5NS41MDEsODQuMDA1IDE5NC43MzEsODQuNDQ1IDE5My43ODEsODMuODk3IEwxNTEuMzA4LDU5LjM3NCBDMTUwLjM1OCw1OC44MjYgMTQ5LjU4OCw1Ny40OTcgMTQ5LjU4OCw1Ni40MDggTDE0OS41ODgsMjIuMzc1IiBpZD0iRmlsbC05IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE5NC41NTMsODQuMjUgQzE5NC4yOTYsODQuMjUgMTk0LjAxMyw4NC4xNjUgMTkzLjcyMiw4My45OTcgTDE1MS4yNSw1OS40NzYgQzE1MC4yNjksNTguOTA5IDE0OS40NzEsNTcuNTMzIDE0OS40NzEsNTYuNDA4IEwxNDkuNDcxLDIyLjM3NSBMMTQ5LjcwNSwyMi4zNzUgTDE0OS43MDUsNTYuNDA4IEMxNDkuNzA1LDU3LjQ1OSAxNTAuNDUsNTguNzQ0IDE1MS4zNjYsNTkuMjc0IEwxOTMuODM5LDgzLjc5NSBDMTk0LjI2Myw4NC4wNCAxOTQuNjU1LDg0LjA4MyAxOTQuOTQyLDgzLjkxNyBDMTk1LjIyNyw4My43NTMgMTk1LjM4NCw4My4zOTcgMTk1LjM4NCw4Mi45MTUgTDE5NS4zODQsMjguOTgyIEMxOTQuMTAyLDI4LjI0MiAxNzIuMTA0LDE1LjU0MiAxNjkuNjMxLDE0LjExNCBMMTY5LjYzNCwxNS4yMiBDMTY5LjY2OCwxNi4wNTIgMTY5LjY2LDE2Ljg3NCAxNjkuNjEsMTcuNjU5IEMxNjkuNTU2LDE4LjUwMyAxNjkuMjE0LDE5LjEyMyAxNjguNjQ3LDE5LjQwNSBDMTY4LjAyOCwxOS43MTQgMTY3LjE5NywxOS41NzggMTY2LjM2NywxOS4wMzIgQzE2Ni4xODEsMTguOTA5IDE2NS45OTUsMTguNzY2IDE2NS44MTQsMTguNjA2IEwxNTguNDE3LDEyLjA2MiBDMTU3LjI1OSwxMS4wMzYgMTU2LjQxOCw5LjQzNyAxNTYuMjc0LDcuOTg2IEMxNTYuMjY2LDcuOTA3IDE1Ni4yNTcsNy44MjcgMTU2LjI0Nyw3Ljc0OCBDMTU2LjIyMSw3LjU1NSAxNTYuMjA5LDcuMzY1IDE1Ni4yMDksNy4xODQgTDE1Ni4yMDksNi4zNjQgQzE1NS4zNzUsNS44ODMgMTQ5LjUyOSwyLjUwOCAxNDkuNTI5LDIuNTA4IEwxNDkuNjQ2LDIuMzA2IEMxNDkuNjQ2LDIuMzA2IDE1NS44MjcsNS44NzQgMTU2LjM4NCw2LjE5NiBMMTU2LjQ0Miw2LjIzIEwxNTYuNDQyLDcuMTg0IEMxNTYuNDQyLDcuMzU1IDE1Ni40NTQsNy41MzUgMTU2LjQ3OCw3LjcxNyBDMTU2LjQ4OSw3LjggMTU2LjQ5OSw3Ljg4MiAxNTYuNTA3LDcuOTYzIEMxNTYuNjQ1LDkuMzU4IDE1Ny40NTUsMTAuODk4IDE1OC41NzIsMTEuODg2IEwxNjUuOTY5LDE4LjQzMSBDMTY2LjE0MiwxOC41ODQgMTY2LjMxOSwxOC43MiAxNjYuNDk2LDE4LjgzNyBDMTY3LjI1NCwxOS4zMzYgMTY4LDE5LjQ2NyAxNjguNTQzLDE5LjE5NiBDMTY5LjAzMywxOC45NTMgMTY5LjMyOSwxOC40MDEgMTY5LjM3NywxNy42NDUgQzE2OS40MjcsMTYuODY3IDE2OS40MzQsMTYuMDU0IDE2OS40MDEsMTUuMjI4IEwxNjkuMzk3LDE1LjA2NSBMMTY5LjM5NywxMy43MSBMMTY5LjU3MiwxMy44MSBDMTcwLjgzOSwxNC41NDEgMTk1LjU1OSwyOC44MTQgMTk1LjU1OSwyOC44MTQgTDE5NS42MTgsMjguODQ3IEwxOTUuNjE4LDgyLjkxNSBDMTk1LjYxOCw4My40ODQgMTk1LjQyLDgzLjkxMSAxOTUuMDU5LDg0LjExOSBDMTk0LjkwOCw4NC4yMDYgMTk0LjczNyw4NC4yNSAxOTQuNTUzLDg0LjI1IiBpZD0iRmlsbC0xMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDUuNjg1LDU2LjE2MSBMMTY5LjgsNzAuMDgzIEwxNDMuODIyLDg1LjA4MSBMMTQyLjM2LDg0Ljc3NCBDMTM1LjgyNiw4Mi42MDQgMTI4LjczMiw4MS4wNDYgMTIxLjM0MSw4MC4xNTggQzExNi45NzYsNzkuNjM0IDExMi42NzgsODEuMjU0IDExMS43NDMsODMuNzc4IEMxMTEuNTA2LDg0LjQxNCAxMTEuNTAzLDg1LjA3MSAxMTEuNzMyLDg1LjcwNiBDMTEzLjI3LDg5Ljk3MyAxMTUuOTY4LDk0LjA2OSAxMTkuNzI3LDk3Ljg0MSBMMTIwLjI1OSw5OC42ODYgQzEyMC4yNiw5OC42ODUgOTQuMjgyLDExMy42ODMgOTQuMjgyLDExMy42ODMgTDcwLjE2Nyw5OS43NjEgTDE0NS42ODUsNTYuMTYxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05NC4yODIsMTEzLjgxOCBMOTQuMjIzLDExMy43ODUgTDY5LjkzMyw5OS43NjEgTDcwLjEwOCw5OS42NiBMMTQ1LjY4NSw1Ni4wMjYgTDE0NS43NDMsNTYuMDU5IEwxNzAuMDMzLDcwLjA4MyBMMTQzLjg0Miw4NS4yMDUgTDE0My43OTcsODUuMTk1IEMxNDMuNzcyLDg1LjE5IDE0Mi4zMzYsODQuODg4IDE0Mi4zMzYsODQuODg4IEMxMzUuNzg3LDgyLjcxNCAxMjguNzIzLDgxLjE2MyAxMjEuMzI3LDgwLjI3NCBDMTIwLjc4OCw4MC4yMDkgMTIwLjIzNiw4MC4xNzcgMTE5LjY4OSw4MC4xNzcgQzExNS45MzEsODAuMTc3IDExMi42MzUsODEuNzA4IDExMS44NTIsODMuODE5IEMxMTEuNjI0LDg0LjQzMiAxMTEuNjIxLDg1LjA1MyAxMTEuODQyLDg1LjY2NyBDMTEzLjM3Nyw4OS45MjUgMTE2LjA1OCw5My45OTMgMTE5LjgxLDk3Ljc1OCBMMTE5LjgyNiw5Ny43NzkgTDEyMC4zNTIsOTguNjE0IEMxMjAuMzU0LDk4LjYxNyAxMjAuMzU2LDk4LjYyIDEyMC4zNTgsOTguNjI0IEwxMjAuNDIyLDk4LjcyNiBMMTIwLjMxNyw5OC43ODcgQzEyMC4yNjQsOTguODE4IDk0LjU5OSwxMTMuNjM1IDk0LjM0LDExMy43ODUgTDk0LjI4MiwxMTMuODE4IEw5NC4yODIsMTEzLjgxOCBaIE03MC40MDEsOTkuNzYxIEw5NC4yODIsMTEzLjU0OSBMMTE5LjA4NCw5OS4yMjkgQzExOS42Myw5OC45MTQgMTE5LjkzLDk4Ljc0IDEyMC4xMDEsOTguNjU0IEwxMTkuNjM1LDk3LjkxNCBDMTE1Ljg2NCw5NC4xMjcgMTEzLjE2OCw5MC4wMzMgMTExLjYyMiw4NS43NDYgQzExMS4zODIsODUuMDc5IDExMS4zODYsODQuNDA0IDExMS42MzMsODMuNzM4IEMxMTIuNDQ4LDgxLjUzOSAxMTUuODM2LDc5Ljk0MyAxMTkuNjg5LDc5Ljk0MyBDMTIwLjI0Niw3OS45NDMgMTIwLjgwNiw3OS45NzYgMTIxLjM1NSw4MC4wNDIgQzEyOC43NjcsODAuOTMzIDEzNS44NDYsODIuNDg3IDE0Mi4zOTYsODQuNjYzIEMxNDMuMjMyLDg0LjgzOCAxNDMuNjExLDg0LjkxNyAxNDMuNzg2LDg0Ljk2NyBMMTY5LjU2Niw3MC4wODMgTDE0NS42ODUsNTYuMjk1IEw3MC40MDEsOTkuNzYxIEw3MC40MDEsOTkuNzYxIFoiIGlkPSJGaWxsLTEyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2Ny4yMywxOC45NzkgTDE2Ny4yMyw2OS44NSBMMTM5LjkwOSw4NS42MjMgTDEzMy40NDgsNzEuNDU2IEMxMzIuNTM4LDY5LjQ2IDEzMC4wMiw2OS43MTggMTI3LjgyNCw3Mi4wMyBDMTI2Ljc2OSw3My4xNCAxMjUuOTMxLDc0LjU4NSAxMjUuNDk0LDc2LjA0OCBMMTE5LjAzNCw5Ny42NzYgTDkxLjcxMiwxMTMuNDUgTDkxLjcxMiw2Mi41NzkgTDE2Ny4yMywxOC45NzkiIGlkPSJGaWxsLTEzIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjcxMiwxMTMuNTY3IEM5MS42OTIsMTEzLjU2NyA5MS42NzIsMTEzLjU2MSA5MS42NTMsMTEzLjU1MSBDOTEuNjE4LDExMy41MyA5MS41OTUsMTEzLjQ5MiA5MS41OTUsMTEzLjQ1IEw5MS41OTUsNjIuNTc5IEM5MS41OTUsNjIuNTM3IDkxLjYxOCw2Mi40OTkgOTEuNjUzLDYyLjQ3OCBMMTY3LjE3MiwxOC44NzggQzE2Ny4yMDgsMTguODU3IDE2Ny4yNTIsMTguODU3IDE2Ny4yODgsMTguODc4IEMxNjcuMzI0LDE4Ljg5OSAxNjcuMzQ3LDE4LjkzNyAxNjcuMzQ3LDE4Ljk3OSBMMTY3LjM0Nyw2OS44NSBDMTY3LjM0Nyw2OS44OTEgMTY3LjMyNCw2OS45MyAxNjcuMjg4LDY5Ljk1IEwxMzkuOTY3LDg1LjcyNSBDMTM5LjkzOSw4NS43NDEgMTM5LjkwNSw4NS43NDUgMTM5Ljg3Myw4NS43MzUgQzEzOS44NDIsODUuNzI1IDEzOS44MTYsODUuNzAyIDEzOS44MDIsODUuNjcyIEwxMzMuMzQyLDcxLjUwNCBDMTMyLjk2Nyw3MC42ODIgMTMyLjI4LDcwLjIyOSAxMzEuNDA4LDcwLjIyOSBDMTMwLjMxOSw3MC4yMjkgMTI5LjA0NCw3MC45MTUgMTI3LjkwOCw3Mi4xMSBDMTI2Ljg3NCw3My4yIDEyNi4wMzQsNzQuNjQ3IDEyNS42MDYsNzYuMDgyIEwxMTkuMTQ2LDk3LjcwOSBDMTE5LjEzNyw5Ny43MzggMTE5LjExOCw5Ny43NjIgMTE5LjA5Miw5Ny43NzcgTDkxLjc3LDExMy41NTEgQzkxLjc1MiwxMTMuNTYxIDkxLjczMiwxMTMuNTY3IDkxLjcxMiwxMTMuNTY3IEw5MS43MTIsMTEzLjU2NyBaIE05MS44MjksNjIuNjQ3IEw5MS44MjksMTEzLjI0OCBMMTE4LjkzNSw5Ny41OTggTDEyNS4zODIsNzYuMDE1IEMxMjUuODI3LDc0LjUyNSAxMjYuNjY0LDczLjA4MSAxMjcuNzM5LDcxLjk1IEMxMjguOTE5LDcwLjcwOCAxMzAuMjU2LDY5Ljk5NiAxMzEuNDA4LDY5Ljk5NiBDMTMyLjM3Nyw2OS45OTYgMTMzLjEzOSw3MC40OTcgMTMzLjU1NCw3MS40MDcgTDEzOS45NjEsODUuNDU4IEwxNjcuMTEzLDY5Ljc4MiBMMTY3LjExMywxOS4xODEgTDkxLjgyOSw2Mi42NDcgTDkxLjgyOSw2Mi42NDcgWiIgaWQ9IkZpbGwtMTQiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTY4LjU0MywxOS4yMTMgTDE2OC41NDMsNzAuMDgzIEwxNDEuMjIxLDg1Ljg1NyBMMTM0Ljc2MSw3MS42ODkgQzEzMy44NTEsNjkuNjk0IDEzMS4zMzMsNjkuOTUxIDEyOS4xMzcsNzIuMjYzIEMxMjguMDgyLDczLjM3NCAxMjcuMjQ0LDc0LjgxOSAxMjYuODA3LDc2LjI4MiBMMTIwLjM0Niw5Ny45MDkgTDkzLjAyNSwxMTMuNjgzIEw5My4wMjUsNjIuODEzIEwxNjguNTQzLDE5LjIxMyIgaWQ9IkZpbGwtMTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTMuMDI1LDExMy44IEM5My4wMDUsMTEzLjggOTIuOTg0LDExMy43OTUgOTIuOTY2LDExMy43ODUgQzkyLjkzMSwxMTMuNzY0IDkyLjkwOCwxMTMuNzI1IDkyLjkwOCwxMTMuNjg0IEw5Mi45MDgsNjIuODEzIEM5Mi45MDgsNjIuNzcxIDkyLjkzMSw2Mi43MzMgOTIuOTY2LDYyLjcxMiBMMTY4LjQ4NCwxOS4xMTIgQzE2OC41MiwxOS4wOSAxNjguNTY1LDE5LjA5IDE2OC42MDEsMTkuMTEyIEMxNjguNjM3LDE5LjEzMiAxNjguNjYsMTkuMTcxIDE2OC42NiwxOS4yMTIgTDE2OC42Niw3MC4wODMgQzE2OC42Niw3MC4xMjUgMTY4LjYzNyw3MC4xNjQgMTY4LjYwMSw3MC4xODQgTDE0MS4yOCw4NS45NTggQzE0MS4yNTEsODUuOTc1IDE0MS4yMTcsODUuOTc5IDE0MS4xODYsODUuOTY4IEMxNDEuMTU0LDg1Ljk1OCAxNDEuMTI5LDg1LjkzNiAxNDEuMTE1LDg1LjkwNiBMMTM0LjY1NSw3MS43MzggQzEzNC4yOCw3MC45MTUgMTMzLjU5Myw3MC40NjMgMTMyLjcyLDcwLjQ2MyBDMTMxLjYzMiw3MC40NjMgMTMwLjM1Nyw3MS4xNDggMTI5LjIyMSw3Mi4zNDQgQzEyOC4xODYsNzMuNDMzIDEyNy4zNDcsNzQuODgxIDEyNi45MTksNzYuMzE1IEwxMjAuNDU4LDk3Ljk0MyBDMTIwLjQ1LDk3Ljk3MiAxMjAuNDMxLDk3Ljk5NiAxMjAuNDA1LDk4LjAxIEw5My4wODMsMTEzLjc4NSBDOTMuMDY1LDExMy43OTUgOTMuMDQ1LDExMy44IDkzLjAyNSwxMTMuOCBMOTMuMDI1LDExMy44IFogTTkzLjE0Miw2Mi44ODEgTDkzLjE0MiwxMTMuNDgxIEwxMjAuMjQ4LDk3LjgzMiBMMTI2LjY5NSw3Ni4yNDggQzEyNy4xNCw3NC43NTggMTI3Ljk3Nyw3My4zMTUgMTI5LjA1Miw3Mi4xODMgQzEzMC4yMzEsNzAuOTQyIDEzMS41NjgsNzAuMjI5IDEzMi43Miw3MC4yMjkgQzEzMy42ODksNzAuMjI5IDEzNC40NTIsNzAuNzMxIDEzNC44NjcsNzEuNjQxIEwxNDEuMjc0LDg1LjY5MiBMMTY4LjQyNiw3MC4wMTYgTDE2OC40MjYsMTkuNDE1IEw5My4xNDIsNjIuODgxIEw5My4xNDIsNjIuODgxIFoiIGlkPSJGaWxsLTE2IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS44LDcwLjA4MyBMMTQyLjQ3OCw4NS44NTcgTDEzNi4wMTgsNzEuNjg5IEMxMzUuMTA4LDY5LjY5NCAxMzIuNTksNjkuOTUxIDEzMC4zOTMsNzIuMjYzIEMxMjkuMzM5LDczLjM3NCAxMjguNSw3NC44MTkgMTI4LjA2NCw3Ni4yODIgTDEyMS42MDMsOTcuOTA5IEw5NC4yODIsMTEzLjY4MyBMOTQuMjgyLDYyLjgxMyBMMTY5LjgsMTkuMjEzIEwxNjkuOCw3MC4wODMgWiIgaWQ9IkZpbGwtMTciIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTQuMjgyLDExMy45MTcgQzk0LjI0MSwxMTMuOTE3IDk0LjIwMSwxMTMuOTA3IDk0LjE2NSwxMTMuODg2IEM5NC4wOTMsMTEzLjg0NSA5NC4wNDgsMTEzLjc2NyA5NC4wNDgsMTEzLjY4NCBMOTQuMDQ4LDYyLjgxMyBDOTQuMDQ4LDYyLjczIDk0LjA5Myw2Mi42NTIgOTQuMTY1LDYyLjYxMSBMMTY5LjY4MywxOS4wMSBDMTY5Ljc1NSwxOC45NjkgMTY5Ljg0NCwxOC45NjkgMTY5LjkxNywxOS4wMSBDMTY5Ljk4OSwxOS4wNTIgMTcwLjAzMywxOS4xMjkgMTcwLjAzMywxOS4yMTIgTDE3MC4wMzMsNzAuMDgzIEMxNzAuMDMzLDcwLjE2NiAxNjkuOTg5LDcwLjI0NCAxNjkuOTE3LDcwLjI4NSBMMTQyLjU5NSw4Ni4wNiBDMTQyLjUzOCw4Ni4wOTIgMTQyLjQ2OSw4Ni4xIDE0Mi40MDcsODYuMDggQzE0Mi4zNDQsODYuMDYgMTQyLjI5Myw4Ni4wMTQgMTQyLjI2Niw4NS45NTQgTDEzNS44MDUsNzEuNzg2IEMxMzUuNDQ1LDcwLjk5NyAxMzQuODEzLDcwLjU4IDEzMy45NzcsNzAuNTggQzEzMi45MjEsNzAuNTggMTMxLjY3Niw3MS4yNTIgMTMwLjU2Miw3Mi40MjQgQzEyOS41NCw3My41MDEgMTI4LjcxMSw3NC45MzEgMTI4LjI4Nyw3Ni4zNDggTDEyMS44MjcsOTcuOTc2IEMxMjEuODEsOTguMDM0IDEyMS43NzEsOTguMDgyIDEyMS43Miw5OC4xMTIgTDk0LjM5OCwxMTMuODg2IEM5NC4zNjIsMTEzLjkwNyA5NC4zMjIsMTEzLjkxNyA5NC4yODIsMTEzLjkxNyBMOTQuMjgyLDExMy45MTcgWiBNOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDExMy4yNzkgTDEyMS40MDYsOTcuNzU0IEwxMjcuODQsNzYuMjE1IEMxMjguMjksNzQuNzA4IDEyOS4xMzcsNzMuMjQ3IDEzMC4yMjQsNzIuMTAzIEMxMzEuNDI1LDcwLjgzOCAxMzIuNzkzLDcwLjExMiAxMzMuOTc3LDcwLjExMiBDMTM0Ljk5NSw3MC4xMTIgMTM1Ljc5NSw3MC42MzggMTM2LjIzLDcxLjU5MiBMMTQyLjU4NCw4NS41MjYgTDE2OS41NjYsNjkuOTQ4IEwxNjkuNTY2LDE5LjYxNyBMOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDYyLjk0OCBaIiBpZD0iRmlsbC0xOCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMDkuODk0LDkyLjk0MyBMMTA5Ljg5NCw5Mi45NDMgQzEwOC4xMiw5Mi45NDMgMTA2LjY1Myw5Mi4yMTggMTA1LjY1LDkwLjgyMyBDMTA1LjU4Myw5MC43MzEgMTA1LjU5Myw5MC42MSAxMDUuNjczLDkwLjUyOSBDMTA1Ljc1Myw5MC40NDggMTA1Ljg4LDkwLjQ0IDEwNS45NzQsOTAuNTA2IEMxMDYuNzU0LDkxLjA1MyAxMDcuNjc5LDkxLjMzMyAxMDguNzI0LDkxLjMzMyBDMTEwLjA0Nyw5MS4zMzMgMTExLjQ3OCw5MC44OTQgMTEyLjk4LDkwLjAyNyBDMTE4LjI5MSw4Ni45NiAxMjIuNjExLDc5LjUwOSAxMjIuNjExLDczLjQxNiBDMTIyLjYxMSw3MS40ODkgMTIyLjE2OSw2OS44NTYgMTIxLjMzMyw2OC42OTIgQzEyMS4yNjYsNjguNiAxMjEuMjc2LDY4LjQ3MyAxMjEuMzU2LDY4LjM5MiBDMTIxLjQzNiw2OC4zMTEgMTIxLjU2Myw2OC4yOTkgMTIxLjY1Niw2OC4zNjUgQzEyMy4zMjcsNjkuNTM3IDEyNC4yNDcsNzEuNzQ2IDEyNC4yNDcsNzQuNTg0IEMxMjQuMjQ3LDgwLjgyNiAxMTkuODIxLDg4LjQ0NyAxMTQuMzgyLDkxLjU4NyBDMTEyLjgwOCw5Mi40OTUgMTExLjI5OCw5Mi45NDMgMTA5Ljg5NCw5Mi45NDMgTDEwOS44OTQsOTIuOTQzIFogTTEwNi45MjUsOTEuNDAxIEMxMDcuNzM4LDkyLjA1MiAxMDguNzQ1LDkyLjI3OCAxMDkuODkzLDkyLjI3OCBMMTA5Ljg5NCw5Mi4yNzggQzExMS4yMTUsOTIuMjc4IDExMi42NDcsOTEuOTUxIDExNC4xNDgsOTEuMDg0IEMxMTkuNDU5LDg4LjAxNyAxMjMuNzgsODAuNjIxIDEyMy43OCw3NC41MjggQzEyMy43OCw3Mi41NDkgMTIzLjMxNyw3MC45MjkgMTIyLjQ1NCw2OS43NjcgQzEyMi44NjUsNzAuODAyIDEyMy4wNzksNzIuMDQyIDEyMy4wNzksNzMuNDAyIEMxMjMuMDc5LDc5LjY0NSAxMTguNjUzLDg3LjI4NSAxMTMuMjE0LDkwLjQyNSBDMTExLjY0LDkxLjMzNCAxMTAuMTMsOTEuNzQyIDEwOC43MjQsOTEuNzQyIEMxMDguMDgzLDkxLjc0MiAxMDcuNDgxLDkxLjU5MyAxMDYuOTI1LDkxLjQwMSBMMTA2LjkyNSw5MS40MDEgWiIgaWQ9IkZpbGwtMTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjA5Nyw5MC4yMyBDMTE4LjQ4MSw4Ny4xMjIgMTIyLjg0NSw3OS41OTQgMTIyLjg0NSw3My40MTYgQzEyMi44NDUsNzEuMzY1IDEyMi4zNjIsNjkuNzI0IDEyMS41MjIsNjguNTU2IEMxMTkuNzM4LDY3LjMwNCAxMTcuMTQ4LDY3LjM2MiAxMTQuMjY1LDY5LjAyNiBDMTA4Ljg4MSw3Mi4xMzQgMTA0LjUxNyw3OS42NjIgMTA0LjUxNyw4NS44NCBDMTA0LjUxNyw4Ny44OTEgMTA1LDg5LjUzMiAxMDUuODQsOTAuNyBDMTA3LjYyNCw5MS45NTIgMTEwLjIxNCw5MS44OTQgMTEzLjA5Nyw5MC4yMyIgaWQ9IkZpbGwtMjAiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA4LjcyNCw5MS42MTQgTDEwOC43MjQsOTEuNjE0IEMxMDcuNTgyLDkxLjYxNCAxMDYuNTY2LDkxLjQwMSAxMDUuNzA1LDkwLjc5NyBDMTA1LjY4NCw5MC43ODMgMTA1LjY2NSw5MC44MTEgMTA1LjY1LDkwLjc5IEMxMDQuNzU2LDg5LjU0NiAxMDQuMjgzLDg3Ljg0MiAxMDQuMjgzLDg1LjgxNyBDMTA0LjI4Myw3OS41NzUgMTA4LjcwOSw3MS45NTMgMTE0LjE0OCw2OC44MTIgQzExNS43MjIsNjcuOTA0IDExNy4yMzIsNjcuNDQ5IDExOC42MzgsNjcuNDQ5IEMxMTkuNzgsNjcuNDQ5IDEyMC43OTYsNjcuNzU4IDEyMS42NTYsNjguMzYyIEMxMjEuNjc4LDY4LjM3NyAxMjEuNjk3LDY4LjM5NyAxMjEuNzEyLDY4LjQxOCBDMTIyLjYwNiw2OS42NjIgMTIzLjA3OSw3MS4zOSAxMjMuMDc5LDczLjQxNSBDMTIzLjA3OSw3OS42NTggMTE4LjY1Myw4Ny4xOTggMTEzLjIxNCw5MC4zMzggQzExMS42NCw5MS4yNDcgMTEwLjEzLDkxLjYxNCAxMDguNzI0LDkxLjYxNCBMMTA4LjcyNCw5MS42MTQgWiBNMTA2LjAwNiw5MC41MDUgQzEwNi43OCw5MS4wMzcgMTA3LjY5NCw5MS4yODEgMTA4LjcyNCw5MS4yODEgQzExMC4wNDcsOTEuMjgxIDExMS40NzgsOTAuODY4IDExMi45OCw5MC4wMDEgQzExOC4yOTEsODYuOTM1IDEyMi42MTEsNzkuNDk2IDEyMi42MTEsNzMuNDAzIEMxMjIuNjExLDcxLjQ5NCAxMjIuMTc3LDY5Ljg4IDEyMS4zNTYsNjguNzE4IEMxMjAuNTgyLDY4LjE4NSAxMTkuNjY4LDY3LjkxOSAxMTguNjM4LDY3LjkxOSBDMTE3LjMxNSw2Ny45MTkgMTE1Ljg4Myw2OC4zNiAxMTQuMzgyLDY5LjIyNyBDMTA5LjA3MSw3Mi4yOTMgMTA0Ljc1MSw3OS43MzMgMTA0Ljc1MSw4NS44MjYgQzEwNC43NTEsODcuNzM1IDEwNS4xODUsODkuMzQzIDEwNi4wMDYsOTAuNTA1IEwxMDYuMDA2LDkwLjUwNSBaIiBpZD0iRmlsbC0yMSIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDkuMzE4LDcuMjYyIEwxMzkuMzM0LDE2LjE0IEwxNTUuMjI3LDI3LjE3MSBMMTYwLjgxNiwyMS4wNTkgTDE0OS4zMTgsNy4yNjIiIGlkPSJGaWxsLTIyIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS42NzYsMTMuODQgTDE1OS45MjgsMTkuNDY3IEMxNTYuMjg2LDIxLjU3IDE1MC40LDIxLjU4IDE0Ni43ODEsMTkuNDkxIEMxNDMuMTYxLDE3LjQwMiAxNDMuMTgsMTQuMDAzIDE0Ni44MjIsMTEuOSBMMTU2LjMxNyw2LjI5MiBMMTQ5LjU4OCwyLjQwNyBMNjcuNzUyLDQ5LjQ3OCBMMTEzLjY3NSw3NS45OTIgTDExNi43NTYsNzQuMjEzIEMxMTcuMzg3LDczLjg0OCAxMTcuNjI1LDczLjMxNSAxMTcuMzc0LDcyLjgyMyBDMTE1LjAxNyw2OC4xOTEgMTE0Ljc4MSw2My4yNzcgMTE2LjY5MSw1OC41NjEgQzEyMi4zMjksNDQuNjQxIDE0MS4yLDMzLjc0NiAxNjUuMzA5LDMwLjQ5MSBDMTczLjQ3OCwyOS4zODggMTgxLjk4OSwyOS41MjQgMTkwLjAxMywzMC44ODUgQzE5MC44NjUsMzEuMDMgMTkxLjc4OSwzMC44OTMgMTkyLjQyLDMwLjUyOCBMMTk1LjUwMSwyOC43NSBMMTY5LjY3NiwxMy44NCIgaWQ9IkZpbGwtMjMiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3Ni40NTkgQzExMy41OTQsNzYuNDU5IDExMy41MTQsNzYuNDM4IDExMy40NDIsNzYuMzk3IEw2Ny41MTgsNDkuODgyIEM2Ny4zNzQsNDkuNzk5IDY3LjI4NCw0OS42NDUgNjcuMjg1LDQ5LjQ3OCBDNjcuMjg1LDQ5LjMxMSA2Ny4zNzQsNDkuMTU3IDY3LjUxOSw0OS4wNzMgTDE0OS4zNTUsMi4wMDIgQzE0OS40OTksMS45MTkgMTQ5LjY3NywxLjkxOSAxNDkuODIxLDIuMDAyIEwxNTYuNTUsNS44ODcgQzE1Ni43NzQsNi4wMTcgMTU2Ljg1LDYuMzAyIDE1Ni43MjIsNi41MjYgQzE1Ni41OTIsNi43NDkgMTU2LjMwNyw2LjgyNiAxNTYuMDgzLDYuNjk2IEwxNDkuNTg3LDIuOTQ2IEw2OC42ODcsNDkuNDc5IEwxMTMuNjc1LDc1LjQ1MiBMMTE2LjUyMyw3My44MDggQzExNi43MTUsNzMuNjk3IDExNy4xNDMsNzMuMzk5IDExNi45NTgsNzMuMDM1IEMxMTQuNTQyLDY4LjI4NyAxMTQuMyw2My4yMjEgMTE2LjI1OCw1OC4zODUgQzExOS4wNjQsNTEuNDU4IDEyNS4xNDMsNDUuMTQzIDEzMy44NCw0MC4xMjIgQzE0Mi40OTcsMzUuMTI0IDE1My4zNTgsMzEuNjMzIDE2NS4yNDcsMzAuMDI4IEMxNzMuNDQ1LDI4LjkyMSAxODIuMDM3LDI5LjA1OCAxOTAuMDkxLDMwLjQyNSBDMTkwLjgzLDMwLjU1IDE5MS42NTIsMzAuNDMyIDE5Mi4xODYsMzAuMTI0IEwxOTQuNTY3LDI4Ljc1IEwxNjkuNDQyLDE0LjI0NCBDMTY5LjIxOSwxNC4xMTUgMTY5LjE0MiwxMy44MjkgMTY5LjI3MSwxMy42MDYgQzE2OS40LDEzLjM4MiAxNjkuNjg1LDEzLjMwNiAxNjkuOTA5LDEzLjQzNSBMMTk1LjczNCwyOC4zNDUgQzE5NS44NzksMjguNDI4IDE5NS45NjgsMjguNTgzIDE5NS45NjgsMjguNzUgQzE5NS45NjgsMjguOTE2IDE5NS44NzksMjkuMDcxIDE5NS43MzQsMjkuMTU0IEwxOTIuNjUzLDMwLjkzMyBDMTkxLjkzMiwzMS4zNSAxOTAuODksMzEuNTA4IDE4OS45MzUsMzEuMzQ2IEMxODEuOTcyLDI5Ljk5NSAxNzMuNDc4LDI5Ljg2IDE2NS4zNzIsMzAuOTU0IEMxNTMuNjAyLDMyLjU0MyAxNDIuODYsMzUuOTkzIDEzNC4zMDcsNDAuOTMxIEMxMjUuNzkzLDQ1Ljg0NyAxMTkuODUxLDUyLjAwNCAxMTcuMTI0LDU4LjczNiBDMTE1LjI3LDYzLjMxNCAxMTUuNTAxLDY4LjExMiAxMTcuNzksNzIuNjExIEMxMTguMTYsNzMuMzM2IDExNy44NDUsNzQuMTI0IDExNi45OSw3NC42MTcgTDExMy45MDksNzYuMzk3IEMxMTMuODM2LDc2LjQzOCAxMTMuNzU2LDc2LjQ1OSAxMTMuNjc1LDc2LjQ1OSIgaWQ9IkZpbGwtMjQiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUzLjMxNiwyMS4yNzkgQzE1MC45MDMsMjEuMjc5IDE0OC40OTUsMjAuNzUxIDE0Ni42NjQsMTkuNjkzIEMxNDQuODQ2LDE4LjY0NCAxNDMuODQ0LDE3LjIzMiAxNDMuODQ0LDE1LjcxOCBDMTQzLjg0NCwxNC4xOTEgMTQ0Ljg2LDEyLjc2MyAxNDYuNzA1LDExLjY5OCBMMTU2LjE5OCw2LjA5MSBDMTU2LjMwOSw2LjAyNSAxNTYuNDUyLDYuMDYyIDE1Ni41MTgsNi4xNzMgQzE1Ni41ODMsNi4yODQgMTU2LjU0Nyw2LjQyNyAxNTYuNDM2LDYuNDkzIEwxNDYuOTQsMTIuMTAyIEMxNDUuMjQ0LDEzLjA4MSAxNDQuMzEyLDE0LjM2NSAxNDQuMzEyLDE1LjcxOCBDMTQ0LjMxMiwxNy4wNTggMTQ1LjIzLDE4LjMyNiAxNDYuODk3LDE5LjI4OSBDMTUwLjQ0NiwyMS4zMzggMTU2LjI0LDIxLjMyNyAxNTkuODExLDE5LjI2NSBMMTY5LjU1OSwxMy42MzcgQzE2OS42NywxMy41NzMgMTY5LjgxMywxMy42MTEgMTY5Ljg3OCwxMy43MjMgQzE2OS45NDMsMTMuODM0IDE2OS45MDQsMTMuOTc3IDE2OS43OTMsMTQuMDQyIEwxNjAuMDQ1LDE5LjY3IEMxNTguMTg3LDIwLjc0MiAxNTUuNzQ5LDIxLjI3OSAxNTMuMzE2LDIxLjI3OSIgaWQ9IkZpbGwtMjUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3NS45OTIgTDY3Ljc2Miw0OS40ODQiIGlkPSJGaWxsLTI2IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMy42NzUsNzYuMzQyIEMxMTMuNjE1LDc2LjM0MiAxMTMuNTU1LDc2LjMyNyAxMTMuNSw3Ni4yOTUgTDY3LjU4Nyw0OS43ODcgQzY3LjQxOSw0OS42OSA2Ny4zNjIsNDkuNDc2IDY3LjQ1OSw0OS4zMDkgQzY3LjU1Niw0OS4xNDEgNjcuNzcsNDkuMDgzIDY3LjkzNyw0OS4xOCBMMTEzLjg1LDc1LjY4OCBDMTE0LjAxOCw3NS43ODUgMTE0LjA3NSw3NiAxMTMuOTc4LDc2LjE2NyBDMTEzLjkxNCw3Ni4yNzkgMTEzLjc5Niw3Ni4zNDIgMTEzLjY3NSw3Ni4zNDIiIGlkPSJGaWxsLTI3IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY3Ljc2Miw0OS40ODQgTDY3Ljc2MiwxMDMuNDg1IEM2Ny43NjIsMTA0LjU3NSA2OC41MzIsMTA1LjkwMyA2OS40ODIsMTA2LjQ1MiBMMTExLjk1NSwxMzAuOTczIEMxMTIuOTA1LDEzMS41MjIgMTEzLjY3NSwxMzEuMDgzIDExMy42NzUsMTI5Ljk5MyBMMTEzLjY3NSw3NS45OTIiIGlkPSJGaWxsLTI4IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMi43MjcsMTMxLjU2MSBDMTEyLjQzLDEzMS41NjEgMTEyLjEwNywxMzEuNDY2IDExMS43OCwxMzEuMjc2IEw2OS4zMDcsMTA2Ljc1NSBDNjguMjQ0LDEwNi4xNDIgNjcuNDEyLDEwNC43MDUgNjcuNDEyLDEwMy40ODUgTDY3LjQxMiw0OS40ODQgQzY3LjQxMiw0OS4yOSA2Ny41NjksNDkuMTM0IDY3Ljc2Miw0OS4xMzQgQzY3Ljk1Niw0OS4xMzQgNjguMTEzLDQ5LjI5IDY4LjExMyw0OS40ODQgTDY4LjExMywxMDMuNDg1IEM2OC4xMTMsMTA0LjQ0NSA2OC44MiwxMDUuNjY1IDY5LjY1NywxMDYuMTQ4IEwxMTIuMTMsMTMwLjY3IEMxMTIuNDc0LDEzMC44NjggMTEyLjc5MSwxMzAuOTEzIDExMywxMzAuNzkyIEMxMTMuMjA2LDEzMC42NzMgMTEzLjMyNSwxMzAuMzgxIDExMy4zMjUsMTI5Ljk5MyBMMTEzLjMyNSw3NS45OTIgQzExMy4zMjUsNzUuNzk4IDExMy40ODIsNzUuNjQxIDExMy42NzUsNzUuNjQxIEMxMTMuODY5LDc1LjY0MSAxMTQuMDI1LDc1Ljc5OCAxMTQuMDI1LDc1Ljk5MiBMMTE0LjAyNSwxMjkuOTkzIEMxMTQuMDI1LDEzMC42NDggMTEzLjc4NiwxMzEuMTQ3IDExMy4zNSwxMzEuMzk5IEMxMTMuMTYyLDEzMS41MDcgMTEyLjk1MiwxMzEuNTYxIDExMi43MjcsMTMxLjU2MSIgaWQ9IkZpbGwtMjkiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEyLjg2LDQwLjUxMiBDMTEyLjg2LDQwLjUxMiAxMTIuODYsNDAuNTEyIDExMi44NTksNDAuNTEyIEMxMTAuNTQxLDQwLjUxMiAxMDguMzYsMzkuOTkgMTA2LjcxNywzOS4wNDEgQzEwNS4wMTIsMzguMDU3IDEwNC4wNzQsMzYuNzI2IDEwNC4wNzQsMzUuMjkyIEMxMDQuMDc0LDMzLjg0NyAxMDUuMDI2LDMyLjUwMSAxMDYuNzU0LDMxLjUwNCBMMTE4Ljc5NSwyNC41NTEgQzEyMC40NjMsMjMuNTg5IDEyMi42NjksMjMuMDU4IDEyNS4wMDcsMjMuMDU4IEMxMjcuMzI1LDIzLjA1OCAxMjkuNTA2LDIzLjU4MSAxMzEuMTUsMjQuNTMgQzEzMi44NTQsMjUuNTE0IDEzMy43OTMsMjYuODQ1IDEzMy43OTMsMjguMjc4IEMxMzMuNzkzLDI5LjcyNCAxMzIuODQxLDMxLjA2OSAxMzEuMTEzLDMyLjA2NyBMMTE5LjA3MSwzOS4wMTkgQzExNy40MDMsMzkuOTgyIDExNS4xOTcsNDAuNTEyIDExMi44Niw0MC41MTIgTDExMi44Niw0MC41MTIgWiBNMTI1LjAwNywyMy43NTkgQzEyMi43OSwyMy43NTkgMTIwLjcwOSwyNC4yNTYgMTE5LjE0NiwyNS4xNTggTDEwNy4xMDQsMzIuMTEgQzEwNS42MDIsMzIuOTc4IDEwNC43NzQsMzQuMTA4IDEwNC43NzQsMzUuMjkyIEMxMDQuNzc0LDM2LjQ2NSAxMDUuNTg5LDM3LjU4MSAxMDcuMDY3LDM4LjQzNCBDMTA4LjYwNSwzOS4zMjMgMTEwLjY2MywzOS44MTIgMTEyLjg1OSwzOS44MTIgTDExMi44NiwzOS44MTIgQzExNS4wNzYsMzkuODEyIDExNy4xNTgsMzkuMzE1IDExOC43MjEsMzguNDEzIEwxMzAuNzYyLDMxLjQ2IEMxMzIuMjY0LDMwLjU5MyAxMzMuMDkyLDI5LjQ2MyAxMzMuMDkyLDI4LjI3OCBDMTMzLjA5MiwyNy4xMDYgMTMyLjI3OCwyNS45OSAxMzAuOCwyNS4xMzYgQzEyOS4yNjEsMjQuMjQ4IDEyNy4yMDQsMjMuNzU5IDEyNS4wMDcsMjMuNzU5IEwxMjUuMDA3LDIzLjc1OSBaIiBpZD0iRmlsbC0zMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjUuNjMsMTYuMjE5IEwxNTkuODk2LDE5LjUzIEMxNTYuNzI5LDIxLjM1OCAxNTEuNjEsMjEuMzY3IDE0OC40NjMsMTkuNTUgQzE0NS4zMTYsMTcuNzMzIDE0NS4zMzIsMTQuNzc4IDE0OC40OTksMTIuOTQ5IEwxNTQuMjMzLDkuNjM5IEwxNjUuNjMsMTYuMjE5IiBpZD0iRmlsbC0zMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNTQuMjMzLDEwLjQ0OCBMMTY0LjIyOCwxNi4yMTkgTDE1OS41NDYsMTguOTIzIEMxNTguMTEyLDE5Ljc1IDE1Ni4xOTQsMjAuMjA2IDE1NC4xNDcsMjAuMjA2IEMxNTIuMTE4LDIwLjIwNiAxNTAuMjI0LDE5Ljc1NyAxNDguODE0LDE4Ljk0MyBDMTQ3LjUyNCwxOC4xOTkgMTQ2LjgxNCwxNy4yNDkgMTQ2LjgxNCwxNi4yNjkgQzE0Ni44MTQsMTUuMjc4IDE0Ny41MzcsMTQuMzE0IDE0OC44NSwxMy41NTYgTDE1NC4yMzMsMTAuNDQ4IE0xNTQuMjMzLDkuNjM5IEwxNDguNDk5LDEyLjk0OSBDMTQ1LjMzMiwxNC43NzggMTQ1LjMxNiwxNy43MzMgMTQ4LjQ2MywxOS41NSBDMTUwLjAzMSwyMC40NTUgMTUyLjA4NiwyMC45MDcgMTU0LjE0NywyMC45MDcgQzE1Ni4yMjQsMjAuOTA3IDE1OC4zMDYsMjAuNDQ3IDE1OS44OTYsMTkuNTMgTDE2NS42MywxNi4yMTkgTDE1NC4yMzMsOS42MzkiIGlkPSJGaWxsLTMyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NS40NDUsNzIuNjY3IEwxNDUuNDQ1LDcyLjY2NyBDMTQzLjY3Miw3Mi42NjcgMTQyLjIwNCw3MS44MTcgMTQxLjIwMiw3MC40MjIgQzE0MS4xMzUsNzAuMzMgMTQxLjE0NSw3MC4xNDcgMTQxLjIyNSw3MC4wNjYgQzE0MS4zMDUsNjkuOTg1IDE0MS40MzIsNjkuOTQ2IDE0MS41MjUsNzAuMDExIEMxNDIuMzA2LDcwLjU1OSAxNDMuMjMxLDcwLjgyMyAxNDQuMjc2LDcwLjgyMiBDMTQ1LjU5OCw3MC44MjIgMTQ3LjAzLDcwLjM3NiAxNDguNTMyLDY5LjUwOSBDMTUzLjg0Miw2Ni40NDMgMTU4LjE2Myw1OC45ODcgMTU4LjE2Myw1Mi44OTQgQzE1OC4xNjMsNTAuOTY3IDE1Ny43MjEsNDkuMzMyIDE1Ni44ODQsNDguMTY4IEMxNTYuODE4LDQ4LjA3NiAxNTYuODI4LDQ3Ljk0OCAxNTYuOTA4LDQ3Ljg2NyBDMTU2Ljk4OCw0Ny43ODYgMTU3LjExNCw0Ny43NzQgMTU3LjIwOCw0Ny44NCBDMTU4Ljg3OCw0OS4wMTIgMTU5Ljc5OCw1MS4yMiAxNTkuNzk4LDU0LjA1OSBDMTU5Ljc5OCw2MC4zMDEgMTU1LjM3Myw2OC4wNDYgMTQ5LjkzMyw3MS4xODYgQzE0OC4zNiw3Mi4wOTQgMTQ2Ljg1LDcyLjY2NyAxNDUuNDQ1LDcyLjY2NyBMMTQ1LjQ0NSw3Mi42NjcgWiBNMTQyLjQ3Niw3MSBDMTQzLjI5LDcxLjY1MSAxNDQuMjk2LDcyLjAwMiAxNDUuNDQ1LDcyLjAwMiBDMTQ2Ljc2Nyw3Mi4wMDIgMTQ4LjE5OCw3MS41NSAxNDkuNyw3MC42ODIgQzE1NS4wMSw2Ny42MTcgMTU5LjMzMSw2MC4xNTkgMTU5LjMzMSw1NC4wNjUgQzE1OS4zMzEsNTIuMDg1IDE1OC44NjgsNTAuNDM1IDE1OC4wMDYsNDkuMjcyIEMxNTguNDE3LDUwLjMwNyAxNTguNjMsNTEuNTMyIDE1OC42Myw1Mi44OTIgQzE1OC42Myw1OS4xMzQgMTU0LjIwNSw2Ni43NjcgMTQ4Ljc2NSw2OS45MDcgQzE0Ny4xOTIsNzAuODE2IDE0NS42ODEsNzEuMjgzIDE0NC4yNzYsNzEuMjgzIEMxNDMuNjM0LDcxLjI4MyAxNDMuMDMzLDcxLjE5MiAxNDIuNDc2LDcxIEwxNDIuNDc2LDcxIFoiIGlkPSJGaWxsLTMzIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0OC42NDgsNjkuNzA0IEMxNTQuMDMyLDY2LjU5NiAxNTguMzk2LDU5LjA2OCAxNTguMzk2LDUyLjg5MSBDMTU4LjM5Niw1MC44MzkgMTU3LjkxMyw0OS4xOTggMTU3LjA3NCw0OC4wMyBDMTU1LjI4OSw0Ni43NzggMTUyLjY5OSw0Ni44MzYgMTQ5LjgxNiw0OC41MDEgQzE0NC40MzMsNTEuNjA5IDE0MC4wNjgsNTkuMTM3IDE0MC4wNjgsNjUuMzE0IEMxNDAuMDY4LDY3LjM2NSAxNDAuNTUyLDY5LjAwNiAxNDEuMzkxLDcwLjE3NCBDMTQzLjE3Niw3MS40MjcgMTQ1Ljc2NSw3MS4zNjkgMTQ4LjY0OCw2OS43MDQiIGlkPSJGaWxsLTM0IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NC4yNzYsNzEuMjc2IEwxNDQuMjc2LDcxLjI3NiBDMTQzLjEzMyw3MS4yNzYgMTQyLjExOCw3MC45NjkgMTQxLjI1Nyw3MC4zNjUgQzE0MS4yMzYsNzAuMzUxIDE0MS4yMTcsNzAuMzMyIDE0MS4yMDIsNzAuMzExIEMxNDAuMzA3LDY5LjA2NyAxMzkuODM1LDY3LjMzOSAxMzkuODM1LDY1LjMxNCBDMTM5LjgzNSw1OS4wNzMgMTQ0LjI2LDUxLjQzOSAxNDkuNyw0OC4yOTggQzE1MS4yNzMsNDcuMzkgMTUyLjc4NCw0Ni45MjkgMTU0LjE4OSw0Ni45MjkgQzE1NS4zMzIsNDYuOTI5IDE1Ni4zNDcsNDcuMjM2IDE1Ny4yMDgsNDcuODM5IEMxNTcuMjI5LDQ3Ljg1NCAxNTcuMjQ4LDQ3Ljg3MyAxNTcuMjYzLDQ3Ljg5NCBDMTU4LjE1Nyw0OS4xMzggMTU4LjYzLDUwLjg2NSAxNTguNjMsNTIuODkxIEMxNTguNjMsNTkuMTMyIDE1NC4yMDUsNjYuNzY2IDE0OC43NjUsNjkuOTA3IEMxNDcuMTkyLDcwLjgxNSAxNDUuNjgxLDcxLjI3NiAxNDQuMjc2LDcxLjI3NiBMMTQ0LjI3Niw3MS4yNzYgWiBNMTQxLjU1OCw3MC4xMDQgQzE0Mi4zMzEsNzAuNjM3IDE0My4yNDUsNzEuMDA1IDE0NC4yNzYsNzEuMDA1IEMxNDUuNTk4LDcxLjAwNSAxNDcuMDMsNzAuNDY3IDE0OC41MzIsNjkuNiBDMTUzLjg0Miw2Ni41MzQgMTU4LjE2Myw1OS4wMzMgMTU4LjE2Myw1Mi45MzkgQzE1OC4xNjMsNTEuMDMxIDE1Ny43MjksNDkuMzg1IDE1Ni45MDcsNDguMjIzIEMxNTYuMTMzLDQ3LjY5MSAxNTUuMjE5LDQ3LjQwOSAxNTQuMTg5LDQ3LjQwOSBDMTUyLjg2Nyw0Ny40MDkgMTUxLjQzNSw0Ny44NDIgMTQ5LjkzMyw0OC43MDkgQzE0NC42MjMsNTEuNzc1IDE0MC4zMDIsNTkuMjczIDE0MC4zMDIsNjUuMzY2IEMxNDAuMzAyLDY3LjI3NiAxNDAuNzM2LDY4Ljk0MiAxNDEuNTU4LDcwLjEwNCBMMTQxLjU1OCw3MC4xMDQgWiIgaWQ9IkZpbGwtMzUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUwLjcyLDY1LjM2MSBMMTUwLjM1Nyw2NS4wNjYgQzE1MS4xNDcsNjQuMDkyIDE1MS44NjksNjMuMDQgMTUyLjUwNSw2MS45MzggQzE1My4zMTMsNjAuNTM5IDE1My45NzgsNTkuMDY3IDE1NC40ODIsNTcuNTYzIEwxNTQuOTI1LDU3LjcxMiBDMTU0LjQxMiw1OS4yNDUgMTUzLjczMyw2MC43NDUgMTUyLjkxLDYyLjE3MiBDMTUyLjI2Miw2My4yOTUgMTUxLjUyNSw2NC4zNjggMTUwLjcyLDY1LjM2MSIgaWQ9IkZpbGwtMzYiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE1LjkxNyw4NC41MTQgTDExNS41NTQsODQuMjIgQzExNi4zNDQsODMuMjQ1IDExNy4wNjYsODIuMTk0IDExNy43MDIsODEuMDkyIEMxMTguNTEsNzkuNjkyIDExOS4xNzUsNzguMjIgMTE5LjY3OCw3Ni43MTcgTDEyMC4xMjEsNzYuODY1IEMxMTkuNjA4LDc4LjM5OCAxMTguOTMsNzkuODk5IDExOC4xMDYsODEuMzI2IEMxMTcuNDU4LDgyLjQ0OCAxMTYuNzIyLDgzLjUyMSAxMTUuOTE3LDg0LjUxNCIgaWQ9IkZpbGwtMzciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE0LDEzMC40NzYgTDExNCwxMzAuMDA4IEwxMTQsNzYuMDUyIEwxMTQsNzUuNTg0IEwxMTQsNzYuMDUyIEwxMTQsMTMwLjAwOCBMMTE0LDEzMC40NzYiIGlkPSJGaWxsLTM4IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyLjAwMDAwMCwgMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTkuODIyLDM3LjQ3NCBDMTkuODM5LDM3LjMzOSAxOS43NDcsMzcuMTk0IDE5LjU1NSwzNy4wODIgQzE5LjIyOCwzNi44OTQgMTguNzI5LDM2Ljg3MiAxOC40NDYsMzcuMDM3IEwxMi40MzQsNDAuNTA4IEMxMi4zMDMsNDAuNTg0IDEyLjI0LDQwLjY4NiAxMi4yNDMsNDAuNzkzIEMxMi4yNDUsNDAuOTI1IDEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQxLjM3MSBMMTIuMjQ1LDQxLjQxNCBMMTIuMjM4LDQxLjU0MiBDOC4xNDgsNDMuODg3IDUuNjQ3LDQ1LjMyMSA1LjY0Nyw0NS4zMjEgQzUuNjQ2LDQ1LjMyMSAzLjU3LDQ2LjM2NyAyLjg2LDUwLjUxMyBDMi44Niw1MC41MTMgMS45NDgsNTcuNDc0IDEuOTYyLDcwLjI1OCBDMS45NzcsODIuODI4IDIuNTY4LDg3LjMyOCAzLjEyOSw5MS42MDkgQzMuMzQ5LDkzLjI5MyA2LjEzLDkzLjczNCA2LjEzLDkzLjczNCBDNi40NjEsOTMuNzc0IDYuODI4LDkzLjcwNyA3LjIxLDkzLjQ4NiBMODIuNDgzLDQ5LjkzNSBDODQuMjkxLDQ4Ljg2NiA4NS4xNSw0Ni4yMTYgODUuNTM5LDQzLjY1MSBDODYuNzUyLDM1LjY2MSA4Ny4yMTQsMTAuNjczIDg1LjI2NCwzLjc3MyBDODUuMDY4LDMuMDggODQuNzU0LDIuNjkgODQuMzk2LDIuNDkxIEw4Mi4zMSwxLjcwMSBDODEuNTgzLDEuNzI5IDgwLjg5NCwyLjE2OCA4MC43NzYsMi4yMzYgQzgwLjYzNiwyLjMxNyA0MS44MDcsMjQuNTg1IDIwLjAzMiwzNy4wNzIgTDE5LjgyMiwzNy40NzQiIGlkPSJGaWxsLTEiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIuMzExLDEuNzAxIEw4NC4zOTYsMi40OTEgQzg0Ljc1NCwyLjY5IDg1LjA2OCwzLjA4IDg1LjI2NCwzLjc3MyBDODcuMjEzLDEwLjY3MyA4Ni43NTEsMzUuNjYgODUuNTM5LDQzLjY1MSBDODUuMTQ5LDQ2LjIxNiA4NC4yOSw0OC44NjYgODIuNDgzLDQ5LjkzNSBMNy4yMSw5My40ODYgQzYuODk3LDkzLjY2NyA2LjU5NSw5My43NDQgNi4zMTQsOTMuNzQ0IEw2LjEzMSw5My43MzMgQzYuMTMxLDkzLjczNCAzLjM0OSw5My4yOTMgMy4xMjgsOTEuNjA5IEMyLjU2OCw4Ny4zMjcgMS45NzcsODIuODI4IDEuOTYzLDcwLjI1OCBDMS45NDgsNTcuNDc0IDIuODYsNTAuNTEzIDIuODYsNTAuNTEzIEMzLjU3LDQ2LjM2NyA1LjY0Nyw0NS4zMjEgNS42NDcsNDUuMzIxIEM1LjY0Nyw0NS4zMjEgOC4xNDgsNDMuODg3IDEyLjIzOCw0MS41NDIgTDEyLjI0NSw0MS40MTQgTDEyLjI0NSw0MS4zNzEgQzEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQwLjkyNSAxMi4yNDMsNDAuNzkzIEMxMi4yNCw0MC42ODYgMTIuMzAyLDQwLjU4MyAxMi40MzQsNDAuNTA4IEwxOC40NDYsMzcuMDM2IEMxOC41NzQsMzYuOTYyIDE4Ljc0NiwzNi45MjYgMTguOTI3LDM2LjkyNiBDMTkuMTQ1LDM2LjkyNiAxOS4zNzYsMzYuOTc5IDE5LjU1NCwzNy4wODIgQzE5Ljc0NywzNy4xOTQgMTkuODM5LDM3LjM0IDE5LjgyMiwzNy40NzQgTDIwLjAzMywzNy4wNzIgQzQxLjgwNiwyNC41ODUgODAuNjM2LDIuMzE4IDgwLjc3NywyLjIzNiBDODAuODk0LDIuMTY4IDgxLjU4MywxLjcyOSA4Mi4zMTEsMS43MDEgTTgyLjMxMSwwLjcwNCBMODIuMjcyLDAuNzA1IEM4MS42NTQsMC43MjggODAuOTg5LDAuOTQ5IDgwLjI5OCwxLjM2MSBMODAuMjc3LDEuMzczIEM4MC4xMjksMS40NTggNTkuNzY4LDEzLjEzNSAxOS43NTgsMzYuMDc5IEMxOS41LDM1Ljk4MSAxOS4yMTQsMzUuOTI5IDE4LjkyNywzNS45MjkgQzE4LjU2MiwzNS45MjkgMTguMjIzLDM2LjAxMyAxNy45NDcsMzYuMTczIEwxMS45MzUsMzkuNjQ0IEMxMS40OTMsMzkuODk5IDExLjIzNiw0MC4zMzQgMTEuMjQ2LDQwLjgxIEwxMS4yNDcsNDAuOTYgTDUuMTY3LDQ0LjQ0NyBDNC43OTQsNDQuNjQ2IDIuNjI1LDQ1Ljk3OCAxLjg3Nyw1MC4zNDUgTDEuODcxLDUwLjM4NCBDMS44NjIsNTAuNDU0IDAuOTUxLDU3LjU1NyAwLjk2NSw3MC4yNTkgQzAuOTc5LDgyLjg3OSAxLjU2OCw4Ny4zNzUgMi4xMzcsOTEuNzI0IEwyLjEzOSw5MS43MzkgQzIuNDQ3LDk0LjA5NCA1LjYxNCw5NC42NjIgNS45NzUsOTQuNzE5IEw2LjAwOSw5NC43MjMgQzYuMTEsOTQuNzM2IDYuMjEzLDk0Ljc0MiA2LjMxNCw5NC43NDIgQzYuNzksOTQuNzQyIDcuMjYsOTQuNjEgNy43MSw5NC4zNSBMODIuOTgzLDUwLjc5OCBDODQuNzk0LDQ5LjcyNyA4NS45ODIsNDcuMzc1IDg2LjUyNSw0My44MDEgQzg3LjcxMSwzNS45ODcgODguMjU5LDEwLjcwNSA4Ni4yMjQsMy41MDIgQzg1Ljk3MSwyLjYwOSA4NS41MiwxLjk3NSA4NC44ODEsMS42MiBMODQuNzQ5LDEuNTU4IEw4Mi42NjQsMC43NjkgQzgyLjU1MSwwLjcyNSA4Mi40MzEsMC43MDQgODIuMzExLDAuNzA0IiBpZD0iRmlsbC0yIiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY2LjI2NywxMS41NjUgTDY3Ljc2MiwxMS45OTkgTDExLjQyMyw0NC4zMjUiIGlkPSJGaWxsLTMiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMjAyLDkwLjU0NSBDMTIuMDI5LDkwLjU0NSAxMS44NjIsOTAuNDU1IDExLjc2OSw5MC4yOTUgQzExLjYzMiw5MC4wNTcgMTEuNzEzLDg5Ljc1MiAxMS45NTIsODkuNjE0IEwzMC4zODksNzguOTY5IEMzMC42MjgsNzguODMxIDMwLjkzMyw3OC45MTMgMzEuMDcxLDc5LjE1MiBDMzEuMjA4LDc5LjM5IDMxLjEyNyw3OS42OTYgMzAuODg4LDc5LjgzMyBMMTIuNDUxLDkwLjQ3OCBMMTIuMjAyLDkwLjU0NSIgaWQ9IkZpbGwtNCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43NjQsNDIuNjU0IEwxMy42NTYsNDIuNTkyIEwxMy43MDIsNDIuNDIxIEwxOC44MzcsMzkuNDU3IEwxOS4wMDcsMzkuNTAyIEwxOC45NjIsMzkuNjczIEwxMy44MjcsNDIuNjM3IEwxMy43NjQsNDIuNjU0IiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTguNTIsOTAuMzc1IEw4LjUyLDQ2LjQyMSBMOC41ODMsNDYuMzg1IEw3NS44NCw3LjU1NCBMNzUuODQsNTEuNTA4IEw3NS43NzgsNTEuNTQ0IEw4LjUyLDkwLjM3NSBMOC41Miw5MC4zNzUgWiBNOC43Nyw0Ni41NjQgTDguNzcsODkuOTQ0IEw3NS41OTEsNTEuMzY1IEw3NS41OTEsNy45ODUgTDguNzcsNDYuNTY0IEw4Ljc3LDQ2LjU2NCBaIiBpZD0iRmlsbC02IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTI0Ljk4Niw4My4xODIgQzI0Ljc1Niw4My4zMzEgMjQuMzc0LDgzLjU2NiAyNC4xMzcsODMuNzA1IEwxMi42MzIsOTAuNDA2IEMxMi4zOTUsOTAuNTQ1IDEyLjQyNiw5MC42NTggMTIuNyw5MC42NTggTDEzLjI2NSw5MC42NTggQzEzLjU0LDkwLjY1OCAxMy45NTgsOTAuNTQ1IDE0LjE5NSw5MC40MDYgTDI1LjcsODMuNzA1IEMyNS45MzcsODMuNTY2IDI2LjEyOCw4My40NTIgMjYuMTI1LDgzLjQ0OSBDMjYuMTIyLDgzLjQ0NyAyNi4xMTksODMuMjIgMjYuMTE5LDgyLjk0NiBDMjYuMTE5LDgyLjY3MiAyNS45MzEsODIuNTY5IDI1LjcwMSw4Mi43MTkgTDI0Ljk4Niw4My4xODIiIGlkPSJGaWxsLTciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjY2LDkwLjc4MiBMMTIuNyw5MC43ODIgQzEyLjUsOTAuNzgyIDEyLjM4NCw5MC43MjYgMTIuMzU0LDkwLjYxNiBDMTIuMzI0LDkwLjUwNiAxMi4zOTcsOTAuMzk5IDEyLjU2OSw5MC4yOTkgTDI0LjA3NCw4My41OTcgQzI0LjMxLDgzLjQ1OSAyNC42ODksODMuMjI2IDI0LjkxOCw4My4wNzggTDI1LjYzMyw4Mi42MTQgQzI1LjcyMyw4Mi41NTUgMjUuODEzLDgyLjUyNSAyNS44OTksODIuNTI1IEMyNi4wNzEsODIuNTI1IDI2LjI0NCw4Mi42NTUgMjYuMjQ0LDgyLjk0NiBDMjYuMjQ0LDgzLjE2IDI2LjI0NSw4My4zMDkgMjYuMjQ3LDgzLjM4MyBMMjYuMjUzLDgzLjM4NyBMMjYuMjQ5LDgzLjQ1NiBDMjYuMjQ2LDgzLjUzMSAyNi4yNDYsODMuNTMxIDI1Ljc2Myw4My44MTIgTDE0LjI1OCw5MC41MTQgQzE0LDkwLjY2NSAxMy41NjQsOTAuNzgyIDEzLjI2Niw5MC43ODIgTDEzLjI2Niw5MC43ODIgWiBNMTIuNjY2LDkwLjUzMiBMMTIuNyw5MC41MzMgTDEzLjI2Niw5MC41MzMgQzEzLjUxOCw5MC41MzMgMTMuOTE1LDkwLjQyNSAxNC4xMzIsOTAuMjk5IEwyNS42MzcsODMuNTk3IEMyNS44MDUsODMuNDk5IDI1LjkzMSw4My40MjQgMjUuOTk4LDgzLjM4MyBDMjUuOTk0LDgzLjI5OSAyNS45OTQsODMuMTY1IDI1Ljk5NCw4Mi45NDYgTDI1Ljg5OSw4Mi43NzUgTDI1Ljc2OCw4Mi44MjQgTDI1LjA1NCw4My4yODcgQzI0LjgyMiw4My40MzcgMjQuNDM4LDgzLjY3MyAyNC4yLDgzLjgxMiBMMTIuNjk1LDkwLjUxNCBMMTIuNjY2LDkwLjUzMiBMMTIuNjY2LDkwLjUzMiBaIiBpZD0iRmlsbC04IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjI2Niw4OS44NzEgTDEyLjcsODkuODcxIEMxMi41LDg5Ljg3MSAxMi4zODQsODkuODE1IDEyLjM1NCw4OS43MDUgQzEyLjMyNCw4OS41OTUgMTIuMzk3LDg5LjQ4OCAxMi41NjksODkuMzg4IEwyNC4wNzQsODIuNjg2IEMyNC4zMzIsODIuNTM1IDI0Ljc2OCw4Mi40MTggMjUuMDY3LDgyLjQxOCBMMjUuNjMyLDgyLjQxOCBDMjUuODMyLDgyLjQxOCAyNS45NDgsODIuNDc0IDI1Ljk3OCw4Mi41ODQgQzI2LjAwOCw4Mi42OTQgMjUuOTM1LDgyLjgwMSAyNS43NjMsODIuOTAxIEwxNC4yNTgsODkuNjAzIEMxNCw4OS43NTQgMTMuNTY0LDg5Ljg3MSAxMy4yNjYsODkuODcxIEwxMy4yNjYsODkuODcxIFogTTEyLjY2Niw4OS42MjEgTDEyLjcsODkuNjIyIEwxMy4yNjYsODkuNjIyIEMxMy41MTgsODkuNjIyIDEzLjkxNSw4OS41MTUgMTQuMTMyLDg5LjM4OCBMMjUuNjM3LDgyLjY4NiBMMjUuNjY3LDgyLjY2OCBMMjUuNjMyLDgyLjY2NyBMMjUuMDY3LDgyLjY2NyBDMjQuODE1LDgyLjY2NyAyNC40MTgsODIuNzc1IDI0LjIsODIuOTAxIEwxMi42OTUsODkuNjAzIEwxMi42NjYsODkuNjIxIEwxMi42NjYsODkuNjIxIFoiIGlkPSJGaWxsLTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzcsOTAuODAxIEwxMi4zNyw4OS41NTQgTDEyLjM3LDkwLjgwMSIgaWQ9IkZpbGwtMTAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4xMyw5My45MDEgQzUuMzc5LDkzLjgwOCA0LjgxNiw5My4xNjQgNC42OTEsOTIuNTI1IEMzLjg2LDg4LjI4NyAzLjU0LDgzLjc0MyAzLjUyNiw3MS4xNzMgQzMuNTExLDU4LjM4OSA0LjQyMyw1MS40MjggNC40MjMsNTEuNDI4IEM1LjEzNCw0Ny4yODIgNy4yMSw0Ni4yMzYgNy4yMSw0Ni4yMzYgQzcuMjEsNDYuMjM2IDgxLjY2NywzLjI1IDgyLjA2OSwzLjAxNyBDODIuMjkyLDIuODg4IDg0LjU1NiwxLjQzMyA4NS4yNjQsMy45NCBDODcuMjE0LDEwLjg0IDg2Ljc1MiwzNS44MjcgODUuNTM5LDQzLjgxOCBDODUuMTUsNDYuMzgzIDg0LjI5MSw0OS4wMzMgODIuNDgzLDUwLjEwMSBMNy4yMSw5My42NTMgQzYuODI4LDkzLjg3NCA2LjQ2MSw5My45NDEgNi4xMyw5My45MDEgQzYuMTMsOTMuOTAxIDMuMzQ5LDkzLjQ2IDMuMTI5LDkxLjc3NiBDMi41NjgsODcuNDk1IDEuOTc3LDgyLjk5NSAxLjk2Miw3MC40MjUgQzEuOTQ4LDU3LjY0MSAyLjg2LDUwLjY4IDIuODYsNTAuNjggQzMuNTcsNDYuNTM0IDUuNjQ3LDQ1LjQ4OSA1LjY0Nyw0NS40ODkgQzUuNjQ2LDQ1LjQ4OSA4LjA2NSw0NC4wOTIgMTIuMjQ1LDQxLjY3OSBMMTMuMTE2LDQxLjU2IEwxOS43MTUsMzcuNzMgTDE5Ljc2MSwzNy4yNjkgTDYuMTMsOTMuOTAxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjMxNyw5NC4xNjEgTDYuMTAyLDk0LjE0OCBMNi4xMDEsOTQuMTQ4IEw1Ljg1Nyw5NC4xMDEgQzUuMTM4LDkzLjk0NSAzLjA4NSw5My4zNjUgMi44ODEsOTEuODA5IEMyLjMxMyw4Ny40NjkgMS43MjcsODIuOTk2IDEuNzEzLDcwLjQyNSBDMS42OTksNTcuNzcxIDIuNjA0LDUwLjcxOCAyLjYxMyw1MC42NDggQzMuMzM4LDQ2LjQxNyA1LjQ0NSw0NS4zMSA1LjUzNSw0NS4yNjYgTDEyLjE2Myw0MS40MzkgTDEzLjAzMyw0MS4zMiBMMTkuNDc5LDM3LjU3OCBMMTkuNTEzLDM3LjI0NCBDMTkuNTI2LDM3LjEwNyAxOS42NDcsMzcuMDA4IDE5Ljc4NiwzNy4wMjEgQzE5LjkyMiwzNy4wMzQgMjAuMDIzLDM3LjE1NiAyMC4wMDksMzcuMjkzIEwxOS45NSwzNy44ODIgTDEzLjE5OCw0MS44MDEgTDEyLjMyOCw0MS45MTkgTDUuNzcyLDQ1LjcwNCBDNS43NDEsNDUuNzIgMy43ODIsNDYuNzcyIDMuMTA2LDUwLjcyMiBDMy4wOTksNTAuNzgyIDIuMTk4LDU3LjgwOCAyLjIxMiw3MC40MjQgQzIuMjI2LDgyLjk2MyAyLjgwOSw4Ny40MiAzLjM3Myw5MS43MjkgQzMuNDY0LDkyLjQyIDQuMDYyLDkyLjg4MyA0LjY4Miw5My4xODEgQzQuNTY2LDkyLjk4NCA0LjQ4Niw5Mi43NzYgNC40NDYsOTIuNTcyIEMzLjY2NSw4OC41ODggMy4yOTEsODQuMzcgMy4yNzYsNzEuMTczIEMzLjI2Miw1OC41MiA0LjE2Nyw1MS40NjYgNC4xNzYsNTEuMzk2IEM0LjkwMSw0Ny4xNjUgNy4wMDgsNDYuMDU5IDcuMDk4LDQ2LjAxNCBDNy4wOTQsNDYuMDE1IDgxLjU0MiwzLjAzNCA4MS45NDQsMi44MDIgTDgxLjk3MiwyLjc4NSBDODIuODc2LDIuMjQ3IDgzLjY5MiwyLjA5NyA4NC4zMzIsMi4zNTIgQzg0Ljg4NywyLjU3MyA4NS4yODEsMy4wODUgODUuNTA0LDMuODcyIEM4Ny41MTgsMTEgODYuOTY0LDM2LjA5MSA4NS43ODUsNDMuODU1IEM4NS4yNzgsNDcuMTk2IDg0LjIxLDQ5LjM3IDgyLjYxLDUwLjMxNyBMNy4zMzUsOTMuODY5IEM2Ljk5OSw5NC4wNjMgNi42NTgsOTQuMTYxIDYuMzE3LDk0LjE2MSBMNi4zMTcsOTQuMTYxIFogTTYuMTcsOTMuNjU0IEM2LjQ2Myw5My42OSA2Ljc3NCw5My42MTcgNy4wODUsOTMuNDM3IEw4Mi4zNTgsNDkuODg2IEM4NC4xODEsNDguODA4IDg0Ljk2LDQ1Ljk3MSA4NS4yOTIsNDMuNzggQzg2LjQ2NiwzNi4wNDkgODcuMDIzLDExLjA4NSA4NS4wMjQsNC4wMDggQzg0Ljg0NiwzLjM3NyA4NC41NTEsMi45NzYgODQuMTQ4LDIuODE2IEM4My42NjQsMi42MjMgODIuOTgyLDIuNzY0IDgyLjIyNywzLjIxMyBMODIuMTkzLDMuMjM0IEM4MS43OTEsMy40NjYgNy4zMzUsNDYuNDUyIDcuMzM1LDQ2LjQ1MiBDNy4zMDQsNDYuNDY5IDUuMzQ2LDQ3LjUyMSA0LjY2OSw1MS40NzEgQzQuNjYyLDUxLjUzIDMuNzYxLDU4LjU1NiAzLjc3NSw3MS4xNzMgQzMuNzksODQuMzI4IDQuMTYxLDg4LjUyNCA0LjkzNiw5Mi40NzYgQzUuMDI2LDkyLjkzNyA1LjQxMiw5My40NTkgNS45NzMsOTMuNjE1IEM2LjA4Nyw5My42NCA2LjE1OCw5My42NTIgNi4xNjksOTMuNjU0IEw2LjE3LDkzLjY1NCBMNi4xNyw5My42NTQgWiIgaWQ9IkZpbGwtMTIiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4zMTcsNjguOTgyIEM3LjgwNiw2OC43MDEgOC4yMDIsNjguOTI2IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNi44MjksNzEuMjk0IDYuNDMzLDcxLjA2OSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIiBpZD0iRmlsbC0xMyIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjkyLDcxLjEzMyBDNi42MzEsNzEuMTMzIDYuNDMzLDcwLjkwNSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIEM3LjQ2LDY4LjkgNy41OTUsNjguODYxIDcuNzE0LDY4Ljg2MSBDOC4wMDMsNjguODYxIDguMjAyLDY5LjA5IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNy4xNzQsNzEuMDk0IDcuMDM5LDcxLjEzMyA2LjkyLDcxLjEzMyBNNy43MTQsNjguNjc0IEM3LjU1Nyw2OC42NzQgNy4zOTIsNjguNzIzIDcuMjI0LDY4LjgyMSBDNi42NzYsNjkuMTM4IDYuMjQ2LDY5Ljg3OSA2LjI0Niw3MC41MDggQzYuMjQ2LDcwLjk5NCA2LjUxNyw3MS4zMiA2LjkyLDcxLjMyIEM3LjA3OCw3MS4zMiA3LjI0Myw3MS4yNzEgNy40MTEsNzEuMTc0IEM3Ljk1OSw3MC44NTcgOC4zODksNzAuMTE3IDguMzg5LDY5LjQ4NyBDOC4zODksNjkuMDAxIDguMTE3LDY4LjY3NCA3LjcxNCw2OC42NzQiIGlkPSJGaWxsLTE0IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYuOTIsNzAuOTQ3IEM2LjY0OSw3MC45NDcgNi42MjEsNzAuNjQgNi42MjEsNzAuNTA4IEM2LjYyMSw3MC4wMTcgNi45ODIsNjkuMzkyIDcuNDExLDY5LjE0NSBDNy41MjEsNjkuMDgyIDcuNjI1LDY5LjA0OSA3LjcxNCw2OS4wNDkgQzcuOTg2LDY5LjA0OSA4LjAxNSw2OS4zNTUgOC4wMTUsNjkuNDg3IEM4LjAxNSw2OS45NzggNy42NTIsNzAuNjAzIDcuMjI0LDcwLjg1MSBDNy4xMTUsNzAuOTE0IDcuMDEsNzAuOTQ3IDYuOTIsNzAuOTQ3IE03LjcxNCw2OC44NjEgQzcuNTk1LDY4Ljg2MSA3LjQ2LDY4LjkgNy4zMTcsNjguOTgyIEM2LjgyOSw2OS4yNjUgNi40MzMsNjkuOTQ4IDYuNDMzLDcwLjUwOCBDNi40MzMsNzAuOTA1IDYuNjMxLDcxLjEzMyA2LjkyLDcxLjEzMyBDNy4wMzksNzEuMTMzIDcuMTc0LDcxLjA5NCA3LjMxNyw3MS4wMTIgQzcuODA2LDcwLjczIDguMjAyLDcwLjA0NyA4LjIwMiw2OS40ODcgQzguMjAyLDY5LjA5IDguMDAzLDY4Ljg2MSA3LjcxNCw2OC44NjEiIGlkPSJGaWxsLTE1IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuNDQ0LDg1LjM1IEM3LjcwOCw4NS4xOTggNy45MjEsODUuMzE5IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuOTI1IDcuNzA4LDg2LjI5MiA3LjQ0NCw4Ni40NDQgQzcuMTgxLDg2LjU5NyA2Ljk2Nyw4Ni40NzUgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IiBpZD0iRmlsbC0xNiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjIzLDg2LjUxIEM3LjA3NCw4Ni41MSA2Ljk2Nyw4Ni4zODcgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IEM3LjUyMSw4NS4zMDUgNy41OTQsODUuMjg0IDcuNjU4LDg1LjI4NCBDNy44MTQsODUuMjg0IDcuOTIxLDg1LjQwOCA3LjkyMSw4NS42MjIgQzcuOTIxLDg1LjkyNSA3LjcwOCw4Ni4yOTIgNy40NDQsODYuNDQ0IEM3LjM2Nyw4Ni40ODkgNy4yOTQsODYuNTEgNy4yMyw4Ni41MSBNNy42NTgsODUuMDk4IEM3LjU1OCw4NS4wOTggNy40NTUsODUuMTI3IDcuMzUxLDg1LjE4OCBDNy4wMzEsODUuMzczIDYuNzgxLDg1LjgwNiA2Ljc4MSw4Ni4xNzMgQzYuNzgxLDg2LjQ4MiA2Ljk2Niw4Ni42OTcgNy4yMyw4Ni42OTcgQzcuMzMsODYuNjk3IDcuNDMzLDg2LjY2NiA3LjUzOCw4Ni42MDcgQzcuODU4LDg2LjQyMiA4LjEwOCw4NS45ODkgOC4xMDgsODUuNjIyIEM4LjEwOCw4NS4zMTMgNy45MjMsODUuMDk4IDcuNjU4LDg1LjA5OCIgaWQ9IkZpbGwtMTciIGZpbGw9IiM4MDk3QTIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4yMyw4Ni4zMjIgTDcuMTU0LDg2LjE3MyBDNy4xNTQsODUuOTM4IDcuMzMzLDg1LjYyOSA3LjUzOCw4NS41MTIgTDcuNjU4LDg1LjQ3MSBMNy43MzQsODUuNjIyIEM3LjczNCw4NS44NTYgNy41NTUsODYuMTY0IDcuMzUxLDg2LjI4MiBMNy4yMyw4Ni4zMjIgTTcuNjU4LDg1LjI4NCBDNy41OTQsODUuMjg0IDcuNTIxLDg1LjMwNSA3LjQ0NCw4NS4zNSBDNy4xODEsODUuNTAyIDYuOTY3LDg1Ljg3MSA2Ljk2Nyw4Ni4xNzMgQzYuOTY3LDg2LjM4NyA3LjA3NCw4Ni41MSA3LjIzLDg2LjUxIEM3LjI5NCw4Ni41MSA3LjM2Nyw4Ni40ODkgNy40NDQsODYuNDQ0IEM3LjcwOCw4Ni4yOTIgNy45MjEsODUuOTI1IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuNDA4IDcuODE0LDg1LjI4NCA3LjY1OCw4NS4yODQiIGlkPSJGaWxsLTE4IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTc3LjI3OCw3Ljc2OSBMNzcuMjc4LDUxLjQzNiBMMTAuMjA4LDkwLjE2IEwxMC4yMDgsNDYuNDkzIEw3Ny4yNzgsNy43NjkiIGlkPSJGaWxsLTE5IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA4Myw5MC4zNzUgTDEwLjA4Myw0Ni40MjEgTDEwLjE0Niw0Ni4zODUgTDc3LjQwMyw3LjU1NCBMNzcuNDAzLDUxLjUwOCBMNzcuMzQxLDUxLjU0NCBMMTAuMDgzLDkwLjM3NSBMMTAuMDgzLDkwLjM3NSBaIE0xMC4zMzMsNDYuNTY0IEwxMC4zMzMsODkuOTQ0IEw3Ny4xNTQsNTEuMzY1IEw3Ny4xNTQsNy45ODUgTDEwLjMzMyw0Ni41NjQgTDEwLjMzMyw0Ni41NjQgWiIgaWQ9IkZpbGwtMjAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMjUuNzM3LDg4LjY0NyBMMTE4LjA5OCw5MS45ODEgTDExOC4wOTgsODQgTDEwNi42MzksODguNzEzIEwxMDYuNjM5LDk2Ljk4MiBMOTksMTAwLjMxNSBMMTEyLjM2OSwxMDMuOTYxIEwxMjUuNzM3LDg4LjY0NyIgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTIiIGZpbGw9IiM0NTVBNjQiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+")},t.exports=n},{"./util.js":68}],63:[function(e,t,o){var i=e("./sensor-sample.js"),n=e("../math-util.js"),r=e("../util.js");function s(e){this.kFilter=e,this.currentAccelMeasurement=new i,this.currentGyroMeasurement=new i,this.previousGyroMeasurement=new i,r.isIOS()?this.filterQ=new n.Quaternion(-1,0,0,1):this.filterQ=new n.Quaternion(1,0,0,1),this.previousFilterQ=new n.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new n.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new n.Vector3,this.measuredGravity=new n.Vector3,this.gyroIntegralQ=new n.Quaternion}s.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},s.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var o=t-this.previousGyroMeasurement.timestampS;r.isTimestampDeltaValid(o)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},s.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var o=new n.Quaternion;o.copy(this.filterQ),o.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(o),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i=new n.Quaternion;i.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),i.inverse(),r.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",n.radToDeg*r.getQuaternionAngle(i),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var s=new n.Quaternion;s.copy(this.filterQ),s.multiply(i),this.filterQ.slerp(s,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},s.prototype.getOrientation=function(){return this.filterQ},s.prototype.accelToQuaternion_=function(e){var t=new n.Vector3;t.copy(e),t.normalize();var o=new n.Quaternion;return o.setFromUnitVectors(new n.Vector3(0,0,-1),t),o.inverse(),o},s.prototype.gyroToQuaternionDelta_=function(e,t){var o=new n.Quaternion,i=new n.Vector3;return i.copy(e),i.normalize(),o.setFromAxisAngle(i,e.length()*t),o},t.exports=s},{"../math-util.js":59,"../util.js":68,"./sensor-sample.js":66}],64:[function(e,t,o){var i=e("./complementary-filter.js"),n=e("./pose-predictor.js"),r=e("../touch-panner.js"),s=e("../math-util.js"),a=e("../util.js");function l(){this.deviceId="webvr-polyfill:fused",this.deviceName="VR Position Device (webvr-polyfill:fused)",this.accelerometer=new s.Vector3,this.gyroscope=new s.Vector3,this.start(),this.filter=new i(window.WebVRConfig.K_FILTER),this.posePredictor=new n(window.WebVRConfig.PREDICTION_TIME_S),this.touchPanner=new r,this.filterToWorldQ=new s.Quaternion,a.isIOS()?this.filterToWorldQ.setFromAxisAngle(new s.Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new s.Vector3(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new s.Quaternion,this.worldToScreenQ=new s.Quaternion,this.originalPoseAdjustQ=new s.Quaternion,this.originalPoseAdjustQ.setFromAxisAngle(new s.Vector3(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),a.isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new s.Quaternion,this.isFirefoxAndroid=a.isFirefoxAndroid(),this.isIOS=a.isIOS(),this.orientationOut_=new Float32Array(4)}l.prototype.getPosition=function(){return null},l.prototype.getOrientation=function(){var e=this.filter.getOrientation();this.predictedQ=this.posePredictor.getPrediction(e,this.gyroscope,this.previousTimestampS);var t=new s.Quaternion;return t.copy(this.filterToWorldQ),t.multiply(this.resetQ),window.WebVRConfig.TOUCH_PANNER_DISABLED||t.multiply(this.touchPanner.getOrientation()),t.multiply(this.predictedQ),t.multiply(this.worldToScreenQ),window.WebVRConfig.YAW_ONLY&&(t.x=0,t.z=0,t.normalize()),this.orientationOut_[0]=t.x,this.orientationOut_[1]=t.y,this.orientationOut_[2]=t.z,this.orientationOut_[3]=t.w,this.orientationOut_},l.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),a.isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ),window.WebVRConfig.TOUCH_PANNER_DISABLED||this.touchPanner.resetSensor()},l.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)},l.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,o=e.rotationRate,i=e.timeStamp/1e3,n=i-this.previousTimestampS;if(n<=a.MIN_TIMESTEP||n>a.MAX_TIMESTEP)return console.warn("Invalid timestamps detected. Time step between successive gyroscope sensor samples is very small or not monotonic"),void(this.previousTimestampS=i);this.accelerometer.set(-t.x,-t.y,-t.z),this.gyroscope.set(o.alpha,o.beta,o.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,i),this.filter.addGyroMeasurement(this.gyroscope,i),this.previousTimestampS=i},l.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},l.prototype.onMessage_=function(e){var t=e.data;if(t&&t.type){var o=t.type.toLowerCase();"devicemotion"===o&&this.updateDeviceMotion_(t.deviceMotionEvent)}},l.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new s.Vector3(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new s.Vector3(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},l.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),a.isIOS()&&a.isInsideCrossDomainIFrame()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},l.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)},t.exports=l},{"../math-util.js":59,"../touch-panner.js":67,"../util.js":68,"./complementary-filter.js":63,"./pose-predictor.js":65}],65:[function(e,t,o){var i=e("../math-util"),n=e("../util");function r(e){this.predictionTimeS=e,this.previousQ=new i.Quaternion,this.previousTimestampS=null,this.deltaQ=new i.Quaternion,this.outQ=new i.Quaternion}r.prototype.getPrediction=function(e,t,o){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=o,e;var r=new i.Vector3;r.copy(t),r.normalize();var s=t.length();if(s<20*i.degToRad)return n.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(i.radToDeg*s).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;this.previousTimestampS;var a=s*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(r,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=o,this.outQ},t.exports=r},{"../math-util":59,"../util":68}],66:[function(e,t,o){function i(e,t){this.set(e,t)}i.prototype.set=function(e,t){this.sample=e,this.timestampS=t},i.prototype.copy=function(e){this.set(e.sample,e.timestampS)},t.exports=i},{}],67:[function(e,t,o){var i=e("./math-util.js"),n=e("./util.js");function r(){window.addEventListener("touchstart",this.onTouchStart_.bind(this)),window.addEventListener("touchmove",this.onTouchMove_.bind(this)),window.addEventListener("touchend",this.onTouchEnd_.bind(this)),this.isTouching=!1,this.rotateStart=new i.Vector2,this.rotateEnd=new i.Vector2,this.rotateDelta=new i.Vector2,this.theta=0,this.orientation=new i.Quaternion}r.prototype.getOrientation=function(){return this.orientation.setFromEulerXYZ(0,0,this.theta),this.orientation},r.prototype.resetSensor=function(){this.theta=0},r.prototype.onTouchStart_=function(e){e.touches&&1==e.touches.length&&(this.rotateStart.set(e.touches[0].pageX,e.touches[0].pageY),this.isTouching=!0)},r.prototype.onTouchMove_=function(e){if(this.isTouching){this.rotateEnd.set(e.touches[0].pageX,e.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd),n.isIOS()&&(this.rotateDelta.x*=-1);var t=document.body;this.theta+=2*Math.PI*this.rotateDelta.x/t.clientWidth*.5}},r.prototype.onTouchEnd_=function(e){this.isTouching=!1},t.exports=r},{"./math-util.js":59,"./util.js":68}],68:[function(e,t,o){var i,n,r,s,a=window.Util||{};a.MIN_TIMESTEP=.001,a.MAX_TIMESTEP=1,a.base64=function(e,t){return"data:"+e+";base64,"+t},a.clamp=function(e,t,o){return Math.min(Math.max(t,e),o)},a.lerp=function(e,t,o){return e+(t-e)*o},a.race=function(e){return Promise.race?Promise.race(e):new Promise(function(t,o){for(var i=0;i<e.length;i++)e[i].then(t,o)})},a.isIOS=(i=/iPad|iPhone|iPod/.test(navigator.platform),function(){return i}),a.isWebViewAndroid=(n=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome"),function(){return n}),a.isSafari=(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){return r}),a.isFirefoxAndroid=(s=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android"),function(){return s}),a.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation},a.isTimestampDeltaValid=function(e){return!(isNaN(e)||e<=a.MIN_TIMESTEP||e>a.MAX_TIMESTEP)},a.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},a.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},a.requestFullscreen=function(e){if(a.isWebViewAndroid())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},a.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},a.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},a.linkProgram=function(e,t,o,i){var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t),e.compileShader(n);var r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,o),e.compileShader(r);var s=e.createProgram();for(var a in e.attachShader(s,n),e.attachShader(s,r),i)e.bindAttribLocation(s,i[a],a);return e.linkProgram(s),e.deleteShader(n),e.deleteShader(r),s},a.getProgramUniforms=function(e,t){for(var o={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n="",r=0;r<i;r++){var s=e.getActiveUniform(t,r);n=s.name.replace("[0]",""),o[n]=e.getUniformLocation(t,n)}return o},a.orthoMatrix=function(e,t,o,i,n,r,s){var a=1/(t-o),l=1/(i-n),c=1/(r-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+o)*a,e[13]=(n+i)*l,e[14]=(s+r)*c,e[15]=1,e},a.copyArray=function(e,t){for(var o=0,i=e.length;o<i;o++)t[o]=e[o]},a.isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},a.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},a.safariCssSizeWorkaround=function(e){if(a.isIOS()){var t=e.style.width,o=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(o)+"px",setTimeout(function(){e.style.width=t,e.style.height=o},100)}window.Util=a,window.canvas=e},a.isDebug=function(){return a.getQueryParameter("debug")},a.getQueryParameter=function(e){var e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),o=t.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},a.frameDataFromPose=function(){var e=Math.PI/180,t=.25*Math.PI,o=new Float32Array([0,0,0,1]),i=new Float32Array([0,0,0]);function n(n,r,s,a,l){var c,u,h,g,d,p,f,m,y,v;c=n,u=a?a.fieldOfView:null,h=l.depthNear,g=l.depthFar,d=Math.tan(u?u.upDegrees*e:t),p=Math.tan(u?u.downDegrees*e:t),f=Math.tan(u?u.leftDegrees*e:t),m=Math.tan(u?u.rightDegrees*e:t),y=2/(f+m),v=2/(d+p),c[0]=y,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=v,c[6]=0,c[7]=0,c[8]=-(f-m)*y*.5,c[9]=(d-p)*v*.5,c[10]=g/(h-g),c[11]=-1,c[12]=0,c[13]=0,c[14]=g*h/(h-g),c[15]=0;var E=s.orientation||o,_=s.position||i;!function(e,t,o){var i=t[0],n=t[1],r=t[2],s=t[3],a=i+i,l=n+n,c=r+r,u=i*a,h=i*l,g=i*c,d=n*l,p=n*c,f=r*c,m=s*a,y=s*l,v=s*c;e[0]=1-(d+f),e[1]=h+v,e[2]=g-y,e[3]=0,e[4]=h-v,e[5]=1-(u+f),e[6]=p+m,e[7]=0,e[8]=g+y,e[9]=p-m,e[10]=1-(u+d),e[11]=0,e[12]=o[0],e[13]=o[1],e[14]=o[2],e[15]=1}(r,E,_),a&&function(e,t,o){var i,n,r,s,a,l,c,u,h,g,d,p,f=o[0],m=o[1],y=o[2];t===e?(e[12]=t[0]*f+t[4]*m+t[8]*y+t[12],e[13]=t[1]*f+t[5]*m+t[9]*y+t[13],e[14]=t[2]*f+t[6]*m+t[10]*y+t[14],e[15]=t[3]*f+t[7]*m+t[11]*y+t[15]):(i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],g=t[9],d=t[10],p=t[11],e[0]=i,e[1]=n,e[2]=r,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=g,e[10]=d,e[11]=p,e[12]=i*f+a*m+h*y+t[12],e[13]=n*f+l*m+g*y+t[13],e[14]=r*f+c*m+d*y+t[14],e[15]=s*f+u*m+p*y+t[15])}(r,r,a.offset),function(e,t){var o=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],g=t[10],d=t[11],p=t[12],f=t[13],m=t[14],y=t[15],v=o*a-i*s,E=o*l-n*s,_=o*c-r*s,T=i*l-n*a,b=i*c-r*a,M=n*c-r*l,A=u*f-h*p,S=u*m-g*p,w=u*y-d*p,C=h*m-g*f,N=h*y-d*f,L=g*y-d*m,I=v*L-E*N+_*C+T*w-b*S+M*A;if(!I)return null;I=1/I,e[0]=(a*L-l*N+c*C)*I,e[1]=(n*N-i*L-r*C)*I,e[2]=(f*M-m*b+y*T)*I,e[3]=(g*b-h*M-d*T)*I,e[4]=(l*w-s*L-c*S)*I,e[5]=(o*L-n*w+r*S)*I,e[6]=(m*_-p*M-y*E)*I,e[7]=(u*M-g*_+d*E)*I,e[8]=(s*N-a*w+c*A)*I,e[9]=(i*w-o*N-r*A)*I,e[10]=(p*b-f*_+y*v)*I,e[11]=(h*_-u*b-d*v)*I,e[12]=(a*S-s*C-l*A)*I,e[13]=(o*C-i*S+n*A)*I,e[14]=(f*E-p*T-m*v)*I,e[15]=(u*T-h*E+g*v)*I}(r,r)}return function(e,t,o){return!(!e||!t||(e.pose=t,e.timestamp=t.timestamp,n(e.leftProjectionMatrix,e.leftViewMatrix,t,o.getEyeParameters("left"),o),n(e.rightProjectionMatrix,e.rightViewMatrix,t,o.getEyeParameters("right"),o),0))}}(),a.isInsideCrossDomainIFrame=function(){var e=window.self!==window.top,t=a.getDomainFromUrl(document.referrer),o=a.getDomainFromUrl(window.location.href);return e&&t!==o},a.getDomainFromUrl=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0]},t.exports=a},{}],69:[function(e,t,o){var i=e("./device-info.js"),n=(e("./util.js"),"CardboardV1"),r="WEBVR_CARDBOARD_VIEWER";function s(){try{this.selectedKey=localStorage.getItem(r)}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=n),this.dialog=this.createDialog_(i.Viewers),this.root=null,this.onChangeCallbacks_=[]}s.prototype.show=function(e){this.root=e,e.appendChild(this.dialog);var t=this.dialog.querySelector("#"+this.selectedKey);t.checked=!0,this.dialog.style.display="block"},s.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},s.prototype.getCurrentViewer=function(){return i.Viewers[this.selectedKey]},s.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},s.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},s.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},s.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&i.Viewers[this.selectedKey]){this.fireOnChange_(i.Viewers[this.selectedKey]);try{localStorage.setItem(r,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},s.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add("webvr-polyfill-viewer-selector"),t.style.display="none";var o=document.createElement("div"),i=o.style;i.position="fixed",i.left=0,i.top=0,i.width="100%",i.height="100%",i.background="rgba(0, 0, 0, 0.3)",o.addEventListener("click",this.hide.bind(this));var n=document.createElement("div"),i=n.style;for(var r in i.boxSizing="border-box",i.position="fixed",i.top="24px",i.left="50%",i.marginLeft="-140px",i.width="280px",i.padding="24px",i.overflow="hidden",i.background="#fafafa",i.fontFamily="'Roboto', sans-serif",i.boxShadow="0px 5px 20px #666",n.appendChild(this.createH1_("Select your viewer")),e)n.appendChild(this.createChoice_(r,e[r].label));return n.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(o),t.appendChild(n),t},s.prototype.createH1_=function(e){var t=document.createElement("h1"),o=t.style;return o.color="black",o.fontSize="20px",o.fontWeight="bold",o.marginTop=0,o.marginBottom="24px",t.innerHTML=e,t},s.prototype.createChoice_=function(e,t){var o=document.createElement("div");o.style.marginTop="8px",o.style.color="black";var i=document.createElement("input");i.style.fontSize="30px",i.setAttribute("id",e),i.setAttribute("type","radio"),i.setAttribute("value",e),i.setAttribute("name","field");var n=document.createElement("label");return n.style.marginLeft="4px",n.setAttribute("for",e),n.innerHTML=t,o.appendChild(i),o.appendChild(n),o},s.prototype.createButton_=function(e,t){var o=document.createElement("button");o.innerHTML=e;var i=o.style;return i.float="right",i.textTransform="uppercase",i.color="#1094f7",i.fontSize="14px",i.letterSpacing=0,i.border=0,i.background="none",i.marginTop="16px",o.addEventListener("click",t),o},t.exports=s},{"./device-info.js":53,"./util.js":68}],70:[function(e,t,o){var i,n=e("./util.js");function r(){var e=document.createElement("video");function t(e,t,o){var i=document.createElement("source");i.src=o,i.type="video/"+t,e.appendChild(i)}e.setAttribute("loop",""),t(e,"webm",n.base64("video/webm","GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=")),t(e,"mp4",n.base64("video/mp4","AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw==")),this.request=function(){e.paused&&e.play()},this.release=function(){e.pause()}}function s(){var e=null;this.request=function(){e||(e=setInterval(function(){window.location=window.location,setTimeout(window.stop,0)},3e4))},this.release=function(){e&&(clearInterval(e),e=null)}}t.exports=(i=navigator.userAgent||navigator.vendor||window.opera).match(/iPhone/i)||i.match(/iPod/i)?s:r},{"./util.js":68}],71:[function(e,t,o){var i=e("./util.js"),n=e("./cardboard-vr-display.js"),r=e("./mouse-keyboard-vr-display.js"),s=e("./base.js").VRDisplay,a=e("./base.js").VRFrameData,l=e("./base.js").HMDVRDevice,c=e("./base.js").PositionSensorVRDevice,u=e("./display-wrappers.js").VRDisplayHMDDevice,h=e("./display-wrappers.js").VRDisplayPositionSensorDevice,g=e("../package.json").version;function d(){this.displays=[],this.devices=[],this.devicesPopulated=!1,this.nativeWebVRAvailable=this.isWebVRAvailable(),this.nativeLegacyWebVRAvailable=this.isDeprecatedWebVRAvailable(),this.nativeGetVRDisplaysFunc=this.nativeWebVRAvailable?navigator.getVRDisplays:null,this.nativeLegacyWebVRAvailable||this.nativeWebVRAvailable||(this.enablePolyfill(),window.WebVRConfig.ENABLE_DEPRECATED_API&&this.enableDeprecatedPolyfill()),p()}function p(){"VRDisplay"in window&&!("VRFrameData"in window)&&(window.VRFrameData=a,"depthNear"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthNear=.01),"depthFar"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthFar=1e4),window.VRDisplay.prototype.getFrameData=function(e){return i.frameDataFromPose(e,this.getPose(),this)})}d.prototype.isWebVRAvailable=function(){return"getVRDisplays"in navigator},d.prototype.isDeprecatedWebVRAvailable=function(){return"getVRDevices"in navigator||"mozGetVRDevices"in navigator},d.prototype.connectDisplay=function(e){e.fireVRDisplayConnect_(),this.displays.push(e)},d.prototype.populateDevices=function(){if(!this.devicesPopulated){var e=null;this.isCardboardCompatible()&&(e=new n,this.connectDisplay(e),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new u(e)),this.devices.push(new h(e)))),this.isMobile()||window.WebVRConfig.MOUSE_KEYBOARD_CONTROLS_DISABLED||(e=new r,this.connectDisplay(e),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new u(e)),this.devices.push(new h(e)))),this.devicesPopulated=!0}},d.prototype.enablePolyfill=function(){if(navigator.getVRDisplays=this.getVRDisplays.bind(this),this.nativeWebVRAvailable&&window.VRFrameData){var e=window.VRFrameData,t=new window.VRFrameData,o=window.VRDisplay.prototype.getFrameData;window.VRFrameData=a,window.VRDisplay.prototype.getFrameData=function(n){n instanceof e?o.call(this,n):(o.call(this,t),n.pose=t.pose,i.copyArray(t.leftProjectionMatrix,n.leftProjectionMatrix),i.copyArray(t.rightProjectionMatrix,n.rightProjectionMatrix),i.copyArray(t.leftViewMatrix,n.leftViewMatrix),i.copyArray(t.rightViewMatrix,n.rightViewMatrix))}}if(window.VRDisplay=s,navigator&&void 0===navigator.vrEnabled){var n=this;Object.defineProperty(navigator,"vrEnabled",{get:function(){return n.isCardboardCompatible()&&(n.isFullScreenAvailable()||i.isIOS())}})}"VRFrameData"in window||(window.VRFrameData=a)},d.prototype.enableDeprecatedPolyfill=function(){navigator.getVRDevices=this.getVRDevices.bind(this),window.HMDVRDevice=l,window.PositionSensorVRDevice=c},d.prototype.getVRDisplays=function(){this.populateDevices();var e,t=this.displays;if(!this.nativeWebVRAvailable)return Promise.resolve(t);var o=this.nativeGetVRDisplaysFunc.call(navigator),n=new Promise(function(t){e=setTimeout(function(){console.warn("Native WebVR implementation detected, but `getVRDisplays()` failed to resolve. Falling back to polyfill."),t([])},window.WebVRConfig.GET_VR_DISPLAYS_TIMEOUT)});return i.race([o,n]).then(function(o){return clearTimeout(e),window.WebVRConfig.ALWAYS_APPEND_POLYFILL_DISPLAY?o.concat(t):o.length>0?o:t})},d.prototype.getVRDevices=function(){console.warn("getVRDevices is deprecated. Please update your code to use getVRDisplays instead.");var e=this;return new Promise(function(t,o){try{if(!e.devicesPopulated){if(e.nativeWebVRAvailable)return navigator.getVRDisplays(function(o){for(var i=0;i<o.length;++i)e.devices.push(new u(o[i])),e.devices.push(new h(o[i]));e.devicesPopulated=!0,t(e.devices)},o);if(e.nativeLegacyWebVRAvailable)return(navigator.getVRDDevices||navigator.mozGetVRDevices)(function(o){for(var i=0;i<o.length;++i)o[i]instanceof l&&e.devices.push(o[i]),o[i]instanceof c&&e.devices.push(o[i]);e.devicesPopulated=!0,t(e.devices)},o)}e.populateDevices(),t(e.devices)}catch(e){o(e)}})},d.prototype.NativeVRFrameData=window.VRFrameData,d.prototype.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},d.prototype.isCardboardCompatible=function(){return this.isMobile()||window.WebVRConfig.FORCE_ENABLE_VR},d.prototype.isFullScreenAvailable=function(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||!1},d.InstallWebVRSpecShim=p,d.version=g,t.exports.WebVRPolyfill=d},{"../package.json":47,"./base.js":48,"./cardboard-vr-display.js":51,"./display-wrappers.js":54,"./mouse-keyboard-vr-display.js":60,"./util.js":68}],72:[function(e,t,o){var i=/\n/,n="\n",r=/\s/;function s(e,t,o,i){var n=e.indexOf(t,o);return-1===n||n>i?i:n}function a(e){return r.test(e)}function l(e,t,o,i){var n=Math.min(i,o-t);return{start:t,end:t+n}}t.exports=function(e,o){var i=t.exports.lines(e,o);return i.map(function(t){return e.substring(t.start,t.end)}).join("\n")},t.exports.lines=function(e,t){if(0===(t=t||{}).width&&"nowrap"!==t.mode)return[];e=e||"";var o="number"==typeof t.width?t.width:Number.MAX_VALUE,r=Math.max(0,t.start||0),c="number"==typeof t.end?t.end:e.length,u=t.mode,h=t.measure||l;return"pre"===u?function(e,t,o,n,r){for(var s=[],a=o,l=o;l<n&&l<t.length;l++){var c=t.charAt(l),u=i.test(c);if(u||l===n-1){var h=u?l:l+1,g=e(t,a,h,r);s.push(g),a=l+1}}return s}(h,e,r,c,o):function(e,t,o,i,r,l){var c=[],u=r;for("nowrap"===l&&(u=Number.MAX_VALUE);o<i&&o<t.length;){for(var h=s(t,n,o,i);o<h&&a(t.charAt(o));)o++;var g=e(t,o,h,u),d=o+(g.end-g.start),p=d+n.length;if(d<h){for(;d>o&&!a(t.charAt(d));)d--;if(d===o)p>o+n.length&&p--,d=p;else for(p=d;d>o&&a(t.charAt(d-n.length));)d--}if(d>=o){var f=e(t,o,d,u);c.push(f)}o=p}return c}(h,e,r,c,o,u)}},{}],73:[function(e,t,o){"use strict";var i=e("global/window"),n=e("is-function"),r=e("parse-headers"),s=e("xtend");function a(e,t,o){var i=e;return n(t)?(o=t,"string"==typeof e&&(i={uri:e})):i=s(t,{uri:e}),i.callback=o,i}function l(e,t,o){return c(t=a(e,t,o))}function c(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,o=function(o,i,n){t||(t=!0,e.callback(o,i,n))};function i(e){return clearTimeout(u),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,o(e,y)}function n(){if(!a){var t;clearTimeout(u),t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var i=y,n=null;return 0!==t?(i={body:function(){var e=void 0;if(e=c.response?c.response:c.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(c),m)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:g,headers:{},url:h,rawRequest:c},c.getAllResponseHeaders&&(i.headers=r(c.getAllResponseHeaders()))):n=new Error("Internal XMLHttpRequest Error"),o(n,i,i.body)}}var s,a,c=e.xhr||null;c||(c=e.cors||e.useXDR?new l.XDomainRequest:new l.XMLHttpRequest);var u,h=c.url=e.uri||e.url,g=c.method=e.method||"GET",d=e.body||e.data,p=c.headers=e.headers||{},f=!!e.sync,m=!1,y={body:void 0,headers:{},statusCode:0,method:g,url:h,rawRequest:c};if("json"in e&&!1!==e.json&&(m=!0,p.accept||p.Accept||(p.Accept="application/json"),"GET"!==g&&"HEAD"!==g&&(p["content-type"]||p["Content-Type"]||(p["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(n,0)},c.onload=n,c.onerror=i,c.onprogress=function(){},c.onabort=function(){a=!0},c.ontimeout=i,c.open(g,h,!f,e.username,e.password),f||(c.withCredentials=!!e.withCredentials),!f&&e.timeout>0&&(u=setTimeout(function(){if(!a){a=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}},e.timeout)),c.setRequestHeader)for(s in p)p.hasOwnProperty(s)&&c.setRequestHeader(s,p[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(d||null),c}t.exports=l,l.XMLHttpRequest=i.XMLHttpRequest||function(){},l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:i.XDomainRequest,function(e,t){for(var o=0;o<e.length;o++)t(e[o])}(["get","put","post","patch","head","delete"],function(e){l["delete"===e?"del":e]=function(t,o,i){return(o=a(t,o,i)).method=e.toUpperCase(),c(o)}})},{"global/window":17,"is-function":21,"parse-headers":31,xtend:75}],74:[function(e,t,o){t.exports=void 0!==self.DOMParser?function(e){var t=new self.DOMParser;return t.parseFromString(e,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}:function(e){var t=document.createElement("div");return t.innerHTML=e,t}},{}],75:[function(e,t,o){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var o=arguments[t];for(var n in o)i.call(o,n)&&(e[n]=o[n])}return e};var i=Object.prototype.hasOwnProperty},{}],76:[function(e,t,o){t.exports={name:"aframe",version:"0.7.1",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [envify --INSPECTOR_VERSION dev] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prerelease:"node scripts/release.js 0.6.1 0.7.0",start:"npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",dependencies:{"@tweenjs/tween.js":"^16.8.0","browserify-css":"^0.8.2",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7",envify:"^3.4.1","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","style-attr":"^1.0.2",three:"^0.87.0","three-bmfont-text":"^2.1.0","webvr-polyfill":"^0.9.36"},devDependencies:{browserify:"^13.1.0","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.0.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"0.0.20",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],77:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../lib/three"),r=e("../utils/"),s=r.bind,a=r.device.checkHasPositionalTracking;t.exports.Component=i("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},userHeight:{default:0,min:0},zoom:{default:1,min:0}},init:function(){var e,t=this.el,o=t.sceneEl;this.savedPose=null,e=this.camera=new n.PerspectiveCamera,t.setObject3D("camera",e),this.onEnterVR=s(this.onEnterVR,this),this.onExitVR=s(this.onExitVR,this),o.addEventListener("enter-vr",this.onEnterVR),o.addEventListener("exit-vr",this.onExitVR)},update:function(e){var t=this.el,o=this.data,i=this.camera,n=this.system;this.addHeightOffset(e.userHeight),i.aspect=o.aspect||window.innerWidth/window.innerHeight,i.far=o.far,i.fov=o.fov,i.near=o.near,i.zoom=o.zoom,i.updateProjectionMatrix(),e&&e.active===o.active||(o.active&&n.activeCameraEl!==t?n.setActiveCamera(t):o.active||n.activeCameraEl!==t||n.disableActiveCamera())},remove:function(){var e=this.el.sceneEl;this.el.removeObject3D("camera"),e.removeEventListener("enter-vr",this.onEnterVR),e.removeEventListener("exit-vr",this.onExitVR)},onEnterVR:function(){this.saveCameraPose(),this.removeHeightOffset()},onExitVR:function(){this.restoreCameraPose()},addHeightOffset:function(e){var t,o=this.el,i=this.data.userHeight;e=e||0,t=o.getAttribute("position")||{x:0,y:0,z:0},o.setAttribute("position",{x:t.x,y:t.y-e+i,z:t.z})},removeHeightOffset:function(){var e,t,o=this.el,i=this.data.userHeight;t=void 0!==this.hasPositionalTracking?this.hasPositionalTracking:a(),i&&t&&(e=o.getAttribute("position")||{x:0,y:0,z:0},o.setAttribute("position",{x:e.x,y:e.y-i,z:e.z}))},saveCameraPose:function(){var e=this.el,t=void 0!==this.hasPositionalTracking?this.hasPositionalTracking:a();!this.savedPose&&t&&(this.savedPose={position:e.getAttribute("position"),rotation:e.getAttribute("rotation")})},restoreCameraPose:function(){var e=this.el,t=this.savedPose,o=void 0!==this.hasPositionalTracking?this.hasPositionalTracking:a();t&&o&&(e.setAttribute("position",t.position),e.setAttribute("rotation",t.rotation),this.savedPose=null)}})},{"../core/component":125,"../lib/three":173,"../utils/":195}],78:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../lib/three");t.exports.Component=i("collada-model",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new n.ColladaLoader,this.loader.options.convertUpAxis=!0},update:function(){var e=this,t=this.el,o=this.data;o&&(this.remove(),this.loader.load(o,function(o){e.model=o.scene,t.setObject3D("mesh",e.model),t.emit("model-loaded",{format:"collada",model:e.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":125,"../lib/three":173}],79:[function(e,t,o){var i,n,r,s,a=e("../core/component").registerComponent,l=e("../utils/"),c=l.bind,u={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},h={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},g={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]};t.exports.Component=a("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:l.device.isMobile()},fuseTimeout:{default:1500,min:0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var e=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersection=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.updateCanvasBounds=l.debounce(function(){e.canvasBounds=e.el.sceneEl.canvas.getBoundingClientRect()},200),this.onCursorDown=c(this.onCursorDown,this),this.onCursorUp=c(this.onCursorUp,this),this.onIntersection=c(this.onIntersection,this),this.onIntersectionCleared=c(this.onIntersectionCleared,this),this.onMouseMove=c(this.onMouseMove,this)},update:function(e){this.data.rayOrigin!==e.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var e=this.el;e.removeState(h.HOVERING),e.removeState(h.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(h.HOVERED),this.removeEventListeners()},addEventListeners:function(){var e,t=this.data,o=this.el,i=this;function n(){e=o.sceneEl.canvas,g.DOWN.forEach(function(t){e.addEventListener(t,i.onCursorDown)}),g.UP.forEach(function(t){e.addEventListener(t,i.onCursorUp)})}(e=o.sceneEl.canvas)?n():o.sceneEl.addEventListener("render-target-loaded",n),t.downEvents.forEach(function(e){o.addEventListener(e,i.onCursorDown)}),t.upEvents.forEach(function(e){o.addEventListener(e,i.onCursorUp)}),o.addEventListener("raycaster-intersection",this.onIntersection),o.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),window.addEventListener("resize",this.updateCanvasBounds)},removeEventListeners:function(){var e,t=this.data,o=this.el,i=this;(e=o.sceneEl.canvas)&&(g.DOWN.forEach(function(t){e.removeEventListener(t,i.onCursorDown)}),g.UP.forEach(function(t){e.removeEventListener(t,i.onCursorUp)})),t.downEvents.forEach(function(e){o.removeEventListener(e,i.onCursorDown)}),t.upEvents.forEach(function(e){o.removeEventListener(e,i.onCursorUp)}),o.removeEventListener("raycaster-intersection",this.onIntersection),o.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.updateCanvasBounds)},updateMouseEventListeners:function(){var e=this.el;window.removeEventListener("mousemove",this.onMouseMove),e.setAttribute("raycaster","useWorldCoordinates",!1),"mouse"===this.data.rayOrigin&&(window.addEventListener("mousemove",this.onMouseMove,!1),e.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:(i=new THREE.Vector2,n=new THREE.Vector3,r=new THREE.Vector3,s={origin:n,direction:r},function(e){var t=this.el.sceneEl.camera;t.parent.updateMatrixWorld(),t.updateMatrixWorld();var o=this.canvasBounds,a=e.clientX-o.left,l=e.clientY-o.top;i.x=a/o.width*2-1,i.y=-l/o.height*2+1,n.setFromMatrixPosition(t.matrixWorld),r.set(i.x,i.y,.5).unproject(t).sub(n).normalize(),this.el.setAttribute("raycaster",s)}),onCursorDown:function(e){this.twoWayEmit(u.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(e){this.twoWayEmit(u.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&this.cursorDownEl.emit(u.MOUSEUP,{cursorEl:this.el,intersection:null}),!this.data.fuse&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(u.CLICK),this.cursorDownEl=null},onIntersection:function(e){var t,o,i,n=this,r=this.el,s=this.data;t=e.detail.els[0]===r?1:0,i=e.detail.intersections[t],(o=e.detail.els[t])&&(this.intersectedEl!==o?(this.intersectedEl&&this.clearCurrentIntersection(),this.intersection=i,this.intersectedEl=o,r.addState(h.HOVERING),o.addState(h.HOVERED),n.twoWayEmit(u.MOUSEENTER),0!==s.fuseTimeout&&s.fuse&&(r.addState(h.FUSING),this.twoWayEmit(u.FUSING),this.fuseTimeout=setTimeout(function(){r.removeState(h.FUSING),n.twoWayEmit(u.CLICK)},s.fuseTimeout))):this.intersection=i)},onIntersectionCleared:function(e){var t=this.el,o=e.detail.el;t!==o&&o===this.intersectedEl&&this.clearCurrentIntersection()},clearCurrentIntersection:function(){var e=this.el;this.intersectedEl.removeState(h.HOVERED),e.removeState(h.HOVERING),e.removeState(h.FUSING),this.twoWayEmit(u.MOUSELEAVE),this.intersection=null,this.intersectedEl=null,clearTimeout(this.fuseTimeout)},twoWayEmit:function(e){var t=this.el,o=this.intersectedEl,i=this.intersection;t.emit(e,{intersectedEl:o,intersection:i}),o&&o.emit(e,{cursorEl:t,intersection:i})}})},{"../core/component":125,"../utils/":195}],80:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/bind"),r=e("../utils/tracked-controls").checkControllerPresentAndSetup,s=e("../utils/tracked-controls").emitIfAxesChanged;t.exports.Component=i("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},rotationOffset:{default:0},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this),this.onControllersUpdate=n(this.onControllersUpdate,this),this.checkIfControllerPresent=n(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=n(this.removeControllersUpdateListener,this),this.onAxisMoved=n(this.onAxisMoved,this),this.onGamepadConnectionEvent=n(this.onGamepadConnectionEvent,this)},init:function(){var e=this;this.animationActive="pointing",this.onButtonChanged=n(this.onButtonChanged,this),this.onButtonDown=function(t){e.onButtonEvent(t.detail.id,"down")},this.onButtonUp=function(t){e.onButtonEvent(t.detail.id,"up")},this.onButtonTouchStart=function(t){e.onButtonEvent(t.detail.id,"touchstart")},this.onButtonTouchEnd=function(t){e.onButtonEvent(t.detail.id,"touchend")},this.onAxisMoved=n(this.onAxisMoved,this),this.controllerPresent=!1,this.everGotGamepadEvent=!1,this.lastControllerCheck=0,this.bindMethods(),this.checkControllerPresentAndSetup=r,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Daydream Controller",{hand:this.data.hand})},onGamepadConnectionEvent:function(e){this.everGotGamepadEvent=!0,this.checkIfControllerPresent()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener(),window.addEventListener("gamepadconnected",this.onGamepadConnectionEvent,!1),window.addEventListener("gamepaddisconnected",this.onGamepadConnectionEvent,!1)},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener(),window.removeEventListener("gamepadconnected",this.onGamepadConnectionEvent,!1),window.removeEventListener("gamepaddisconnected",this.onGamepadConnectionEvent,!1)},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,hand:t.hand,idPrefix:"Daydream Controller",rotationOffset:t.rotationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.obj",mtl:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.everGotGamepadEvent||this.checkIfControllerPresent()},onModelLoaded:function(e){var t,o=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).menu=o.getObjectByName("AppButton_AppButton_Cylinder.004"),t.system=o.getObjectByName("HomeButton_HomeButton_Cylinder.005"),t.trackpad=o.getObjectByName("TouchPad_TouchPad_Cylinder.003"),o.position.set(0,0,-.04))},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},onButtonEvent:function(e,t){var o,i=this.mapping.buttons[e];if(Array.isArray(i))for(o=0;o<i.length;o++)this.el.emit(i[o]+t);else this.el.emit(i+t);this.updateModel(i,t)},updateModel:function(e,t){var o;if(this.data.model)if(Array.isArray(e))for(o=0;o<e.length;o++)this.updateButtonModel(e[o],t);else this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var o=this.buttonMeshes;if(o&&o[e]){var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}o[e].material.color.set(i)}}})},{"../core/component":125,"../utils/bind":189,"../utils/tracked-controls":199}],81:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/bind"),r=e("../utils/tracked-controls").checkControllerPresentAndSetup,s=e("../utils/tracked-controls").emitIfAxesChanged;t.exports.Component=i("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},rotationOffset:{default:0},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this),this.onControllersUpdate=n(this.onControllersUpdate,this),this.checkIfControllerPresent=n(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=n(this.removeControllersUpdateListener,this),this.onAxisMoved=n(this.onAxisMoved,this)},init:function(){var e=this;this.animationActive="pointing",this.onButtonChanged=n(this.onButtonChanged,this),this.onButtonDown=function(t){e.onButtonEvent(t.detail.id,"down")},this.onButtonUp=function(t){e.onButtonEvent(t.detail.id,"up")},this.onButtonTouchStart=function(t){e.onButtonEvent(t.detail.id,"touchstart")},this.onButtonTouchEnd=function(t){e.onButtonEvent(t.detail.id,"touchend")},this.onAxisMoved=n(this.onAxisMoved,this),this.controllerPresent=!1,this.everGotGamepadEvent=!1,this.lastControllerCheck=0,this.bindMethods(),this.checkControllerPresentAndSetup=r,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Gear VR",this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,idPrefix:"Gear VR",rotationOffset:t.rotationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.obj",mtl:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t,o=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).trigger=o.getObjectByName("Trigger"),t.trackpad=o.getObjectByName("Touchpad"))},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},onButtonEvent:function(e,t){var o,i=this.mapping.buttons[e];if(Array.isArray(i))for(o=0;o<i.length;o++)this.el.emit(i[o]+t);else this.el.emit(i+t);this.updateModel(i,t)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){var o;if(this.data.model)if(Array.isArray(e))for(o=0;o<e.length;o++)this.updateButtonModel(e[o],t);else this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var o=this.buttonMeshes;if(o&&o[e]){var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}o[e].material.color.set(i)}}})},{"../core/component":125,"../utils/bind":189,"../utils/tracked-controls":199}],82:[function(e,t,o){var i=e("../utils/debug"),n=e("../core/geometry").geometries,r=e("../core/geometry").geometryNames,s=e("../core/component").registerComponent,a=e("../lib/three"),l=new a.Geometry,c=i("components:geometry:warn");t.exports.Component=s("geometry",{schema:{buffer:{default:!0},mergeTo:{type:"selector"},primitive:{default:"box",oneOf:r},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(e){var t=this.data,o=this.el.getOrCreateObject3D("mesh",a.Mesh),i=this.system;this.geometry&&(i.unuseGeometry(e),this.geometry=null),this.geometry=o.geometry=i.getOrCreateGeometry(t),t.mergeTo&&this.mergeTo(t.mergeTo)},mergeTo:function(e){var t,o=this.el,i=o.getObject3D("mesh");if(e&&e.isEntity)if(e!==o){if(!(t=e.getObject3D("mesh")))return t=e.getOrCreateObject3D("mesh",a.Mesh),void e.setAttribute("material",o.getAttribute("material"));t.geometry instanceof a.Geometry!=0&&i.geometry instanceof a.Geometry!=0?!1!==this.data.skipCache?(i.parent.updateMatrixWorld(),t.geometry.merge(i.geometry,i.matrixWorld),o.emit("geometry-merged",{mergeTarget:e}),o.parentNode.removeChild(o)):c("Cached geometries are not allowed to merge. Set `skipCache` to true"):c("Geometry merge is only available for `THREE.Geometry` types. Check that both of the merging geometry and the target geometry have `buffer` set to false")}else c("Source and target geometries cannot be the same for merge");else c("There is not a valid entity to merge the geometry to")},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=l,this.geometry=null},updateSchema:function(e){var t=e.primitive,o=this.data&&this.data.primitive,i=n[t]&&n[t].schema;if(!i)throw new Error("Unknown geometry schema `"+t+"`");o&&o===t||this.extendSchema(i)}})},{"../core/component":125,"../core/geometry":126,"../lib/three":173,"../utils/debug":191}],83:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../lib/three"),r=e("../utils/"),s=r.debug("components:gltf-model:warn");t.exports.Component=i("gltf-model",{schema:{type:"model"},init:function(){this.model=null,this.loader=new n.GLTFLoader},update:function(){var e=this,t=this.el,o=this.data;o&&(this.remove(),this.loader.load(o,function(o){e.model=o.scene||o.scenes[0],e.model.animations=o.animations,t.setObject3D("mesh",e.model),t.emit("model-loaded",{format:"gltf",model:e.model})},void 0,function(e){var i=e&&e.message?e.message:"Failed to load glTF model";s(i),t.emit("model-error",{format:"gltf",src:o})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":125,"../lib/three":173,"../utils/":195}],84:[function(e,t,o){var i=e("../core/component").registerComponent,n={left:"https://cdn.aframe.io/controllers/oculus-hands/v2/leftHand.json",right:"https://cdn.aframe.io/controllers/oculus-hands/v2/rightHand.json"},r={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},s={};function a(e,t){var o;if(e)return"grip"===(o=s[e])?o+(t?"close":"open"):"point"===o||"thumb"===o?o+(t?"up":"down"):"pointing"===o||"pistol"===o?o+(t?"start":"end"):void 0}s[r.fist]="grip",s[r.thumbUp]="pistol",s[r.point]="pointing",s[r.thumb]="thumb",t.exports.Component=i("hand-controls",{schema:{default:"left"},init:function(){var e=this,t=this.el;this.gesture=r.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.ObjectLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){e.handleButton("grip","down")},this.onGripUp=function(){e.handleButton("grip","up")},this.onTrackpadDown=function(){e.handleButton("trackpad","down")},this.onTrackpadUp=function(){e.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){e.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){e.handleButton("trackpad","touchend")},this.onTriggerDown=function(){e.handleButton("trigger","down")},this.onTriggerUp=function(){e.handleButton("trigger","up")},this.onTriggerTouchStart=function(){e.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){e.handleButton("trigger","touchend")},this.onGripTouchStart=function(){e.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){e.handleButton("grip","touchend")},this.onThumbstickDown=function(){e.handleButton("thumbstick","down")},this.onThumbstickUp=function(){e.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){e.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){e.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){e.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){e.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){e.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){e.handleButton("surface","touchend")},this.onControllerConnected=function(){e.setModelVisibility(!0)},this.onControllerDisconnected=function(){e.setModelVisibility(!1)},t.addEventListener("controllerconnected",this.onControllerConnected),t.addEventListener("controllerdisconnected",this.onControllerDisconnected)},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(e,t){var o=this.el.getObject3D("mesh");o&&o.mixer&&o.mixer.update(t/1e3)},addEventListeners:function(){var e=this.el;e.addEventListener("gripdown",this.onGripDown),e.addEventListener("gripup",this.onGripUp),e.addEventListener("trackpaddown",this.onTrackpadDown),e.addEventListener("trackpadup",this.onTrackpadUp),e.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.addEventListener("triggerdown",this.onTriggerDown),e.addEventListener("triggerup",this.onTriggerUp),e.addEventListener("triggertouchstart",this.onTriggerTouchStart),e.addEventListener("triggertouchend",this.onTriggerTouchEnd),e.addEventListener("griptouchstart",this.onGripTouchStart),e.addEventListener("griptouchend",this.onGripTouchEnd),e.addEventListener("thumbstickdown",this.onThumbstickDown),e.addEventListener("thumbstickup",this.onThumbstickUp),e.addEventListener("abuttontouchstart",this.onAorXTouchStart),e.addEventListener("abuttontouchend",this.onAorXTouchEnd),e.addEventListener("bbuttontouchstart",this.onBorYTouchStart),e.addEventListener("bbuttontouchend",this.onBorYTouchEnd),e.addEventListener("xbuttontouchstart",this.onAorXTouchStart),e.addEventListener("xbuttontouchend",this.onAorXTouchEnd),e.addEventListener("ybuttontouchstart",this.onBorYTouchStart),e.addEventListener("ybuttontouchend",this.onBorYTouchEnd),e.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var e=this.el;e.removeEventListener("gripdown",this.onGripDown),e.removeEventListener("gripup",this.onGripUp),e.removeEventListener("trackpaddown",this.onTrackpadDown),e.removeEventListener("trackpadup",this.onTrackpadUp),e.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.removeEventListener("triggerdown",this.onTriggerDown),e.removeEventListener("triggerup",this.onTriggerUp),e.removeEventListener("triggertouchstart",this.onTriggerTouchStart),e.removeEventListener("triggertouchend",this.onTriggerTouchEnd),e.removeEventListener("griptouchstart",this.onGripTouchStart),e.removeEventListener("griptouchend",this.onGripTouchEnd),e.removeEventListener("thumbstickdown",this.onThumbstickDown),e.removeEventListener("thumbstickup",this.onThumbstickUp),e.removeEventListener("abuttontouchstart",this.onAorXTouchStart),e.removeEventListener("abuttontouchend",this.onAorXTouchEnd),e.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),e.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),e.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),e.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),e.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),e.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),e.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(e){var t,o=this.el,i=this.data;t={hand:i,model:!1,rotationOffset:"left"===i?90:-90},i!==e&&this.loader.load(n[i],function(e){var i=e.getObjectByName("Hand");i.material.skinning=!0,i.mixer=new THREE.AnimationMixer(i),o.setObject3D("mesh",i),i.position.set(0,0,0),i.rotation.set(0,0,0),i.visible=!1,o.setAttribute("vive-controls",t),o.setAttribute("oculus-touch-controls",t),o.setAttribute("windows-motion-controls",t)})},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(e,t){var o,i="down"===t,n="touchstart"===t;if(0===t.indexOf("touch")){if(n===this.touchedButtons[e])return;this.touchedButtons[e]=n}else{if(i===this.pressedButtons[e])return;this.pressedButtons[e]=i}o=this.gesture,this.gesture=this.determineGesture(),this.gesture!==o&&(this.animateGesture(this.gesture,o),this.emitGestureEvents(this.gesture,o))},determineGesture:function(){var e,t,o,i=this.pressedButtons.grip,n=this.pressedButtons.surface||this.touchedButtons.surface,s=this.pressedButtons.trackpad||this.touchedButtons.trackpad,a=this.pressedButtons.trigger||this.touchedButtons.trigger,l=this.touchedButtons.AorX||this.touchedButtons.BorY,c=(t=this.el.components["tracked-controls"],(o=t&&t.controller&&t.controller.id)&&0===o.indexOf("OpenVR "));return i?e=c?r.fist:n||l||s?a?r.fist:r.point:a?r.thumbUp:r.pointThumb:a?e=c?r.fist:r.hold:c&&s&&(e=r.point),e},animateGesture:function(e,t){e?this.playAnimation(e||r.open,t,!1):this.playAnimation(t,t,!0)},emitGestureEvents:function(e,t){var o,i=this.el;t!==e&&((o=a(t,!1))&&i.emit(o),(o=a(e,!0))&&i.emit(o))},playAnimation:function(e,t,o){var i,n,r=this.el.getObject3D("mesh");if(r){if((n=r.mixer.clipAction(e)).clampWhenFinished=!0,n.loop=THREE.PingPong,n.repetitions=0,n.timeScale=o?-1:1,n.weight=1,!t||e===t)return r.mixer.stopAllAction(),void n.play();i=r.mixer.clipAction(t),r.mixer.stopAllAction(),i.weight=.15,i.play(),n.play(),i.crossFadeTo(n,.15,!0)}},setModelVisibility:function(e){var t=this.el.getObject3D("mesh");t&&(t.visible=e)}})},{"../core/component":125}],85:[function(e,t,o){e("./camera"),e("./collada-model"),e("./cursor"),e("./daydream-controls"),e("./gearvr-controls"),e("./geometry"),e("./gltf-model"),e("./hand-controls"),e("./laser-controls"),e("./light"),e("./line"),e("./link"),e("./look-controls"),e("./material"),e("./obj-model"),e("./oculus-touch-controls"),e("./position"),e("./raycaster"),e("./rotation"),e("./scale"),e("./shadow"),e("./sound"),e("./text"),e("./tracked-controls"),e("./visible"),e("./vive-controls"),e("./wasd-controls"),e("./windows-motion-controls"),e("./scene/debug"),e("./scene/embedded"),e("./scene/inspector"),e("./scene/fog"),e("./scene/keyboard-shortcuts"),e("./scene/pool"),e("./scene/screenshot"),e("./scene/stats"),e("./scene/vr-mode-ui")},{"./camera":77,"./collada-model":78,"./cursor":79,"./daydream-controls":80,"./gearvr-controls":81,"./geometry":82,"./gltf-model":83,"./hand-controls":84,"./laser-controls":86,"./light":87,"./line":88,"./link":89,"./look-controls":90,"./material":91,"./obj-model":92,"./oculus-touch-controls":93,"./position":94,"./raycaster":95,"./rotation":96,"./scale":97,"./scene/debug":98,"./scene/embedded":99,"./scene/fog":100,"./scene/inspector":101,"./scene/keyboard-shortcuts":102,"./scene/pool":103,"./scene/screenshot":104,"./scene/stats":105,"./scene/vr-mode-ui":106,"./shadow":107,"./sound":108,"./text":109,"./tracked-controls":110,"./visible":111,"./vive-controls":112,"./wasd-controls":113,"./windows-motion-controls":114}],86:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/");i("laser-controls",{schema:{hand:{default:"right"}},init:function(){var e=this.config,t=this.data,o=this.el,i=this;function r(t){var r=e[t.detail.name];if(r){var s=n.extend({showLine:!0},r.raycaster||{});t.detail.rayOrigin&&(s.origin=t.detail.rayOrigin.origin,s.direction=t.detail.rayOrigin.direction,s.showLine=!0),t.detail.rayOrigin||!i.modelReady?o.setAttribute("raycaster",s):o.setAttribute("raycaster","showLine",!0),o.setAttribute("cursor",n.extend({fuse:!1},r.cursor))}}o.setAttribute("daydream-controls",{hand:t.hand}),o.setAttribute("gearvr-controls",{hand:t.hand}),o.setAttribute("oculus-touch-controls",{hand:t.hand}),o.setAttribute("vive-controls",{hand:t.hand}),o.setAttribute("windows-motion-controls",{hand:t.hand}),o.addEventListener("controllerconnected",r),o.addEventListener("controllerdisconnected",function(){o.setAttribute("raycaster","showLine",!1)}),o.addEventListener("controllermodelready",function(e){r(e),i.modelReady=!0})},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown"],upEvents:["trackpadup"]}},"gearvr-controls":{cursor:{downEvents:["trackpaddown"],upEvents:["trackpadup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:.001,y:0,z:.065},direction:{x:0,y:-.8,z:-1}}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":125,"../utils/":195}],87:[function(e,t,o){var i=e("../utils/bind"),n=e("../utils").diff,r=e("../utils/debug"),s=e("../core/component").registerComponent,a=e("../lib/three"),l=a.Math.degToRad,c=r("components:light:warn");t.exports.Component=s("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"]},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}}},init:function(){var e=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(e)},update:function(e){var t=this.data,o=n(t,e),r=this.light,s=this;if(!r||"type"in o)this.setLight(this.data),this.updateShadow();else{var a=!1;Object.keys(o).forEach(function(e){var o=t[e];switch(e){case"color":r.color.set(o);break;case"groundColor":r.groundColor.set(o);break;case"angle":r.angle=l(o);break;case"target":null===o?"spot"!==t.type&&"directional"!==t.type||(r.target=s.defaultTarget):o.hasLoaded?s.onSetTarget(o,r):o.addEventListener("loaded",i(s.onSetTarget,s,o,r));break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":a||(s.updateShadow(),a=!0);break;default:r[e]=o}})}},setLight:function(e){var t=this.el,o=this.getLight(e);o&&(this.light&&t.removeObject3D("light"),this.light=o,this.light.el=t,t.setObject3D("light",this.light),"spot"!==e.type&&"directional"!==e.type&&"hemisphere"!==e.type||t.getObject3D("light").translateY(-1),"spot"===e.type&&(t.setObject3D("light-target",this.defaultTarget),t.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var e=this.el,t=this.data,o=this.light;o.castShadow=t.castShadow;var i=e.getObject3D("cameraHelper");if(t.shadowCameraVisible&&!i?e.setObject3D("cameraHelper",new a.CameraHelper(o.shadow.camera)):!t.shadowCameraVisible&&i&&e.removeObject3D("cameraHelper"),!t.castShadow)return o;o.shadow.bias=t.shadowBias,o.shadow.mapSize.height=t.shadowMapHeight,o.shadow.mapSize.width=t.shadowMapWidth,o.shadow.camera.near=t.shadowCameraNear,o.shadow.camera.far=t.shadowCameraFar,o.shadow.camera instanceof a.OrthographicCamera?(o.shadow.camera.top=t.shadowCameraTop,o.shadow.camera.right=t.shadowCameraRight,o.shadow.camera.bottom=t.shadowCameraBottom,o.shadow.camera.left=t.shadowCameraLeft):o.shadow.camera.fov=t.shadowCameraFov,o.shadow.camera.updateProjectionMatrix(),i&&i.update()},getLight:function(e){var t=e.angle,o=new a.Color(e.color).getHex(),n=e.decay,r=e.distance,s=new a.Color(e.groundColor).getHex(),u=e.intensity,h=e.type,g=e.target,d=null;switch(h.toLowerCase()){case"ambient":return new a.AmbientLight(o,u);case"directional":return d=new a.DirectionalLight(o,u),this.defaultTarget=d.target,g&&(g.hasLoaded?this.onSetTarget(g,d):g.addEventListener("loaded",i(this.onSetTarget,this,g,d))),d;case"hemisphere":return new a.HemisphereLight(o,s,u);case"point":return new a.PointLight(o,u,r,n);case"spot":return d=new a.SpotLight(o,u,r,l(t),e.penumbra,n),this.defaultTarget=d.target,g&&(g.hasLoaded?this.onSetTarget(g,d):g.addEventListener("loaded",i(this.onSetTarget,this,g,d))),d;default:c("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",h)}},onSetTarget:function(e,t){t.target=e.object3D},remove:function(){var e=this.el;e.removeObject3D("light"),e.getObject3D("cameraHelper")&&e.removeObject3D("cameraHelper")}})},{"../core/component":125,"../lib/three":173,"../utils":195,"../utils/bind":189,"../utils/debug":191}],88:[function(e,t,o){var i=e("../core/component").registerComponent;function n(e,t){return!(!e||!t)&&e.x===t.x&&e.y===t.y&&e.z===t.z}t.exports.Component=i("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var e,t,o=this.data;t=this.material=new THREE.LineBasicMaterial({color:o.color,opacity:o.opacity,transparent:o.opacity<1,visible:o.visible}),(e=this.geometry=new THREE.BufferGeometry).addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(e,t),this.el.setObject3D(this.attrName,this.line)},update:function(e){var t=this.data,o=this.geometry,i=!1,r=this.material,s=o.attributes.position.array;n(t.start,e.start)||(s[0]=t.start.x,s[1]=t.start.y,s[2]=t.start.z,i=!0),n(t.end,e.end)||(s[3]=t.end.x,s[4]=t.end.y,s[5]=t.end.z,i=!0),i&&(o.attributes.position.needsUpdate=!0,o.computeBoundingSphere()),r.color.setStyle(t.color),r.opacity=t.opacity,r.transparent=t.opacity<1,r.visible=t.visible},remove:function(){this.el.removeObject3D("line",this.line)}})},{"../core/component":125}],89:[function(e,t,o){var i,n,r,s,a,l,c,u,h=e("../core/component").registerComponent,g=e("../core/shader").registerShader,d=e("../lib/three");t.exports.Component=h("link",{schema:{color:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},visualAspectEnabled:{default:!0}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.hiddenEls=[],this.initVisualAspect()},update:function(e){var t=this.data,o=this.el,i=t.highlighted?t.highlightedColor:t.color;o.setAttribute("material","strokeColor",i),t.on!==e.on&&this.updateEventListener(),t.visualAspectEnabled&&void 0!==e.peekMode&&t.peekMode!==e.peekMode&&this.updatePeekMode(),t.image&&e.image!==t.image&&o.setAttribute("material","pano","string"==typeof t.image?t.image:t.image.src)},updatePeekMode:function(){var e=this.el,t=this.sphereEl;this.data.peekMode?(this.hideAll(),e.getObject3D("mesh").visible=!1,t.setAttribute("visible",!0)):(this.showAll(),e.getObject3D("mesh").visible=!0,t.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var e=this.el;e.isPlaying&&(this.removeEventListener(),e.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var e=this.data.on;e&&this.el.removeEventListener(e,this.navigate)},initVisualAspect:function(){var e,t,o,i=this.el;this.data.visualAspectEnabled&&(e=this.textEl=this.textEl||document.createElement("a-entity"),t=this.sphereEl=this.sphereEl||document.createElement("a-entity"),o=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),i.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),i.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),e.setAttribute("text",{color:"white",align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),e.setAttribute("position","0 1.5 0"),i.appendChild(e),o.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),o.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),o.setAttribute("rotation","0 180 0"),o.setAttribute("position","0 0 0"),o.setAttribute("visible",!1),i.appendChild(o),t.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),t.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),t.setAttribute("visible",!1),i.appendChild(t))},navigate:function(){window.location=this.data.href},tick:(a=new d.Vector3,l=new d.Vector3,c=new d.Vector3,u=new d.Quaternion,function(){if(this.data.visualAspectEnabled){var e,t,o=this.el,i=o.object3D,n=o.sceneEl.camera,r=this.textEl;if(i.updateMatrixWorld(),n.parent.updateMatrixWorld(),n.updateMatrixWorld(),i.matrix.decompose(a,u,c),a.setFromMatrixPosition(i.matrixWorld),l.setFromMatrixPosition(n.matrixWorld),t=a.distanceTo(l),this.previousQuaternion=this.previousQuaternion||u.clone(),t>20)i.lookAt(l);else{if(e=this.calculateCameraPortalOrientation(),t<.5){if(!0===this.semiSphereEl.getAttribute("visible"))return;r.setAttribute("text","width",1.5),e<=0?(r.setAttribute("position","0 0 0.75"),r.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(r.setAttribute("position","0 0 -0.75"),r.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),o.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=e}else e<=0?r.setAttribute("rotation","0 180 0"):r.setAttribute("rotation","0 0 0"),r.setAttribute("text","width",5),r.setAttribute("position","0 1.5 0"),o.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(i.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}),hideAll:function(){var e=this.el,t=this.hiddenEls,o=this;t.length>0||e.sceneEl.object3D.traverse(function(i){i&&i.el&&i.el.hasAttribute("link-controls")||i.el&&i!==e.sceneEl.object3D&&i.el!==e&&i.el!==o.sphereEl&&i.el!==e.sceneEl.cameraEl&&!1!==i.el.getAttribute("visible")&&i.el!==o.textEl&&i.el!==o.semiSphereEl&&(i.el.setAttribute("visible",!1),t.push(i.el))})},showAll:function(){this.hiddenEls.forEach(function(e){e.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:(i=new d.Matrix4,n=new d.Vector3,r=new d.Vector3(0,0,1),s=new d.Vector3(0,0,0),function(){var e=this.el,t=e.sceneEl.camera;return n.set(0,0,0),r.set(0,0,1),s.set(0,0,0),e.object3D.matrixWorld.extractRotation(i),r.applyMatrix4(i),e.object3D.updateMatrixWorld(),e.object3D.localToWorld(s),t.parent.parent.updateMatrixWorld(),t.parent.updateMatrixWorld(),t.updateMatrixWorld(),t.localToWorld(n),n.sub(s).normalize(),r.normalize(),Math.sign(r.dot(n))}),remove:function(){this.removeEventListener()}}),g("portal",{schema:{pano:{type:"map",is:"uniform"},borderEnabled:{default:1,type:"int",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = saturate(direction.y * 0.5  + 0.5);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(0.93, 0.17, 0.36, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join("\n")})},{"../core/component":125,"../core/shader":134,"../lib/three":173}],90:[function(e,t,o){var i,n=e("../core/component").registerComponent,r=e("../lib/three"),s=e("../constants").DEFAULT_CAMERA_HEIGHT,a=e("../utils/bind"),l=Math.PI/2,c=r.Math.radToDeg;t.exports.Component=n("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},touchEnabled:{default:!0},hmdEnabled:{default:!0},reverseMouseDrag:{default:!1},standing:{default:!0}},init:function(){var e=this.el.sceneEl;this.previousHMDPosition=new r.Vector3,this.hmdQuaternion=new r.Quaternion,this.hmdEuler=new r.Euler,this.position=new r.Vector3,this.rotation={},this.setupMouseControls(),this.setupHMDControls(),this.bindMethods(),e.addEventListener("exit-vr",this.onExitVR)},update:function(e){var t=this.data;t.enabled!==e.enabled&&this.updateGrabCursor(t.enabled),!e||t.hmdEnabled||e.hmdEnabled||(this.pitchObject.rotation.set(0,0,0),this.yawObject.rotation.set(0,0,0))},tick:function(e){var t=this.data;t.enabled&&(this.controls.standing=t.standing,this.controls.userHeight=this.getUserHeight(),this.controls.update(),this.updateOrientation(),this.updatePosition())},getUserHeight:function(){var e=this.el,t=e.hasAttribute("camera")&&e.getAttribute("camera").userHeight||s;return t},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.removeEventListeners()},bindMethods:function(){this.onMouseDown=a(this.onMouseDown,this),this.onMouseMove=a(this.onMouseMove,this),this.onMouseUp=a(this.onMouseUp,this),this.onTouchStart=a(this.onTouchStart,this),this.onTouchMove=a(this.onTouchMove,this),this.onTouchEnd=a(this.onTouchEnd,this),this.onExitVR=a(this.onExitVR,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new r.Object3D,this.yawObject=new r.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},setupHMDControls:function(){this.dolly=new r.Object3D,this.euler=new r.Euler,this.controls=new r.VRControls(this.dolly),this.controls.userHeight=0},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd)):e.addEventListener("render-target-loaded",a(this.addEventListeners,this))},removeEventListeners:function(){var e=this.el.sceneEl,t=e&&e.canvas;t&&(t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseout",this.onMouseUp),t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd))},updateOrientation:function(){var e,t,o,i=this.hmdEuler,n=this.hmdQuaternion,r=this.pitchObject,s=this.yawObject,a=this.el.sceneEl,l=this.rotation;n=n.copy(this.dolly.quaternion),i.setFromQuaternion(n,"YXZ"),a.isMobile?(l.x=c(i.x)+c(r.rotation.x),l.y=c(i.y)+c(s.rotation.y),l.z=c(i.z)):a.is("vr-mode")&&(0!==(o=i).x||0!==o.y||0!==o.z)&&this.data.hmdEnabled?(l.x=c(i.x),l.y=c(i.y),l.z=c(i.z)):(e=this.el.getAttribute("rotation"),t=this.calculateDeltaRotation(),this.data.reverseMouseDrag?(l.x=e.x-t.x,l.y=e.y-t.y,l.z=e.z):(l.x=e.x+t.x,l.y=e.y+t.y,l.z=e.z)),this.el.setAttribute("rotation",l)},calculateDeltaRotation:function(){var e,t=c(this.pitchObject.rotation.x),o=c(this.yawObject.rotation.y);return e={x:t-(this.previousRotationX||0),y:o-(this.previousRotationY||0)},this.previousRotationX=t,this.previousRotationY=o,e},updatePosition:function(){var e,t,o=this.el,i=this.position,n=this.previousHMDPosition,r=this.el.sceneEl;r.is("vr-mode")&&(e=this.calculateHMDPosition(),t=o.getAttribute("position"),i.copy(t).sub(n).add(e),o.setAttribute("position",i),n.copy(e))},calculateHMDPosition:(i=new r.Vector3,function(){return this.dolly.updateMatrix(),i.setFromMatrixPosition(this.dolly.matrix),i}),onMouseMove:function(e){var t,o,i=this.pitchObject,n=this.yawObject,r=this.previousMouseEvent;this.mouseDown&&this.data.enabled&&(t=e.movementX||e.mozMovementX,o=e.movementY||e.mozMovementY,void 0!==t&&void 0!==o||(t=e.screenX-r.screenX,o=e.screenY-r.screenY),this.previousMouseEvent=e,n.rotation.y-=.002*t,i.rotation.x-=.002*o,i.rotation.x=Math.max(-l,Math.min(l,i.rotation.x)))},onMouseDown:function(e){this.data.enabled&&0===e.button&&(this.mouseDown=!0,this.previousMouseEvent=e,document.body.classList.add("a-grabbing"))},onMouseUp:function(){this.mouseDown=!1,document.body.classList.remove("a-grabbing")},onTouchStart:function(e){1===e.touches.length&&this.data.touchEnabled&&(this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(e){var t,o=this.el.sceneEl.canvas,i=this.yawObject;this.touchStarted&&this.data.touchEnabled&&(t=2*Math.PI*(e.touches[0].pageX-this.touchStart.x)/o.clientWidth,i.rotation.y-=.5*t,this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onExitVR:function(){this.previousHMDPosition.set(0,0,0)},updateGrabCursor:function(e){var t=this.el.sceneEl;function o(){t.canvas.classList.add("a-grab-cursor")}function i(){t.canvas.classList.remove("a-grab-cursor")}t.canvas?e?o():i():e?t.addEventListener("render-target-loaded",o):t.addEventListener("render-target-loaded",i)}})},{"../constants":116,"../core/component":125,"../lib/three":173,"../utils/bind":189}],91:[function(e,t,o){var i=e("../utils/"),n=e("../core/component"),r=e("../lib/three"),s=e("../core/shader"),a=i.debug("components:material:error"),l=n.registerComponent,c=s.shaders,u=s.shaderNames;function h(e,t){e.dispose(),t.unregisterMaterial(e)}t.exports.Component=l("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:u},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0}},init:function(){this.material=null},update:function(e){var t=this.data;this.shader&&t.shader===e.shader||this.updateShader(t.shader),this.shader.update(this.data),this.updateMaterial(e)},updateSchema:function(e){var t=e.shader,o=this.data&&this.data.shader,i=t||o,n=c[i]&&c[i].schema;n||a("Unknown shader schema "+i),o&&t===o||(this.extendSchema(n),this.updateBehavior())},updateBehavior:function(){var e=this.schema,t=this,o=this.el.sceneEl,i={},n=function(e,o){Object.keys(i).forEach(function(t){i[t]=e}),t.shader.update(i)};this.tick=void 0,Object.keys(e).forEach(function(o){"time"===e[o].type&&(t.tick=n,i[o]=!0)}),o&&(this.tick?o.addBehavior(this):o.removeBehavior(this))},updateShader:function(e){var t,o=this.data,i=c[e]&&c[e].Shader;if(!i)throw new Error("Unknown shader "+e);(t=this.shader=new i).el=this.el,t.init(o),this.setMaterial(t.material),this.updateSchema(o)},updateMaterial:function(e){var t=this.data,o=this.material;o.alphaTest=t.alphaTest,o.depthTest=!1!==t.depthTest,o.depthWrite=!1!==t.depthWrite,o.opacity=t.opacity,o.flatShading=t.flatShading,o.side=function(e){switch(e){case"back":return r.BackSide;case"double":return r.DoubleSide;default:return r.FrontSide}}(t.side),o.transparent=!1!==t.transparent||t.opacity<1,o.vertexColors=function(e){switch(e){case"face":return r.FaceColors;case"vertex":return r.VertexColors;default:return r.NoColors}}(t.vertexColors),o.visible=t.visible,!Object.keys(e).length||e.alphaTest===t.alphaTest&&e.side===t.side&&e.vertexColors===t.vertexColors||(o.needsUpdate=!0)},remove:function(){var e=new r.MeshBasicMaterial,t=this.material,o=this.el.getObject3D("mesh");o&&(o.material=e),h(t,this.system)},setMaterial:function(e){var t=this.el.getOrCreateObject3D("mesh",r.Mesh),o=this.system;this.material&&h(this.material,o),this.material=t.material=e,o.registerMaterial(e)}})},{"../core/component":125,"../core/shader":134,"../lib/three":173,"../utils/":195}],92:[function(e,t,o){var i=e("../utils/debug"),n=e("../core/component").registerComponent,r=e("../lib/three"),s=i("components:obj-model:warn");t.exports.Component=n("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){this.model=null,this.objLoader=new r.OBJLoader,this.mtlLoader=new r.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin=""},update:function(){var e=this.data;e.obj&&(this.remove(),this.loadObj(e.obj,e.mtl))},remove:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(e,t){var o=this,i=this.el,n=this.mtlLoader,a=this.objLoader;if(t)return i.hasAttribute("material")&&s("Material component properties are ignored when a .MTL is provided"),n.setTexturePath(t.substr(0,t.lastIndexOf("/")+1)),void n.load(t,function(t){t.preload(),a.setMaterials(t),a.load(e,function(e){o.model=e,i.setObject3D("mesh",e),i.emit("model-loaded",{format:"obj",model:e})})});a.load(e,function(e){var t=i.components.material;t&&e.traverse(function(e){e instanceof r.Mesh&&(e.material=t.material)}),o.model=e,i.setObject3D("mesh",e),i.emit("model-loaded",{format:"obj",model:e})})}})},{"../core/component":125,"../lib/three":173,"../utils/debug":191}],93:[function(e,t,o){var i=e("../utils/bind"),n=e("../core/component").registerComponent,r=e("../utils/tracked-controls"),s={x:0,y:-.015,z:.04};t.exports.Component=n("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},rotationOffset:{default:0}},mapping:{left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},bindMethods:function(){this.onModelLoaded=i(this.onModelLoaded,this),this.onControllersUpdate=i(this.onControllersUpdate,this),this.checkIfControllerPresent=i(this.checkIfControllerPresent,this),this.onAxisMoved=i(this.onAxisMoved,this)},init:function(){var e=this;this.onButtonChanged=i(this.onButtonChanged,this),this.onButtonDown=function(t){e.onButtonEvent(t.detail.id,"down")},this.onButtonUp=function(t){e.onButtonEvent(t.detail.id,"up")},this.onButtonTouchStart=function(t){e.onButtonEvent(t.detail.id,"touchstart")},this.onButtonTouchEnd=function(t){e.onButtonEvent(t.detail.id,"touchend")},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.emitIfAxesChanged=r.emitIfAxesChanged,this.checkControllerPresentAndSetup=r.checkControllerPresentAndSetup},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("axismove",this.onAxisMoved),e.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("axismove",this.onAxisMoved),e.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Oculus Touch",{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){var e,t;this.data.model&&("right"===this.data.hand?(e="url(https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-right.obj)",t="url(https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-right.mtl)"):(e="url(https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-left.obj)",t="url(https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-left.mtl)"),this.el.setAttribute("obj-model",{obj:e,mtl:t}))},injectTrackedControls:function(){var e=this.data,t="right"===e.hand?-90:90;this.el.setAttribute("tracked-controls",{id:"right"===e.hand?"Oculus Touch (Right)":"Oculus Touch (Left)",controller:0,rotationOffset:-999!==e.rotationOffset?e.rotationOffset:t}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t,o=this.mapping[this.data.hand].buttons[e.detail.id],i=this.buttonMeshes;o&&("trigger"!==o&&"grip"!==o||(t=e.detail.state.value),i&&("trigger"===o&&i.trigger&&(i.trigger.rotation.x=-t*(Math.PI/24)),"grip"===o&&i.grip&&(i.grip.rotation.y=("left"===this.data.hand?-1:1)*t*(Math.PI/60))),this.el.emit(o+"changed",e.detail.state))},onModelLoaded:function(e){var t,o=e.detail.model;if(this.data.model){var i="left"===this.data.hand;(t=this.buttonMeshes={}).grip=o.getObjectByName(i?"buttonHand_oculus-touch-controller-left.004":"buttonHand_oculus-touch-controller-right.005"),t.thumbstick=o.getObjectByName(i?"stick_oculus-touch-controller-left.007":"stick_oculus-touch-controller-right.004"),t.trigger=o.getObjectByName(i?"buttonTrigger_oculus-touch-controller-left.005":"buttonTrigger_oculus-touch-controller-right.006"),t.xbutton=o.getObjectByName("buttonX_oculus-touch-controller-left.002"),t.abutton=o.getObjectByName("buttonA_oculus-touch-controller-right.002"),t.ybutton=o.getObjectByName("buttonY_oculus-touch-controller-left.001"),t.bbutton=o.getObjectByName("buttonB_oculus-touch-controller-right.003"),o.position=s}},onButtonEvent:function(e,t){var o,i=this.mapping[this.data.hand].buttons[e];if(Array.isArray(i))for(o=0;o<i.length;o++)this.el.emit(i[o]+t);else this.el.emit(i+t);this.updateModel(i,t)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping[this.data.hand].axes,e)},updateModel:function(e,t){var o;if(Array.isArray(e))for(o=0;o<e.length;o++)this.updateButtonModel(e[o],t);else this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var o="up"===t||"touchend"===t?this.data.buttonColor:"touchstart"===t?this.data.buttonTouchColor:this.data.buttonHighlightColor,i=this.buttonMeshes;this.data.model&&i&&i[e]&&i[e].material.color.set(o)}})},{"../core/component":125,"../utils/bind":189,"../utils/tracked-controls":199}],94:[function(e,t,o){var i=e("../core/component").registerComponent;t.exports.Component=i("position",{schema:{type:"vec3"},update:function(){var e=this.el.object3D,t=this.data;e.position.set(t.x,t.y,t.z)}})},{"../core/component":125}],95:[function(e,t,o){var i,n,r,s,a,l,c=e("../core/component").registerComponent,u=e("../lib/three"),h=e("../utils/"),g=h.bind,d=new u.Vector3;t.exports.Component=c("raycaster",{schema:{direction:{type:"vec3",default:{x:0,y:0,z:-1}},far:{default:1e3},interval:{default:100},near:{default:0},objects:{default:""},origin:{type:"vec3"},recursive:{default:!0},showLine:{default:!1},useWorldCoordinates:{default:!1}},init:function(){this.lineData={},this.lineEndVec3=new u.Vector3,this.unitLineEndVec3=new u.Vector3,this.intersectedEls=[],this.objects=null,this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.raycaster=new u.Raycaster,this.updateOriginDirection(),this.refreshObjects=g(this.refreshObjects,this),this.refreshOnceChildLoaded=g(this.refreshOnceChildLoaded,this)},update:function(e){var t=this.data,o=this.el,i=this.raycaster;i.far=t.far,i.near=t.near,!t.showLine||t.far===e.far&&t.origin===e.origin&&t.direction===e.direction&&t.showLine===e.showLine||(this.unitLineEndVec3.copy(t.origin).add(t.direction).normalize(),this.drawLine()),!t.showLine&&e.showLine&&o.removeAttribute("line"),this.refreshObjects()},play:function(){this.el.sceneEl.addEventListener("loaded",this.refreshObjects),this.el.sceneEl.addEventListener("child-attached",this.refreshOnceChildLoaded),this.el.sceneEl.addEventListener("child-detached",this.refreshObjects)},pause:function(){this.el.sceneEl.removeEventListener("loaded",this.refreshObjects),this.el.sceneEl.removeEventListener("child-attached",this.refreshOnceChildLoaded),this.el.sceneEl.removeEventListener("child-detached",this.refreshObjects)},remove:function(){this.data.showLine&&this.el.removeAttribute("line")},refreshOnceChildLoaded:function(e){var t=this,o=e.detail.el;o&&(o.hasLoaded?this.refreshObjects():o.addEventListener("loaded",function e(i){o.removeEventListener("loaded",e),t.refreshObjects()}))},refreshObjects:function(){var e,t,o,i=this.data,n=i.objects?this.el.sceneEl.querySelectorAll(i.objects):null;if(n)for(o=[],t=0;t<n.length;t++)o.push(n[t].object3D);else o=this.el.sceneEl.object3D.children;for(this.objects=[],t=0;t<o.length;t++)(e=o[t].children)&&this.objects.push.apply(this.objects,e)},tick:(l=[],function(e){var t,o,i,n,r=this.el,s=this.data,a=this.intersectedEls,c=this.prevCheckTime,u=this.prevIntersectedEls;if(!(c&&e-c<s.interval)){for(this.prevCheckTime=e,function(e,t){var o;for(e.length=t.length,o=0;o<t.length;o++)e[o]=t[o]}(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),n=this.raycaster.intersectObjects(this.objects,s.recursive),l.length=0,t=0;t<n.length;t++)o=n[t],s.showLine&&o.object===r.getObject3D("line")||o.object.el&&l.push(o);for(a.length=l.length,t=0;t<l.length;t++)a[t]=l[t].object.el;for(t=0;t<l.length;t++)l[t].object.el.emit("raycaster-intersected",{el:r,intersection:l[t]});for(l.length&&r.emit("raycaster-intersection",{els:a,intersections:l}),t=0;t<u.length;t++){if(-1!==a.indexOf(u[t]))return;r.emit("raycaster-intersection-cleared",{el:u[t]}),u[t].emit("raycaster-intersected-cleared",{el:r})}s.showLine&&(l.length&&(i=l[0].object.el===r&&l[1]?l[1].distance:l[0].distance),this.drawLine(i))}}),updateOriginDirection:(r=new u.Vector3,s=new u.Quaternion,a=new u.Vector3,function(){var e=this.el,t=this.data;t.useWorldCoordinates?this.raycaster.set(t.origin,t.direction):(e.object3D.updateMatrixWorld(),e.object3D.matrixWorld.decompose(a,s,d),0===t.origin.x&&0===t.origin.y&&0===t.origin.z||(a=e.object3D.localToWorld(a.copy(t.origin))),r.copy(t.direction).add(t.origin).applyQuaternion(s).normalize(),this.raycaster.set(a,r))}),drawLine:(i=new u.Vector3,n={},function(e){var t=this.data,o=this.el;void 0===e&&(e=t.far===1/0?1e3:t.far),n.start=t.origin,n.end=i.copy(this.unitLineEndVec3).multiplyScalar(e),o.setAttribute("line",n)})})},{"../core/component":125,"../lib/three":173,"../utils/":195}],96:[function(e,t,o){var i=e("../lib/three").Math.degToRad,n=e("../core/component").registerComponent;t.exports.Component=n("rotation",{schema:{type:"vec3"},update:function(){var e=this.data,t=this.el.object3D;t.rotation.set(i(e.x),i(e.y),i(e.z)),t.rotation.order="YXZ"}})},{"../core/component":125,"../lib/three":173}],97:[function(e,t,o){var i=e("../core/component").registerComponent;t.exports.Component=i("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var e=this.data,t=this.el.object3D,o=0===e.x?1e-5:e.x,i=0===e.y?1e-5:e.y,n=0===e.z?1e-5:e.z;t.scale.set(o,i,n)}})},{"../core/component":125}],98:[function(e,t,o){var i=e("../../core/component").registerComponent;t.exports.Component=i("debug",{schema:{default:!0}})},{"../../core/component":125}],99:[function(e,t,o){var i=e("../../core/component").registerComponent;t.exports.Component=i("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var e=this.el,t=e.querySelector(".a-enter-vr");!0===this.data?(t&&t.classList.add("embedded"),e.removeFullScreenStyles()):(t&&t.classList.remove("embedded"),e.addFullScreenStyles())}})},{"../../core/component":125}],100:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../lib/three"),r=e("../../utils/debug"),s=r("components:fog:warn");t.exports.Component=i("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var e=this.data,t=this.el,o=this.el.object3D.fog;if(t.isScene)return o&&e.type===o.name?void Object.keys(this.schema).forEach(function(t){var i=e[t];"color"===t&&(i=new n.Color(i)),o[t]=i}):(t.object3D.fog=function(e){var t;return(t="exponential"===e.type?new n.FogExp2(e.color,e.density):new n.Fog(e.color,e.near,e.far)).name=e.type,t}(e),void t.systems.material.updateMaterials());s("Fog component can only be applied to <a-scene>")},remove:function(){var e=this.el.object3D.fog;e&&(e.far=0,e.near=.1)}})},{"../../core/component":125,"../../lib/three":173,"../../utils/debug":191}],101:[function(e,t,o){(function(o){var i,n,r=e("../../constants").AFRAME_INJECTED,s=e("../../utils/bind"),a=e("../../../package"),l=e("../../core/component").registerComponent,c="https://unpkg.com/aframe-inspector@"+(i=a.version,(n=i.split("."))[2]="x",n.join("."))+"/dist/aframe-inspector.min.js",u="dev"===o.env.INSPECTOR_VERSION?"https://aframe.io/aframe-inspector/dist/aframe-inspector.js":c;t.exports.Component=l("inspector",{schema:{url:{default:u}},init:function(){this.onKeydown=s(this.onKeydown,this),this.onMessage=s(this.onMessage,this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},initOverlay:function(){this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML='Loading Inspector<span class="dots"><span>.</span><span>.</span><span>.</span></span>'},remove:function(){this.removeEventListeners()},onKeydown:function(e){var t=73===e.keyCode&&e.ctrlKey&&e.altKey;this.data&&t&&this.injectInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(e){"INJECT_AFRAME_INSPECTOR"===e.data&&this.injectInspector()},injectInspector:function(){var e,t=this;AFRAME.INSPECTOR||AFRAME.inspectorInjected||(this.showLoader(),(e=document.createElement("script")).src=this.data.url,e.setAttribute("data-name","aframe-inspector"),e.setAttribute(r,""),e.onload=function(){AFRAME.INSPECTOR.open(),t.hideLoader(),t.removeEventListeners()},e.onerror=function(){t.loadingMessageEl.innerHTML="Error loading Inspector"},document.head.appendChild(e),AFRAME.inspectorInjected=!0)},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,e("_process"))},{"../../../package":76,"../../constants":116,"../../core/component":125,"../../utils/bind":189,_process:6}],102:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../utils/").shouldCaptureKeyEvent;t.exports.Component=i("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){var e=this,t=this.el;this.listener=window.addEventListener("keyup",function(o){n(o)&&(e.enterVREnabled&&70===o.keyCode&&t.enterVR(),e.enterVREnabled&&27===o.keyCode&&t.exitVR())},!1)},update:function(e){var t=this.data;this.enterVREnabled=t.enterVR},remove:function(){window.removeEventListener("keyup",this.listener)}})},{"../../core/component":125,"../../utils/":195}],103:[function(e,t,o){var i=e("../../utils/debug"),n=e("../../core/component").registerComponent,r=i("components:pool:warn");t.exports.Component=n("pool",{schema:{mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var e,t=this.data.mixin;if(t)for(this.availableEls=[],this.usedEls=[],e=0;e<this.data.size;++e)this.createEntity()},update:function(e){var t=this.data;e.mixin===t.mixin&&e.size===t.size||this.initPool()},createEntity:function(){var e=document.createElement("a-entity");e.play=this.wrapPlay(e.play),e.setAttribute("mixin",this.data.mixin),e.setAttribute("visible",!1),this.el.appendChild(e),this.availableEls.push(e)},wrapPlay:function(e){var t=this.usedEls;return function(){-1!==t.indexOf(this)&&e.call(this)}},requestEntity:function(){var e;if(0===this.availableEls.length){if(!1===this.data.dynamic)return void r("Requested entity from empty pool "+this.name);r("Requested entity from empty pool. This pool is dynamicand will resize automatically. You might want to increase its initial size"+this.name),this.createEntity()}return e=this.availableEls.shift(),this.usedEls.push(e),e.setAttribute("visible",!0),e},returnEntity:function(e){var t=this.usedEls.indexOf(e);-1!==t?(this.usedEls.splice(t,1),this.availableEls.push(e),e.setAttribute("visible",!1),e.pause()):r("The returned entity was not previously pooled from "+this.name)}})},{"../../core/component":125,"../../utils/debug":191}],104:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../lib/three"),r=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),s=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join("\n");t.exports.Component=i("screenshot",{schema:{width:{default:4096},height:{default:2048}},init:function(){var e=this.el,t=this;function o(){var o=e.renderer.getContext();t.cubeMapSize=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),t.material=new n.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:r,fragmentShader:s,side:n.DoubleSide}),t.quad=new n.Mesh(new n.PlaneBufferGeometry(1,1),t.material),t.quad.visible=!1,t.camera=new n.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),t.canvas=document.createElement("canvas"),t.ctx=t.canvas.getContext("2d"),e.camera&&e.camera.add(t.quad),t.onKeyDown=t.onKeyDown.bind(t),t.onCameraActive=t.onCameraActive.bind(t),e.addEventListener("camera-set-active",t.onCameraActive)}e.renderer?o():e.addEventListener("render-target-loaded",o)},getRenderTarget:function(e,t){return new n.WebGLRenderTarget(e,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,wrapS:n.ClampToEdgeWrapping,wrapT:n.ClampToEdgeWrapping,format:n.RGBAFormat,type:n.UnsignedByteType})},resize:function(e,t){this.quad.scale.set(e,t,1),this.camera.left=-1*e/2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=-1*t/2,this.camera.updateProjectionMatrix(),this.canvas.width=e,this.canvas.height=t},play:function(){window.addEventListener("keydown",this.onKeyDown)},onCameraActive:function(e){var t=this.quad.parent;t&&t.remove(this.quad),e.detail.cameraEl.getObject3D("camera").add(this.quad)},onKeyDown:function(e){var t=83===e.keyCode&&e.ctrlKey&&e.altKey;if(this.data&&t){var o=e.shiftKey?"equirectangular":"perspective";this.capture(o)}},setCapture:function(e){var t,o,i,r=this.el;return"perspective"===e?(this.quad.visible=!1,o=r.camera,t={width:this.data.width,height:this.data.height}):((o=this.camera).position.copy(r.camera.getWorldPosition()),o.rotation.copy(r.camera.getWorldRotation()),(i=new n.CubeCamera(r.camera.near,r.camera.far,Math.min(this.cubeMapSize,2048))).position.copy(r.camera.getWorldPosition()),i.rotation.copy(r.camera.getWorldRotation()),i.updateCubeMap(r.renderer,r.object3D),this.quad.material.uniforms.map.value=i.renderTarget.texture,t={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:o,size:t,projection:e}},capture:function(e){var t=this.setCapture(e);this.renderCapture(t.camera,t.size,t.projection),this.saveCapture()},getCanvas:function(e){var t=this.setCapture(e);return this.renderCapture(t.camera,t.size,t.projection),this.canvas},renderCapture:function(e,t,o){var i,n,r,s=this.el.renderer.autoClear,a=this.el,l=this.el.renderer;n=this.getRenderTarget(t.width,t.height),r=new Uint8Array(4*t.width*t.height),this.resize(t.width,t.height),l.autoClear=!0,l.render(a.object3D,e,n,!0),l.autoClear=s,l.readRenderTargetPixels(n,0,0,t.width,t.height,r),"perspective"===o&&(r=this.flipPixelsVertically(r,t.width,t.height)),i=new ImageData(new Uint8ClampedArray(r),t.width,t.height),this.quad.visible=!1,this.ctx.putImageData(i,0,0)},flipPixelsVertically:function(e,t,o){for(var i=e.slice(0),n=0;n<t;++n)for(var r=0;r<o;++r)i[4*n+r*t*4]=e[4*n+(o-r)*t*4],i[4*n+1+r*t*4]=e[4*n+1+(o-r)*t*4],i[4*n+2+r*t*4]=e[4*n+2+(o-r)*t*4],i[4*n+3+r*t*4]=e[4*n+3+(o-r)*t*4];return i},saveCapture:function(){this.canvas.toBlob(function(e){var t="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",o=document.createElement("a"),i=URL.createObjectURL(e);o.href=i,o.setAttribute("download",t),o.innerHTML="downloading...",o.style.display="none",document.body.appendChild(o),setTimeout(function(){o.click(),document.body.removeChild(o)},1)},"image/png")}})},{"../../core/component":125,"../../lib/three":173}],105:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../../vendor/rStats"),r=e("../../utils");e("../../../vendor/rStats.extras"),e("../../lib/rStatsAframe");var s=window.aframeStats,a=r.bind,l=window.threeStats;t.exports.Component=i("stats",{schema:{default:!0},init:function(){var e=this.el;"false"!==r.getUrlParameter("stats")&&(this.stats=function(e){var t=new l(e.renderer),o=new s(e),i=e.isMobile?[]:[t,o];return new n({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:i})}(e),this.statsEl=document.querySelector(".rs-base"),this.hideBound=a(this.hide,this),this.showBound=a(this.show,this),e.addEventListener("enter-vr",this.hideBound),e.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var e=this.stats;e&&(e("rAF").tick(),e("FPS").frame(),e().update())},hide:function(){this.statsEl.classList.add("a-hidden")},show:function(){this.statsEl.classList.remove("a-hidden")}})},{"../../../vendor/rStats":203,"../../../vendor/rStats.extras":202,"../../core/component":125,"../../lib/rStatsAframe":172,"../../utils":195}],106:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../constants/"),r=e("../../utils/"),s=r.bind,a="a-enter-vr",l="a-enter-vr-button",c="a-hidden",u="a-orientation-modal";t.exports.Component=i("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0}},init:function(){var e=this,t=this.el;"false"!==r.getUrlParameter("ui")&&(this.enterVR=s(t.enterVR,t),this.exitVR=s(t.exitVR,t),this.insideLoader=!1,this.enterVREl=null,this.orientationModalEl=null,t.addEventListener("enter-vr",s(this.updateEnterVRInterface,this)),t.addEventListener("exit-vr",s(this.updateEnterVRInterface,this)),window.addEventListener("message",function(t){"loaderReady"===t.data.type&&(e.insideLoader=!0,e.remove())}),window.addEventListener("orientationchange",s(this.toggleOrientationModalIfNeeded,this)))},update:function(){var e,t,o,i=this.el;if(!this.data.enabled||this.insideLoader||"false"===r.getUrlParameter("ui"))return this.remove();this.enterVREl||this.orientationModalEl||(this.enterVREl=(e=this.enterVR,(o=document.createElement("div")).classList.add(a),o.setAttribute(n.AFRAME_INJECTED,""),(t=document.createElement("button")).className=l,t.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),t.setAttribute(n.AFRAME_INJECTED,""),o.appendChild(t),t.addEventListener("click",function(t){e()}),o),i.appendChild(this.enterVREl),this.orientationModalEl=function(e){var t=document.createElement("div");t.className=u,t.classList.add(c),t.setAttribute(n.AFRAME_INJECTED,"");var o=document.createElement("button");return o.setAttribute(n.AFRAME_INJECTED,""),o.innerHTML="Exit VR",o.addEventListener("click",e),t.appendChild(o),t}(this.exitVR),i.appendChild(this.orientationModalEl),this.updateEnterVRInterface())},remove:function(){[this.enterVREl,this.orientationModalEl].forEach(function(e){e&&e.parentNode.removeChild(e)})},updateEnterVRInterface:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var e=this.el;this.enterVREl&&(e.is("vr-mode")?this.enterVREl.classList.add(c):this.enterVREl.classList.remove(c))},toggleOrientationModalIfNeeded:function(){var e=this.el,t=this.orientationModalEl;t&&e.isMobile&&(!r.device.isLandscape()&&e.is("vr-mode")?t.classList.remove(c):t.classList.add(c))}})},{"../../constants/":116,"../../core/component":125,"../../utils/":195}],107:[function(e,t,o){var i=e("../core/component"),n=e("../lib/three"),r=e("../utils/bind"),s=i.registerComponent;t.exports.Component=s("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=r(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var e=this.data;this.updateDescendants(e.cast,e.receive)},remove:function(){var e=this.el;e.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(e,t){var o=this.el.sceneEl;this.el.object3D.traverse(function(i){if(i instanceof n.Mesh&&(i.castShadow=e,i.receiveShadow=t,o.hasLoaded&&i.material))for(var r=i.material.materials||[i.material],s=0;s<r.length;s++)r[s].needsUpdate=!0})}})},{"../core/component":125,"../lib/three":173,"../utils/bind":189}],108:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/debug"),r=e("../utils/bind"),s=e("../lib/three"),a=n("components:sound:warn");t.exports.Component=i("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){this.listener=null,this.audioLoader=new s.AudioLoader,this.pool=new s.Group,this.loaded=!1,this.mustPlay=!1,this.playSound=r(this.playSound,this)},update:function(e){var t=this.data,o=t.src!==e.src;if(o){if(!t.src)return void a("Audio source was not specified with `src`");this.setupSound()}if(this.pool.children.forEach(function(e){t.positional&&(e.setDistanceModel(t.distanceModel),e.setMaxDistance(t.maxDistance),e.setRefDistance(t.refDistance),e.setRolloffFactor(t.rolloffFactor)),e.setLoop(t.loop),e.setVolume(t.volume),e.isPaused=!1}),t.on!==e.on&&this.updateEventListener(e.on),o){var i=this;this.loaded=!1,this.audioLoader.load(t.src,function(e){i.pool.children.forEach(function(t){t.setBuffer(e)}),i.loaded=!0,s.Cache.remove(t.src),(i.data.autoplay||i.mustPlay)&&i.playSound(),i.el.emit("sound-loaded")})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){this.removeEventListener(),this.el.removeObject3D(this.attrName);try{this.pool.children.forEach(function(e){e.disconnect()})}catch(e){a("Audio source not properly disconnected")}},updateEventListener:function(e){var t=this.el;e&&t.removeEventListener(e,this.playSound),t.addEventListener(this.data.on,this.playSound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSound)},setupSound:function(){var e=this.el,t=e.sceneEl;this.pool.children.length>0&&(this.stopSound(),e.removeObject3D("sound"));var o=this.listener=t.audioListener||new s.AudioListener;t.audioListener=o,t.camera&&t.camera.add(o),t.addEventListener("camera-set-active",function(e){e.detail.cameraEl.getObject3D("camera").add(o)}),this.pool=new s.Group;for(var i=0;i<this.data.poolSize;i++){var n=this.data.positional?new s.PositionalAudio(o):new s.Audio(o);this.pool.add(n)}e.setObject3D(this.attrName,this.pool),this.pool.children.forEach(function(t){t.onEnded=function(){t.isPlaying=!1,e.emit("sound-ended",{index:i})}})},pauseSound:function(){this.isPlaying=!1,this.pool.children.forEach(function(e){e.source&&e.source.buffer&&e.isPlaying&&!e.isPaused&&(e.isPaused=!0,e.pause())})},playSound:function(){if(!this.loaded)return a("Sound not loaded yet. It will be played once it finished loading"),void(this.mustPlay=!0);var e=!1;this.isPlaying=!0,this.pool.children.forEach(function(t){if(!t.isPlaying&&t.buffer&&!e)return t.play(),t.isPaused=!1,void(e=!0)}),e?this.mustPlay=!1:a("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el)},stopSound:function(){this.isPlaying=!1,this.pool.children.forEach(function(e){e.source&&e.source.buffer&&e.stop()})}})},{"../core/component":125,"../lib/three":173,"../utils/bind":189,"../utils/debug":191}],109:[function(e,t,o){var i=e("three-bmfont-text"),n=e("load-bmfont"),r=e("path"),s=e("../core/component").registerComponent,a=e("../core/shader"),l=e("../lib/three"),c=e("../utils/"),u=c.debug("components:text:error"),h=a.shaders,g=c.debug("components:text:warn"),d="https://cdn.aframe.io/fonts/",p={aileronsemibold:d+"Aileron-Semibold.fnt",dejavu:d+"DejaVu-sdf.fnt",exo2bold:d+"Exo2Bold.fnt",exo2semibold:d+"Exo2SemiBold.fnt",kelsonsans:d+"KelsonSans.fnt",monoid:d+"Monoid.fnt",mozillavr:d+"mozillavr.fnt",roboto:d+"Roboto-msdf.json",sourcecodepro:d+"SourceCodePro.fnt"},f=["roboto"];t.exports.FONTS=p;var m=new function(){var e=this.cache={};this.get=function(t,o){return t in e?e[t]:(e[t]=o(),e[t])}},y={};function v(e){return void 0!==(e=c.clone(e)).lineHeight&&(e.lineHeight=parseFloat(e.lineHeight),isFinite(e.lineHeight)||(e.lineHeight=void 0)),void 0!==e.width&&(e.width=parseFloat(e.width),isFinite(e.width)||(e.width=void 0)),e}function E(e,t){e.side=t.side}function _(e,t,o){return e||(.5+t)*o}t.exports.Component=s("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:"roboto"},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:h},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.texture=new l.Texture,this.texture.anisotropy=16,this.geometry=i(),this.createOrUpdateMaterial(),this.mesh=new l.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh)},update:function(e){var t=v(this.data),o=this.currentFont;this.createOrUpdateMaterial(),e.font===t.font?o&&(this.updateGeometry(this.geometry,t,o),this.updateLayout(t)):this.updateFont()},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var e,t,o,i,n=this.data,r=this.material;if(i=n.shader,-1!==f.indexOf(n.font)||n.font.indexOf("-msdf.")>=0?i="msdf":n.font in p&&-1===f.indexOf(n.font)&&(i="sdf"),e=(this.shaderObject&&this.shaderObject.name)!==i,o={alphaTest:n.alphaTest,color:n.color,map:this.texture,opacity:n.opacity,side:function(e){switch(e){case"back":return l.BackSide;case"double":return l.DoubleSide;default:return l.FrontSide}}(n.side),transparent:n.transparent},!e)return this.shaderObject.update(o),r.transparent=o.transparent,void E(r,o);t=function(e,t,o){var i,n;return(n=new h[t].Shader).el=e,n.init(o),n.update(o),(i=n.material).transparent=o.transparent,{material:i,shader:n}}(this.el,i,o),this.material=t.material,this.shaderObject=t.shader,E(this.material,o),this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var e,t=this.data,o=this.el,i=this.geometry,s=this;t.font||g("No font specified. Using the default font."),this.mesh.visible=!1,e=this.lookupFont(t.font||"roboto")||t.font,m.get(e,function(){return o=e,i=t.yOffset,new Promise(function(e,t){n(o,function(n,r){if(n)return u("Error loading font",o),void t(n);o.indexOf("/Roboto-msdf.json")>=0&&(i=30),i&&r.chars.map(function(e){e.yoffset+=i}),e(r)})});var o,i}).then(function(n){var a,c;if(1!==n.pages.length)throw new Error("Currently only single-page bitmap fonts are supported.");y[e]||(n.widthFactor=y[n]=function(e){var t=0,o=0,i=0;return e.chars.map(function(e){t+=e.xadvance,e.id>=48&&e.id<=57&&(i++,o+=e.xadvance)}),i?o/i:t/e.chars.length}(n)),a=v(t),s.updateGeometry(i,s.data,n),s.currentFont=n,s.updateLayout(a),c=t.fontImage||e.replace(/(\.fnt)|(\.json)/,".png")||r.dirname(t.font)+"/"+n.pages[0],m.get(c,function(){return e=c,new Promise(function(t,o){(new l.ImageLoader).load(e,function(e){t(e)},void 0,function(){u("Error loading font image",e),o(null)})});var e}).then(function(e){s.mesh.visible=!0,s.texture.image=e,s.texture.needsUpdate=!0,o.emit("textfontset",{font:t.font,fontObj:n})}).catch(function(e){throw u(e),e})}).catch(function(e){throw u(e),e})},updateLayout:function(e){var t,o,i,n,r,s,a,l,c=this.el,u=this.geometry,h=c.getAttribute("geometry"),g=u.layout,d=this.mesh;if(h=c.getAttribute("geometry"),s=e.width||h&&h.width||1,n=_(e.wrapPixels,e.wrapCount,this.currentFont.widthFactor),i=(r=s/n)*(g.height+g.descender),h&&(h.width||c.setAttribute("geometry","width",s),h.height||c.setAttribute("geometry","height",i)),"left"===(t="align"===e.anchor?e.align:e.anchor))a=0;else if("right"===t)a=-1*g.width;else{if("center"!==t)throw new TypeError("Invalid text.anchor property value",t);a=-1*g.width/2}if("bottom"===(o=e.baseline))l=0;else if("top"===o)l=-1*g.height+g.ascender;else{if("center"!==o)throw new TypeError("Invalid text.baseline property value",o);l=-1*g.height/2}d.position.x=a*r,d.position.y=l*r,d.position.z=e.zOffset,d.scale.set(r,-1*r,r),this.geometry.computeBoundingSphere()},lookupFont:function(e){return p[e]},updateGeometry:function(e,t,o){e.update(c.extend({},t,{font:o,width:_(t.wrapPixels,t.wrapCount,o.widthFactor),text:t.value.toString().replace(/\\n/g,"\n").replace(/\\t/g,"\t"),lineHeight:t.lineHeight||o.common.lineHeight}))}})},{"../core/component":125,"../core/shader":134,"../lib/three":173,"../utils/":195,"load-bmfont":24,path:32,"three-bmfont-text":37}],110:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/tracked-controls"),r=e("../lib/three"),s=e("../constants").DEFAULT_CAMERA_HEIGHT,a=e("../constants").DEFAULT_HANDEDNESS,l={x:.175,y:-.3,z:-.03},c={x:0,y:0,z:-.175};t.exports.Component=i("tracked-controls",{schema:{controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},rotationOffset:{default:0},armModel:{default:!0},headElement:{type:"selector"}},init:function(){this.axis=[0,0,0],this.buttonStates={},this.targetControllerNumber=this.data.controller,this.dolly=new r.Object3D,this.controllerEuler=new r.Euler,this.controllerEuler.order="YXZ",this.controllerPosition=new r.Vector3,this.controllerQuaternion=new r.Quaternion,this.deltaControllerPosition=new r.Vector3,this.position=new r.Vector3,this.rotation={},this.standingMatrix=new r.Matrix4,this.previousControllerPosition=new r.Vector3,this.updateGamepad()},tick:function(e,t){var o=this.el.getObject3D("mesh");o&&o.update&&o.update(t/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return s},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var e=this.data,t=n.findMatchingController(this.system.controllers,e.id,e.idPrefix,e.hand,e.controller);this.controller=t},applyArmModel:function(e){var t,o,i,n,r,s,u=this.controller,h=this.controllerEuler,g=this.controllerQuaternion,d=this.deltaControllerPosition;i=this.getHeadElement(),n=i.object3D,o=i.components.camera,s=(o?o.data.userHeight:0)||this.defaultUserHeight(),r=u.pose,t=(u?u.hand:void 0)||a,e.copy(n.position),d.set(l.x*("left"===t?-1:"right"===t?1:0),l.y,l.z),d.multiplyScalar(s),d.applyAxisAngle(n.up,n.rotation.y),e.add(d),d.set(c.x,c.y,c.z),d.multiplyScalar(s),r.orientation?g.fromArray(r.orientation):g.copy(n.quaternion),h.setFromQuaternion(g),h.set(h.x,h.y,0),d.applyEuler(h),e.add(d)},updatePose:function(){var e,t,o=this.controller,i=this.controllerEuler,n=this.controllerPosition,s=this.previousControllerPosition,a=this.dolly,l=this.el,c=this.standingMatrix,u=this.system.vrDisplay,h=this.getHeadElement(),g=h.components.camera,d=(g?g.data.userHeight:0)||this.defaultUserHeight();o&&(null!==(t=o.pose).orientation&&a.quaternion.fromArray(t.orientation),null!==t.position?a.position.fromArray(t.position):this.data.armModel&&this.applyArmModel(a.position),null!=t.position&&u?u.stageParameters?(c.fromArray(u.stageParameters.sittingToStandingTransform),a.matrix.compose(a.position,a.quaternion,a.scale),a.matrix.multiplyMatrices(c,a.matrix)):(a.position.y+=d,a.matrix.compose(a.position,a.quaternion,a.scale)):a.matrix.compose(a.position,a.quaternion,a.scale),i.setFromRotationMatrix(a.matrix),n.setFromMatrixPosition(a.matrix),this.rotation.x=r.Math.radToDeg(i.x),this.rotation.y=r.Math.radToDeg(i.y),this.rotation.z=r.Math.radToDeg(i.z)+this.data.rotationOffset,l.setAttribute("rotation",this.rotation),e=l.getAttribute("position"),this.position.copy(e).sub(s).add(n),l.setAttribute("position",this.position),s.copy(n))},updateButtons:function(){var e,t,o=this.controller;if(o){for(t=0;t<o.buttons.length;++t)this.buttonStates[t]||(this.buttonStates[t]={pressed:!1,touched:!1,value:0}),e=o.buttons[t],this.handleButton(t,e);this.handleAxes()}},handleButton:function(e,t){var o=this.handlePress(e,t)||this.handleTouch(e,t)||this.handleValue(e,t);return!!o&&(this.el.emit("buttonchanged",{id:e,state:t}),!0)},handleAxes:function(){var e,t=!1,o=this.controller.axes,i=this.axis,n=[];for(e=0;e<o.length;++e)n.push(i[e]!==o[e]),n[e]&&(t=!0);return!!t&&(this.axis=o.slice(),this.el.emit("axismove",{axis:this.axis,changed:n}),!0)},handlePress:function(e,t){var o,i=this.buttonStates[e];return t.pressed!==i.pressed&&(o=t.pressed?"down":"up",this.el.emit("button"+o,{id:e,state:t}),i.pressed=t.pressed,!0)},handleTouch:function(e,t){var o,i=this.buttonStates[e];return t.touched!==i.touched&&(o=t.touched?"start":"end",this.el.emit("touch"+o,{id:e,state:t},!0,{touches:[]}),i.touched=t.touched,!0)},handleValue:function(e,t){var o=this.buttonStates[e];return t.value!==o.value&&(o.value=t.value,!0)}})},{"../constants":116,"../core/component":125,"../lib/three":173,"../utils/tracked-controls":199}],111:[function(e,t,o){var i=e("../core/component").registerComponent;t.exports.Component=i("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":125}],112:[function(e,t,o){var i=e("../core/component").registerComponent,n=e("../utils/"),r=n.bind,s=n.trackedControls.checkControllerPresentAndSetup,a=n.trackedControls.emitIfAxesChanged;t.exports.Component=i("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},rotationOffset:{default:0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},init:function(){var e=this;this.animationActive="pointing",this.checkControllerPresentAndSetup=s,this.controllerPresent=!1,this.emitIfAxesChanged=a,this.lastControllerCheck=0,this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(t){e.onButtonEvent(t.detail.id,"down")},this.onButtonUp=function(t){e.onButtonEvent(t.detail.id,"up")},this.onButtonTouchEnd=function(t){e.onButtonEvent(t.detail.id,"touchend")},this.onButtonTouchStart=function(t){e.onButtonEvent(t.detail.id,"touchstart")},this.onAxisMoved=r(this.onAxisMoved,this),this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var e=this.data,t="right"===e.hand?0:"left"===e.hand?1:2;this.checkControllerPresentAndSetup(this,"OpenVR ",{index:t})},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{idPrefix:"OpenVR ",controller:"right"===t.hand?0:"left"===t.hand?1:2,rotationOffset:t.rotationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",mtl:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t,o=this.mapping.buttons[e.detail.id],i=this.buttonMeshes;o&&("trigger"===o&&(t=e.detail.state.value,i&&i.trigger&&(i.trigger.rotation.x=-t*(Math.PI/12))),this.el.emit(o+"changed",e.detail.state))},onModelLoaded:function(e){var t,o=e.detail.model,i=this;this.data.model&&((t=this.buttonMeshes={}).grip={left:o.getObjectByName("leftgrip"),right:o.getObjectByName("rightgrip")},t.menu=o.getObjectByName("menubutton"),t.system=o.getObjectByName("systembutton"),t.trackpad=o.getObjectByName("touchpad"),t.trigger=o.getObjectByName("trigger"),Object.keys(t).forEach(function(e){i.setButtonColor(e,i.data.buttonColor)}),o.position.set(0,-.015,.04))},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},onButtonEvent:function(e,t){var o,i,n=this.mapping.buttons[e],r=-1!==t.indexOf("touch");if(Array.isArray(n))for(i=0;i<n.length;i++)this.el.emit(n[i]+t);else this.el.emit(n+t);if(this.data.model&&!r)if(o="up"===t?this.data.buttonColor:this.data.buttonHighlightColor,Array.isArray(n))for(i=0;i<n.length;i++)this.setButtonColor(n[i],o);else this.setButtonColor(n,o)},setButtonColor:function(e,t){var o=this.buttonMeshes;if(o)return"grip"===e?(o.grip.left.material.color.set(t),void o.grip.right.material.color.set(t)):void o[e].material.color.set(t)}})},{"../core/component":125,"../utils/":195}],113:[function(e,t,o){var i,n,r=e("../constants").keyboardevent.KEYCODE_TO_CODE,s=e("../core/component").registerComponent,a=e("../lib/three"),l=e("../utils/"),c=l.bind,u=l.shouldCaptureKeyEvent,h=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];t.exports.Component=s("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},easing:{default:20},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.position={},this.velocity=new a.Vector3,this.onBlur=c(this.onBlur,this),this.onFocus=c(this.onFocus,this),this.onKeyDown=c(this.onKeyDown,this),this.onKeyUp=c(this.onKeyUp,this),this.onVisibilityChange=c(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(e,t){var o,i,n=this.data,r=this.el,s=this.position,a=this.velocity;(a[n.adAxis]||a[n.wsAxis]||!function(e){var t;for(t in e)return!1;return!0}(this.keys))&&(t/=1e3,this.updateVelocity(t),(a[n.adAxis]||a[n.wsAxis])&&(o=r.getAttribute("position"),i=this.getMovementVector(t),s.x=o.x+i.x,s.y=o.y+i.y,s.z=o.z+i.z,r.setAttribute("position",s)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(e){var t,o,i,n,r,s=this.data,a=this.keys,l=this.velocity;if(o=s.adAxis,n=s.wsAxis,e>.2)return l[o]=0,void(l[n]=0);0!==l[o]&&(l[o]-=l[o]*s.easing*e),0!==l[n]&&(l[n]-=l[n]*s.easing*e),Math.abs(l[o])<1e-5&&(l[o]=0),Math.abs(l[n])<1e-5&&(l[n]=0),s.enabled&&(t=s.acceleration,s.adEnabled&&(i=s.adInverted?-1:1,(a.KeyA||a.ArrowLeft)&&(l[o]-=i*t*e),(a.KeyD||a.ArrowRight)&&(l[o]+=i*t*e)),s.wsEnabled&&(r=s.wsInverted?-1:1,(a.KeyW||a.ArrowUp)&&(l[n]-=r*t*e),(a.KeyS||a.ArrowDown)&&(l[n]+=r*t*e)))},getMovementVector:(i=new a.Vector3(0,0,0),n=new a.Euler(0,0,0,"YXZ"),function(e){var t,o=this.el.getAttribute("rotation"),r=this.velocity;return i.copy(r),i.multiplyScalar(e),o?(t=this.data.fly?o.x:0,n.set(a.Math.degToRad(t),a.Math.degToRad(o.y),0),i.applyEuler(n),i):i}),attachVisibilityEventListeners:function(){window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(e){var t;u(e)&&(t=e.code||r[e.keyCode],-1!==h.indexOf(t)&&(this.keys[t]=!0))},onKeyUp:function(e){var t;t=e.code||r[e.keyCode],delete this.keys[t]}})},{"../constants":116,"../core/component":125,"../lib/three":173,"../utils/":195}],114:[function(e,t,o){var i,n=e("../utils/bind"),r=e("../core/component").registerComponent,s=e("../utils/tracked-controls"),a=e("../utils/"),l=a.debug("components:windows-motion-controls:debug"),c=a.debug("components:windows-motion-controls:warn"),u=e("../constants").DEFAULT_HANDEDNESS,h={left:"left.glb",right:"right.glb",default:"universal.glb"},g=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/;t.exports.Component=r("windows-motion-controls",{schema:{hand:{default:u},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:{axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},bindMethods:function(){this.onModelError=n(this.onModelError,this),this.onModelLoaded=n(this.onModelLoaded,this),this.onControllersUpdate=n(this.onControllersUpdate,this),this.checkIfControllerPresent=n(this.checkIfControllerPresent,this),this.onAxisMoved=n(this.onAxisMoved,this)},init:function(){var e=this,t=this.el;this.onButtonChanged=n(this.onButtonChanged,this),this.onButtonDown=function(t){e.onButtonEvent(t,"down")},this.onButtonUp=function(t){e.onButtonEvent(t,"up")},this.onButtonTouchStart=function(t){e.onButtonEvent(t,"touchstart")},this.onButtonTouchEnd=function(t){e.onButtonEvent(t,"touchend")},this.onControllerConnected=function(){e.setModelVisibility(!0)},this.onControllerDisconnected=function(){e.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},this.emitIfAxesChanged=s.emitIfAxesChanged,this.checkControllerPresentAndSetup=s.checkControllerPresentAndSetup,t.addEventListener("controllerconnected",this.onControllerConnected),t.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("axismove",this.onAxisMoved),e.addEventListener("model-error",this.onModelError),e.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("axismove",this.onAxisMoved),e.removeEventListener("model-error",this.onModelError),e.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Spatial Controller (Spatial Interaction Source) ",{hand:this.data.hand,index:this.data.pair})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(this.data.model&&!this.rayOrigin.createdFromMesh){var e=this.createControllerModelUrl();this.loadModel(e)}else this.modelReady()},createControllerModelUrl:function(e){var t=this.el.components["tracked-controls"],o=t?t.controller:null,i="default",n=this.data.hand;if(o&&(n=o.hand,!e)){var r=o.id.match(g);i=r&&r[0]||i}return"https://cdn.aframe.io/controllers/microsoft/"+i+"/"+(h[n]||h.default)},injectTrackedControls:function(){var e=this.data;this.el.setAttribute("tracked-controls",{idPrefix:"Spatial Controller (Spatial Interaction Source) ",controller:e.pair,hand:e.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(e){var t=this.createControllerModelUrl(!0);e.detail.src!==t?(c("Failed to load controller model for device, attempting to load default."),this.loadModel(t)):c("Failed to load default controller model.")},loadModel:function(e){this.el.setAttribute("gltf-model","url("+e+")")},onModelLoaded:function(e){var t,o,i,n,r=this.controllerModel=e.detail.model,s=this.loadedMeshInfo;if(l("Processing model"),s.buttonMeshes={},s.axisMeshes={},r){for(t=0;t<this.mapping.buttons.length;t++)(o=this.mapping.buttonMeshNames[this.mapping.buttons[t]])?(i=r.getObjectByName(o))?(n={index:t,value:a(i,"VALUE"),pressed:a(i,"PRESSED"),unpressed:a(i,"UNPRESSED")}).value&&n.pressed&&n.unpressed?s.buttonMeshes[this.mapping.buttons[t]]=n:c("Missing button submesh under mesh with name: "+o+"(VALUE: "+!!n.value+", PRESSED: "+!!n.pressed+", UNPRESSED:"+!!n.unpressed+")"):c("Missing button mesh with name: "+o):l("Skipping unknown button at index: "+t+" with mapped name: "+this.mapping.buttons[t]);for(t=0;t<this.mapping.axisMeshNames.length;t++)(o=this.mapping.axisMeshNames[t])?(i=r.getObjectByName(o))?(n={index:t,value:a(i,"VALUE"),min:a(i,"MIN"),max:a(i,"MAX")}).value&&n.min&&n.max?s.axisMeshes[t]=n:c("Missing axis submesh under mesh with name: "+o+"(VALUE: "+!!n.value+", MIN: "+!!n.min+", MAX:"+!!n.max+")"):c("Missing axis mesh with name: "+o):l("Skipping unknown axis at index: "+t);this.calculateRayOriginFromMesh(r),this.setModelVisibility()}function a(e,t){for(var o=0,i=e.children.length;o<i;o++){var n=e.children[o];if(n&&n.name===t)return n}}l("Model load complete.")},calculateRayOriginFromMesh:(i=new THREE.Quaternion,function(e){var t;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,t=e.getObjectByName(this.mapping.pointingPoseMeshName)){var o=e.parent;o&&(e.parent=null,e.updateMatrixWorld(!0),e.parent=o),t.getWorldPosition(this.rayOrigin.origin),t.getWorldQuaternion(i),this.rayOrigin.direction.applyQuaternion(i),o&&e.updateMatrixWorld(!0)}else l("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}),lerpAxisTransform:function(){var e=new THREE.Quaternion;return function(t,o){var i=this.loadedMeshInfo.axisMeshes[t];if(i){var n=i.min,r=i.max,s=i.value,a=.5*o+.5;s.setRotationFromQuaternion(e.copy(n.quaternion).slerp(r.quaternion,a)),s.position.lerpVectors(n.position,r.position,a)}}}(),lerpButtonTransform:function(){var e=new THREE.Quaternion;return function(t,o){var i=this.loadedMeshInfo.buttonMeshes[t];if(i){var n=i.unpressed,r=i.pressed,s=i.value;s.setRotationFromQuaternion(e.copy(n.quaternion).slerp(r.quaternion,o)),s.position.lerpVectors(n.position,r.position,o)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(t,e.detail.state.value),this.el.emit(t+"changed",e.detail.state))},onButtonEvent:function(e,t){var o=this.mapping.buttons[e.detail.id];l("onButtonEvent("+e.detail.id+", "+t+")"),o&&this.el.emit(o+t)},onAxisMoved:function(e){var t=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var o=0;o<t;o++)this.lerpAxisTransform(o,e.detail.axis[o]||0);this.emitIfAxesChanged(this,this.mapping.axes,e)},setModelVisibility:function(e){var t=this.el.getObject3D("mesh");e=void 0!==e?e:this.modelVisible,this.modelVisible=e,t&&(t.visible=e)}})},{"../constants":116,"../core/component":125,"../utils/":195,"../utils/bind":189,"../utils/tracked-controls":199}],115:[function(e,t,o){var i=e("@tweenjs/tween.js"),n={alternate:"alternate",alternateReverse:"alternate-reverse",normal:"normal",reverse:"reverse"},r={linear:i.Easing.Linear.None,ease:i.Easing.Cubic.InOut,"ease-in":i.Easing.Cubic.In,"ease-out":i.Easing.Cubic.Out,"ease-in-out":i.Easing.Cubic.InOut,"ease-cubic":i.Easing.Cubic.In,"ease-in-cubic":i.Easing.Cubic.In,"ease-out-cubic":i.Easing.Cubic.Out,"ease-in-out-cubic":i.Easing.Cubic.InOut,"ease-quad":i.Easing.Quadratic.InOut,"ease-in-quad":i.Easing.Quadratic.In,"ease-out-quad":i.Easing.Quadratic.Out,"ease-in-out-quad":i.Easing.Quadratic.InOut,"ease-quart":i.Easing.Quartic.InOut,"ease-in-quart":i.Easing.Quartic.In,"ease-out-quart":i.Easing.Quartic.Out,"ease-in-out-quart":i.Easing.Quartic.InOut,"ease-quint":i.Easing.Quintic.InOut,"ease-in-quint":i.Easing.Quintic.In,"ease-out-quint":i.Easing.Quintic.Out,"ease-in-out-quint":i.Easing.Quintic.InOut,"ease-sine":i.Easing.Sinusoidal.InOut,"ease-in-sine":i.Easing.Sinusoidal.In,"ease-out-sine":i.Easing.Sinusoidal.Out,"ease-in-out-sine":i.Easing.Sinusoidal.InOut,"ease-expo":i.Easing.Exponential.InOut,"ease-in-expo":i.Easing.Exponential.In,"ease-out-expo":i.Easing.Exponential.Out,"ease-in-out-expo":i.Easing.Exponential.InOut,"ease-circ":i.Easing.Circular.InOut,"ease-in-circ":i.Easing.Circular.In,"ease-out-circ":i.Easing.Circular.Out,"ease-in-out-circ":i.Easing.Circular.InOut,"ease-elastic":i.Easing.Elastic.InOut,"ease-in-elastic":i.Easing.Elastic.In,"ease-out-elastic":i.Easing.Elastic.Out,"ease-in-out-elastic":i.Easing.Elastic.InOut,"ease-back":i.Easing.Back.InOut,"ease-in-back":i.Easing.Back.In,"ease-out-back":i.Easing.Back.Out,"ease-in-out-back":i.Easing.Back.InOut,"ease-bounce":i.Easing.Bounce.InOut,"ease-in-bounce":i.Easing.Bounce.In,"ease-out-bounce":i.Easing.Bounce.Out,"ease-in-out-bounce":i.Easing.Bounce.InOut},s={backwards:"backwards",both:"both",forwards:"forwards",none:"none"},a={attribute:"rotation",begin:"",end:"",delay:0,dur:1e3,easing:"ease",direction:n.normal,fill:s.forwards,from:void 0,repeat:0,to:void 0};t.exports.defaults=a,t.exports.directions=n,t.exports.easingFunctions=r,t.exports.fills=s,t.exports.repeats={indefinite:"indefinite"}},{"@tweenjs/tween.js":1}],116:[function(e,t,o){t.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",animation:e("./animation"),keyboardevent:e("./keyboardevent")}},{"./animation":115,"./keyboardevent":117}],117:[function(e,t,o){t.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],118:[function(e,t,o){var i=e("./a-node"),n=e("../constants/animation"),r=e("../utils/").coordinates,s=e("./schema").parseProperty,a=e("./a-register-element").registerElement,l=e("@tweenjs/tween.js"),c=e("../lib/three"),u=e("../utils/"),h=u.bind,g=u.entity.getComponentProperty,d=n.defaults,p=n.directions,f=n.easingFunctions,m=n.fills,y=n.repeats,v=r.isCoordinates;function E(e){return u.extend({},e)}function _(e,t,o,i,n){var a,l,u,h,d,p=t.split("."),f={},m={};return 2===p.length?function(){var t=p[0],o=p[1],i=e.components[t],n=i&&i.schema;return n&&n[o]&&"color"===n[o].type}()?y():(h=p[0],u=p[1],(l=e.components[h])||(e.setAttribute(h,""),l=e.components[h]),a=l.schema,f[t]=void 0===o?g(e,t):o,f[t]=s(f[t],a[u]),m[t]=s(i,a[u]),d=function(o){t in o&&e.setAttribute(h,u,o[t])}):i&&v(i)?(f=o?r.parse(o):n,m=r.parse(i),d=function(o){e.setAttribute(t,o)}):-1!==["true","false"].indexOf(i)?(f[t]=void 0!==o&&T(o),f[t]=b(f[t]),m[t]=b(T(i)),d=function(o){e.setAttribute(t,!!o[t])}):isNaN(i)?y():(f[t]=void 0===o?parseFloat(e.getAttribute(t)):parseFloat(o),m[t]=parseFloat(i),d=function(o){e.setAttribute(t,o[t])}),{from:f,partialSetAttribute:d,to:m};function y(){f=new c.Color(o||e.getAttribute(t)),m=new c.Color(i),d=function(o){p.length>1&&e.setAttribute(p[0],p[1],M(o)),e.setAttribute(t,M(o))}}}function T(e){return"true"===e}function b(e){return e?1:0}function M(e){return"#"+["r","g","b"].map(function(t){return function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}(function(e){return Math.floor(255*Math.min(Math.abs(e),1))}(e[t]))}).join("")}t.exports.AAnimation=a("a-animation",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.bindMethods(),this.isRunning=!1,this.partialSetAttribute=function(){},this.tween=null}},attachedCallback:{value:function(){this.el=this.parentNode,this.handleMixinUpdate(),this.update(),this.load()}},attributeChangedCallback:{value:function(e,t,o){this.hasLoaded&&this.isRunning&&(this.stop(),this.handleMixinUpdate(),this.update())}},detachedCallback:{value:function(){this.isRunning&&this.stop()}},getTween:{value:function(){var e,t,o,i,n=this,r=n.data,s=n.el,a=r.attribute,c=parseInt(r.delay,10),u=g(s,a),d=n.getDirection(r.direction),v=f[r.easing],T=r.fill,b=r.repeat===y.indefinite?1/0:0,M=!1;return e=_(s,a,r.from||n.initialValue,r.to,u),t=e.from,o=e.to,n.partialSetAttribute=e.partialSetAttribute,void 0===n.count&&(n.count=b===1/0?0:parseInt(r.repeat,10)),isNaN(c)&&(c=0),n.initialValue=n.initialValue||E(u),b===1/0&&T===m.forwards&&-1!==[p.alternate,p.alternateReverse].indexOf(r.direction)&&(M=!0),d===p.reverse&&(i=o,o=E(t),t=E(i)),-1!==[m.backwards,m.both].indexOf(T)&&n.partialSetAttribute(t),new l.Tween(E(t)).to(o,r.dur).delay(c).easing(v).repeat(b).yoyo(M).onUpdate(function(){n.partialSetAttribute(this)}).onComplete(h(n.onCompleted,n))}},update:{value:function(){var e=this.data;"infinite"===e.repeat&&console.warn("Using 'infinite' as 'repeat' value is invalid.  Use 'indefinite' instead."),""===e.begin||isNaN(e.begin)||(console.warn("Using 'begin' to specify a delay is deprecated. Use 'delay' instead."),e.delay=e.begin,e.begin="");var t=e.begin,o=e.end;this.evt&&this.removeEventListeners(this.evt),this.evt={begin:t,end:o},this.addEventListeners(this.evt),""===t&&(this.stop(),this.start())},writable:window.debug},onCompleted:{value:function(){var e=this.data;if(this.isRunning=!1,-1!==[m.backwards,m.none].indexOf(e.fill)&&this.partialSetAttribute(this.initialValue),0===this.count)return this.count=void 0,void this.emit("animationend");this.isRunning=!1,this.count--,this.start()}},start:{value:function(){var e=this;this.el.hasLoaded?!this.isRunning&&this.el.isPlaying&&(this.tween=this.getTween(),this.isRunning=!0,this.tween.start(),this.emit("animationstart")):this.el.addEventListener("loaded",function(){e.start()})},writable:!0},stop:{value:function(){var e=this.tween;e&&(e.stop(),this.isRunning=!1,-1!==[m.backwards,m.none].indexOf(this.data.fill)&&this.partialSetAttribute(this.initialValue),this.emit("animationstop"))},writable:!0},getDirection:{value:function(e){return e===p.alternate?(this.prevDirection=this.prevDirection===p.normal?p.reverse:p.normal,this.prevDirection):e===p.alternateReverse?(this.prevDirection=this.prevDirection===p.reverse?p.normal:p.reverse,this.prevDirection):e}},bindMethods:{value:function(){this.start=h(this.start,this),this.stop=h(this.stop,this),this.onStateAdded=h(this.onStateAdded,this),this.onStateRemoved=h(this.onStateRemoved,this)}},addEventListeners:{value:function(e){var t=this.el,o=this;u.splitString(e.begin).forEach(function(e){t.addEventListener(e,o.start)}),u.splitString(e.end).forEach(function(e){t.addEventListener(e,o.stop)}),""===e.begin&&t.addEventListener("play",this.start),t.addEventListener("pause",this.stop),t.addEventListener("stateadded",this.onStateAdded),t.addEventListener("stateremoved",this.onStateRemoved)}},removeEventListeners:{value:function(e){var t=this.el,o=this.start,i=this.stop;u.splitString(e.begin).forEach(function(e){t.removeEventListener(e,o)}),u.splitString(e.end).forEach(function(e){t.removeEventListener(e,i)}),t.removeEventListener("stateadded",this.onStateAdded),t.removeEventListener("stateremoved",this.onStateRemoved)}},onStateAdded:{value:function(e){e.detail.state===this.data.begin&&this.start()},writable:!0},onStateRemoved:{value:function(e){e.detail.state===this.data.begin&&this.stop()},writable:!0},handleMixinUpdate:{value:function(){var e,t,o,i={};o=document.querySelector("#"+this.getAttribute("mixin")),t=o?u.getElData(o,d):{},e=u.getElData(this,d),u.extend(i,d,t,e),this.data=i}}})}),t.exports.getAnimationValues=_},{"../constants/animation":115,"../lib/three":173,"../utils/":195,"./a-node":123,"./a-register-element":124,"./schema":133,"@tweenjs/tween.js":1}],119:[function(e,t,o){var i=e("./a-node"),n=e("../utils/bind"),r=e("../utils/debug"),s=e("./a-register-element").registerElement,a=e("../lib/three"),l=new a.FileLoader,c=r("core:a-assets:warn");function u(e){if(e.hasAttribute("autoplay")||"auto"===e.getAttribute("preload"))return new Promise(function(t,o){if(4===e.readyState)return t();if(e.error)return o();function i(){for(var o=0,i=0;i<e.buffered.length;i++)o+=e.buffered.end(i)-e.buffered.start(i);o>=e.duration&&(a.Cache.files[e.getAttribute("src")]=e,t())}e.addEventListener("loadeddata",i,!1),e.addEventListener("progress",i,!1),e.addEventListener("error",o,!1)})}function h(e){var t=function(e){var t,o;if(e.hasAttribute("crossorigin"))return e;if(null!==(t=e.getAttribute("src"))){if(-1===t.indexOf("://"))return e;if(((o=t).indexOf("://")>-1?o.split("/")[2]:o.split("/")[0]).split(":")[0]===window.location.host)return e}return c('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',t),e.crossOrigin="anonymous",e.cloneNode(!0)}(e);return t.tagName&&"video"===t.tagName.toLowerCase()&&(t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline","")),t!==e&&(e.parentNode.appendChild(t),e.parentNode.removeChild(e)),t}function g(e){var t=e.lastIndexOf(".");if(t>=0){var o=e.slice(t,e.length);if(".gltf"===o||".glb"===o)return"arraybuffer"}return"text"}t.exports=s("a-assets",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=l,this.timeout=null}},attachedCallback:{value:function(){var e,t,o,i,r,s,l=this,g=[];if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(r=this.querySelectorAll("img"),e=0;e<r.length;e++)i=h(r[e]),g.push(new Promise(function(t,o){a.Cache.files[r[e].getAttribute("src")]=i,i.onload=t,i.onerror=o}));for(o=this.querySelectorAll("audio, video"),e=0;e<o.length;e++)t=h(o[e]),g.push(u(t));Promise.all(g).then(n(this.load,this)),s=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){l.hasLoaded||(c("Asset loading timed out in ",s,"ms"),l.emit("timeout"),l.load())},s)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){i.prototype.load.call(this,null,function(e){return e.isAssetItem&&e.hasAttribute("src")})}}})}),s("a-asset-item",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var e=this,t=this.getAttribute("src");l.setResponseType(this.getAttribute("response-type")||g(t)),l.load(t,function(t){e.data=t,setTimeout(function(){i.prototype.load.call(e)})},function(t){e.emit("progress",{loadedBytes:t.loaded,totalBytes:t.total,xhr:t})},function(t){e.emit("error",{xhr:t})})}}})}),t.exports.inferResponseType=g},{"../lib/three":173,"../utils/bind":189,"../utils/debug":191,"./a-node":123,"./a-register-element":124}],120:[function(e,t,o){var i=e("../utils/debug"),n=e("./a-register-element").registerElement,r=i("core:cubemap:warn");t.exports=n("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var e,t=this.querySelectorAll("[src]"),o=[];if(6===t.length){for(e=0;e<t.length;e++)o.push(t[e].getAttribute("src"));return o}r("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":191,"./a-register-element":124}],121:[function(e,t,o){var i,n,r=e("./a-node"),s=e("./component").components,a=e("./a-register-element").registerElement,l=e("../lib/three"),c=e("../utils/"),u=c.bind,h=c.debug("core:a-entity:debug"),g=c.debug("core:a-entity:warn"),d="__",p=Object.create(r.prototype,{defaultComponents:{value:{position:"",rotation:"",scale:"",visible:""}},createdCallback:{value:function(){this.components={},this.initializingComponents={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new l.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.states=[]}},attributeChangedCallback:{value:function(e,t,o){var i=this.components[e];i&&i.justInitialized&&""===o?delete i.justInitialized:(i||null!==o)&&this.setEntityAttribute(e,t,o)}},attachedCallback:{value:function(){var e,t=this.sceneEl,o=this;this.addToParent(),this.isScene||(t?!(e=t.querySelector("a-assets"))||e.hasLoaded?this.load():e.addEventListener("loaded",function(){o.load()}):this.load())}},detachedCallback:{value:function(){var e;if(this.parentEl){for(e in this.components)this.removeComponent(e);this.isScene||(this.removeFromParent(),r.prototype.detachedCallback.call(this),this.object3D.el=null)}}},handleMixinUpdate:{value:function(e){e?this.updateComponent(e,this.getDOMAttribute(e)):this.updateComponents()}},mapStateMixins:{value:function(e,t){var o,i,n;if(o=this.getAttribute("mixin")){for(i=o.split(" "),n=0;n<i.length;n++)t(i[n]+"-"+e);this.updateComponents()}}},updateStateMixins:{value:function(e,t){var o,i,n,r,s,a;for(i=e.split(" "),n=t?t.split(" "):[],o=n.filter(function(e){return i.indexOf(e)<0}),r=0;r<o.length;r++)for(a=document.querySelectorAll("[id^="+o[r]+"-]"),s=0;s<a.length;s++)this.unregisterMixin(a[s].id);for(r=0;r<this.states.length;r++)for(s=0;s<i.length;s++)this.registerMixin(i[s]+"-"+this.states[r])}},getObject3D:{value:function(e){return this.object3DMap[e]}},setObject3D:{value:function(e,t){var o,i=this;if(!(t instanceof l.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");(o=this.getObject3D(e))&&this.object3D.remove(o),t.el=this,t.children.length&&t.traverse(function(e){e.el=i}),this.object3D.add(t),this.object3DMap[e]=t,this.emit("object3dset",{object:t,type:e})}},removeObject3D:{value:function(e){var t=this.getObject3D(e);t?(this.object3D.remove(t),delete this.object3DMap[e],this.emit("object3dremove",{type:e})):g("Tried to remove `Object3D` of type:",e,"which was not defined.")}},getOrCreateObject3D:{value:function(e,t){var o=this.getObject3D(e);return!o&&t&&(o=new t,this.setObject3D(e,o)),o}},add:{value:function(e){if(!e.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(e.object3D),this.emit("child-attached",{el:e})}},addToParent:{value:function(){var e=this.parentEl=this.parentNode;e&&e.add&&!this.attachedToParent&&(e.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var e=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=this.parentNode=null,e.emit("child-detached",{el:this})}},load:{value:function(){var e=this;!this.hasLoaded&&this.parentEl&&r.prototype.load.call(this,function(){e.parentEl&&(e.updateComponents(),(e.isScene||e.parentEl.isPlaying)&&e.play())})},writable:window.debug},remove:{value:function(e){this.object3D.remove(e.object3D)}},getChildEntities:{value:function(){for(var e=this.children,t=[],o=0;o<e.length;o++){var n=e[o];n instanceof i&&t.push(n)}return t}},initComponent:{value:function(e,t,o){var i,n,r,a=e.split(d),l=a[1],c=a[0],u=(r=e,void 0!==(n=this).defaultComponents[r]||!(!n.components[r]||!n.components[r].attrValue)||f(r,n.mixinEls)||void 0!==t);if(s[c]&&(u||o)&&!(e in this.components)){if(this.initComponentDependencies(c),l&&!s[c].multiple)throw new Error("Trying to initialize multiple components of type `"+c+"`. There can only be one component of this type per entity.");i=new s[c].Component(this,t,l),this.isPlaying&&i.play(),this.hasAttribute(e)||(i.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,e,"")),h("Component initialized: %s",e)}},writable:window.debug},initComponentDependencies:{value:function(e){var t,o,i=s[e];if(i&&(t=s[e].dependencies))for(o=0;o<t.length;o++)this.initComponent(t[o],window.HTMLElement.prototype.getAttribute.call(this,t[o])||void 0,!0)}},removeComponent:{value:function(e){var t,o,i;o=e in this.defaultComponents,i=f(e,this.mixinEls),o||i||(t=this.components[e])&&(t.initialized?(t.pause(),t.remove(),delete this.components[e],this.emit("componentremoved",t.evtDetail)):this.addEventListener("componentinitialized",function t(o){o.detail.name===e&&(this.removeComponent(e),this.removeEventListener("componentinitialized",t))}))},writable:window.debug},updateComponents:{value:(n={},function(){var e,t,o,i;if(this.hasLoaded){for(o=0;o<this.mixinEls.length;o++)for(i in this.mixinEls[o].componentCache)y(i)&&(n[i]=!0);if(this.getExtraComponents)for(i in t=this.getExtraComponents())y(i)&&(n[i]=!0);for(o=0;o<this.attributes.length;++o)y(i=this.attributes[o].name)&&(n[i]=!0);for(i in this.defaultComponents)e=m(this.getDOMAttribute(i),t&&t[i]),this.updateComponent(i,e),delete n[i];for(i in n)e=m(this.getDOMAttribute(i),t&&t[i]),this.updateComponent(i,e),delete n[i]}}),writable:window.debug},updateComponent:{value:function(e,t,o){var i=this.components[e],n=e in this.defaultComponents;if(i)return null!==t||n?void i.updateProperties(t,o):void this.removeComponent(e);this.initComponent(e,t,!1)}},removeAttribute:{value:function(e,t){var o=this.components[e];o&&void 0===t&&(this.setEntityAttribute(e,void 0,null),this.components[e])||(o&&void 0!==t?o.resetProperty(t):("mixin"===e&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,e)))}},play:{value:function(){var e,t,o;if(!this.isPlaying&&this.hasLoaded){for(o in this.isPlaying=!0,this.components)this.components[o].play();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].play();this.emit("play")}},writable:!0},pause:{value:function(){var e,t,o;if(this.isPlaying){for(o in this.isPlaying=!1,this.components)this.components[o].pause();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(e,t,o){s[e]||this.components[e]?this.updateComponent(e,o):"mixin"!==e||this.mixinUpdate(o,t)}},mixinUpdate:{value:function(e,t){t=t||this.getAttribute("mixin"),this.updateMixins(e,t),this.updateStateMixins(e,t),this.updateComponents()}},setAttribute:{value:function(e,t,o){var i,n,a,l;if(l=e.indexOf(d),a=l>0?e.substring(0,l):e,!s[a])return r.prototype.setAttribute.call(this,e,t),void("mixin"===e&&this.mixinUpdate(t));!this.components[e]&&this.hasAttribute(e)&&this.updateComponent(e,window.HTMLElement.prototype.getAttribute.call(this,e)),void 0!==o&&"string"==typeof t&&t.length>0&&"string"==typeof c.styleParser.parse(t)?((i={})[t]=o,n=!1):(i=t,n=!0===o),this.updateComponent(e,i,n),this.sceneEl&&this.sceneEl.getAttribute("debug")&&this.components[e].flushToDOM()},writable:window.debug},flushToDOM:{value:function(e){var t,o,i,n=this.components,r=this.defaultComponents,s=this.children;for(i in n)n[i].flushToDOM(i in r);if(e)for(o=0;o<s.length;++o)(t=s[o]).flushToDOM&&t.flushToDOM(e)}},getAttribute:{value:function(e){var t=this.components[e];return t?t.data:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},getComputedAttribute:{value:function(e){return g("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(e)}},getDOMAttribute:{value:function(e){var t=this.components[e];return t?t.attrValue:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},addState:{value:function(e){this.is(e)||(this.states.push(e),this.mapStateMixins(e,u(this.registerMixin,this)),this.emit("stateadded",{state:e}))}},removeState:{value:function(e){var t=this.states.indexOf(e);-1!==t&&(this.states.splice(t,1),this.mapStateMixins(e,u(this.unregisterMixin,this)),this.emit("stateremoved",{state:e}))}},is:{value:function(e){return-1!==this.states.indexOf(e)}}});function f(e,t){var o,i=!1;for(o=0;o<t.length&&!(i=t[o].hasAttribute(e));++o);return i}function m(e,t){return t?t.constructor===Object?c.extend(t,c.styleParser.parse(e||{})):e||t:e}function y(e){return-1!==e.indexOf(d)&&(e=e.split(d)[0]),!!s[e]}i=a("a-entity",{prototype:p}),t.exports=i},{"../lib/three":173,"../utils/":195,"./a-node":123,"./a-register-element":124,"./component":125}],122:[function(e,t,o){var i=e("./a-node"),n=e("./a-register-element").registerElement,r=e("./component").components;t.exports=n("a-mixin",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id")}},attributeChangedCallback:{value:function(e,t,o){this.cacheAttribute(e,o)}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(e,t){this.cacheAttribute(e,t),window.HTMLElement.prototype.setAttribute.call(this,e,t)}},cacheAttribute:{value:function(e,t){var o=e.split("__")[0],i=r[o];i&&(void 0===t&&(t=window.HTMLElement.prototype.getAttribute.call(this,e)),this.componentCache[e]=i.parseAttrValueForCache(t))}},getAttribute:{value:function(e){return this.componentCache[e]||window.HTMLElement.prototype.getAttribute.call(this,e)}},cacheAttributes:{value:function(){var e,t,o=this.attributes;for(t=0;t<o.length;t++)e=o[t].name,this.cacheAttribute(e)}},updateEntities:{value:function(){if(this.sceneEl)for(var e=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),t=0;t<e.length;t++){var o=e[t];o.hasLoaded&&(o.registerMixin(this.id),Object.keys(this.componentCache).forEach(function(e){o.updateComponent(e)}))}}}})})},{"./a-node":123,"./a-register-element":124,"./component":125}],123:[function(e,t,o){var i=e("./a-register-element").registerElement,n=e("./a-register-element").isNode,r=e("../utils/"),s=r.bind,a=r.debug("core:a-node:warn");t.exports=i("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[],this.mixinObservers={}},writable:window.debug},attachedCallback:{value:function(){var e;this.sceneEl=this.closestScene(),this.sceneEl||a("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",{},!1),(e=this.getAttribute("mixin"))&&this.updateMixins(e)},writable:window.debug},attributeChangedCallback:{value:function(e,t,o){"mixin"===e&&this.updateMixins(o,t)}},closestScene:{value:function(){for(var e=this;e&&!e.isScene;)e=e.parentElement;return e}},closest:{value:function(e){for(var t=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,o=this;o&&!t.call(o,e);)o=o.parentElement;return o}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(e,t){var o,i,r=this;this.hasLoaded||(t=t||n,o=this.getChildren(),i=o.filter(t).map(function(e){return new Promise(function(t){if(e.hasLoaded)return t();e.addEventListener("loaded",t)})}),Promise.all(i).then(function(){r.hasLoaded=!0,e&&e(),r.emit("loaded",void 0,!1)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(e,t){var o=e?e.trim().split(/\s+/):[],i=t?t.trim().split(/\s+/):[];i.filter(function(e){return o.indexOf(e)<0}).forEach(s(this.unregisterMixin,this)),this.mixinEls=[],o.forEach(s(this.registerMixin,this))}},registerMixin:{value:function(e){if(this.sceneEl){var t=this.sceneEl.querySelector("a-mixin#"+e);t&&(this.attachMixinListener(t),this.mixinEls.push(t))}}},setAttribute:{value:function(e,t){"mixin"===e&&this.updateMixins(t),window.HTMLElement.prototype.setAttribute.call(this,e,t)}},unregisterMixin:{value:function(e){var t,o,i=this.mixinEls;for(o=0;o<i.length;++o)if(t=i[o],e===t.id){i.splice(o,1);break}this.removeMixinListener(e)}},removeMixinListener:{value:function(e){var t=this.mixinObservers[e];t&&(t.disconnect(),this.mixinObservers[e]=null)}},attachMixinListener:{value:function(e){var t=this,o=e.id,i=this.mixinObservers[o];if(e&&!i){var n=new MutationObserver(function(e){var o=e[0].attributeName;t.handleMixinUpdate(o)});n.observe(e,{attributes:!0}),this.mixinObservers[o]=n}}},handleMixinUpdate:{value:function(){}},emit:{value:function(e,t,o,i){var n;return void 0===o&&(o=!0),n={bubbles:!!o,detail:t},i&&r.extend(n,i),r.fireEvent(this,e,n)},writable:window.debug},emitter:{value:function(e,t,o){var i=this;return function(){i.emit(e,t,o)}}}})})},{"../utils/":195,"./a-register-element":124}],124:[function(e,t,o){var i,n;e("document-register-element");var r=t.exports.knownTags={};function s(e,t,o,i){t.forEach(function(t){!function(e,t,o,i){var n=o[t],r=i[t];n&&r&&n!==r&&(e[t]={value:function(){return r.apply(this,arguments),n.apply(this,arguments)},writable:window.debug})}(e,t,o,i)})}function a(e,t){var o=Object.getOwnPropertyNames(e);o.forEach(function(o){var i;t[o]||(i=Object.getOwnPropertyDescriptor(e,o),t[o]={value:e[o],writable:i.writable})})}t.exports.isNode=function(e){return e.tagName.toLowerCase()in r||e.isNode},t.exports.registerElement=function(e,t){var o=Object.getPrototypeOf(t.prototype),l=t,c=i&&o===i.prototype,u=n&&o===n.prototype;return(c||u)&&function(e){r[e.toLowerCase()]=!0}(e),c&&(l=function(e){var t={};return s(t,["attachedCallback","attributeChangedCallback","createdCallback"],e,i.prototype),a(e,t),t}(t.prototype),l={prototype:Object.create(o,l)}),u&&(l=function(e){var t={};return s(t,["attachedCallback","attributeChangedCallback","createdCallback"],e,i.prototype),s(t,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],e,n.prototype),a(e,t),t}(t.prototype),l={prototype:Object.create(o,l)}),document.registerElement(e,l)},t.exports.wrapMethods=s,i=e("./a-node"),n=e("./a-entity")},{"./a-entity":121,"./a-node":123,"document-register-element":13}],125:[function(e,t,o){var i=e("./schema"),n=e("./scene/scenes"),r=e("./system"),s=e("../utils/"),a=t.exports.components={},l=i.parseProperties,c=i.parseProperty,u=i.process,h=i.isSingleProperty,g=i.stringifyProperties,d=i.stringifyProperty,p=s.styleParser,f=s.debug("core:component:warn"),m=document.currentScript,y=new RegExp("[A-Z]+"),v=t.exports.Component=function(e,t,o){var i=this;this.el=e,this.id=o,this.attrName=this.name+(o?"__"+o:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.oldData=void 0,this.previousAttrValue=void 0,this.throttledEmitComponentChanged=s.throttle(function(){e.emit("componentchanged",i.evtDetail,!1)},200),this.updateProperties(t)};if(v.prototype={schema:{},init:function(){},update:function(e){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(e,t){var o=this.schema;return h(o)?c(e,o):l(p.parse(e),o,!0,this.name,t)},stringify:function(e){var t=this.schema;return"string"==typeof e?e:h(t)?d(e,t):(e=g(e,t),p.stringify(e))},updateCachedAttrValue:function(e,t){var o,i=this.parseAttrValueForCache(e),n=h(this.schema);if(void 0!==e){if(!n&&!t&&this.attrValue)for(o in this.attrValue)o in i||(i[o]=this.attrValue[o]);this.attrValue=_({},i,n)}},parseAttrValueForCache:function(e){var t;return"string"!=typeof e?e:(h(this.schema)?"string"==typeof(t=this.schema.parse(e))&&(t=e):t=p.parse(e),t)},flushToDOM:function(e){var t=e?this.data:this.attrValue;t&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(t))},updateProperties:function(e,t){var o,i,n=this.el,r=this.oldData;if(n.hasLoaded)if(o=h(this.schema),i=null!==e&&"object"==typeof this.previousAttrValue&&e===this.previousAttrValue,this.previousAttrValue=e,e=this.parseAttrValueForCache(e),this.updateSchema&&this.updateSchema(this.buildData(e,!1,!0)),this.data=this.buildData(e,t,!1,i),this.updateCachedAttrValue(e,t),this.initialized){if(s.deepEqual(this.oldData,this.data))return;this.oldData=_({},this.data,o),this.update(r),this.throttledEmitComponentChanged()}else{if(n.initializingComponents[this.name])return;n.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete n.initializingComponents[this.name],r=o&&"object"!=typeof c(void 0,this.schema)?void 0:{},this.oldData=_({},this.data,o),this.update(r),n.isPlaying&&this.play(),n.emit("componentinitialized",this.evtDetail,!1)}else this.updateCachedAttrValue(e)},resetProperty:function(e){if(h(this.schema))this.attrValue=void 0;else{if(!(e in this.attrValue))return;delete this.attrValue[e]}this.updateProperties(this.attrValue)},extendSchema:function(e){var t=s.extend({},a[this.name].schema);s.extend(t,e),this.schema=u(t),this.el.emit("schemachanged",{component:this.name})},buildData:function(e,t,o,i){var n,r,a,u,g,d,p,f=void 0!==e&&null!==e,m=this.schema,y=h(m),v=this.el.mixinEls;if(y)n=m.default&&m.default.constructor===Object?s.clone(m.default):m.default;else for(p=!t&&this.attrValue,n="object"==typeof p?function(e){var t,o,i={};for(o in e)t=e[o],i[o]=t&&t.constructor===Object?s.clone(t):t;return i}(p):{},d=0,a=Object.keys(m),u=a.length;d<u;d++)r=m[a[d]].default,void 0===n[a[d]]&&(n[a[d]]=r&&r.constructor===Object?s.clone(r):r);for(d=0;d<v.length;d++)(g=v[d].getAttribute(this.attrName))&&(n=_(n,g,y));if(f){if(y)return!0===i?e:c(e,m);n=_(n,e,y)}else{if(!0===i)return n;if(y)return c(n,m)}return!0===i?n:l(n,m,void 0,this.name,o)}},window.debug)var E=t.exports.registrationOrderWarnings={};function _(e,t,o){return!o||null!==t&&"object"==typeof t?s.extend(e,t):t}function T(e){return e.tick||e.tock}t.exports.registerComponent=function(e,t){var o,i,l,c={};if(document.currentScript&&document.currentScript!==m&&n.forEach(function(t){t.hasLoaded||document.currentScript.compareDocumentPosition(t)!==Node.DOCUMENT_POSITION_FOLLOWING&&(f("The component `"+e+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(E[e]=!0))}),!0===y.test(e)&&f("The component name `"+e+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+e.toLowerCase()+"`"),-1!==e.indexOf("__"))throw new Error("The component name `"+e+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(t).forEach(function(e){c[e]={value:t[e],writable:!0}}),a[e])throw new Error("The component `"+e+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");return((o=function(e,t,o){v.call(this,e,t,o)}).prototype=Object.create(v.prototype,c)).name=e,o.prototype.constructor=o,o.prototype.system=r&&r.systems[e],o.prototype.play=(i=o.prototype.play,function(){var e=this.el.sceneEl,t=this.el.isPlaying&&!this.isPlaying;this.initialized&&t&&(i.call(this),this.isPlaying=!0,T(this)&&e.addBehavior(this))}),o.prototype.pause=(l=o.prototype.pause,function(){var e=this.el.sceneEl;this.isPlaying&&(l.call(this),this.isPlaying=!1,T(this)&&e.removeBehavior(this))}),a[e]={Component:o,dependencies:o.prototype.dependencies,isSingleProp:h(o.prototype.schema),multiple:o.prototype.multiple,parse:o.prototype.parse,parseAttrValueForCache:o.prototype.parseAttrValueForCache,schema:s.extend(u(o.prototype.schema,o.prototype.name)),stringify:o.prototype.stringify,type:o.prototype.type},o}},{"../utils/":195,"./scene/scenes":131,"./schema":133,"./system":135}],126:[function(e,t,o){var i=e("./schema"),n=i.process,r=t.exports.geometries={},s=t.exports.geometryNames=[],a=e("../lib/three"),l=t.exports.Geometry=function(){};l.prototype={schema:{},init:function(e){return this.geometry=new a.Geometry,this.geometry},update:function(e){}},t.exports.registerGeometry=function(e,t){var o,i={};if(Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:!0}}),r[e])throw new Error("The geometry `"+e+"` has been already registered");return((o=function(){l.call(this)}).prototype=Object.create(l.prototype,i)).name=e,o.prototype.constructor=o,r[e]={Geometry:o,schema:n(o.prototype.schema)},s.push(e),o}},{"../lib/three":173,"./schema":133}],127:[function(e,t,o){var i=e("../utils/coordinates"),n=e("debug"),r=n("core:propertyTypes:warn"),s=n("core:propertyTypes:warn"),a=t.exports.propertyTypes={},l=/[,> .[\]:]/;function c(e,t,o,i){"type"in a?r("Property type "+e+" is already registered."):a[e]={default:t,parse:o||h,stringify:i||g}}function u(e){var t,o;return"string"!=typeof e?e:(o=e.match(/\url\((.+)\)/))?o[1]:"#"===e.charAt(0)?(t=document.getElementById(e.substring(1)))?"CANVAS"===t.tagName||"VIDEO"===t.tagName||"IMG"===t.tagName?t:t.getAttribute("src"):void s('"'+e+'" asset not found.'):e}function h(e){return e}function g(e){return null===e?"null":e.toString()}function d(e){return parseInt(e,10)}function p(e){return i.parse(e,this.default)}function f(e,t){if(null===e)return!0;if("object"!=typeof e)return!1;if(Object.keys(e).length!==t)return!1;var o=e.x,i=e.y,n=e.z,r=e.w;return!("number"!=typeof o||"number"!=typeof i||t>2&&"number"!=typeof n||t>3&&"number"!=typeof r)}c("audio","",u),c("array",[],function(e){return Array.isArray(e)?e:e&&"string"==typeof e?e.split(",").map(function(e){return e.trim()}):[]},function(e){return e.join(", ")}),c("asset","",u),c("boolean",!1,function(e){return"false"!==e&&!1!==e}),c("color","#FFF",h,g),c("int",0,d),c("number",0,function(e){return parseFloat(e,10)}),c("map","",u),c("model","",u),c("selector",null,function(e){return e?"string"!=typeof e?e:"#"!==e[0]||l.test(e)?document.querySelector(e):document.getElementById(e.substring(1)):null},function(e){return e.getAttribute?"#"+e.getAttribute("id"):g(e)}),c("selectorAll",null,function(e){return e?"string"!=typeof e?e:Array.prototype.slice.call(document.querySelectorAll(e),0):null},function(e){return e instanceof Array?e.map(function(e){return"#"+e.getAttribute("id")}).join(", "):g(e)}),c("src","",function(e){return s("`src` property type is deprecated. Use `asset` instead."),u(e)}),c("string","",h,g),c("time",0,d),c("vec2",{x:0,y:0},p,i.stringify),c("vec3",{x:0,y:0,z:0},p,i.stringify),c("vec4",{x:0,y:0,z:0,w:0},p,i.stringify),t.exports.registerPropertyType=c,t.exports.isValidDefaultValue=function(e,t){return("audio"!==e||"string"==typeof t)&&!("array"===e&&!Array.isArray(t))&&("asset"!==e||"string"==typeof t)&&("boolean"!==e||"boolean"==typeof t)&&("color"!==e||"string"==typeof t)&&("int"!==e||"number"==typeof t)&&("number"!==e||"number"==typeof t)&&("map"!==e||"string"==typeof t)&&("model"!==e||"string"==typeof t)&&("selector"!==e||"string"==typeof t||null===t)&&("selectorAll"!==e||"string"==typeof t||null===t)&&("src"!==e||"string"==typeof t)&&("string"!==e||"string"==typeof t)&&("time"!==e||"number"==typeof t)&&("vec2"===e?f(t,2):"vec3"===e?f(t,3):"vec4"!==e||f(t,4))},t.exports.isValidDefaultCoordinate=f},{"../utils/coordinates":190,debug:10}],128:[function(e,t,o){var i=e("./metaTags").inject,n=e("./wakelock"),r=e("../a-register-element"),s=e("./scenes"),a=e("../system").systems,l=e("../../lib/three"),c=e("@tweenjs/tween.js"),u=e("../../utils/"),h=e("../a-entity"),g=e("../a-node"),d=e("./postMessage"),p=u.bind,f=u.device.isIOS(),m=u.device.isMobile(),y=r.registerElement,v=u.debug("core:a-scene:warn");function E(e){return null!==e.getAttribute("antialias")?"true"===e.getAttribute("antialias"):!e.isMobile}function _(e){var t;function o(){var t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;t||e.exitVR(),document.activeElement.blur(),document.body.focus()}(t=document.createElement("canvas")).classList.add("a-canvas"),t.dataset.aframeCanvas=!0,e.appendChild(t),document.addEventListener("fullscreenchange",o),document.addEventListener("mozfullscreenchange",o),document.addEventListener("webkitfullscreenchange",o),t.addEventListener("touchmove",function(e){e.preventDefault()}),e.canvas=t,e.emit("render-target-loaded",{target:t}),setTimeout(p(e.resize,e),0)}t.exports.AScene=y("a-scene",{prototype:Object.create(h.prototype,{defaultComponents:{value:{inspector:"","keyboard-shortcuts":"",screenshot:"","vr-mode-ui":""}},createdCallback:{value:function(){this.isIOS=f,this.isMobile=m,this.isScene=!0,this.object3D=new l.Scene,this.render=p(this.render,this),this.systems={},this.systemNames=[],this.time=0,this.init()}},init:{value:function(){this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.renderTarget=null,_(this),this.setupRenderer(),this.resize(),this.addFullScreenStyles(),d(this)},writable:!0},addFullScreenStyles:{value:function(){var e=document.documentElement;e.classList.add("a-html"),document.body.classList.add("a-body"),this.classList.add("fullscreen")}},removeFullScreenStyles:{value:function(){var e=document.documentElement;e.classList.remove("a-html"),document.body.classList.remove("a-body"),this.classList.remove("fullscreen")}},attachedCallback:{value:function(){var e,t=this;i(this),n(this),this.initSystems(),e=p(this.resize,this),window.addEventListener("load",e),window.addEventListener("resize",e),this.play(),s.push(this),this.onVRPresentChangeBound=p(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){t.enterVR()},this.exitVRBound=function(){t.exitVR()},this.exitVRTrueBound=function(){t.exitVR(!0)},this.pointerRestrictedBound=function(){t.pointerRestricted()},this.pointerUnrestrictedBound=function(){t.pointerUnrestricted()},window.addEventListener("vrdisplayactivate",this.enterVRBound),window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)},writable:window.debug},initSystems:{value:function(){Object.keys(a).forEach(p(this.initSystem,this))}},initSystem:{value:function(e){this.systems[e]||(this.systems[e]=new a[e](this),this.systemNames.push(e))}},detachedCallback:{value:function(){var e;this.effect&&this.effect.cancelAnimationFrame?this.effect.cancelAnimationFrame(this.animationFrameID):window.cancelAnimationFrame(this.animationFrameID),this.animationFrameID=null,e=s.indexOf(this),s.splice(e,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)}},addBehavior:{value:function(e){var t=this,o=this.behaviors;Object.keys(o).forEach(function(o){if(e[o]){var i=t.behaviors[o];-1===i.indexOf(e)&&i.push(e)}})}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:u.device.checkHeadsetConnected,writable:window.debug},enterVR:{value:function(e){var t=this,o=this.effect;return this.is("vr-mode")?Promise.resolve("Already in VR."):e||!this.checkHeadsetConnected()&&!this.isMobile?(i(),Promise.resolve()):o&&o.requestPresent().then(i,function(e){throw e&&e.message?new Error("Failed to enter VR mode (`requestPresent`): "+e.message):new Error("Failed to enter VR mode (`requestPresent`).")})||Promise.reject(new Error("VREffect not initialized"));function i(){var e;t.addState("vr-mode"),t.emit("enter-vr",{target:t}),t.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),t.addFullScreenStyles(),t.isMobile||t.checkHeadsetConnected()||((e=t.canvas).requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen).apply(e),t.resize()}},writable:window.debug},exitVR:{value:function(e){var t=this;return this.is("vr-mode")?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),e||!this.checkHeadsetConnected()&&!this.isMobile?(o(),Promise.resolve()):this.effect.exitPresent().then(o,function(e){throw e&&e.message?new Error("Failed to exit VR mode (`exitPresent`): "+e.message):new Error("Failed to exit VR mode (`exitPresent`).")})):Promise.resolve("Not in VR.");function o(){t.removeState("vr-mode"),t.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),t.hasAttribute("embedded")&&t.removeFullScreenStyles(),t.resize(),t.isIOS&&u.forceCanvasResizeSafariMobile(this.canvas),t.emit("exit-vr",{target:t})}},writable:window.debug},pointerRestricted:{value:function(){if(this.canvas){var e=this.getPointerLockElement();e&&e!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var e=this.getPointerLockElement();e&&e===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(e){var t=e.display||e.detail.display;t.isPresenting?this.enterVR(!0):this.exitVR(!0)}},getAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getAttribute.call(this,e)}},getComputedAttribute:{value:function(e){v("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(e)}},getDOMAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getDOMAttribute.call(this,e)}},setAttribute:{value:function(e,t,o){var i=this.systems[e];if(i)return g.prototype.setAttribute.call(this,e,t),void i.updateProperties(t);h.prototype.setAttribute.call(this,e,t,o)}},removeBehavior:{value:function(e){var t=this,o=this.behaviors;Object.keys(o).forEach(function(o){if(e[o]){var i=t.behaviors[o],n=i.indexOf(e);-1!==n&&i.splice(n,1)}})}},resize:{value:function(){var e,t=this.camera,o=this.canvas,i=this.getAttribute("embedded")&&!this.is("vr-mode"),n=this.effect&&this.effect.isPresenting;!t||!o||this.is("vr-mode")&&(this.isMobile||n)||(e=function(e,t){return t?{height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth}:{height:window.innerHeight,width:window.innerWidth}}(o,i),t.aspect=e.width/e.height,t.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height))},writable:window.debug},setupRenderer:{value:function(){var e;(e=this.renderer=new l.WebGLRenderer({canvas:this.canvas,antialias:E(this),alpha:!0})).setPixelRatio(window.devicePixelRatio),e.sortObjects=!1,this.effect=new l.VREffect(e),this.effect.autoSubmitFrame=!1},writable:window.debug},play:{value:function(){var e=this;this.renderStarted?h.prototype.play.call(this):(this.addEventListener("loaded",function(){function e(e){e.renderStarted||(e.resize(),e.renderer&&(window.performance&&window.performance.mark("render-started"),e.clock=new l.Clock,e.render(),e.renderStarted=!0,e.emit("renderstart")))}h.prototype.play.call(this),this.camera?e(this):this.addEventListener("camera-set-active",function(){e(this)})}),setTimeout(function(){h.prototype.load.call(e)}))}},reload:{value:function(e){var t=this;e&&this.pause(),this.innerHTML=this.originalHTML,this.init(),g.prototype.load.call(this,function(){t.isPlaying&&h.prototype.play.call(t)})}},updateComponent:{value:function(e){e in a||h.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(e,t){var o,i=this.systems;for(c.update(),o=0;o<this.behaviors.tick.length;o++)this.behaviors.tick[o].el.isPlaying&&this.behaviors.tick[o].tick(e,t);for(o=0;o<this.systemNames.length;o++)i[this.systemNames[o]].tick&&i[this.systemNames[o]].tick(e,t)}},tock:{value:function(e,t){var o,i=this.systems;for(o=0;o<this.behaviors.tock.length;o++)this.behaviors.tock[o].el.isPlaying&&this.behaviors.tock[o].tock(e,t);for(o=0;o<this.systemNames.length;o++)i[this.systemNames[o]].tock&&i[this.systemNames[o]].tock(e,t)}},render:{value:function(){var e=this.effect,t=1e3*this.clock.getDelta();this.time=1e3*this.clock.elapsedTime,this.isPlaying&&this.tick(this.time,t),this.animationFrameID=e.requestAnimationFrame(this.render),e.render(this.object3D,this.camera,this.renderTarget),this.isPlaying&&this.tock(this.time,t),this.effect.submitFrame()},writable:!0}})}),t.exports.shouldAntiAlias=E,t.exports.setupCanvas=_},{"../../lib/three":173,"../../utils/":195,"../a-entity":121,"../a-node":123,"../a-register-element":124,"../system":135,"./metaTags":129,"./postMessage":130,"./scenes":131,"./wakelock":132,"@tweenjs/tween.js":1}],129:[function(e,t,o){var i,n=e("../../constants/"),r=e("../../utils").extend,s=t.exports.MOBILE_HEAD_TAGS=[l({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui"}),l({name:"mobile-web-app-capable",content:"yes"}),l({name:"theme-color",content:"black"})],a=[l({name:"apple-mobile-web-app-capable",content:"yes"}),l({name:"apple-mobile-web-app-status-bar-style",content:"black"}),(i={rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"},{tagName:"link",attributes:i,exists:function(){return document.querySelector('link[rel="'+i.rel+'"]')}})];function l(e){return{tagName:"meta",attributes:e,exists:function(){return document.querySelector('meta[name="'+e.name+'"]')}}}t.exports.inject=function(e){var t,o=document.head,i=o.querySelector("script"),l=[];return s.forEach(c),e.isIOS&&a.forEach(c),l;function c(e){e&&!e.exists()&&(t=function(e){if(e&&e.tagName){var t=document.createElement(e.tagName);return t.setAttribute(n.AFRAME_INJECTED,""),r(t,e.attributes)}}(e))&&(i?i.parentNode.insertBefore(t,i):o.appendChild(t),l.push(t))}}},{"../../constants/":116,"../../utils":195}],130:[function(e,t,o){var i=e("../../utils/bind"),n=e("../../utils/").isIframed;function r(e){if(e.data)switch(e.data.type){case"vr":switch(e.data.data){case"enter":this.enterVR();break;case"exit":this.exitVR()}}}t.exports=function(e){n()&&window.addEventListener("message",i(r,e))}},{"../../utils/":195,"../../utils/bind":189}],131:[function(e,t,o){t.exports=[]},{}],132:[function(e,t,o){var i=e("../../../vendor/wakelock/wakelock");t.exports=function(e){if(e.isMobile){var t=e.wakelock=new i;e.addEventListener("enter-vr",function(){t.request()}),e.addEventListener("exit-vr",function(){t.release()})}}},{"../../../vendor/wakelock/wakelock":205}],133:[function(e,t,o){var i=e("../utils/"),n=e("./propertyTypes"),r=i.debug,s=n.isValidDefaultValue,a=n.propertyTypes,l=r("core:schema:warn");function c(e){return"type"in e?"string"==typeof e.type:"default"in e}function u(e,t){var o,i,n=e.default,r=e.type;return e.type?"bool"===e.type?r="boolean":"float"===e.type&&(r="number"):r=void 0!==n&&-1!==["boolean","number"].indexOf(typeof n)?typeof n:Array.isArray(n)?"array":"string",(i=a[r])||l("Unknown property type for component `"+t+"`: "+r),o=!!e.parse,e.parse=e.parse||i.parse,e.stringify=e.stringify||i.stringify,e.type=r,"default"in e?o||s(r,n)||l("Default value `"+n+"` does not match type `"+r+"` in component `"+t+"`"):e.default=i.default,e}function h(e,t){return void 0!==e&&null!==e&&""!==e||(e=t.default,Array.isArray(e)&&(e=e.slice())),t.parse(e,t.default)}function g(e,t){return"object"!=typeof e?e:t&&null!==e?t.stringify(e):JSON.stringify(e)}t.exports.isSingleProperty=c,t.exports.process=function(e,t){return c(e)?u(e,t):(Object.keys(e).forEach(function(o){e[o]=u(e[o],t)}),e)},t.exports.processPropertyDefinition=u,t.exports.parseProperties=function(e,t,o,i,n){var r=Object.keys(o?e:t);return null===e||"object"!=typeof e?e:(Object.keys(e).forEach(function(e){t[e]||n||l("Unknown property `"+e+"` for component/system `"+i+"`.")}),r.forEach(function(o){var i=t[o],n=e[o];t[o]&&(e[o]=h(n,i))}),e)},t.exports.parseProperty=h,t.exports.stringifyProperties=function(e,t){var o={};return Object.keys(e).forEach(function(i){var n=t[i],r=e[i],s=r;"object"==typeof s&&(s=g(r,n),n||l("Unknown component property: "+i)),o[i]=s}),o},t.exports.stringifyProperty=g},{"../utils/":195,"./propertyTypes":127}],134:[function(e,t,o){var i=e("./schema"),n=i.process,r=t.exports.shaders={},s=t.exports.shaderNames=[],a=e("../lib/three"),l=e("../utils"),c={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},u=t.exports.Shader=function(){};u.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(e){return this.attributes=this.initVariables(e,"attribute"),this.uniforms=this.initVariables(e,"uniform"),this.material=new(this.raw?a.RawShaderMaterial:a.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(e,t){var o={},i=this.schema;return Object.keys(i).forEach(function(e){if(i[e].is===t){var n=c[i[e].type];o[e]={type:n,value:void 0}}}),o},update:function(e){this.updateVariables(e,"attribute"),this.updateVariables(e,"uniform")},updateVariables:function(e,t){var o=this,i="uniform"===t?this.uniforms:this.attributes,n=this.schema;Object.keys(e).forEach(function(r){var s;if(n[r]&&n[r].is===t){if("map"===n[r].type){if(!i[r]||i[r].value===e[r])return;return s="_texture_"+r,o.el.addEventListener("materialtextureloaded",function(){i[r].value=o.material[s],i[r].needsUpdate=!0}),void l.material.updateMapMaterialFromData(s,r,o,e)}i[r].value=o.parseValue(n[r].type,e[r]),i[r].needsUpdate=!0}})},parseValue:function(e,t){var o;switch(e){case"vec2":return new a.Vector2(t.x,t.y);case"vec3":return new a.Vector3(t.x,t.y,t.z);case"vec4":return new a.Vector4(t.x,t.y,t.z,t.w);case"color":return o=new a.Color(t),new a.Vector3(o.r,o.g,o.b);case"map":return a.ImageUtils.loadTexture(t);default:return t}}},t.exports.registerShader=function(e,t){var o,i={};if(Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:!0}}),r[e])throw new Error("The shader "+e+" has been already registered");return((o=function(){u.call(this)}).prototype=Object.create(u.prototype,i)).name=e,o.prototype.constructor=o,r[e]={Shader:o,schema:n(o.prototype.schema)},s.push(e),o}},{"../lib/three":173,"../utils":195,"./schema":133}],135:[function(e,t,o){var i=e("./component"),n=e("./schema"),r=e("../utils/"),s=n.parseProperties,a=n.parseProperty,l=n.process,c=n.isSingleProperty,u=r.styleParser,h=t.exports.systems={},g=t.exports.System=function(e){var t=i&&i.components[this.name];this.el=e,this.sceneEl=e,t&&(t.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};g.prototype={schema:{},init:function(){},update:function(e){},updateProperties:function(e){var t=this.data;Object.keys(n).length&&(this.buildData(e),this.update(t))},buildData:function(e){var t=this.schema;Object.keys(t).length&&(e=e||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),c(t)?this.data=a(e,t):this.data=s(u.parse(e)||{},t))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},t.exports.registerSystem=function(e,t){var o,i,n={},s=r.findAllScenes(document);if(Object.keys(t).forEach(function(e){n[e]={value:t[e],writable:!0}}),h[e])throw new Error("The system `"+e+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(((i=function(e){g.call(this,e)}).prototype=Object.create(g.prototype,n)).name=e,i.prototype.constructor=i,i.prototype.schema=r.extend(l(i.prototype.schema)),h[e]=i,o=0;o<s.length;o++)s[o].initSystem(e)}},{"../utils/":195,"./component":125,"./schema":133}],136:[function(e,t,o){e("./pivot")},{"./pivot":137}],137:[function(e,t,o){var i=e("../../core/component").registerComponent,n=e("../../lib/three"),r=new n.Vector3,s=new n.Vector3;i("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var e=this.data,t=this.el,o=t.object3D.parent,i=t.object3D,a=new n.Group;r.copy(i.position),s.copy(i.rotation),o.remove(i),a.add(i),o.add(a),t.object3D=a,i.position.set(-1*e.x,-1*e.y,-1*e.z),a.position.set(e.x+r.x,e.y+r.y,e.z+r.z),a.rotation.copy(i.rotation),i.rotation.set(0,0,0)}})},{"../../core/component":125,"../../lib/three":173}],138:[function(e,t,o){var i=e("../../core/component").components,n=e("../../core/shader").shaders,r=e("../../utils/"),s={};function a(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===e&&(t="material-fog"),"visible"===e&&(t="material-visible"),s[t]="material."+e}Object.keys(i.material.schema).forEach(a),Object.keys(n.standard.schema).forEach(a),t.exports=function(){return{defaultComponents:{material:{}},mappings:r.extend({},s)}}},{"../../core/component":125,"../../core/shader":134,"../../utils/":195}],139:[function(e,t,o){e("./primitives/a-camera"),e("./primitives/a-collada-model"),e("./primitives/a-cursor"),e("./primitives/a-curvedimage"),e("./primitives/a-gltf-model"),e("./primitives/a-image"),e("./primitives/a-light"),e("./primitives/a-link"),e("./primitives/a-obj-model"),e("./primitives/a-sky"),e("./primitives/a-sound"),e("./primitives/a-text"),e("./primitives/a-video"),e("./primitives/a-videosphere"),e("./primitives/meshPrimitives")},{"./primitives/a-camera":141,"./primitives/a-collada-model":142,"./primitives/a-cursor":143,"./primitives/a-curvedimage":144,"./primitives/a-gltf-model":145,"./primitives/a-image":146,"./primitives/a-light":147,"./primitives/a-link":148,"./primitives/a-obj-model":149,"./primitives/a-sky":150,"./primitives/a-sound":151,"./primitives/a-text":152,"./primitives/a-video":153,"./primitives/a-videosphere":154,"./primitives/meshPrimitives":155}],140:[function(e,t,o){var i=e("../../core/a-entity"),n=e("../../core/component").components,r=e("../../core/a-register-element").registerElement,s=e("../../utils/"),a=s.debug,l=s.entity.setComponentProperty,c=a("extras:primitives:debug"),u=a("extras:primitives:warn"),h=t.exports.primitives={};t.exports.registerPrimitive=function(e,t){e=e.toLowerCase(),c("Registering <%s>",e),t.defaultAttributes&&u("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var o=r(e,{prototype:Object.create(i.prototype,{defaultComponentsFromPrimitive:{value:t.defaultComponents||t.defaultAttributes||{}},deprecated:{value:t.deprecated||null},deprecatedMappings:{value:t.deprecatedMappings||{}},mappings:{value:t.mappings||{}},createdCallback:{value:function(){t.deprecated&&console.warn(t.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var e=this.mappings,t=this;Object.keys(e).forEach(function(o){var i;o!==o.toLowerCase()&&u("Mapping keys should be specified in lower case. The mapping key "+o+" may not be recognized"),n[o]&&(i=e[o].replace(".","-"),e[i]=e[o],delete e[o],console.warn("The primitive "+t.tagName.toLowerCase()+" has a mapping collision. The attribute "+o+" has the same name as a registered component and has been renamed to "+i))})}},getExtraComponents:{value:function(){var e,t,o,i,n,r,a=this;for(t=s.clone(this.defaultComponentsFromPrimitive),(n=this.getAttribute("mixin"))&&(n=n.trim().split(" ")).forEach(function(e){var o=a.sceneEl.querySelector("#"+e).componentCache;Object.keys(o).forEach(function(e){var i,n;t[e]=(i=t[e],n=o[e],l(i)?c(n):l(n)?c(i):u(i)&&u(n)?s.extendDeep(i,n):c(n))})}),o=0;o<this.attributes.length;o++)e=this.attributes[o],(i=this.mappings[e.name])&&((r=s.entity.getComponentPropertyPath(i)).constructor===Array?(t[r[0]]=t[r[0]]||{},t[r[0]][r[1]]=e.value):t[r]=e.value);return t;function l(e){return void 0===e}function c(e){return u(e)?s.extendDeep({},e):e}function u(e){return null!==e&&e.constructor===Object}}},attributeChangedCallback:{value:function(e,t,o){var i=this.mappings[e];e in this.deprecatedMappings&&console.warn(this.deprecatedMappings[e]),e&&i&&l(this,i,o)}}})});return h[e]=o,o},t.exports.definePrimitive=function(e,o,i){i=i||{},Object.keys(o).map(function(e){!function(e,t){var o=n[e].schema;Object.keys(o).map(function(o){var i=o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==t[i]&&(i=e+"-"+o),t[i]=e+"."+o})}(e,i)}),t.exports.registerPrimitive(e,s.extendDeep({},null,{defaultComponents:o,mappings:i}))}},{"../../core/a-entity":121,"../../core/a-register-element":124,"../../core/component":125,"../../utils/":195}],141:[function(e,t,o){var i=e("../../../constants/").DEFAULT_CAMERA_HEIGHT,n=e("../primitives").registerPrimitive;n("a-camera",{defaultComponents:{camera:{userHeight:i},"look-controls":{},"wasd-controls":{}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag","user-height":"camera.userHeight",zoom:"camera.zoom"},deprecatedMappings:{"cursor-color":"a-camera[cursor-color] has been removed. Use a-cursor[color] instead.","cursor-maxdistance":"a-camera[cursor-maxdistance] has been removed. Use a-cursor[max-distance] instead.","cursor-offset":"a-camera[cursor-offset] has been removed. Use a-cursor[position] instead.","cursor-opacity":"a-camera[cursor-offset] has been removed. Use a-cursor[opacity] instead.","cursor-scale":"a-camera[cursor-scale] has been removed. Use a-cursor[scale] instead.","cursor-visible":"a-camera[cursor-visible] has been removed. Use a-cursor[visible] instead."}})},{"../../../constants/":116,"../primitives":140}],142:[function(e,t,o){var i=e("../primitives").registerPrimitive;i("a-collada-model",{mappings:{src:"collada-model"}})},{"../primitives":140}],143:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-cursor",r.extendDeep({},i(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],144:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-curvedimage",r.extendDeep({},i(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],145:[function(e,t,o){var i=e("../primitives").registerPrimitive;i("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":140}],146:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-image",r.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],147:[function(e,t,o){var i=e("../primitives").registerPrimitive;i("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":140}],148:[function(e,t,o){var i=e("../primitives").registerPrimitive;i("a-link",{defaultComponents:{},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":140}],149:[function(e,t,o){var i=e("../getMeshMixin")(),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-obj-model",r.extendDeep({},i,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],150:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/"),s=e("./meshPrimitives");n("a-sky",r.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:r.extendDeep({},s["a-sphere"].prototype.mappings)}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140,"./meshPrimitives":155}],151:[function(e,t,o){var i=e("../primitives").registerPrimitive;i("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":140}],152:[function(e,t,o){var i=e("../primitives").definePrimitive;i("a-text",{text:{anchor:"align",width:5}})},{"../primitives":140}],153:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-video",r.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],154:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../primitives").registerPrimitive,r=e("../../../utils/");n("a-videosphere",r.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],155:[function(e,t,o){var i=e("../getMeshMixin"),n=e("../../../core/geometry").geometries,r=e("../../../core/geometry").geometryNames,s=e("../primitives").registerPrimitive,a=e("../../../utils/"),l=t.exports={};function c(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}r.forEach(function(e){var t=n[e],o=c(e),r={};Object.keys(t.schema).forEach(function(e){r[c(e)]="geometry."+e});var u="a-"+o,h=s(u,a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:e}},mappings:r}));l[u]=h})},{"../../../core/geometry":126,"../../../utils/":195,"../getMeshMixin":138,"../primitives":140}],156:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new n.BoxGeometry(e.width,e.height,e.depth,e.segmentsWidth,e.segmentsHeight,e.segmentsDepth)}})},{"../core/geometry":126,"../lib/three":173}],157:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CircleGeometry(e.radius,e.segments,r(e.thetaStart),r(e.thetaLength))}})},{"../core/geometry":126,"../lib/three":173}],158:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,r(e.thetaStart),r(e.thetaLength))}})},{"../core/geometry":126,"../lib/three":173}],159:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CylinderGeometry(e.radius,e.radius,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,r(e.thetaStart),r(e.thetaLength))}})},{"../core/geometry":126,"../lib/three":173}],160:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.DodecahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":126,"../lib/three":173}],161:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.IcosahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":126,"../lib/three":173}],162:[function(e,t,o){e("./box.js"),e("./circle.js"),e("./cone.js"),e("./cylinder.js"),e("./dodecahedron.js"),e("./icosahedron.js"),e("./octahedron.js"),e("./plane.js"),e("./ring.js"),e("./sphere.js"),e("./tetrahedron.js"),e("./torus.js"),e("./torusKnot.js"),e("./triangle.js")},{"./box.js":156,"./circle.js":157,"./cone.js":158,"./cylinder.js":159,"./dodecahedron.js":160,"./icosahedron.js":161,"./octahedron.js":163,"./plane.js":164,"./ring.js":165,"./sphere.js":166,"./tetrahedron.js":167,"./torus.js":168,"./torusKnot.js":169,"./triangle.js":170}],163:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.OctahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":126,"../lib/three":173}],164:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new n.PlaneGeometry(e.width,e.height,e.segmentsWidth,e.segmentsHeight)}})},{"../core/geometry":126,"../lib/three":173}],165:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.RingGeometry(e.radiusInner,e.radiusOuter,e.segmentsTheta,e.segmentsPhi,r(e.thetaStart),r(e.thetaLength))}})},{"../core/geometry":126,"../lib/three":173}],166:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(e){this.geometry=new n.SphereGeometry(e.radius,e.segmentsWidth,e.segmentsHeight,r(e.phiStart),r(e.phiLength),r(e.thetaStart),r(e.thetaLength))}})},{"../core/geometry":126,"../lib/three":173}],167:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.TetrahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":126,"../lib/three":173}],168:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=n.Math.degToRad;i("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(e){this.geometry=new n.TorusGeometry(e.radius,2*e.radiusTubular,e.segmentsRadial,e.segmentsTubular,r(e.arc))}})},{"../core/geometry":126,"../lib/three":173}],169:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three");i("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(e){this.geometry=new n.TorusKnotGeometry(e.radius,2*e.radiusTubular,e.segmentsTubular,e.segmentsRadial,e.p,e.q)}})},{"../core/geometry":126,"../lib/three":173}],170:[function(e,t,o){var i=e("../core/geometry").registerGeometry,n=e("../lib/three"),r=new n.Quaternion,s=new n.Vector3(0,0,1),a=new n.Vector2,l=new n.Vector2,c=new n.Vector2;i("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(e){var t,o,i,u,h,g;(i=new n.Triangle).a.set(e.vertexA.x,e.vertexA.y,e.vertexA.z),i.b.set(e.vertexB.x,e.vertexB.y,e.vertexB.z),i.c.set(e.vertexC.x,e.vertexC.y,e.vertexC.z),o=i.normal(),r.setFromUnitVectors(o,s),u=i.a.clone().applyQuaternion(r),h=i.b.clone().applyQuaternion(r),g=i.c.clone().applyQuaternion(r),a.set(Math.min(u.x,h.x,g.x),Math.min(u.y,h.y,g.y)),l.set(Math.max(u.x,h.x,g.x),Math.max(u.y,h.y,g.y)),c.set(0,0).subVectors(l,a),u=(new n.Vector2).subVectors(u,a).divide(c),h=(new n.Vector2).subVectors(h,a).divide(c),g=(new n.Vector2).subVectors(g,a).divide(c),(t=this.geometry=new n.Geometry).vertices.push(i.a),t.vertices.push(i.b),t.vertices.push(i.c),t.faces.push(new n.Face3(0,1,2,o)),t.faceVertexUvs[0]=[[u,h,g]]}})},{"../core/geometry":126,"../lib/three":173}],171:[function(e,t,o){var i=e("./utils/"),n=i.debug,r=n("A-Frame:error"),s=n("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&s("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),"file:"===window.location.protocol&&r("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),window.Promise=window.Promise||e("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.WebVRConfig=window.WebVRConfig||{BUFFER_SCALE:1,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,TOUCH_PANNER_DISABLED:!0,MOUSE_KEYBOARD_CONTROLS_DISABLED:!0},i.device.isIOSOlderThan10(window.navigator.userAgent)&&(window.WebVRConfig.BUFFER_SCALE=1/window.devicePixelRatio),e("webvr-polyfill"),e("present"),i.device.isBrowserEnvironment&&(e("./style/aframe.css"),e("./style/rStats.css"));var a=e("./core/scene/a-scene").AScene,l=e("./core/component").components,c=e("./core/component").registerComponent,u=e("./core/geometry").registerGeometry,h=e("./extras/primitives/primitives").registerPrimitive,g=e("./core/shader").registerShader,d=e("./core/system").registerSystem,p=e("./core/shader").shaders,f=e("./core/system").systems,m=window.THREE=e("./lib/three"),y=window.TWEEN=e("@tweenjs/tween.js"),v=e("../package");e("./components/index"),e("./geometries/index"),e("./shaders/index"),e("./systems/index");var E=e("./core/a-node"),_=e("./core/a-entity");e("./core/a-animation"),e("./core/a-assets"),e("./core/a-cubemap"),e("./core/a-mixin"),e("./extras/components/"),e("./extras/primitives/"),console.log("A-Frame Version: 0.7.1 (Date 18-10-2017, Commit #0da6cf4)"),console.log("three Version:",v.dependencies.three),console.log("WebVR Polyfill Version:",v.dependencies["webvr-polyfill"]),t.exports=window.AFRAME={AComponent:e("./core/component").Component,AEntity:_,ANode:E,AScene:a,components:l,geometries:e("./core/geometry").geometries,registerComponent:c,registerElement:e("./core/a-register-element").registerElement,registerGeometry:u,registerPrimitive:h,registerShader:g,registerSystem:d,primitives:{getMeshMixin:e("./extras/primitives/getMeshMixin"),primitives:e("./extras/primitives/primitives").primitives},scenes:e("./core/scene/scenes"),schema:e("./core/schema"),shaders:p,systems:f,THREE:m,TWEEN:y,utils:i,version:v.version}},{"../package":76,"./components/index":85,"./core/a-animation":118,"./core/a-assets":119,"./core/a-cubemap":120,"./core/a-entity":121,"./core/a-mixin":122,"./core/a-node":123,"./core/a-register-element":124,"./core/component":125,"./core/geometry":126,"./core/scene/a-scene":128,"./core/scene/scenes":131,"./core/schema":133,"./core/shader":134,"./core/system":135,"./extras/components/":136,"./extras/primitives/":139,"./extras/primitives/getMeshMixin":138,"./extras/primitives/primitives":140,"./geometries/index":162,"./lib/three":173,"./shaders/index":175,"./style/aframe.css":180,"./style/rStats.css":181,"./systems/index":184,"./utils/":195,"@tweenjs/tween.js":1,present:33,"promise-polyfill":34,"webvr-polyfill":61}],172:[function(e,t,o){window.aframeStats=function(e){var t=null,o=e;return{update:function(){var e;t("te").set((e=o.querySelectorAll("*"),Array.prototype.slice.call(e).filter(function(e){return e.isEntity}),e.length)),window.performance.getEntriesByName&&t("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))},start:function(){},end:function(){},attach:function(e){t=e},values:{te:{caption:"Entities"},lt:{caption:"Load Time"}},groups:[{caption:"A-Frame",values:["te","lt"]}],fractions:[]}},"object"==typeof t&&(t.exports={aframeStats:window.aframeStats})},{}],173:[function(e,t,i){(function(o){var i=o.THREE=e("three");i.TextureLoader&&(i.TextureLoader.prototype.crossOrigin="anonymous"),i.ImageLoader&&(i.ImageLoader.prototype.crossOrigin="anonymous"),i.Cache&&(i.Cache.enabled=!0),e("three/examples/js/loaders/GLTFLoader"),e("three/examples/js/loaders/OBJLoader"),e("three/examples/js/loaders/MTLLoader"),e("three/examples/js/loaders/ColladaLoader"),e("../../vendor/VRControls"),e("../../vendor/VREffect"),i.ColladaLoader.prototype.crossOrigin="anonymous",i.GLTFLoader.prototype.crossOrigin="anonymous",i.MTLLoader.prototype.crossOrigin="anonymous",i.OBJLoader.prototype.crossOrigin="anonymous",t.exports=i}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../vendor/VRControls":200,"../../vendor/VREffect":201,three:41,"three/examples/js/loaders/ColladaLoader":42,"three/examples/js/loaders/GLTFLoader":43,"three/examples/js/loaders/MTLLoader":44,"three/examples/js/loaders/OBJLoader":45}],174:[function(e,t,o){var i=e("../core/shader").registerShader,n=e("../lib/three"),r=e("../utils/");function s(e){return{fog:e.fog,color:new n.Color(e.color),wireframe:e.wireframe,wireframeLinewidth:e.wireframeLinewidth}}t.exports.Shader=i("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.textureSrc=null,this.material=new n.MeshBasicMaterial(s(e)),r.material.updateMap(this,e)},update:function(e){this.updateMaterial(e),r.material.updateMap(this,e)},updateMaterial:function(e){var t=this.material;e=s(e),Object.keys(e).forEach(function(o){t[o]=e[o]})}})},{"../core/shader":134,"../lib/three":173,"../utils/":195}],175:[function(e,t,o){e("./flat"),e("./standard"),e("./sdf"),e("./msdf"),e("./ios10hls")},{"./flat":174,"./ios10hls":176,"./msdf":177,"./sdf":178,"./standard":179}],176:[function(e,t,o){var i=e("../core/shader").registerShader;t.exports.Shader=i("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join("\n")})},{"../core/shader":134}],177:[function(e,t,o){var i=e("../core/shader").registerShader;t.exports.Shader=i("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","uniform sampler2D map;","uniform vec3 color;","uniform float opacity;","uniform float alphaTest;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","void main() {","  vec3 sample = 1.0 - texture2D(map, vUV).rgb;","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  if (isBigEnough <= BIG_ENOUGH && alpha < alphaTest) { discard; return; }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join("\n")})},{"../core/shader":134}],178:[function(e,t,o){var i=e("../core/shader").registerShader;t.exports.Shader=i("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","uniform sampler2D map;","uniform vec3 color;","uniform float opacity;","uniform float alphaTest;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#else","float aastep(float value, float afwidth) {","  return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","}","#endif","void main() {","#ifdef GL_OES_standard_derivatives","  vec2 uv = vUV;","  vec4 texColor = texture2D(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  else if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture2D(map, box.xy).a, width)","      + contour(texture2D(map, box.zw).a, width)","      + contour(texture2D(map, box.xw).a, width)","      + contour(texture2D(map, box.zy).a, width)","    )) / 3.0;","  }","  if (isBigEnough <= BIG_ENOUGH && alpha < alphaTest) { discard; return; }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","#else","  vec4 texColor = texture2D(map, vUV);","  float value = texColor.a;","  float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","  float alpha = aastep(value, afwidth);","  float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","  if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","  alpha = alpha * ratio + (1.0 - ratio) * value;","  if (ratio < 1.0)","    if (alpha <= DISCARD_ALPHA) { discard; return; }","#endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join("\n")})},{"../core/shader":134}],179:[function(e,t,o){var i=e("../core/shader").registerShader,n=e("../lib/three"),r=e("../utils/"),s=new n.CubeTextureLoader,a={};function l(e){var t={color:new n.Color(e.color),emissive:new n.Color(e.emissive),emissiveIntensity:e.emissiveIntensity,fog:e.fog,metalness:e.metalness,roughness:e.roughness,wireframe:e.wireframe,wireframeLinewidth:e.wireframeLinewidth};return e.normalMap&&(t.normalScale=e.normalScale),e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity),e.displacementMap&&(t.displacementScale=e.displacementScale,t.displacementBias=e.displacementBias),t}t.exports.Shader=i("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.material=new n.MeshStandardMaterial(l(e)),r.material.updateMap(this,e),e.normalMap&&r.material.updateDistortionMap("normal",this,e),e.displacementMap&&r.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&r.material.updateDistortionMap("ambientOcclusion",this,e),this.updateEnvMap(e)},update:function(e){this.updateMaterial(e),r.material.updateMap(this,e),e.normalMap&&r.material.updateDistortionMap("normal",this,e),e.displacementMap&&r.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&r.material.updateDistortionMap("ambientOcclusion",this,e),this.updateEnvMap(e)},updateMaterial:function(e){var t=this.material;e=l(e),Object.keys(e).forEach(function(o){t[o]=e[o]})},updateEnvMap:function(e){var t=this,o=this.material,i=e.envMap,l=e.sphericalEnvMap;if(!i&&!l||this.isLoadingEnvMap)return o.envMap=null,void(o.needsUpdate=!0);this.isLoadingEnvMap=!0,l?this.el.sceneEl.systems.material.loadTexture(l,{src:l},function(e){t.isLoadingEnvMap=!1,e.mapping=n.SphericalReflectionMapping,o.envMap=e,r.material.handleTextureEvents(t.el,e),o.needsUpdate=!0}):a[i]?a[i].then(function(e){t.isLoadingEnvMap=!1,o.envMap=e,r.material.handleTextureEvents(t.el,e),o.needsUpdate=!0}):a[i]=new Promise(function(e){r.srcLoader.validateCubemapSrc(i,function(i){s.load(i,function(i){t.isLoadingEnvMap=!1,o.envMap=i,r.material.handleTextureEvents(t.el,i),e(i)})})})}})},{"../core/shader":134,"../lib/three":173,"../utils/":195}],180:[function(e,t,o){var i=".a-html{bottom:0;left:0;position:fixed;right:0;top:0}.a-body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}.a-canvas.a-grab-cursor:active,.a-grabbing{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}// Class is removed when doing <a-scene embedded>. a-scene.fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:999999!important;position:fixed!important}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-vr.embedded{right:5px;bottom:5px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff}.a-enter-vr-button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20245.82%20141.73%22%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill%3A%23fff%3Bfill-rule%3Aevenodd%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3Emask%3C%2Ftitle%3E%3Cpath%20class%3D%22a%22%20d%3D%22M175.56%2C111.37c-22.52%2C0-40.77-18.84-40.77-42.07S153%2C27.24%2C175.56%2C27.24s40.77%2C18.84%2C40.77%2C42.07S198.08%2C111.37%2C175.56%2C111.37ZM26.84%2C69.31c0-23.23%2C18.25-42.07%2C40.77-42.07s40.77%2C18.84%2C40.77%2C42.07-18.26%2C42.07-40.77%2C42.07S26.84%2C92.54%2C26.84%2C69.31ZM27.27%2C0C11.54%2C0%2C0%2C12.34%2C0%2C28.58V110.9c0%2C16.24%2C11.54%2C30.83%2C27.27%2C30.83H99.57c2.17%2C0%2C4.19-1.83%2C5.4-3.7L116.47%2C118a8%2C8%2C0%2C0%2C1%2C12.52-.18l11.51%2C20.34c1.2%2C1.86%2C3.22%2C3.61%2C5.39%2C3.61h72.29c15.74%2C0%2C27.63-14.6%2C27.63-30.83V28.58C245.82%2C12.34%2C233.93%2C0%2C218.19%2C0H27.27Z%22%2F%3E%3C%2Fsvg%3E) 50% 50%/70% 70% no-repeat rgba(0,0,0,.35);border:0;bottom:0;cursor:pointer;min-width:50px;min-height:30px;padding-right:5%;padding-top:4%;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999}.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#666}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}";e("browserify-css").createStyle(i,{href:"src\\style\\aframe.css"}),t.exports=i},{"browserify-css":5}],181:[function(e,t,o){var i=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";e("browserify-css").createStyle(i,{href:"src\\style\\rStats.css"}),t.exports=i},{"browserify-css":5}],182:[function(e,t,o){var i=e("../utils/bind"),n=e("../constants/"),r=e("../core/system").registerSystem,s="data-aframe-default-camera";t.exports.System=r("camera",{init:function(){this.activeCameraEl=null,this.sceneEl.addEventListener("loaded",i(this.setupDefaultCamera,this))},setupDefaultCamera:function(){var e,t=this.sceneEl;t.camera?t.emit("camera-ready",{cameraEl:t.camera.el}):((e=document.createElement("a-entity")).setAttribute("position","0 0 0"),e.setAttribute(s,""),e.setAttribute("camera",{active:!0,userHeight:n.DEFAULT_CAMERA_HEIGHT}),e.setAttribute("wasd-controls",""),e.setAttribute("look-controls",""),e.setAttribute(n.AFRAME_INJECTED,""),t.appendChild(e),t.addEventListener("enter-vr",this.removeDefaultOffset),t.addEventListener("exit-vr",this.addDefaultOffset),t.emit("camera-ready",{cameraEl:e}))},disableActiveCamera:function(){var e=this.sceneEl.querySelectorAll("[camera]"),t=e[e.length-1];t.setAttribute("camera","active",!0)},setActiveCamera:function(e){var t,o,i,n,r=this.activeCameraEl,a=this.sceneEl;if((n=e.getObject3D("camera"))&&e!==this.activeCameraEl){var l=a.querySelector("["+s+"]"),c=l&&l.querySelector("[camera]");for(e!==c&&function(e){var t;e.camera&&(t=e.querySelector("["+s+"]"))&&e.removeChild(t)}(a),this.activeCameraEl=e,this.activeCameraEl.play(),a.camera=n,r&&r.setAttribute("camera","active",!1),o=a.querySelectorAll("[camera]"),i=0;i<o.length;i++)t=o[i],e!==t&&(t.setAttribute("camera","active",!1),t.pause());a.emit("camera-set-active",{cameraEl:e})}}})},{"../constants/":116,"../core/system":135,"../utils/bind":189}],183:[function(e,t,o){var i=e("../core/geometry").geometries,n=e("../core/system").registerSystem,r=e("../lib/three");function s(e){var t,o,n=e.primitive,s=i[n]&&i[n].Geometry,a=new s;if(!s)throw new Error("Unknown geometry `"+n+"`");return a.init(e),t=a.geometry,e.buffer?((o=(new r.BufferGeometry).fromGeometry(t)).metadata={type:t.type,parameters:t.parameters||{}},t.dispose(),o):t}t.exports.System=n("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(e){var t,o,i=this.cache;return e.skipCache||e.mergeTo?s(e):(o=this.hash(e),t=i[o],function(e,t){e[t]=void 0===e[t]?1:e[t]+1}(this.cacheCount,o),t||(t=s(e),i[o]=t,t))},unuseGeometry:function(e){var t,o=this.cache,i=this.cacheCount;e.skipCache||e.mergeTo||(t=this.hash(e),o[t]&&(function(e,t){e[t]--}(i,t),i[t]>0||(o[t].dispose(),delete o[t],delete i[t])))},hash:function(e){return JSON.stringify(e)}})},{"../core/geometry":126,"../core/system":135,"../lib/three":173}],184:[function(e,t,o){e("./camera"),e("./geometry"),e("./light"),e("./material"),e("./shadow"),e("./tracked-controls")},{"./camera":182,"./geometry":183,"./light":185,"./material":186,"./shadow":187,"./tracked-controls":188}],185:[function(e,t,o){var i=e("../core/system").registerSystem,n=e("../utils/bind"),r=e("../constants/");t.exports.System=i("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",n(this.setupDefaultLights,this))},registerLight:function(e){e.hasAttribute("data-aframe-default-light")||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var e,t=this.sceneEl;if(this.defaultLights){e=document.querySelectorAll("[data-aframe-default-light]");for(var o=0;o<e.length;o++)t.removeChild(e[o]);this.defaultLights=!1}},setupDefaultLights:function(){var e,t,o=this.sceneEl;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||((e=document.createElement("a-entity")).setAttribute("light",{color:"#BBB",type:"ambient"}),e.setAttribute("data-aframe-default-light",""),e.setAttribute(r.AFRAME_INJECTED,""),o.appendChild(e),(t=document.createElement("a-entity")).setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),t.setAttribute("position",{x:-.5,y:1,z:1}),t.setAttribute("data-aframe-default-light",""),t.setAttribute(r.AFRAME_INJECTED,""),o.appendChild(t),this.defaultLights=!0)}})},{"../constants/":116,"../core/system":135,"../utils/bind":189}],186:[function(e,t,o){var i=e("../core/system").registerSystem,n=e("../lib/three"),r=e("../utils/"),s=e("../utils/material").isHLS,a=r.bind,l=r.debug,c=l("components:texture:error"),u=new n.TextureLoader,h=l("components:texture:warn");function g(e,t){var o=t.offset||{x:0,y:0},i=t.repeat||{x:1,y:1},r=t.npot||!1;r&&(e.wrapS=n.ClampToEdgeWrapping,e.wrapT=n.ClampToEdgeWrapping,e.magFilter=n.LinearFilter,e.minFilter=n.LinearFilter),1===i.x&&1===i.y||(e.wrapS=n.RepeatWrapping,e.wrapT=n.RepeatWrapping,e.repeat.set(i.x,i.y)),0===o.x&&0===o.y||e.offset.set(o.x,o.y)}u.setCrossOrigin("anonymous"),t.exports.System=i("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",a(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(e,t,o){var i=this;if("CANVAS"!==e.tagName){if("VIDEO"===e.tagName)return e.hasAttribute("src")||e.hasAttribute("srcObject")||h("Video element was defined without `src` nor `srcObject` attributes."),void this.loadVideo(e,t,o);r.srcLoader.validateSrc(e,function(e){i.loadImage(e,t,o)},function(e){i.loadVideo(e,t,o)})}else this.loadCanvas(e,t,o)},loadImage:function(e,t,o){var i=this.hash(t),r=this.textureCache;r[i]?r[i].then(o):(r[i]=function(e,t){return new Promise(function(o,i){function r(e){g(e,t),e.needsUpdate=!0,o(e)}"string"==typeof e?u.load(e,r,function(){},function(e){c("`$s` could not be fetched (Error code: %s; Response: %s)",e.status,e.statusText)}):r(new n.Texture(e))})}(e,t),r[i].then(o))},loadCanvas:function(e,t,o){e.readyState=2,e.HAVE_CURRENT_DATA=2,this.loadVideo(e,t,o)},loadVideo:function(e,t,o){var i,r,a,l,c=this.textureCache;function u(e){e.texture.needsUpdate=!0,o(e.texture,e.videoEl)}if("string"!=typeof e){if(a=e,i=this.hashVideo(t,a),c[i])return void c[i].then(u);!function(e){e.autoplay=e.hasAttribute("autoplay")&&"false"!==e.getAttribute("autoplay"),e.controls=e.hasAttribute("controls")&&"false"!==e.getAttribute("controls"),"false"===e.getAttribute("loop")&&e.removeAttribute("loop"),"false"===e.getAttribute("preload")&&(e.preload="none"),e.crossOrigin=e.crossOrigin||"anonymous",e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline","")}(a)}a=a||function(e,t,o){var i=document.createElement("video");return i.width=t,i.height=o,i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.autoplay=!0,i.loop=!0,i.crossOrigin="anonymous",i.addEventListener("error",function(){h("`$s` is not a valid video",e)},!0),i.src=e,i}(e,t.width,t.height),i=this.hashVideo(t,a),c[i]?c[i].then(u):((r=new n.VideoTexture(a)).minFilter=n.LinearFilter,g(r,t),this.sceneEl.isIOS&&s(a.src||a.getAttribute("src"),a.type||a.getAttribute("type"))&&(r.format=n.RGBAFormat,r.needsCorrectionBGRA=!0,r.flipY=!1,r.needsCorrectionFlipY=!0),l={texture:r,videoEl:a},c[i]=Promise.resolve(l),u(l))},hash:function(e){return e.src.tagName&&((e=r.extendDeep({},e)).src=e.src.getAttribute("src")),JSON.stringify(e)},hashVideo:function(e,t){return function(e,t){var o,i,n,r=t.getAttribute("id");if(r)return r;for(i="",n=e||{},o=0;o<t.attributes.length;o++)n[t.attributes[o].name]=t.attributes[o].value;return Object.keys(n).sort().forEach(function(e){i+=e+":"+n[e]+";"}),i}(e,t)},registerMaterial:function(e){this.materials[e.uuid]=e},unregisterMaterial:function(e){delete this.materials[e.uuid];var t=this.textureCounts;Object.keys(e).filter(function(t){return e[t]&&e[t].isTexture}).forEach(function(o){t[e[o].uuid]--,t[e[o].uuid]<=0&&e[o].dispose()})},updateMaterials:function(e){var t=this.materials;Object.keys(t).forEach(function(e){t[e].needsUpdate=!0})},onMaterialTextureLoaded:function(e){this.textureCounts[e.detail.texture.uuid]||(this.textureCounts[e.detail.texture.uuid]=0),this.textureCounts[e.detail.texture.uuid]++}})},{"../core/system":135,"../lib/three":173,"../utils/":195,"../utils/material":196}],187:[function(e,t,o){var i=e("../core/system").registerSystem,n=e("../utils/bind"),r=e("../lib/three"),s={basic:r.BasicShadowMap,pcf:r.PCFShadowMap,pcfsoft:r.PCFSoftShadowMap};t.exports.System=i("shadow",{schema:{type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]},renderReverseSided:{default:!0},renderSingleSided:{default:!0}},init:function(){var e=this.sceneEl,t=this.data;this.shadowMapEnabled=!1,e.addEventListener("render-target-loaded",n(function(){e.renderer&&(e.renderer.shadowMap.type=s[t.type],e.renderer.shadowMap.renderReverseSided=t.renderReverseSided,e.renderer.shadowMap.renderSingleSided=t.renderSingleSided,this.setShadowMapEnabled(this.shadowMapEnabled))},this))},setShadowMapEnabled:function(e){var t=this.sceneEl.renderer;this.shadowMapEnabled=e,t&&(t.shadowMap.enabled=e)}})},{"../core/system":135,"../lib/three":173,"../utils/bind":189}],188:[function(e,t,o){var i=e("../core/system").registerSystem;t.exports.System=i("tracked-controls",{init:function(){var e=this;this.controllers=[],this.updateControllerList(),navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(t){t.length&&(e.vrDisplay=t[0])})})},tick:function(){this.updateControllerList()},updateControllerList:function(){var e,t,o,i,n=this.controllers;if(t=navigator.getGamepads&&navigator.getGamepads()){for(i=n.length,n.length=0,o=0;o<t.length;++o)(e=t[o])&&e.pose&&n.push(e);n.length!==i&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":135}],189:[function(e,t,o){t.exports=function(e,t){return o=Array.prototype.slice.call(arguments,2),function(){var i=o.concat(Array.prototype.slice.call(arguments,0));return e.apply(t,i)};var o}},{}],190:[function(e,t,o){var i=e("./debug"),n=e("object-assign"),r=i("utils:coordinates:warn"),s=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;function a(e){return s.test(e)}function l(e){var t;for(t in e)void 0!==e[t]?e[t].constructor===String&&(e[t]=parseFloat(e[t],10)):delete e[t];return e}t.exports.regex=s,t.exports.parse=function(e,t){var o,i;return e&&e instanceof Object?(t&&(e.x=void 0===e.x?t.x:e.x,e.y=void 0===e.y?t.y:e.y,e.z=void 0===e.z?t.z:e.z,e.w=void 0===e.w?t.w:e.w),l(e)):null===e||void 0===e?"object"==typeof t?n({},t):t:(o=e.trim().replace(/\s+/g," ").split(" "),(i={}).x=o[0]||t&&t.x,i.y=o[1]||t&&t.y,i.z=o[2]||t&&t.z,i.w=o[3]||t&&t.w,l(i))},t.exports.stringify=function(e){return"object"!=typeof e?e:[e.x,e.y,e.z,e.w].join(" ").trim()},t.exports.isCoordinates=a,t.exports.isCoordinate=function(e){return r("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),a(e)},t.exports.toVector3=function(e){return new THREE.Vector3(e.x,e.y,e.z)}},{"./debug":191,"object-assign":26}],191:[function(e,t,o){(function(o){var i=e("debug"),n=e("object-assign"),r={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},s=function(e){var t=i(e);return t.color=function(e){var t=function(e){var t=e.split(":");return t[t.length-1]}(e);return r.colors&&r.colors[t]||null}(e),t};n(s,i);var a=function(){try{return window.localStorage}catch(e){}}();a&&(parseInt(a.logs,10)||"true"===a.logs)?s.enable("*"):s.enable("*:error,*:info,*:warn"),o.browser&&(window.logs=s),t.exports=s}).call(this,e("_process"))},{_process:6,debug:10,"object-assign":26}],192:[function(e,t,o){(function(o){var i=e("../lib/three"),n=new i.Object3D,r=new i.VRControls(n);t.exports.checkHeadsetConnected=function(){var e,t=r.getVRDisplay();return t&&"isConnected"in t?t.isConnected:(r.update(),0!==(e=n.quaternion)._x||0!==e._y||0!==e._z)},t.exports.checkHasPositionalTracking=function(){var e=r.getVRDisplay();return!l()&&!h()&&e&&e.capabilities.hasPosition};var s,a,l=(a=!1,s=window.navigator.userAgent||window.navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4)))&&(a=!0),(u()||c())&&(a=!0),function(){return a});function c(e){var t=e||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t)}function u(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function h(){return/SamsungBrowser.+Mobile VR/i.test(window.navigator.userAgent)}t.exports.isMobile=l,t.exports.isTablet=c,t.exports.isIOS=u,t.exports.isGearVR=h,t.exports.isLandscape=function(){return 90===window.orientation||-90===window.orientation},t.exports.isIOSOlderThan10=function(e){return/(iphone|ipod|ipad).*os.(7|8|9)/i.test(e)},t.exports.isBrowserEnvironment=!(o&&!o.browser),t.exports.isNodeEnvironment=!t.exports.isBrowserEnvironment}).call(this,e("_process"))},{"../lib/three":173,_process:6}],193:[function(e,t,o){t.exports.getComponentPropertyPath=function(e,t){return t=t||".",-1===e.indexOf(t)?e:e.split(t)},t.exports.getComponentProperty=function(e,t,o){var i;return o=o||".",-1!==t.indexOf(o)?(i=t.split(o),e.getAttribute(i[0])[i[1]]):e.getAttribute(t)},t.exports.setComponentProperty=function(e,t,o,i){var n,r={};if(i=i||".",-1!==t.indexOf(i))return n=t.split(i),r[n[1]]=o,void e.setAttribute(n[0],r);e.setAttribute(t,o)}},{}],194:[function(e,t,o){t.exports=function(e){var t=e.style.width,o=e.style.height;e.style.width=parseInt(t,10)+1+"px",e.style.height=parseInt(o,10)+1+"px",setTimeout(function(){e.style.width=t,e.style.height=o},200)}},{}],195:[function(e,t,o){var i=e("./debug"),n=e("deep-assign"),r=e("./device"),s=e("object-assign"),a=i("utils:warn");function l(e,t){var o,i,n,r,s;if(void 0===e||void 0===t||null===e||null===t||!(e&&t&&e.constructor===Object&&t.constructor===Object||e.constructor===Array&&t.constructor===Array))return e===t;if(i=Object.keys(e),n=Object.keys(t),i.length!==n.length)return!1;for(o=0;o<i.length;++o)if(r=e[i[o]],s=t[i[o]],"object"==typeof r||"object"==typeof s||Array.isArray(r)&&Array.isArray(s)){if(r===s)continue;if(!l(r,s))return!1}else if(r!==s)return!1;return!0}t.exports.bind=e("./bind"),t.exports.coordinates=e("./coordinates"),t.exports.debug=i,t.exports.device=r,t.exports.entity=e("./entity"),t.exports.forceCanvasResizeSafariMobile=e("./forceCanvasResizeSafariMobile"),t.exports.material=e("./material"),t.exports.styleParser=e("./styleParser"),t.exports.trackedControls=e("./tracked-controls"),t.exports.checkHeadsetConnected=function(){return a("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),r.checkHeadsetConnected(arguments)},t.exports.isGearVR=function(){return a("`utils.isGearVR` has moved to `utils.device.isGearVR`"),r.isGearVR(arguments)},t.exports.isIOS=function(){return a("`utils.isIOS` has moved to `utils.device.isIOS`"),r.isIOS(arguments)},t.exports.isMobile=function(){return a("`utils.isMobile has moved to `utils.device.isMobile`"),r.isMobile(arguments)},t.exports.throttle=function(e,o,i){var n;return i&&(e=t.exports.bind(e,i)),function(){var t=Date.now(),i=void 0===n?o:t-n;(void 0===n||i>=o)&&(n=t,e.apply(null,arguments))}},t.exports.throttleTick=function(e,o,i){var n;return i&&(e=t.exports.bind(e,i)),function(t,i){var r=void 0===n?i:t-n;(void 0===n||r>=o)&&(n=t,e(t,r))}},t.exports.debounce=function(e,t,o){var i;return function(){var n=this,r=arguments,s=o&&!i;clearTimeout(i),i=setTimeout(function(){i=null,o||e.apply(n,r)},t),s&&e.apply(n,r)}},t.exports.fireEvent=function(e,t,o){(o=o||{}).detail=o.detail||{},o.detail.target=o.detail.target||e;var i=new CustomEvent(t,o);e.dispatchEvent(i)},t.exports.extend=s,t.exports.extendDeep=n,t.exports.clone=function(e){return JSON.parse(JSON.stringify(e))},t.exports.deepEqual=l,t.exports.diff=function(e,t){var o={},i=Object.keys(e);return t?(Object.keys(t).forEach(function(e){-1===i.indexOf(e)&&i.push(e)}),i.forEach(function(i){var n=e[i],r=t[i],s=n&&r&&n.constructor===Object&&r.constructor===Object;(s&&!l(n,r)||!s&&n!==r)&&(o[i]=r)}),o):o},t.exports.shouldCaptureKeyEvent=function(e){return!e.metaKey&&document.activeElement===document.body},t.exports.splitString=function(e,t){void 0===t&&(t=" ");var o=new RegExp(t,"g");return(e=(e||"").replace(o,t)).split(t)},t.exports.getElData=function(e,t){t=t||{};var o={};return Object.keys(t).forEach(function(t){e.hasAttribute(t)&&(o[t]=e.getAttribute(t))}),o},t.exports.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),o=t.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},t.exports.isIframed=function(){return window.top!==window.self},t.exports.findAllScenes=function(e){for(var t=[],o=e.getElementsByTagName("*"),i=0,n=o.length;i<n;i++)o[i].isScene&&t.push(o[i]);return t},t.exports.srcLoader=e("./src-loader")},{"./bind":189,"./coordinates":190,"./debug":191,"./device":192,"./entity":193,"./forceCanvasResizeSafariMobile":194,"./material":196,"./src-loader":197,"./styleParser":198,"./tracked-controls":199,"deep-assign":12,"object-assign":26}],196:[function(e,t,o){var i=e("../lib/three"),n=["application/x-mpegurl","application/vnd.apple.mpegurl"];function r(e,t){t&&(e.emit("materialtextureloaded",{src:t.image,texture:t}),t.image&&"VIDEO"===t.image.tagName&&(t.image.addEventListener("loadeddata",function(){e.components&&e.components.material&&(t.needsCorrectionBGRA&&t.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(e.components.material.data.shader)&&e.setAttribute("material","shader","ios10hls"),e.emit("materialvideoloadeddata",{src:t.image,texture:t}))}),t.image.addEventListener("ended",function(){e.emit("materialvideoended",{src:t.image,texture:t})})))}t.exports.updateMapMaterialFromData=function(e,t,o,n){var s=o.el,a=o.material,l=n[t];if(o.materialSrcs||(o.materialSrcs={}),!l)return delete o.materialSrcs[e],void c(null);function c(t){a[e]=t,a.needsUpdate=!0,r(s,t)}l!==o.materialSrcs[e]&&(o.materialSrcs[e]=l,l instanceof i.Texture?c(l):s.sceneEl.systems.material.loadTexture(l,{src:l,repeat:n.repeat,offset:n.offset,npot:n.npot},function(t){o.materialSrcs[e]===l&&c(t)}))},t.exports.updateMap=function(e,o){return t.exports.updateMapMaterialFromData("map","src",e,o)},t.exports.updateDistortionMap=function(e,t,o){var i=e;"ambientOcclusion"===e&&(i="ao");var n=t.el,s=t.material,a=o[e+"Map"],l={};if(l.src=a,l.offset=o[e+"TextureOffset"],l.repeat=o[e+"TextureRepeat"],l.wrap=o[e+"TextureWrap"],a){if(a===t[e+"TextureSrc"])return;return t[e+"TextureSrc"]=a,void n.sceneEl.systems.material.loadTexture(a,l,c)}function c(e){s[i+"Map"]=e,s.needsUpdate=!0,r(n,e)}s.map&&c(null)},t.exports.handleTextureEvents=r,t.exports.isHLS=function(e,t){return!(!t||!n.includes(t.toLowerCase()))||!!(e&&e.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":173}],197:[function(e,t,o){var i=e("./debug"),n=i("utils:src-loader:warn");function r(e,t,o){!function(e,t){if(e.tagName)t("IMG"===e.tagName);else{var o=new Image;o.addEventListener("load",function(){t(!0)}),o.addEventListener("error",function(){t(!1)}),o.src=e}}(e,function(i){i?t(e):o(e)})}function s(e){var t=e.match(/\url\((.+)\)/);if(t)return t[1]}t.exports={parseUrl:s,validateSrc:r,validateCubemapSrc:function(e,t){var o,i,a,l="",c=[];for(i=0;i<5;i++)l+="(url\\((?:[^\\)]+)\\),\\s*)";function u(e){c.push(e),6===c.length&&t(c)}if(l+="(url\\((?:[^\\)]+)\\)\\s*)",a=e.match(new RegExp(l)))for(i=1;i<7;i++)r(s(a[i]),u);else if(o=function(e){try{var t=document.querySelector(e);return t||n('No element was found matching the selector: "%s"',e),t}catch(t){return void n('"%s" is not a valid selector',e)}}(e))return"A-CUBEMAP"===o.tagName&&o.srcs?t(o.srcs):void n('Selector "%s" does not point to <a-cubemap>',e)}}},{"./debug":191}],198:[function(e,t,o){var i=e("style-attr");function n(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}function r(e){var t=Object.keys(e),o={};return t.forEach(function(t){var i=n(t);o[i]=e[t]}),o}t.exports.parse=function(e){var t;return"string"!=typeof e?e:(t=i.parse(e))[""]?e:r(t)},t.exports.stringify=function(e){return"string"==typeof e?e:i.stringify(e)},t.exports.toCamelCase=n,t.exports.transformKeysToCamelCase=r},{"style-attr":36}],199:[function(e,t,o){var i=e("../constants").DEFAULT_HANDEDNESS,n=["x","y","z","w"],r=2;function s(e,t,o){var i,n,r=e.el.sceneEl,s=o.index||0;return!!(t&&(n=r&&r.systems["tracked-controls"])&&(i=n.controllers).length&&a(i,null,t,o.hand,s))}function a(e,t,o,n,s){var a,l,c=0,u=s||0;for(l=0;l<e.length;l++)if(a=e[l],(!o||-1!==a.id.indexOf(o))&&(o||a.id===t)&&(!n||!a.hand||n===a.hand)){if(n&&!a.hand&&(u=r*s+(n===i?0:1)),c===u)return a;++c}}t.exports.checkControllerPresentAndSetup=function(e,t,o){var i=e.el,n=s(e,t,o);if(e.controllerPresent&&!e.controllerEventsActive&&e.addEventListeners(),n===e.controllerPresent)return n;e.controllerPresent=n,n?(e.injectTrackedControls(),e.addEventListeners(),i.emit("controllerconnected",{name:e.name,component:e})):(e.removeEventListeners(),i.emit("controllerdisconnected",{name:e.name,component:e}))},t.exports.isControllerPresent=s,t.exports.findMatchingController=a,t.exports.emitIfAxesChanged=function(e,t,o){var i,r,s,a,l,c;for(r=Object.keys(t),l=0;l<r.length;l++){for(i=t[r[l]],s=!1,c=0;c<i.length;c++)o.detail.changed[i[c]]&&(s=!0);if(s){for(a={},c=0;c<i.length;c++)a[n[c]]=o.detail.axis[i[c]];e.el.emit(r[l]+"moved",a)}}}},{"../constants":116}],200:[function(e,t,o){THREE.VRControls=function(e,t){var o,i,n=this,r=new THREE.Matrix4,s=null;"VRFrameData"in window&&(s=new window.VRFrameData),window.addEventListener("vrdisplayconnect",function(e){o=e.display}),window.addEventListener("vrdisplaydisconnect",function(){o=void 0}),navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){i=e,e.length>0?o=e[0]:t&&t("VR input not available.")}).catch(function(){console.warn("THREE.VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return o},this.setVRDisplay=function(e){o=e},this.getVRDisplays=function(){return console.warn("THREE.VRControls: getVRDisplays() is being deprecated."),i},this.getStandingMatrix=function(){return r},this.update=function(){var t;o&&(o.getFrameData?(o.getFrameData(s),t=s.pose):o.getPose&&(t=o.getPose()),null!==t.orientation&&e.quaternion.fromArray(t.orientation),null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),this.standing&&(o.stageParameters?(e.updateMatrix(),r.fromArray(o.stageParameters.sittingToStandingTransform),e.applyMatrix(r)):e.position.setY(e.position.y+this.userHeight)),e.position.multiplyScalar(n.scale))},this.resetPose=function(){o&&o.resetPose()},this.resetSensor=function(){console.warn("THREE.VRControls: .resetSensor() is now .resetPose()."),this.resetPose()},this.zeroSensor=function(){console.warn("THREE.VRControls: .zeroSensor() is now .resetPose()."),this.resetPose()},this.dispose=function(){o=null}}},{}],201:[function(e,t,o){THREE.VREffect=function(e,t){var o,i,n,r,s=new THREE.Vector3,a=new THREE.Vector3,l=null;"VRFrameData"in window&&(l=new window.VRFrameData),window.addEventListener("vrdisplayconnect",function(e){o=e.display}),window.addEventListener("vrdisplaydisconnect",function(e){var t;c.exitPresent(),t=c.cancelAnimationFrame(),o=void 0,c.requestAnimationFrame(t)}),navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){i=e,e.length>0?o=e[0]:t&&t("HMD not available")}).catch(function(){console.warn("THREE.VREffect: Unable to get VR Displays")}),this.isPresenting=!1;var c=this,u=e.getSize(),h=!1,g=e.getPixelRatio();this.getVRDisplay=function(){return o},this.setVRDisplay=function(e){o=e},this.getVRDisplays=function(){return console.warn("THREE.VREffect: getVRDisplays() is being deprecated."),i},this.setSize=function(t,i,n){if(u={width:t,height:i},h=n,c.isPresenting){var r=o.getEyeParameters("left");e.setPixelRatio(1),e.setSize(2*r.renderWidth,r.renderHeight,!1)}else e.setPixelRatio(g),e.setSize(t,i,n)};var d=e.domElement,p=[0,0,.5,1],f=[.5,0,.5,1];function m(){var t=c.isPresenting;if(c.isPresenting=void 0!==o&&o.isPresenting,c.isPresenting){var i=o.getEyeParameters("left"),n=i.renderWidth,r=i.renderHeight;t||(g=e.getPixelRatio(),u=e.getSize(),e.setPixelRatio(1),e.setSize(2*n,r,!1))}else t&&(e.setPixelRatio(g),e.setSize(u.width,u.height,h))}window.addEventListener("vrdisplaypresentchange",m,!1),this.setFullScreen=function(e){return new Promise(function(t,i){void 0!==o?c.isPresenting!==e?t(e?o.requestPresent([{source:d}]):o.exitPresent()):t():i(new Error("No VR hardware found."))})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(e){var e=c.f=e||c.f;if(e)return void 0!==o?o.requestAnimationFrame(e):window.requestAnimationFrame(e)},this.cancelAnimationFrame=function(e){var t=c.f;return c.f=void 0,void 0!==o?o.cancelAnimationFrame(e):window.cancelAnimationFrame(e),t},this.submitFrame=function(){void 0!==o&&c.isPresenting&&o.submitFrame()},this.autoSubmitFrame=!0;var y=new THREE.PerspectiveCamera;y.layers.enable(1);var v=new THREE.PerspectiveCamera;function E(e,t,o,i){var n=Math.PI/180,r={upTan:Math.tan(e.upDegrees*n),downTan:Math.tan(e.downDegrees*n),leftTan:Math.tan(e.leftDegrees*n),rightTan:Math.tan(e.rightDegrees*n)};return function(e,t,o,i){t=void 0===t||t,o=void 0===o?.01:o,i=void 0===i?1e4:i;var n=t?-1:1,r=new THREE.Matrix4,s=r.elements,a=function(e){var t=2/(e.leftTan+e.rightTan),o=(e.leftTan-e.rightTan)*t*.5,i=2/(e.upTan+e.downTan),n=(e.upTan-e.downTan)*i*.5;return{scale:[t,i],offset:[o,n]}}(e);return s[0]=a.scale[0],s[1]=0,s[2]=a.offset[0]*n,s[3]=0,s[4]=0,s[5]=a.scale[1],s[6]=-a.offset[1]*n,s[7]=0,s[8]=0,s[9]=0,s[10]=i/(o-i)*-n,s[11]=i*o/(o-i),s[12]=0,s[13]=0,s[14]=n,s[15]=0,r.transpose(),r}(r,t,o,i)}v.layers.enable(2),this.render=function(t,i,u,h){if(o&&c.isPresenting){var g=t.autoUpdate;g&&(t.updateMatrixWorld(),t.autoUpdate=!1);var d=o.getEyeParameters("left"),m=o.getEyeParameters("right");s.fromArray(d.offset),a.fromArray(m.offset),Array.isArray(t)&&(console.warn("THREE.VREffect.render() no longer supports arrays. Use object.layers instead."),t=t[0]);var _,T,b=e.getSize(),M=o.getLayers();if(M.length){var A=M[0];_=null!==A.leftBounds&&4===A.leftBounds.length?A.leftBounds:p,T=null!==A.rightBounds&&4===A.rightBounds.length?A.rightBounds:f}else _=p,T=f;return n={x:Math.round(b.width*_[0]),y:Math.round(b.height*_[1]),width:Math.round(b.width*_[2]),height:Math.round(b.height*_[3])},r={x:Math.round(b.width*T[0]),y:Math.round(b.height*T[1]),width:Math.round(b.width*T[2]),height:Math.round(b.height*T[3])},u?(e.setRenderTarget(u),u.scissorTest=!0):(e.setRenderTarget(null),e.setScissorTest(!0)),(e.autoClear||h)&&e.clear(),null===i.parent&&i.updateMatrixWorld(),i.matrixWorld.decompose(y.position,y.quaternion,y.scale),v.position.copy(y.position),v.quaternion.copy(y.quaternion),v.scale.copy(y.scale),y.translateOnAxis(s,y.scale.x),v.translateOnAxis(a,v.scale.x),o.getFrameData?(o.depthNear=i.near,o.depthFar=i.far,o.getFrameData(l),y.projectionMatrix.elements=l.leftProjectionMatrix,v.projectionMatrix.elements=l.rightProjectionMatrix):(y.projectionMatrix=E(d.fieldOfView,!0,i.near,i.far),v.projectionMatrix=E(m.fieldOfView,!0,i.near,i.far)),u?(u.viewport.set(n.x,n.y,n.width,n.height),u.scissor.set(n.x,n.y,n.width,n.height)):(e.setViewport(n.x,n.y,n.width,n.height),e.setScissor(n.x,n.y,n.width,n.height)),e.render(t,y,u,h),u?(u.viewport.set(r.x,r.y,r.width,r.height),u.scissor.set(r.x,r.y,r.width,r.height)):(e.setViewport(r.x,r.y,r.width,r.height),e.setScissor(r.x,r.y,r.width,r.height)),e.render(t,v,u,h),u?(u.viewport.set(0,0,b.width,b.height),u.scissor.set(0,0,b.width,b.height),u.scissorTest=!1,e.setRenderTarget(null)):(e.setViewport(0,0,b.width,b.height),e.setScissorTest(!1)),g&&(t.autoUpdate=!0),void(c.autoSubmitFrame&&c.submitFrame())}e.render(t,i,u,h)},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",m,!1)}}},{}],202:[function(e,t,o){window.glStats=function(){var e=null,t=0,o=0,i=0,n=0,r=0,s=0,a=0;function l(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}}return WebGLRenderingContext.prototype.drawArrays=l(WebGLRenderingContext.prototype.drawArrays,function(){t++,arguments[0]==this.POINTS?s+=arguments[2]:r+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=l(WebGLRenderingContext.prototype.drawElements,function(){o++,n+=arguments[1]/3,r+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=l(WebGLRenderingContext.prototype.useProgram,function(){i++}),WebGLRenderingContext.prototype.bindTexture=l(WebGLRenderingContext.prototype.bindTexture,function(){a++}),{update:function(){e("allcalls").set(t+o),e("drawElements").set(o),e("drawArrays").set(t),e("bindTexture").set(a),e("useProgram").set(i),e("glfaces").set(n),e("glvertices").set(r),e("glpoints").set(s)},start:function(){t=0,o=0,i=0,n=0,r=0,s=0,a=0},end:function(){},attach:function(t){e=t},values:{allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}},window.threeStats=function(e){var t=null;return{update:function(){t("renderer.info.memory.geometries").set(e.info.memory.geometries),t("renderer.info.programs").set(e.info.programs.length),t("renderer.info.memory.textures").set(e.info.memory.textures),t("renderer.info.render.calls").set(e.info.render.calls),t("renderer.info.render.faces").set(e.info.render.faces),t("renderer.info.render.points").set(e.info.render.points),t("renderer.info.render.vertices").set(e.info.render.vertices)},start:function(){},end:function(){},attach:function(e){t=e},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.faces":{caption:"Faces",over:1e3},"renderer.info.render.points":{caption:"Points"},"renderer.info.render.vertices":{caption:"Vertices"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.faces","renderer.info.render.points","renderer.info.render.vertices"]}],fractions:[]}},window.BrowserStats=function(){var e=null,t=0,o=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var i=Math.log(1024);function n(e){var t=Math.floor(Math.log(e)/i);return Math.round(100*e/Math.pow(1024,t))/100}return{update:function(){t=n(performance.memory.usedJSHeapSize),o=n(performance.memory.totalJSHeapSize),e("memory").set(t),e("total").set(o)},start:function(){t=0},end:function(){},attach:function(t){e=t},values:{memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}},"object"==typeof t&&(t.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],203:[function(e,t,o){"use strict";!function(){"performance"in window==0&&(window.performance={});var e=window.performance;if("now"in e==0){var t=Date.now();e.timing&&e.timing.navigationStart&&(t=e.timing.navigationStart),e.now=function(){return Date.now()-t}}e.mark||(e.mark=function(){}),e.measure||(e.measure=function(){})}(),window.rStats=function(e){function t(e,t){for(var o=Object.keys(e),i=0,n=o.length;i<n;i++)t(o[i])}var o=e||{},i=o.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],n=(o.CSSPath?o.CSSPath:"")+"rStats.css",r=o.css||["https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",n];r.forEach(function(e){var t,o;t=e,(o=document.createElement("link")).href=t,o.rel="stylesheet",o.type="text/css",document.getElementsByTagName("head")[0].appendChild(o)}),o.values||(o.values={});var s,a,l=10,c=200,u={};function h(e,t){var i,n=e,r=0,s=0,u=0,h=0,g=performance.now(),d=0,p=document.createElement("div"),f=document.createElement("span"),m=document.createElement("div"),y=document.createTextNode(""),v=o?o.values[n.toLowerCase()]:null,E=new function(e,t,o){var i=o||{},n=document.createElement("canvas"),r=n.getContext("2d"),s=0,a=0,u=i.color?i.color:"#666666",h=document.createElement("canvas"),g=h.getContext("2d");h.width=1,h.height=2*l,g.fillStyle="#444444",g.fillRect(0,0,1,2*l),g.fillStyle=u,g.fillRect(0,l,1,l),g.fillStyle="#ffffff",g.globalAlpha=.5,g.fillRect(0,l,1,1),g.globalAlpha=1;var d=document.createElement("canvas"),p=d.getContext("2d");return d.width=1,d.height=2*l,p.fillStyle="#444444",p.fillRect(0,0,1,2*l),p.fillStyle="#b70000",p.fillRect(0,l,1,l),p.globalAlpha=.5,p.fillStyle="#ffffff",p.fillRect(0,l,1,1),p.globalAlpha=1,n.width=c,n.height=l,n.style.width=n.width+"px",n.style.height=n.height+"px",n.className="rs-canvas",e.appendChild(n),r.fillStyle="#444444",r.fillRect(0,0,n.width,n.height),{draw:function(e,t){(a+=.1*(e-a))>(s*=.99)&&(s=a),r.drawImage(n,1,0,n.width-1,n.height,0,0,n.width-1,n.height),t?r.drawImage(d,n.width-1,n.height-a*n.height/s-l):r.drawImage(h,n.width-1,n.height-a*n.height/s-l)}}}(p,n,v),_=!1;function T(e){if(v&&v.average){h+=e,d++;var t=performance.now();t-g>=(v.avgMs||1e3)&&(u=h/d,h=0,g=t,d=0)}}function b(){i=performance.now(),o.userTimingAPI&&performance.mark(n+"-start"),_=!0}function M(){r=performance.now()-i,o.userTimingAPI&&(performance.mark(n+"-end"),_&&performance.measure(n,n+"-start",n+"-end")),T(r)}return f.className="rs-counter-id",f.textContent=v&&v.caption?v.caption:n,m.className="rs-counter-value",m.appendChild(y),p.appendChild(f),p.appendChild(m),t?t.div.appendChild(p):a.appendChild(p),i=performance.now(),{set:function(e){T(r=e)},start:b,tick:function(){M(),b()},end:M,frame:function(){var e=performance.now(),t=e-i;s++,t>1e3&&(r=v&&!1===v.interpolate?s:1e3*s/t,s=0,i=e,T(r))},value:function(){return r},draw:function(){var e=v&&v.average?u:r;y.nodeValue=Math.round(100*e)/100;var t=v&&(v.below&&r<v.below||v.over&&r>v.over);E.draw(r,t),p.className=t?"rs-counter-base alarm":"rs-counter-base"}}}function g(e){var i=e.toLowerCase();if(void 0===i&&(i="default"),u[i])return u[i];var n=null;o&&o.groups&&t(o.groups,function(e){var t=o.groups[parseInt(e,10)];n||-1===t.values.indexOf(i.toLowerCase())||(n=t)});var r=new h(i,n);return u[i]=r,r}function d(){t(o.plugins,function(e){o.plugins[e].update()}),t(u,function(e){u[e].draw()}),o&&o.fractions&&t(o.fractions,function(e){var i=o.fractions[parseInt(e,10)],n=[],r=u[i.base.toLowerCase()];r&&(r=r.value(),t(o.fractions[e].steps,function(t){var i=o.fractions[e].steps[parseInt(t,10)].toLowerCase(),s=u[i];s&&n.push(s.value()/r)})),i.graph.draw(n)})}return function(){if(o.plugins){o.values||(o.values={}),o.groups||(o.groups=[]),o.fractions||(o.fractions=[]);for(var e=0;e<o.plugins.length;e++)o.plugins[e].attach(g),t(o.plugins[e].values,function(t){o.values[t]=o.plugins[e].values[t]}),o.groups=o.groups.concat(o.plugins[e].groups),o.fractions=o.fractions.concat(o.plugins[e].fractions)}else o.plugins={};(s=document.createElement("div")).className="rs-base",(a=document.createElement("div")).className="rs-container",a.style.height="auto",s.appendChild(a),document.body.appendChild(s),o&&(o.groups&&t(o.groups,function(e){var t=o.groups[parseInt(e,10)],i=document.createElement("div");i.className="rs-group",t.div=i;var n=document.createElement("h1");n.textContent=t.caption,n.addEventListener("click",function(e){this.classList.toggle("hidden"),e.preventDefault()}.bind(i)),a.appendChild(n),a.appendChild(i)}),o.fractions&&t(o.fractions,function(e){var n=o.fractions[parseInt(e,10)],r=document.createElement("div");r.className="rs-fraction";var s=document.createElement("div");s.className="rs-legend";var u=0;t(o.fractions[e].steps,function(t){var n=document.createElement("p");n.textContent=o.fractions[e].steps[t],n.style.color=i[u],s.appendChild(n),u++}),r.appendChild(s),r.style.height=u*l+"px",n.div=r;var h=new function(e,o){var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=c,n.height=l*o,n.style.width=n.width+"px",n.style.height=n.height+"px",n.className="rs-canvas",e.appendChild(n),r.fillStyle="#444444",r.fillRect(0,0,n.width,n.height),{draw:function(e){r.drawImage(n,1,0,n.width-1,n.height,0,0,n.width-1,n.height);var o=0;t(e,function(t){var s=e[t]*n.height;r.fillStyle=i[t],r.fillRect(n.width-1,o,1,s),o+=s})}}}(r,u);n.graph=h,a.appendChild(r)}))}(),function(e){return e?g(e):{element:s,update:d}}},"object"==typeof t&&(t.exports=window.rStats)},{}],204:[function(e,t,o){var i={base64:function(e,t){return"data:"+e+";base64,"+t},isMobile:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},appendQueryParameter:function(e,t,o){var i=e.indexOf("?")<0?"?":"&";return e+=i+t+"="+o},getQueryParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),o=t.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},isLandscapeMode:function(){return 90==window.orientation||-90==window.orientation}};t.exports=i},{}],205:[function(e,t,o){var i,n=e("./util.js");function r(){var e=document.createElement("video");e.addEventListener("ended",function(){e.play()}),this.request=function(){e.paused&&(e.src=n.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),e.play())},this.release=function(){e.pause(),e.src=""}}function s(){var e=null;this.request=function(){e||(e=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){e&&(clearInterval(e),e=null)}}t.exports=(i=navigator.userAgent||navigator.vendor||window.opera).match(/iPhone/i)||i.match(/iPod/i)?s:r},{"./util.js":204}]},{},[171])(171)}).call(this,i(27),i(155).setImmediate)},function(e,t,o){o(156);var i=function(e){var t=$("#left-view-top"),o=$("#left-view-top canvas");o.width(t.innerWidth()),o.height(t.innerHeight()),document.querySelector("a-scene").resize()};window.addEventListener("resize",i,!1),window.splitEvents.onDrag.push(i),$(document).ready(i)},function(e,t,o){e.exports=function(){"use strict";var e=window,t=e.document,o="addEventListener",i="removeEventListener",n="getBoundingClientRect",r=function(){return!1},s=e.attachEvent&&!e[o],a=["","-webkit-","-moz-","-o-"].filter(function(e){var o=t.createElement("div");return o.style.cssText="width:"+e+"calc(9px)",!!o.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(c,u){var h,g,d,p;void 0===u&&(u={});var f=l(c[0]).parentNode,m=e.getComputedStyle(f).flexDirection,y=u.sizes||c.map(function(){return 100/c.length}),v=void 0!==u.minSize?u.minSize:100,E=Array.isArray(v)?v:c.map(function(){return v}),_=void 0!==u.gutterSize?u.gutterSize:10,T=void 0!==u.snapOffset?u.snapOffset:30,b=u.direction||"horizontal",M=u.cursor||("horizontal"===b?"ew-resize":"ns-resize"),A=u.gutter||function(e,o){var i=t.createElement("div");return i.className="gutter gutter-"+o,i},S=u.elementStyle||function(e,t,o){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=s?t+"%":a+"("+t+"% - "+o+"px)",i},w=u.gutterStyle||function(e,t){return(o={})[e]=t+"px",o;var o};function C(e,t,o){var i=S(h,t,o);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function N(e){var t=p[this.a],o=p[this.b],i=t.size+o.size;t.size=e/this.size*i,o.size=i-e/this.size*i,C(t.element,t.size,this.aGutterSize),C(o.element,o.size,this.bGutterSize)}function L(){var e=p[this.a].element,t=p[this.b].element;this.size=e[n]()[h]+t[n]()[h]+this.aGutterSize+this.bGutterSize,this.start=e[n]()[d]}function I(t){var n=p[this.a].element,s=p[this.b].element;!this.dragging&&u.onDragStart&&u.onDragStart(),t.preventDefault(),this.dragging=!0,this.move=function(e){var t;this.dragging&&((t="touches"in e?e.touches[0][g]-this.start:e[g]-this.start)<=p[this.a].minSize+T+this.aGutterSize?t=p[this.a].minSize+this.aGutterSize:t>=this.size-(p[this.b].minSize+T+this.bGutterSize)&&(t=this.size-(p[this.b].minSize+this.bGutterSize)),N.call(this,t),u.onDrag&&u.onDrag())}.bind(this),this.stop=function(){var t=p[this.a].element,o=p[this.b].element;this.dragging&&u.onDragEnd&&u.onDragEnd(),this.dragging=!1,e[i]("mouseup",this.stop),e[i]("touchend",this.stop),e[i]("touchcancel",this.stop),this.parent[i]("mousemove",this.move),this.parent[i]("touchmove",this.move),delete this.stop,delete this.move,t[i]("selectstart",r),t[i]("dragstart",r),o[i]("selectstart",r),o[i]("dragstart",r),t.style.userSelect="",t.style.webkitUserSelect="",t.style.MozUserSelect="",t.style.pointerEvents="",o.style.userSelect="",o.style.webkitUserSelect="",o.style.MozUserSelect="",o.style.pointerEvents="",this.gutter.style.cursor="",this.parent.style.cursor=""}.bind(this),e[o]("mouseup",this.stop),e[o]("touchend",this.stop),e[o]("touchcancel",this.stop),this.parent[o]("mousemove",this.move),this.parent[o]("touchmove",this.move),n[o]("selectstart",r),n[o]("dragstart",r),s[o]("selectstart",r),s[o]("dragstart",r),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",this.gutter.style.cursor=M,this.parent.style.cursor=M,L.call(this)}"horizontal"===b?(h="width",g="clientX",d="left"):"vertical"===b&&(h="height",g="clientY",d="top");var R=[];function D(e){e.forEach(function(t,o){if(o>0){var i=R[o-1],n=p[i.a],r=p[i.b];n.size=e[o-1],r.size=t,C(n.element,n.size,i.aGutterSize),C(r.element,r.size,i.bGutterSize)}})}function x(){R.forEach(function(e){e.parent.removeChild(e.gutter),p[e.a].element.style[h]="",p[e.b].element.style[h]=""})}return p=c.map(function(e,t){var i,r={element:l(e),size:y[t],minSize:E[t]};if(t>0&&((i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===c.length-1,direction:b,parent:f}).aGutterSize=_,i.bGutterSize=_,i.isFirst&&(i.aGutterSize=_/2),i.isLast&&(i.bGutterSize=_/2),"row-reverse"===m||"column-reverse"===m)){var a=i.a;i.a=i.b,i.b=a}if(!s&&t>0){var u=A(t,b);!function(e,t){var o=w(h,t);Object.keys(o).forEach(function(t){return e.style[t]=o[t]})}(u,_),u[o]("mousedown",I.bind(i)),u[o]("touchstart",I.bind(i)),f.insertBefore(u,r.element),i.gutter=u}0===t||t===c.length-1?C(r.element,r.size,_/2):C(r.element,r.size,_);var g=r.element[n]()[h];return g<r.minSize&&(r.minSize=g),t>0&&R.push(i),r}),s?{setSizes:D,destroy:x}:{setSizes:D,getSizes:function(){return p.map(function(e){return e.size})},collapse:function(e){if(e===R.length){var t=R[e-1];L.call(t),s||N.call(t,t.size-t.bGutterSize)}else{var o=R[e];L.call(o),s||N.call(o,o.aGutterSize)}},destroy:x}}}()},function(e,t,o){const i=o(158);window.splitEvents={onDrag:[],onDragStart:[],onDragEnd:[]},window.splits=[];const n=function(e){return function(){for(var t in window.splitEvents[e])window.splitEvents[e][t]()}};$(document).ready(function(){window.splits.push(i(["#left-view","#right-view"],{direction:"horizontal",sizes:[33,67],onDrag:n("onDrag"),onDragStart:n("onDragStart"),onDragEnd:n("onDragEnd")})),window.splits.push(i(["#left-view-top","#left-view-bottom"],{direction:"vertical",sizes:[33,67],onDrag:n("onDrag"),onDragStart:n("onDragStart"),onDragEnd:n("onDragEnd")}))})},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var o=t.protocol+"//"+t.host,i=o+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(r)?e:(n=0===r.indexOf("//")?r:0===r.indexOf("/")?o+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t,o){var i,n,r={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=i.apply(this,arguments)),n}),a=function(e){var t={};return function(e){if(void 0===t[e]){var o=function(e){return document.querySelector(e)}.call(this,e);if(o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}}(),l=null,c=0,u=[],h=o(160);function g(e,t){for(var o=0;o<e.length;o++){var i=e[o],n=r[i.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](i.parts[s]);for(;s<i.parts.length;s++)n.parts.push(v(i.parts[s],t))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(v(i.parts[s],t));r[i.id]={id:i.id,refs:1,parts:a}}}}function d(e,t){for(var o=[],i={},n=0;n<e.length;n++){var r=e[n],s=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};i[s]?i[s].parts.push(a):o.push(i[s]={id:s,parts:[a]})}return o}function p(e,t){var o=a(e.insertInto);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===e.insertAt)i?i.nextSibling?o.insertBefore(t,i.nextSibling):o.appendChild(t):o.insertBefore(t,o.firstChild),u.push(t);else if("bottom"===e.insertAt)o.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(e.insertInto+" "+e.insertAt.before);o.insertBefore(t,n)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function m(e){var t=document.createElement("style");return e.attrs.type="text/css",y(t,e.attrs),p(e,t),t}function y(e,t){Object.keys(t).forEach(function(o){e.setAttribute(o,t[o])})}function v(e,t){var o,i,n,r;if(t.transform&&e.css){if(!(r=t.transform(e.css)))return function(){};e.css=r}if(t.singleton){var s=c++;o=l||(l=m(t)),i=T.bind(null,o,s,!1),n=T.bind(null,o,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",y(t,e.attrs),p(e,t),t}(t),i=function(e,t,o){var i=o.css,n=o.sourceMap,r=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||r)&&(i=h(i));n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([i],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,o,t),n=function(){f(o),o.href&&URL.revokeObjectURL(o.href)}):(o=m(t),i=function(e,t){var o=t.css,i=t.media;i&&e.setAttribute("media",i);if(e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}.bind(null,o),n=function(){f(o)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var o=d(e,t);return g(o,t),function(e){for(var i=[],n=0;n<o.length;n++){var s=o[n];(a=r[s.id]).refs--,i.push(a)}e&&g(d(e,t),t);for(n=0;n<i.length;n++){var a;if(0===(a=i[n]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete r[a.id]}}}};var E,_=(E=[],function(e,t){return E[e]=t,E.filter(Boolean).join("\n")});function T(e,t,o,i){var n=o?"":i.css;if(e.styleSheet)e.styleSheet.cssText=_(t,n);else{var r=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o=function(e,t){var o=e[1]||"",i=e[3];if(!i)return o;if(t&&"function"==typeof btoa){var n=(s=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),r=i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"});return[o].concat(r).concat([n]).join("\n")}var s;return[o].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+o+"}":o}).join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var r=this[n][0];"number"==typeof r&&(i[r]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&i[s[0]]||(o&&!s[2]?s[2]=o:o&&(s[2]="("+s[2]+") and ("+o+")"),t.push(s))}},t}},function(e,t,o){(e.exports=o(162)(!1)).push([e.i,'body {\n    width: 100vw;\n    height: 100vh;\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* General */\n}\n\n#right-view,\n#left-view,\nbody > .gutter {\n    display: inline-block;\n    height: 100%;\n    width: 100%;\n    float: left;\n}\n\n.gutter {\n    background: grey;\n}\n\n.gutter.gutter-horizontal {\n    cursor: e-resize;\n}\n\n.gutter.gutter-vertical {\n    cursor: n-resize;\n}\n\n#right-view {\n    overflow-y: auto;\n}\n\n#right-view > div {\n    min-height: 100vh;\n}\n\n#right-view > div > .row{\n    min-height: calc(100vh - 49px);\n    margin-bottom: 0;\n}\n\n#left-view-bottom .card-content {\n    padding: 0.5rem;\n    padding-top: calc(0.5rem - 6px);\n}\n\n#left-view-bottom .row > div .active > div > div {\n    background: lightblue;\n}\n\n.obj-preview {\n    width: 100%;\n}\n\n#left-view-bottom {\n    overflow-y: auto;\n}\n\n.card-content > i {\n    cursor: pointer;\n    padding: 0 0.2em;\n}\n.card-content > i:hover {\n    color: gray;\n}\n\n.card[data-type="env"] .toggle-grav{\n    display: none;\n}\n\n.card-title {\n    padding: 0!important;\n    left: 24px!important;\n    bottom: 24px!important;\n    cursor: text;\n}\n\n.card-image {\n    cursor: pointer;\n}\n\n.card-wrap{\n    min-width: 13rem;\n    max-width: 25rem;\n    width: 33.3333333%;\n}\n\n/* make materialize and blockly get along */\n.blocklyHtmlInput {\n    background-color: white!important;\n    border: none!important;\n    border-radius: 4px!important;\n    font-family: sans-serif!important;\n    height: 100%!important;\n    margin: 0!important;\n    outline: none!important;\n    padding: 0 1px!important;\n    width: 100%!important;\n}\n\n.blocklyDropdownMenu {\n    -webkit-box-sizing: initial!important;\n    box-sizing: initial!important;\n}\n\n.blocklyWidgetDiv .goog-palette-table {\n    width: initial;\n}\n\n.blocklyWidgetDiv .goog-palette-cell {\n    padding: 0;\n}\n\n.a-canvas {\n    z-index: 10000;\n}\n\n.a-enter-vr {\n    z-index: 10001;\n}',""])},function(e,t,o){var i=o(163);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0};o(161)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,o){o(164),o(159),o(157),o(152),o(40),o(147),o(146),o(125),o(124),o(123).registerAll(),o(44),$(document).ready(function(){$(".loader").css("height",0)})}]);